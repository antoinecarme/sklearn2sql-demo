-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : CalibratedClassifierCV_sigmoid
-- Dataset : FourClass_500
-- Database : teradata


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180417002014_yc47mb_calp part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180417002014_yc47mb_calp  (
	"KEY" BIGINT, 
	"Proba_0" FLOAT, 
	"Proba_1" FLOAT, 
	"Proba_2" FLOAT, 
	"Proba_3" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180417002014_yc47mb_calp part 2/2. Populate

INSERT INTO tmp_20180417002014_yc47mb_calp ("KEY", "Proba_0", "Proba_1", "Proba_2", "Proba_3") SELECT "U"."KEY", "U"."Proba_0", "U"."Proba_1", "U"."Proba_2", "U"."Proba_3" 
FROM (WITH "DT_node_lookup" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_18" <= 4.599671840667725) THEN CASE WHEN ("ADS"."Feature_249" <= 4.27580451965332) THEN CASE WHEN ("ADS"."Feature_477" <= 0.70470118522644) THEN CASE WHEN ("ADS"."Feature_456" <= -3.913557529449463) THEN CASE WHEN ("ADS"."Feature_368" <= -0.725506901741028) THEN 5 ELSE 6 END ELSE CASE WHEN ("ADS"."Feature_208" <= 7.578444480895996) THEN 8 ELSE 9 END END ELSE CASE WHEN ("ADS"."Feature_252" <= -6.678833484649658) THEN CASE WHEN ("ADS"."Feature_333" <= -3.098625659942627) THEN 12 ELSE 13 END ELSE CASE WHEN ("ADS"."Feature_143" <= 0.130018413066864) THEN 15 ELSE 16 END END END ELSE CASE WHEN ("ADS"."Feature_406" <= -0.075814850628376) THEN CASE WHEN ("ADS"."Feature_358" <= 0.317897140979767) THEN CASE WHEN ("ADS"."Feature_318" <= -0.835650503635406) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS"."Feature_432" <= 1.752685070037842) THEN 23 ELSE 24 END END ELSE CASE WHEN ("ADS"."Feature_198" <= -0.71648359298706) THEN CASE WHEN ("ADS"."Feature_377" <= 3.510922431945801) THEN 27 ELSE 28 END ELSE CASE WHEN ("ADS"."Feature_335" <= -0.206499069929123) THEN 30 ELSE 31 END END END END ELSE CASE WHEN ("ADS"."Feature_260" <= 1.30246376991272) THEN CASE WHEN ("ADS"."Feature_497" <= -4.776134490966797) THEN CASE WHEN ("ADS"."Feature_167" <= -0.364411175251007) THEN 35 ELSE CASE WHEN ("ADS"."Feature_120" <= 0.214668795466423) THEN 37 ELSE 38 END END ELSE CASE WHEN ("ADS"."Feature_436" <= -4.761728763580322) THEN CASE WHEN ("ADS"."Feature_330" <= 0.512633681297302) THEN 41 ELSE 42 END ELSE CASE WHEN ("ADS"."Feature_229" <= -5.699057579040527) THEN 44 ELSE 45 END END END ELSE CASE WHEN ("ADS"."Feature_14" <= 0.120370231568813) THEN CASE WHEN ("ADS"."Feature_139" <= -1.064292311668396) THEN CASE WHEN ("ADS"."Feature_120" <= -1.064013481140137) THEN 49 ELSE 50 END ELSE 51 END ELSE 52 END END END AS node_id_2 
FROM "FourClass_500" AS "ADS"), 
"DT_node_data" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values"."count" AS FLOAT) AS "count", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Proba_0" AS FLOAT) AS "Proba_0", CAST("Values"."LogProba_0" AS FLOAT) AS "LogProba_0", CAST("Values"."Proba_1" AS FLOAT) AS "Proba_1", CAST("Values"."LogProba_1" AS FLOAT) AS "LogProba_1", CAST("Values"."Proba_2" AS FLOAT) AS "Proba_2", CAST("Values"."LogProba_2" AS FLOAT) AS "LogProba_2", CAST("Values"."Proba_3" AS FLOAT) AS "Proba_3", CAST("Values"."LogProba_3" AS FLOAT) AS "LogProba_3", CAST("Values"."Decision" AS FLOAT) AS "Decision", CAST("Values"."DecisionProba" AS FLOAT) AS "DecisionProba" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS "count", 5 AS depth, 4 AS parent_id, 0.8 AS "Proba_0", -0.22314355131421 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.2 AS "Proba_3", -1.6094379124341 AS "LogProba_3", 0 AS "Decision", 0.8 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 29 AS "count", 5 AS depth, 4 AS parent_id, 0.068965517241379 AS "Proba_0", -2.674148649426528 AS "LogProba_0", 0.241379310344828 AS "Proba_1", -1.421385680931161 AS "LogProba_1", 0.551724137931034 AS "Proba_2", -0.594707107746693 AS "LogProba_2", 0.137931034482759 AS "Proba_3", -1.981001468866583 AS "LogProba_3", 2 AS "Decision", 0.551724137931034 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 97 AS "count", 5 AS depth, 7 AS parent_id, 0.072164948453608 AS "Proba_0", -2.62880082944807 AS "LogProba_0", 0.701030927835052 AS "Proba_1", -0.355203273327276 AS "LogProba_1", 0.123711340206186 AS "Proba_2", -2.089804328715382 AS "LogProba_2", 0.103092783505155 AS "Proba_3", -2.272125885509338 AS "LogProba_3", 1 AS "Decision", 0.701030927835052 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS "count", 5 AS depth, 7 AS parent_id, 0.1 AS "Proba_0", -2.302585092994046 AS "LogProba_0", 0.1 AS "Proba_1", -2.302585092994046 AS "LogProba_1", 0.2 AS "Proba_2", -1.6094379124341 AS "LogProba_2", 0.6 AS "Proba_3", -0.510825623765991 AS "LogProba_3", 3 AS "Decision", 0.6 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 12 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS "count", 5 AS depth, 11 AS parent_id, 0.9 AS "Proba_0", -0.105360515657826 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.1 AS "Proba_2", -2.302585092994046 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 0.9 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS "count", 5 AS depth, 11 AS parent_id, 0.214285714285714 AS "Proba_0", -1.540445040947149 AS "LogProba_0", 0.142857142857143 AS "Proba_1", -1.945910149055314 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.642857142857143 AS "Proba_3", -0.441832752279039 AS "LogProba_3", 3 AS "Decision", 0.642857142857143 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 67 AS "count", 5 AS depth, 14 AS parent_id, 0.134328358208955 AS "Proba_0", -2.007468042054746 AS "LogProba_0", 0.17910447761194 AS "Proba_1", -1.719785969602966 AS "LogProba_1", 0.537313432835821 AS "Proba_2", -0.621173680934856 AS "LogProba_2", 0.149253731343284 AS "Proba_3", -1.90210752639692 AS "LogProba_3", 2 AS "Decision", 0.537313432835821 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 59 AS "count", 5 AS depth, 14 AS parent_id, 0.23728813559322 AS "Proba_0", -1.438480114290461 AS "LogProba_0", 0.35593220338983 AS "Proba_1", -1.033015006182296 AS "LogProba_1", 0.186440677966102 AS "Proba_2", -1.679642171107349 AS "LogProba_2", 0.220338983050847 AS "Proba_3", -1.512588086444183 AS "LogProba_3", 1 AS "Decision", 0.35593220338983 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS "count", 5 AS depth, 19 AS parent_id, 0.222222222222222 AS "Proba_0", -1.504077396776274 AS "LogProba_0", 0.111111111111111 AS "Proba_1", -2.19722457733622 AS "LogProba_1", 0.555555555555556 AS "Proba_2", -0.587786664902119 AS "LogProba_2", 0.111111111111111 AS "Proba_3", -2.19722457733622 AS "LogProba_3", 2 AS "Decision", 0.555555555555556 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 32 AS "count", 5 AS depth, 19 AS parent_id, 0.875 AS "Proba_0", -0.133531392624523 AS "LogProba_0", 0.03125 AS "Proba_1", -3.465735902799726 AS "LogProba_1", 0.0625 AS "Proba_2", -2.772588722239781 AS "LogProba_2", 0.03125 AS "Proba_3", -3.465735902799726 AS "LogProba_3", 0 AS "Decision", 0.875 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 31 AS "count", 5 AS depth, 22 AS parent_id, 0.387096774193548 AS "Proba_0", -0.949080554697146 AS "LogProba_0", 0.064516129032258 AS "Proba_1", -2.740840023925201 AS "LogProba_1", 0.161290322580645 AS "Proba_2", -1.824549292051046 AS "LogProba_2", 0.387096774193548 AS "Proba_3", -0.949080554697146 AS "LogProba_3", 0 AS "Decision", 0.387096774193548 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS "count", 5 AS depth, 22 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 1.0 AS "Proba_1", 0.0 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 19 AS "count", 5 AS depth, 26 AS parent_id, 0.105263157894737 AS "Proba_0", -2.251291798606495 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.842105263157895 AS "Proba_2", -0.171850256926659 AS "LogProba_2", 0.052631578947368 AS "Proba_3", -2.94443897916644 AS "LogProba_3", 2 AS "Decision", 0.842105263157895 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS "count", 5 AS depth, 26 AS parent_id, 0.222222222222222 AS "Proba_0", -1.504077396776274 AS "LogProba_0", 0.444444444444444 AS "Proba_1", -0.810930216216329 AS "LogProba_1", 0.111111111111111 AS "Proba_2", -2.19722457733622 AS "LogProba_2", 0.222222222222222 AS "Proba_3", -1.504077396776274 AS "LogProba_3", 1 AS "Decision", 0.444444444444444 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 27 AS "count", 5 AS depth, 29 AS parent_id, 0.444444444444444 AS "Proba_0", -0.810930216216329 AS "LogProba_0", 0.037037037037037 AS "Proba_1", -3.295836866004329 AS "LogProba_1", 0.333333333333333 AS "Proba_2", -1.09861228866811 AS "LogProba_2", 0.185185185185185 AS "Proba_3", -1.686398953570229 AS "LogProba_3", 0 AS "Decision", 0.444444444444444 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 41 AS "count", 5 AS depth, 29 AS parent_id, 0.048780487804878 AS "Proba_0", -3.020424886144362 AS "LogProba_0", 0.292682926829268 AS "Proba_1", -1.228665416916308 AS "LogProba_1", 0.121951219512195 AS "Proba_2", -2.104134154270208 AS "LogProba_2", 0.536585365853659 AS "Proba_3", -0.622529613345992 AS "LogProba_3", 3 AS "Decision", 0.536585365853659 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS "count", 4 AS depth, 34 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 1.0 AS "Proba_2", 0.0 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 2 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS "count", 5 AS depth, 36 AS parent_id, 0.571428571428571 AS "Proba_0", -0.559615787935423 AS "LogProba_0", 0.142857142857143 AS "Proba_1", -1.945910149055314 AS "LogProba_1", 0.285714285714286 AS "Proba_2", -1.252762968495368 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 0.571428571428571 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS "count", 5 AS depth, 36 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 1.0 AS "Proba_3", 0.0 AS "LogProba_3", 3 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 15 AS "count", 5 AS depth, 40 AS parent_id, 0.866666666666667 AS "Proba_0", -0.143100843640673 AS "LogProba_0", 0.066666666666667 AS "Proba_1", -2.70805020110221 AS "LogProba_1", 0.066666666666667 AS "Proba_2", -2.70805020110221 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 0.866666666666667 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS "count", 5 AS depth, 40 AS parent_id, 0.2 AS "Proba_0", -1.6094379124341 AS "LogProba_0", 0.1 AS "Proba_1", -2.302585092994046 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.7 AS "Proba_3", -0.356674943938732 AS "LogProba_3", 3 AS "Decision", 0.7 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS "count", 5 AS depth, 43 AS parent_id, 0.1 AS "Proba_0", -2.302585092994046 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.8 AS "Proba_2", -0.22314355131421 AS "LogProba_2", 0.1 AS "Proba_3", -2.302585092994046 AS "LogProba_3", 2 AS "Decision", 0.8 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 58 AS "count", 5 AS depth, 43 AS parent_id, 0.155172413793103 AS "Proba_0", -1.8632184332102 AS "LogProba_0", 0.03448275862069 AS "Proba_1", -3.367295829986474 AS "LogProba_1", 0.086206896551724 AS "Proba_2", -2.451005098112319 AS "LogProba_2", 0.724137931034483 AS "Proba_3", -0.322773392263051 AS "LogProba_3", 3 AS "Decision", 0.724137931034483 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 49 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 1 AS "count", 5 AS depth, 48 AS parent_id, 1.0 AS "Proba_0", 0.0 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 1 AS "count", 5 AS depth, 48 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 1.0 AS "Proba_2", 0.0 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 2 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS "count", 4 AS depth, 47 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 1.0 AS "Proba_3", 0.0 AS "LogProba_3", 3 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS "count", 3 AS depth, 46 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 1.0 AS "Proba_1", 0.0 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".node_id AS node_id, "DT_node_data".feature AS feature, "DT_node_data"."threshold" AS "threshold", "DT_node_data"."count" AS "count", "DT_node_data".depth AS depth, "DT_node_data".parent_id AS parent_id, "DT_node_data"."Proba_0" AS "Proba_0", "DT_node_data"."LogProba_0" AS "LogProba_0", "DT_node_data"."Proba_1" AS "Proba_1", "DT_node_data"."LogProba_1" AS "LogProba_1", "DT_node_data"."Proba_2" AS "Proba_2", "DT_node_data"."LogProba_2" AS "LogProba_2", "DT_node_data"."Proba_3" AS "Proba_3", "DT_node_data"."LogProba_3" AS "LogProba_3", "DT_node_data"."Decision" AS "Decision", "DT_node_data"."DecisionProba" AS "DecisionProba" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".node_id), 
"Calibrated_Model_0" AS 
(SELECT "DT_Output"."KEY" AS "KEY", CAST(NULL AS FLOAT) AS "Score_0", CAST(NULL AS FLOAT) AS "Score_1", CAST(NULL AS FLOAT) AS "Score_2", CAST(NULL AS FLOAT) AS "Score_3", "DT_Output"."Proba_0" AS "Proba_0", "DT_Output"."Proba_1" AS "Proba_1", "DT_Output"."Proba_2" AS "Proba_2", "DT_Output"."Proba_3" AS "Proba_3", "DT_Output"."LogProba_0" AS "LogProba_0", "DT_Output"."LogProba_1" AS "LogProba_1", "DT_Output"."LogProba_2" AS "LogProba_2", "DT_Output"."LogProba_3" AS "LogProba_3", CAST(NULL AS BIGINT) AS "Decision", CAST(NULL AS FLOAT) AS "DecisionProba", coalesce(CAST(NULL AS FLOAT), "DT_Output"."Proba_0") AS "ScoreOrProba_0", coalesce(CAST(NULL AS FLOAT), "DT_Output"."Proba_1") AS "ScoreOrProba_1", coalesce(CAST(NULL AS FLOAT), "DT_Output"."Proba_2") AS "ScoreOrProba_2", coalesce(CAST(NULL AS FLOAT), "DT_Output"."Proba_3") AS "ScoreOrProba_3" 
FROM "DT_Output"), 
sigmoid_calibration_0 AS 
(SELECT "Calibrated_Model_0"."KEY" AS "KEY", 1.0 / (1.0 + exp(least(greatest(-100.0, -(-0.334045176040699 * "Calibrated_Model_0"."ScoreOrProba_0" + -1.098665621265825)), 100.0))) AS "Proba_0", 1.0 / (1.0 + exp(least(greatest(-100.0, -(1.013346975181713 * "Calibrated_Model_0"."ScoreOrProba_1" + -1.36676047946013)), 100.0))) AS "Proba_1", 1.0 / (1.0 + exp(least(greatest(-100.0, -(0.791521805783873 * "Calibrated_Model_0"."ScoreOrProba_2" + -1.279832091133283)), 100.0))) AS "Proba_2", 1.0 / (1.0 + exp(least(greatest(-100.0, -(0.025965369415159 * "Calibrated_Model_0"."ScoreOrProba_3" + -1.066527862390536)), 100.0))) AS "Proba_3" 
FROM "Calibrated_Model_0"), 
"Normalized_Probas" AS 
(SELECT sigmoid_calibration_0."KEY" AS "KEY", sigmoid_calibration_0."Proba_0" / (sigmoid_calibration_0."Proba_0" + sigmoid_calibration_0."Proba_1" + sigmoid_calibration_0."Proba_2" + sigmoid_calibration_0."Proba_3") AS "Proba_0", sigmoid_calibration_0."Proba_1" / (sigmoid_calibration_0."Proba_0" + sigmoid_calibration_0."Proba_1" + sigmoid_calibration_0."Proba_2" + sigmoid_calibration_0."Proba_3") AS "Proba_1", sigmoid_calibration_0."Proba_2" / (sigmoid_calibration_0."Proba_0" + sigmoid_calibration_0."Proba_1" + sigmoid_calibration_0."Proba_2" + sigmoid_calibration_0."Proba_3") AS "Proba_2", sigmoid_calibration_0."Proba_3" / (sigmoid_calibration_0."Proba_0" + sigmoid_calibration_0."Proba_1" + sigmoid_calibration_0."Proba_2" + sigmoid_calibration_0."Proba_3") AS "Proba_3" 
FROM sigmoid_calibration_0), 
"DT_node_lookup_1" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_266" <= 2.772783756256104) THEN CASE WHEN ("ADS"."Feature_196" <= 3.836905479431152) THEN CASE WHEN ("ADS"."Feature_259" <= 0.538612246513367) THEN CASE WHEN ("ADS"."Feature_135" <= 1.05292797088623) THEN CASE WHEN ("ADS"."Feature_183" <= -8.940668106079102) THEN 5 ELSE 6 END ELSE CASE WHEN ("ADS"."Feature_459" <= -0.807369470596314) THEN 8 ELSE 9 END END ELSE CASE WHEN ("ADS"."Feature_495" <= -0.593831777572632) THEN CASE WHEN ("ADS"."Feature_424" <= -0.684011995792389) THEN 12 ELSE 13 END ELSE CASE WHEN ("ADS"."Feature_310" <= 0.775376975536346) THEN 15 ELSE 16 END END END ELSE CASE WHEN ("ADS"."Feature_74" <= -0.89936351776123) THEN CASE WHEN ("ADS"."Feature_420" <= -6.494420051574707) THEN 19 ELSE CASE WHEN ("ADS"."Feature_115" <= 1.169323682785034) THEN 21 ELSE 22 END END ELSE CASE WHEN ("ADS"."Feature_209" <= 4.615220069885254) THEN CASE WHEN ("ADS"."Feature_390" <= -1.724122643470764) THEN 25 ELSE 26 END ELSE CASE WHEN ("ADS"."Feature_308" <= 1.609619855880737) THEN 28 ELSE 29 END END END END ELSE CASE WHEN ("ADS"."Feature_106" <= -5.906652450561523) THEN CASE WHEN ("ADS"."Feature_422" <= 4.589769840240479) THEN CASE WHEN ("ADS"."Feature_399" <= 1.077586889266968) THEN CASE WHEN ("ADS"."Feature_402" <= 0.804811000823975) THEN 34 ELSE 35 END ELSE 36 END ELSE CASE WHEN ("ADS"."Feature_120" <= -1.346397638320923) THEN 38 ELSE 39 END END ELSE CASE WHEN ("ADS"."Feature_142" <= 1.063592791557312) THEN CASE WHEN ("ADS"."Feature_396" <= 4.546978950500488) THEN CASE WHEN ("ADS"."Feature_31" <= -0.85359799861908) THEN 43 ELSE 44 END ELSE CASE WHEN ("ADS"."Feature_185" <= -0.953507602214813) THEN 46 ELSE 47 END END ELSE CASE WHEN ("ADS"."Feature_200" <= 1.32137393951416) THEN CASE WHEN ("ADS"."Feature_373" <= 1.0130535364151) THEN 50 ELSE 51 END ELSE CASE WHEN ("ADS"."Feature_67" <= 0.873365044593811) THEN 53 ELSE 54 END END END END END AS node_id_2 
FROM "FourClass_500" AS "ADS"), 
"DT_node_data_1" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values"."count" AS FLOAT) AS "count", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Proba_0" AS FLOAT) AS "Proba_0", CAST("Values"."LogProba_0" AS FLOAT) AS "LogProba_0", CAST("Values"."Proba_1" AS FLOAT) AS "Proba_1", CAST("Values"."LogProba_1" AS FLOAT) AS "LogProba_1", CAST("Values"."Proba_2" AS FLOAT) AS "Proba_2", CAST("Values"."LogProba_2" AS FLOAT) AS "LogProba_2", CAST("Values"."Proba_3" AS FLOAT) AS "Proba_3", CAST("Values"."LogProba_3" AS FLOAT) AS "LogProba_3", CAST("Values"."Decision" AS FLOAT) AS "Decision", CAST("Values"."DecisionProba" AS FLOAT) AS "DecisionProba" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 18 AS "count", 5 AS depth, 4 AS parent_id, 0.055555555555556 AS "Proba_0", -2.890371757896165 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.055555555555556 AS "Proba_2", -2.890371757896165 AS "LogProba_2", 0.888888888888889 AS "Proba_3", -0.117783035656384 AS "LogProba_3", 3 AS "Decision", 0.888888888888889 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 129 AS "count", 5 AS depth, 4 AS parent_id, 0.310077519379845 AS "Proba_0", -1.170932950247736 AS "LogProba_0", 0.186046511627907 AS "Proba_1", -1.681758574013726 AS "LogProba_1", 0.178294573643411 AS "Proba_2", -1.724318188432522 AS "LogProba_2", 0.325581395348837 AS "Proba_3", -1.122142786078304 AS "LogProba_3", 3 AS "Decision", 0.325581395348837 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 19 AS "count", 5 AS depth, 7 AS parent_id, 0.052631578947368 AS "Proba_0", -2.94443897916644 AS "LogProba_0", 0.789473684210526 AS "Proba_1", -0.23638877806423 AS "LogProba_1", 0.105263157894737 AS "Proba_2", -2.251291798606495 AS "LogProba_2", 0.052631578947368 AS "Proba_3", -2.94443897916644 AS "LogProba_3", 1 AS "Decision", 0.789473684210526 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 80 AS "count", 5 AS depth, 7 AS parent_id, 0.125 AS "Proba_0", -2.079441541679836 AS "LogProba_0", 0.25 AS "Proba_1", -1.38629436111989 AS "LogProba_1", 0.325 AS "Proba_2", -1.1239300966524 AS "LogProba_2", 0.3 AS "Proba_3", -1.203972804325936 AS "LogProba_3", 2 AS "Decision", 0.325 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 12 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS "count", 5 AS depth, 11 AS parent_id, 0.125 AS "Proba_0", -2.079441541679836 AS "LogProba_0", 0.75 AS "Proba_1", -0.287682072451781 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.125 AS "Proba_3", -2.079441541679836 AS "LogProba_3", 1 AS "Decision", 0.75 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 31 AS "count", 5 AS depth, 11 AS parent_id, 0.193548387096774 AS "Proba_0", -1.642227735257091 AS "LogProba_0", 0.096774193548387 AS "Proba_1", -2.335374915817036 AS "LogProba_1", 0.548387096774194 AS "Proba_2", -0.60077386042893 AS "LogProba_2", 0.161290322580645 AS "Proba_3", -1.824549292051046 AS "LogProba_3", 2 AS "Decision", 0.548387096774194 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 40 AS "count", 5 AS depth, 14 AS parent_id, 0.05 AS "Proba_0", -2.995732273553991 AS "LogProba_0", 0.8 AS "Proba_1", -0.22314355131421 AS "LogProba_1", 0.075 AS "Proba_2", -2.590267165445826 AS "LogProba_2", 0.075 AS "Proba_3", -2.590267165445826 AS "LogProba_3", 1 AS "Decision", 0.8 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS "count", 5 AS depth, 14 AS parent_id, 0.8 AS "Proba_0", -0.22314355131421 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.2 AS "Proba_2", -1.6094379124341 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 0.8 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS "count", 4 AS depth, 18 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 1.0 AS "Proba_1", 0.0 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS "count", 5 AS depth, 20 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 1.0 AS "Proba_3", 0.0 AS "LogProba_3", 3 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS "count", 5 AS depth, 20 AS parent_id, 0.5 AS "Proba_0", -0.693147180559945 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.5 AS "Proba_2", -0.693147180559945 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 0.5 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS "count", 5 AS depth, 24 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 1.0 AS "Proba_3", 0.0 AS "LogProba_3", 3 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 48 AS "count", 5 AS depth, 24 AS parent_id, 0.041666666666667 AS "Proba_0", -3.178053830347946 AS "LogProba_0", 0.125 AS "Proba_1", -2.079441541679836 AS "LogProba_1", 0.770833333333333 AS "Proba_2", -0.260283098263666 AS "LogProba_2", 0.0625 AS "Proba_3", -2.772588722239781 AS "LogProba_3", 2 AS "Decision", 0.770833333333333 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS "count", 5 AS depth, 27 AS parent_id, 0.142857142857143 AS "Proba_0", -1.945910149055314 AS "LogProba_0", 0.214285714285714 AS "Proba_1", -1.540445040947149 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.642857142857143 AS "Proba_3", -0.441832752279039 AS "LogProba_3", 3 AS "Decision", 0.642857142857143 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS "count", 5 AS depth, 27 AS parent_id, 0.285714285714286 AS "Proba_0", -1.252762968495368 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.714285714285714 AS "Proba_2", -0.336472236621213 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 2 AS "Decision", 0.714285714285714 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS "count", 5 AS depth, 33 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 1.0 AS "Proba_3", 0.0 AS "LogProba_3", 3 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS "count", 5 AS depth, 33 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 1.0 AS "Proba_1", 0.0 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS "count", 4 AS depth, 32 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 1.0 AS "Proba_2", 0.0 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 2 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 1 AS "count", 4 AS depth, 37 AS parent_id, 1.0 AS "Proba_0", 0.0 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS "count", 4 AS depth, 37 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 1.0 AS "Proba_1", 0.0 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS "count", 5 AS depth, 42 AS parent_id, 0.111111111111111 AS "Proba_0", -2.19722457733622 AS "LogProba_0", 0.666666666666667 AS "Proba_1", -0.405465108108164 AS "LogProba_1", 0.111111111111111 AS "Proba_2", -2.19722457733622 AS "LogProba_2", 0.111111111111111 AS "Proba_3", -2.19722457733622 AS "LogProba_3", 1 AS "Decision", 0.666666666666667 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 64 AS "count", 5 AS depth, 42 AS parent_id, 0.796875 AS "Proba_0", -0.227057450635346 AS "LogProba_0", 0.09375 AS "Proba_1", -2.367123614131617 AS "LogProba_1", 0.078125 AS "Proba_2", -2.549445170925572 AS "LogProba_2", 0.03125 AS "Proba_3", -3.465735902799726 AS "LogProba_3", 0 AS "Decision", 0.796875 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS "count", 5 AS depth, 45 AS parent_id, 0.25 AS "Proba_0", -1.38629436111989 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.75 AS "Proba_2", -0.287682072451781 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 2 AS "Decision", 0.75 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS "count", 5 AS depth, 45 AS parent_id, 0.230769230769231 AS "Proba_0", -1.466337068793427 AS "LogProba_0", 0.384615384615385 AS "Proba_1", -0.955511445027436 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.384615384615385 AS "Proba_3", -0.955511445027436 AS "LogProba_3", 1 AS "Decision", 0.384615384615385 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 37 AS "count", 5 AS depth, 49 AS parent_id, 0.108108108108108 AS "Proba_0", -2.224623551524334 AS "LogProba_0", 0.243243243243243 AS "Proba_1", -1.413693335308005 AS "LogProba_1", 0.162162162162162 AS "Proba_2", -1.81915844341617 AS "LogProba_2", 0.486486486486486 AS "Proba_3", -0.72054615474806 AS "LogProba_3", 3 AS "Decision", 0.486486486486486 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS "count", 5 AS depth, 49 AS parent_id, 0.777777777777778 AS "Proba_0", -0.251314428280906 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.222222222222222 AS "Proba_2", -1.504077396776274 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 0.777777777777778 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 53 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS "count", 5 AS depth, 52 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 1.0 AS "Proba_2", 0.0 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 2 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 1 AS "count", 5 AS depth, 52 AS parent_id, 1.0 AS "Proba_0", 0.0 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_1" AS 
(SELECT "DT_node_lookup_1"."KEY" AS "KEY", "DT_node_lookup_1".node_id_2 AS node_id_2, "DT_node_data_1".node_id AS node_id, "DT_node_data_1".feature AS feature, "DT_node_data_1"."threshold" AS "threshold", "DT_node_data_1"."count" AS "count", "DT_node_data_1".depth AS depth, "DT_node_data_1".parent_id AS parent_id, "DT_node_data_1"."Proba_0" AS "Proba_0", "DT_node_data_1"."LogProba_0" AS "LogProba_0", "DT_node_data_1"."Proba_1" AS "Proba_1", "DT_node_data_1"."LogProba_1" AS "LogProba_1", "DT_node_data_1"."Proba_2" AS "Proba_2", "DT_node_data_1"."LogProba_2" AS "LogProba_2", "DT_node_data_1"."Proba_3" AS "Proba_3", "DT_node_data_1"."LogProba_3" AS "LogProba_3", "DT_node_data_1"."Decision" AS "Decision", "DT_node_data_1"."DecisionProba" AS "DecisionProba" 
FROM "DT_node_lookup_1" LEFT OUTER JOIN "DT_node_data_1" ON "DT_node_lookup_1".node_id_2 = "DT_node_data_1".node_id), 
"Calibrated_Model_1" AS 
(SELECT "DT_Output_1"."KEY" AS "KEY", CAST(NULL AS FLOAT) AS "Score_0", CAST(NULL AS FLOAT) AS "Score_1", CAST(NULL AS FLOAT) AS "Score_2", CAST(NULL AS FLOAT) AS "Score_3", "DT_Output_1"."Proba_0" AS "Proba_0", "DT_Output_1"."Proba_1" AS "Proba_1", "DT_Output_1"."Proba_2" AS "Proba_2", "DT_Output_1"."Proba_3" AS "Proba_3", "DT_Output_1"."LogProba_0" AS "LogProba_0", "DT_Output_1"."LogProba_1" AS "LogProba_1", "DT_Output_1"."LogProba_2" AS "LogProba_2", "DT_Output_1"."LogProba_3" AS "LogProba_3", CAST(NULL AS BIGINT) AS "Decision", CAST(NULL AS FLOAT) AS "DecisionProba", coalesce(CAST(NULL AS FLOAT), "DT_Output_1"."Proba_0") AS "ScoreOrProba_0", coalesce(CAST(NULL AS FLOAT), "DT_Output_1"."Proba_1") AS "ScoreOrProba_1", coalesce(CAST(NULL AS FLOAT), "DT_Output_1"."Proba_2") AS "ScoreOrProba_2", coalesce(CAST(NULL AS FLOAT), "DT_Output_1"."Proba_3") AS "ScoreOrProba_3" 
FROM "DT_Output_1"), 
sigmoid_calibration_1 AS 
(SELECT "Calibrated_Model_1"."KEY" AS "KEY", 1.0 / (1.0 + exp(least(greatest(-100.0, -(0.64068882315686 * "Calibrated_Model_1"."ScoreOrProba_0" + -1.303079458902145)), 100.0))) AS "Proba_0", 1.0 / (1.0 + exp(least(greatest(-100.0, -(1.186760835398612 * "Calibrated_Model_1"."ScoreOrProba_1" + -1.461875640224514)), 100.0))) AS "Proba_1", 1.0 / (1.0 + exp(least(greatest(-100.0, -(1.060367048284584 * "Calibrated_Model_1"."ScoreOrProba_2" + -1.371433686007958)), 100.0))) AS "Proba_2", 1.0 / (1.0 + exp(least(greatest(-100.0, -(0.059516156693284 * "Calibrated_Model_1"."ScoreOrProba_3" + -1.066398921501775)), 100.0))) AS "Proba_3" 
FROM "Calibrated_Model_1"), 
"Normalized_Probas_1" AS 
(SELECT sigmoid_calibration_1."KEY" AS "KEY", sigmoid_calibration_1."Proba_0" / (sigmoid_calibration_1."Proba_0" + sigmoid_calibration_1."Proba_1" + sigmoid_calibration_1."Proba_2" + sigmoid_calibration_1."Proba_3") AS "Proba_0", sigmoid_calibration_1."Proba_1" / (sigmoid_calibration_1."Proba_0" + sigmoid_calibration_1."Proba_1" + sigmoid_calibration_1."Proba_2" + sigmoid_calibration_1."Proba_3") AS "Proba_1", sigmoid_calibration_1."Proba_2" / (sigmoid_calibration_1."Proba_0" + sigmoid_calibration_1."Proba_1" + sigmoid_calibration_1."Proba_2" + sigmoid_calibration_1."Proba_3") AS "Proba_2", sigmoid_calibration_1."Proba_3" / (sigmoid_calibration_1."Proba_0" + sigmoid_calibration_1."Proba_1" + sigmoid_calibration_1."Proba_2" + sigmoid_calibration_1."Proba_3") AS "Proba_3" 
FROM sigmoid_calibration_1), 
"DT_node_lookup_2" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_249" <= 2.867722034454346) THEN CASE WHEN ("ADS"."Feature_209" <= -3.830874919891358) THEN CASE WHEN ("ADS"."Feature_283" <= 4.226866722106934) THEN CASE WHEN ("ADS"."Feature_336" <= 0.485923886299133) THEN CASE WHEN ("ADS"."Feature_146" <= -1.513776063919068) THEN 5 ELSE 6 END ELSE CASE WHEN ("ADS"."Feature_141" <= 0.111022368073463) THEN 8 ELSE 9 END END ELSE CASE WHEN ("ADS"."Feature_481" <= 0.211803182959557) THEN 11 ELSE CASE WHEN ("ADS"."Feature_480" <= 7.416871547698975) THEN 13 ELSE 14 END END END ELSE CASE WHEN ("ADS"."Feature_338" <= 3.33180570602417) THEN CASE WHEN ("ADS"."Feature_495" <= -0.567240417003632) THEN CASE WHEN ("ADS"."Feature_343" <= -2.373010158538818) THEN 18 ELSE 19 END ELSE CASE WHEN ("ADS"."Feature_157" <= -0.928917527198792) THEN 21 ELSE 22 END END ELSE CASE WHEN ("ADS"."Feature_483" <= 4.307338237762451) THEN CASE WHEN ("ADS"."Feature_289" <= 1.832192659378052) THEN 25 ELSE 26 END ELSE CASE WHEN ("ADS"."Feature_58" <= -0.600655853748322) THEN 28 ELSE 29 END END END END ELSE CASE WHEN ("ADS"."Feature_497" <= -7.866596221923828) THEN CASE WHEN ("ADS"."Feature_76" <= 0.059133343398571) THEN CASE WHEN ("ADS"."Feature_125" <= 1.010543346405029) THEN 33 ELSE CASE WHEN ("ADS"."Feature_106" <= -0.654592990875244) THEN 35 ELSE 36 END END ELSE CASE WHEN ("ADS"."Feature_114" <= 0.886090278625488) THEN CASE WHEN ("ADS"."Feature_41" <= -1.396751403808594) THEN 39 ELSE 40 END ELSE CASE WHEN ("ADS"."Feature_377" <= -4.432969570159912) THEN 42 ELSE 43 END END END ELSE CASE WHEN ("ADS"."Feature_288" <= 3.289342403411865) THEN CASE WHEN ("ADS"."Feature_153" <= 1.387183904647827) THEN CASE WHEN ("ADS"."Feature_303" <= -0.429277002811432) THEN 47 ELSE 48 END ELSE CASE WHEN ("ADS"."Feature_424" <= -0.485293745994568) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS"."Feature_295" <= -0.881173372268677) THEN CASE WHEN ("ADS"."Feature_199" <= -1.34501039981842) THEN 54 ELSE 55 END ELSE CASE WHEN ("ADS"."Feature_37" <= 0.362713754177094) THEN 57 ELSE 58 END END END END END AS node_id_2 
FROM "FourClass_500" AS "ADS"), 
"DT_node_data_2" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values"."count" AS FLOAT) AS "count", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Proba_0" AS FLOAT) AS "Proba_0", CAST("Values"."LogProba_0" AS FLOAT) AS "LogProba_0", CAST("Values"."Proba_1" AS FLOAT) AS "Proba_1", CAST("Values"."LogProba_1" AS FLOAT) AS "LogProba_1", CAST("Values"."Proba_2" AS FLOAT) AS "Proba_2", CAST("Values"."LogProba_2" AS FLOAT) AS "LogProba_2", CAST("Values"."Proba_3" AS FLOAT) AS "Proba_3", CAST("Values"."LogProba_3" AS FLOAT) AS "LogProba_3", CAST("Values"."Decision" AS FLOAT) AS "Decision", CAST("Values"."DecisionProba" AS FLOAT) AS "DecisionProba" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS "count", 5 AS depth, 4 AS parent_id, 0.8 AS "Proba_0", -0.22314355131421 AS "LogProba_0", 0.2 AS "Proba_1", -1.6094379124341 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 0.8 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 44 AS "count", 5 AS depth, 4 AS parent_id, 0.022727272727273 AS "Proba_0", -3.784189633918261 AS "LogProba_0", 0.068181818181818 AS "Proba_1", -2.685577345250152 AS "LogProba_1", 0.75 AS "Proba_2", -0.287682072451781 AS "LogProba_2", 0.159090909090909 AS "Proba_3", -1.838279484862948 AS "LogProba_3", 2 AS "Decision", 0.75 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS "count", 5 AS depth, 7 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.9 AS "Proba_1", -0.105360515657826 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.1 AS "Proba_3", -2.302585092994046 AS "LogProba_3", 1 AS "Decision", 0.9 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS "count", 5 AS depth, 7 AS parent_id, 0.666666666666667 AS "Proba_0", -0.405465108108164 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.333333333333333 AS "Proba_2", -1.09861228866811 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 0.666666666666667 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS "count", 4 AS depth, 10 AS parent_id, 1.0 AS "Proba_0", 0.0 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS "count", 5 AS depth, 12 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.666666666666667 AS "Proba_1", -0.405465108108164 AS "LogProba_1", 0.333333333333333 AS "Proba_2", -1.09861228866811 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 0.666666666666667 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS "count", 5 AS depth, 12 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 1.0 AS "Proba_3", 0.0 AS "LogProba_3", 3 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 53 AS "count", 5 AS depth, 17 AS parent_id, 0.433962264150943 AS "Proba_0", -0.834797697622972 AS "LogProba_0", 0.264150943396226 AS "Proba_1", -1.331234583936863 AS "LogProba_1", 0.264150943396226 AS "Proba_2", -1.331234583936863 AS "LogProba_2", 0.037735849056604 AS "Proba_3", -3.277144732992176 AS "LogProba_3", 0 AS "Decision", 0.433962264150943 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 49 AS "count", 5 AS depth, 17 AS parent_id, 0.102040816326531 AS "Proba_0", -2.282382385676526 AS "LogProba_0", 0.346938775510204 AS "Proba_1", -1.05860695405441 AS "LogProba_1", 0.163265306122449 AS "Proba_2", -1.812378756430791 AS "LogProba_2", 0.387755102040816 AS "Proba_3", -0.947381318944186 AS "LogProba_3", 3 AS "Decision", 0.387755102040816 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 15 AS "count", 5 AS depth, 20 AS parent_id, 0.066666666666667 AS "Proba_0", -2.70805020110221 AS "LogProba_0", 0.133333333333333 AS "Proba_1", -2.014903020542265 AS "LogProba_1", 0.266666666666667 AS "Proba_2", -1.32175583998232 AS "LogProba_2", 0.533333333333333 AS "Proba_3", -0.628608659422374 AS "LogProba_3", 3 AS "Decision", 0.533333333333333 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 83 AS "count", 5 AS depth, 20 AS parent_id, 0.072289156626506 AS "Proba_0", -2.627081138568543 AS "LogProba_0", 0.686746987951807 AS "Proba_1", -0.375789339962048 AS "LogProba_1", 0.108433734939759 AS "Proba_2", -2.221616030460379 AS "LogProba_2", 0.132530120481928 AS "Proba_3", -2.020945334998227 AS "LogProba_3", 1 AS "Decision", 0.686746987951807 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 30 AS "count", 5 AS depth, 24 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.133333333333333 AS "Proba_1", -2.014903020542265 AS "LogProba_1", 0.766666666666667 AS "Proba_2", -0.265703165733006 AS "LogProba_2", 0.1 AS "Proba_3", -2.302585092994046 AS "LogProba_3", 2 AS "Decision", 0.766666666666667 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 17 AS "count", 5 AS depth, 24 AS parent_id, 0.352941176470588 AS "Proba_0", -1.041453874828161 AS "LogProba_0", 0.235294117647059 AS "Proba_1", -1.446918982936325 AS "LogProba_1", 0.117647058823529 AS "Proba_2", -2.140066163496271 AS "LogProba_2", 0.294117647058824 AS "Proba_3", -1.223775431622116 AS "LogProba_3", 0 AS "Decision", 0.352941176470588 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS "count", 5 AS depth, 27 AS parent_id, 0.375 AS "Proba_0", -0.980829253011726 AS "LogProba_0", 0.375 AS "Proba_1", -0.980829253011726 AS "LogProba_1", 0.125 AS "Proba_2", -2.079441541679836 AS "LogProba_2", 0.125 AS "Proba_3", -2.079441541679836 AS "LogProba_3", 0 AS "Decision", 0.375 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS "count", 5 AS depth, 27 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.071428571428571 AS "Proba_2", -2.639057329615259 AS "LogProba_2", 0.928571428571429 AS "Proba_3", -0.074107972153722 AS "LogProba_3", 3 AS "Decision", 0.928571428571429 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 16 AS "count", 4 AS depth, 32 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 1.0 AS "Proba_2", 0.0 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 2 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS "count", 5 AS depth, 34 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 1.0 AS "Proba_1", 0.0 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS "count", 5 AS depth, 34 AS parent_id, 0.5 AS "Proba_0", -0.693147180559945 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.5 AS "Proba_3", -0.693147180559945 AS "LogProba_3", 0 AS "Decision", 0.5 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 1 AS "count", 5 AS depth, 38 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 1.0 AS "Proba_3", 0.0 AS "LogProba_3", 3 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS "count", 5 AS depth, 38 AS parent_id, 1.0 AS "Proba_0", 0.0 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS "count", 5 AS depth, 41 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 1.0 AS "Proba_2", 0.0 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 2 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS "count", 5 AS depth, 41 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.666666666666667 AS "Proba_1", -0.405465108108164 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.333333333333333 AS "Proba_3", -1.09861228866811 AS "LogProba_3", 1 AS "Decision", 0.666666666666667 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 28 AS "count", 5 AS depth, 46 AS parent_id, 0.071428571428571 AS "Proba_0", -2.639057329615259 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.071428571428571 AS "Proba_2", -2.639057329615259 AS "LogProba_2", 0.857142857142857 AS "Proba_3", -0.154150679827258 AS "LogProba_3", 3 AS "Decision", 0.857142857142857 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 67 AS "count", 5 AS depth, 46 AS parent_id, 0.388059701492537 AS "Proba_0", -0.946596081369484 AS "LogProba_0", 0.08955223880597 AS "Proba_1", -2.412933150162911 AS "LogProba_1", 0.074626865671642 AS "Proba_2", -2.595254706956866 AS "LogProba_2", 0.447761194029851 AS "Proba_3", -0.803495237728811 AS "LogProba_3", 3 AS "Decision", 0.447761194029851 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 21 AS "count", 5 AS depth, 49 AS parent_id, 0.476190476190476 AS "Proba_0", -0.741937344729377 AS "LogProba_0", 0.333333333333333 AS "Proba_1", -1.09861228866811 AS "LogProba_1", 0.19047619047619 AS "Proba_2", -1.658228076603532 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 0.476190476190476 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 40 AS "count", 5 AS depth, 49 AS parent_id, 0.05 AS "Proba_0", -2.995732273553991 AS "LogProba_0", 0.225 AS "Proba_1", -1.491654876777717 AS "LogProba_1", 0.3 AS "Proba_2", -1.203972804325936 AS "LogProba_2", 0.425 AS "Proba_3", -0.85566611005772 AS "LogProba_3", 3 AS "Decision", 0.425 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 1 AS "count", 5 AS depth, 53 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 1.0 AS "Proba_3", 0.0 AS "LogProba_3", 3 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS "count", 5 AS depth, 53 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 1.0 AS "Proba_1", 0.0 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 31 AS "count", 5 AS depth, 56 AS parent_id, 0.774193548387097 AS "Proba_0", -0.255933374137201 AS "LogProba_0", 0.032258064516129 AS "Proba_1", -3.433987204485146 AS "LogProba_1", 0.064516129032258 AS "Proba_2", -2.740840023925201 AS "LogProba_2", 0.129032258064516 AS "Proba_3", -2.047692843365256 AS "LogProba_3", 0 AS "Decision", 0.774193548387097 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 19 AS "count", 5 AS depth, 56 AS parent_id, 0.210526315789474 AS "Proba_0", -1.55814461804655 AS "LogProba_0", 0.105263157894737 AS "Proba_1", -2.251291798606495 AS "LogProba_1", 0.473684210526316 AS "Proba_2", -0.747214401830221 AS "LogProba_2", 0.210526315789474 AS "Proba_3", -1.55814461804655 AS "LogProba_3", 2 AS "Decision", 0.473684210526316 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_2" AS 
(SELECT "DT_node_lookup_2"."KEY" AS "KEY", "DT_node_lookup_2".node_id_2 AS node_id_2, "DT_node_data_2".node_id AS node_id, "DT_node_data_2".feature AS feature, "DT_node_data_2"."threshold" AS "threshold", "DT_node_data_2"."count" AS "count", "DT_node_data_2".depth AS depth, "DT_node_data_2".parent_id AS parent_id, "DT_node_data_2"."Proba_0" AS "Proba_0", "DT_node_data_2"."LogProba_0" AS "LogProba_0", "DT_node_data_2"."Proba_1" AS "Proba_1", "DT_node_data_2"."LogProba_1" AS "LogProba_1", "DT_node_data_2"."Proba_2" AS "Proba_2", "DT_node_data_2"."LogProba_2" AS "LogProba_2", "DT_node_data_2"."Proba_3" AS "Proba_3", "DT_node_data_2"."LogProba_3" AS "LogProba_3", "DT_node_data_2"."Decision" AS "Decision", "DT_node_data_2"."DecisionProba" AS "DecisionProba" 
FROM "DT_node_lookup_2" LEFT OUTER JOIN "DT_node_data_2" ON "DT_node_lookup_2".node_id_2 = "DT_node_data_2".node_id), 
"Calibrated_Model_2" AS 
(SELECT "DT_Output_2"."KEY" AS "KEY", CAST(NULL AS FLOAT) AS "Score_0", CAST(NULL AS FLOAT) AS "Score_1", CAST(NULL AS FLOAT) AS "Score_2", CAST(NULL AS FLOAT) AS "Score_3", "DT_Output_2"."Proba_0" AS "Proba_0", "DT_Output_2"."Proba_1" AS "Proba_1", "DT_Output_2"."Proba_2" AS "Proba_2", "DT_Output_2"."Proba_3" AS "Proba_3", "DT_Output_2"."LogProba_0" AS "LogProba_0", "DT_Output_2"."LogProba_1" AS "LogProba_1", "DT_Output_2"."LogProba_2" AS "LogProba_2", "DT_Output_2"."LogProba_3" AS "LogProba_3", CAST(NULL AS BIGINT) AS "Decision", CAST(NULL AS FLOAT) AS "DecisionProba", coalesce(CAST(NULL AS FLOAT), "DT_Output_2"."Proba_0") AS "ScoreOrProba_0", coalesce(CAST(NULL AS FLOAT), "DT_Output_2"."Proba_1") AS "ScoreOrProba_1", coalesce(CAST(NULL AS FLOAT), "DT_Output_2"."Proba_2") AS "ScoreOrProba_2", coalesce(CAST(NULL AS FLOAT), "DT_Output_2"."Proba_3") AS "ScoreOrProba_3" 
FROM "DT_Output_2"), 
sigmoid_calibration_2 AS 
(SELECT "Calibrated_Model_2"."KEY" AS "KEY", 1.0 / (1.0 + exp(least(greatest(-100.0, -(-0.110670360482632 * "Calibrated_Model_2"."ScoreOrProba_0" + -1.120008307860179)), 100.0))) AS "Proba_0", 1.0 / (1.0 + exp(least(greatest(-100.0, -(0.995070248649644 * "Calibrated_Model_2"."ScoreOrProba_1" + -1.37138334662399)), 100.0))) AS "Proba_1", 1.0 / (1.0 + exp(least(greatest(-100.0, -(0.232239919908199 * "Calibrated_Model_2"."ScoreOrProba_2" + -1.145353095701938)), 100.0))) AS "Proba_2", 1.0 / (1.0 + exp(least(greatest(-100.0, -(0.734125798929864 * "Calibrated_Model_2"."ScoreOrProba_3" + -1.275138475867694)), 100.0))) AS "Proba_3" 
FROM "Calibrated_Model_2"), 
"Normalized_Probas_2" AS 
(SELECT sigmoid_calibration_2."KEY" AS "KEY", sigmoid_calibration_2."Proba_0" / (sigmoid_calibration_2."Proba_0" + sigmoid_calibration_2."Proba_1" + sigmoid_calibration_2."Proba_2" + sigmoid_calibration_2."Proba_3") AS "Proba_0", sigmoid_calibration_2."Proba_1" / (sigmoid_calibration_2."Proba_0" + sigmoid_calibration_2."Proba_1" + sigmoid_calibration_2."Proba_2" + sigmoid_calibration_2."Proba_3") AS "Proba_1", sigmoid_calibration_2."Proba_2" / (sigmoid_calibration_2."Proba_0" + sigmoid_calibration_2."Proba_1" + sigmoid_calibration_2."Proba_2" + sigmoid_calibration_2."Proba_3") AS "Proba_2", sigmoid_calibration_2."Proba_3" / (sigmoid_calibration_2."Proba_0" + sigmoid_calibration_2."Proba_1" + sigmoid_calibration_2."Proba_2" + sigmoid_calibration_2."Proba_3") AS "Proba_3" 
FROM sigmoid_calibration_2), 
"DT_node_lookup_3" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_338" <= -1.793696761131286) THEN CASE WHEN ("ADS"."Feature_249" <= -21.123554229736328) THEN CASE WHEN ("ADS"."Feature_255" <= 0.245279490947723) THEN CASE WHEN ("ADS"."Feature_120" <= -0.610634922981262) THEN CASE WHEN ("ADS"."Feature_128" <= 0.436793953180313) THEN 5 ELSE 6 END ELSE CASE WHEN ("ADS"."Feature_274" <= 0.347911059856415) THEN 8 ELSE 9 END END ELSE CASE WHEN ("ADS"."Feature_329" <= -0.702915489673614) THEN CASE WHEN ("ADS"."Feature_5" <= -0.100877657532692) THEN 12 ELSE 13 END ELSE CASE WHEN ("ADS"."Feature_242" <= -1.103729844093323) THEN 15 ELSE 16 END END END ELSE CASE WHEN ("ADS"."Feature_129" <= -7.825395107269287) THEN CASE WHEN ("ADS"."Feature_28" <= 1.476552367210388) THEN 19 ELSE 20 END ELSE CASE WHEN ("ADS"."Feature_329" <= -0.975034356117248) THEN CASE WHEN ("ADS"."Feature_442" <= -2.499715328216552) THEN 23 ELSE 24 END ELSE CASE WHEN ("ADS"."Feature_268" <= 8.236695289611816) THEN 26 ELSE 27 END END END END ELSE CASE WHEN ("ADS"."Feature_301" <= -7.468977928161621) THEN CASE WHEN ("ADS"."Feature_50" <= 0.697615027427673) THEN CASE WHEN ("ADS"."Feature_247" <= 8.527505874633789) THEN 31 ELSE 32 END ELSE CASE WHEN ("ADS"."Feature_471" <= 1.155460834503174) THEN 34 ELSE CASE WHEN ("ADS"."Feature_469" <= -0.500163674354553) THEN 36 ELSE 37 END END END ELSE CASE WHEN ("ADS"."Feature_72" <= 2.885459423065186) THEN CASE WHEN ("ADS"."Feature_129" <= -5.498040199279785) THEN CASE WHEN ("ADS"."Feature_182" <= -0.441330373287201) THEN 41 ELSE 42 END ELSE CASE WHEN ("ADS"."Feature_289" <= -2.05486536026001) THEN 44 ELSE 45 END END ELSE CASE WHEN ("ADS"."Feature_179" <= -4.175331115722656) THEN CASE WHEN ("ADS"."Feature_137" <= -0.118306636810303) THEN 48 ELSE 49 END ELSE CASE WHEN ("ADS"."Feature_228" <= -0.506215035915375) THEN 51 ELSE 52 END END END END END AS node_id_2 
FROM "FourClass_500" AS "ADS"), 
"DT_node_data_3" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values"."count" AS FLOAT) AS "count", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Proba_0" AS FLOAT) AS "Proba_0", CAST("Values"."LogProba_0" AS FLOAT) AS "LogProba_0", CAST("Values"."Proba_1" AS FLOAT) AS "Proba_1", CAST("Values"."LogProba_1" AS FLOAT) AS "LogProba_1", CAST("Values"."Proba_2" AS FLOAT) AS "Proba_2", CAST("Values"."LogProba_2" AS FLOAT) AS "LogProba_2", CAST("Values"."Proba_3" AS FLOAT) AS "Proba_3", CAST("Values"."LogProba_3" AS FLOAT) AS "LogProba_3", CAST("Values"."Decision" AS FLOAT) AS "Decision", CAST("Values"."DecisionProba" AS FLOAT) AS "DecisionProba" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS "count", 5 AS depth, 4 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.923076923076923 AS "Proba_2", -0.080042707673536 AS "LogProba_2", 0.076923076923077 AS "Proba_3", -2.564949357461536 AS "LogProba_3", 2 AS "Decision", 0.923076923076923 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS "count", 5 AS depth, 4 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 1.0 AS "Proba_1", 0.0 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 22 AS "count", 5 AS depth, 7 AS parent_id, 0.090909090909091 AS "Proba_0", -2.39789527279837 AS "LogProba_0", 0.409090909090909 AS "Proba_1", -0.893817876022096 AS "LogProba_1", 0.136363636363636 AS "Proba_2", -1.992430164690206 AS "LogProba_2", 0.363636363636364 AS "Proba_3", -1.01160091167848 AS "LogProba_3", 1 AS "Decision", 0.409090909090909 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS "count", 5 AS depth, 7 AS parent_id, 0.75 AS "Proba_0", -0.287682072451781 AS "LogProba_0", 0.166666666666667 AS "Proba_1", -1.791759469228055 AS "LogProba_1", 0.083333333333333 AS "Proba_2", -2.484906649788 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 0.75 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 12 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS "count", 5 AS depth, 11 AS parent_id, 0.2 AS "Proba_0", -1.6094379124341 AS "LogProba_0", 0.6 AS "Proba_1", -0.510825623765991 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.2 AS "Proba_3", -1.6094379124341 AS "LogProba_3", 1 AS "Decision", 0.6 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS "count", 5 AS depth, 11 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 1.0 AS "Proba_2", 0.0 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 2 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS "count", 5 AS depth, 14 AS parent_id, 1.0 AS "Proba_0", 0.0 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 0 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 24 AS "count", 5 AS depth, 14 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 1.0 AS "Proba_1", 0.0 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS "count", 4 AS depth, 18 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 1.0 AS "Proba_1", 0.0 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 1 AS "count", 4 AS depth, 18 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 1.0 AS "Proba_3", 0.0 AS "LogProba_3", 3 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS "count", 5 AS depth, 22 AS parent_id, 0.111111111111111 AS "Proba_0", -2.19722457733622 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.888888888888889 AS "Proba_3", -0.117783035656384 AS "LogProba_3", 3 AS "Decision", 0.888888888888889 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS "count", 5 AS depth, 22 AS parent_id, 0.2 AS "Proba_0", -1.6094379124341 AS "LogProba_0", 0.5 AS "Proba_1", -0.693147180559945 AS "LogProba_1", 0.2 AS "Proba_2", -1.6094379124341 AS "LogProba_2", 0.1 AS "Proba_3", -2.302585092994046 AS "LogProba_3", 1 AS "Decision", 0.5 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 105 AS "count", 5 AS depth, 25 AS parent_id, 0.60952380952381 AS "Proba_0", -0.495077266797851 AS "LogProba_0", 0.104761904761905 AS "Proba_1", -2.256065077359153 AS "LogProba_1", 0.19047619047619 AS "Proba_2", -1.658228076603532 AS "LogProba_2", 0.095238095238095 AS "Proba_3", -2.351375257163478 AS "LogProba_3", 0 AS "Decision", 0.60952380952381 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS "count", 5 AS depth, 25 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.4 AS "Proba_1", -0.916290731874155 AS "LogProba_1", 0.6 AS "Proba_2", -0.510825623765991 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 2 AS "Decision", 0.6 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 22 AS "count", 4 AS depth, 30 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 1.0 AS "Proba_3", 0.0 AS "LogProba_3", 3 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 1 AS "count", 4 AS depth, 30 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 1.0 AS "Proba_2", 0.0 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 2 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS "count", 4 AS depth, 33 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 1.0 AS "Proba_1", 0.0 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 1 AS "count", 5 AS depth, 35 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 1.0 AS "Proba_3", 0.0 AS "LogProba_3", 3 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 1 AS "count", 5 AS depth, 35 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 0.0 AS "Proba_1", -1.79769313486231e+308 AS "LogProba_1", 1.0 AS "Proba_2", 0.0 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 2 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS "count", 5 AS depth, 40 AS parent_id, 0.0 AS "Proba_0", -1.79769313486231e+308 AS "LogProba_0", 1.0 AS "Proba_1", 0.0 AS "LogProba_1", 0.0 AS "Proba_2", -1.79769313486231e+308 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 1.0 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 25 AS "count", 5 AS depth, 40 AS parent_id, 0.12 AS "Proba_0", -2.120263536200091 AS "LogProba_0", 0.28 AS "Proba_1", -1.272965675812887 AS "LogProba_1", 0.12 AS "Proba_2", -2.120263536200091 AS "LogProba_2", 0.48 AS "Proba_3", -0.7339691750802 AS "LogProba_3", 3 AS "Decision", 0.48 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 81 AS "count", 5 AS depth, 43 AS parent_id, 0.123456790123457 AS "Proba_0", -2.091864061678393 AS "LogProba_0", 0.123456790123457 AS "Proba_1", -2.091864061678393 AS "LogProba_1", 0.518518518518518 AS "Proba_2", -0.65677953638907 AS "LogProba_2", 0.234567901234568 AS "Proba_3", -1.450010175505998 AS "LogProba_3", 2 AS "Decision", 0.518518518518518 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 126 AS "count", 5 AS depth, 43 AS parent_id, 0.341269841269841 AS "Proba_0", -1.075081791257916 AS "LogProba_0", 0.222222222222222 AS "Proba_1", -1.504077396776274 AS "LogProba_1", 0.261904761904762 AS "Proba_2", -1.339774345484998 AS "LogProba_2", 0.174603174603175 AS "Proba_3", -1.745239453593162 AS "LogProba_3", 0 AS "Decision", 0.341269841269841 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS "count", 5 AS depth, 47 AS parent_id, 0.071428571428571 AS "Proba_0", -2.639057329615259 AS "LogProba_0", 0.857142857142857 AS "Proba_1", -0.154150679827258 AS "LogProba_1", 0.071428571428571 AS "Proba_2", -2.639057329615259 AS "LogProba_2", 0.0 AS "Proba_3", -1.79769313486231e+308 AS "LogProba_3", 1 AS "Decision", 0.857142857142857 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 49 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS "count", 5 AS depth, 47 AS parent_id, 0.25 AS "Proba_0", -1.38629436111989 AS "LogProba_0", 0.083333333333333 AS "Proba_1", -2.484906649788 AS "LogProba_1", 0.25 AS "Proba_2", -1.38629436111989 AS "LogProba_2", 0.416666666666667 AS "Proba_3", -0.8754687373539 AS "LogProba_3", 3 AS "Decision", 0.416666666666667 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 33 AS "count", 5 AS depth, 50 AS parent_id, 0.03030303030303 AS "Proba_0", -3.49650756146648 AS "LogProba_0", 0.181818181818182 AS "Proba_1", -1.704748092238425 AS "LogProba_1", 0.454545454545454 AS "Proba_2", -0.78845736036427 AS "LogProba_2", 0.333333333333333 AS "Proba_3", -1.09861228866811 AS "LogProba_3", 2 AS "Decision", 0.454545454545454 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 44 AS "count", 5 AS depth, 50 AS parent_id, 0.022727272727273 AS "Proba_0", -3.784189633918261 AS "LogProba_0", 0.136363636363636 AS "Proba_1", -1.992430164690206 AS "LogProba_1", 0.090909090909091 AS "Proba_2", -2.39789527279837 AS "LogProba_2", 0.75 AS "Proba_3", -0.287682072451781 AS "LogProba_3", 3 AS "Decision", 0.75 AS "DecisionProba" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_3" AS 
(SELECT "DT_node_lookup_3"."KEY" AS "KEY", "DT_node_lookup_3".node_id_2 AS node_id_2, "DT_node_data_3".node_id AS node_id, "DT_node_data_3".feature AS feature, "DT_node_data_3"."threshold" AS "threshold", "DT_node_data_3"."count" AS "count", "DT_node_data_3".depth AS depth, "DT_node_data_3".parent_id AS parent_id, "DT_node_data_3"."Proba_0" AS "Proba_0", "DT_node_data_3"."LogProba_0" AS "LogProba_0", "DT_node_data_3"."Proba_1" AS "Proba_1", "DT_node_data_3"."LogProba_1" AS "LogProba_1", "DT_node_data_3"."Proba_2" AS "Proba_2", "DT_node_data_3"."LogProba_2" AS "LogProba_2", "DT_node_data_3"."Proba_3" AS "Proba_3", "DT_node_data_3"."LogProba_3" AS "LogProba_3", "DT_node_data_3"."Decision" AS "Decision", "DT_node_data_3"."DecisionProba" AS "DecisionProba" 
FROM "DT_node_lookup_3" LEFT OUTER JOIN "DT_node_data_3" ON "DT_node_lookup_3".node_id_2 = "DT_node_data_3".node_id), 
"Calibrated_Model_3" AS 
(SELECT "DT_Output_3"."KEY" AS "KEY", CAST(NULL AS FLOAT) AS "Score_0", CAST(NULL AS FLOAT) AS "Score_1", CAST(NULL AS FLOAT) AS "Score_2", CAST(NULL AS FLOAT) AS "Score_3", "DT_Output_3"."Proba_0" AS "Proba_0", "DT_Output_3"."Proba_1" AS "Proba_1", "DT_Output_3"."Proba_2" AS "Proba_2", "DT_Output_3"."Proba_3" AS "Proba_3", "DT_Output_3"."LogProba_0" AS "LogProba_0", "DT_Output_3"."LogProba_1" AS "LogProba_1", "DT_Output_3"."LogProba_2" AS "LogProba_2", "DT_Output_3"."LogProba_3" AS "LogProba_3", CAST(NULL AS BIGINT) AS "Decision", CAST(NULL AS FLOAT) AS "DecisionProba", coalesce(CAST(NULL AS FLOAT), "DT_Output_3"."Proba_0") AS "ScoreOrProba_0", coalesce(CAST(NULL AS FLOAT), "DT_Output_3"."Proba_1") AS "ScoreOrProba_1", coalesce(CAST(NULL AS FLOAT), "DT_Output_3"."Proba_2") AS "ScoreOrProba_2", coalesce(CAST(NULL AS FLOAT), "DT_Output_3"."Proba_3") AS "ScoreOrProba_3" 
FROM "DT_Output_3"), 
sigmoid_calibration_3 AS 
(SELECT "Calibrated_Model_3"."KEY" AS "KEY", 1.0 / (1.0 + exp(least(greatest(-100.0, -(1.655512265293466 * "Calibrated_Model_3"."ScoreOrProba_0" + -1.617143097927821)), 100.0))) AS "Proba_0", 1.0 / (1.0 + exp(least(greatest(-100.0, -(0.54083017919543 * "Calibrated_Model_3"."ScoreOrProba_1" + -1.221865402561999)), 100.0))) AS "Proba_1", 1.0 / (1.0 + exp(least(greatest(-100.0, -(0.205237255728356 * "Calibrated_Model_3"."ScoreOrProba_2" + -1.133996404224491)), 100.0))) AS "Proba_2", 1.0 / (1.0 + exp(least(greatest(-100.0, -(1.32737104572635 * "Calibrated_Model_3"."ScoreOrProba_3" + -1.440824336786175)), 100.0))) AS "Proba_3" 
FROM "Calibrated_Model_3"), 
"Normalized_Probas_3" AS 
(SELECT sigmoid_calibration_3."KEY" AS "KEY", sigmoid_calibration_3."Proba_0" / (sigmoid_calibration_3."Proba_0" + sigmoid_calibration_3."Proba_1" + sigmoid_calibration_3."Proba_2" + sigmoid_calibration_3."Proba_3") AS "Proba_0", sigmoid_calibration_3."Proba_1" / (sigmoid_calibration_3."Proba_0" + sigmoid_calibration_3."Proba_1" + sigmoid_calibration_3."Proba_2" + sigmoid_calibration_3."Proba_3") AS "Proba_1", sigmoid_calibration_3."Proba_2" / (sigmoid_calibration_3."Proba_0" + sigmoid_calibration_3."Proba_1" + sigmoid_calibration_3."Proba_2" + sigmoid_calibration_3."Proba_3") AS "Proba_2", sigmoid_calibration_3."Proba_3" / (sigmoid_calibration_3."Proba_0" + sigmoid_calibration_3."Proba_1" + sigmoid_calibration_3."Proba_2" + sigmoid_calibration_3."Proba_3") AS "Proba_3" 
FROM sigmoid_calibration_3)
 SELECT "CalProb_B0"."KEY", "CalProb_B0"."Proba_0", "CalProb_B0"."Proba_1", "CalProb_B0"."Proba_2", "CalProb_B0"."Proba_3" 
FROM (SELECT "CalProb_esu_0"."KEY" AS "KEY", "CalProb_esu_0"."Proba_0" AS "Proba_0", "CalProb_esu_0"."Proba_1" AS "Proba_1", "CalProb_esu_0"."Proba_2" AS "Proba_2", "CalProb_esu_0"."Proba_3" AS "Proba_3" 
FROM (SELECT "Normalized_Probas"."KEY" AS "KEY", "Normalized_Probas"."Proba_0" AS "Proba_0", "Normalized_Probas"."Proba_1" AS "Proba_1", "Normalized_Probas"."Proba_2" AS "Proba_2", "Normalized_Probas"."Proba_3" AS "Proba_3" 
FROM "Normalized_Probas" UNION ALL SELECT "Normalized_Probas_1"."KEY" AS "KEY", "Normalized_Probas_1"."Proba_0" AS "Proba_0", "Normalized_Probas_1"."Proba_1" AS "Proba_1", "Normalized_Probas_1"."Proba_2" AS "Proba_2", "Normalized_Probas_1"."Proba_3" AS "Proba_3" 
FROM "Normalized_Probas_1" UNION ALL SELECT "Normalized_Probas_2"."KEY" AS "KEY", "Normalized_Probas_2"."Proba_0" AS "Proba_0", "Normalized_Probas_2"."Proba_1" AS "Proba_1", "Normalized_Probas_2"."Proba_2" AS "Proba_2", "Normalized_Probas_2"."Proba_3" AS "Proba_3" 
FROM "Normalized_Probas_2" UNION ALL SELECT "Normalized_Probas_3"."KEY" AS "KEY", "Normalized_Probas_3"."Proba_0" AS "Proba_0", "Normalized_Probas_3"."Proba_1" AS "Proba_1", "Normalized_Probas_3"."Proba_2" AS "Proba_2", "Normalized_Probas_3"."Proba_3" AS "Proba_3" 
FROM "Normalized_Probas_3") AS "CalProb_esu_0") AS "CalProb_B0") AS "U"

-- Code For temporary table tmp_20180417002014_u1g6uh_calp part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180417002014_u1g6uh_calp  (
	"KEY" BIGINT, 
	"Proba_0" FLOAT, 
	"Proba_1" FLOAT, 
	"Proba_2" FLOAT, 
	"Proba_3" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180417002014_u1g6uh_calp part 2/2. Populate

INSERT INTO tmp_20180417002014_u1g6uh_calp ("KEY", "Proba_0", "Proba_1", "Proba_2", "Proba_3") SELECT "U"."KEY", "U"."Proba_0", "U"."Proba_1", "U"."Proba_2", "U"."Proba_3" 
FROM (SELECT "CalProb_Union"."KEY", "CalProb_Union"."Proba_0", "CalProb_Union"."Proba_1", "CalProb_Union"."Proba_2", "CalProb_Union"."Proba_3" 
FROM (SELECT "CalProb_EnsembleUnion"."KEY" AS "KEY", "CalProb_EnsembleUnion"."Proba_0" AS "Proba_0", "CalProb_EnsembleUnion"."Proba_1" AS "Proba_1", "CalProb_EnsembleUnion"."Proba_2" AS "Proba_2", "CalProb_EnsembleUnion"."Proba_3" AS "Proba_3" 
FROM (SELECT "CalProb_B0"."KEY" AS "KEY", "CalProb_B0"."Proba_0" AS "Proba_0", "CalProb_B0"."Proba_1" AS "Proba_1", "CalProb_B0"."Proba_2" AS "Proba_2", "CalProb_B0"."Proba_3" AS "Proba_3" 
FROM tmp_20180417002014_yc47mb_calp AS "CalProb_B0") AS "CalProb_EnsembleUnion") AS "CalProb_Union") AS "U"

-- Code For temporary table tmp_20180417002014_5iqnx4_calp part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180417002014_5iqnx4_calp  (
	"KEY" BIGINT, 
	"Proba_0" FLOAT, 
	"Proba_1" FLOAT, 
	"Proba_2" FLOAT, 
	"Proba_3" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180417002014_5iqnx4_calp part 2/2. Populate

INSERT INTO tmp_20180417002014_5iqnx4_calp ("KEY", "Proba_0", "Proba_1", "Proba_2", "Proba_3") SELECT "U"."KEY", "U"."Proba_0", "U"."Proba_1", "U"."Proba_2", "U"."Proba_3" 
FROM (SELECT "CalProb_avg"."KEY", "CalProb_avg"."Proba_0", "CalProb_avg"."Proba_1", "CalProb_avg"."Proba_2", "CalProb_avg"."Proba_3" 
FROM (SELECT "T"."KEY" AS "KEY", CAST("T"."Proba_0" AS FLOAT) AS "Proba_0", CAST("T"."Proba_1" AS FLOAT) AS "Proba_1", CAST("T"."Proba_2" AS FLOAT) AS "Proba_2", CAST("T"."Proba_3" AS FLOAT) AS "Proba_3" 
FROM (SELECT "CalProb_Union"."KEY" AS "KEY", avg(CAST("CalProb_Union"."Proba_0" AS FLOAT)) AS "Proba_0", avg(CAST("CalProb_Union"."Proba_1" AS FLOAT)) AS "Proba_1", avg(CAST("CalProb_Union"."Proba_2" AS FLOAT)) AS "Proba_2", avg(CAST("CalProb_Union"."Proba_3" AS FLOAT)) AS "Proba_3" 
FROM tmp_20180417002014_u1g6uh_calp AS "CalProb_Union" GROUP BY "CalProb_Union"."KEY") AS "T") AS "CalProb_avg") AS "U"

-- Model deployment code

WITH orig_cte AS 
(SELECT "CalProb_avg"."KEY" AS "KEY", CAST(NULL AS FLOAT) AS "Score_0", CAST(NULL AS FLOAT) AS "Score_1", CAST(NULL AS FLOAT) AS "Score_2", CAST(NULL AS FLOAT) AS "Score_3", "CalProb_avg"."Proba_0" AS "Proba_0", "CalProb_avg"."Proba_1" AS "Proba_1", "CalProb_avg"."Proba_2" AS "Proba_2", "CalProb_avg"."Proba_3" AS "Proba_3", CAST(NULL AS FLOAT) AS "LogProba_0", CAST(NULL AS FLOAT) AS "LogProba_1", CAST(NULL AS FLOAT) AS "LogProba_2", CAST(NULL AS FLOAT) AS "LogProba_3", CAST(NULL AS BIGINT) AS "Decision", CAST(NULL AS FLOAT) AS "DecisionProba" 
FROM tmp_20180417002014_5iqnx4_calp AS "CalProb_avg"), 
score_class_union AS 
(SELECT scu."KEY_u" AS "KEY_u", scu."class" AS "class", scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY_u", 0 AS "class", orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 1 AS "class", orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 2 AS "class", orig_cte."LogProba_2" AS "LogProba", orig_cte."Proba_2" AS "Proba", orig_cte."Score_2" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 3 AS "class", orig_cte."LogProba_3" AS "LogProba", orig_cte."Proba_3" AS "Proba", orig_cte."Score_3" AS "Score" 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Score_2" AS "Score_2", orig_cte."Score_3" AS "Score_3", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."Proba_2" AS "Proba_2", orig_cte."Proba_3" AS "Proba_3", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."LogProba_2" AS "LogProba_2", orig_cte."LogProba_3" AS "LogProba_3", orig_cte."Decision" AS "Decision", orig_cte."DecisionProba" AS "DecisionProba", max_select."KEY_m" AS "KEY_m", max_select."max_Proba" AS "max_Proba" 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union."KEY_u" AS "KEY_m", max(score_class_union."Proba") AS "max_Proba" 
FROM score_class_union GROUP BY score_class_union."KEY_u") AS max_select ON orig_cte."KEY" = max_select."KEY_m"), 
union_with_max AS 
(SELECT score_class_union."KEY_u" AS "KEY_u", score_class_union."class" AS "class", score_class_union."LogProba" AS "LogProba", score_class_union."Proba" AS "Proba", score_class_union."Score" AS "Score", score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Proba" AS "max_Proba" 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union."KEY_u" = score_max."KEY"), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Proba" AS "max_Proba", "arg_max_t_Proba"."KEY_Proba" AS "KEY_Proba", "arg_max_t_Proba"."arg_max_Proba" AS "arg_max_Proba" 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max."KEY" AS "KEY_Proba", min(union_with_max."class") AS "arg_max_Proba" 
FROM union_with_max 
WHERE union_with_max."Proba" >= union_with_max."max_Proba" GROUP BY union_with_max."KEY") AS "arg_max_t_Proba" ON score_max."KEY" = "arg_max_t_Proba"."KEY_Proba")
 SELECT arg_max_cte."KEY" AS "KEY", arg_max_cte."Score_0" AS "Score_0", arg_max_cte."Score_1" AS "Score_1", arg_max_cte."Score_2" AS "Score_2", arg_max_cte."Score_3" AS "Score_3", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", arg_max_cte."Proba_2" AS "Proba_2", arg_max_cte."Proba_3" AS "Proba_3", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN ln(arg_max_cte."Proba_0") ELSE -1.79769313486231e+308 END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN ln(arg_max_cte."Proba_1") ELSE -1.79769313486231e+308 END AS "LogProba_1", CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN ln(arg_max_cte."Proba_2") ELSE -1.79769313486231e+308 END AS "LogProba_2", CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN ln(arg_max_cte."Proba_3") ELSE -1.79769313486231e+308 END AS "LogProba_3", arg_max_cte."arg_max_Proba" AS "Decision", arg_max_cte."max_Proba" AS "DecisionProba" 
FROM arg_max_cte