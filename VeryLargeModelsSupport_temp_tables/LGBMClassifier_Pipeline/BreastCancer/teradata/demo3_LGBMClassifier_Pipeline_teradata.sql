-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : LGBMClassifier_Pipeline
-- Dataset : BreastCancer
-- Database : teradata


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180416231659_asuezn_ads_ part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416231659_asuezn_ads_  (
	"KEY" BIGINT, 
	impter_2 FLOAT, 
	impter_3 FLOAT, 
	impter_4 FLOAT, 
	impter_5 FLOAT, 
	impter_6 FLOAT, 
	impter_7 FLOAT, 
	impter_8 FLOAT, 
	impter_9 FLOAT, 
	impter_10 FLOAT, 
	impter_11 FLOAT, 
	impter_12 FLOAT, 
	impter_13 FLOAT, 
	impter_14 FLOAT, 
	impter_15 FLOAT, 
	impter_16 FLOAT, 
	impter_17 FLOAT, 
	impter_18 FLOAT, 
	impter_19 FLOAT, 
	impter_20 FLOAT, 
	impter_21 FLOAT, 
	impter_22 FLOAT, 
	impter_23 FLOAT, 
	impter_24 FLOAT, 
	impter_25 FLOAT, 
	impter_26 FLOAT, 
	impter_27 FLOAT, 
	impter_28 FLOAT, 
	impter_29 FLOAT, 
	impter_30 FLOAT, 
	impter_31 FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416231659_asuezn_ads_ part 2/2. Populate

INSERT INTO tmp_20180416231659_asuezn_ads_ ("KEY", impter_2, impter_3, impter_4, impter_5, impter_6, impter_7, impter_8, impter_9, impter_10, impter_11, impter_12, impter_13, impter_14, impter_15, impter_16, impter_17, impter_18, impter_19, impter_20, impter_21, impter_22, impter_23, impter_24, impter_25, impter_26, impter_27, impter_28, impter_29, impter_30, impter_31) SELECT "U"."KEY", "U".impter_2, "U".impter_3, "U".impter_4, "U".impter_5, "U".impter_6, "U".impter_7, "U".impter_8, "U".impter_9, "U".impter_10, "U".impter_11, "U".impter_12, "U".impter_13, "U".impter_14, "U".impter_15, "U".impter_16, "U".impter_17, "U".impter_18, "U".impter_19, "U".impter_20, "U".impter_21, "U".impter_22, "U".impter_23, "U".impter_24, "U".impter_25, "U".impter_26, "U".impter_27, "U".impter_28, "U".impter_29, "U".impter_30, "U".impter_31 
FROM (SELECT "ADS_imp_1_OUT"."KEY", "ADS_imp_1_OUT".impter_2, "ADS_imp_1_OUT".impter_3, "ADS_imp_1_OUT".impter_4, "ADS_imp_1_OUT".impter_5, "ADS_imp_1_OUT".impter_6, "ADS_imp_1_OUT".impter_7, "ADS_imp_1_OUT".impter_8, "ADS_imp_1_OUT".impter_9, "ADS_imp_1_OUT".impter_10, "ADS_imp_1_OUT".impter_11, "ADS_imp_1_OUT".impter_12, "ADS_imp_1_OUT".impter_13, "ADS_imp_1_OUT".impter_14, "ADS_imp_1_OUT".impter_15, "ADS_imp_1_OUT".impter_16, "ADS_imp_1_OUT".impter_17, "ADS_imp_1_OUT".impter_18, "ADS_imp_1_OUT".impter_19, "ADS_imp_1_OUT".impter_20, "ADS_imp_1_OUT".impter_21, "ADS_imp_1_OUT".impter_22, "ADS_imp_1_OUT".impter_23, "ADS_imp_1_OUT".impter_24, "ADS_imp_1_OUT".impter_25, "ADS_imp_1_OUT".impter_26, "ADS_imp_1_OUT".impter_27, "ADS_imp_1_OUT".impter_28, "ADS_imp_1_OUT".impter_29, "ADS_imp_1_OUT".impter_30, "ADS_imp_1_OUT".impter_31 
FROM (SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 14.077712087912083 ELSE "ADS"."Feature_0" END AS impter_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 19.03905494505495 ELSE "ADS"."Feature_1" END AS impter_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 91.66178021978023 ELSE "ADS"."Feature_2" END AS impter_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 650.9676923076925 ELSE "ADS"."Feature_3" END AS impter_5, CASE WHEN ("ADS"."Feature_4" IS NULL) THEN 0.09642184615384615 ELSE "ADS"."Feature_4" END AS impter_6, CASE WHEN ("ADS"."Feature_5" IS NULL) THEN 0.10441613186813191 ELSE "ADS"."Feature_5" END AS impter_7, CASE WHEN ("ADS"."Feature_6" IS NULL) THEN 0.08826232681318694 ELSE "ADS"."Feature_6" END AS impter_8, CASE WHEN ("ADS"."Feature_7" IS NULL) THEN 0.048516399999999966 ELSE "ADS"."Feature_7" END AS impter_9, CASE WHEN ("ADS"."Feature_8" IS NULL) THEN 0.1815885714285715 ELSE "ADS"."Feature_8" END AS impter_10, CASE WHEN ("ADS"."Feature_9" IS NULL) THEN 0.06294030769230768 ELSE "ADS"."Feature_9" END AS impter_11, CASE WHEN ("ADS"."Feature_10" IS NULL) THEN 0.4099173626373627 ELSE "ADS"."Feature_10" END AS impter_12, CASE WHEN ("ADS"."Feature_11" IS NULL) THEN 1.2170694505494501 ELSE "ADS"."Feature_11" END AS impter_13, CASE WHEN ("ADS"."Feature_12" IS NULL) THEN 2.90524901098901 ELSE "ADS"."Feature_12" END AS impter_14, CASE WHEN ("ADS"."Feature_13" IS NULL) THEN 40.87988571428572 ELSE "ADS"."Feature_13" END AS impter_15, CASE WHEN ("ADS"."Feature_14" IS NULL) THEN 0.007055971428571433 ELSE "ADS"."Feature_14" END AS impter_16, CASE WHEN ("ADS"."Feature_15" IS NULL) THEN 0.025567830769230776 ELSE "ADS"."Feature_15" END AS impter_17, CASE WHEN ("ADS"."Feature_16" IS NULL) THEN 0.03199925626373623 ELSE "ADS"."Feature_16" END AS impter_18, CASE WHEN ("ADS"."Feature_17" IS NULL) THEN 0.011972369230769237 ELSE "ADS"."Feature_17" END AS impter_19, CASE WHEN ("ADS"."Feature_18" IS NULL) THEN 0.020896200000000014 ELSE "ADS"."Feature_18" END AS impter_20, CASE WHEN ("ADS"."Feature_19" IS NULL) THEN 0.0038465518681318647 ELSE "ADS"."Feature_19" END AS impter_21, CASE WHEN ("ADS"."Feature_20" IS NULL) THEN 16.17776483516484 ELSE "ADS"."Feature_20" END AS impter_22, CASE WHEN ("ADS"."Feature_21" IS NULL) THEN 25.26505494505494 ELSE "ADS"."Feature_21" END AS impter_23, CASE WHEN ("ADS"."Feature_22" IS NULL) THEN 106.68156043956041 ELSE "ADS"."Feature_22" END AS impter_24, CASE WHEN ("ADS"."Feature_23" IS NULL) THEN 870.8639560439567 ELSE "ADS"."Feature_23" END AS impter_25, CASE WHEN ("ADS"."Feature_24" IS NULL) THEN 0.1318275604395605 ELSE "ADS"."Feature_24" END AS impter_26, CASE WHEN ("ADS"."Feature_25" IS NULL) THEN 0.24991806593406582 ELSE "ADS"."Feature_25" END AS impter_27, CASE WHEN ("ADS"."Feature_26" IS NULL) THEN 0.2654615934065932 ELSE "ADS"."Feature_26" END AS impter_28, CASE WHEN ("ADS"."Feature_27" IS NULL) THEN 0.11348798021978022 ELSE "ADS"."Feature_27" END AS impter_29, CASE WHEN ("ADS"."Feature_28" IS NULL) THEN 0.2897881318681319 ELSE "ADS"."Feature_28" END AS impter_30, CASE WHEN ("ADS"."Feature_29" IS NULL) THEN 0.08364145054945049 ELSE "ADS"."Feature_29" END AS impter_31 
FROM "BreastCancer" AS "ADS") AS "ADS_imp_1_OUT") AS "U"

-- Code For temporary table tmp_20180416231659_hqabvg_ads_ part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416231659_hqabvg_ads_  (
	"KEY" BIGINT, 
	scaler_2 FLOAT, 
	scaler_3 FLOAT, 
	scaler_4 FLOAT, 
	scaler_5 FLOAT, 
	scaler_6 FLOAT, 
	scaler_7 FLOAT, 
	scaler_8 FLOAT, 
	scaler_9 FLOAT, 
	scaler_10 FLOAT, 
	scaler_11 FLOAT, 
	scaler_12 FLOAT, 
	scaler_13 FLOAT, 
	scaler_14 FLOAT, 
	scaler_15 FLOAT, 
	scaler_16 FLOAT, 
	scaler_17 FLOAT, 
	scaler_18 FLOAT, 
	scaler_19 FLOAT, 
	scaler_20 FLOAT, 
	scaler_21 FLOAT, 
	scaler_22 FLOAT, 
	scaler_23 FLOAT, 
	scaler_24 FLOAT, 
	scaler_25 FLOAT, 
	scaler_26 FLOAT, 
	scaler_27 FLOAT, 
	scaler_28 FLOAT, 
	scaler_29 FLOAT, 
	scaler_30 FLOAT, 
	scaler_31 FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416231659_hqabvg_ads_ part 2/2. Populate

INSERT INTO tmp_20180416231659_hqabvg_ads_ ("KEY", scaler_2, scaler_3, scaler_4, scaler_5, scaler_6, scaler_7, scaler_8, scaler_9, scaler_10, scaler_11, scaler_12, scaler_13, scaler_14, scaler_15, scaler_16, scaler_17, scaler_18, scaler_19, scaler_20, scaler_21, scaler_22, scaler_23, scaler_24, scaler_25, scaler_26, scaler_27, scaler_28, scaler_29, scaler_30, scaler_31) SELECT "U"."KEY", "U".scaler_2, "U".scaler_3, "U".scaler_4, "U".scaler_5, "U".scaler_6, "U".scaler_7, "U".scaler_8, "U".scaler_9, "U".scaler_10, "U".scaler_11, "U".scaler_12, "U".scaler_13, "U".scaler_14, "U".scaler_15, "U".scaler_16, "U".scaler_17, "U".scaler_18, "U".scaler_19, "U".scaler_20, "U".scaler_21, "U".scaler_22, "U".scaler_23, "U".scaler_24, "U".scaler_25, "U".scaler_26, "U".scaler_27, "U".scaler_28, "U".scaler_29, "U".scaler_30, "U".scaler_31 
FROM (SELECT "ADS_sca_2_OUT"."KEY", "ADS_sca_2_OUT".scaler_2, "ADS_sca_2_OUT".scaler_3, "ADS_sca_2_OUT".scaler_4, "ADS_sca_2_OUT".scaler_5, "ADS_sca_2_OUT".scaler_6, "ADS_sca_2_OUT".scaler_7, "ADS_sca_2_OUT".scaler_8, "ADS_sca_2_OUT".scaler_9, "ADS_sca_2_OUT".scaler_10, "ADS_sca_2_OUT".scaler_11, "ADS_sca_2_OUT".scaler_12, "ADS_sca_2_OUT".scaler_13, "ADS_sca_2_OUT".scaler_14, "ADS_sca_2_OUT".scaler_15, "ADS_sca_2_OUT".scaler_16, "ADS_sca_2_OUT".scaler_17, "ADS_sca_2_OUT".scaler_18, "ADS_sca_2_OUT".scaler_19, "ADS_sca_2_OUT".scaler_20, "ADS_sca_2_OUT".scaler_21, "ADS_sca_2_OUT".scaler_22, "ADS_sca_2_OUT".scaler_23, "ADS_sca_2_OUT".scaler_24, "ADS_sca_2_OUT".scaler_25, "ADS_sca_2_OUT".scaler_26, "ADS_sca_2_OUT".scaler_27, "ADS_sca_2_OUT".scaler_28, "ADS_sca_2_OUT".scaler_29, "ADS_sca_2_OUT".scaler_30, "ADS_sca_2_OUT".scaler_31 
FROM (SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".impter_2 AS FLOAT) - 14.077712087912081) / 3.545149298700082 AS scaler_2, (CAST("ADS_imp_1_OUT".impter_3 AS FLOAT) - 19.039054945054946) / 4.16229715042182 AS scaler_3, (CAST("ADS_imp_1_OUT".impter_4 AS FLOAT) - 91.66178021978023) / 24.503971943475648 AS scaler_4, (CAST("ADS_imp_1_OUT".impter_5 AS FLOAT) - 650.9676923076925) / 355.702823163891 AS scaler_5, (CAST("ADS_imp_1_OUT".impter_6 AS FLOAT) - 0.096421846153846) / 0.014197819663072 AS scaler_6, (CAST("ADS_imp_1_OUT".impter_7 AS FLOAT) - 0.104416131868132) / 0.053403694669734 AS scaler_7, (CAST("ADS_imp_1_OUT".impter_8 AS FLOAT) - 0.088262326813187) / 0.081912001626314 AS scaler_8, (CAST("ADS_imp_1_OUT".impter_9 AS FLOAT) - 0.0485164) / 0.03937311739673 AS scaler_9, (CAST("ADS_imp_1_OUT".impter_10 AS FLOAT) - 0.181588571428572) / 0.027790058328748 AS scaler_10, (CAST("ADS_imp_1_OUT".impter_11 AS FLOAT) - 0.062940307692308) / 0.007019354586173 AS scaler_11, (CAST("ADS_imp_1_OUT".impter_12 AS FLOAT) - 0.409917362637363) / 0.29120400836827 AS scaler_12, (CAST("ADS_imp_1_OUT".impter_13 AS FLOAT) - 1.21706945054945) / 0.536389639633626 AS scaler_13, (CAST("ADS_imp_1_OUT".impter_14 AS FLOAT) - 2.90524901098901) / 2.142494429980862 AS scaler_14, (CAST("ADS_imp_1_OUT".impter_15 AS FLOAT) - 40.87988571428572) / 48.224754479577314 AS scaler_15, (CAST("ADS_imp_1_OUT".impter_16 AS FLOAT) - 0.007055971428571) / 0.002863651656569 AS scaler_16, (CAST("ADS_imp_1_OUT".impter_17 AS FLOAT) - 0.025567830769231) / 0.017947013631032 AS scaler_17, (CAST("ADS_imp_1_OUT".impter_18 AS FLOAT) - 0.031999256263736) / 0.031664936721364 AS scaler_18, (CAST("ADS_imp_1_OUT".impter_19 AS FLOAT) - 0.011972369230769) / 0.006392005589397 AS scaler_19, (CAST("ADS_imp_1_OUT".impter_20 AS FLOAT) - 0.0208962) / 0.008582910079869 AS scaler_20, (CAST("ADS_imp_1_OUT".impter_21 AS FLOAT) - 0.003846551868132) / 0.002743607586619 AS scaler_21, (CAST("ADS_imp_1_OUT".impter_22 AS FLOAT) - 16.17776483516484) / 4.817458816201383 AS scaler_22, (CAST("ADS_imp_1_OUT".impter_23 AS FLOAT) - 25.26505494505494) / 5.92332412866667 AS scaler_23, (CAST("ADS_imp_1_OUT".impter_24 AS FLOAT) - 106.68156043956041) / 33.70385837605481 AS scaler_24, (CAST("ADS_imp_1_OUT".impter_25 AS FLOAT) - 870.8639560439567) / 566.9950559872813 AS scaler_25, (CAST("ADS_imp_1_OUT".impter_26 AS FLOAT) - 0.131827560439561) / 0.022748207522289 AS scaler_26, (CAST("ADS_imp_1_OUT".impter_27 AS FLOAT) - 0.249918065934066) / 0.15246893644279 AS scaler_27, (CAST("ADS_imp_1_OUT".impter_28 AS FLOAT) - 0.265461593406593) / 0.206925686782041 AS scaler_28, (CAST("ADS_imp_1_OUT".impter_29 AS FLOAT) - 0.11348798021978) / 0.066381412785207 AS scaler_29, (CAST("ADS_imp_1_OUT".impter_30 AS FLOAT) - 0.289788131868132) / 0.062204706650519 AS scaler_30, (CAST("ADS_imp_1_OUT".impter_31 AS FLOAT) - 0.08364145054945) / 0.017065145806948 AS scaler_31 
FROM tmp_20180416231659_asuezn_ads_ AS "ADS_imp_1_OUT") AS "ADS_sca_2_OUT") AS "U"

-- Code For temporary table tmp_20180416231700_iankvh_lgbm part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416231700_iankvh_lgbm  (
	"KEY" BIGINT, 
	"Score_0" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416231700_iankvh_lgbm part 2/2. Populate

INSERT INTO tmp_20180416231700_iankvh_lgbm ("KEY", "Score_0") SELECT "U"."KEY", "U"."Score_0" 
FROM (WITH "DT_node_lookup" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.481490502222973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.394140780643644) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.122237754819097) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.123709626470165) THEN 16 ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.084681436878409) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.04 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.04 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.1 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.06 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.1 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.080952380952381 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".node_id AS node_id, "DT_node_data".feature AS feature, "DT_node_data"."threshold" AS "threshold", "DT_node_data".depth AS depth, "DT_node_data".parent_id AS parent_id, "DT_node_data"."Score" AS "Score" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".node_id), 
"LGBM_Model_0_0" AS 
(SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."Score" AS "Score_0" 
FROM "DT_Output"), 
"DT_node_lookup_1" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.481490502222973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 0.03868824555771) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.166509623552076) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.83577982482458) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.123709626470165) THEN 34 ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.084681436878409) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_1" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.03872342243694 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.038015466079827 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.09524187224606 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.064157242773797 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.085260818958933 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.09524187224606 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.096677145789133 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_1" AS 
(SELECT "DT_node_lookup_1"."KEY" AS "KEY", "DT_node_lookup_1".node_id_2 AS node_id_2, "DT_node_data_1".node_id AS node_id, "DT_node_data_1".feature AS feature, "DT_node_data_1"."threshold" AS "threshold", "DT_node_data_1".depth AS depth, "DT_node_data_1".parent_id AS parent_id, "DT_node_data_1"."Score" AS "Score" 
FROM "DT_node_lookup_1" LEFT OUTER JOIN "DT_node_data_1" ON "DT_node_lookup_1".node_id_2 = "DT_node_data_1".node_id), 
"LGBM_Model_0_1" AS 
(SELECT "DT_Output_1"."KEY" AS "KEY", "DT_Output_1"."Score" AS "Score_0" 
FROM "DT_Output_1"), 
"DT_node_lookup_2" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.481490502222973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 0.03868824555771) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.122237754819097) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.132748301226025) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.231103005801833) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.808625795814256) THEN 64 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.120334591938066) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.211875047512963) THEN 260 ELSE 261 END ELSE 131 END END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.084681436878409) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.9159805803605) THEN 14 ELSE 15 END END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_2" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.036820304575049 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.036156163482734 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.054007699282571 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.091131780775724 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.091131780775724 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.072357290370034 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.091802597854021 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 64 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.091485482975151 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 131 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 65 AS parent_id, 0.091241560373794 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 260 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 130 AS parent_id, 0.091131780775724 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 261 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 130 AS parent_id, 0.091131780775724 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_2" AS 
(SELECT "DT_node_lookup_2"."KEY" AS "KEY", "DT_node_lookup_2".node_id_2 AS node_id_2, "DT_node_data_2".node_id AS node_id, "DT_node_data_2".feature AS feature, "DT_node_data_2"."threshold" AS "threshold", "DT_node_data_2".depth AS depth, "DT_node_data_2".parent_id AS parent_id, "DT_node_data_2"."Score" AS "Score" 
FROM "DT_node_lookup_2" LEFT OUTER JOIN "DT_node_data_2" ON "DT_node_lookup_2".node_id_2 = "DT_node_data_2".node_id), 
"LGBM_Model_0_2" AS 
(SELECT "DT_Output_2"."KEY" AS "KEY", "DT_Output_2"."Score" AS "Score_0" 
FROM "DT_Output_2"), 
"DT_node_lookup_3" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.481490502222973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.394140780643644) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.132748301226025) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.236853865421935) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.150853763648845) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= -0.134431579379566) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.792770758741113) THEN 136 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.136561865546408) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.03884682814596) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.610467000100544) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.492884518247762) THEN 2192 ELSE 2193 END ELSE 1097 END ELSE 549 END ELSE 275 END END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.084681436878409) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 1.718485569654798) THEN 14 ELSE 15 END END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_3" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.035571968798026 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.034409502171933 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.05079859401203 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.087549100739152 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.087549100739152 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.068876927558094 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.090906272956557 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 69 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 34 AS parent_id, 0.088755384569695 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 136 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 68 AS parent_id, 0.087788707388723 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 275 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 137 AS parent_id, 0.087661711467408 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 549 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 274 AS parent_id, 0.087614513139234 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1097 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 548 AS parent_id, 0.08754617059924 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2192 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1096 AS parent_id, 0.087549100739152 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2193 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1096 AS parent_id, 0.087547863350353 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_3" AS 
(SELECT "DT_node_lookup_3"."KEY" AS "KEY", "DT_node_lookup_3".node_id_2 AS node_id_2, "DT_node_data_3".node_id AS node_id, "DT_node_data_3".feature AS feature, "DT_node_data_3"."threshold" AS "threshold", "DT_node_data_3".depth AS depth, "DT_node_data_3".parent_id AS parent_id, "DT_node_data_3"."Score" AS "Score" 
FROM "DT_node_lookup_3" LEFT OUTER JOIN "DT_node_data_3" ON "DT_node_lookup_3".node_id_2 = "DT_node_data_3".node_id), 
"LGBM_Model_0_3" AS 
(SELECT "DT_Output_3"."KEY" AS "KEY", "DT_Output_3"."Score" AS "Score_0" 
FROM "DT_Output_3"), 
"DT_node_lookup_4" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.481490502222973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 0.03868824555771) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.166509623552076) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 1.277166156771464) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.123709626470165) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.099404459092668) THEN 64 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.808625795814256) THEN 130 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.290062416430746) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.202917218782638) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.258852282571627) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.206800274362294) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.424604575550544) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.46415310332188) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.648128440952994) THEN 16768 ELSE 16769 END ELSE 8385 END ELSE 4193 END ELSE 2097 END ELSE 1049 END ELSE 525 END ELSE 263 END END END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.084681436878409) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 1.832726174457677) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.423070480387637) THEN 28 ELSE 29 END ELSE 15 END END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_4" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.033962863004324 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.032764749644905 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.054646681291946 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.084401502427522 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.074410135702788 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.084401502427522 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.084401502427522 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.087581623963821 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 64 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.08488337578474 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 130 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 65 AS parent_id, 0.084665381813167 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 263 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 131 AS parent_id, 0.084376018280069 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 525 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 262 AS parent_id, 0.084395211162602 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1049 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 524 AS parent_id, 0.08439802349845 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2097 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1048 AS parent_id, 0.084400465063407 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4193 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS depth, 2096 AS parent_id, 0.084401062671782 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8385 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4192 AS parent_id, 0.084401522770248 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16768 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8384 AS parent_id, 0.084401502427522 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16769 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8384 AS parent_id, 0.084401502427522 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_4" AS 
(SELECT "DT_node_lookup_4"."KEY" AS "KEY", "DT_node_lookup_4".node_id_2 AS node_id_2, "DT_node_data_4".node_id AS node_id, "DT_node_data_4".feature AS feature, "DT_node_data_4"."threshold" AS "threshold", "DT_node_data_4".depth AS depth, "DT_node_data_4".parent_id AS parent_id, "DT_node_data_4"."Score" AS "Score" 
FROM "DT_node_lookup_4" LEFT OUTER JOIN "DT_node_data_4" ON "DT_node_lookup_4".node_id_2 = "DT_node_data_4".node_id), 
"LGBM_Model_0_4" AS 
(SELECT "DT_Output_4"."KEY" AS "KEY", "DT_Output_4"."Score" AS "Score_0" 
FROM "DT_Output_4"), 
"DT_node_lookup_5" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.481490502222973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.394140780643644) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.132748301226025) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 1.641401109186068) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.166509623552076) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.943293116747107) THEN 64 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.031885452474783) THEN 130 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.660937164656952) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.774182094586394) THEN 524 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.083025494009142) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.318168746977154) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.349475359427515) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.363471517607261) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.05403299534226) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.765178796376186) THEN 33600 ELSE 33601 END ELSE 16801 END ELSE 8401 END ELSE 4201 END ELSE 2101 END ELSE 1051 END END ELSE 263 END END END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.084681436878409) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_5" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.032876653894358 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.03121269290752 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.081617122023786 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.045206619562706 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.062524468953187 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.085052114134268 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 64 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.083278403122378 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 130 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 65 AS parent_id, 0.08190545585374 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 263 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 131 AS parent_id, 0.08185682540206 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 524 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 262 AS parent_id, 0.081791731697637 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1051 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 525 AS parent_id, 0.081657008189327 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2101 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1050 AS parent_id, 0.081600793102237 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4201 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS depth, 2100 AS parent_id, 0.081613435215722 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8401 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4200 AS parent_id, 0.081616214263045 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16801 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8400 AS parent_id, 0.081617156927764 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33600 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 15 AS depth, 16800 AS parent_id, 0.081617122023786 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33601 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 15 AS depth, 16800 AS parent_id, 0.081617133058247 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_5" AS 
(SELECT "DT_node_lookup_5"."KEY" AS "KEY", "DT_node_lookup_5".node_id_2 AS node_id_2, "DT_node_data_5".node_id AS node_id, "DT_node_data_5".feature AS feature, "DT_node_data_5"."threshold" AS "threshold", "DT_node_data_5".depth AS depth, "DT_node_data_5".parent_id AS parent_id, "DT_node_data_5"."Score" AS "Score" 
FROM "DT_node_lookup_5" LEFT OUTER JOIN "DT_node_data_5" ON "DT_node_lookup_5".node_id_2 = "DT_node_data_5".node_id), 
"LGBM_Model_0_5" AS 
(SELECT "DT_Output_5"."KEY" AS "KEY", "DT_Output_5"."Score" AS "Score_0" 
FROM "DT_Output_5"), 
"DT_node_lookup_6" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.481490502222973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 0.03868824555771) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.166509623552076) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.83577982482458) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.123709626470165) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 1.387854079282782) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.06725255117939) THEN 136 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.676536285896761) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.779595724263018) THEN 548 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.410522020582095) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.91209217899776) THEN 2196 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.113011357807249) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.450803450404135) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= 0.126387030101082) THEN 17576 ELSE 17577 END ELSE 8789 END ELSE 4395 END END ELSE 1099 END END ELSE 275 END END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.181535285728191) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.025814246805817) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 1.549240229206088) THEN 30 ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_6" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.031395079453844 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.030614014856393 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.049351077340024 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.080330994015642 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.068907952284393 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.079139124155677 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.079139124155677 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.083090929956987 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 69 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 34 AS parent_id, 0.079683622846186 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 136 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 68 AS parent_id, 0.079405813882266 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 275 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 137 AS parent_id, 0.07930333675278 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 548 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 274 AS parent_id, 0.079111285102593 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1099 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 549 AS parent_id, 0.079124697986705 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2196 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1098 AS parent_id, 0.079133839821012 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4395 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS depth, 2197 AS parent_id, 0.079135042610355 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8789 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4394 AS parent_id, 0.079137697862791 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17576 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8788 AS parent_id, 0.079139147465174 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17577 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8788 AS parent_id, 0.079138648904816 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_6" AS 
(SELECT "DT_node_lookup_6"."KEY" AS "KEY", "DT_node_lookup_6".node_id_2 AS node_id_2, "DT_node_data_6".node_id AS node_id, "DT_node_data_6".feature AS feature, "DT_node_data_6"."threshold" AS "threshold", "DT_node_data_6".depth AS depth, "DT_node_data_6".parent_id AS parent_id, "DT_node_data_6"."Score" AS "Score" 
FROM "DT_node_lookup_6" LEFT OUTER JOIN "DT_node_data_6" ON "DT_node_lookup_6".node_id_2 = "DT_node_data_6".node_id), 
"LGBM_Model_0_6" AS 
(SELECT "DT_Output_6"."KEY" AS "KEY", "DT_Output_6"."Score" AS "Score_0" 
FROM "DT_Output_6"), 
"DT_node_lookup_7" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.481490502222973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.047172572236715) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.086718921967713) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.224467409551457) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.949626414621215) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.749397209046769) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.06725255117939) THEN 258 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.828559160378474) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.525602617063506) THEN 1036 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.4930575008707) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.413419516333082) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.13528804133447) THEN 8296 ELSE 8297 END ELSE 4149 END ELSE 2075 END END ELSE 519 END END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.084681436878409) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.399454415096405) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.124251852044835) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.150384519010522) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_7" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.016778388263404 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.028086185830407 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.055306028713149 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.07711398978952 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.078968697799269 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.076904330514392 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.07846163444505 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.076921967446683 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.076921967446683 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.077365852740707 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 128 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 64 AS parent_id, 0.077225608764092 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 258 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 129 AS parent_id, 0.077160939841366 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 519 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 259 AS parent_id, 0.077042533273032 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1036 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 518 AS parent_id, 0.076915710868255 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2075 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1037 AS parent_id, 0.076919323913196 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4149 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS depth, 2074 AS parent_id, 0.076920807253841 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8296 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4148 AS parent_id, 0.076922211072279 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8297 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4148 AS parent_id, 0.076921968389434 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_7" AS 
(SELECT "DT_node_lookup_7"."KEY" AS "KEY", "DT_node_lookup_7".node_id_2 AS node_id_2, "DT_node_data_7".node_id AS node_id, "DT_node_data_7".feature AS feature, "DT_node_data_7"."threshold" AS "threshold", "DT_node_data_7".depth AS depth, "DT_node_data_7".parent_id AS parent_id, "DT_node_data_7"."Score" AS "Score" 
FROM "DT_node_lookup_7" LEFT OUTER JOIN "DT_node_data_7" ON "DT_node_lookup_7".node_id_2 = "DT_node_data_7".node_id), 
"LGBM_Model_0_7" AS 
(SELECT "DT_Output_7"."KEY" AS "KEY", "DT_Output_7"."Score" AS "Score_0" 
FROM "DT_Output_7"), 
"DT_node_lookup_8" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.481490502222973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.394140780643644) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.132748301226025) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.236853865421935) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.150853763648845) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.229832614355071) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.949626414621215) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.779831590554985) THEN 272 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -1.322252367598604) THEN 546 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.619755723987532) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -0.678214465428718) THEN 2188 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= 0.340658951723629) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.416070251281072) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.30958743886674) THEN 17512 ELSE 17513 END ELSE 8757 END ELSE 4379 END END ELSE 1095 END END END ELSE 137 END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.181535285728191) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.025814246805817) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.61982685155105) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.437924587285565) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_8" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.030892833830838 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.027649083273577 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.037863760180938 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.076134268483911 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.055770223392602 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.074926391600785 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.080320835993777 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.074928850756124 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.07492871773404 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 69 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 34 AS parent_id, 0.077189290545278 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 137 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 68 AS parent_id, 0.075332013502781 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 272 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 136 AS parent_id, 0.07522097039612 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 546 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 273 AS parent_id, 0.075084759127895 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1095 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 547 AS parent_id, 0.075011964350433 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2188 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1094 AS parent_id, 0.07490211625256 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4379 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS depth, 2189 AS parent_id, 0.074938123822767 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8757 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4378 AS parent_id, 0.074916500889096 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17512 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8756 AS parent_id, 0.074928304402234 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17513 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8756 AS parent_id, 0.074925295495883 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_8" AS 
(SELECT "DT_node_lookup_8"."KEY" AS "KEY", "DT_node_lookup_8".node_id_2 AS node_id_2, "DT_node_data_8".node_id AS node_id, "DT_node_data_8".feature AS feature, "DT_node_data_8"."threshold" AS "threshold", "DT_node_data_8".depth AS depth, "DT_node_data_8".parent_id AS parent_id, "DT_node_data_8"."Score" AS "Score" 
FROM "DT_node_lookup_8" LEFT OUTER JOIN "DT_node_data_8" ON "DT_node_lookup_8".node_id_2 = "DT_node_data_8".node_id), 
"LGBM_Model_0_8" AS 
(SELECT "DT_Output_8"."KEY" AS "KEY", "DT_Output_8"."Score" AS "Score_0" 
FROM "DT_Output_8"), 
"DT_node_lookup_9" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.229007595341761) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.534216104965492) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.166509623552076) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.866335325093167) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.123709626470165) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.141727176342154) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.06725255117939) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.779831590554985) THEN 258 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.971179364699073) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -0.678214465428718) THEN 1036 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.356020195260602) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -1.008426720005061) THEN 4148 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.737525433184068) THEN 8298 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.007879313066281) THEN 16598 ELSE 16599 END END END ELSE 2075 END END ELSE 519 END END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.424961632873787) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.590707822189619) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= 0.239194878443586) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 1.256458334642248) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.062560913259148) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_9" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.042089312546468 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.036906090003175 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.035196824179885 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.081703111546886 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.059677742516905 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.073106134973364 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.08316719964603 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.073128678761426 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.075220943804841 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.073129149020285 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 127 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.073129108313103 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 128 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 64 AS parent_id, 0.073703785476754 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 258 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 129 AS parent_id, 0.07337009415964 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 519 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 259 AS parent_id, 0.07326924597018 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1036 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 518 AS parent_id, 0.073114678560761 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2075 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1037 AS parent_id, 0.073118159077849 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4148 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS depth, 2074 AS parent_id, 0.073123993673355 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8298 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4149 AS parent_id, 0.073127650525083 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16598 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8299 AS parent_id, 0.073129356384104 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16599 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8299 AS parent_id, 0.073128385634789 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_9" AS 
(SELECT "DT_node_lookup_9"."KEY" AS "KEY", "DT_node_lookup_9".node_id_2 AS node_id_2, "DT_node_data_9".node_id AS node_id, "DT_node_data_9".feature AS feature, "DT_node_data_9"."threshold" AS "threshold", "DT_node_data_9".depth AS depth, "DT_node_data_9".parent_id AS parent_id, "DT_node_data_9"."Score" AS "Score" 
FROM "DT_node_lookup_9" LEFT OUTER JOIN "DT_node_data_9" ON "DT_node_lookup_9".node_id_2 = "DT_node_data_9".node_id), 
"LGBM_Model_0_9" AS 
(SELECT "DT_Output_9"."KEY" AS "KEY", "DT_Output_9"."Score" AS "Score_0" 
FROM "DT_Output_9")
 SELECT "LGBM_B0"."KEY", "LGBM_B0"."Score_0" 
FROM (SELECT "LGBM_esu_0"."KEY" AS "KEY", "LGBM_esu_0"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_Model_0_0"."KEY" AS "KEY", "LGBM_Model_0_0"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_0" UNION ALL SELECT "LGBM_Model_0_1"."KEY" AS "KEY", "LGBM_Model_0_1"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_1" UNION ALL SELECT "LGBM_Model_0_2"."KEY" AS "KEY", "LGBM_Model_0_2"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_2" UNION ALL SELECT "LGBM_Model_0_3"."KEY" AS "KEY", "LGBM_Model_0_3"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_3" UNION ALL SELECT "LGBM_Model_0_4"."KEY" AS "KEY", "LGBM_Model_0_4"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_4" UNION ALL SELECT "LGBM_Model_0_5"."KEY" AS "KEY", "LGBM_Model_0_5"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_5" UNION ALL SELECT "LGBM_Model_0_6"."KEY" AS "KEY", "LGBM_Model_0_6"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_6" UNION ALL SELECT "LGBM_Model_0_7"."KEY" AS "KEY", "LGBM_Model_0_7"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_7" UNION ALL SELECT "LGBM_Model_0_8"."KEY" AS "KEY", "LGBM_Model_0_8"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_8" UNION ALL SELECT "LGBM_Model_0_9"."KEY" AS "KEY", "LGBM_Model_0_9"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_9") AS "LGBM_esu_0") AS "LGBM_B0") AS "U"

-- Code For temporary table tmp_20180416231700_eqkm3i_lgbm part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416231700_eqkm3i_lgbm  (
	"KEY" BIGINT, 
	"Score_0" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416231700_eqkm3i_lgbm part 2/2. Populate

INSERT INTO tmp_20180416231700_eqkm3i_lgbm ("KEY", "Score_0") SELECT "U"."KEY", "U"."Score_0" 
FROM (WITH "DT_node_lookup_10" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.481490502222973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.047172572236715) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.086718921967713) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.224467409551457) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.099404459092668) THEN 64 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.833137769898793) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.774182094586394) THEN 260 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= 0.755431425899172) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.952934881498718) THEN 1044 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.4034950220112) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.560555796953347) THEN 4180 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= 0.138507800843476) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.130666979256589) THEN 16724 ELSE 16725 END ELSE 8363 END END ELSE 2091 END END ELSE 523 END END ELSE 131 END END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.084681436878409) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 0.276256454623401) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.337638969521536) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 1.237630749386758) THEN 60 ELSE 61 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.313098935529795) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 1.256458334642248) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_10" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.016514786348658 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.024143621578848 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.049959291373931 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.072638373649394 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.073704316613357 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.073230874767104 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.071409741822702 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.071496037606552 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.071535335070704 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 64 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.072179039017908 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.071485305029742 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 127 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.071498143450955 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 131 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 65 AS parent_id, 0.071970934903361 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 260 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 130 AS parent_id, 0.071716613765355 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 523 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 261 AS parent_id, 0.071587297920013 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1044 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 522 AS parent_id, 0.071525353188118 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2091 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1045 AS parent_id, 0.071483030586817 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4180 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS depth, 2090 AS parent_id, 0.071492627300418 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8363 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4181 AS parent_id, 0.071496159949159 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16724 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8362 AS parent_id, 0.07149806654726 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16725 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8362 AS parent_id, 0.071497256966436 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_10" AS 
(SELECT "DT_node_lookup_10"."KEY" AS "KEY", "DT_node_lookup_10".node_id_2 AS node_id_2, "DT_node_data_10".node_id AS node_id, "DT_node_data_10".feature AS feature, "DT_node_data_10"."threshold" AS "threshold", "DT_node_data_10".depth AS depth, "DT_node_data_10".parent_id AS parent_id, "DT_node_data_10"."Score" AS "Score" 
FROM "DT_node_lookup_10" LEFT OUTER JOIN "DT_node_data_10" ON "DT_node_lookup_10".node_id_2 = "DT_node_data_10".node_id), 
"LGBM_Model_0_10" AS 
(SELECT "DT_Output_10"."KEY" AS "KEY", "DT_Output_10"."Score" AS "Score_0" 
FROM "DT_Output_10"), 
"DT_node_lookup_11" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.229007595341761) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.534216104965492) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.166509623552076) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.866335325093167) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.123709626470165) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.141727176342154) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.06725255117939) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.779831590554985) THEN 258 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.971179364699073) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.258852282571627) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -0.678214465428718) THEN 2072 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -1.008426720005061) THEN 4146 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= -0.791997867146758) THEN 8294 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.483774069273192) THEN 16590 ELSE 16591 END END END END ELSE 1037 END ELSE 519 END END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.424961632873787) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.590707822189619) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= 0.239194878443586) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= 0.778802874399108) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.427959875212109) THEN 124 ELSE 125 END ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_11" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.038964009177836 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.034261966311745 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.032855466879346 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.078574535776006 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.056236924048336 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.069994929236228 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.079496989690776 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.07001313721575 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.072184467116203 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 124 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.070014934878857 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 125 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.070014369517136 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 128 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 64 AS parent_id, 0.070485561081038 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 258 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 129 AS parent_id, 0.070211471864568 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 519 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 259 AS parent_id, 0.070131569001507 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1037 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 518 AS parent_id, 0.069990944768366 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2072 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1036 AS parent_id, 0.070001358844656 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4146 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS depth, 2073 AS parent_id, 0.07000980975147 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8294 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4147 AS parent_id, 0.070014776411392 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16590 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8295 AS parent_id, 0.070014383519369 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16591 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8295 AS parent_id, 0.070012824463404 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_11" AS 
(SELECT "DT_node_lookup_11"."KEY" AS "KEY", "DT_node_lookup_11".node_id_2 AS node_id_2, "DT_node_data_11".node_id AS node_id, "DT_node_data_11".feature AS feature, "DT_node_data_11"."threshold" AS "threshold", "DT_node_data_11".depth AS depth, "DT_node_data_11".parent_id AS parent_id, "DT_node_data_11"."Score" AS "Score" 
FROM "DT_node_lookup_11" LEFT OUTER JOIN "DT_node_data_11" ON "DT_node_lookup_11".node_id_2 = "DT_node_data_11".node_id), 
"LGBM_Model_0_11" AS 
(SELECT "DT_Output_11"."KEY" AS "KEY", "DT_Output_11"."Score" AS "Score_0" 
FROM "DT_Output_11"), 
"DT_node_lookup_12" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.481490502222973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.047172572236715) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.086718921967713) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.224467409551457) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.866335325093167) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.06725255117939) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.779831590554985) THEN 258 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.971179364699073) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.308390012738007) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.545991971999246) THEN 2072 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= 0.21598734959929) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.698216692031296) THEN 8292 ELSE 8293 END ELSE 4147 END END ELSE 1037 END ELSE 519 END END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.084681436878409) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 0.276256454623401) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.337638969521536) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 1.099014951499015) THEN 60 ELSE 61 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.540691832235398) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.723924806066296) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_12" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.01507662888038 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.022017427329214 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.046524181609464 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.07039083550484 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.071009510185524 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.07022428794675 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.068523665965854 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.068659626828407 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.068729930293057 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.06948505898906 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.068642685549915 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 127 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.068661189824275 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 128 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 64 AS parent_id, 0.069065716147088 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 258 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 129 AS parent_id, 0.068841326846656 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 519 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 259 AS parent_id, 0.068768122152481 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1037 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 518 AS parent_id, 0.068646892788223 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2072 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1036 AS parent_id, 0.068655213158686 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4147 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS depth, 2073 AS parent_id, 0.068659190112928 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8292 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4146 AS parent_id, 0.068661273287687 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8293 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4146 AS parent_id, 0.068660565450333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_12" AS 
(SELECT "DT_node_lookup_12"."KEY" AS "KEY", "DT_node_lookup_12".node_id_2 AS node_id_2, "DT_node_data_12".node_id AS node_id, "DT_node_data_12".feature AS feature, "DT_node_data_12"."threshold" AS "threshold", "DT_node_data_12".depth AS depth, "DT_node_data_12".parent_id AS parent_id, "DT_node_data_12"."Score" AS "Score" 
FROM "DT_node_lookup_12" LEFT OUTER JOIN "DT_node_data_12" ON "DT_node_lookup_12".node_id_2 = "DT_node_data_12".node_id), 
"LGBM_Model_0_12" AS 
(SELECT "DT_Output_12"."KEY" AS "KEY", "DT_Output_12"."Score" AS "Score_0" 
FROM "DT_Output_12"), 
"DT_node_lookup_13" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.229007595341761) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.534216104965492) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.166509623552076) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.866335325093167) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.123709626470165) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.141727176342154) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.06725255117939) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.779831590554985) THEN 258 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.971179364699073) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.258852282571627) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -0.678214465428718) THEN 2072 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -1.008426720005061) THEN 4146 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= -0.791997867146758) THEN 8294 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.483774069273192) THEN 16590 ELSE 16591 END END END END ELSE 1037 END ELSE 519 END END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.424961632873787) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.590707822189619) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 1.00043262656228) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.188039450377325) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 1.365376006716602) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_13" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.03611097851582 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.031819323135533 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.03068749502889 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.075939833328597 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.053165773342762 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.067405494367058 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.07648150800105 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.067420307243442 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.069641134045665 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.06742374825495 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 127 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.067422739453175 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 128 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 64 AS parent_id, 0.067814252823722 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 258 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 129 AS parent_id, 0.067585829873953 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 519 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 259 AS parent_id, 0.067520888247947 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1037 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 518 AS parent_id, 0.067394439562186 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2072 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1036 AS parent_id, 0.067408330790669 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4146 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS depth, 2073 AS parent_id, 0.067418914145947 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8294 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4147 AS parent_id, 0.067423134521652 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16590 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8295 AS parent_id, 0.067422750697862 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16591 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 14 AS depth, 8295 AS parent_id, 0.067421437880773 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_13" AS 
(SELECT "DT_node_lookup_13"."KEY" AS "KEY", "DT_node_lookup_13".node_id_2 AS node_id_2, "DT_node_data_13".node_id AS node_id, "DT_node_data_13".feature AS feature, "DT_node_data_13"."threshold" AS "threshold", "DT_node_data_13".depth AS depth, "DT_node_data_13".parent_id AS parent_id, "DT_node_data_13"."Score" AS "Score" 
FROM "DT_node_lookup_13" LEFT OUTER JOIN "DT_node_data_13" ON "DT_node_lookup_13".node_id_2 = "DT_node_data_13".node_id), 
"LGBM_Model_0_13" AS 
(SELECT "DT_Output_13"."KEY" AS "KEY", "DT_Output_13"."Score" AS "Score_0" 
FROM "DT_Output_13"), 
"DT_node_lookup_14" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 1.045856164609302) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.188626003552017) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.276620209932995) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= 0.639209961317877) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.248936170724719) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.228910070067684) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.680692048396486) THEN 288 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= 0.227054384492278) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.341578116638559) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.716260277687384) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.72785539910906) THEN 4624 ELSE 4625 END ELSE 2313 END ELSE 1157 END ELSE 579 END END ELSE 145 END ELSE 73 END ELSE 37 END ELSE 19 END END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.0) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.456678528187152) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.590707822189619) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.539129707990552) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.431931983973044) THEN 126 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.488736559415112) THEN 254 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.563668128483355) THEN 510 ELSE 511 END END END END END END END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_14" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, 0.030674450042139 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, 0.017952804520308 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.045632388906517 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.038611390370743 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.081104403108589 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.076999896334681 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.056944838061214 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.070087744597034 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 73 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 36 AS parent_id, 0.07399910716833 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.066281733908603 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 145 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 72 AS parent_id, 0.068532028138534 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 254 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 127 AS parent_id, -0.066287427997186 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 288 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 144 AS parent_id, 0.066407248281092 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 510 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 255 AS parent_id, -0.06628628749894 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 511 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 255 AS parent_id, -0.066287011799428 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 579 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 289 AS parent_id, 0.066375308129059 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1157 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 578 AS parent_id, 0.066250692599202 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2313 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1156 AS parent_id, 0.066316801567398 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4624 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS depth, 2312 AS parent_id, 0.066285874825617 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4625 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS depth, 2312 AS parent_id, 0.066278752575286 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_14" AS 
(SELECT "DT_node_lookup_14"."KEY" AS "KEY", "DT_node_lookup_14".node_id_2 AS node_id_2, "DT_node_data_14".node_id AS node_id, "DT_node_data_14".feature AS feature, "DT_node_data_14"."threshold" AS "threshold", "DT_node_data_14".depth AS depth, "DT_node_data_14".parent_id AS parent_id, "DT_node_data_14"."Score" AS "Score" 
FROM "DT_node_lookup_14" LEFT OUTER JOIN "DT_node_data_14" ON "DT_node_lookup_14".node_id_2 = "DT_node_data_14".node_id), 
"LGBM_Model_0_14" AS 
(SELECT "DT_Output_14"."KEY" AS "KEY", "DT_Output_14"."Score" AS "Score_0" 
FROM "DT_Output_14"), 
"DT_node_lookup_15" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.481490502222973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.181535285728191) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.166509623552076) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.020069408376513) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 1.061894456273984) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.276620209932995) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.06725255117939) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.749397209046769) THEN 258 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= 0.505779543477771) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= -0.10908758520735) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.420735904894618) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -0.386050235037698) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.755157991622432) THEN 8288 ELSE 8289 END ELSE 4145 END ELSE 2073 END ELSE 1037 END ELSE 519 END END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.249868977774157) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.095140679184257) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.143176960560025) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.311234168342968) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 1.026823879159884) THEN 126 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= 0.645968664742461) THEN 254 ELSE 255 END END END END END END END AS node_id_2 
FROM tmp_20180416231659_hqabvg_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_15" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, -0.017762811687231 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.019401130940274 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.035213039116729 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.077395507486498 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.069378446406283 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.053873650540224 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.066735189638677 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.067300018565396 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.066181913506799 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.065082035253674 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 128 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 64 AS parent_id, 0.065835276341645 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 254 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 127 AS parent_id, -0.06524177482726 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 255 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 127 AS parent_id, -0.065242462381578 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 258 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 129 AS parent_id, 0.065468857433438 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 519 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 259 AS parent_id, 0.065338511340144 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1037 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 518 AS parent_id, 0.065290805873208 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2073 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1036 AS parent_id, 0.065197955160014 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4145 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 12 AS depth, 2072 AS parent_id, 0.065269472085041 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8288 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4144 AS parent_id, 0.065241275102916 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8289 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 13 AS depth, 4144 AS parent_id, 0.065230662114447 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_15" AS 
(SELECT "DT_node_lookup_15"."KEY" AS "KEY", "DT_node_lookup_15".node_id_2 AS node_id_2, "DT_node_data_15".node_id AS node_id, "DT_node_data_15".feature AS feature, "DT_node_data_15"."threshold" AS "threshold", "DT_node_data_15".depth AS depth, "DT_node_data_15".parent_id AS parent_id, "DT_node_data_15"."Score" AS "Score" 
FROM "DT_node_lookup_15" LEFT OUTER JOIN "DT_node_data_15" ON "DT_node_lookup_15".node_id_2 = "DT_node_data_15".node_id), 
"LGBM_Model_0_15" AS 
(SELECT "DT_Output_15"."KEY" AS "KEY", "DT_Output_15"."Score" AS "Score_0" 
FROM "DT_Output_15")
 SELECT "LGBM_B1"."KEY", "LGBM_B1"."Score_0" 
FROM (SELECT "LGBM_esu_1"."KEY" AS "KEY", "LGBM_esu_1"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_Model_0_10"."KEY" AS "KEY", "LGBM_Model_0_10"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_10" UNION ALL SELECT "LGBM_Model_0_11"."KEY" AS "KEY", "LGBM_Model_0_11"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_11" UNION ALL SELECT "LGBM_Model_0_12"."KEY" AS "KEY", "LGBM_Model_0_12"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_12" UNION ALL SELECT "LGBM_Model_0_13"."KEY" AS "KEY", "LGBM_Model_0_13"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_13" UNION ALL SELECT "LGBM_Model_0_14"."KEY" AS "KEY", "LGBM_Model_0_14"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_14" UNION ALL SELECT "LGBM_Model_0_15"."KEY" AS "KEY", "LGBM_Model_0_15"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_15") AS "LGBM_esu_1") AS "LGBM_B1") AS "U"

-- Code For temporary table tmp_20180416231700_64kqx5_lgbm part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416231700_64kqx5_lgbm  (
	"KEY" BIGINT, 
	"Score_0" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416231700_64kqx5_lgbm part 2/2. Populate

INSERT INTO tmp_20180416231700_64kqx5_lgbm ("KEY", "Score_0") SELECT "U"."KEY", "U"."Score_0" 
FROM (SELECT "LGBM_Union"."KEY", "LGBM_Union"."Score_0" 
FROM (SELECT "LGBM_EnsembleUnion"."KEY" AS "KEY", "LGBM_EnsembleUnion"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_B0"."KEY" AS "KEY", "LGBM_B0"."Score_0" AS "Score_0" 
FROM tmp_20180416231700_iankvh_lgbm AS "LGBM_B0" UNION ALL SELECT "LGBM_B1"."KEY" AS "KEY", "LGBM_B1"."Score_0" AS "Score_0" 
FROM tmp_20180416231700_eqkm3i_lgbm AS "LGBM_B1") AS "LGBM_EnsembleUnion") AS "LGBM_Union") AS "U"

-- Code For temporary table tmp_20180416231700_vpow7p_lgbm part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416231700_vpow7p_lgbm  (
	"KEY" BIGINT, 
	"Score_0" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416231700_vpow7p_lgbm part 2/2. Populate

INSERT INTO tmp_20180416231700_vpow7p_lgbm ("KEY", "Score_0") SELECT "U"."KEY", "U"."Score_0" 
FROM (SELECT "LGBM_sum"."KEY", "LGBM_sum"."Score_0" 
FROM (SELECT "T"."KEY" AS "KEY", CAST("T"."Score_0" AS FLOAT) AS "Score_0" 
FROM (SELECT "LGBM_Union"."KEY" AS "KEY", sum("LGBM_Union"."Score_0") AS "Score_0" 
FROM tmp_20180416231700_64kqx5_lgbm AS "LGBM_Union" GROUP BY "LGBM_Union"."KEY") AS "T") AS "LGBM_sum") AS "U"

-- Model deployment code

WITH orig_cte AS 
(SELECT "LGBM_sum"."KEY" AS "KEY", "LGBM_sum"."Score_0" AS "Score_0", CAST(NULL AS FLOAT) AS "Score_1", 1.0 - 1.0 / (1.0 + exp(least(greatest(-100.0, -"LGBM_sum"."Score_0"), 100.0))) AS "Proba_0", 1.0 / (1.0 + exp(least(greatest(-100.0, -"LGBM_sum"."Score_0"), 100.0))) AS "Proba_1", CAST(NULL AS FLOAT) AS "LogProba_0", CAST(NULL AS FLOAT) AS "LogProba_1", CAST(NULL AS BIGINT) AS "Decision", CAST(NULL AS FLOAT) AS "DecisionProba" 
FROM tmp_20180416231700_vpow7p_lgbm AS "LGBM_sum"), 
score_class_union AS 
(SELECT scu."KEY_u" AS "KEY_u", scu."class" AS "class", scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY_u", 0 AS "class", orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 1 AS "class", orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."Decision" AS "Decision", orig_cte."DecisionProba" AS "DecisionProba", max_select."KEY_m" AS "KEY_m", max_select."max_Proba" AS "max_Proba" 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union."KEY_u" AS "KEY_m", max(score_class_union."Proba") AS "max_Proba" 
FROM score_class_union GROUP BY score_class_union."KEY_u") AS max_select ON orig_cte."KEY" = max_select."KEY_m"), 
union_with_max AS 
(SELECT score_class_union."KEY_u" AS "KEY_u", score_class_union."class" AS "class", score_class_union."LogProba" AS "LogProba", score_class_union."Proba" AS "Proba", score_class_union."Score" AS "Score", score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Proba" AS "max_Proba" 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union."KEY_u" = score_max."KEY"), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Proba" AS "max_Proba", "arg_max_t_Proba"."KEY_Proba" AS "KEY_Proba", "arg_max_t_Proba"."arg_max_Proba" AS "arg_max_Proba" 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max."KEY" AS "KEY_Proba", min(union_with_max."class") AS "arg_max_Proba" 
FROM union_with_max 
WHERE union_with_max."max_Proba" <= union_with_max."Proba" GROUP BY union_with_max."KEY") AS "arg_max_t_Proba" ON score_max."KEY" = "arg_max_t_Proba"."KEY_Proba")
 SELECT arg_max_cte."KEY" AS "KEY", CAST(NULL AS FLOAT) AS "Score_0", CAST(NULL AS FLOAT) AS "Score_1", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN ln(arg_max_cte."Proba_0") ELSE -1.79769313486231e+308 END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN ln(arg_max_cte."Proba_1") ELSE -1.79769313486231e+308 END AS "LogProba_1", arg_max_cte."arg_max_Proba" AS "Decision", arg_max_cte."max_Proba" AS "DecisionProba" 
FROM arg_max_cte