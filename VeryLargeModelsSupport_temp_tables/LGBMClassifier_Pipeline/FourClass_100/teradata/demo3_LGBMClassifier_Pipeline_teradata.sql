-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : LGBMClassifier_Pipeline
-- Dataset : FourClass_100
-- Database : teradata


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180416233645_c5vukt_ads_ part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416233645_c5vukt_ads_  (
	"KEY" BIGINT, 
	impter_2 FLOAT, 
	impter_3 FLOAT, 
	impter_4 FLOAT, 
	impter_5 FLOAT, 
	impter_6 FLOAT, 
	impter_7 FLOAT, 
	impter_8 FLOAT, 
	impter_9 FLOAT, 
	impter_10 FLOAT, 
	impter_11 FLOAT, 
	impter_12 FLOAT, 
	impter_13 FLOAT, 
	impter_14 FLOAT, 
	impter_15 FLOAT, 
	impter_16 FLOAT, 
	impter_17 FLOAT, 
	impter_18 FLOAT, 
	impter_19 FLOAT, 
	impter_20 FLOAT, 
	impter_21 FLOAT, 
	impter_22 FLOAT, 
	impter_23 FLOAT, 
	impter_24 FLOAT, 
	impter_25 FLOAT, 
	impter_26 FLOAT, 
	impter_27 FLOAT, 
	impter_28 FLOAT, 
	impter_29 FLOAT, 
	impter_30 FLOAT, 
	impter_31 FLOAT, 
	impter_32 FLOAT, 
	impter_33 FLOAT, 
	impter_34 FLOAT, 
	impter_35 FLOAT, 
	impter_36 FLOAT, 
	impter_37 FLOAT, 
	impter_38 FLOAT, 
	impter_39 FLOAT, 
	impter_40 FLOAT, 
	impter_41 FLOAT, 
	impter_42 FLOAT, 
	impter_43 FLOAT, 
	impter_44 FLOAT, 
	impter_45 FLOAT, 
	impter_46 FLOAT, 
	impter_47 FLOAT, 
	impter_48 FLOAT, 
	impter_49 FLOAT, 
	impter_50 FLOAT, 
	impter_51 FLOAT, 
	impter_52 FLOAT, 
	impter_53 FLOAT, 
	impter_54 FLOAT, 
	impter_55 FLOAT, 
	impter_56 FLOAT, 
	impter_57 FLOAT, 
	impter_58 FLOAT, 
	impter_59 FLOAT, 
	impter_60 FLOAT, 
	impter_61 FLOAT, 
	impter_62 FLOAT, 
	impter_63 FLOAT, 
	impter_64 FLOAT, 
	impter_65 FLOAT, 
	impter_66 FLOAT, 
	impter_67 FLOAT, 
	impter_68 FLOAT, 
	impter_69 FLOAT, 
	impter_70 FLOAT, 
	impter_71 FLOAT, 
	impter_72 FLOAT, 
	impter_73 FLOAT, 
	impter_74 FLOAT, 
	impter_75 FLOAT, 
	impter_76 FLOAT, 
	impter_77 FLOAT, 
	impter_78 FLOAT, 
	impter_79 FLOAT, 
	impter_80 FLOAT, 
	impter_81 FLOAT, 
	impter_82 FLOAT, 
	impter_83 FLOAT, 
	impter_84 FLOAT, 
	impter_85 FLOAT, 
	impter_86 FLOAT, 
	impter_87 FLOAT, 
	impter_88 FLOAT, 
	impter_89 FLOAT, 
	impter_90 FLOAT, 
	impter_91 FLOAT, 
	impter_92 FLOAT, 
	impter_93 FLOAT, 
	impter_94 FLOAT, 
	impter_95 FLOAT, 
	impter_96 FLOAT, 
	impter_97 FLOAT, 
	impter_98 FLOAT, 
	impter_99 FLOAT, 
	impter_100 FLOAT, 
	impter_101 FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416233645_c5vukt_ads_ part 2/2. Populate

INSERT INTO tmp_20180416233645_c5vukt_ads_ ("KEY", impter_2, impter_3, impter_4, impter_5, impter_6, impter_7, impter_8, impter_9, impter_10, impter_11, impter_12, impter_13, impter_14, impter_15, impter_16, impter_17, impter_18, impter_19, impter_20, impter_21, impter_22, impter_23, impter_24, impter_25, impter_26, impter_27, impter_28, impter_29, impter_30, impter_31, impter_32, impter_33, impter_34, impter_35, impter_36, impter_37, impter_38, impter_39, impter_40, impter_41, impter_42, impter_43, impter_44, impter_45, impter_46, impter_47, impter_48, impter_49, impter_50, impter_51, impter_52, impter_53, impter_54, impter_55, impter_56, impter_57, impter_58, impter_59, impter_60, impter_61, impter_62, impter_63, impter_64, impter_65, impter_66, impter_67, impter_68, impter_69, impter_70, impter_71, impter_72, impter_73, impter_74, impter_75, impter_76, impter_77, impter_78, impter_79, impter_80, impter_81, impter_82, impter_83, impter_84, impter_85, impter_86, impter_87, impter_88, impter_89, impter_90, impter_91, impter_92, impter_93, impter_94, impter_95, impter_96, impter_97, impter_98, impter_99, impter_100, impter_101) SELECT "U"."KEY", "U".impter_2, "U".impter_3, "U".impter_4, "U".impter_5, "U".impter_6, "U".impter_7, "U".impter_8, "U".impter_9, "U".impter_10, "U".impter_11, "U".impter_12, "U".impter_13, "U".impter_14, "U".impter_15, "U".impter_16, "U".impter_17, "U".impter_18, "U".impter_19, "U".impter_20, "U".impter_21, "U".impter_22, "U".impter_23, "U".impter_24, "U".impter_25, "U".impter_26, "U".impter_27, "U".impter_28, "U".impter_29, "U".impter_30, "U".impter_31, "U".impter_32, "U".impter_33, "U".impter_34, "U".impter_35, "U".impter_36, "U".impter_37, "U".impter_38, "U".impter_39, "U".impter_40, "U".impter_41, "U".impter_42, "U".impter_43, "U".impter_44, "U".impter_45, "U".impter_46, "U".impter_47, "U".impter_48, "U".impter_49, "U".impter_50, "U".impter_51, "U".impter_52, "U".impter_53, "U".impter_54, "U".impter_55, "U".impter_56, "U".impter_57, "U".impter_58, "U".impter_59, "U".impter_60, "U".impter_61, "U".impter_62, "U".impter_63, "U".impter_64, "U".impter_65, "U".impter_66, "U".impter_67, "U".impter_68, "U".impter_69, "U".impter_70, "U".impter_71, "U".impter_72, "U".impter_73, "U".impter_74, "U".impter_75, "U".impter_76, "U".impter_77, "U".impter_78, "U".impter_79, "U".impter_80, "U".impter_81, "U".impter_82, "U".impter_83, "U".impter_84, "U".impter_85, "U".impter_86, "U".impter_87, "U".impter_88, "U".impter_89, "U".impter_90, "U".impter_91, "U".impter_92, "U".impter_93, "U".impter_94, "U".impter_95, "U".impter_96, "U".impter_97, "U".impter_98, "U".impter_99, "U".impter_100, "U".impter_101 
FROM (SELECT "ADS_imp_1_OUT"."KEY", "ADS_imp_1_OUT".impter_2, "ADS_imp_1_OUT".impter_3, "ADS_imp_1_OUT".impter_4, "ADS_imp_1_OUT".impter_5, "ADS_imp_1_OUT".impter_6, "ADS_imp_1_OUT".impter_7, "ADS_imp_1_OUT".impter_8, "ADS_imp_1_OUT".impter_9, "ADS_imp_1_OUT".impter_10, "ADS_imp_1_OUT".impter_11, "ADS_imp_1_OUT".impter_12, "ADS_imp_1_OUT".impter_13, "ADS_imp_1_OUT".impter_14, "ADS_imp_1_OUT".impter_15, "ADS_imp_1_OUT".impter_16, "ADS_imp_1_OUT".impter_17, "ADS_imp_1_OUT".impter_18, "ADS_imp_1_OUT".impter_19, "ADS_imp_1_OUT".impter_20, "ADS_imp_1_OUT".impter_21, "ADS_imp_1_OUT".impter_22, "ADS_imp_1_OUT".impter_23, "ADS_imp_1_OUT".impter_24, "ADS_imp_1_OUT".impter_25, "ADS_imp_1_OUT".impter_26, "ADS_imp_1_OUT".impter_27, "ADS_imp_1_OUT".impter_28, "ADS_imp_1_OUT".impter_29, "ADS_imp_1_OUT".impter_30, "ADS_imp_1_OUT".impter_31, "ADS_imp_1_OUT".impter_32, "ADS_imp_1_OUT".impter_33, "ADS_imp_1_OUT".impter_34, "ADS_imp_1_OUT".impter_35, "ADS_imp_1_OUT".impter_36, "ADS_imp_1_OUT".impter_37, "ADS_imp_1_OUT".impter_38, "ADS_imp_1_OUT".impter_39, "ADS_imp_1_OUT".impter_40, "ADS_imp_1_OUT".impter_41, "ADS_imp_1_OUT".impter_42, "ADS_imp_1_OUT".impter_43, "ADS_imp_1_OUT".impter_44, "ADS_imp_1_OUT".impter_45, "ADS_imp_1_OUT".impter_46, "ADS_imp_1_OUT".impter_47, "ADS_imp_1_OUT".impter_48, "ADS_imp_1_OUT".impter_49, "ADS_imp_1_OUT".impter_50, "ADS_imp_1_OUT".impter_51, "ADS_imp_1_OUT".impter_52, "ADS_imp_1_OUT".impter_53, "ADS_imp_1_OUT".impter_54, "ADS_imp_1_OUT".impter_55, "ADS_imp_1_OUT".impter_56, "ADS_imp_1_OUT".impter_57, "ADS_imp_1_OUT".impter_58, "ADS_imp_1_OUT".impter_59, "ADS_imp_1_OUT".impter_60, "ADS_imp_1_OUT".impter_61, "ADS_imp_1_OUT".impter_62, "ADS_imp_1_OUT".impter_63, "ADS_imp_1_OUT".impter_64, "ADS_imp_1_OUT".impter_65, "ADS_imp_1_OUT".impter_66, "ADS_imp_1_OUT".impter_67, "ADS_imp_1_OUT".impter_68, "ADS_imp_1_OUT".impter_69, "ADS_imp_1_OUT".impter_70, "ADS_imp_1_OUT".impter_71, "ADS_imp_1_OUT".impter_72, "ADS_imp_1_OUT".impter_73, "ADS_imp_1_OUT".impter_74, "ADS_imp_1_OUT".impter_75, "ADS_imp_1_OUT".impter_76, "ADS_imp_1_OUT".impter_77, "ADS_imp_1_OUT".impter_78, "ADS_imp_1_OUT".impter_79, "ADS_imp_1_OUT".impter_80, "ADS_imp_1_OUT".impter_81, "ADS_imp_1_OUT".impter_82, "ADS_imp_1_OUT".impter_83, "ADS_imp_1_OUT".impter_84, "ADS_imp_1_OUT".impter_85, "ADS_imp_1_OUT".impter_86, "ADS_imp_1_OUT".impter_87, "ADS_imp_1_OUT".impter_88, "ADS_imp_1_OUT".impter_89, "ADS_imp_1_OUT".impter_90, "ADS_imp_1_OUT".impter_91, "ADS_imp_1_OUT".impter_92, "ADS_imp_1_OUT".impter_93, "ADS_imp_1_OUT".impter_94, "ADS_imp_1_OUT".impter_95, "ADS_imp_1_OUT".impter_96, "ADS_imp_1_OUT".impter_97, "ADS_imp_1_OUT".impter_98, "ADS_imp_1_OUT".impter_99, "ADS_imp_1_OUT".impter_100, "ADS_imp_1_OUT".impter_101 
FROM (SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 0.006535740121159998 ELSE "ADS"."Feature_0" END AS impter_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 0.16767827125978743 ELSE "ADS"."Feature_1" END AS impter_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN -0.05514704173583139 ELSE "ADS"."Feature_2" END AS impter_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 0.0015211693051869056 ELSE "ADS"."Feature_3" END AS impter_5, CASE WHEN ("ADS"."Feature_4" IS NULL) THEN 0.03142760191039923 ELSE "ADS"."Feature_4" END AS impter_6, CASE WHEN ("ADS"."Feature_5" IS NULL) THEN 0.026179683178748685 ELSE "ADS"."Feature_5" END AS impter_7, CASE WHEN ("ADS"."Feature_6" IS NULL) THEN -0.011254713122120081 ELSE "ADS"."Feature_6" END AS impter_8, CASE WHEN ("ADS"."Feature_7" IS NULL) THEN -0.016886211800947296 ELSE "ADS"."Feature_7" END AS impter_9, CASE WHEN ("ADS"."Feature_8" IS NULL) THEN -0.027342702964496257 ELSE "ADS"."Feature_8" END AS impter_10, CASE WHEN ("ADS"."Feature_9" IS NULL) THEN -0.16370127884822097 ELSE "ADS"."Feature_9" END AS impter_11, CASE WHEN ("ADS"."Feature_10" IS NULL) THEN 0.03541225073893643 ELSE "ADS"."Feature_10" END AS impter_12, CASE WHEN ("ADS"."Feature_11" IS NULL) THEN -0.028529123475633158 ELSE "ADS"."Feature_11" END AS impter_13, CASE WHEN ("ADS"."Feature_12" IS NULL) THEN -0.026749444989609742 ELSE "ADS"."Feature_12" END AS impter_14, CASE WHEN ("ADS"."Feature_13" IS NULL) THEN 0.38601982291131526 ELSE "ADS"."Feature_13" END AS impter_15, CASE WHEN ("ADS"."Feature_14" IS NULL) THEN 0.01621452573135814 ELSE "ADS"."Feature_14" END AS impter_16, CASE WHEN ("ADS"."Feature_15" IS NULL) THEN 0.22723775077839256 ELSE "ADS"."Feature_15" END AS impter_17, CASE WHEN ("ADS"."Feature_16" IS NULL) THEN 0.5663734566941232 ELSE "ADS"."Feature_16" END AS impter_18, CASE WHEN ("ADS"."Feature_17" IS NULL) THEN 0.2776964106161551 ELSE "ADS"."Feature_17" END AS impter_19, CASE WHEN ("ADS"."Feature_18" IS NULL) THEN 0.005994326812351447 ELSE "ADS"."Feature_18" END AS impter_20, CASE WHEN ("ADS"."Feature_19" IS NULL) THEN -0.021852534469692157 ELSE "ADS"."Feature_19" END AS impter_21, CASE WHEN ("ADS"."Feature_20" IS NULL) THEN -0.028375425917008895 ELSE "ADS"."Feature_20" END AS impter_22, CASE WHEN ("ADS"."Feature_21" IS NULL) THEN 0.015164323296291698 ELSE "ADS"."Feature_21" END AS impter_23, CASE WHEN ("ADS"."Feature_22" IS NULL) THEN 0.017469134548764743 ELSE "ADS"."Feature_22" END AS impter_24, CASE WHEN ("ADS"."Feature_23" IS NULL) THEN 0.03493909449429536 ELSE "ADS"."Feature_23" END AS impter_25, CASE WHEN ("ADS"."Feature_24" IS NULL) THEN -0.1443616076343936 ELSE "ADS"."Feature_24" END AS impter_26, CASE WHEN ("ADS"."Feature_25" IS NULL) THEN 0.1461046774436175 ELSE "ADS"."Feature_25" END AS impter_27, CASE WHEN ("ADS"."Feature_26" IS NULL) THEN 0.06761584237384538 ELSE "ADS"."Feature_26" END AS impter_28, CASE WHEN ("ADS"."Feature_27" IS NULL) THEN -0.3083684560804083 ELSE "ADS"."Feature_27" END AS impter_29, CASE WHEN ("ADS"."Feature_28" IS NULL) THEN 0.9525753017609152 ELSE "ADS"."Feature_28" END AS impter_30, CASE WHEN ("ADS"."Feature_29" IS NULL) THEN -0.05813383910109171 ELSE "ADS"."Feature_29" END AS impter_31, CASE WHEN ("ADS"."Feature_30" IS NULL) THEN -0.013124412714914525 ELSE "ADS"."Feature_30" END AS impter_32, CASE WHEN ("ADS"."Feature_31" IS NULL) THEN -0.3375512543306959 ELSE "ADS"."Feature_31" END AS impter_33, CASE WHEN ("ADS"."Feature_32" IS NULL) THEN 0.03902651459317101 ELSE "ADS"."Feature_32" END AS impter_34, CASE WHEN ("ADS"."Feature_33" IS NULL) THEN -0.0402939442131795 ELSE "ADS"."Feature_33" END AS impter_35, CASE WHEN ("ADS"."Feature_34" IS NULL) THEN -0.17161188573704908 ELSE "ADS"."Feature_34" END AS impter_36, CASE WHEN ("ADS"."Feature_35" IS NULL) THEN 0.012647786868640112 ELSE "ADS"."Feature_35" END AS impter_37, CASE WHEN ("ADS"."Feature_36" IS NULL) THEN 0.005193735308514513 ELSE "ADS"."Feature_36" END AS impter_38, CASE WHEN ("ADS"."Feature_37" IS NULL) THEN -0.017160876576937396 ELSE "ADS"."Feature_37" END AS impter_39, CASE WHEN ("ADS"."Feature_38" IS NULL) THEN 0.045036155997948996 ELSE "ADS"."Feature_38" END AS impter_40, CASE WHEN ("ADS"."Feature_39" IS NULL) THEN -0.12035820022636322 ELSE "ADS"."Feature_39" END AS impter_41, CASE WHEN ("ADS"."Feature_40" IS NULL) THEN -0.17640392282213266 ELSE "ADS"."Feature_40" END AS impter_42, CASE WHEN ("ADS"."Feature_41" IS NULL) THEN -0.015157075927040681 ELSE "ADS"."Feature_41" END AS impter_43, CASE WHEN ("ADS"."Feature_42" IS NULL) THEN -0.3068740190578085 ELSE "ADS"."Feature_42" END AS impter_44, CASE WHEN ("ADS"."Feature_43" IS NULL) THEN -0.04035458069305412 ELSE "ADS"."Feature_43" END AS impter_45, CASE WHEN ("ADS"."Feature_44" IS NULL) THEN -0.00789981512459992 ELSE "ADS"."Feature_44" END AS impter_46, CASE WHEN ("ADS"."Feature_45" IS NULL) THEN 0.002647932254171184 ELSE "ADS"."Feature_45" END AS impter_47, CASE WHEN ("ADS"."Feature_46" IS NULL) THEN -0.1492108459830671 ELSE "ADS"."Feature_46" END AS impter_48, CASE WHEN ("ADS"."Feature_47" IS NULL) THEN 0.24895399236878446 ELSE "ADS"."Feature_47" END AS impter_49, CASE WHEN ("ADS"."Feature_48" IS NULL) THEN -0.7004243979718509 ELSE "ADS"."Feature_48" END AS impter_50, CASE WHEN ("ADS"."Feature_49" IS NULL) THEN 0.025527673750135163 ELSE "ADS"."Feature_49" END AS impter_51, CASE WHEN ("ADS"."Feature_50" IS NULL) THEN -0.15642138685028584 ELSE "ADS"."Feature_50" END AS impter_52, CASE WHEN ("ADS"."Feature_51" IS NULL) THEN -0.12783857717811203 ELSE "ADS"."Feature_51" END AS impter_53, CASE WHEN ("ADS"."Feature_52" IS NULL) THEN -0.3698795238326839 ELSE "ADS"."Feature_52" END AS impter_54, CASE WHEN ("ADS"."Feature_53" IS NULL) THEN 0.04105474558890989 ELSE "ADS"."Feature_53" END AS impter_55, CASE WHEN ("ADS"."Feature_54" IS NULL) THEN -0.10047427531359215 ELSE "ADS"."Feature_54" END AS impter_56, CASE WHEN ("ADS"."Feature_55" IS NULL) THEN -0.1312728865356366 ELSE "ADS"."Feature_55" END AS impter_57, CASE WHEN ("ADS"."Feature_56" IS NULL) THEN 0.3685784313653654 ELSE "ADS"."Feature_56" END AS impter_58, CASE WHEN ("ADS"."Feature_57" IS NULL) THEN 0.22281246520596887 ELSE "ADS"."Feature_57" END AS impter_59, CASE WHEN ("ADS"."Feature_58" IS NULL) THEN -0.006274087618403553 ELSE "ADS"."Feature_58" END AS impter_60, CASE WHEN ("ADS"."Feature_59" IS NULL) THEN 0.014268598957774136 ELSE "ADS"."Feature_59" END AS impter_61, CASE WHEN ("ADS"."Feature_60" IS NULL) THEN -0.028545511573860538 ELSE "ADS"."Feature_60" END AS impter_62, CASE WHEN ("ADS"."Feature_61" IS NULL) THEN -0.4374918318496328 ELSE "ADS"."Feature_61" END AS impter_63, CASE WHEN ("ADS"."Feature_62" IS NULL) THEN -0.3689927805875731 ELSE "ADS"."Feature_62" END AS impter_64, CASE WHEN ("ADS"."Feature_63" IS NULL) THEN 0.0011690418193188894 ELSE "ADS"."Feature_63" END AS impter_65, CASE WHEN ("ADS"."Feature_64" IS NULL) THEN -0.011564873717580429 ELSE "ADS"."Feature_64" END AS impter_66, CASE WHEN ("ADS"."Feature_65" IS NULL) THEN -0.04358769989694412 ELSE "ADS"."Feature_65" END AS impter_67, CASE WHEN ("ADS"."Feature_66" IS NULL) THEN -0.1618634137390173 ELSE "ADS"."Feature_66" END AS impter_68, CASE WHEN ("ADS"."Feature_67" IS NULL) THEN -0.01727264153501617 ELSE "ADS"."Feature_67" END AS impter_69, CASE WHEN ("ADS"."Feature_68" IS NULL) THEN -0.36403022036864674 ELSE "ADS"."Feature_68" END AS impter_70, CASE WHEN ("ADS"."Feature_69" IS NULL) THEN -0.049273006502403176 ELSE "ADS"."Feature_69" END AS impter_71, CASE WHEN ("ADS"."Feature_70" IS NULL) THEN -0.015468512657334297 ELSE "ADS"."Feature_70" END AS impter_72, CASE WHEN ("ADS"."Feature_71" IS NULL) THEN -0.19162939351279548 ELSE "ADS"."Feature_71" END AS impter_73, CASE WHEN ("ADS"."Feature_72" IS NULL) THEN 0.023782830321603186 ELSE "ADS"."Feature_72" END AS impter_74, CASE WHEN ("ADS"."Feature_73" IS NULL) THEN 0.020454799672569742 ELSE "ADS"."Feature_73" END AS impter_75, CASE WHEN ("ADS"."Feature_74" IS NULL) THEN -0.17335534659313448 ELSE "ADS"."Feature_74" END AS impter_76, CASE WHEN ("ADS"."Feature_75" IS NULL) THEN 0.02758228824576348 ELSE "ADS"."Feature_75" END AS impter_77, CASE WHEN ("ADS"."Feature_76" IS NULL) THEN -0.015452336678168777 ELSE "ADS"."Feature_76" END AS impter_78, CASE WHEN ("ADS"."Feature_77" IS NULL) THEN -0.0425555457732581 ELSE "ADS"."Feature_77" END AS impter_79, CASE WHEN ("ADS"."Feature_78" IS NULL) THEN -0.009425736580365328 ELSE "ADS"."Feature_78" END AS impter_80, CASE WHEN ("ADS"."Feature_79" IS NULL) THEN 0.007423677489325057 ELSE "ADS"."Feature_79" END AS impter_81, CASE WHEN ("ADS"."Feature_80" IS NULL) THEN 0.0498533264368169 ELSE "ADS"."Feature_80" END AS impter_82, CASE WHEN ("ADS"."Feature_81" IS NULL) THEN 0.027960221179443 ELSE "ADS"."Feature_81" END AS impter_83, CASE WHEN ("ADS"."Feature_82" IS NULL) THEN -0.005270502487579236 ELSE "ADS"."Feature_82" END AS impter_84, CASE WHEN ("ADS"."Feature_83" IS NULL) THEN -0.053393611774246875 ELSE "ADS"."Feature_83" END AS impter_85, CASE WHEN ("ADS"."Feature_84" IS NULL) THEN 0.17162033288561043 ELSE "ADS"."Feature_84" END AS impter_86, CASE WHEN ("ADS"."Feature_85" IS NULL) THEN 0.037211997007404414 ELSE "ADS"."Feature_85" END AS impter_87, CASE WHEN ("ADS"."Feature_86" IS NULL) THEN 0.01843497333044896 ELSE "ADS"."Feature_86" END AS impter_88, CASE WHEN ("ADS"."Feature_87" IS NULL) THEN 0.5605216326173627 ELSE "ADS"."Feature_87" END AS impter_89, CASE WHEN ("ADS"."Feature_88" IS NULL) THEN -0.05285046291900049 ELSE "ADS"."Feature_88" END AS impter_90, CASE WHEN ("ADS"."Feature_89" IS NULL) THEN 0.07939021734244131 ELSE "ADS"."Feature_89" END AS impter_91, CASE WHEN ("ADS"."Feature_90" IS NULL) THEN -2.088667163118704 ELSE "ADS"."Feature_90" END AS impter_92, CASE WHEN ("ADS"."Feature_91" IS NULL) THEN -1.0831020638954625 ELSE "ADS"."Feature_91" END AS impter_93, CASE WHEN ("ADS"."Feature_92" IS NULL) THEN -0.30470236282124374 ELSE "ADS"."Feature_92" END AS impter_94, CASE WHEN ("ADS"."Feature_93" IS NULL) THEN -0.9354262595637257 ELSE "ADS"."Feature_93" END AS impter_95, CASE WHEN ("ADS"."Feature_94" IS NULL) THEN -0.09841121992703274 ELSE "ADS"."Feature_94" END AS impter_96, CASE WHEN ("ADS"."Feature_95" IS NULL) THEN -0.5316534843603434 ELSE "ADS"."Feature_95" END AS impter_97, CASE WHEN ("ADS"."Feature_96" IS NULL) THEN 0.014127422137804999 ELSE "ADS"."Feature_96" END AS impter_98, CASE WHEN ("ADS"."Feature_97" IS NULL) THEN -0.012631277412677116 ELSE "ADS"."Feature_97" END AS impter_99, CASE WHEN ("ADS"."Feature_98" IS NULL) THEN 0.031286881233113274 ELSE "ADS"."Feature_98" END AS impter_100, CASE WHEN ("ADS"."Feature_99" IS NULL) THEN -0.45039051538460234 ELSE "ADS"."Feature_99" END AS impter_101 
FROM "FourClass_100" AS "ADS") AS "ADS_imp_1_OUT") AS "U"

-- Code For temporary table tmp_20180416233645_ppmjc9_ads_ part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416233645_ppmjc9_ads_  (
	"KEY" BIGINT, 
	scaler_2 FLOAT, 
	scaler_3 FLOAT, 
	scaler_4 FLOAT, 
	scaler_5 FLOAT, 
	scaler_6 FLOAT, 
	scaler_7 FLOAT, 
	scaler_8 FLOAT, 
	scaler_9 FLOAT, 
	scaler_10 FLOAT, 
	scaler_11 FLOAT, 
	scaler_12 FLOAT, 
	scaler_13 FLOAT, 
	scaler_14 FLOAT, 
	scaler_15 FLOAT, 
	scaler_16 FLOAT, 
	scaler_17 FLOAT, 
	scaler_18 FLOAT, 
	scaler_19 FLOAT, 
	scaler_20 FLOAT, 
	scaler_21 FLOAT, 
	scaler_22 FLOAT, 
	scaler_23 FLOAT, 
	scaler_24 FLOAT, 
	scaler_25 FLOAT, 
	scaler_26 FLOAT, 
	scaler_27 FLOAT, 
	scaler_28 FLOAT, 
	scaler_29 FLOAT, 
	scaler_30 FLOAT, 
	scaler_31 FLOAT, 
	scaler_32 FLOAT, 
	scaler_33 FLOAT, 
	scaler_34 FLOAT, 
	scaler_35 FLOAT, 
	scaler_36 FLOAT, 
	scaler_37 FLOAT, 
	scaler_38 FLOAT, 
	scaler_39 FLOAT, 
	scaler_40 FLOAT, 
	scaler_41 FLOAT, 
	scaler_42 FLOAT, 
	scaler_43 FLOAT, 
	scaler_44 FLOAT, 
	scaler_45 FLOAT, 
	scaler_46 FLOAT, 
	scaler_47 FLOAT, 
	scaler_48 FLOAT, 
	scaler_49 FLOAT, 
	scaler_50 FLOAT, 
	scaler_51 FLOAT, 
	scaler_52 FLOAT, 
	scaler_53 FLOAT, 
	scaler_54 FLOAT, 
	scaler_55 FLOAT, 
	scaler_56 FLOAT, 
	scaler_57 FLOAT, 
	scaler_58 FLOAT, 
	scaler_59 FLOAT, 
	scaler_60 FLOAT, 
	scaler_61 FLOAT, 
	scaler_62 FLOAT, 
	scaler_63 FLOAT, 
	scaler_64 FLOAT, 
	scaler_65 FLOAT, 
	scaler_66 FLOAT, 
	scaler_67 FLOAT, 
	scaler_68 FLOAT, 
	scaler_69 FLOAT, 
	scaler_70 FLOAT, 
	scaler_71 FLOAT, 
	scaler_72 FLOAT, 
	scaler_73 FLOAT, 
	scaler_74 FLOAT, 
	scaler_75 FLOAT, 
	scaler_76 FLOAT, 
	scaler_77 FLOAT, 
	scaler_78 FLOAT, 
	scaler_79 FLOAT, 
	scaler_80 FLOAT, 
	scaler_81 FLOAT, 
	scaler_82 FLOAT, 
	scaler_83 FLOAT, 
	scaler_84 FLOAT, 
	scaler_85 FLOAT, 
	scaler_86 FLOAT, 
	scaler_87 FLOAT, 
	scaler_88 FLOAT, 
	scaler_89 FLOAT, 
	scaler_90 FLOAT, 
	scaler_91 FLOAT, 
	scaler_92 FLOAT, 
	scaler_93 FLOAT, 
	scaler_94 FLOAT, 
	scaler_95 FLOAT, 
	scaler_96 FLOAT, 
	scaler_97 FLOAT, 
	scaler_98 FLOAT, 
	scaler_99 FLOAT, 
	scaler_100 FLOAT, 
	scaler_101 FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416233645_ppmjc9_ads_ part 2/2. Populate

INSERT INTO tmp_20180416233645_ppmjc9_ads_ ("KEY", scaler_2, scaler_3, scaler_4, scaler_5, scaler_6, scaler_7, scaler_8, scaler_9, scaler_10, scaler_11, scaler_12, scaler_13, scaler_14, scaler_15, scaler_16, scaler_17, scaler_18, scaler_19, scaler_20, scaler_21, scaler_22, scaler_23, scaler_24, scaler_25, scaler_26, scaler_27, scaler_28, scaler_29, scaler_30, scaler_31, scaler_32, scaler_33, scaler_34, scaler_35, scaler_36, scaler_37, scaler_38, scaler_39, scaler_40, scaler_41, scaler_42, scaler_43, scaler_44, scaler_45, scaler_46, scaler_47, scaler_48, scaler_49, scaler_50, scaler_51, scaler_52, scaler_53, scaler_54, scaler_55, scaler_56, scaler_57, scaler_58, scaler_59, scaler_60, scaler_61, scaler_62, scaler_63, scaler_64, scaler_65, scaler_66, scaler_67, scaler_68, scaler_69, scaler_70, scaler_71, scaler_72, scaler_73, scaler_74, scaler_75, scaler_76, scaler_77, scaler_78, scaler_79, scaler_80, scaler_81, scaler_82, scaler_83, scaler_84, scaler_85, scaler_86, scaler_87, scaler_88, scaler_89, scaler_90, scaler_91, scaler_92, scaler_93, scaler_94, scaler_95, scaler_96, scaler_97, scaler_98, scaler_99, scaler_100, scaler_101) SELECT "U"."KEY", "U".scaler_2, "U".scaler_3, "U".scaler_4, "U".scaler_5, "U".scaler_6, "U".scaler_7, "U".scaler_8, "U".scaler_9, "U".scaler_10, "U".scaler_11, "U".scaler_12, "U".scaler_13, "U".scaler_14, "U".scaler_15, "U".scaler_16, "U".scaler_17, "U".scaler_18, "U".scaler_19, "U".scaler_20, "U".scaler_21, "U".scaler_22, "U".scaler_23, "U".scaler_24, "U".scaler_25, "U".scaler_26, "U".scaler_27, "U".scaler_28, "U".scaler_29, "U".scaler_30, "U".scaler_31, "U".scaler_32, "U".scaler_33, "U".scaler_34, "U".scaler_35, "U".scaler_36, "U".scaler_37, "U".scaler_38, "U".scaler_39, "U".scaler_40, "U".scaler_41, "U".scaler_42, "U".scaler_43, "U".scaler_44, "U".scaler_45, "U".scaler_46, "U".scaler_47, "U".scaler_48, "U".scaler_49, "U".scaler_50, "U".scaler_51, "U".scaler_52, "U".scaler_53, "U".scaler_54, "U".scaler_55, "U".scaler_56, "U".scaler_57, "U".scaler_58, "U".scaler_59, "U".scaler_60, "U".scaler_61, "U".scaler_62, "U".scaler_63, "U".scaler_64, "U".scaler_65, "U".scaler_66, "U".scaler_67, "U".scaler_68, "U".scaler_69, "U".scaler_70, "U".scaler_71, "U".scaler_72, "U".scaler_73, "U".scaler_74, "U".scaler_75, "U".scaler_76, "U".scaler_77, "U".scaler_78, "U".scaler_79, "U".scaler_80, "U".scaler_81, "U".scaler_82, "U".scaler_83, "U".scaler_84, "U".scaler_85, "U".scaler_86, "U".scaler_87, "U".scaler_88, "U".scaler_89, "U".scaler_90, "U".scaler_91, "U".scaler_92, "U".scaler_93, "U".scaler_94, "U".scaler_95, "U".scaler_96, "U".scaler_97, "U".scaler_98, "U".scaler_99, "U".scaler_100, "U".scaler_101 
FROM (SELECT "ADS_sca_2_OUT"."KEY", "ADS_sca_2_OUT".scaler_2, "ADS_sca_2_OUT".scaler_3, "ADS_sca_2_OUT".scaler_4, "ADS_sca_2_OUT".scaler_5, "ADS_sca_2_OUT".scaler_6, "ADS_sca_2_OUT".scaler_7, "ADS_sca_2_OUT".scaler_8, "ADS_sca_2_OUT".scaler_9, "ADS_sca_2_OUT".scaler_10, "ADS_sca_2_OUT".scaler_11, "ADS_sca_2_OUT".scaler_12, "ADS_sca_2_OUT".scaler_13, "ADS_sca_2_OUT".scaler_14, "ADS_sca_2_OUT".scaler_15, "ADS_sca_2_OUT".scaler_16, "ADS_sca_2_OUT".scaler_17, "ADS_sca_2_OUT".scaler_18, "ADS_sca_2_OUT".scaler_19, "ADS_sca_2_OUT".scaler_20, "ADS_sca_2_OUT".scaler_21, "ADS_sca_2_OUT".scaler_22, "ADS_sca_2_OUT".scaler_23, "ADS_sca_2_OUT".scaler_24, "ADS_sca_2_OUT".scaler_25, "ADS_sca_2_OUT".scaler_26, "ADS_sca_2_OUT".scaler_27, "ADS_sca_2_OUT".scaler_28, "ADS_sca_2_OUT".scaler_29, "ADS_sca_2_OUT".scaler_30, "ADS_sca_2_OUT".scaler_31, "ADS_sca_2_OUT".scaler_32, "ADS_sca_2_OUT".scaler_33, "ADS_sca_2_OUT".scaler_34, "ADS_sca_2_OUT".scaler_35, "ADS_sca_2_OUT".scaler_36, "ADS_sca_2_OUT".scaler_37, "ADS_sca_2_OUT".scaler_38, "ADS_sca_2_OUT".scaler_39, "ADS_sca_2_OUT".scaler_40, "ADS_sca_2_OUT".scaler_41, "ADS_sca_2_OUT".scaler_42, "ADS_sca_2_OUT".scaler_43, "ADS_sca_2_OUT".scaler_44, "ADS_sca_2_OUT".scaler_45, "ADS_sca_2_OUT".scaler_46, "ADS_sca_2_OUT".scaler_47, "ADS_sca_2_OUT".scaler_48, "ADS_sca_2_OUT".scaler_49, "ADS_sca_2_OUT".scaler_50, "ADS_sca_2_OUT".scaler_51, "ADS_sca_2_OUT".scaler_52, "ADS_sca_2_OUT".scaler_53, "ADS_sca_2_OUT".scaler_54, "ADS_sca_2_OUT".scaler_55, "ADS_sca_2_OUT".scaler_56, "ADS_sca_2_OUT".scaler_57, "ADS_sca_2_OUT".scaler_58, "ADS_sca_2_OUT".scaler_59, "ADS_sca_2_OUT".scaler_60, "ADS_sca_2_OUT".scaler_61, "ADS_sca_2_OUT".scaler_62, "ADS_sca_2_OUT".scaler_63, "ADS_sca_2_OUT".scaler_64, "ADS_sca_2_OUT".scaler_65, "ADS_sca_2_OUT".scaler_66, "ADS_sca_2_OUT".scaler_67, "ADS_sca_2_OUT".scaler_68, "ADS_sca_2_OUT".scaler_69, "ADS_sca_2_OUT".scaler_70, "ADS_sca_2_OUT".scaler_71, "ADS_sca_2_OUT".scaler_72, "ADS_sca_2_OUT".scaler_73, "ADS_sca_2_OUT".scaler_74, "ADS_sca_2_OUT".scaler_75, "ADS_sca_2_OUT".scaler_76, "ADS_sca_2_OUT".scaler_77, "ADS_sca_2_OUT".scaler_78, "ADS_sca_2_OUT".scaler_79, "ADS_sca_2_OUT".scaler_80, "ADS_sca_2_OUT".scaler_81, "ADS_sca_2_OUT".scaler_82, "ADS_sca_2_OUT".scaler_83, "ADS_sca_2_OUT".scaler_84, "ADS_sca_2_OUT".scaler_85, "ADS_sca_2_OUT".scaler_86, "ADS_sca_2_OUT".scaler_87, "ADS_sca_2_OUT".scaler_88, "ADS_sca_2_OUT".scaler_89, "ADS_sca_2_OUT".scaler_90, "ADS_sca_2_OUT".scaler_91, "ADS_sca_2_OUT".scaler_92, "ADS_sca_2_OUT".scaler_93, "ADS_sca_2_OUT".scaler_94, "ADS_sca_2_OUT".scaler_95, "ADS_sca_2_OUT".scaler_96, "ADS_sca_2_OUT".scaler_97, "ADS_sca_2_OUT".scaler_98, "ADS_sca_2_OUT".scaler_99, "ADS_sca_2_OUT".scaler_100, "ADS_sca_2_OUT".scaler_101 
FROM (SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".impter_2 AS FLOAT) - 0.00653574012116) / 0.985821711919416 AS scaler_2, (CAST("ADS_imp_1_OUT".impter_3 AS FLOAT) - 0.167678271259787) / 4.178932779057346 AS scaler_3, (CAST("ADS_imp_1_OUT".impter_4 AS FLOAT) - -0.055147041735831) / 4.08515606391014 AS scaler_4, (CAST("ADS_imp_1_OUT".impter_5 AS FLOAT) - 0.001521169305187) / 1.058399422125588 AS scaler_5, (CAST("ADS_imp_1_OUT".impter_6 AS FLOAT) - 0.031427601910399) / 0.958502901404168 AS scaler_6, (CAST("ADS_imp_1_OUT".impter_7 AS FLOAT) - 0.026179683178749) / 0.993854807715344 AS scaler_7, (CAST("ADS_imp_1_OUT".impter_8 AS FLOAT) - -0.01125471312212) / 0.995945599636728 AS scaler_8, (CAST("ADS_imp_1_OUT".impter_9 AS FLOAT) - -0.016886211800947) / 1.04542967803467 AS scaler_9, (CAST("ADS_imp_1_OUT".impter_10 AS FLOAT) - -0.027342702964496) / 4.331356741820494 AS scaler_10, (CAST("ADS_imp_1_OUT".impter_11 AS FLOAT) - -0.163701278848221) / 4.458898205934484 AS scaler_11, (CAST("ADS_imp_1_OUT".impter_12 AS FLOAT) - 0.035412250738936) / 1.036616487810755 AS scaler_12, (CAST("ADS_imp_1_OUT".impter_13 AS FLOAT) - -0.028529123475633) / 1.004676205552298 AS scaler_13, (CAST("ADS_imp_1_OUT".impter_14 AS FLOAT) - -0.02674944498961) / 0.999624026710058 AS scaler_14, (CAST("ADS_imp_1_OUT".impter_15 AS FLOAT) - 0.386019822911315) / 4.144804786518486 AS scaler_15, (CAST("ADS_imp_1_OUT".impter_16 AS FLOAT) - 0.016214525731358) / 1.017281296667399 AS scaler_16, (CAST("ADS_imp_1_OUT".impter_17 AS FLOAT) - 0.227237750778393) / 4.367112620179618 AS scaler_17, (CAST("ADS_imp_1_OUT".impter_18 AS FLOAT) - 0.566373456694123) / 4.118156884045948 AS scaler_18, (CAST("ADS_imp_1_OUT".impter_19 AS FLOAT) - 0.277696410616155) / 4.014328975715426 AS scaler_19, (CAST("ADS_imp_1_OUT".impter_20 AS FLOAT) - 0.005994326812351) / 0.972439502321079 AS scaler_20, (CAST("ADS_imp_1_OUT".impter_21 AS FLOAT) - -0.021852534469692) / 0.985687517726374 AS scaler_21, (CAST("ADS_imp_1_OUT".impter_22 AS FLOAT) - -0.028375425917009) / 1.023103469868883 AS scaler_22, (CAST("ADS_imp_1_OUT".impter_23 AS FLOAT) - 0.015164323296292) / 4.353145169181992 AS scaler_23, (CAST("ADS_imp_1_OUT".impter_24 AS FLOAT) - 0.017469134548765) / 1.001805654268762 AS scaler_24, (CAST("ADS_imp_1_OUT".impter_25 AS FLOAT) - 0.034939094494295) / 0.992721649767531 AS scaler_25, (CAST("ADS_imp_1_OUT".impter_26 AS FLOAT) - -0.144361607634394) / 4.467397668863504 AS scaler_26, (CAST("ADS_imp_1_OUT".impter_27 AS FLOAT) - 0.146104677443618) / 4.107342778563649 AS scaler_27, (CAST("ADS_imp_1_OUT".impter_28 AS FLOAT) - 0.067615842373845) / 4.277643036456076 AS scaler_28, (CAST("ADS_imp_1_OUT".impter_29 AS FLOAT) - -0.308368456080408) / 4.030195686259092 AS scaler_29, (CAST("ADS_imp_1_OUT".impter_30 AS FLOAT) - 0.952575301760915) / 4.017302623019134 AS scaler_30, (CAST("ADS_imp_1_OUT".impter_31 AS FLOAT) - -0.058133839101092) / 4.03353195749377 AS scaler_31, (CAST("ADS_imp_1_OUT".impter_32 AS FLOAT) - -0.013124412714915) / 0.955198781566282 AS scaler_32, (CAST("ADS_imp_1_OUT".impter_33 AS FLOAT) - -0.337551254330696) / 4.106571680414476 AS scaler_33, (CAST("ADS_imp_1_OUT".impter_34 AS FLOAT) - 0.039026514593171) / 0.990359225336864 AS scaler_34, (CAST("ADS_imp_1_OUT".impter_35 AS FLOAT) - -0.04029394421318) / 1.015296116761204 AS scaler_35, (CAST("ADS_imp_1_OUT".impter_36 AS FLOAT) - -0.171611885737049) / 4.179229563019858 AS scaler_36, (CAST("ADS_imp_1_OUT".impter_37 AS FLOAT) - 0.01264778686864) / 1.007830761864778 AS scaler_37, (CAST("ADS_imp_1_OUT".impter_38 AS FLOAT) - 0.005193735308515) / 4.297332183672822 AS scaler_38, (CAST("ADS_imp_1_OUT".impter_39 AS FLOAT) - -0.017160876576937) / 1.017378855706664 AS scaler_39, (CAST("ADS_imp_1_OUT".impter_40 AS FLOAT) - 0.045036155997949) / 3.904281136786187 AS scaler_40, (CAST("ADS_imp_1_OUT".impter_41 AS FLOAT) - -0.120358200226363) / 3.984028603622864 AS scaler_41, (CAST("ADS_imp_1_OUT".impter_42 AS FLOAT) - -0.176403922822133) / 4.069314637621373 AS scaler_42, (CAST("ADS_imp_1_OUT".impter_43 AS FLOAT) - -0.015157075927041) / 1.029157389545088 AS scaler_43, (CAST("ADS_imp_1_OUT".impter_44 AS FLOAT) - -0.306874019057808) / 4.347912512213832 AS scaler_44, (CAST("ADS_imp_1_OUT".impter_45 AS FLOAT) - -0.040354580693054) / 4.05064377380716 AS scaler_45, (CAST("ADS_imp_1_OUT".impter_46 AS FLOAT) - -0.0078998151246) / 1.006375476591226 AS scaler_46, (CAST("ADS_imp_1_OUT".impter_47 AS FLOAT) - 0.002647932254171) / 1.002144775585071 AS scaler_47, (CAST("ADS_imp_1_OUT".impter_48 AS FLOAT) - -0.149210845983067) / 4.103402009893949 AS scaler_48, (CAST("ADS_imp_1_OUT".impter_49 AS FLOAT) - 0.248953992368784) / 4.232200380326286 AS scaler_49, (CAST("ADS_imp_1_OUT".impter_50 AS FLOAT) - -0.700424397971851) / 4.220766541993596 AS scaler_50, (CAST("ADS_imp_1_OUT".impter_51 AS FLOAT) - 0.025527673750135) / 1.020674092725397 AS scaler_51, (CAST("ADS_imp_1_OUT".impter_52 AS FLOAT) - -0.156421386850286) / 4.078310671245766 AS scaler_52, (CAST("ADS_imp_1_OUT".impter_53 AS FLOAT) - -0.127838577178112) / 4.247236801364964 AS scaler_53, (CAST("ADS_imp_1_OUT".impter_54 AS FLOAT) - -0.369879523832684) / 4.037675848477055 AS scaler_54, (CAST("ADS_imp_1_OUT".impter_55 AS FLOAT) - 0.04105474558891) / 4.445571371438813 AS scaler_55, (CAST("ADS_imp_1_OUT".impter_56 AS FLOAT) - -0.100474275313592) / 4.045836826444958 AS scaler_56, (CAST("ADS_imp_1_OUT".impter_57 AS FLOAT) - -0.131272886535637) / 4.256606009499922 AS scaler_57, (CAST("ADS_imp_1_OUT".impter_58 AS FLOAT) - 0.368578431365365) / 4.04294690880675 AS scaler_58, (CAST("ADS_imp_1_OUT".impter_59 AS FLOAT) - 0.222812465205969) / 4.252398068764952 AS scaler_59, (CAST("ADS_imp_1_OUT".impter_60 AS FLOAT) - -0.006274087618404) / 1.013175429895288 AS scaler_60, (CAST("ADS_imp_1_OUT".impter_61 AS FLOAT) - 0.014268598957774) / 0.975232456173164 AS scaler_61, (CAST("ADS_imp_1_OUT".impter_62 AS FLOAT) - -0.028545511573861) / 0.99601766121793 AS scaler_62, (CAST("ADS_imp_1_OUT".impter_63 AS FLOAT) - -0.437491831849633) / 4.238759256560504 AS scaler_63, (CAST("ADS_imp_1_OUT".impter_64 AS FLOAT) - -0.368992780587573) / 4.18274187652401 AS scaler_64, (CAST("ADS_imp_1_OUT".impter_65 AS FLOAT) - 0.001169041819319) / 1.043336524991625 AS scaler_65, (CAST("ADS_imp_1_OUT".impter_66 AS FLOAT) - -0.01156487371758) / 4.081504294152238 AS scaler_66, (CAST("ADS_imp_1_OUT".impter_67 AS FLOAT) - -0.043587699896944) / 1.058664519012294 AS scaler_67, (CAST("ADS_imp_1_OUT".impter_68 AS FLOAT) - -0.161863413739017) / 4.259666235165136 AS scaler_68, (CAST("ADS_imp_1_OUT".impter_69 AS FLOAT) - -0.017272641535016) / 1.010305833440296 AS scaler_69, (CAST("ADS_imp_1_OUT".impter_70 AS FLOAT) - -0.364030220368647) / 4.23529048916204 AS scaler_70, (CAST("ADS_imp_1_OUT".impter_71 AS FLOAT) - -0.049273006502403) / 4.310802365306347 AS scaler_71, (CAST("ADS_imp_1_OUT".impter_72 AS FLOAT) - -0.015468512657334) / 1.010660801531323 AS scaler_72, (CAST("ADS_imp_1_OUT".impter_73 AS FLOAT) - -0.191629393512795) / 4.116044965548444 AS scaler_73, (CAST("ADS_imp_1_OUT".impter_74 AS FLOAT) - 0.023782830321603) / 0.997185935238241 AS scaler_74, (CAST("ADS_imp_1_OUT".impter_75 AS FLOAT) - 0.02045479967257) / 0.96404748767937 AS scaler_75, (CAST("ADS_imp_1_OUT".impter_76 AS FLOAT) - -0.173355346593134) / 4.268840083291991 AS scaler_76, (CAST("ADS_imp_1_OUT".impter_77 AS FLOAT) - 0.027582288245763) / 1.002873637150224 AS scaler_77, (CAST("ADS_imp_1_OUT".impter_78 AS FLOAT) - -0.015452336678169) / 0.951796972877656 AS scaler_78, (CAST("ADS_imp_1_OUT".impter_79 AS FLOAT) - -0.042555545773258) / 1.026041980115793 AS scaler_79, (CAST("ADS_imp_1_OUT".impter_80 AS FLOAT) - -0.009425736580365) / 0.981547933162807 AS scaler_80, (CAST("ADS_imp_1_OUT".impter_81 AS FLOAT) - 0.007423677489325) / 1.017144763796163 AS scaler_81, (CAST("ADS_imp_1_OUT".impter_82 AS FLOAT) - 0.049853326436817) / 1.013812175189716 AS scaler_82, (CAST("ADS_imp_1_OUT".impter_83 AS FLOAT) - 0.027960221179443) / 1.004933108786332 AS scaler_83, (CAST("ADS_imp_1_OUT".impter_84 AS FLOAT) - -0.005270502487579) / 1.023325284914829 AS scaler_84, (CAST("ADS_imp_1_OUT".impter_85 AS FLOAT) - -0.053393611774247) / 1.004589191993288 AS scaler_85, (CAST("ADS_imp_1_OUT".impter_86 AS FLOAT) - 0.17162033288561) / 4.24884427578287 AS scaler_86, (CAST("ADS_imp_1_OUT".impter_87 AS FLOAT) - 0.037211997007404) / 4.254048583081736 AS scaler_87, (CAST("ADS_imp_1_OUT".impter_88 AS FLOAT) - 0.018434973330449) / 3.949728840889438 AS scaler_88, (CAST("ADS_imp_1_OUT".impter_89 AS FLOAT) - 0.560521632617363) / 4.331332438981666 AS scaler_89, (CAST("ADS_imp_1_OUT".impter_90 AS FLOAT) - -0.052850462919) / 1.0358397102155 AS scaler_90, (CAST("ADS_imp_1_OUT".impter_91 AS FLOAT) - 0.079390217342441) / 0.969876446027829 AS scaler_91, (CAST("ADS_imp_1_OUT".impter_92 AS FLOAT) - -2.088667163118704) / 15.30221524651991 AS scaler_92, (CAST("ADS_imp_1_OUT".impter_93 AS FLOAT) - -1.083102063895462) / 4.36710902027052 AS scaler_93, (CAST("ADS_imp_1_OUT".impter_94 AS FLOAT) - -0.304702362821244) / 4.204292362348631 AS scaler_94, (CAST("ADS_imp_1_OUT".impter_95 AS FLOAT) - -0.935426259563726) / 15.357005766716696 AS scaler_95, (CAST("ADS_imp_1_OUT".impter_96 AS FLOAT) - -0.098411219927033) / 0.952484869943965 AS scaler_96, (CAST("ADS_imp_1_OUT".impter_97 AS FLOAT) - -0.531653484360343) / 3.977000718240084 AS scaler_97, (CAST("ADS_imp_1_OUT".impter_98 AS FLOAT) - 0.014127422137805) / 0.987925892541105 AS scaler_98, (CAST("ADS_imp_1_OUT".impter_99 AS FLOAT) - -0.012631277412677) / 1.015196444834118 AS scaler_99, (CAST("ADS_imp_1_OUT".impter_100 AS FLOAT) - 0.031286881233113) / 0.989361802421023 AS scaler_100, (CAST("ADS_imp_1_OUT".impter_101 AS FLOAT) - -0.450390515384602) / 4.244700325091398 AS scaler_101 
FROM tmp_20180416233645_c5vukt_ads_ AS "ADS_imp_1_OUT") AS "ADS_sca_2_OUT") AS "U"

-- Code For temporary table tmp_20180416233648_lb99gm_lgbm part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416233648_lb99gm_lgbm  (
	"KEY" BIGINT, 
	"Score_0" FLOAT, 
	"Score_1" FLOAT, 
	"Score_2" FLOAT, 
	"Score_3" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416233648_lb99gm_lgbm part 2/2. Populate

INSERT INTO tmp_20180416233648_lb99gm_lgbm ("KEY", "Score_0", "Score_1", "Score_2", "Score_3") SELECT "U"."KEY", "U"."Score_0", "U"."Score_1", "U"."Score_2", "U"."Score_3" 
FROM (WITH "DT_node_lookup" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.451713696089738) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.067193373231848) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.554627746272502) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.504673555509635) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 0.352172623844089) THEN 32 ELSE 33 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.830687848471658) THEN 34 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.129409446931411) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.0) THEN 140 ELSE 141 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.197133061396534) THEN 142 ELSE 143 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= -0.539135890232826) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.650657258592528) THEN 38 ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.608283997336948) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.246454039879453) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.94711200170736) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= 1.106254608104254) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -1.222070291920264) THEN 88 ELSE 89 END ELSE 45 END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.612307081194479) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 0.08263887241881) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_71 <= 0.764150534499136) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.278431255240553) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -0.11213117393021) THEN 104 ELSE 105 END ELSE 53 END ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 1.170075117819322) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.460856035671264) THEN 28 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.215472910220608) THEN 58 ELSE 59 END END ELSE 15 END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.016049382716049 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.006666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.02972972972973 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.025925925925926 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.007407407407407 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.04 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.05 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.013333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, -0.029411764705882 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.013333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, -0.014285714285714 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.015942028985507 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.066666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.1 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 53 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 59 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 88 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.026666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 89 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 104 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 52 AS parent_id, -0.006666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 105 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 52 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 140 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 70 AS parent_id, 0.095061728395062 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 141 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 70 AS parent_id, 0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 142 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 71 AS parent_id, -0.020634920634921 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 143 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 71 AS parent_id, 0.04 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".node_id AS node_id, "DT_node_data".feature AS feature, "DT_node_data"."threshold" AS "threshold", "DT_node_data".depth AS depth, "DT_node_data".parent_id AS parent_id, "DT_node_data"."Score" AS "Score" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".node_id), 
"LGBM_Model_0_0" AS 
(SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output"), 
"DT_node_lookup_1" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= -1.174216977109092) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.442827292811769) THEN 74 ELSE 75 END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.289191756017089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= -0.051056202544623) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= -0.270231831732882) THEN 40 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.668088367891737) THEN 82 ELSE 83 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.419914641948611) THEN 42 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -0.154457965939948) THEN 86 ELSE 87 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.510874314724548) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.476302395030758) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.18261792646899) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.343880447956846) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.05669226674118) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.218785758608868) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.330137870284319) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= -0.732268444520137) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.104775554409621) THEN 28 ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.918555259495295) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.795576321120505) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.419245451596038) THEN 120 ELSE 121 END ELSE 61 END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_1" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.001754385964912 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.003030303030303 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.04 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.017647058823529 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.006666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.061904761904762 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.02 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.026666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, 0.071428571428571 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.024324324324324 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.020833333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.022222222222222 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.054385964912281 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.1 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.006666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 74 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 75 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 82 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, -0.021212121212121 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, 0.051515151515152 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 86 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, -0.001333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 87 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 120 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, -0.013333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 121 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_1" AS 
(SELECT "DT_node_lookup_1"."KEY" AS "KEY", "DT_node_lookup_1".node_id_2 AS node_id_2, "DT_node_data_1".node_id AS node_id, "DT_node_data_1".feature AS feature, "DT_node_data_1"."threshold" AS "threshold", "DT_node_data_1".depth AS depth, "DT_node_data_1".parent_id AS parent_id, "DT_node_data_1"."Score" AS "Score" 
FROM "DT_node_lookup_1" LEFT OUTER JOIN "DT_node_data_1" ON "DT_node_lookup_1".node_id_2 = "DT_node_data_1".node_id), 
"LGBM_Model_1_0" AS 
(SELECT "DT_Output_1"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_1"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_1"), 
"DT_node_lookup_2" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.233320077675485) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.0749257362689) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -0.626827069787334) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.524109576391072) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.392717162404367) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= 0.073918132909454) THEN 36 ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.974062953953973) THEN 38 ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.90962236855053) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.220417256338059) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.827228947189834) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.187237942918085) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_83 <= 0.792516691343179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.569410012898143) THEN 176 ELSE 177 END ELSE 89 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_35 <= 0.366353902514402) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_56 <= -0.122717868175591) THEN 180 ELSE 181 END ELSE 91 END END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= -1.085762191712508) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.380306905242662) THEN 12 ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.485637271654055) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -1.051954511175311) THEN 28 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.907644683449225) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.592103218991626) THEN 118 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.474302722989981) THEN 238 ELSE 239 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.025941224385039) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= 0.115002635190173) THEN 60 ELSE 61 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.129409446931411) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_2" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 12 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.1 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.026666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, -0.026666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.022222222222222 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.017460317460317 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.075757575757576 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.026315789473684 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.038738738738739 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.003448275862069 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.02952380952381 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.02 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.013513513513514 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.03015873015873 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.1 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.026666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, 0.02 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 89 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.006666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 91 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 45 AS parent_id, 0.028571428571429 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 118 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 59 AS parent_id, 0.002702702702703 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 176 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 88 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 177 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 88 AS parent_id, -0.026666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 180 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 90 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 181 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 90 AS parent_id, 0 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 238 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.02 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 239 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_2" AS 
(SELECT "DT_node_lookup_2"."KEY" AS "KEY", "DT_node_lookup_2".node_id_2 AS node_id_2, "DT_node_data_2".node_id AS node_id, "DT_node_data_2".feature AS feature, "DT_node_data_2"."threshold" AS "threshold", "DT_node_data_2".depth AS depth, "DT_node_data_2".parent_id AS parent_id, "DT_node_data_2"."Score" AS "Score" 
FROM "DT_node_lookup_2" LEFT OUTER JOIN "DT_node_data_2" ON "DT_node_lookup_2".node_id_2 = "DT_node_data_2".node_id), 
"LGBM_Model_2_0" AS 
(SELECT "DT_Output_2"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_2"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_2"), 
"DT_node_lookup_3" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.470663599441499) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.132832282716238) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.778151633006933) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_43 <= 0.059966799735266) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.290217350581293) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.116535413072189) THEN 36 ELSE 37 END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.467576267285187) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.021977526667093) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.33678409112609) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.582012371440656) THEN 44 ELSE 45 END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= -0.242943961687349) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.316328451954822) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.477464089146078) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_55 <= 0.547942970313875) THEN 48 ELSE 49 END ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= 0.23009303013395) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.027469953928906) THEN 52 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= -0.310776822054846) THEN 106 ELSE 107 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_56 <= 0.300794360194677) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_98 <= 0.064890941295269) THEN 108 ELSE 109 END ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_65 <= 1.378575993190553) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= -0.199889872546648) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_74 <= 1.100973025361643) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.805173715445181) THEN 112 ELSE 113 END ELSE 57 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= -0.809812177157646) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= 0.274494067304379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.558323213644794) THEN 236 ELSE 237 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= 0.484840152201011) THEN 238 ELSE 239 END END END END ELSE 15 END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_3" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.018840579710145 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.053333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.1 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.001754385964912 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.06 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.006666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.020987654320988 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.006666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.087301587301587 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.02 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.013333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 49 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.006666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.074193548387097 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.027272727272727 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.013333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.014285714285714 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 106 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 53 AS parent_id, -0.022222222222222 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 107 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 53 AS parent_id, 0.035802469135802 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 108 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 54 AS parent_id, -0.006666666666667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 109 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 54 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 112 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 113 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 236 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, -0.02 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 237 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, -0.033333333333333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 238 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.028395061728395 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 239 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, 0.03015873015873 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_3" AS 
(SELECT "DT_node_lookup_3"."KEY" AS "KEY", "DT_node_lookup_3".node_id_2 AS node_id_2, "DT_node_data_3".node_id AS node_id, "DT_node_data_3".feature AS feature, "DT_node_data_3"."threshold" AS "threshold", "DT_node_data_3".depth AS depth, "DT_node_data_3".parent_id AS parent_id, "DT_node_data_3"."Score" AS "Score" 
FROM "DT_node_lookup_3" LEFT OUTER JOIN "DT_node_data_3" ON "DT_node_lookup_3".node_id_2 = "DT_node_data_3".node_id), 
"LGBM_Model_3_0" AS 
(SELECT "DT_Output_3"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_3"."Score" AS "Score_3" 
FROM "DT_Output_3"), 
"DT_node_lookup_4" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.451713696089738) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.854803386634702) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.210274841129939) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.178118760405181) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_92 <= 0.693755763769871) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= -0.249471695146156) THEN 36 ELSE 37 END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.211119237510429) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= -0.984986103252644) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.606392530350532) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.119038675452984) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_76 <= -0.237977581764035) THEN 168 ELSE 169 END ELSE 85 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= 1.142064245102472) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -1.032411402443084) THEN 172 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_91 <= 0.562444463680338) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.297570732759686) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.325293315187167) THEN 1384 ELSE 1385 END ELSE 693 END ELSE 347 END END ELSE 87 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.733317468841946) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.538780223174287) THEN 46 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= -0.701313696683763) THEN 94 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_56 <= 0.56693122383736) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= 0.142748561763117) THEN 380 ELSE 381 END ELSE 191 END END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.318106241928693) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_71 <= 0.764150534499136) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.278431255240553) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 0.629330396390657) THEN 104 ELSE 105 END ELSE 53 END ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 1.170075117819322) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.473624936934708) THEN 28 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_47 <= 0.222852019834288) THEN 58 ELSE 59 END END ELSE 15 END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_4" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.015387433170741 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, -0.033131353706357 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.006748588324302 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.07354259787055 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.004638828737533 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.033306086314754 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.085680130416637 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.046050783916654 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.047166062094103 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.012770440371958 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.019858426593581 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.039121099162318 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.012172465270923 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 53 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.03183554682188 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, -0.032984712527059 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 59 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, -0.033095225766825 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, 0.007433460404932 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 87 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, -0.019797644260581 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 94 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 47 AS parent_id, 0.000233735358884 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 104 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 52 AS parent_id, -0.033144795817227 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 105 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 52 AS parent_id, -0.006129663711674 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 168 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 84 AS parent_id, -0.026271563636848 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 169 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 84 AS parent_id, -0.033229707151726 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 172 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 86 AS parent_id, -0.033253674762283 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 191 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 95 AS parent_id, -0.026368404200851 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 347 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 173 AS parent_id, -0.033181309139561 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 380 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 190 AS parent_id, -0.033242862153303 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 381 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 190 AS parent_id, -0.033097681479076 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 693 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 346 AS parent_id, -0.032961012967973 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1384 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 692 AS parent_id, -0.033002910324376 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1385 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 692 AS parent_id, -0.033116069487057 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_4" AS 
(SELECT "DT_node_lookup_4"."KEY" AS "KEY", "DT_node_lookup_4".node_id_2 AS node_id_2, "DT_node_data_4".node_id AS node_id, "DT_node_data_4".feature AS feature, "DT_node_data_4"."threshold" AS "threshold", "DT_node_data_4".depth AS depth, "DT_node_data_4".parent_id AS parent_id, "DT_node_data_4"."Score" AS "Score" 
FROM "DT_node_lookup_4" LEFT OUTER JOIN "DT_node_data_4" ON "DT_node_lookup_4".node_id_2 = "DT_node_data_4".node_id), 
"LGBM_Model_0_1" AS 
(SELECT "DT_Output_4"."KEY" AS "KEY", "DT_Output_4"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_4"), 
"DT_node_lookup_5" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -1.06711085314315) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= -1.010003027801105) THEN 74 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.266279045402642) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -0.202364641110022) THEN 300 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= -0.145158748254046) THEN 602 ELSE 603 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= 0.379260395619674) THEN 302 ELSE 303 END END END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.289191756017089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= 0.393571563299742) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.683670144151382) THEN 40 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= 0.539290836109095) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.047924040922726) THEN 164 ELSE 165 END ELSE 83 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.113904240197745) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.510874314724548) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.162935955320653) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.18261792646899) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.343880447956846) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.05669226674118) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.199920981337121) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= 0.307866750310075) THEN 52 ELSE 53 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= -0.199889872546648) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= -0.732268444520137) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.104775554409621) THEN 28 ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.918555259495295) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.795576321120505) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_39 <= 0.750649516855533) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_100 <= -0.17185434256011) THEN 240 ELSE 241 END ELSE 121 END ELSE 61 END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_5" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.001717826868651 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.00304843936758 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.038066630578911 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.033012882152676 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.006533924461062 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.05818785382923 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.018963104182684 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.026174304337452 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.015933323710352 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.00938892541512 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.029507086184769 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.020492187114337 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.021433290557746 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.032939667796879 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.033055138374486 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, -0.021534843791617 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 53 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.064992032669591 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.09327247559814 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.048058834773543 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.006517278030532 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 74 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.032917462638367 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, -0.001894620067351 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 121 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, -0.012729257861945 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 164 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, 0.016909285596 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 165 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, 0.07870928134632 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 240 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.032965441895825 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 241 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.033087209626181 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 300 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 150 AS parent_id, -0.033144547975072 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 302 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 151 AS parent_id, -0.032957556258846 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 303 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 151 AS parent_id, -0.033051541064622 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 602 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 301 AS parent_id, -0.032995065786359 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 603 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 301 AS parent_id, -0.033119476104219 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_5" AS 
(SELECT "DT_node_lookup_5"."KEY" AS "KEY", "DT_node_lookup_5".node_id_2 AS node_id_2, "DT_node_data_5".node_id AS node_id, "DT_node_data_5".feature AS feature, "DT_node_data_5"."threshold" AS "threshold", "DT_node_data_5".depth AS depth, "DT_node_data_5".parent_id AS parent_id, "DT_node_data_5"."Score" AS "Score" 
FROM "DT_node_lookup_5" LEFT OUTER JOIN "DT_node_data_5" ON "DT_node_lookup_5".node_id_2 = "DT_node_data_5".node_id), 
"LGBM_Model_1_1" AS 
(SELECT "DT_Output_5"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_5"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_5"), 
"DT_node_lookup_6" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.233320077675485) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.0749257362689) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -0.626827069787334) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_83 <= -0.223878974323644) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.392717162404367) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= 0.073918132909454) THEN 36 ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_85 <= -0.809859481876238) THEN 38 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.346588924956405) THEN 78 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= 0.158794672407511) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= 0.135667834228301) THEN 316 ELSE 317 END ELSE 159 END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.90962236855053) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.220417256338059) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.08997353301002) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_34 <= 0.548979926471524) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_91 <= 0.657087530942892) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.269074337361062) THEN 176 ELSE 177 END ELSE 89 END ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= 0.696997413084533) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.350899072830432) THEN 92 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_48 <= -0.004175553998153) THEN 186 ELSE 187 END END ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= -1.085762191712508) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.380306905242662) THEN 12 ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.485637271654055) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -1.051954511175311) THEN 28 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.907644683449225) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.592103218991626) THEN 118 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_98 <= -0.846148284352466) THEN 238 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= -0.547906001073512) THEN 478 ELSE 479 END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.025941224385039) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= 0.115002635190173) THEN 60 ELSE 61 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= -0.072872144938011) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_6" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 12 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.092028998673496 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.025593544067188 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.026707796918071 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, -0.022103883364885 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.016747927387581 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.070582739371818 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.03676660218675 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.003515756743293 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.029145700870059 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.019494029889242 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.004994236003535 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.054421736726123 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.012920214159061 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.028872821164151 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.092107543794009 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, 0.019844677093387 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.026554703549742 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 78 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 39 AS parent_id, -0.032947369518768 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 89 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.01966138816938 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 92 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, 0.019463542902387 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 118 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 59 AS parent_id, 0.002661537604814 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 159 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 79 AS parent_id, -0.03298813161181 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 176 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 88 AS parent_id, -0.0330831318339 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 177 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 88 AS parent_id, -0.033286057189361 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 186 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 93 AS parent_id, -0.033356230571542 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 187 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 93 AS parent_id, -0.019871640707318 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 238 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.019430668725242 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 316 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 158 AS parent_id, -0.033115244553556 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 317 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 158 AS parent_id, -0.033034891272677 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 478 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 239 AS parent_id, -0.033131669443825 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 479 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 239 AS parent_id, -0.03299587527296 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_6" AS 
(SELECT "DT_node_lookup_6"."KEY" AS "KEY", "DT_node_lookup_6".node_id_2 AS node_id_2, "DT_node_data_6".node_id AS node_id, "DT_node_data_6".feature AS feature, "DT_node_data_6"."threshold" AS "threshold", "DT_node_data_6".depth AS depth, "DT_node_data_6".parent_id AS parent_id, "DT_node_data_6"."Score" AS "Score" 
FROM "DT_node_lookup_6" LEFT OUTER JOIN "DT_node_data_6" ON "DT_node_lookup_6".node_id_2 = "DT_node_data_6".node_id), 
"LGBM_Model_2_1" AS 
(SELECT "DT_Output_6"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_6"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_6"), 
"DT_node_lookup_7" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.470663599441499) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.132832282716238) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.042664248041282) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.596853716516558) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= -0.069292617050089) THEN 32 ELSE 33 END ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.290217350581293) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.467576267285187) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_75 <= 0.145931505645052) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.33678409112609) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_34 <= 0.37733997492107) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= 0.425630365684048) THEN 88 ELSE 89 END ELSE 45 END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= -0.242943961687349) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.316328451954822) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_59 <= 0.794707368041002) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.361717378481845) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= 0.258139304612296) THEN 96 ELSE 97 END ELSE 49 END ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= 0.23009303013395) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.027469953928906) THEN 52 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= -0.310776822054846) THEN 106 ELSE 107 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_56 <= 0.300794360194677) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= -0.24690410232057) THEN 108 ELSE 109 END ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_65 <= 1.378575993190553) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= -0.199889872546648) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_83 <= 1.028957468027695) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -0.158385872044048) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_79 <= 0.462744590699329) THEN 224 ELSE 225 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.398393914677865) THEN 226 ELSE 227 END END ELSE 57 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= -0.809812177157646) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= 0.274494067304379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.485605195771621) THEN 236 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= -0.142456757934528) THEN 474 ELSE 475 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= 0.484840152201011) THEN 238 ELSE 239 END END END END ELSE 15 END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_7" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.018010936610979 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.024622429680511 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.050731902620098 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.014195544221773 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.00577441056324 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.057502962327996 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.020272207429678 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.006803863148457 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.093803245809419 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.056652047517944 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.01269194974449 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 49 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.009607198756098 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.069150369973509 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.026367115777503 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.012761607780843 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.013596211214951 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 88 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.033130748193977 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 89 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.032986689105289 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 96 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 48 AS parent_id, -0.033205838247443 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 97 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 48 AS parent_id, -0.03300846092517 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 106 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 53 AS parent_id, -0.021910624733673 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 107 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 53 AS parent_id, 0.033959281055776 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 108 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 54 AS parent_id, -0.006102465333429 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 109 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 54 AS parent_id, -0.033126554459234 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 224 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, -0.033008664762233 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 225 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, -0.032887457773899 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 226 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 113 AS parent_id, -0.033134569582952 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 227 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 113 AS parent_id, -0.033034923595853 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 236 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, -0.019441328337814 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 238 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.02805011206881 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 239 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, 0.028707748473749 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 474 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 237 AS parent_id, -0.033136925382966 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 475 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 237 AS parent_id, -0.033018369488854 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_7" AS 
(SELECT "DT_node_lookup_7"."KEY" AS "KEY", "DT_node_lookup_7".node_id_2 AS node_id_2, "DT_node_data_7".node_id AS node_id, "DT_node_data_7".feature AS feature, "DT_node_data_7"."threshold" AS "threshold", "DT_node_data_7".depth AS depth, "DT_node_data_7".parent_id AS parent_id, "DT_node_data_7"."Score" AS "Score" 
FROM "DT_node_lookup_7" LEFT OUTER JOIN "DT_node_data_7" ON "DT_node_lookup_7".node_id_2 = "DT_node_data_7".node_id), 
"LGBM_Model_3_1" AS 
(SELECT "DT_Output_7"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_7"."Score" AS "Score_3" 
FROM "DT_Output_7"), 
"DT_node_lookup_8" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.451713696089738) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.067193373231848) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.554627746272502) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.504673555509635) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 0.352172623844089) THEN 32 ELSE 33 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.947656628833807) THEN 34 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.129409446931411) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.348440137132981) THEN 140 ELSE 141 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.197133061396534) THEN 142 ELSE 143 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.795194172858918) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.380812871743497) THEN 38 ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= 0.810356497385888) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= 0.330961740661462) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.31557712371237) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.394089351919764) THEN 160 ELSE 161 END ELSE 81 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_99 <= -0.060661986121868) THEN 82 ELSE 83 END END ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= -0.513841692077992) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.636886725677481) THEN 46 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_91 <= 0.64936316913125) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= -0.458599849448913) THEN 188 ELSE 189 END ELSE 95 END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.154788077692472) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.879973724619845) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_71 <= 0.764150534499136) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.707612952357965) THEN 52 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_35 <= -0.270248427941202) THEN 106 ELSE 107 END END ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -0.509650615548876) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_76 <= -0.260014089237414) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.744643314443216) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_8" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.014837411139673 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.00623865063093 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.012644675851391 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.02197134930596 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.034540851424172 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.044670057088413 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.012355675421611 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, -0.028834409171065 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.013386259129041 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, -0.016727666923835 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.032835123702084 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.033055466183219 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.001282472528909 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.057174000296945 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.088008669761489 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.039620447826346 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.032829263986089 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.033230476151692 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 81 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, -0.03289486830434 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 82 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, -0.033122661290839 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, -0.03284889922478 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 95 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 47 AS parent_id, -0.012738898992657 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 106 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 53 AS parent_id, -0.003544737774981 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 107 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 53 AS parent_id, -0.029233148978085 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 140 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 70 AS parent_id, 0.037293107449387 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 141 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 70 AS parent_id, 0.091285288162436 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 142 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 71 AS parent_id, -0.02061244766986 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 143 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 71 AS parent_id, 0.037439411393045 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 160 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 80 AS parent_id, -0.032767028455933 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 161 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 80 AS parent_id, -0.032575864045235 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 188 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 94 AS parent_id, -0.033186701255669 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 189 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 94 AS parent_id, -0.032836299007682 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_8" AS 
(SELECT "DT_node_lookup_8"."KEY" AS "KEY", "DT_node_lookup_8".node_id_2 AS node_id_2, "DT_node_data_8".node_id AS node_id, "DT_node_data_8".feature AS feature, "DT_node_data_8"."threshold" AS "threshold", "DT_node_data_8".depth AS depth, "DT_node_data_8".parent_id AS parent_id, "DT_node_data_8"."Score" AS "Score" 
FROM "DT_node_lookup_8" LEFT OUTER JOIN "DT_node_data_8" ON "DT_node_lookup_8".node_id_2 = "DT_node_data_8".node_id), 
"LGBM_Model_0_2" AS 
(SELECT "DT_Output_8"."KEY" AS "KEY", "DT_Output_8"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_8"), 
"DT_node_lookup_9" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -1.285632499996934) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= -0.926953732410714) THEN 74 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.266279045402642) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.476102734886258) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.761167377303201) THEN 600 ELSE 601 END ELSE 301 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_34 <= 0.430911376686003) THEN 302 ELSE 303 END END END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.289191756017089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= 0.393571563299742) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.683670144151382) THEN 40 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= 0.539290836109095) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.047924040922726) THEN 164 ELSE 165 END ELSE 83 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.113904240197745) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.510874314724548) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.162935955320653) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.18261792646899) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.343880447956846) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.05669226674118) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.218785758608868) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= 0.515243478629052) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= -0.732268444520137) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.104775554409621) THEN 28 ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.918555259495295) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.795576321120505) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_39 <= 0.750649516855533) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= 0.512342432925985) THEN 240 ELSE 241 END ELSE 121 END ELSE 61 END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_9" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.001699015651308 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.003086940215272 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.036309905359798 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.032703291775796 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.016253480577299 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.006330814650449 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.055032093896535 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.018170960522803 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.025724740432576 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.015510180658209 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.008946447196633 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.029176931788695 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.0201414508542 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.020658770659911 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.032605352367675 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.032798020507057 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.044886696191493 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.082571117210311 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.006234698685939 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 74 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.032556329845758 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, -0.001782653419541 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 121 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, -0.01236677334619 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 164 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, 0.016279862563454 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 165 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, 0.073282219637998 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 240 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.032630217475992 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 241 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.032830336565881 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 301 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 150 AS parent_id, -0.032940517778763 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 302 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 151 AS parent_id, -0.032777330825248 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 303 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 151 AS parent_id, -0.03260269314792 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 600 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 300 AS parent_id, -0.032690859046785 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 601 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 300 AS parent_id, -0.03286139630628 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_9" AS 
(SELECT "DT_node_lookup_9"."KEY" AS "KEY", "DT_node_lookup_9".node_id_2 AS node_id_2, "DT_node_data_9".node_id AS node_id, "DT_node_data_9".feature AS feature, "DT_node_data_9"."threshold" AS "threshold", "DT_node_data_9".depth AS depth, "DT_node_data_9".parent_id AS parent_id, "DT_node_data_9"."Score" AS "Score" 
FROM "DT_node_lookup_9" LEFT OUTER JOIN "DT_node_data_9" ON "DT_node_lookup_9".node_id_2 = "DT_node_data_9".node_id), 
"LGBM_Model_1_2" AS 
(SELECT "DT_Output_9"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_9"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_9")
 SELECT "LGBM_B0"."KEY", "LGBM_B0"."Score_0", "LGBM_B0"."Score_1", "LGBM_B0"."Score_2", "LGBM_B0"."Score_3" 
FROM (SELECT "LGBM_esu_0"."KEY" AS "KEY", "LGBM_esu_0"."Score_0" AS "Score_0", "LGBM_esu_0"."Score_1" AS "Score_1", "LGBM_esu_0"."Score_2" AS "Score_2", "LGBM_esu_0"."Score_3" AS "Score_3" 
FROM (SELECT "LGBM_Model_0_0"."KEY" AS "KEY", "LGBM_Model_0_0"."Score_0" AS "Score_0", "LGBM_Model_0_0"."Score_1" AS "Score_1", "LGBM_Model_0_0"."Score_2" AS "Score_2", "LGBM_Model_0_0"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_0" UNION ALL SELECT "LGBM_Model_1_0"."KEY" AS "KEY", "LGBM_Model_1_0"."Score_0" AS "Score_0", "LGBM_Model_1_0"."Score_1" AS "Score_1", "LGBM_Model_1_0"."Score_2" AS "Score_2", "LGBM_Model_1_0"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_0" UNION ALL SELECT "LGBM_Model_2_0"."KEY" AS "KEY", "LGBM_Model_2_0"."Score_0" AS "Score_0", "LGBM_Model_2_0"."Score_1" AS "Score_1", "LGBM_Model_2_0"."Score_2" AS "Score_2", "LGBM_Model_2_0"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_0" UNION ALL SELECT "LGBM_Model_3_0"."KEY" AS "KEY", "LGBM_Model_3_0"."Score_0" AS "Score_0", "LGBM_Model_3_0"."Score_1" AS "Score_1", "LGBM_Model_3_0"."Score_2" AS "Score_2", "LGBM_Model_3_0"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_0" UNION ALL SELECT "LGBM_Model_0_1"."KEY" AS "KEY", "LGBM_Model_0_1"."Score_0" AS "Score_0", "LGBM_Model_0_1"."Score_1" AS "Score_1", "LGBM_Model_0_1"."Score_2" AS "Score_2", "LGBM_Model_0_1"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_1" UNION ALL SELECT "LGBM_Model_1_1"."KEY" AS "KEY", "LGBM_Model_1_1"."Score_0" AS "Score_0", "LGBM_Model_1_1"."Score_1" AS "Score_1", "LGBM_Model_1_1"."Score_2" AS "Score_2", "LGBM_Model_1_1"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_1" UNION ALL SELECT "LGBM_Model_2_1"."KEY" AS "KEY", "LGBM_Model_2_1"."Score_0" AS "Score_0", "LGBM_Model_2_1"."Score_1" AS "Score_1", "LGBM_Model_2_1"."Score_2" AS "Score_2", "LGBM_Model_2_1"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_1" UNION ALL SELECT "LGBM_Model_3_1"."KEY" AS "KEY", "LGBM_Model_3_1"."Score_0" AS "Score_0", "LGBM_Model_3_1"."Score_1" AS "Score_1", "LGBM_Model_3_1"."Score_2" AS "Score_2", "LGBM_Model_3_1"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_1" UNION ALL SELECT "LGBM_Model_0_2"."KEY" AS "KEY", "LGBM_Model_0_2"."Score_0" AS "Score_0", "LGBM_Model_0_2"."Score_1" AS "Score_1", "LGBM_Model_0_2"."Score_2" AS "Score_2", "LGBM_Model_0_2"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_2" UNION ALL SELECT "LGBM_Model_1_2"."KEY" AS "KEY", "LGBM_Model_1_2"."Score_0" AS "Score_0", "LGBM_Model_1_2"."Score_1" AS "Score_1", "LGBM_Model_1_2"."Score_2" AS "Score_2", "LGBM_Model_1_2"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_2") AS "LGBM_esu_0") AS "LGBM_B0") AS "U"

-- Code For temporary table tmp_20180416233648_t93had_lgbm part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416233648_t93had_lgbm  (
	"KEY" BIGINT, 
	"Score_0" FLOAT, 
	"Score_1" FLOAT, 
	"Score_2" FLOAT, 
	"Score_3" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416233648_t93had_lgbm part 2/2. Populate

INSERT INTO tmp_20180416233648_t93had_lgbm ("KEY", "Score_0", "Score_1", "Score_2", "Score_3") SELECT "U"."KEY", "U"."Score_0", "U"."Score_1", "U"."Score_2", "U"."Score_3" 
FROM (WITH "DT_node_lookup_10" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.233320077675485) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.0749257362689) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -0.626827069787334) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.524109576391072) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.392717162404367) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= 0.073918132909454) THEN 36 ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_77 <= 0.873521109758108) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.61199116696618) THEN 76 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_46 <= 0.333309614630918) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.294795020459984) THEN 308 ELSE 309 END ELSE 155 END END ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.90962236855053) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.220417256338059) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.827228947189834) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.187237942918085) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= 0.825367932263775) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.766947778138043) THEN 176 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.230774515391637) THEN 354 ELSE 355 END END ELSE 89 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_35 <= 0.366353902514402) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_56 <= -0.122717868175591) THEN 180 ELSE 181 END ELSE 91 END END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= -1.085762191712508) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.380306905242662) THEN 12 ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.485637271654055) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -1.051954511175311) THEN 28 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.907644683449225) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.592103218991626) THEN 118 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= 0.910512494300502) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= -0.547906001073512) THEN 476 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= -0.032742286808421) THEN 954 ELSE 955 END END ELSE 239 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.025941224385039) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= 0.115002635190173) THEN 60 ELSE 61 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= 0.214496941401076) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_10" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 12 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.085163715555979 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.024585754229766 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, -0.026189771924425 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.021314915191947 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.015994279395967 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.066002248500373 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.024572386772061 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.035158482342033 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.003521348539076 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.028791849294877 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.019005755222889 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.012458496186509 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.027916172328052 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.085376849507268 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, 0.019493245675937 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.026364091443612 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 76 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 38 AS parent_id, -0.032591249927794 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 89 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.005849054603466 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 91 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 45 AS parent_id, 0.027083889152204 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 118 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 59 AS parent_id, 0.002572811392991 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 155 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 77 AS parent_id, -0.032654653682221 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 176 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 88 AS parent_id, -0.026075756012615 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 180 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 90 AS parent_id, -0.032938765249967 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 181 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 90 AS parent_id, -0.00013157111386 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 239 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.018973637893349 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 308 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 154 AS parent_id, -0.032736989508664 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 309 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 154 AS parent_id, -0.032905119627974 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 354 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 177 AS parent_id, -0.032826072359909 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 355 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 177 AS parent_id, -0.033071289498803 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 476 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 238 AS parent_id, -0.032933291219617 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 954 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 477 AS parent_id, -0.032596052243023 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 955 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 477 AS parent_id, -0.032803922759158 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_10" AS 
(SELECT "DT_node_lookup_10"."KEY" AS "KEY", "DT_node_lookup_10".node_id_2 AS node_id_2, "DT_node_data_10".node_id AS node_id, "DT_node_data_10".feature AS feature, "DT_node_data_10"."threshold" AS "threshold", "DT_node_data_10".depth AS depth, "DT_node_data_10".parent_id AS parent_id, "DT_node_data_10"."Score" AS "Score" 
FROM "DT_node_lookup_10" LEFT OUTER JOIN "DT_node_data_10" ON "DT_node_lookup_10".node_id_2 = "DT_node_data_10".node_id), 
"LGBM_Model_2_2" AS 
(SELECT "DT_Output_10"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_10"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_10"), 
"DT_node_lookup_11" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.470663599441499) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.132832282716238) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.778151633006933) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_43 <= 0.059966799735266) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_74 <= 0.292605611069522) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.800152083723521) THEN 36 ELSE 37 END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.467576267285187) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= -0.025549888209412) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.33678409112609) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_34 <= 0.37733997492107) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.146146120313904) THEN 88 ELSE 89 END ELSE 45 END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= -0.242943961687349) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.316328451954822) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_43 <= 0.819116136471358) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_82 <= 0.548801808816004) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_48 <= 0.394992054346109) THEN 96 ELSE 97 END ELSE 49 END ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.836180818207983) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.94711200170736) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_77 <= -0.157790726012897) THEN 108 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.175344400944914) THEN 218 ELSE 219 END END ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_65 <= 1.378575993190553) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= -0.199889872546648) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_83 <= 1.028957468027695) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -0.178928806985995) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.224643343148075) THEN 224 ELSE 225 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_32 <= 0.507682314410179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= 0.202172110108645) THEN 452 ELSE 453 END ELSE 227 END END ELSE 57 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= -0.809812177157646) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= 0.274494067304379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= 0.521691012305472) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= -0.838800558867612) THEN 472 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_78 <= 0.105592282878138) THEN 946 ELSE 947 END END ELSE 237 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= 0.484840152201011) THEN 238 ELSE 239 END END END END ELSE 15 END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_11" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.017416172653921 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.046919509072176 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.086908462216702 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.057105516209281 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.055071160974045 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.004978897487761 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.019415481678382 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.007134023106017 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.017424678460472 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.034586553845242 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.033532562100636 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.012315880611434 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 49 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.005637391550234 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, -0.012877205469932 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.012436913159256 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.013107598719735 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 88 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.032907404899907 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 89 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.032698217195929 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 96 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 48 AS parent_id, -0.033084279928757 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 97 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 48 AS parent_id, -0.032764027564165 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 108 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 54 AS parent_id, 0.007187703250983 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 218 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 109 AS parent_id, 0.03313298262185 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 219 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 109 AS parent_id, 0.081988818414742 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 224 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, -0.032726760764944 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 225 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, -0.032505602391637 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 227 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 113 AS parent_id, -0.032709396905125 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 237 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, -0.01894478931257 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 238 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.027734328869957 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 239 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, 0.027449728914515 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 452 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 226 AS parent_id, -0.032791972437135 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 453 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 226 AS parent_id, -0.032927626452225 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 472 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 236 AS parent_id, -0.032910241558921 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 946 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 473 AS parent_id, -0.032812619243195 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 947 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 473 AS parent_id, -0.032647943673144 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_11" AS 
(SELECT "DT_node_lookup_11"."KEY" AS "KEY", "DT_node_lookup_11".node_id_2 AS node_id_2, "DT_node_data_11".node_id AS node_id, "DT_node_data_11".feature AS feature, "DT_node_data_11"."threshold" AS "threshold", "DT_node_data_11".depth AS depth, "DT_node_data_11".parent_id AS parent_id, "DT_node_data_11"."Score" AS "Score" 
FROM "DT_node_lookup_11" LEFT OUTER JOIN "DT_node_data_11" ON "DT_node_lookup_11".node_id_2 = "DT_node_data_11".node_id), 
"LGBM_Model_3_2" AS 
(SELECT "DT_Output_11"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_11"."Score" AS "Score_3" 
FROM "DT_Output_11"), 
"DT_node_lookup_12" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.451713696089738) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.067193373231848) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.554627746272502) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.504673555509635) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 0.352172623844089) THEN 32 ELSE 33 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.947656628833807) THEN 34 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.129409446931411) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.0) THEN 140 ELSE 141 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.197133061396534) THEN 142 ELSE 143 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.795194172858918) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_34 <= 0.168079121822289) THEN 38 ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.608283997336948) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.246454039879453) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.94711200170736) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= 1.106254608104254) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= 1.123092185324333) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.034309988622557) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= 0.409877533749141) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_100 <= 0.715173806772453) THEN 704 ELSE 705 END ELSE 353 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -0.126628460467321) THEN 354 ELSE 355 END END ELSE 89 END ELSE 45 END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.318106241928693) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.03157798380693) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= 0.072638904024747) THEN 52 ELSE 53 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.222033244715318) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 1.170075117819322) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.473624936934708) THEN 28 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.04825688913811) THEN 58 ELSE 59 END END ELSE 15 END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_12" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.01508943333779 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.006026530978541 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.028867430435532 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.024349339196053 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.006283370148854 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.075212683981871 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.040554638468176 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.012132411355163 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, -0.028504931909061 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.013116445469036 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, -0.016422823953732 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.032764381196036 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.03246917489456 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.014763741509453 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, -0.003735251957355 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 53 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.057170405303478 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.018544491780056 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, -0.02607559252098 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, -0.032394278298479 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 59 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, -0.032720613620503 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 89 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.025565516292477 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 140 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 70 AS parent_id, 0.080498971798024 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 141 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 70 AS parent_id, 0.029084103512205 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 142 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 71 AS parent_id, -0.020275600427807 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 143 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 71 AS parent_id, 0.035509004618052 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 353 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 176 AS parent_id, -0.032698599644845 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 354 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 177 AS parent_id, -0.03252166565799 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 355 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 177 AS parent_id, -0.033023570250142 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 704 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 352 AS parent_id, -0.032511941007585 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 705 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 352 AS parent_id, -0.032247118335914 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_12" AS 
(SELECT "DT_node_lookup_12"."KEY" AS "KEY", "DT_node_lookup_12".node_id_2 AS node_id_2, "DT_node_data_12".node_id AS node_id, "DT_node_data_12".feature AS feature, "DT_node_data_12"."threshold" AS "threshold", "DT_node_data_12".depth AS depth, "DT_node_data_12".parent_id AS parent_id, "DT_node_data_12"."Score" AS "Score" 
FROM "DT_node_lookup_12" LEFT OUTER JOIN "DT_node_data_12" ON "DT_node_lookup_12".node_id_2 = "DT_node_data_12".node_id), 
"LGBM_Model_0_3" AS 
(SELECT "DT_Output_12"."KEY" AS "KEY", "DT_Output_12"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_12"), 
"DT_node_lookup_13" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.896844008270084) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.476102734886258) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -0.59555717394699) THEN 148 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= -0.470414584314867) THEN 298 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.110667003903851) THEN 598 ELSE 599 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.225597636747441) THEN 150 ELSE 151 END END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.289191756017089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= 0.393571563299742) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.683670144151382) THEN 40 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= 0.539290836109095) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.047924040922726) THEN 164 ELSE 165 END ELSE 83 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= 0.363211087276031) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_79 <= 0.118720043816368) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.510874314724548) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.186805575930592) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.18261792646899) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.343880447956846) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.05669226674118) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.218785758608868) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.330137870284319) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= -0.732268444520137) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.104775554409621) THEN 28 ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.918555259495295) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.795576321120505) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.419245451596038) THEN 120 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.0) THEN 242 ELSE 243 END END ELSE 61 END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_13" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.001737706212436 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.003102289808302 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.034549380738855 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.032424197029967 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.015576736200973 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.006177262811788 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.052168343112944 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.017431924262135 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.025272605905428 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.015104955568591 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.012747616050999 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.019804410513336 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.019951666398635 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.032244822472471 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.032499369759502 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.044832256171591 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.081227012003529 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.006053536609535 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, -0.001728685641073 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.019082609021531 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.033070859783243 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 120 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, -0.011884713808605 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 148 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 74 AS parent_id, -0.032183480952859 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 150 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 75 AS parent_id, -0.032799966544562 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 151 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 75 AS parent_id, -0.032498672332067 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 164 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, 0.015823783148137 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 165 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, 0.068621981532936 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 242 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 121 AS parent_id, -0.032359129331624 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 243 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 121 AS parent_id, -0.032598242480086 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 298 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 149 AS parent_id, -0.032295707348926 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 598 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 299 AS parent_id, -0.032431344584194 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 599 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 299 AS parent_id, -0.032652951132933 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_13" AS 
(SELECT "DT_node_lookup_13"."KEY" AS "KEY", "DT_node_lookup_13".node_id_2 AS node_id_2, "DT_node_data_13".node_id AS node_id, "DT_node_data_13".feature AS feature, "DT_node_data_13"."threshold" AS "threshold", "DT_node_data_13".depth AS depth, "DT_node_data_13".parent_id AS parent_id, "DT_node_data_13"."Score" AS "Score" 
FROM "DT_node_lookup_13" LEFT OUTER JOIN "DT_node_data_13" ON "DT_node_lookup_13".node_id_2 = "DT_node_data_13".node_id), 
"LGBM_Model_1_3" AS 
(SELECT "DT_Output_13"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_13"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_13"), 
"DT_node_lookup_14" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.56281341656356) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.011342994322324) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.723179475915204) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.286549703841539) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.62484514521883) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.647230583531285) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_48 <= -0.252762355564859) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= 0.245101647444908) THEN 258 ELSE 259 END END ELSE 65 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 0.339309215561207) THEN 66 ELSE 67 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.569079127975254) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.888593351942693) THEN 68 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.12238492391526) THEN 138 ELSE 139 END END ELSE 35 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -0.03548042211694) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.206619871856084) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.418669433303156) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= 0.886285207509524) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= -0.94980319921625) THEN 80 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_61 <= -0.450094012609338) THEN 162 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_100 <= -0.17185434256011) THEN 326 ELSE 327 END END END ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= 0.287043033474738) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.121856302139455) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.054160248854451) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= -0.295457677565736) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.385650072856247) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.341560323322132) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= 0.309714663431319) THEN 24 ELSE 25 END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= -0.854395912652681) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= -1.03169971172907) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.2651086500887) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.116535413072189) THEN 124 ELSE 125 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_46 <= -0.109617746607824) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_14" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.042191666152385 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.002879175905191 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.0195197938555 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.076431797274527 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.029525590894495 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.012836386338391 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.018863055416786 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.073593234477145 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.006024605308987 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.017896364031934 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.03234467370425 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.032990827107229 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.003602900416843 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.060757066720412 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.00349190814445 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.017183130095946 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 66 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, -0.009630447175814 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 67 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, 0.057929161327021 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 68 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 34 AS parent_id, -0.026286902632171 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 80 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, -0.025965589154746 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 124 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.032594762849369 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 125 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.03301676406397 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.033504167655534 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 127 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.032952794699133 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 128 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 64 AS parent_id, -0.009355144925555 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 138 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 69 AS parent_id, 0.002304425808718 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 139 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 69 AS parent_id, 0.059439428122259 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 162 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 81 AS parent_id, -0.03248357829026 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 258 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 129 AS parent_id, -0.033468359196906 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 259 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 129 AS parent_id, -0.03277213026158 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 326 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 163 AS parent_id, -0.03271080546852 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 327 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 163 AS parent_id, -0.033249718142637 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_14" AS 
(SELECT "DT_node_lookup_14"."KEY" AS "KEY", "DT_node_lookup_14".node_id_2 AS node_id_2, "DT_node_data_14".node_id AS node_id, "DT_node_data_14".feature AS feature, "DT_node_data_14"."threshold" AS "threshold", "DT_node_data_14".depth AS depth, "DT_node_data_14".parent_id AS parent_id, "DT_node_data_14"."Score" AS "Score" 
FROM "DT_node_lookup_14" LEFT OUTER JOIN "DT_node_data_14" ON "DT_node_lookup_14".node_id_2 = "DT_node_data_14".node_id), 
"LGBM_Model_2_3" AS 
(SELECT "DT_Output_14"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_14"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_14"), 
"DT_node_lookup_15" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.470663599441499) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.132832282716238) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.042664248041282) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.596853716516558) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.031260857754344) THEN 32 ELSE 33 END ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.290217350581293) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.467576267285187) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.021977526667093) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.33678409112609) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= 0.785088734710176) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.023909176282692) THEN 88 ELSE 89 END ELSE 45 END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= -0.242943961687349) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.316328451954822) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.355147203675119) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_80 <= -0.50384730985213) THEN 48 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_48 <= 0.354866443521427) THEN 98 ELSE 99 END END ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= 0.88315831302214) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.498754223298489) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= 0.418296509216595) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= -0.376372178348246) THEN 208 ELSE 209 END ELSE 105 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= -0.437036092883979) THEN 106 ELSE 107 END END ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_65 <= 1.378575993190553) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= -0.199889872546648) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_74 <= 1.100973025361643) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -0.253780512481725) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.239145054837181) THEN 224 ELSE 225 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_32 <= 0.507682314410179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.14436862672735) THEN 452 ELSE 453 END ELSE 227 END END ELSE 57 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.68910410819735) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 0.136709131773358) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.096445416123525) THEN 236 ELSE 237 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= -0.163624966732398) THEN 238 ELSE 239 END END END END ELSE 15 END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_15" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.016723039904058 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.021586531193635 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.046349425964371 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.014177113406333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.052197625717431 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.004636707622546 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.01878125986525 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.003497250943343 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.017233480150854 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.050350787789125 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.082337831569552 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.01187098433297 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.011972396927545 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.012078249051598 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.012735083421372 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 88 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.032694772851857 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 89 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.032395333126897 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 98 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 49 AS parent_id, -0.032892215879001 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 99 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 49 AS parent_id, -0.032535187596417 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 105 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 52 AS parent_id, 0.069582113708105 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 106 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 53 AS parent_id, 0.018148761904967 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 107 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 53 AS parent_id, -0.032940887668149 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 208 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 104 AS parent_id, 0.053612611147649 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 209 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 104 AS parent_id, 0.001059091992896 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 224 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, -0.032431254392276 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 225 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, -0.032126359928737 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 227 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 113 AS parent_id, -0.032385217145531 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 236 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, -0.025964008328923 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 237 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, 0.013894765497415 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 238 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.032915331703453 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 239 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.032501769079415 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 452 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 226 AS parent_id, -0.032529360885473 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 453 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 226 AS parent_id, -0.032778182001534 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_15" AS 
(SELECT "DT_node_lookup_15"."KEY" AS "KEY", "DT_node_lookup_15".node_id_2 AS node_id_2, "DT_node_data_15".node_id AS node_id, "DT_node_data_15".feature AS feature, "DT_node_data_15"."threshold" AS "threshold", "DT_node_data_15".depth AS depth, "DT_node_data_15".parent_id AS parent_id, "DT_node_data_15"."Score" AS "Score" 
FROM "DT_node_lookup_15" LEFT OUTER JOIN "DT_node_data_15" ON "DT_node_lookup_15".node_id_2 = "DT_node_data_15".node_id), 
"LGBM_Model_3_3" AS 
(SELECT "DT_Output_15"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_15"."Score" AS "Score_3" 
FROM "DT_Output_15"), 
"DT_node_lookup_16" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.451713696089738) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.854803386634702) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.210274841129939) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.178118760405181) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.129707817467635) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.211119237510429) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= -0.984986103252644) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.606392530350532) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.119038675452984) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_76 <= -0.237977581764035) THEN 168 ELSE 169 END ELSE 85 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 1.104351102147555) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_91 <= 0.562444463680338) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= -0.413345050062246) THEN 344 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_62 <= -0.444219501272633) THEN 690 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_75 <= 0.04034621600418) THEN 1382 ELSE 1383 END END END ELSE 173 END ELSE 87 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.733317468841946) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.538780223174287) THEN 46 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= -0.701313696683763) THEN 94 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_78 <= 0.342064895124651) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= -0.503508922561036) THEN 380 ELSE 381 END ELSE 191 END END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.612307081194479) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= 0.21738831703587) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_39 <= 0.868260319879006) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.03157798380693) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.042371581456281) THEN 104 ELSE 105 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.081660873982223) THEN 106 ELSE 107 END END ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -0.509650615548876) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_76 <= -0.260014089237414) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.744643314443216) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_16" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.014512624899492 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, -0.032482407310879 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.006247838109465 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.005067766964112 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.051338925397138 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.004815464047894 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.031027218985786 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.03020064568661 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.027818284328522 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.011551656184787 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.010942624915985 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.078344164996248 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.052093331053355 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.032316697473223 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.032880311988667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, 0.007911318126752 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 87 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, -0.01905656218948 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 94 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 47 AS parent_id, 0.00045082693762 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 104 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 52 AS parent_id, 0.07091849028114 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 105 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 52 AS parent_id, 0.015813641162793 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 106 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 53 AS parent_id, 0.027116902314596 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 107 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 53 AS parent_id, -0.027668030874004 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 168 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 84 AS parent_id, -0.025169431236754 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 169 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 84 AS parent_id, -0.032742523842489 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 173 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 86 AS parent_id, -0.032776250462021 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 191 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 95 AS parent_id, -0.025553135174805 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 344 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 172 AS parent_id, -0.032597002873403 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 380 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 190 AS parent_id, -0.032787498449345 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 381 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 190 AS parent_id, -0.03242188703872 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 690 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 345 AS parent_id, -0.032456980963915 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1382 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 691 AS parent_id, -0.031873764345868 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1383 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 691 AS parent_id, -0.032218826272208 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_16" AS 
(SELECT "DT_node_lookup_16"."KEY" AS "KEY", "DT_node_lookup_16".node_id_2 AS node_id_2, "DT_node_data_16".node_id AS node_id, "DT_node_data_16".feature AS feature, "DT_node_data_16"."threshold" AS "threshold", "DT_node_data_16".depth AS depth, "DT_node_data_16".parent_id AS parent_id, "DT_node_data_16"."Score" AS "Score" 
FROM "DT_node_lookup_16" LEFT OUTER JOIN "DT_node_data_16" ON "DT_node_lookup_16".node_id_2 = "DT_node_data_16".node_id), 
"LGBM_Model_0_4" AS 
(SELECT "DT_Output_16"."KEY" AS "KEY", "DT_Output_16"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_16"), 
"DT_node_lookup_17" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 1.109229383375731) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.467524439236323) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= -0.682510392937524) THEN 144 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.118778094089726) THEN 290 ELSE 291 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.225073627470614) THEN 146 ELSE 147 END END ELSE 37 END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.289191756017089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= 0.393571563299742) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.683670144151382) THEN 40 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= 0.539290836109095) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.047924040922726) THEN 164 ELSE 165 END ELSE 83 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.113904240197745) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.510874314724548) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.253978525786874) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.18261792646899) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.343880447956846) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.05669226674118) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.199920981337121) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= 0.307866750310075) THEN 52 ELSE 53 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= -0.199889872546648) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= -0.732268444520137) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.104775554409621) THEN 28 ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.918555259495295) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= -0.378644630115165) THEN 60 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_71 <= 0.42286303719573) THEN 122 ELSE 123 END END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_17" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.001674672796162 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.003110817195662 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.033172523931988 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.032173923001506 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.006044560522926 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.049633682754017 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.016728533042457 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.024871912765617 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.014710799314694 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.008527963867202 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.028658287210988 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.019489188351165 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.019207512411689 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.0319462666964 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.032255082018626 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, -0.021861640284691 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 53 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.056653223111383 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.076689354348224 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.040148935615716 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.002006272525584 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, -0.001581324060565 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 122 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 61 AS parent_id, -0.032492547772349 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 123 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 61 AS parent_id, -0.025108063479355 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 144 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 72 AS parent_id, -0.031875593885074 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 146 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 73 AS parent_id, -0.032511289388985 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 147 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 73 AS parent_id, -0.032184062415189 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 164 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, 0.015211570227999 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 165 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, 0.064522146571669 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 290 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 145 AS parent_id, -0.03230769307017 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 291 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 145 AS parent_id, -0.03202257163021 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_17" AS 
(SELECT "DT_node_lookup_17"."KEY" AS "KEY", "DT_node_lookup_17".node_id_2 AS node_id_2, "DT_node_data_17".node_id AS node_id, "DT_node_data_17".feature AS feature, "DT_node_data_17"."threshold" AS "threshold", "DT_node_data_17".depth AS depth, "DT_node_data_17".parent_id AS parent_id, "DT_node_data_17"."Score" AS "Score" 
FROM "DT_node_lookup_17" LEFT OUTER JOIN "DT_node_data_17" ON "DT_node_lookup_17".node_id_2 = "DT_node_data_17".node_id), 
"LGBM_Model_1_4" AS 
(SELECT "DT_Output_17"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_17"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_17"), 
"DT_node_lookup_18" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.56281341656356) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.011342994322324) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.723179475915204) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.286549703841539) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.086879861942097) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.373885303038597) THEN 64 ELSE 65 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= 0.695240327061486) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.21959172283653) THEN 132 ELSE 133 END ELSE 67 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.569079127975254) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.888593351942693) THEN 68 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_83 <= -0.303115065610459) THEN 138 ELSE 139 END END ELSE 35 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -0.03548042211694) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.206619871856084) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.418669433303156) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= 0.886285207509524) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.578406245441717) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_55 <= -0.146925077462194) THEN 320 ELSE 321 END ELSE 161 END ELSE 81 END ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_92 <= -0.045987404204829) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.121856302139455) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.054160248854451) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= -0.071740042452096) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.385650072856247) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.341560323322132) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= 0.309714663431319) THEN 24 ELSE 25 END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= -0.854395912652681) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= -1.03169971172907) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.189453501428962) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.116535413072189) THEN 124 ELSE 125 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_56 <= 0.477955873335749) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_18" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.039819519593318 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.002730604622233 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.019039816889089 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.071665649800987 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.029236746151956 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.012379986542134 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.018497506538341 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.069145870619377 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.005994592668484 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.021099433468119 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.027042634973097 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.032708343267998 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.003513592318955 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.002020280215162 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.051294733457864 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 64 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, -0.03289747824204 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, -0.000220686418103 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 67 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, 0.050263151403123 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 68 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 34 AS parent_id, -0.025912877113664 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 81 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, -0.025554744944113 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 124 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.032282724727012 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 125 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.032752417688184 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.033215317583635 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 127 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.032599498908146 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 132 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 66 AS parent_id, 0.023162728462967 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 133 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 66 AS parent_id, -0.020900658371714 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 138 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 69 AS parent_id, -0.000141001402407 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 139 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 69 AS parent_id, 0.054667827607575 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 161 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 80 AS parent_id, -0.033055670867117 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 320 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 160 AS parent_id, -0.032192584890227 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 321 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 160 AS parent_id, -0.03260007977871 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_18" AS 
(SELECT "DT_node_lookup_18"."KEY" AS "KEY", "DT_node_lookup_18".node_id_2 AS node_id_2, "DT_node_data_18".node_id AS node_id, "DT_node_data_18".feature AS feature, "DT_node_data_18"."threshold" AS "threshold", "DT_node_data_18".depth AS depth, "DT_node_data_18".parent_id AS parent_id, "DT_node_data_18"."Score" AS "Score" 
FROM "DT_node_lookup_18" LEFT OUTER JOIN "DT_node_data_18" ON "DT_node_lookup_18".node_id_2 = "DT_node_data_18".node_id), 
"LGBM_Model_2_4" AS 
(SELECT "DT_Output_18"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_18"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_18"), 
"DT_node_lookup_19" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.288392294079473) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.132832282716238) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.042664248041282) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.826497355433401) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.128387840215334) THEN 32 ELSE 33 END ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.290217350581293) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.168994536624717) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_92 <= -0.359266598988793) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= 0.270769734381647) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.752410410390122) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.320437291030534) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_100 <= -0.125919764513613) THEN 92 ELSE 93 END ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -1.501079257101271) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.316328451954822) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 1.403172725063492) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_91 <= 0.824790075362175) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= -0.525721970105762) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= -0.126557701351512) THEN 224 ELSE 225 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.150385157106) THEN 226 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.509134059401132) THEN 454 ELSE 455 END END END ELSE 57 END ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= 0.834237459066138) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.493048341442552) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= -0.216227704490804) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= 0.887748560514237) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN 480 ELSE 481 END ELSE 241 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.07911477377876) THEN 242 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.194330210372763) THEN 486 ELSE 487 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= -0.401603413951631) THEN 122 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_91 <= 0.637290635213974) THEN 246 ELSE 247 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.194643031767761) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_19" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, 0.029501550527272 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.01297162496798 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.038645465989774 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.014335429031799 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.003281467426229 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.026532213853624 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.003727526477848 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.039642248564164 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.078479191733863 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.033396758234975 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.032472663420344 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.053440418212152 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.00409520604927 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.025900241980613 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.033251056859439 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 92 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, -0.01995666911346 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 93 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, 0.032013729812711 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 122 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 61 AS parent_id, 0.00336651966486 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 224 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, -0.032979141672732 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 225 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, -0.032508966686885 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 226 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 113 AS parent_id, -0.032573120119565 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 241 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.020336340360351 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 242 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 121 AS parent_id, 0.020319339911226 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 246 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 123 AS parent_id, -0.032845652831471 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 247 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 123 AS parent_id, -0.025448609202126 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 454 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 227 AS parent_id, -0.031995347878946 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 455 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 227 AS parent_id, -0.032387043507372 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 480 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 240 AS parent_id, 0.023732163921553 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 481 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 240 AS parent_id, 0.079204056895143 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 486 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 243 AS parent_id, -0.032807221048368 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 487 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 243 AS parent_id, -0.025303339760909 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_19" AS 
(SELECT "DT_node_lookup_19"."KEY" AS "KEY", "DT_node_lookup_19".node_id_2 AS node_id_2, "DT_node_data_19".node_id AS node_id, "DT_node_data_19".feature AS feature, "DT_node_data_19"."threshold" AS "threshold", "DT_node_data_19".depth AS depth, "DT_node_data_19".parent_id AS parent_id, "DT_node_data_19"."Score" AS "Score" 
FROM "DT_node_lookup_19" LEFT OUTER JOIN "DT_node_data_19" ON "DT_node_lookup_19".node_id_2 = "DT_node_data_19".node_id), 
"LGBM_Model_3_4" AS 
(SELECT "DT_Output_19"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_19"."Score" AS "Score_3" 
FROM "DT_Output_19")
 SELECT "LGBM_B1"."KEY", "LGBM_B1"."Score_0", "LGBM_B1"."Score_1", "LGBM_B1"."Score_2", "LGBM_B1"."Score_3" 
FROM (SELECT "LGBM_esu_1"."KEY" AS "KEY", "LGBM_esu_1"."Score_0" AS "Score_0", "LGBM_esu_1"."Score_1" AS "Score_1", "LGBM_esu_1"."Score_2" AS "Score_2", "LGBM_esu_1"."Score_3" AS "Score_3" 
FROM (SELECT "LGBM_Model_2_2"."KEY" AS "KEY", "LGBM_Model_2_2"."Score_0" AS "Score_0", "LGBM_Model_2_2"."Score_1" AS "Score_1", "LGBM_Model_2_2"."Score_2" AS "Score_2", "LGBM_Model_2_2"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_2" UNION ALL SELECT "LGBM_Model_3_2"."KEY" AS "KEY", "LGBM_Model_3_2"."Score_0" AS "Score_0", "LGBM_Model_3_2"."Score_1" AS "Score_1", "LGBM_Model_3_2"."Score_2" AS "Score_2", "LGBM_Model_3_2"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_2" UNION ALL SELECT "LGBM_Model_0_3"."KEY" AS "KEY", "LGBM_Model_0_3"."Score_0" AS "Score_0", "LGBM_Model_0_3"."Score_1" AS "Score_1", "LGBM_Model_0_3"."Score_2" AS "Score_2", "LGBM_Model_0_3"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_3" UNION ALL SELECT "LGBM_Model_1_3"."KEY" AS "KEY", "LGBM_Model_1_3"."Score_0" AS "Score_0", "LGBM_Model_1_3"."Score_1" AS "Score_1", "LGBM_Model_1_3"."Score_2" AS "Score_2", "LGBM_Model_1_3"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_3" UNION ALL SELECT "LGBM_Model_2_3"."KEY" AS "KEY", "LGBM_Model_2_3"."Score_0" AS "Score_0", "LGBM_Model_2_3"."Score_1" AS "Score_1", "LGBM_Model_2_3"."Score_2" AS "Score_2", "LGBM_Model_2_3"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_3" UNION ALL SELECT "LGBM_Model_3_3"."KEY" AS "KEY", "LGBM_Model_3_3"."Score_0" AS "Score_0", "LGBM_Model_3_3"."Score_1" AS "Score_1", "LGBM_Model_3_3"."Score_2" AS "Score_2", "LGBM_Model_3_3"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_3" UNION ALL SELECT "LGBM_Model_0_4"."KEY" AS "KEY", "LGBM_Model_0_4"."Score_0" AS "Score_0", "LGBM_Model_0_4"."Score_1" AS "Score_1", "LGBM_Model_0_4"."Score_2" AS "Score_2", "LGBM_Model_0_4"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_4" UNION ALL SELECT "LGBM_Model_1_4"."KEY" AS "KEY", "LGBM_Model_1_4"."Score_0" AS "Score_0", "LGBM_Model_1_4"."Score_1" AS "Score_1", "LGBM_Model_1_4"."Score_2" AS "Score_2", "LGBM_Model_1_4"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_4" UNION ALL SELECT "LGBM_Model_2_4"."KEY" AS "KEY", "LGBM_Model_2_4"."Score_0" AS "Score_0", "LGBM_Model_2_4"."Score_1" AS "Score_1", "LGBM_Model_2_4"."Score_2" AS "Score_2", "LGBM_Model_2_4"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_4" UNION ALL SELECT "LGBM_Model_3_4"."KEY" AS "KEY", "LGBM_Model_3_4"."Score_0" AS "Score_0", "LGBM_Model_3_4"."Score_1" AS "Score_1", "LGBM_Model_3_4"."Score_2" AS "Score_2", "LGBM_Model_3_4"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_4") AS "LGBM_esu_1") AS "LGBM_B1") AS "U"

-- Code For temporary table tmp_20180416233648_7ikryl_lgbm part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416233648_7ikryl_lgbm  (
	"KEY" BIGINT, 
	"Score_0" FLOAT, 
	"Score_1" FLOAT, 
	"Score_2" FLOAT, 
	"Score_3" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416233648_7ikryl_lgbm part 2/2. Populate

INSERT INTO tmp_20180416233648_7ikryl_lgbm ("KEY", "Score_0", "Score_1", "Score_2", "Score_3") SELECT "U"."KEY", "U"."Score_0", "U"."Score_1", "U"."Score_2", "U"."Score_3" 
FROM (WITH "DT_node_lookup_20" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.32663052777751) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.067193373231848) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.554627746272502) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.504673555509635) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 0.352172623844089) THEN 32 ELSE 33 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.830687848471658) THEN 34 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.129409446931411) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.348440137132981) THEN 140 ELSE 141 END ELSE 71 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.078844973305049) THEN 38 ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= 1.18102959044037) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -1.397571837628473) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= -1.224499461905061) THEN 42 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -1.224330589791154) THEN 86 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= -1.045222093166181) THEN 174 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= -1.008788835808256) THEN 350 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.656913098244467) THEN 702 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= 0.258126936575414) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.045519383540314) THEN 2812 ELSE 2813 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_48 <= 0.107619922722163) THEN 2814 ELSE 2815 END END END END END END END END ELSE 11 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -1.010601668066718) THEN 12 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= -0.677998099123223) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -1.297155363306454) THEN 54 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= 0.059095869813727) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.174698122477522) THEN 220 ELSE 221 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_37 <= -0.365324212395256) THEN 222 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.040954016730826) THEN 446 ELSE 447 END END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_39 <= -0.862112593505175) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.59858030349317) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= -0.340509219310514) THEN 60 ELSE 61 END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_20" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 5 AS parent_id, 0.00600998384326 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 12 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.060243360035788 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.026647377158687 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.011851988503104 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.000468067079941 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.024104081221521 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.001399568378914 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, -0.027937302647202 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.013230649605462 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, -0.012995196545323 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.031965943476509 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.032601071300393 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.003197796904532 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.065678105072541 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.024912883344698 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.032550364247412 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 71 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 35 AS parent_id, 0.010256525169131 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 86 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, -0.018298392271228 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 140 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 70 AS parent_id, 0.036285361659521 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 141 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 70 AS parent_id, 0.078437867895179 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 174 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 87 AS parent_id, -0.025159447300064 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 220 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 110 AS parent_id, 0.019272833317738 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 221 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 110 AS parent_id, -0.029376742783172 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 222 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 111 AS parent_id, -0.000497103577844 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 350 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 175 AS parent_id, -0.033062637170309 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 446 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 223 AS parent_id, 0.076574386532539 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 447 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 223 AS parent_id, 0.016645370347293 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 702 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 351 AS parent_id, -0.032798366042241 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2812 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1406 AS parent_id, -0.03245970888801 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2813 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1406 AS parent_id, -0.032060565425965 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2814 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1407 AS parent_id, -0.031746320509026 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2815 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1407 AS parent_id, -0.032109394777407 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_20" AS 
(SELECT "DT_node_lookup_20"."KEY" AS "KEY", "DT_node_lookup_20".node_id_2 AS node_id_2, "DT_node_data_20".node_id AS node_id, "DT_node_data_20".feature AS feature, "DT_node_data_20"."threshold" AS "threshold", "DT_node_data_20".depth AS depth, "DT_node_data_20".parent_id AS parent_id, "DT_node_data_20"."Score" AS "Score" 
FROM "DT_node_lookup_20" LEFT OUTER JOIN "DT_node_data_20" ON "DT_node_lookup_20".node_id_2 = "DT_node_data_20".node_id), 
"LGBM_Model_0_5" AS 
(SELECT "DT_Output_20"."KEY" AS "KEY", "DT_Output_20"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_20"), 
"DT_node_lookup_21" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= -1.015381226342707) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.467524439236323) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.110667003903851) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.081827587029679) THEN 296 ELSE 297 END ELSE 149 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_91 <= -0.082258560438678) THEN 150 ELSE 151 END END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.289191756017089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= 0.393571563299742) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.683670144151382) THEN 40 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= 0.539290836109095) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.047924040922726) THEN 164 ELSE 165 END ELSE 83 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= 0.363211087276031) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_67 <= 0.459310297817733) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.510874314724548) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.253978525786874) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.18261792646899) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.343880447956846) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.109401415265847) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.199920981337121) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= 0.307866750310075) THEN 52 ELSE 53 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= 0.515243478629052) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= -0.732268444520137) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.104775554409621) THEN 28 ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= 0.85419311486618) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= -0.767550224198527) THEN 60 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.59653211235878) THEN 122 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.383880108412604) THEN 246 ELSE 247 END END END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_21" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.0015794986342 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.003078975322329 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.033059599652186 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.031322176776867 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.005867954489443 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.047239926357281 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.01284622124578 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.024453392765227 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.014411187186476 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.012363823294293 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.019189970821879 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.018614422671179 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.031630744977688 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.032027717596498 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, -0.021535329241309 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 53 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.053741305101612 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.038697571885453 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.073120048631972 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.012409358907561 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, -0.00150409682019 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.032762708364834 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.018240533202472 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 122 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 61 AS parent_id, -0.025096276417104 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 149 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 74 AS parent_id, -0.032035568810062 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 150 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 75 AS parent_id, -0.031954346986923 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 151 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 75 AS parent_id, -0.032255358262638 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 164 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, 0.014517006297798 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 165 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, 0.060923160530871 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 246 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 123 AS parent_id, -0.032154660160865 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 247 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 123 AS parent_id, -0.033350669951987 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 296 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 148 AS parent_id, -0.031869362388995 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 297 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 148 AS parent_id, -0.031547758038846 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_21" AS 
(SELECT "DT_node_lookup_21"."KEY" AS "KEY", "DT_node_lookup_21".node_id_2 AS node_id_2, "DT_node_data_21".node_id AS node_id, "DT_node_data_21".feature AS feature, "DT_node_data_21"."threshold" AS "threshold", "DT_node_data_21".depth AS depth, "DT_node_data_21".parent_id AS parent_id, "DT_node_data_21"."Score" AS "Score" 
FROM "DT_node_lookup_21" LEFT OUTER JOIN "DT_node_data_21" ON "DT_node_lookup_21".node_id_2 = "DT_node_data_21".node_id), 
"LGBM_Model_1_5" AS 
(SELECT "DT_Output_21"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_21"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_21"), 
"DT_node_lookup_22" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.56281341656356) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.011342994322324) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.723179475915204) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.286549703841539) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.62484514521883) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.647230583531285) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_48 <= -0.252762355564859) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= 0.219489280825685) THEN 258 ELSE 259 END END ELSE 65 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 0.339309215561207) THEN 66 ELSE 67 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.569079127975254) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.016350857180627) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.059325797761893) THEN 136 ELSE 137 END ELSE 69 END ELSE 35 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -0.03548042211694) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.40081436483578) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.893457035764529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= -0.08075101967783) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.625981020619298) THEN 80 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.082874793028348) THEN 162 ELSE 163 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.113629795823364) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_74 <= 0.0) THEN 164 ELSE 165 END ELSE 83 END END ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= -0.582578369936212) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_46 <= -0.5230959419645) THEN 46 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= -0.283389230272429) THEN 94 ELSE 95 END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.385650072856247) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.341560323322132) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= 0.309714663431319) THEN 24 ELSE 25 END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= -0.854395912652681) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= -1.03169971172907) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= -0.257237412809624) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.234585809645775) THEN 124 ELSE 125 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_34 <= 0.260619044598789) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_22" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.037802777947398 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.00261724087799 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.018442479453928 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.067438052456002 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.009941208145553 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.041310037137878 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.028924935848058 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.012016747061271 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.018162158068123 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.065201611352437 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.024448840848515 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.016298709991201 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 66 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, -0.009470589436121 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 67 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, 0.053858415998955 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 69 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 34 AS parent_id, 0.045139468802833 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 80 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, -0.032781309932475 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, 0.020891199697925 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 94 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 47 AS parent_id, -0.033024108401721 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 95 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 47 AS parent_id, -0.005731355495508 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 124 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.032373528127514 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 125 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.032955031521414 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.032466304703006 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 127 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.031933437873331 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 128 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 64 AS parent_id, -0.009118851685892 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 136 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 68 AS parent_id, -0.022543327649911 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 137 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 68 AS parent_id, 0.018602935540212 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 162 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 81 AS parent_id, -0.032461883406568 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 163 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 81 AS parent_id, -0.031851908371495 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 164 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, -0.018268876438378 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 165 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, -0.032578226076906 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 258 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 129 AS parent_id, -0.032263646574619 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 259 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 129 AS parent_id, -0.033137900306425 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_22" AS 
(SELECT "DT_node_lookup_22"."KEY" AS "KEY", "DT_node_lookup_22".node_id_2 AS node_id_2, "DT_node_data_22".node_id AS node_id, "DT_node_data_22".feature AS feature, "DT_node_data_22"."threshold" AS "threshold", "DT_node_data_22".depth AS depth, "DT_node_data_22".parent_id AS parent_id, "DT_node_data_22"."Score" AS "Score" 
FROM "DT_node_lookup_22" LEFT OUTER JOIN "DT_node_data_22" ON "DT_node_lookup_22".node_id_2 = "DT_node_data_22".node_id), 
"LGBM_Model_2_5" AS 
(SELECT "DT_Output_22"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_22"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_22"), 
"DT_node_lookup_23" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.288392294079473) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.132832282716238) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.422643992745158) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_85 <= 0.0) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.166177180770205) THEN 34 ELSE 35 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_56 <= -0.532802395130078) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.241101173459233) THEN 38 ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_47 <= 0.318785938587487) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= 0.328130691065211) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= 0.276470708453372) THEN 40 ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_39 <= 0.055634257491351) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= -0.343770308080513) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= 0.131276003408889) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -1.501079257101271) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.316328451954822) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 1.403172725063492) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_91 <= 0.824790075362175) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= -0.525721970105762) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= -0.126557701351512) THEN 224 ELSE 225 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.150385157106) THEN 226 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.490340725988963) THEN 454 ELSE 455 END END END ELSE 57 END ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= 0.834237459066138) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.493048341442552) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.531542699527761) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.406734127691457) THEN 240 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.330524834801073) THEN 482 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_82 <= 0.580871680558816) THEN 966 ELSE 967 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.613402552525358) THEN 242 ELSE 243 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= -0.401603413951631) THEN 122 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.0) THEN 246 ELSE 247 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_39 <= -0.10671314050035) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_23" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, 0.028177742846369 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.023903119648123 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.043902930170637 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.026505994021506 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.003596445552058 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.078115564617538 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.051994645691504 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, 0.011176405393582 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.027505338346595 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.033011585204976 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.032202965313075 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.019560084296954 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.023666397020146 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.007355470628741 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.064122858155253 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.003919416045434 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.02551830224584 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.032957792103754 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 122 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 61 AS parent_id, 0.00324424177479 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 224 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, -0.032709863830676 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 225 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, -0.032249810918239 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 226 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 113 AS parent_id, -0.032345373325942 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 240 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, 0.029239128128612 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 242 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 121 AS parent_id, 0.063999913313387 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 243 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 121 AS parent_id, 0.011252764540951 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 246 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 123 AS parent_id, -0.032565430507144 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 247 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 123 AS parent_id, -0.025063859926747 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 454 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 227 AS parent_id, -0.031691769252521 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 455 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 227 AS parent_id, -0.032109557892085 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 482 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 241 AS parent_id, 0.011095815013159 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 966 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 483 AS parent_id, -0.032839169316447 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 967 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 483 AS parent_id, -0.012259363279236 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_23" AS 
(SELECT "DT_node_lookup_23"."KEY" AS "KEY", "DT_node_lookup_23".node_id_2 AS node_id_2, "DT_node_data_23".node_id AS node_id, "DT_node_data_23".feature AS feature, "DT_node_data_23"."threshold" AS "threshold", "DT_node_data_23".depth AS depth, "DT_node_data_23".parent_id AS parent_id, "DT_node_data_23"."Score" AS "Score" 
FROM "DT_node_lookup_23" LEFT OUTER JOIN "DT_node_data_23" ON "DT_node_lookup_23".node_id_2 = "DT_node_data_23".node_id), 
"LGBM_Model_3_5" AS 
(SELECT "DT_Output_23"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_23"."Score" AS "Score_3" 
FROM "DT_Output_23"), 
"DT_node_lookup_24" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.397498703526244) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.79602768915845) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_80 <= 0.240219104609845) THEN 8 ELSE 9 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= 0.081119450256599) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= 0.194339779155819) THEN 40 ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_78 <= 0.357284795025933) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= 0.028435129072326) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.56744503778288) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= 0.269256087066403) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.14664541625915) THEN 92 ELSE 93 END ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_65 <= 0.174125873386804) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= 0.058509527731855) THEN 48 ELSE 49 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.276056103373906) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.240745697470727) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.315436819236289) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.337705894530969) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.136011071233652) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_65 <= 0.295335237153966) THEN 112 ELSE 113 END ELSE 57 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.701497555598703) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_98 <= -0.26270429282839) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.039180789366854) THEN 236 ELSE 237 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.84212082244031) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_55 <= -0.057250622546156) THEN 476 ELSE 477 END ELSE 239 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.930429083667873) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= 0.880825547268369) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= 0.560432335967992) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_79 <= 0.308458898053918) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_76 <= 0.377515482978447) THEN 496 ELSE 497 END ELSE 249 END ELSE 125 END ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_24" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.010555777682271 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.039356367368753 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.031591237095307 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.01851695104896 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.029074063254055 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.013492734861246 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, 0.026291668799477 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.026079286155626 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.018533444558735 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.031843281410921 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.010686784948944 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 49 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, 0.044341553737291 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.038668172872492 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.070282758558379 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, 0.001128598746074 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.025014210513354 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.003007599473564 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.032878299487247 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.032154652952145 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 92 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, -0.032693442428084 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 93 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, -0.03206546975568 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 112 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, 0.071990726699144 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 113 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, 0.029098316855388 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 125 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.024908368061921 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 236 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, 0.024424914160773 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 237 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, -0.025970420703748 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 239 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.024938457943953 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 249 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 124 AS parent_id, -0.031925853285784 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 476 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 238 AS parent_id, -0.032324707183141 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 477 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 238 AS parent_id, -0.03314565152923 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 496 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 248 AS parent_id, -0.032372596004798 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 497 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 248 AS parent_id, -0.033155096386185 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_24" AS 
(SELECT "DT_node_lookup_24"."KEY" AS "KEY", "DT_node_lookup_24".node_id_2 AS node_id_2, "DT_node_data_24".node_id AS node_id, "DT_node_data_24".feature AS feature, "DT_node_data_24"."threshold" AS "threshold", "DT_node_data_24".depth AS depth, "DT_node_data_24".parent_id AS parent_id, "DT_node_data_24"."Score" AS "Score" 
FROM "DT_node_lookup_24" LEFT OUTER JOIN "DT_node_data_24" ON "DT_node_lookup_24".node_id_2 = "DT_node_data_24".node_id), 
"LGBM_Model_0_6" AS 
(SELECT "DT_Output_24"."KEY" AS "KEY", "DT_Output_24"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_24"), 
"DT_node_lookup_25" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -1.06711085314315) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.467524439236323) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= 0.50647872996458) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.024412892653843) THEN 296 ELSE 297 END ELSE 149 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 0.1859588713639) THEN 150 ELSE 151 END END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.289191756017089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= -0.051056202544623) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= -0.270231831732882) THEN 40 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.668088367891737) THEN 82 ELSE 83 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.419914641948611) THEN 42 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -0.154457965939948) THEN 86 ELSE 87 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= -0.385345369294838) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.253978525786874) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.18261792646899) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.450498715896181) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.309584346770503) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.343880447956846) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_78 <= 0.26899018300847) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= -0.732268444520137) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.104775554409621) THEN 28 ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.918555259495295) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.795576321120505) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_39 <= 0.750649516855533) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_59 <= -0.36829044127069) THEN 240 ELSE 241 END ELSE 121 END ELSE 61 END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_25" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.001431437602704 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.002963909082718 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.029491909152564 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.073038454688264 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.023308130242305 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.005745777756396 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.044913033736041 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.016489685290584 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.02409647789755 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, 0.05675693853246 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.021930315161421 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.026428185464666 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.012436267801557 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.031363091457354 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.031826896602712 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.048202266166517 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.002254468524495 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.00651238869154 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 82 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, -0.021486472489393 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, 0.038819767088064 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 86 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, -0.002398962332182 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 87 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, -0.032482484610175 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 121 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, -0.010677303253991 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 149 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 74 AS parent_id, -0.031821073486086 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 150 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 75 AS parent_id, -0.032110244804357 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 151 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 75 AS parent_id, -0.031703902101412 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 240 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.031638645249677 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 241 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.031981165993203 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 296 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 148 AS parent_id, -0.03130490536183 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 297 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 148 AS parent_id, -0.031645269901482 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_25" AS 
(SELECT "DT_node_lookup_25"."KEY" AS "KEY", "DT_node_lookup_25".node_id_2 AS node_id_2, "DT_node_data_25".node_id AS node_id, "DT_node_data_25".feature AS feature, "DT_node_data_25"."threshold" AS "threshold", "DT_node_data_25".depth AS depth, "DT_node_data_25".parent_id AS parent_id, "DT_node_data_25"."Score" AS "Score" 
FROM "DT_node_lookup_25" LEFT OUTER JOIN "DT_node_data_25" ON "DT_node_lookup_25".node_id_2 = "DT_node_data_25".node_id), 
"LGBM_Model_1_6" AS 
(SELECT "DT_Output_25"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_25"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_25"), 
"DT_node_lookup_26" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.56281341656356) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.011342994322324) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -1.355449640017905) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.935044206679286) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= 0.236270660129605) THEN 36 ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.265848144446139) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.03939696066271) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= -0.068874798285621) THEN 152 ELSE 153 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= 0.621654485084281) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= -0.192370202371293) THEN 308 ELSE 309 END ELSE 155 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_67 <= -0.901438832503692) THEN 78 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.068597032331301) THEN 158 ELSE 159 END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.397768403334476) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.726668846443118) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.101166707848982) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.485637271654055) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.979055337401938) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= 0.150023186846378) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= 0.940801256298563) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_59 <= -0.239843156526295) THEN 352 ELSE 353 END ELSE 177 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= 0.328758522944836) THEN 178 ELSE 179 END END ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.172160419561616) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.385650072856247) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.341560323322132) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= 0.309714663431319) THEN 24 ELSE 25 END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= -0.854395912652681) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_32 <= 1.203504495776177) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_59 <= 0.821444010327461) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.079199649691186) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_74 <= 0.143278837975252) THEN 240 ELSE 241 END ELSE 121 END ELSE 61 END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_26" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.05545189520991 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.035884129188689 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.002551431106602 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.00159309498394 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.028631813769406 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.011612812156878 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.017750755350018 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.032535316783004 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.018706836772433 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.031828879103341 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.032506563341055 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.033614238411409 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.067209345351698 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.002886873273257 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.032539748997812 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 78 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 39 AS parent_id, 0.004956741474316 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 121 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, -0.032252591617825 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 152 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 76 AS parent_id, -0.003357210535292 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 153 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 76 AS parent_id, 0.046848911001456 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 155 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 77 AS parent_id, 0.011630065885193 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 158 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 79 AS parent_id, 0.031319672900821 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 159 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 79 AS parent_id, 0.067549611798997 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 177 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 88 AS parent_id, -0.018570832372584 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 178 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 89 AS parent_id, -0.026640156394863 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 179 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 89 AS parent_id, 0.028148525700921 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 240 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.031535151633962 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 241 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.03216670192754 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 308 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 154 AS parent_id, -0.033221196633914 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 309 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 154 AS parent_id, -0.019075843579042 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 352 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 176 AS parent_id, -0.033025363291703 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 353 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 176 AS parent_id, -0.03218893689874 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_26" AS 
(SELECT "DT_node_lookup_26"."KEY" AS "KEY", "DT_node_lookup_26".node_id_2 AS node_id_2, "DT_node_data_26".node_id AS node_id, "DT_node_data_26".feature AS feature, "DT_node_data_26"."threshold" AS "threshold", "DT_node_data_26".depth AS depth, "DT_node_data_26".parent_id AS parent_id, "DT_node_data_26"."Score" AS "Score" 
FROM "DT_node_lookup_26" LEFT OUTER JOIN "DT_node_data_26" ON "DT_node_lookup_26".node_id_2 = "DT_node_data_26".node_id), 
"LGBM_Model_2_6" AS 
(SELECT "DT_Output_26"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_26"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_26"), 
"DT_node_lookup_27" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.288392294079473) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -1.157031743150364) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_78 <= 0.133771875937608) THEN 8 ELSE 9 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.181398425167108) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.142409972636937) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= -0.17008846984759) THEN 40 ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= -0.116140614674369) THEN 42 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= -0.057943411474019) THEN 86 ELSE 87 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -0.872918451664946) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= -0.304193546228245) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.185850313096715) THEN 92 ELSE 93 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= -0.563322389371045) THEN 94 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= 0.10842062931728) THEN 190 ELSE 191 END END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.335113709558737) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.875954880239882) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.067193373231848) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.890738256712341) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.839675723091807) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.285206357789187) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_48 <= 0.079063103911357) THEN 216 ELSE 217 END ELSE 109 END ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -1.501079257101271) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.483311018661744) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.767448294248176) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= 0.019664556508871) THEN 120 ELSE 121 END ELSE 61 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.756747021569668) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -1.052583656564832) THEN 126 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_43 <= -0.974016415571864) THEN 254 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_71 <= -0.637857300538418) THEN 510 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= -0.352626939019762) THEN 1022 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.324960303401877) THEN 2046 ELSE 2047 END END END END END END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_27" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.036155627088473 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.067738868900044 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.042065457509447 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.03109705195843 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.032226834919809 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.017388173524806 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.012282984206028 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, 0.016903792755017 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, 0.06341653958198 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.018320787876083 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, -0.032757492932015 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.055324709628816 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, 0.008033337454823 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 86 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, -0.00261256666159 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 87 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, 0.047811862250615 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 92 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, -0.02557792218278 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 93 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, 0.023340893414505 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 94 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 47 AS parent_id, -0.025352108643929 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 109 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 54 AS parent_id, -0.032438122538486 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 120 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, -0.025308282148805 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 121 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, 0.021139365486977 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.001592855825117 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 190 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 95 AS parent_id, -0.032530572516744 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 191 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 95 AS parent_id, -0.033717348407508 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 216 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 108 AS parent_id, -0.032128097802217 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 217 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 108 AS parent_id, -0.031618025051988 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 254 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 127 AS parent_id, -0.005917573675125 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 510 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 255 AS parent_id, -0.025073925526649 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1022 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 511 AS parent_id, -0.032776451820114 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2046 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 1023 AS parent_id, -0.032305153907234 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2047 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 1023 AS parent_id, -0.031659256680826 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_27" AS 
(SELECT "DT_node_lookup_27"."KEY" AS "KEY", "DT_node_lookup_27".node_id_2 AS node_id_2, "DT_node_data_27".node_id AS node_id, "DT_node_data_27".feature AS feature, "DT_node_data_27"."threshold" AS "threshold", "DT_node_data_27".depth AS depth, "DT_node_data_27".parent_id AS parent_id, "DT_node_data_27"."Score" AS "Score" 
FROM "DT_node_lookup_27" LEFT OUTER JOIN "DT_node_data_27" ON "DT_node_lookup_27".node_id_2 = "DT_node_data_27".node_id), 
"LGBM_Model_3_6" AS 
(SELECT "DT_Output_27"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_27"."Score" AS "Score_3" 
FROM "DT_Output_27"), 
"DT_node_lookup_28" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.397498703526244) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.79602768915845) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.549648527181562) THEN 8 ELSE 9 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= 0.081119450256599) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= 0.194339779155819) THEN 40 ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= 0.397867616579586) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_35 <= 0.046906087052007) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.56744503778288) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= 0.269256087066403) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.14664541625915) THEN 92 ELSE 93 END ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.076267692737508) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_67 <= -0.246686174701261) THEN 48 ELSE 49 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.173903503143925) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.143729989656786) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.315436819236289) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.337705894530969) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.502525406123876) THEN 56 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.136011071233652) THEN 114 ELSE 115 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.701497555598703) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_98 <= -0.26270429282839) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.039180789366854) THEN 236 ELSE 237 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.84212082244031) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_37 <= 0.070617424311544) THEN 476 ELSE 477 END ELSE 239 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.930429083667873) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= 0.880825547268369) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= 0.560432335967992) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_79 <= 0.308458898053918) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_76 <= 0.377515482978447) THEN 496 ELSE 497 END ELSE 249 END ELSE 125 END ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_28" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.025690484166263 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.023666996074621 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.031304018700037 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.024703901653642 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.020620658700149 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.013096058638308 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, 0.025076699645487 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.025793911958538 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.018076395039387 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.031561221872644 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.009176092042899 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 49 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, 0.042259154693294 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.06323356442206 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.028912573546918 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 56 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.01339913504373 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.023884647133806 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.002907306733973 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.031931244743992 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.032623759293813 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 92 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, -0.032437277195835 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 93 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, -0.031830014772175 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 114 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 57 AS parent_id, 0.060644224522426 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 115 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 57 AS parent_id, 0.012787491310655 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 125 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.024517052210948 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 236 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, 0.023414404928745 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 237 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, -0.025618348072854 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 239 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.024517215757724 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 249 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 124 AS parent_id, -0.031658923001151 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 476 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 238 AS parent_id, -0.032119319421523 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 477 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 238 AS parent_id, -0.032881553257254 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 496 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 248 AS parent_id, -0.032127071801011 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 497 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 248 AS parent_id, -0.032853527783533 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_28" AS 
(SELECT "DT_node_lookup_28"."KEY" AS "KEY", "DT_node_lookup_28".node_id_2 AS node_id_2, "DT_node_data_28".node_id AS node_id, "DT_node_data_28".feature AS feature, "DT_node_data_28"."threshold" AS "threshold", "DT_node_data_28".depth AS depth, "DT_node_data_28".parent_id AS parent_id, "DT_node_data_28"."Score" AS "Score" 
FROM "DT_node_lookup_28" LEFT OUTER JOIN "DT_node_data_28" ON "DT_node_lookup_28".node_id_2 = "DT_node_data_28".node_id), 
"LGBM_Model_0_7" AS 
(SELECT "DT_Output_28"."KEY" AS "KEY", "DT_Output_28"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_28"), 
"DT_node_lookup_29" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 1.174984050407564) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.467524439236323) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.482531229170317) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.222001116985888) THEN 288 ELSE 289 END ELSE 145 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_91 <= 0.06165559368365) THEN 146 ELSE 147 END END ELSE 37 END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.289191756017089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= 0.393571563299742) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= 0.14514807228221) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.13282862449826) THEN 80 ELSE 81 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_98 <= -0.120059342779768) THEN 82 ELSE 83 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.298281198743656) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.269170717065253) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.103377803054307) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.253978525786874) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.18261792646899) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.450498715896181) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.309584346770503) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.343880447956846) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -1.043340498359494) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= -0.732268444520137) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= -0.227439202565589) THEN 28 ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= 0.85419311486618) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= -0.767550224198527) THEN 60 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.59653211235878) THEN 122 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.284744467491554) THEN 246 ELSE 247 END END END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_29" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.001314395053461 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.002905092522007 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.028317364592876 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.069217741746893 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.022965118919179 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.003776374784766 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.044363958345195 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.012476611643423 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.023714731741844 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.012042666399364 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.019292165777724 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.017658243115051 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.031103053082277 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.031592682509634 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.057353514345798 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.012737129998776 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.012312510873874 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 80 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, 0.036438340625213 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 81 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, -0.013482342164498 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 82 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, 0.022148707309629 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, 0.061479751703668 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.032732969132678 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.018332974538499 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 122 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 61 AS parent_id, -0.024408627163585 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 145 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 72 AS parent_id, -0.031129981637274 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 146 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 73 AS parent_id, -0.0315252891206 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 147 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 73 AS parent_id, -0.031891573365713 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 246 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 123 AS parent_id, -0.031607492002727 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 247 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 123 AS parent_id, -0.032975197937271 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 288 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 144 AS parent_id, -0.031692098707739 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 289 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 144 AS parent_id, -0.031292401606383 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_29" AS 
(SELECT "DT_node_lookup_29"."KEY" AS "KEY", "DT_node_lookup_29".node_id_2 AS node_id_2, "DT_node_data_29".node_id AS node_id, "DT_node_data_29".feature AS feature, "DT_node_data_29"."threshold" AS "threshold", "DT_node_data_29".depth AS depth, "DT_node_data_29".parent_id AS parent_id, "DT_node_data_29"."Score" AS "Score" 
FROM "DT_node_lookup_29" LEFT OUTER JOIN "DT_node_data_29" ON "DT_node_lookup_29".node_id_2 = "DT_node_data_29".node_id), 
"LGBM_Model_1_7" AS 
(SELECT "DT_Output_29"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_29"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_29")
 SELECT "LGBM_B2"."KEY", "LGBM_B2"."Score_0", "LGBM_B2"."Score_1", "LGBM_B2"."Score_2", "LGBM_B2"."Score_3" 
FROM (SELECT "LGBM_esu_2"."KEY" AS "KEY", "LGBM_esu_2"."Score_0" AS "Score_0", "LGBM_esu_2"."Score_1" AS "Score_1", "LGBM_esu_2"."Score_2" AS "Score_2", "LGBM_esu_2"."Score_3" AS "Score_3" 
FROM (SELECT "LGBM_Model_0_5"."KEY" AS "KEY", "LGBM_Model_0_5"."Score_0" AS "Score_0", "LGBM_Model_0_5"."Score_1" AS "Score_1", "LGBM_Model_0_5"."Score_2" AS "Score_2", "LGBM_Model_0_5"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_5" UNION ALL SELECT "LGBM_Model_1_5"."KEY" AS "KEY", "LGBM_Model_1_5"."Score_0" AS "Score_0", "LGBM_Model_1_5"."Score_1" AS "Score_1", "LGBM_Model_1_5"."Score_2" AS "Score_2", "LGBM_Model_1_5"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_5" UNION ALL SELECT "LGBM_Model_2_5"."KEY" AS "KEY", "LGBM_Model_2_5"."Score_0" AS "Score_0", "LGBM_Model_2_5"."Score_1" AS "Score_1", "LGBM_Model_2_5"."Score_2" AS "Score_2", "LGBM_Model_2_5"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_5" UNION ALL SELECT "LGBM_Model_3_5"."KEY" AS "KEY", "LGBM_Model_3_5"."Score_0" AS "Score_0", "LGBM_Model_3_5"."Score_1" AS "Score_1", "LGBM_Model_3_5"."Score_2" AS "Score_2", "LGBM_Model_3_5"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_5" UNION ALL SELECT "LGBM_Model_0_6"."KEY" AS "KEY", "LGBM_Model_0_6"."Score_0" AS "Score_0", "LGBM_Model_0_6"."Score_1" AS "Score_1", "LGBM_Model_0_6"."Score_2" AS "Score_2", "LGBM_Model_0_6"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_6" UNION ALL SELECT "LGBM_Model_1_6"."KEY" AS "KEY", "LGBM_Model_1_6"."Score_0" AS "Score_0", "LGBM_Model_1_6"."Score_1" AS "Score_1", "LGBM_Model_1_6"."Score_2" AS "Score_2", "LGBM_Model_1_6"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_6" UNION ALL SELECT "LGBM_Model_2_6"."KEY" AS "KEY", "LGBM_Model_2_6"."Score_0" AS "Score_0", "LGBM_Model_2_6"."Score_1" AS "Score_1", "LGBM_Model_2_6"."Score_2" AS "Score_2", "LGBM_Model_2_6"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_6" UNION ALL SELECT "LGBM_Model_3_6"."KEY" AS "KEY", "LGBM_Model_3_6"."Score_0" AS "Score_0", "LGBM_Model_3_6"."Score_1" AS "Score_1", "LGBM_Model_3_6"."Score_2" AS "Score_2", "LGBM_Model_3_6"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_6" UNION ALL SELECT "LGBM_Model_0_7"."KEY" AS "KEY", "LGBM_Model_0_7"."Score_0" AS "Score_0", "LGBM_Model_0_7"."Score_1" AS "Score_1", "LGBM_Model_0_7"."Score_2" AS "Score_2", "LGBM_Model_0_7"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_7" UNION ALL SELECT "LGBM_Model_1_7"."KEY" AS "KEY", "LGBM_Model_1_7"."Score_0" AS "Score_0", "LGBM_Model_1_7"."Score_1" AS "Score_1", "LGBM_Model_1_7"."Score_2" AS "Score_2", "LGBM_Model_1_7"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_7") AS "LGBM_esu_2") AS "LGBM_B2") AS "U"

-- Code For temporary table tmp_20180416233648_ps4aap_lgbm part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416233648_ps4aap_lgbm  (
	"KEY" BIGINT, 
	"Score_0" FLOAT, 
	"Score_1" FLOAT, 
	"Score_2" FLOAT, 
	"Score_3" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416233648_ps4aap_lgbm part 2/2. Populate

INSERT INTO tmp_20180416233648_ps4aap_lgbm ("KEY", "Score_0", "Score_1", "Score_2", "Score_3") SELECT "U"."KEY", "U"."Score_0", "U"."Score_1", "U"."Score_2", "U"."Score_3" 
FROM (WITH "DT_node_lookup_30" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.56281341656356) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.011342994322324) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.723179475915204) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.286549703841539) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.086879861942097) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= -0.738740453565855) THEN 64 ELSE 65 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= 0.695240327061486) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.21959172283653) THEN 132 ELSE 133 END ELSE 67 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.569079127975254) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.888593351942693) THEN 68 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_83 <= -0.303115065610459) THEN 138 ELSE 139 END END ELSE 35 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -0.03548042211694) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.397768403334476) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.726668846443118) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.614323947932473) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.081617978726793) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.485637271654055) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.979055337401938) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= 0.150023186846378) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_80 <= 0.525755930430716) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_77 <= 0.131388907928372) THEN 352 ELSE 353 END ELSE 177 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= 0.328758522944836) THEN 178 ELSE 179 END END ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.172160419561616) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.385650072856247) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.341560323322132) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= 0.309714663431319) THEN 24 ELSE 25 END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= -0.854395912652681) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= -1.03169971172907) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_59 <= 0.821444010327461) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.275274453058654) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.092062071191463) THEN 248 ELSE 249 END ELSE 125 END ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_30" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.03425875282734 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.002401842457299 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.017574687542134 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.061598992684735 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.001533995252461 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.028364748087591 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.0112325398943 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.017355398215965 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.059613788836503 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.032444296805644 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.032129082810285 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.063320874031645 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.002749475713941 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.032275478669026 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 64 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, -8.8399312402e-05 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, -0.032410080701888 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 67 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, 0.04541104751317 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 68 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 34 AS parent_id, -0.025350041582978 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.031381475712506 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.032050425383145 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 125 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.032062845028033 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 132 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 66 AS parent_id, 0.021378635362146 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 133 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 66 AS parent_id, -0.020547726191028 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 138 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 69 AS parent_id, -0.00140429622434 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 139 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 69 AS parent_id, 0.04782467595251 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 177 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 88 AS parent_id, -0.018168027633664 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 178 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 89 AS parent_id, -0.026333164127182 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 179 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 89 AS parent_id, 0.02700647437753 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 248 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 124 AS parent_id, -0.031317599844952 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 249 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 124 AS parent_id, -0.031840387610771 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 352 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 176 AS parent_id, -0.032725650939638 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 353 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 176 AS parent_id, -0.03188084822598 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_30" AS 
(SELECT "DT_node_lookup_30"."KEY" AS "KEY", "DT_node_lookup_30".node_id_2 AS node_id_2, "DT_node_data_30".node_id AS node_id, "DT_node_data_30".feature AS feature, "DT_node_data_30"."threshold" AS "threshold", "DT_node_data_30".depth AS depth, "DT_node_data_30".parent_id AS parent_id, "DT_node_data_30"."Score" AS "Score" 
FROM "DT_node_lookup_30" LEFT OUTER JOIN "DT_node_data_30" ON "DT_node_lookup_30".node_id_2 = "DT_node_data_30".node_id), 
"LGBM_Model_2_7" AS 
(SELECT "DT_Output_30"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_30"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_30"), 
"DT_node_lookup_31" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.288392294079473) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.132832282716238) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.042664248041282) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.826497355433401) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.128387840215334) THEN 32 ELSE 33 END ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_74 <= 0.349311586250096) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.372547674298115) THEN 36 ELSE 37 END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.168994536624717) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_92 <= -0.359266598988793) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= 0.310494925027822) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.67261032607098) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_100 <= 0.268138350734474) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -0.044408428438911) THEN 92 ELSE 93 END ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.335113709558737) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.875954880239882) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.067193373231848) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.890738256712341) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.839675723091807) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.285206357789187) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_74 <= 0.043522044749369) THEN 216 ELSE 217 END ELSE 109 END ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -1.501079257101271) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.483311018661744) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.767448294248176) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= 0.019664556508871) THEN 120 ELSE 121 END ELSE 61 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.756747021569668) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -1.052583656564832) THEN 126 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_43 <= -0.974016415571864) THEN 254 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.883021620031068) THEN 510 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.416971732666089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.088996588650817) THEN 2044 ELSE 2045 END ELSE 1023 END END END END END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_31" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.039979703355873 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.011476891152625 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.04378257117868 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.002901483543791 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.021806403751133 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.031946386998892 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.016652653340592 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.01206208470724 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.034766234934964 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.068547463721594 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.018413113293403 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.032828672038057 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.032828269661161 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.031783917749628 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.049687080277966 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, -0.032524649064507 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.05212653843317 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, 0.007801514976248 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 92 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, 0.028663915784294 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 93 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, -0.013721156374059 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 109 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 54 AS parent_id, -0.032206751586068 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 120 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, -0.02494222779921 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 121 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, 0.020320818126999 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.001477604010179 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 216 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 108 AS parent_id, -0.031303068003252 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 217 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 108 AS parent_id, -0.031822467024806 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 254 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 127 AS parent_id, -0.005860585046446 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 510 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 255 AS parent_id, -0.024652569778278 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1023 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 511 AS parent_id, -0.031561633667289 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2044 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 1022 AS parent_id, -0.032728771881291 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2045 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 1022 AS parent_id, -0.031915404914532 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_31" AS 
(SELECT "DT_node_lookup_31"."KEY" AS "KEY", "DT_node_lookup_31".node_id_2 AS node_id_2, "DT_node_data_31".node_id AS node_id, "DT_node_data_31".feature AS feature, "DT_node_data_31"."threshold" AS "threshold", "DT_node_data_31".depth AS depth, "DT_node_data_31".parent_id AS parent_id, "DT_node_data_31"."Score" AS "Score" 
FROM "DT_node_lookup_31" LEFT OUTER JOIN "DT_node_data_31" ON "DT_node_lookup_31".node_id_2 = "DT_node_data_31".node_id), 
"LGBM_Model_3_7" AS 
(SELECT "DT_Output_31"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_31"."Score" AS "Score_3" 
FROM "DT_Output_31"), 
"DT_node_lookup_32" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.451713696089738) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.854803386634702) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.199095482794217) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.128079804961251) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.380306905242662) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.211119237510429) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= -0.984986103252644) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.606392530350532) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.216263974625205) THEN 84 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.025488557278992) THEN 170 ELSE 171 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 1.104351102147555) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.009589112418312) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_100 <= -0.786170533997722) THEN 344 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= -0.025088200273477) THEN 690 ELSE 691 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.071626095462272) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= 0.322811486234005) THEN 692 ELSE 693 END ELSE 347 END END ELSE 87 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.733317468841946) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.538780223174287) THEN 46 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= -0.701313696683763) THEN 94 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_78 <= 0.342064895124651) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_76 <= 0.302070707229912) THEN 380 ELSE 381 END ELSE 191 END END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.612307081194479) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 0.08263887241881) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_39 <= 0.868260319879006) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.105564514374666) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.191256436160061) THEN 104 ELSE 105 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.074368954498483) THEN 106 ELSE 107 END END ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 1.170075117819322) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.473624936934708) THEN 28 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.04825688913811) THEN 58 ELSE 59 END END ELSE 15 END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_32" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.015054978007268 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, -0.031756293903788 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.004968785919697 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.005044853413354 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.053411478310005 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.004739043791059 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.027892010886358 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.024985469910593 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.027226570297764 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.010482268974203 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.010180732381058 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.042604258419505 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.064803972733655 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, -0.031374956531867 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 59 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, -0.032077478907051 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, 0.0078318360317 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 87 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, -0.01789459764209 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 94 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 47 AS parent_id, 0.000852718661271 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 104 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 52 AS parent_id, 0.058038965298614 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 105 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 52 AS parent_id, 0.008820328711069 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 106 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 53 AS parent_id, 0.017189937979093 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 107 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 53 AS parent_id, -0.026556178957115 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 170 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 85 AS parent_id, -0.032641254468177 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 171 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 85 AS parent_id, -0.024955674597261 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 191 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 95 AS parent_id, -0.024622952146051 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 344 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 172 AS parent_id, -0.03271809212214 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 347 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 173 AS parent_id, -0.031047822447674 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 380 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 190 AS parent_id, -0.031619474588609 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 381 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 190 AS parent_id, -0.032180263354556 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 690 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 345 AS parent_id, -0.032068582997839 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 691 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 345 AS parent_id, -0.031372091177788 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 692 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 346 AS parent_id, -0.031878633558438 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 693 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 346 AS parent_id, -0.031385616558744 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_32" AS 
(SELECT "DT_node_lookup_32"."KEY" AS "KEY", "DT_node_lookup_32".node_id_2 AS node_id_2, "DT_node_data_32".node_id AS node_id, "DT_node_data_32".feature AS feature, "DT_node_data_32"."threshold" AS "threshold", "DT_node_data_32".depth AS depth, "DT_node_data_32".parent_id AS parent_id, "DT_node_data_32"."Score" AS "Score" 
FROM "DT_node_lookup_32" LEFT OUTER JOIN "DT_node_data_32" ON "DT_node_lookup_32".node_id_2 = "DT_node_data_32".node_id), 
"LGBM_Model_0_8" AS 
(SELECT "DT_Output_32"."KEY" AS "KEY", "DT_Output_32"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_32"), 
"DT_node_lookup_33" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -1.06711085314315) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 1.107668097192869) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.316402671445631) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.518932407359288) THEN 296 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= 0.0) THEN 594 ELSE 595 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.133416521386633) THEN 298 ELSE 299 END END ELSE 75 END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.289191756017089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= 0.393571563299742) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.683670144151382) THEN 40 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= 0.539290836109095) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.047924040922726) THEN 164 ELSE 165 END ELSE 83 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.113904240197745) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.510874314724548) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.253978525786874) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= 0.461211029145637) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= 0.487874242231529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.032077632324018) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= -0.19900204022857) THEN 48 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_61 <= 0.012646566549872) THEN 98 ELSE 99 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.210255919601598) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.294865349412135) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= -0.193069569512856) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -0.68863708938623) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.342791872981864) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= -0.229040352932272) THEN 60 ELSE 61 END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_33" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.001180955388299 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.032199731090448 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.002931320774636 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.001114295055722 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.002801456633272 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.023372094335063 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.014328424011526 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.008499589736428 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.027864130100107 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.018723656513842 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.0180078686002 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.030835793934161 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.031367847033845 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.002730794829752 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.019493632092308 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, -0.032695253306769 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.034461112181752 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.068274357284779 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.033305093451491 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.031779807633811 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 75 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.031645515631455 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, -0.001758488225899 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 98 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 49 AS parent_id, 0.0616359282632 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 99 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 49 AS parent_id, 0.02412656621944 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 164 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, 0.012299551035356 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 165 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, 0.054688412044036 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 296 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 148 AS parent_id, -0.031019747504614 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 298 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 149 AS parent_id, -0.031177533203922 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 299 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 149 AS parent_id, -0.030778569096194 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 594 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 297 AS parent_id, -0.031289127289046 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 595 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 297 AS parent_id, -0.031680405705678 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_33" AS 
(SELECT "DT_node_lookup_33"."KEY" AS "KEY", "DT_node_lookup_33".node_id_2 AS node_id_2, "DT_node_data_33".node_id AS node_id, "DT_node_data_33".feature AS feature, "DT_node_data_33"."threshold" AS "threshold", "DT_node_data_33".depth AS depth, "DT_node_data_33".parent_id AS parent_id, "DT_node_data_33"."Score" AS "Score" 
FROM "DT_node_lookup_33" LEFT OUTER JOIN "DT_node_data_33" ON "DT_node_lookup_33".node_id_2 = "DT_node_data_33".node_id), 
"LGBM_Model_1_8" AS 
(SELECT "DT_Output_33"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_33"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_33"), 
"DT_node_lookup_34" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.56281341656356) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.011342994322324) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.723179475915204) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.286549703841539) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= 0.58625193716783) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.62484514521883) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.577006969610881) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_56 <= -0.0) THEN 256 ELSE 257 END ELSE 129 END ELSE 65 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= 0.303431243850393) THEN 66 ELSE 67 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.569079127975254) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.016350857180627) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.059325797761893) THEN 136 ELSE 137 END ELSE 69 END ELSE 35 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -0.03548042211694) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.397768403334476) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.726668846443118) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.614323947932473) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.081617978726793) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.485637271654055) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.979055337401938) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= 0.150023186846378) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_82 <= -0.387531921714705) THEN 176 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_80 <= 0.077155604981645) THEN 354 ELSE 355 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= 0.328758522944836) THEN 178 ELSE 179 END END ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.172160419561616) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.385650072856247) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.341560323322132) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= -0.765493257371939) THEN 24 ELSE 25 END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= -0.854395912652681) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_32 <= 1.203504495776177) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_48 <= 0.843305735812015) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.208836616808) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_74 <= 0.125123043460945) THEN 240 ELSE 241 END ELSE 121 END ELSE 61 END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_34" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.032599536489077 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.00239582903824 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.017056399052786 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.058662882316997 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.001532251659805 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.010897106263827 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.028404392044401 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.016963235876724 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.056609165212481 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.032198636856023 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.030534666135578 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.059872737363034 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.002734044230911 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.032071701489212 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.043615433124217 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 66 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, -0.032705416125068 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 67 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, -0.018072066043247 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 69 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 34 AS parent_id, 0.039832422144912 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.031125613334711 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.031748898393032 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 121 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, -0.031861076463825 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 129 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 64 AS parent_id, 0.02093352169906 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 136 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 68 AS parent_id, -0.022299182354663 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 137 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 68 AS parent_id, 0.016639120818642 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 176 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 88 AS parent_id, -0.017801648258965 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 178 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 89 AS parent_id, -0.026009288077015 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 179 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 89 AS parent_id, 0.026050833212557 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 240 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.031027409878568 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 241 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.031630080891462 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 256 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 128 AS parent_id, -0.032438992462117 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 257 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 128 AS parent_id, -0.004856981963694 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 354 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 177 AS parent_id, -0.032425918286114 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 355 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 177 AS parent_id, -0.031529957030802 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_34" AS 
(SELECT "DT_node_lookup_34"."KEY" AS "KEY", "DT_node_lookup_34".node_id_2 AS node_id_2, "DT_node_data_34".node_id AS node_id, "DT_node_data_34".feature AS feature, "DT_node_data_34"."threshold" AS "threshold", "DT_node_data_34".depth AS depth, "DT_node_data_34".parent_id AS parent_id, "DT_node_data_34"."Score" AS "Score" 
FROM "DT_node_lookup_34" LEFT OUTER JOIN "DT_node_data_34" ON "DT_node_lookup_34".node_id_2 = "DT_node_data_34".node_id), 
"LGBM_Model_2_8" AS 
(SELECT "DT_Output_34"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_34"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_34"), 
"DT_node_lookup_35" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.288392294079473) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.132832282716238) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.042664248041282) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.826497355433401) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.128387840215334) THEN 32 ELSE 33 END ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_74 <= 0.349311586250096) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.372547674298115) THEN 36 ELSE 37 END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_47 <= 0.318785938587487) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= 0.328130691065211) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.352085181526069) THEN 40 ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_39 <= 0.055634257491351) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= -0.343770308080513) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= 0.131276003408889) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.335113709558737) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.875954880239882) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.067193373231848) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.890738256712341) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.225223845594938) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_99 <= 0.08644418330271) THEN 108 ELSE 109 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.118762481117106) THEN 110 ELSE 111 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.606223818003441) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -1.390521742135929) THEN 28 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 1.243467598045966) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.444024109404464) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.380662006401444) THEN 232 ELSE 233 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= -0.760831479780765) THEN 234 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_99 <= -0.832251899068919) THEN 470 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.203323395236389) THEN 942 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_48 <= -0.425046226579661) THEN 1886 ELSE 1887 END END END END END ELSE 59 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.312745714143149) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_71 <= 0.17909529391158) THEN 60 ELSE 61 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.133482136011978) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_35" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.011199213620217 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.041931655773954 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.025872785934827 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.03167406419459 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.015949471989347 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.011949821416394 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.02603450043983 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.033176425201016 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.065186716737684 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.017728022818271 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.032544300848017 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.032568386920106 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.031633013114136 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.01896284572311 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.021842412225587 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.006581362981171 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.05787828359119 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 59 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.017337573599792 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.06003275466609 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.01902473026174 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.032096148796051 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, 0.018730541058831 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 108 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 54 AS parent_id, -0.031196998241928 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 109 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 54 AS parent_id, -0.031665253689981 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 110 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 55 AS parent_id, -0.032537678946898 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 111 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 55 AS parent_id, -0.031603746341221 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 232 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 116 AS parent_id, -0.022159597185734 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 233 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 116 AS parent_id, 0.020801425009448 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 234 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 117 AS parent_id, -0.00418484170173 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 470 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 235 AS parent_id, -0.017185729921382 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 942 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 471 AS parent_id, -0.032520903854039 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1886 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 943 AS parent_id, -0.031406524383208 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1887 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 943 AS parent_id, -0.031989438429542 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_35" AS 
(SELECT "DT_node_lookup_35"."KEY" AS "KEY", "DT_node_lookup_35".node_id_2 AS node_id_2, "DT_node_data_35".node_id AS node_id, "DT_node_data_35".feature AS feature, "DT_node_data_35"."threshold" AS "threshold", "DT_node_data_35".depth AS depth, "DT_node_data_35".parent_id AS parent_id, "DT_node_data_35"."Score" AS "Score" 
FROM "DT_node_lookup_35" LEFT OUTER JOIN "DT_node_data_35" ON "DT_node_lookup_35".node_id_2 = "DT_node_data_35".node_id), 
"LGBM_Model_3_8" AS 
(SELECT "DT_Output_35"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_35"."Score" AS "Score_3" 
FROM "DT_Output_35"), 
"DT_node_lookup_36" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.397498703526244) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= 0.056844366114366) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_59 <= -0.493321427148524) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.211642169689618) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_35 <= -0.301455914348131) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_82 <= -0.269062365705774) THEN 74 ELSE 75 END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_72 <= 1.027920289834986) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.512185580077254) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= 0.135222664670607) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.343021110316634) THEN 80 ELSE 81 END ELSE 41 END ELSE 21 END ELSE 11 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_65 <= 0.174125873386804) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= 0.058509527731855) THEN 48 ELSE 49 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.276056103373906) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.240745697470727) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.315436819236289) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.337705894530969) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.502525406123876) THEN 56 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.136011071233652) THEN 114 ELSE 115 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.701497555598703) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_98 <= -0.26270429282839) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.039180789366854) THEN 236 ELSE 237 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.84212082244031) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= -0.104780122351001) THEN 476 ELSE 477 END ELSE 239 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.930429083667873) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= 0.880825547268369) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.979055337401938) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.21491314694629) THEN 248 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= -0.082622735363059) THEN 498 ELSE 499 END END ELSE 125 END ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_36" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.020904073347242 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 5 AS parent_id, -0.016982732308108 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.007074818852608 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.032196695673829 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.017859188877075 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.027812488643841 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.01245003017082 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.007672024349109 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.03103633159079 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.011398601250945 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 49 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, 0.039467451783126 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.033783107979169 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.061853951307736 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 56 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.012907700112305 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.022601903064341 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.002257625854349 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 74 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.032538273291306 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 75 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.031588832475241 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 80 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, -0.032002952450291 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 81 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, -0.031320149756751 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 114 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 57 AS parent_id, 0.055570270174515 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 115 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 57 AS parent_id, 0.012091677658559 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 125 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.023871901989551 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 236 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, 0.022369914536373 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 237 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, -0.025139735373885 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 239 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.023999112283 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 248 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 124 AS parent_id, -0.032234926238933 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 476 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 238 AS parent_id, -0.032578940754447 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 477 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 238 AS parent_id, -0.031724275257366 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 498 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 249 AS parent_id, -0.031892118598618 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 499 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 249 AS parent_id, -0.030994204247476 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_36" AS 
(SELECT "DT_node_lookup_36"."KEY" AS "KEY", "DT_node_lookup_36".node_id_2 AS node_id_2, "DT_node_data_36".node_id AS node_id, "DT_node_data_36".feature AS feature, "DT_node_data_36"."threshold" AS "threshold", "DT_node_data_36".depth AS depth, "DT_node_data_36".parent_id AS parent_id, "DT_node_data_36"."Score" AS "Score" 
FROM "DT_node_lookup_36" LEFT OUTER JOIN "DT_node_data_36" ON "DT_node_lookup_36".node_id_2 = "DT_node_data_36".node_id), 
"LGBM_Model_0_9" AS 
(SELECT "DT_Output_36"."KEY" AS "KEY", "DT_Output_36"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_36"), 
"DT_node_lookup_37" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= -0.923326362600761) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 1.107668097192869) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.316402671445631) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= -0.70872981876071) THEN 296 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.194833054565648) THEN 594 ELSE 595 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_83 <= 0.557396663566363) THEN 298 ELSE 299 END END ELSE 75 END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.57526783081357) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_82 <= 0.306051764101972) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.048533976737039) THEN 40 ELSE 41 END ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.248586283963278) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= 0.834237459066138) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.611680420107618) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_32 <= 0.623076460856206) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.122731991636247) THEN 352 ELSE 353 END ELSE 177 END ELSE 89 END ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.716975100526955) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.65295271914008) THEN 92 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN 186 ELSE 187 END END ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.18261792646899) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.450498715896181) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.309584346770503) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.343880447956846) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_78 <= 0.26899018300847) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= -0.732268444520137) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.104775554409621) THEN 28 ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_76 <= 0.757219220536853) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= -0.801351631609242) THEN 60 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.600283765938341) THEN 122 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.284744467491554) THEN 246 ELSE 247 END END END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_37" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.000976978173285 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.002887769511136 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.007066264312469 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.026363999445064 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.063548217388241 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.022478073374742 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.005968408011726 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.040460873887687 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.012326446954005 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.022950923854698 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, 0.014916409307638 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, 0.054784398687298 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.041063232893109 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.002785873025867 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.043132437765991 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.000656479945906 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.004109058443291 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 75 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.031414754675174 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 89 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, 0.01942818092499 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 92 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, -0.02360344587852 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 122 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 61 AS parent_id, -0.017268986026301 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 177 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 88 AS parent_id, 0.00029834321437 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 186 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 93 AS parent_id, -0.032583194081198 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 187 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 93 AS parent_id, -0.031069863113206 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 246 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 123 AS parent_id, -0.031292423360816 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 247 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 123 AS parent_id, -0.032530686615154 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 296 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 148 AS parent_id, -0.030730457248714 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 298 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 149 AS parent_id, -0.030909844398027 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 299 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 149 AS parent_id, -0.030598283492662 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 352 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 176 AS parent_id, -0.033882051728143 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 353 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 176 AS parent_id, -0.026310229056102 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 594 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 297 AS parent_id, -0.031380214256835 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 595 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 297 AS parent_id, -0.030987297044402 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_37" AS 
(SELECT "DT_node_lookup_37"."KEY" AS "KEY", "DT_node_lookup_37".node_id_2 AS node_id_2, "DT_node_data_37".node_id AS node_id, "DT_node_data_37".feature AS feature, "DT_node_data_37"."threshold" AS "threshold", "DT_node_data_37".depth AS depth, "DT_node_data_37".parent_id AS parent_id, "DT_node_data_37"."Score" AS "Score" 
FROM "DT_node_lookup_37" LEFT OUTER JOIN "DT_node_data_37" ON "DT_node_lookup_37".node_id_2 = "DT_node_data_37".node_id), 
"LGBM_Model_1_9" AS 
(SELECT "DT_Output_37"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_37"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_37"), 
"DT_node_lookup_38" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.56281341656356) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.011342994322324) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.935044206679286) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.009589112418312) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.265848144446139) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= 0.58625193716783) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.656227296000389) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= 0.35336293104023) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -0.197573232761607) THEN 288 ELSE 289 END ELSE 145 END ELSE 73 END ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.253770836801218) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.031529932059306) THEN 76 ELSE 77 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= 0.354898777281712) THEN 78 ELSE 79 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.397768403334476) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.726668846443118) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.614323947932473) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_83 <= -0.16961672304832) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.485637271654055) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.979055337401938) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_78 <= 0.56015390813859) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= 0.480436894122028) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.134429124411824) THEN 352 ELSE 353 END ELSE 177 END ELSE 89 END ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= 0.125927307672567) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.385650072856247) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.341560323322132) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_62 <= -0.0) THEN 24 ELSE 25 END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= -0.854395912652681) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= -1.03169971172907) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -1.00798738565189) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.532000390338283) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= 0.717478246222962) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= 0.08570433457187) THEN 504 ELSE 505 END ELSE 253 END ELSE 127 END END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_38" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.031115056048467 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.002283879015425 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, -0.031902511361014 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.005465729535499 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.001644682646493 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.03198196431711 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.006191805544067 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.016531521959448 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.021022597993703 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.03193531206722 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.029392845296118 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.003085746272758 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.056864921553071 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.030979773814191 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 73 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 36 AS parent_id, 0.046680956055932 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 76 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 38 AS parent_id, -0.002858516603084 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 77 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 38 AS parent_id, 0.043784246030242 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 78 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 39 AS parent_id, 0.065638754158174 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 79 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 39 AS parent_id, 0.027784052948791 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.03144273749234 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.030868396765885 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 89 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, 0.007611067167124 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 127 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.031164521998492 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 145 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 72 AS parent_id, 0.035284664002372 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 177 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 88 AS parent_id, -0.008280731120487 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 253 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 126 AS parent_id, -0.032048507111126 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 288 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 144 AS parent_id, 0.018006719007447 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 289 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 144 AS parent_id, -0.028041507929167 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 352 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 176 AS parent_id, -0.032161694281199 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 353 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 176 AS parent_id, -0.031302807073648 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 504 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 252 AS parent_id, -0.031112735506984 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 505 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 252 AS parent_id, -0.031926080718319 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_38" AS 
(SELECT "DT_node_lookup_38"."KEY" AS "KEY", "DT_node_lookup_38".node_id_2 AS node_id_2, "DT_node_data_38".node_id AS node_id, "DT_node_data_38".feature AS feature, "DT_node_data_38"."threshold" AS "threshold", "DT_node_data_38".depth AS depth, "DT_node_data_38".parent_id AS parent_id, "DT_node_data_38"."Score" AS "Score" 
FROM "DT_node_lookup_38" LEFT OUTER JOIN "DT_node_data_38" ON "DT_node_lookup_38".node_id_2 = "DT_node_data_38".node_id), 
"LGBM_Model_2_9" AS 
(SELECT "DT_Output_38"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_38"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_38"), 
"DT_node_lookup_39" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.288392294079473) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.132832282716238) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.422643992745158) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_85 <= 0.0) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.057370178653558) THEN 34 ELSE 35 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_56 <= -0.532802395130078) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.241101173459233) THEN 38 ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.238163918077363) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= 0.733011783170441) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= 0.310494925027822) THEN 40 ELSE 41 END ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.752410410390122) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.320437291030534) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_100 <= -0.125919764513613) THEN 92 ELSE 93 END ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.335113709558737) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.875954880239882) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.067193373231848) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.890738256712341) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.225223845594938) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_99 <= 0.08644418330271) THEN 108 ELSE 109 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.118762481117106) THEN 110 ELSE 111 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -1.501079257101271) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.503552381127684) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.767448294248176) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= 0.019664556508871) THEN 120 ELSE 121 END ELSE 61 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.756747021569668) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -1.052583656564832) THEN 126 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_43 <= -0.989498175478625) THEN 254 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= -0.770379232458409) THEN 510 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= -0.242943961687349) THEN 1022 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.416971732666089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= -0.0) THEN 4092 ELSE 4093 END ELSE 2047 END END END END END END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_39" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.037058341718413 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.019700117499506 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.037370123216679 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.000312283198356 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.025913059949916 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.031431306695528 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.015379826385528 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.01172022585043 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.044473922585807 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.066423151262342 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, 0.008807629356605 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.026858342219235 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.03258481905371 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.031533483249627 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.046530509695743 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.049004407910797 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, 0.007476503913832 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 92 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, -0.019291858633849 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 93 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, 0.023213110711965 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 108 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 54 AS parent_id, -0.030928108661333 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 109 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 54 AS parent_id, -0.031418136274065 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 110 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 55 AS parent_id, -0.03228909945948 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 111 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 55 AS parent_id, -0.031393676555179 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 120 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, -0.024259720486917 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 121 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, 0.020618258650809 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.002636452460104 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 254 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 127 AS parent_id, -0.005317377665998 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 510 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 255 AS parent_id, -0.017415275270457 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1022 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 511 AS parent_id, -0.032498983889418 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2047 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 1023 AS parent_id, -0.03092018324048 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4092 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 2046 AS parent_id, -0.032042310632233 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4093 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 2046 AS parent_id, -0.03138192398815 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_39" AS 
(SELECT "DT_node_lookup_39"."KEY" AS "KEY", "DT_node_lookup_39".node_id_2 AS node_id_2, "DT_node_data_39".node_id AS node_id, "DT_node_data_39".feature AS feature, "DT_node_data_39"."threshold" AS "threshold", "DT_node_data_39".depth AS depth, "DT_node_data_39".parent_id AS parent_id, "DT_node_data_39"."Score" AS "Score" 
FROM "DT_node_lookup_39" LEFT OUTER JOIN "DT_node_data_39" ON "DT_node_lookup_39".node_id_2 = "DT_node_data_39".node_id), 
"LGBM_Model_3_9" AS 
(SELECT "DT_Output_39"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_39"."Score" AS "Score_3" 
FROM "DT_Output_39")
 SELECT "LGBM_B3"."KEY", "LGBM_B3"."Score_0", "LGBM_B3"."Score_1", "LGBM_B3"."Score_2", "LGBM_B3"."Score_3" 
FROM (SELECT "LGBM_esu_3"."KEY" AS "KEY", "LGBM_esu_3"."Score_0" AS "Score_0", "LGBM_esu_3"."Score_1" AS "Score_1", "LGBM_esu_3"."Score_2" AS "Score_2", "LGBM_esu_3"."Score_3" AS "Score_3" 
FROM (SELECT "LGBM_Model_2_7"."KEY" AS "KEY", "LGBM_Model_2_7"."Score_0" AS "Score_0", "LGBM_Model_2_7"."Score_1" AS "Score_1", "LGBM_Model_2_7"."Score_2" AS "Score_2", "LGBM_Model_2_7"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_7" UNION ALL SELECT "LGBM_Model_3_7"."KEY" AS "KEY", "LGBM_Model_3_7"."Score_0" AS "Score_0", "LGBM_Model_3_7"."Score_1" AS "Score_1", "LGBM_Model_3_7"."Score_2" AS "Score_2", "LGBM_Model_3_7"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_7" UNION ALL SELECT "LGBM_Model_0_8"."KEY" AS "KEY", "LGBM_Model_0_8"."Score_0" AS "Score_0", "LGBM_Model_0_8"."Score_1" AS "Score_1", "LGBM_Model_0_8"."Score_2" AS "Score_2", "LGBM_Model_0_8"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_8" UNION ALL SELECT "LGBM_Model_1_8"."KEY" AS "KEY", "LGBM_Model_1_8"."Score_0" AS "Score_0", "LGBM_Model_1_8"."Score_1" AS "Score_1", "LGBM_Model_1_8"."Score_2" AS "Score_2", "LGBM_Model_1_8"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_8" UNION ALL SELECT "LGBM_Model_2_8"."KEY" AS "KEY", "LGBM_Model_2_8"."Score_0" AS "Score_0", "LGBM_Model_2_8"."Score_1" AS "Score_1", "LGBM_Model_2_8"."Score_2" AS "Score_2", "LGBM_Model_2_8"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_8" UNION ALL SELECT "LGBM_Model_3_8"."KEY" AS "KEY", "LGBM_Model_3_8"."Score_0" AS "Score_0", "LGBM_Model_3_8"."Score_1" AS "Score_1", "LGBM_Model_3_8"."Score_2" AS "Score_2", "LGBM_Model_3_8"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_8" UNION ALL SELECT "LGBM_Model_0_9"."KEY" AS "KEY", "LGBM_Model_0_9"."Score_0" AS "Score_0", "LGBM_Model_0_9"."Score_1" AS "Score_1", "LGBM_Model_0_9"."Score_2" AS "Score_2", "LGBM_Model_0_9"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_9" UNION ALL SELECT "LGBM_Model_1_9"."KEY" AS "KEY", "LGBM_Model_1_9"."Score_0" AS "Score_0", "LGBM_Model_1_9"."Score_1" AS "Score_1", "LGBM_Model_1_9"."Score_2" AS "Score_2", "LGBM_Model_1_9"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_9" UNION ALL SELECT "LGBM_Model_2_9"."KEY" AS "KEY", "LGBM_Model_2_9"."Score_0" AS "Score_0", "LGBM_Model_2_9"."Score_1" AS "Score_1", "LGBM_Model_2_9"."Score_2" AS "Score_2", "LGBM_Model_2_9"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_9" UNION ALL SELECT "LGBM_Model_3_9"."KEY" AS "KEY", "LGBM_Model_3_9"."Score_0" AS "Score_0", "LGBM_Model_3_9"."Score_1" AS "Score_1", "LGBM_Model_3_9"."Score_2" AS "Score_2", "LGBM_Model_3_9"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_9") AS "LGBM_esu_3") AS "LGBM_B3") AS "U"

-- Code For temporary table tmp_20180416233648_5xlkqh_lgbm part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416233648_5xlkqh_lgbm  (
	"KEY" BIGINT, 
	"Score_0" FLOAT, 
	"Score_1" FLOAT, 
	"Score_2" FLOAT, 
	"Score_3" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416233648_5xlkqh_lgbm part 2/2. Populate

INSERT INTO tmp_20180416233648_5xlkqh_lgbm ("KEY", "Score_0", "Score_1", "Score_2", "Score_3") SELECT "U"."KEY", "U"."Score_0", "U"."Score_1", "U"."Score_2", "U"."Score_3" 
FROM (WITH "DT_node_lookup_40" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.397498703526244) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.79602768915845) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.154171854926422) THEN 8 ELSE 9 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= 0.081119450256599) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= 0.194339779155819) THEN 40 ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_79 <= 0.641527573563999) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -0.176529089019114) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.485143571064367) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.095099244254024) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.018326394800745) THEN 92 ELSE 93 END ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.753056438357138) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.547274073783631) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.193966414498557) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= 0.147958461913303) THEN 96 ELSE 97 END ELSE 49 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_76 <= 0.091030540488227) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= -0.03214598631216) THEN 100 ELSE 101 END ELSE 51 END END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.315436819236289) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.337705894530969) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.502525406123876) THEN 56 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.136011071233652) THEN 114 ELSE 115 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.701497555598703) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_98 <= -0.26270429282839) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.039180789366854) THEN 236 ELSE 237 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.84212082244031) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= -0.104780122351001) THEN 476 ELSE 477 END ELSE 239 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.930429083667873) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= 0.880825547268369) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= 0.824285968427703) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.265735721550309) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.121856302139455) THEN 496 ELSE 497 END ELSE 249 END ELSE 125 END ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_40" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.030961360994599 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.014974314101531 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, -0.012858535859749 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.030632078050407 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.011949023904786 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, 0.023942829163564 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.025288695244772 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.016684887633777 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.031074784337372 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 49 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.014410976661098 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.02017569507065 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 56 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.012620602943037 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.021763839684365 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.002133459388553 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.032264699801449 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.031214898429281 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 92 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, -0.031983632086446 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 93 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, -0.031330289523432 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 96 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 48 AS parent_id, 0.010411260227918 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 97 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 48 AS parent_id, 0.050443697368304 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 100 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 50 AS parent_id, 0.044315320422552 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 101 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 50 AS parent_id, 0.066428685390388 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 114 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 57 AS parent_id, 0.052873398117694 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 115 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 57 AS parent_id, 0.01180951644844 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 125 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.023531872978014 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 236 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, 0.021356007227037 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 237 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, -0.024816156801866 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 239 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.023670642846212 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 249 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 124 AS parent_id, -0.03210616093655 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 476 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 238 AS parent_id, -0.032339987411962 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 477 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 238 AS parent_id, -0.031492272153202 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 496 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 248 AS parent_id, -0.031754627101176 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 497 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 248 AS parent_id, -0.030873689373298 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_40" AS 
(SELECT "DT_node_lookup_40"."KEY" AS "KEY", "DT_node_lookup_40".node_id_2 AS node_id_2, "DT_node_data_40".node_id AS node_id, "DT_node_data_40".feature AS feature, "DT_node_data_40"."threshold" AS "threshold", "DT_node_data_40".depth AS depth, "DT_node_data_40".parent_id AS parent_id, "DT_node_data_40"."Score" AS "Score" 
FROM "DT_node_lookup_40" LEFT OUTER JOIN "DT_node_data_40" ON "DT_node_lookup_40".node_id_2 = "DT_node_data_40".node_id), 
"LGBM_Model_0_10" AS 
(SELECT "DT_Output_40"."KEY" AS "KEY", "DT_Output_40"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_40"), 
"DT_node_lookup_41" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 1.174984050407564) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= 0.007387383463523) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.267525920302074) THEN 144 ELSE 145 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.088302029935009) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_48 <= 0.069738658497346) THEN 292 ELSE 293 END ELSE 147 END END ELSE 37 END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.289191756017089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= -0.051056202544623) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= -0.270231831732882) THEN 40 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_37 <= 0.049873673475251) THEN 82 ELSE 83 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.419914641948611) THEN 42 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -0.154457965939948) THEN 86 ELSE 87 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= 0.461211029145637) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.253978525786874) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= 0.461211029145637) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= 0.487874242231529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.032077632324018) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= -0.19900204022857) THEN 48 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= 0.260814785386735) THEN 98 ELSE 99 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.210255919601598) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.294865349412135) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= -0.193069569512856) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -0.68863708938623) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.342791872981864) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= -0.229040352932272) THEN 60 ELSE 61 END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_41" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.000859899622974 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.03014511448443 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.002838182310393 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.001276530450269 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.002481340066266 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.022534020705215 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, 0.049997046108054 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.019604718561265 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.014683937202191 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.021709766762621 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.030507754262286 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.031011671838921 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.002885159797499 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.018505013001239 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, -0.032319897052637 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.031837644476547 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.062968726652796 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.03306496876707 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.031390394098846 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 82 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, -0.018463951503119 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, 0.03715885525786 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 86 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, -0.002528790473245 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 87 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, -0.031957670949133 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 98 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 49 AS parent_id, 0.022275962858507 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 99 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 49 AS parent_id, 0.056891333269853 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 144 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 72 AS parent_id, -0.031290507088669 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 145 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 72 AS parent_id, -0.030755087013213 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 147 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 73 AS parent_id, -0.030487477095138 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 292 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 146 AS parent_id, -0.030647734682268 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 293 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 146 AS parent_id, -0.031125365755933 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_41" AS 
(SELECT "DT_node_lookup_41"."KEY" AS "KEY", "DT_node_lookup_41".node_id_2 AS node_id_2, "DT_node_data_41".node_id AS node_id, "DT_node_data_41".feature AS feature, "DT_node_data_41"."threshold" AS "threshold", "DT_node_data_41".depth AS depth, "DT_node_data_41".parent_id AS parent_id, "DT_node_data_41"."Score" AS "Score" 
FROM "DT_node_lookup_41" LEFT OUTER JOIN "DT_node_data_41" ON "DT_node_lookup_41".node_id_2 = "DT_node_data_41".node_id), 
"LGBM_Model_1_10" AS 
(SELECT "DT_Output_41"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_41"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_41"), 
"DT_node_lookup_42" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.56281341656356) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.011342994322324) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -1.355449640017905) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.935044206679286) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_55 <= 0.041017314902838) THEN 36 ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_83 <= -0.63768367921369) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= 0.253583449817676) THEN 76 ELSE 77 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.286549703841539) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= -0.01185549323854) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= 0.07450230161386) THEN 312 ELSE 313 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.081141369741027) THEN 314 ELSE 315 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.229091133364839) THEN 158 ELSE 159 END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.15001825840699) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.81571644285601) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= -0.716201363807965) THEN 40 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_78 <= 0.622432171649942) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.2651086500887) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.193966414498557) THEN 328 ELSE 329 END ELSE 165 END ELSE 83 END END ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.295912747262384) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_55 <= 0.161938814198946) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= 0.689800647107664) THEN 88 ELSE 89 END ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 0.277394485074608) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.385650072856247) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.341560323322132) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= 0.093822650023526) THEN 24 ELSE 25 END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= -0.854395912652681) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_32 <= 1.203504495776177) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.229015679138789) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.354329666730895) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_48 <= 0.263888022588291) THEN 240 ELSE 241 END ELSE 121 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -0.35543327929227) THEN 122 ELSE 123 END END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_42" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.048114529533351 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.029791718692633 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.002244286309386 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.007913099192163 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.031891175196101 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.006338530389428 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.016099379416477 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.03205028551533 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.017796521201092 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.003738595941993 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.031811001891292 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.005160819644926 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.057038151449033 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 76 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 38 AS parent_id, 0.011248813792701 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 77 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 38 AS parent_id, -0.032848384822216 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, -0.018135008201423 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 88 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, 0.017399230856417 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 89 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.024687450319081 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 121 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, -0.030518312635239 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 122 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 61 AS parent_id, -0.03169065490714 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 123 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 61 AS parent_id, -0.03127644424383 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 158 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 79 AS parent_id, 0.02568095536819 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 159 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 79 AS parent_id, 0.067938214601493 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 165 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, -0.032947901026935 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 240 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.03078318571977 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 241 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.031719247810953 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 312 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 156 AS parent_id, 0.054474906308099 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 313 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 156 AS parent_id, -0.000456157760299 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 314 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 157 AS parent_id, 0.015519984192519 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 315 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 157 AS parent_id, -0.027781015990834 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 328 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 164 AS parent_id, -0.031091025497341 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 329 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 164 AS parent_id, -0.03178035272451 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_42" AS 
(SELECT "DT_node_lookup_42"."KEY" AS "KEY", "DT_node_lookup_42".node_id_2 AS node_id_2, "DT_node_data_42".node_id AS node_id, "DT_node_data_42".feature AS feature, "DT_node_data_42"."threshold" AS "threshold", "DT_node_data_42".depth AS depth, "DT_node_data_42".parent_id AS parent_id, "DT_node_data_42"."Score" AS "Score" 
FROM "DT_node_lookup_42" LEFT OUTER JOIN "DT_node_data_42" ON "DT_node_lookup_42".node_id_2 = "DT_node_data_42".node_id), 
"LGBM_Model_2_10" AS 
(SELECT "DT_Output_42"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_42"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_42"), 
"DT_node_lookup_43" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.288392294079473) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.132832282716238) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.042664248041282) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.826497355433401) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.128387840215334) THEN 32 ELSE 33 END ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_74 <= 0.349311586250096) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.372547674298115) THEN 36 ELSE 37 END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_47 <= 0.318785938587487) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= 0.328130691065211) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.352085181526069) THEN 40 ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.136011071233652) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= -0.343770308080513) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= 0.131276003408889) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.335113709558737) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.875954880239882) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.067193373231848) THEN 24 ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.890738256712341) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.225223845594938) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_99 <= 0.08644418330271) THEN 108 ELSE 109 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.118762481117106) THEN 110 ELSE 111 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.606223818003441) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.357233431159453) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_65 <= 0.931403158401869) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= -0.39850753019796) THEN 112 ELSE 113 END ELSE 57 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -1.092495411443824) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.070069125346581) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= -0.435482201443039) THEN 236 ELSE 237 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= -0.341444877565677) THEN 238 ELSE 239 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_99 <= 0.021387270292083) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_78 <= -0.105761292289915) THEN 60 ELSE 61 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= 0.318183045915712) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_43" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.010254850986575 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.039050020001217 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.025420182194391 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.031198813758382 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.01486736373085 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.011566388695471 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.030528901974315 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.060475483173045 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.015763088505469 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.032309789714199 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.032083309243174 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.031243101397866 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.015374045570877 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.023714870805824 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.006273377088781 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.053804342216937 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.010389719399015 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.032725816591561 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.026037199224502 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.012560599450083 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, 0.01288792043649 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, 0.06113386353443 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 108 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 54 AS parent_id, -0.030700399532187 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 109 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 54 AS parent_id, -0.031186359613003 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 110 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 55 AS parent_id, -0.032078801754532 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 111 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 55 AS parent_id, -0.031181718383177 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 112 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, -0.032530558584967 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 113 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, -0.03119181851061 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 236 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, -0.017486682449969 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 237 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, -0.032107384401734 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 238 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.021516047910422 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 239 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, 0.024548969101731 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_43" AS 
(SELECT "DT_node_lookup_43"."KEY" AS "KEY", "DT_node_lookup_43".node_id_2 AS node_id_2, "DT_node_data_43".node_id AS node_id, "DT_node_data_43".feature AS feature, "DT_node_data_43"."threshold" AS "threshold", "DT_node_data_43".depth AS depth, "DT_node_data_43".parent_id AS parent_id, "DT_node_data_43"."Score" AS "Score" 
FROM "DT_node_lookup_43" LEFT OUTER JOIN "DT_node_data_43" ON "DT_node_lookup_43".node_id_2 = "DT_node_data_43".node_id), 
"LGBM_Model_3_10" AS 
(SELECT "DT_Output_43"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_43"."Score" AS "Score_3" 
FROM "DT_Output_43"), 
"DT_node_lookup_44" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.397498703526244) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= 0.056844366114366) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_59 <= -0.493321427148524) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.211642169689618) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_35 <= -0.301455914348131) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.009589112418312) THEN 74 ELSE 75 END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_99 <= 0.874048490874339) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -0.176529089019114) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= 0.221019882384262) THEN 40 ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.064575355318703) THEN 42 ELSE 43 END END ELSE 11 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.374529340156) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.223347536520032) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.021220293487998) THEN 100 ELSE 101 END ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.143729989656786) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.315436819236289) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.337705894530969) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.502525406123876) THEN 56 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.136011071233652) THEN 114 ELSE 115 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.701497555598703) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_98 <= -0.26270429282839) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -0.0) THEN 236 ELSE 237 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.84212082244031) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= -0.104780122351001) THEN 476 ELSE 477 END ELSE 239 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.930429083667873) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= 0.880825547268369) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= 0.824285968427703) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.265735721550309) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.121856302139455) THEN 496 ELSE 497 END ELSE 249 END ELSE 125 END ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_44" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.020207483385525 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 5 AS parent_id, -0.016147306409438 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.006710044873176 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.009808000033766 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.023317343658929 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.020024356704888 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.011676914583734 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.007514581594253 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.031218938436893 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.032085392709443 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.031064228586112 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.030494904876699 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.024304128449356 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 56 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.012362484873739 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.020850729504071 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.00204600575715 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 74 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.032269571250653 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 75 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.031269123471045 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 100 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 50 AS parent_id, 0.059524097093596 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 101 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 50 AS parent_id, 0.041646395494007 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 114 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 57 AS parent_id, 0.050488051383148 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 115 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 57 AS parent_id, 0.011370010590487 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 125 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.023230969228534 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 236 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, 0.020477252147743 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 237 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, -0.024469265828527 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 239 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.023332699623853 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 249 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 124 AS parent_id, -0.031856182639739 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 476 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 238 AS parent_id, -0.032060253090852 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 477 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 238 AS parent_id, -0.031282815464028 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 496 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 248 AS parent_id, -0.031512541933969 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 497 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 248 AS parent_id, -0.03063639303315 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_44" AS 
(SELECT "DT_node_lookup_44"."KEY" AS "KEY", "DT_node_lookup_44".node_id_2 AS node_id_2, "DT_node_data_44".node_id AS node_id, "DT_node_data_44".feature AS feature, "DT_node_data_44"."threshold" AS "threshold", "DT_node_data_44".depth AS depth, "DT_node_data_44".parent_id AS parent_id, "DT_node_data_44"."Score" AS "Score" 
FROM "DT_node_lookup_44" LEFT OUTER JOIN "DT_node_data_44" ON "DT_node_lookup_44".node_id_2 = "DT_node_data_44".node_id), 
"LGBM_Model_0_11" AS 
(SELECT "DT_Output_44"."KEY" AS "KEY", "DT_Output_44"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_44"), 
"DT_node_lookup_45" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -1.06711085314315) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 1.107668097192869) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.518932407359288) THEN 148 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.316402671445631) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.180958621044747) THEN 596 ELSE 597 END ELSE 299 END END ELSE 75 END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.57526783081357) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.39345129277798) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.005946442754744) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= -1.009712241948112) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_61 <= 0.875087817075194) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_34 <= 0.555084873607966) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_67 <= -0.901438832503692) THEN 184 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.0749257362689) THEN 370 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.0) THEN 742 ELSE 743 END END END ELSE 93 END ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= 0.037788382848604) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= 0.3908317861375) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= 0.318382131418994) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.46665806715587) THEN 48 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= -0.319168070527423) THEN 98 ELSE 99 END END ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.024857931158871) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.378160516310635) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.870443456675153) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.444433880172718) THEN 56 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_85 <= -0.131481433728091) THEN 114 ELSE 115 END END ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= 0.252875827706189) THEN 30 ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_45" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.000699459755317 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.002764148852279 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.007640062291683 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.017195640346088 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.010421654900351 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.040186556550777 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.003525475733499 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.045158245565526 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.062538778602971 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.015144206755095 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.022204088642774 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.005933091636955 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.048309644626162 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.009774592378517 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.007194766507509 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 56 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, 0.027734731865453 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 75 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.03110736317952 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 93 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, 0.007012406398541 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 98 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 49 AS parent_id, -0.034350381312927 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 99 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 49 AS parent_id, -0.032277642230295 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 114 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 57 AS parent_id, -0.032597395645847 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 115 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 57 AS parent_id, 0.006066697870039 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 148 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 74 AS parent_id, -0.03027130175659 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 184 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 92 AS parent_id, -0.01168850233195 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 299 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 149 AS parent_id, -0.030412294081855 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 370 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 185 AS parent_id, -0.033435238767709 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 596 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 298 AS parent_id, -0.031069208162526 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 597 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 298 AS parent_id, -0.03060627609349 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 742 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 371 AS parent_id, -0.032549719422671 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 743 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 371 AS parent_id, -0.030950949948213 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_45" AS 
(SELECT "DT_node_lookup_45"."KEY" AS "KEY", "DT_node_lookup_45".node_id_2 AS node_id_2, "DT_node_data_45".node_id AS node_id, "DT_node_data_45".feature AS feature, "DT_node_data_45"."threshold" AS "threshold", "DT_node_data_45".depth AS depth, "DT_node_data_45".parent_id AS parent_id, "DT_node_data_45"."Score" AS "Score" 
FROM "DT_node_lookup_45" LEFT OUTER JOIN "DT_node_data_45" ON "DT_node_lookup_45".node_id_2 = "DT_node_data_45".node_id), 
"LGBM_Model_1_11" AS 
(SELECT "DT_Output_45"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_45"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_45"), 
"DT_node_lookup_46" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.233320077675485) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.208001662790876) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.740266934927638) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -0.038055279184741) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_100 <= -1.062578723534019) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= 0.821443628472691) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_65 <= -0.68159564211355) THEN 76 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_55 <= 0.579439014645786) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_99 <= -0.435092192958091) THEN 308 ELSE 309 END ELSE 155 END END ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= -0.044920644703798) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -0.387918175051577) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= 0.093822650023526) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.289140415659375) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= 0.516712129970437) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.640519015606672) THEN 46 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.602113420691448) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= 0.304188727174445) THEN 188 ELSE 189 END ELSE 95 END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.814454484025646) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= -0.537162936851023) THEN 12 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.101493962001015) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.763611506673371) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.485637271654055) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.167693796983301) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= 0.045222640481856) THEN 112 ELSE 113 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_65 <= -0.375146887931288) THEN 114 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= -0.125077386244194) THEN 230 ELSE 231 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.172160419561616) THEN 58 ELSE 59 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= -0.428589416704194) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.051345104615347) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_46" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 12 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.05575879204903 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.029602238288075 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, -0.024383717617685 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.002783843518213 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.010957676887717 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.038133025047011 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.008571330433597 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.004786621739671 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.019434602451734 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.008254150008358 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.048611439815458 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.010279206093739 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.036322052531887 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.007312067411533 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.052935615014499 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 59 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.004997233405314 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.033260509631285 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.031112687245355 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 76 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 38 AS parent_id, -0.032402195667789 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 95 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 47 AS parent_id, -0.030921751754985 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 112 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, -0.002325374860469 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 113 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, 0.049225285218342 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 114 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 57 AS parent_id, 0.012169069010741 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 155 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 77 AS parent_id, -0.031881669220083 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 188 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 94 AS parent_id, -0.031378839233305 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 189 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 94 AS parent_id, -0.032263341714732 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 230 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 115 AS parent_id, -0.032753974645012 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 231 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 115 AS parent_id, -0.02460240569955 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 308 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 154 AS parent_id, -0.030648591142002 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 309 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 154 AS parent_id, -0.031240015424574 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_46" AS 
(SELECT "DT_node_lookup_46"."KEY" AS "KEY", "DT_node_lookup_46".node_id_2 AS node_id_2, "DT_node_data_46".node_id AS node_id, "DT_node_data_46".feature AS feature, "DT_node_data_46"."threshold" AS "threshold", "DT_node_data_46".depth AS depth, "DT_node_data_46".parent_id AS parent_id, "DT_node_data_46"."Score" AS "Score" 
FROM "DT_node_lookup_46" LEFT OUTER JOIN "DT_node_data_46" ON "DT_node_lookup_46".node_id_2 = "DT_node_data_46".node_id), 
"LGBM_Model_2_11" AS 
(SELECT "DT_Output_46"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_46"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_46"), 
"DT_node_lookup_47" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.109690480004397) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.593418384847587) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.05644227342009) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -1.396745969877637) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -0.530343399345609) THEN 34 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.390731714567062) THEN 70 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -0.295390750866583) THEN 142 ELSE 143 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.238163918077363) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_61 <= 0.211927215817628) THEN 36 ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.320437291030534) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_100 <= -0.125919764513613) THEN 76 ELSE 77 END ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= 0.131846105556483) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.22756320171486) THEN 20 ELSE 21 END ELSE 11 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.316328451954822) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_43 <= 0.819116136471358) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= -1.206021599259164) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.28641548852041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_39 <= -0.553139619281784) THEN 100 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_80 <= 0.306977412725936) THEN 202 ELSE 203 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.581871028043936) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= 0.323759766414362) THEN 204 ELSE 205 END ELSE 103 END END END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.615599899518282) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.135168839532732) THEN 28 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_99 <= 0.297530365189057) THEN 58 ELSE 59 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= -0.0876650200028) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= 0.143046552052876) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.27555171727055) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= -0.0) THEN 240 ELSE 241 END ELSE 121 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.079844772357258) THEN 122 ELSE 123 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.514818844866465) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.683342201397879) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= 0.12498228452213) THEN 252 ELSE 253 END ELSE 127 END END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_47" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 5 AS parent_id, 0.006096659602952 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.001736560495012 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.055009253132153 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.018030088682353 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.032330200317596 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.002358043732092 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.001344998641057 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, -0.005014648472243 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.031664347927627 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.004108068963703 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, 0.042820084097827 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, -0.031014630774288 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 59 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, -0.032302539416387 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, 0.011872101937262 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 70 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 35 AS parent_id, 0.052537272116511 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 76 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 38 AS parent_id, -0.031786894323729 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 77 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 38 AS parent_id, 0.018633510432795 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 100 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 50 AS parent_id, -0.031180024588545 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 103 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 51 AS parent_id, -0.030757870390584 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 121 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 60 AS parent_id, 0.033674524369807 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 122 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 61 AS parent_id, 0.007763583590082 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 123 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 61 AS parent_id, 0.058906401550023 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 127 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.000903105787122 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 142 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 71 AS parent_id, 0.041419245707453 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 143 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 71 AS parent_id, -0.012869129461617 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 202 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 101 AS parent_id, -0.030277260715347 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 203 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 101 AS parent_id, -0.030755585666322 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 204 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 102 AS parent_id, -0.031203258173273 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 205 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 102 AS parent_id, -0.032101855813322 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 240 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, -0.032679388022402 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 241 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 120 AS parent_id, 0.001072809681008 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 252 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 126 AS parent_id, -0.032195896726099 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 253 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 126 AS parent_id, -0.031501927053785 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_47" AS 
(SELECT "DT_node_lookup_47"."KEY" AS "KEY", "DT_node_lookup_47".node_id_2 AS node_id_2, "DT_node_data_47".node_id AS node_id, "DT_node_data_47".feature AS feature, "DT_node_data_47"."threshold" AS "threshold", "DT_node_data_47".depth AS depth, "DT_node_data_47".parent_id AS parent_id, "DT_node_data_47"."Score" AS "Score" 
FROM "DT_node_lookup_47" LEFT OUTER JOIN "DT_node_data_47" ON "DT_node_lookup_47".node_id_2 = "DT_node_data_47".node_id), 
"LGBM_Model_3_11" AS 
(SELECT "DT_Output_47"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_47"."Score" AS "Score_3" 
FROM "DT_Output_47"), 
"DT_node_lookup_48" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.451713696089738) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.211119237510429) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= -0.984986103252644) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.012181175852804) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_92 <= 1.377094513310284) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.340756718203289) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -1.170109368173922) THEN 72 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_98 <= 1.164061507222332) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_100 <= -0.90315148626121) THEN 292 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.863261041710764) THEN 586 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_85 <= 0.703020434625011) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.60392069330686) THEN 2348 ELSE 2349 END ELSE 1175 END END END ELSE 147 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= 0.565876392743766) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_80 <= -0.392381472716648) THEN 148 ELSE 149 END ELSE 75 END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= -0.407140976871437) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= -0.403071754973327) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_47 <= 0.037391937826322) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.110080129691146) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.306590633789884) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.261232682059475) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= 0.058509527731855) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.318106241928693) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.074368954498483) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -0.037185039769962) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.0) THEN 52 ELSE 53 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -0.047662638855446) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -0.509650615548876) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.356167737485619) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= -0.011287137477584) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_48" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.015009494390113 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.03793338521214 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, -0.013321801061938 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.00313565485096 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.017176410725586 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.025554906545245 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.009305383540252 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.056637556597934 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.014821336884721 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.026607675245166 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.022666002908281 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.00959248339207 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.031527363278529 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.004459561829476 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, -0.03282310840626 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.064204984755857 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 53 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.038424463653526 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, -0.011439340462719 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.033460430106913 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.032161654930764 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.031010298847324 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 72 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 36 AS parent_id, -0.010127062268411 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 75 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, 0.015329613786328 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 147 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 73 AS parent_id, -0.023289540040193 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 148 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 74 AS parent_id, -0.009115553318483 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 149 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 74 AS parent_id, -0.031535957628644 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 292 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 146 AS parent_id, -0.032657754037727 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 586 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 293 AS parent_id, -0.030732829615854 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1175 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 587 AS parent_id, -0.032135588838781 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2348 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1174 AS parent_id, -0.031443799764735 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2349 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 11 AS depth, 1174 AS parent_id, -0.030697611961668 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_48" AS 
(SELECT "DT_node_lookup_48"."KEY" AS "KEY", "DT_node_lookup_48".node_id_2 AS node_id_2, "DT_node_data_48".node_id AS node_id, "DT_node_data_48".feature AS feature, "DT_node_data_48"."threshold" AS "threshold", "DT_node_data_48".depth AS depth, "DT_node_data_48".parent_id AS parent_id, "DT_node_data_48"."Score" AS "Score" 
FROM "DT_node_lookup_48" LEFT OUTER JOIN "DT_node_data_48" ON "DT_node_lookup_48".node_id_2 = "DT_node_data_48".node_id), 
"LGBM_Model_0_12" AS 
(SELECT "DT_Output_48"."KEY" AS "KEY", "DT_Output_48"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_48"), 
"DT_node_lookup_49" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= -0.923326362600761) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 1.107668097192869) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.561200906941168) THEN 148 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.422367051286464) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.389495268404232) THEN 596 ELSE 597 END ELSE 299 END END ELSE 75 END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.289191756017089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= 0.393571563299742) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 1.133105550578871) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= -0.425410886925222) THEN 80 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= -0.21074850572262) THEN 162 ELSE 163 END END ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.298281198743656) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.185982484752025) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= -0.385345369294838) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_61 <= 0.225677698029096) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= 0.461211029145637) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= 0.487874242231529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.032077632324018) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_79 <= 0.042097226995642) THEN 48 ELSE 49 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.210255919601598) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.294865349412135) THEN 26 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= -0.193069569512856) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -0.68863708938623) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= 0.342791872981864) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= 0.107916973927981) THEN 60 ELSE 61 END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_49" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.000658106936241 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.028218634979241 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.002769387752943 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.001582329147315 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.002132548033875 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.021826981405229 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.015200114263331 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.011302263980059 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.025306201528568 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.011900331180532 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.03028410699721 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.03083163287336 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, 0.041724329535563 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 49 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, 0.002527563487653 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.017363245213625 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, -0.031930628337177 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.029629517918899 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.058457024799836 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.03108586599122 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.032689149957037 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 75 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.030847878870579 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 80 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, -0.00114804336454 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.017520788020891 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.03219023131819 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 148 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 74 AS parent_id, -0.030050609586719 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 162 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 81 AS parent_id, 0.057745456125732 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 163 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 81 AS parent_id, 0.020515958664599 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 299 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 149 AS parent_id, -0.030221411545554 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 596 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 298 AS parent_id, -0.03094880940886 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 597 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 298 AS parent_id, -0.030413292961114 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_49" AS 
(SELECT "DT_node_lookup_49"."KEY" AS "KEY", "DT_node_lookup_49".node_id_2 AS node_id_2, "DT_node_data_49".node_id AS node_id, "DT_node_data_49".feature AS feature, "DT_node_data_49"."threshold" AS "threshold", "DT_node_data_49".depth AS depth, "DT_node_data_49".parent_id AS parent_id, "DT_node_data_49"."Score" AS "Score" 
FROM "DT_node_lookup_49" LEFT OUTER JOIN "DT_node_data_49" ON "DT_node_lookup_49".node_id_2 = "DT_node_data_49".node_id), 
"LGBM_Model_1_12" AS 
(SELECT "DT_Output_49"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_49"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_49")
 SELECT "LGBM_B4"."KEY", "LGBM_B4"."Score_0", "LGBM_B4"."Score_1", "LGBM_B4"."Score_2", "LGBM_B4"."Score_3" 
FROM (SELECT "LGBM_esu_4"."KEY" AS "KEY", "LGBM_esu_4"."Score_0" AS "Score_0", "LGBM_esu_4"."Score_1" AS "Score_1", "LGBM_esu_4"."Score_2" AS "Score_2", "LGBM_esu_4"."Score_3" AS "Score_3" 
FROM (SELECT "LGBM_Model_0_10"."KEY" AS "KEY", "LGBM_Model_0_10"."Score_0" AS "Score_0", "LGBM_Model_0_10"."Score_1" AS "Score_1", "LGBM_Model_0_10"."Score_2" AS "Score_2", "LGBM_Model_0_10"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_10" UNION ALL SELECT "LGBM_Model_1_10"."KEY" AS "KEY", "LGBM_Model_1_10"."Score_0" AS "Score_0", "LGBM_Model_1_10"."Score_1" AS "Score_1", "LGBM_Model_1_10"."Score_2" AS "Score_2", "LGBM_Model_1_10"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_10" UNION ALL SELECT "LGBM_Model_2_10"."KEY" AS "KEY", "LGBM_Model_2_10"."Score_0" AS "Score_0", "LGBM_Model_2_10"."Score_1" AS "Score_1", "LGBM_Model_2_10"."Score_2" AS "Score_2", "LGBM_Model_2_10"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_10" UNION ALL SELECT "LGBM_Model_3_10"."KEY" AS "KEY", "LGBM_Model_3_10"."Score_0" AS "Score_0", "LGBM_Model_3_10"."Score_1" AS "Score_1", "LGBM_Model_3_10"."Score_2" AS "Score_2", "LGBM_Model_3_10"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_10" UNION ALL SELECT "LGBM_Model_0_11"."KEY" AS "KEY", "LGBM_Model_0_11"."Score_0" AS "Score_0", "LGBM_Model_0_11"."Score_1" AS "Score_1", "LGBM_Model_0_11"."Score_2" AS "Score_2", "LGBM_Model_0_11"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_11" UNION ALL SELECT "LGBM_Model_1_11"."KEY" AS "KEY", "LGBM_Model_1_11"."Score_0" AS "Score_0", "LGBM_Model_1_11"."Score_1" AS "Score_1", "LGBM_Model_1_11"."Score_2" AS "Score_2", "LGBM_Model_1_11"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_11" UNION ALL SELECT "LGBM_Model_2_11"."KEY" AS "KEY", "LGBM_Model_2_11"."Score_0" AS "Score_0", "LGBM_Model_2_11"."Score_1" AS "Score_1", "LGBM_Model_2_11"."Score_2" AS "Score_2", "LGBM_Model_2_11"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_11" UNION ALL SELECT "LGBM_Model_3_11"."KEY" AS "KEY", "LGBM_Model_3_11"."Score_0" AS "Score_0", "LGBM_Model_3_11"."Score_1" AS "Score_1", "LGBM_Model_3_11"."Score_2" AS "Score_2", "LGBM_Model_3_11"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_11" UNION ALL SELECT "LGBM_Model_0_12"."KEY" AS "KEY", "LGBM_Model_0_12"."Score_0" AS "Score_0", "LGBM_Model_0_12"."Score_1" AS "Score_1", "LGBM_Model_0_12"."Score_2" AS "Score_2", "LGBM_Model_0_12"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_12" UNION ALL SELECT "LGBM_Model_1_12"."KEY" AS "KEY", "LGBM_Model_1_12"."Score_0" AS "Score_0", "LGBM_Model_1_12"."Score_1" AS "Score_1", "LGBM_Model_1_12"."Score_2" AS "Score_2", "LGBM_Model_1_12"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_12") AS "LGBM_esu_4") AS "LGBM_B4") AS "U"

-- Code For temporary table tmp_20180416233648_w5e6vq_lgbm part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416233648_w5e6vq_lgbm  (
	"KEY" BIGINT, 
	"Score_0" FLOAT, 
	"Score_1" FLOAT, 
	"Score_2" FLOAT, 
	"Score_3" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416233648_w5e6vq_lgbm part 2/2. Populate

INSERT INTO tmp_20180416233648_w5e6vq_lgbm ("KEY", "Score_0", "Score_1", "Score_2", "Score_3") SELECT "U"."KEY", "U"."Score_0", "U"."Score_1", "U"."Score_2", "U"."Score_3" 
FROM (WITH "DT_node_lookup_50" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.56281341656356) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.011342994322324) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -1.437242589120763) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.935044206679286) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_55 <= 0.041017314902838) THEN 36 ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_83 <= -0.63768367921369) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= 0.253583449817676) THEN 76 ELSE 77 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.286549703841539) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= -0.01185549323854) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= 0.07450230161386) THEN 312 ELSE 313 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.081141369741027) THEN 314 ELSE 315 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.229091133364839) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.040954016730826) THEN 316 ELSE 317 END ELSE 159 END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= 0.22154062694815) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= 0.108198310501397) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.79704927872968) THEN 40 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.485637271654055) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_61 <= -0.363838063707875) THEN 164 ELSE 165 END ELSE 83 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= 0.499862478818646) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= 0.158297414923682) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 1.084140386205292) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_47 <= -0.621785568858888) THEN 44 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= -0.302879184043437) THEN 90 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.177336455106667) THEN 182 ELSE 183 END END END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.385650072856247) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= 0.60974502897004) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= 0.00909455278392) THEN 24 ELSE 25 END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= -0.854395912652681) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= -1.03169971172907) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.924892669631565) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.387487909627234) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_59 <= 0.086701943480666) THEN 248 ELSE 249 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_98 <= 0.247417774363335) THEN 250 ELSE 251 END END ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_50" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.047962764259465 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.024927046602073 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.002288470172694 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.004891666627755 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.033108086533776 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.003326405995523 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.015477363034464 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.031767256188355 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.017333055385847 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, 0.020903178005801 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.050628561621975 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.011965459277322 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.03144303872894 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 76 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 38 AS parent_id, 0.012163363368982 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 77 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 38 AS parent_id, -0.032433932359025 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 83 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, 0.005189712186399 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.018110506547569 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, 0.027223463548671 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 90 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 45 AS parent_id, -0.0324590418745 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 159 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 79 AS parent_id, 0.062832669453409 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 164 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, -0.023655927284238 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 165 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 82 AS parent_id, -0.03187907808764 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 182 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 91 AS parent_id, -0.030715801998753 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 183 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 91 AS parent_id, -0.031881664753244 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 248 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 124 AS parent_id, -0.030143245264143 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 249 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 124 AS parent_id, -0.030719562200869 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 250 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 125 AS parent_id, -0.031281525324969 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 251 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 125 AS parent_id, -0.03064073065019 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 312 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 156 AS parent_id, 0.050468771950018 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 313 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 156 AS parent_id, -0.000608943014235 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 314 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 157 AS parent_id, 0.014583498747476 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 315 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 157 AS parent_id, -0.027331712917969 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 316 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 158 AS parent_id, 0.003462740029152 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 317 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 158 AS parent_id, 0.043607753998208 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_50" AS 
(SELECT "DT_node_lookup_50"."KEY" AS "KEY", "DT_node_lookup_50".node_id_2 AS node_id_2, "DT_node_data_50".node_id AS node_id, "DT_node_data_50".feature AS feature, "DT_node_data_50"."threshold" AS "threshold", "DT_node_data_50".depth AS depth, "DT_node_data_50".parent_id AS parent_id, "DT_node_data_50"."Score" AS "Score" 
FROM "DT_node_lookup_50" LEFT OUTER JOIN "DT_node_data_50" ON "DT_node_lookup_50".node_id_2 = "DT_node_data_50".node_id), 
"LGBM_Model_2_12" AS 
(SELECT "DT_Output_50"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_50"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_50"), 
"DT_node_lookup_51" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.470663599441499) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.132832282716238) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_92 <= 1.039192762595194) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.602072359921817) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= 0.059881327018512) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_74 <= 0.091999545438564) THEN 64 ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.467576267285187) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.021977526667093) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.33678409112609) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_34 <= 0.37733997492107) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.277598755384722) THEN 88 ELSE 89 END ELSE 45 END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= -0.242943961687349) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.316328451954822) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.606392530350532) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= 0.665627395725153) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.175029537068632) THEN 100 ELSE 101 END ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= 0.863532085434816) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= 0.88315831302214) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.795391750053622) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN 208 ELSE 209 END ELSE 105 END ELSE 53 END ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_65 <= 1.378575993190553) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= -0.199889872546648) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_83 <= 1.028957468027695) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.481778503775085) THEN 112 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.40464904589208) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= -0.610250632997876) THEN 452 ELSE 453 END ELSE 227 END END ELSE 57 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.493048341442552) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= -0.76172013591432) THEN 116 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.043970952118211) THEN 234 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.096434479904503) THEN 470 ELSE 471 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.450148953838549) THEN 118 ELSE 119 END END END ELSE 15 END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_51" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.005571003207643 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.015826846268152 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.00361526042137 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.042560781366114 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.002699217148929 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.015716277155939 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.009148101489137 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.021676780531738 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.026489709167008 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.009024869739836 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, -0.005113363823674 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 53 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, -0.012985724962125 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.010530984321287 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 64 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.041274014721222 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.063030571227608 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 88 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.030839892842898 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 89 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.031827400553702 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 100 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 50 AS parent_id, -0.030652751172556 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 101 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 50 AS parent_id, -0.031685037403685 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 105 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 52 AS parent_id, -0.007379580346736 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 112 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, -0.031939707483444 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 116 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 58 AS parent_id, 0.028065509944565 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 118 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 59 AS parent_id, -0.023330997234236 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 119 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 59 AS parent_id, -0.031734034676964 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 208 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 104 AS parent_id, 0.021548804861984 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 209 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 104 AS parent_id, 0.053663005504922 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 227 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 113 AS parent_id, -0.03157696308576 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 234 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 117 AS parent_id, 0.006857196021179 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 452 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 226 AS parent_id, -0.030162092111665 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 453 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 226 AS parent_id, -0.030906322557716 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 470 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 235 AS parent_id, -0.03188746440644 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 471 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 235 AS parent_id, -0.023766357248303 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_51" AS 
(SELECT "DT_node_lookup_51"."KEY" AS "KEY", "DT_node_lookup_51".node_id_2 AS node_id_2, "DT_node_data_51".node_id AS node_id, "DT_node_data_51".feature AS feature, "DT_node_data_51"."threshold" AS "threshold", "DT_node_data_51".depth AS depth, "DT_node_data_51".parent_id AS parent_id, "DT_node_data_51"."Score" AS "Score" 
FROM "DT_node_lookup_51" LEFT OUTER JOIN "DT_node_data_51" ON "DT_node_lookup_51".node_id_2 = "DT_node_data_51".node_id), 
"LGBM_Model_3_12" AS 
(SELECT "DT_Output_51"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_51"."Score" AS "Score_3" 
FROM "DT_Output_51"), 
"DT_node_lookup_52" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.397498703526244) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= 0.056844366114366) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_59 <= -0.493321427148524) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.211642169689618) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_35 <= -0.301455914348131) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_82 <= -0.269062365705774) THEN 74 ELSE 75 END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= -0.809198609544057) THEN 10 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.56744503778288) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_46 <= 0.256682584183179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= -0.174592002783562) THEN 92 ELSE 93 END ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.753056438357138) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_76 <= 0.533068208715942) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.261472209710939) THEN 48 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.43174364062261) THEN 98 ELSE 99 END END ELSE 25 END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.315436819236289) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.337705894530969) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.136011071233652) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_65 <= 0.295335237153966) THEN 112 ELSE 113 END ELSE 57 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.701497555598703) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_98 <= -0.26270429282839) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -0.0) THEN 236 ELSE 237 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= 0.513535896724708) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= 0.14825370762204) THEN 476 ELSE 477 END ELSE 239 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.930429083667873) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= 0.880825547268369) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= 0.560432335967992) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_79 <= 0.308458898053918) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.316148777870413) THEN 496 ELSE 497 END ELSE 249 END ELSE 125 END ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_52" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.01963917247185 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 10 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 5 AS parent_id, -0.015423940595273 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, -0.012380789424607 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.006622687477312 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.030186670204074 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.003585038804395 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.011418792753791 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.007334965809484 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.031628516902026 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, 0.010581432495908 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, 0.000519071232515 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.01973718323164 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.001729219491822 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 74 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.0318137601687 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 75 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.030872969689573 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 92 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, -0.031260917651288 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 93 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 46 AS parent_id, -0.030490295007304 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 98 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 49 AS parent_id, 0.058636918364533 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 99 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 49 AS parent_id, 0.031180503395114 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 112 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, 0.055221817899953 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 113 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, 0.020419183439201 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 125 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.022740287115931 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 236 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, 0.019247115131104 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 237 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, -0.024108928586533 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 239 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 119 AS parent_id, -0.022960049250818 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 249 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 124 AS parent_id, -0.030471261701597 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 476 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 238 AS parent_id, -0.031794218969636 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 477 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 238 AS parent_id, -0.030929249915527 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 496 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 248 AS parent_id, -0.030770789739006 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 497 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 248 AS parent_id, -0.031623820416167 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_52" AS 
(SELECT "DT_node_lookup_52"."KEY" AS "KEY", "DT_node_lookup_52".node_id_2 AS node_id_2, "DT_node_data_52".node_id AS node_id, "DT_node_data_52".feature AS feature, "DT_node_data_52"."threshold" AS "threshold", "DT_node_data_52".depth AS depth, "DT_node_data_52".parent_id AS parent_id, "DT_node_data_52"."Score" AS "Score" 
FROM "DT_node_lookup_52" LEFT OUTER JOIN "DT_node_data_52" ON "DT_node_lookup_52".node_id_2 = "DT_node_data_52".node_id), 
"LGBM_Model_0_13" AS 
(SELECT "DT_Output_52"."KEY" AS "KEY", "DT_Output_52"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_52"), 
"DT_node_lookup_53" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= 0.358045535778086) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.24924510348413) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.735621670803348) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_55 <= -0.146925077462194) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_85 <= 0.386225675366354) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.297290191425121) THEN 64 ELSE 65 END ELSE 33 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_91 <= -0.641690658976338) THEN 34 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_39 <= 0.172018165548053) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= 0.168536160400138) THEN 140 ELSE 141 END ELSE 71 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= 0.070784811815833) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.941923052652281) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 1.120708435836532) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= 1.142074054523165) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= 0.662409977643115) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.153317603604485) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.081617978726793) THEN 320 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_79 <= 0.042097226995642) THEN 642 ELSE 643 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_80 <= -0.532284326336891) THEN 322 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.296863103907579) THEN 646 ELSE 647 END END END ELSE 81 END ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_43 <= 0.029881711736595) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= -0.008652611878061) THEN 22 ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= 0.496888666263869) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 0.894206822798638) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= 0.509794960115838) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_62 <= -0.68605848640405) THEN 48 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.742856261403803) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.512769387904622) THEN 196 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= -0.0) THEN 394 ELSE 395 END END ELSE 99 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.019430469204023) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_32 <= 0.190599763570158) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.507135847739276) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 0.546615605435342) THEN 28 ELSE 29 END ELSE 15 END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_53" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.011721951780522 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.000367400432577 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.053462726726939 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.032667397238987 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.016445386477661 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.031680900914984 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.005098222827142 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.032220366933159 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.011919075330084 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, -0.005561596739307 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, -0.026559921479605 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.005374246504413 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.026666406002127 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.021233241418573 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, 0.060458014563339 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, -0.026420363548698 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.025931005039736 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 64 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, -0.032675554791652 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, -0.031292784202933 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 71 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 35 AS parent_id, -0.007792541975543 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 81 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, -0.019457099214128 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 99 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 49 AS parent_id, 0.050213480180342 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 140 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 70 AS parent_id, 0.014043250817772 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 141 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 70 AS parent_id, 0.059503038379431 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 196 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 98 AS parent_id, 0.04280308700231 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 320 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 160 AS parent_id, -0.03298252800592 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 322 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 161 AS parent_id, -0.032186363186338 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 394 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 197 AS parent_id, -0.032051292585599 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 395 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 197 AS parent_id, 0.018588748050107 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 642 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 321 AS parent_id, -0.031045005136861 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 643 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 321 AS parent_id, -0.032184299025358 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 646 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 323 AS parent_id, -0.030215364228102 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 647 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 323 AS parent_id, -0.031135519838207 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_53" AS 
(SELECT "DT_node_lookup_53"."KEY" AS "KEY", "DT_node_lookup_53".node_id_2 AS node_id_2, "DT_node_data_53".node_id AS node_id, "DT_node_data_53".feature AS feature, "DT_node_data_53"."threshold" AS "threshold", "DT_node_data_53".depth AS depth, "DT_node_data_53".parent_id AS parent_id, "DT_node_data_53"."Score" AS "Score" 
FROM "DT_node_lookup_53" LEFT OUTER JOIN "DT_node_data_53" ON "DT_node_lookup_53".node_id_2 = "DT_node_data_53".node_id), 
"LGBM_Model_1_13" AS 
(SELECT "DT_Output_53"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_53"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_53"), 
"DT_node_lookup_54" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.56281341656356) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.011342994322324) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.935044206679286) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.009589112418312) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= 0.265848144446139) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= 0.58625193716783) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= -0.319116470023157) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_98 <= -0.275483586224406) THEN 144 ELSE 145 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= 0.221651671490304) THEN 146 ELSE 147 END END ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.253770836801218) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_62 <= 0.266713906378546) THEN 76 ELSE 77 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= 0.354898777281712) THEN 78 ELSE 79 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.397768403334476) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.726668846443118) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.318062005022933) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.063549051395734) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.485637271654055) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.979055337401938) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= 0.029893307701324) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= -0.424154848034445) THEN 176 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.119020459440762) THEN 354 ELSE 355 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= 0.439796484827994) THEN 178 ELSE 179 END END ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.172160419561616) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= 0.257451832792748) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -0.313816806385751) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 0.67460092279539) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= -0.119010777392229) THEN 48 ELSE 49 END ELSE 25 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_85 <= 0.694885607289865) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_85 <= -0.506972500962068) THEN 52 ELSE 53 END ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.74141214646237) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.296863103907579) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= -0.113806981010926) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_54" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, -0.016076766334463 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, -0.031195547062326 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.005261895270731 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.001912772791242 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.003086299786206 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.026058879800619 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.032508332596312 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.020204494113566 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.031198631420978 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.02733570864601 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.051815416113438 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.002586368563369 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.032173056170586 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 49 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, -0.030876316350055 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, -0.013472446443161 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 53 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.041025589746953 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.031520342472257 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.0305357743271 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 76 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 38 AS parent_id, -0.007631088912824 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 77 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 38 AS parent_id, 0.035334327620505 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 78 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 39 AS parent_id, 0.056260584390299 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 79 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 39 AS parent_id, 0.024525981861331 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.030175579064376 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.03073280090614 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 144 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 72 AS parent_id, 0.025275486447776 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 145 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 72 AS parent_id, -0.027450443733911 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 146 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 73 AS parent_id, 0.045762475622632 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 147 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 73 AS parent_id, 0.004899079828873 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 176 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 88 AS parent_id, -0.023666893099912 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 178 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 89 AS parent_id, -0.022479515487454 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 179 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 89 AS parent_id, 0.025234426956949 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 354 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 177 AS parent_id, -0.030972066899762 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 355 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 177 AS parent_id, -0.031815090073736 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_54" AS 
(SELECT "DT_node_lookup_54"."KEY" AS "KEY", "DT_node_lookup_54".node_id_2 AS node_id_2, "DT_node_data_54".node_id AS node_id, "DT_node_data_54".feature AS feature, "DT_node_data_54"."threshold" AS "threshold", "DT_node_data_54".depth AS depth, "DT_node_data_54".parent_id AS parent_id, "DT_node_data_54"."Score" AS "Score" 
FROM "DT_node_lookup_54" LEFT OUTER JOIN "DT_node_data_54" ON "DT_node_lookup_54".node_id_2 = "DT_node_data_54".node_id), 
"LGBM_Model_2_13" AS 
(SELECT "DT_Output_54"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_54"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_54"), 
"DT_node_lookup_55" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.248582784942763) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= 0.124141494919062) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= 1.016622928134099) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.02126341342427) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.79355517396423) THEN 32 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_92 <= -0.206227968162295) THEN 66 ELSE 67 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= 0.665027816041179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.382914244114578) THEN 68 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_67 <= 0.531526351897226) THEN 138 ELSE 139 END END ELSE 35 END END ELSE 9 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_46 <= 1.251158540142022) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= 0.939239507911703) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.860406018609814) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.270128335263099) THEN 80 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.134798807966422) THEN 162 ELSE 163 END END ELSE 41 END ELSE 21 END ELSE 11 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.983199319573905) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= 0.13425942988374) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.177106918864117) THEN 24 ELSE 25 END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.437603811795719) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.140502758872103) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= -0.21597926002856) THEN 56 ELSE 57 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= 0.529824084774174) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.177065497915694) THEN 116 ELSE 117 END ELSE 59 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -1.171646158429728) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= 0.928149012238793) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= -0.329275036873117) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 0.567269810535898) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= -0.046805466656308) THEN 496 ELSE 497 END ELSE 249 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= 0.186309844650403) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.031529932059306) THEN 500 ELSE 501 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.181532309171135) THEN 502 ELSE 503 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.037108668948587) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_55" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.030859245582725 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 5 AS parent_id, -0.005084130530066 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.012883174718252 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.01731924403718 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.059590226489147 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.032727260779085 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.027750950915413 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.031626984045954 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.005716926112314 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.032109573355523 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 56 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, 0.026320704961231 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.015243456371555 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 59 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, -0.009198613340845 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 66 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, 0.019505750751392 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 67 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, -0.025216090155722 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 68 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 34 AS parent_id, -0.03332206137115 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 80 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, -0.030428891787477 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 116 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 58 AS parent_id, -0.032224096239941 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 117 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 58 AS parent_id, -0.03069140505665 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.031851968443111 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 127 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, 0.003725802781584 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 138 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 69 AS parent_id, -0.030766440877667 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 139 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 69 AS parent_id, -0.03188308261711 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 162 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 81 AS parent_id, -0.030681190567851 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 163 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 81 AS parent_id, -0.031747451047679 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 249 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 124 AS parent_id, 0.011214106373734 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 496 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 248 AS parent_id, 0.028407429772086 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 497 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 248 AS parent_id, 0.063923691781207 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 500 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 250 AS parent_id, 0.041221292152577 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 501 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 250 AS parent_id, -0.004664279731967 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 502 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 251 AS parent_id, 0.006416600621258 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 503 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 251 AS parent_id, -0.031681780231579 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_55" AS 
(SELECT "DT_node_lookup_55"."KEY" AS "KEY", "DT_node_lookup_55".node_id_2 AS node_id_2, "DT_node_data_55".node_id AS node_id, "DT_node_data_55".feature AS feature, "DT_node_data_55"."threshold" AS "threshold", "DT_node_data_55".depth AS depth, "DT_node_data_55".parent_id AS parent_id, "DT_node_data_55"."Score" AS "Score" 
FROM "DT_node_lookup_55" LEFT OUTER JOIN "DT_node_data_55" ON "DT_node_lookup_55".node_id_2 = "DT_node_data_55".node_id), 
"LGBM_Model_3_13" AS 
(SELECT "DT_Output_55"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_55"."Score" AS "Score_3" 
FROM "DT_Output_55"), 
"DT_node_lookup_56" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.451713696089738) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.067193373231848) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.554627746272502) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_91 <= 0.620348855017262) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.211119237510429) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.35755149859928) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.216351443626411) THEN 128 ELSE 129 END ELSE 65 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 0.319456922138456) THEN 66 ELSE 67 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.013477726213482) THEN 34 ELSE 35 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.795194172858918) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.018658565351726) THEN 38 ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= 0.810356497385888) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.40938646479272) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.046652057345974) THEN 80 ELSE 81 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_99 <= -0.330944269419189) THEN 82 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= 0.215350047243176) THEN 166 ELSE 167 END END END ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.041686166581799) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_81 <= -0.66987613848889) THEN 44 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.276965392806154) THEN 90 ELSE 91 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= -0.136321389014867) THEN 46 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= 0.425627624901464) THEN 94 ELSE 95 END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= 0.058509527731855) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.318106241928693) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.074368954498483) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -0.037185039769962) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= 0.232932935729567) THEN 52 ELSE 53 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -0.047662638855446) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= -0.509650615548876) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.356167737485619) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= -0.011287137477584) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_56" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.014235207613745 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.003651376855831 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.008735712911064 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.024245945141936 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.008867163461929 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.003654098663704 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, -0.032518202123382 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.031563791115808 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.03068639768808 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.002273142075593 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, 0.041154027731387 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.004188043220252 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, -0.032400113614895 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.036025489666966 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 53 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.060222255327316 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, -0.01107874245677 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.031599256321357 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.031925164270889 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.03071649047139 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 65 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 32 AS parent_id, 0.036285121032641 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 66 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, 0.051829615588972 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 67 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, 0.017774226012988 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 80 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, -0.030041939769538 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 81 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, -0.030757702331567 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 82 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 41 AS parent_id, -0.031830163841861 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 90 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 45 AS parent_id, -0.032375055522655 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 91 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 45 AS parent_id, -0.030977855447792 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 94 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 47 AS parent_id, 0.008410173511021 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 95 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 47 AS parent_id, -0.031768736319928 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 128 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 64 AS parent_id, 0.000822341475277 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 129 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 64 AS parent_id, -0.031719609158808 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 166 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 83 AS parent_id, -0.030291491389165 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 167 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 83 AS parent_id, -0.031130884407497 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_56" AS 
(SELECT "DT_node_lookup_56"."KEY" AS "KEY", "DT_node_lookup_56".node_id_2 AS node_id_2, "DT_node_data_56".node_id AS node_id, "DT_node_data_56".feature AS feature, "DT_node_data_56"."threshold" AS "threshold", "DT_node_data_56".depth AS depth, "DT_node_data_56".parent_id AS parent_id, "DT_node_data_56"."Score" AS "Score" 
FROM "DT_node_lookup_56" LEFT OUTER JOIN "DT_node_data_56" ON "DT_node_lookup_56".node_id_2 = "DT_node_data_56".node_id), 
"LGBM_Model_0_14" AS 
(SELECT "DT_Output_56"."KEY" AS "KEY", "DT_Output_56"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_56"), 
"DT_node_lookup_57" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.292922397197381) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.282619957032529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.932402185665807) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_101 <= 1.073246351096179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -1.06711085314315) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 1.107668097192869) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= -0.180571364732146) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -0.069803880703463) THEN 296 ELSE 297 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.00868528955783) THEN 298 ELSE 299 END END ELSE 75 END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.289191756017089) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -0.881775866110581) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= 0.407072377834887) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_37 <= 0.210323266377077) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= 0.021691685977209) THEN 168 ELSE 169 END ELSE 85 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= -0.45444476506751) THEN 86 ELSE 87 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.510874314724548) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_61 <= 0.225677698029096) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -1.311392357476027) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= 0.461211029145637) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= 0.611302165095242) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= 0.564669330215273) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_67 <= 0.145253554295939) THEN 224 ELSE 225 END ELSE 113 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= -0.325446764973493) THEN 114 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_81 <= -0.249084421764724) THEN 230 ELSE 231 END END END ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.21370379262259) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.500990665861413) THEN 60 ELSE 61 END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_57" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, 0.037430436986069 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.000503846844871 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, -0.00266402269692 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.036851740216253 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.01621935292207 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.00942855634882 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.021198100255076 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.017773901471384 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, 0.016949149430749 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.029921736374555 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.030526494035213 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.013073171731252 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, -0.032759984882072 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 75 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, -0.030633042641167 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, 0.032157400852896 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 86 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, -0.004086582269128 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 87 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 43 AS parent_id, -0.031677031100515 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 113 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, 0.032618185385931 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 114 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 57 AS parent_id, 0.061316875266811 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 168 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 84 AS parent_id, -0.019144754438353 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 169 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 84 AS parent_id, 0.01673789026244 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 224 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, 0.003623352383986 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 225 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, -0.032122996291048 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 230 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 115 AS parent_id, 0.048643591464026 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 231 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 115 AS parent_id, 0.004996196721406 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 296 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 148 AS parent_id, -0.030070412720843 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 297 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 148 AS parent_id, -0.029662153094604 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 298 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 149 AS parent_id, -0.030024861126785 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 299 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 149 AS parent_id, -0.030530824446818 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_57" AS 
(SELECT "DT_node_lookup_57"."KEY" AS "KEY", "DT_node_lookup_57".node_id_2 AS node_id_2, "DT_node_data_57".node_id AS node_id, "DT_node_data_57".feature AS feature, "DT_node_data_57"."threshold" AS "threshold", "DT_node_data_57".depth AS depth, "DT_node_data_57".parent_id AS parent_id, "DT_node_data_57"."Score" AS "Score" 
FROM "DT_node_lookup_57" LEFT OUTER JOIN "DT_node_data_57" ON "DT_node_lookup_57".node_id_2 = "DT_node_data_57".node_id), 
"LGBM_Model_1_14" AS 
(SELECT "DT_Output_57"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_57"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_57"), 
"DT_node_lookup_58" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -1.59825500858324) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= -0.068874798285621) THEN 4 ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.935044206679286) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.912602870207743) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_32 <= -0.862313248959513) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.293984056909912) THEN 50 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.030628043816094) THEN 102 ELSE 103 END END END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.436440086503997) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= 1.006211163502712) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= -0.095099244254024) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= -0.85707145534946) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= 0.314451700278235) THEN 224 ELSE 225 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_44 <= -0.319168070527423) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_37 <= 0.386814070791847) THEN 452 ELSE 453 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.586401752967636) THEN 454 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= -0.348307955857075) THEN 910 ELSE 911 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.172940614388226) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.789551632689994) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_98 <= -0.040046422400052) THEN 456 ELSE 457 END ELSE 229 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_49 <= -0.482737729735489) THEN 230 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_73 <= -0.109778543620606) THEN 462 ELSE 463 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= 0.394654086756662) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.047334907793524) THEN 116 ELSE 117 END ELSE 59 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.385650072856247) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.586213806062776) THEN 60 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_34 <= 0.011774206989192) THEN 122 ELSE 123 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= -0.841086977619665) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= 1.030181664292357) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.725871576241692) THEN 252 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_78 <= 0.542827903733605) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= 0.061522954232201) THEN 1012 ELSE 1013 END ELSE 507 END END ELSE 127 END END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_58" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 4 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, 0.003527064496695 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 2 AS parent_id, 0.048048992193152 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, -0.004913603445118 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, -0.022272131924396 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, -0.031460508770114 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 59 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.000794988855743 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.028239635337078 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, 0.003903307660893 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 102 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 51 AS parent_id, -0.030921265928592 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 103 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 51 AS parent_id, -0.030215857715857 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 116 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 58 AS parent_id, -0.023712884769802 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 117 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 58 AS parent_id, -0.031906393803054 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 122 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 61 AS parent_id, -0.027661658941574 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 123 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 61 AS parent_id, 0.00550919500011 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 127 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, -0.022142432679486 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 224 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, 0.059798876148723 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 225 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, 0.034435020279872 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 229 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 114 AS parent_id, 0.04478862385359 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 230 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 115 AS parent_id, 0.002819998341319 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 252 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 126 AS parent_id, -0.031470018686688 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 452 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 226 AS parent_id, -0.024401381383126 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 453 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 226 AS parent_id, 0.012539115750546 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 454 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 227 AS parent_id, -0.012642679325468 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 456 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 228 AS parent_id, 0.022808286910672 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 457 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 228 AS parent_id, -0.016843117640492 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 462 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 231 AS parent_id, -0.01859505381438 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 463 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 231 AS parent_id, -0.032375496000151 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 507 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 253 AS parent_id, -0.031136358095931 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 910 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 455 AS parent_id, 0.011467055283782 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 911 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 455 AS parent_id, 0.050820575725556 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1012 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 506 AS parent_id, -0.030633001898886 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1013 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 506 AS parent_id, -0.02985226798039 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_58" AS 
(SELECT "DT_node_lookup_58"."KEY" AS "KEY", "DT_node_lookup_58".node_id_2 AS node_id_2, "DT_node_data_58".node_id AS node_id, "DT_node_data_58".feature AS feature, "DT_node_data_58"."threshold" AS "threshold", "DT_node_data_58".depth AS depth, "DT_node_data_58".parent_id AS parent_id, "DT_node_data_58"."Score" AS "Score" 
FROM "DT_node_lookup_58" LEFT OUTER JOIN "DT_node_data_58" ON "DT_node_lookup_58".node_id_2 = "DT_node_data_58".node_id), 
"LGBM_Model_2_14" AS 
(SELECT "DT_Output_58"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_58"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_58"), 
"DT_node_lookup_59" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= -0.248582784942763) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= 0.124141494919062) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= 1.016622928134099) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.02126341342427) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.79355517396423) THEN 32 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_92 <= -0.206227968162295) THEN 66 ELSE 67 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= 0.665027816041179) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.382914244114578) THEN 68 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_67 <= 0.531526351897226) THEN 138 ELSE 139 END END ELSE 35 END END ELSE 9 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= -0.972349215583311) THEN 10 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_100 <= 1.088960796262522) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.107651591602749) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= -0.415859925153908) THEN 88 ELSE 89 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= -0.277699071834435) THEN 90 ELSE 91 END END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.983199319573905) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= 0.13425942988374) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.556402577321002) THEN 24 ELSE 25 END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.437603811795719) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= 0.549188095555216) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.598904569016407) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.471824651492295) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= 0.215350047243176) THEN 224 ELSE 225 END ELSE 113 END ELSE 57 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_95 <= 0.131276003408889) THEN 58 ELSE 59 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -1.171646158429728) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= -1.080020023929902) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_62 <= -0.094673363676156) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= -0.057424171466306) THEN 252 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.088458334722429) THEN 506 ELSE 507 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.574802437330151) THEN 254 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.006847653926076) THEN 510 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= -0.113334044922341) THEN 1022 ELSE 1023 END END END END END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_59" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.029616446651152 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 10 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 5 AS parent_id, -0.004492682999201 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.012266878338623 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.015418179299104 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.056759708047376 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.03066088305722 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, -0.027480991513161 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 16 AS parent_id, 0.030248973261798 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 17 AS parent_id, 0.005765724131028 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 28 AS parent_id, -0.004970916229545 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, -0.025193548251622 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 59 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.034596165405017 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 62 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, 0.040019568401201 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 66 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, 0.018975996073843 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 67 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 33 AS parent_id, -0.024931229678448 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 68 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 34 AS parent_id, -0.032991159938985 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 88 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.030256680883654 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 89 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 44 AS parent_id, -0.031040358081957 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 90 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 45 AS parent_id, -0.030834665626185 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 91 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 45 AS parent_id, -0.032023730607108 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 113 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, -0.023203234948639 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 138 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 69 AS parent_id, -0.03052497430435 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 139 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 69 AS parent_id, -0.031624184262278 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 224 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, -0.032711990532912 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 225 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 112 AS parent_id, -0.030814187057634 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 252 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 126 AS parent_id, -0.004223969215572 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 254 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 127 AS parent_id, 0.020566089400556 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 506 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 253 AS parent_id, 0.023423980149605 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 507 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 253 AS parent_id, 0.054180210128316 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 510 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 255 AS parent_id, 0.001062770503407 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1022 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 511 AS parent_id, -0.024690350175191 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1023 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 511 AS parent_id, -0.032458131495574 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_59" AS 
(SELECT "DT_node_lookup_59"."KEY" AS "KEY", "DT_node_lookup_59".node_id_2 AS node_id_2, "DT_node_data_59".node_id AS node_id, "DT_node_data_59".feature AS feature, "DT_node_data_59"."threshold" AS "threshold", "DT_node_data_59".depth AS depth, "DT_node_data_59".parent_id AS parent_id, "DT_node_data_59"."Score" AS "Score" 
FROM "DT_node_lookup_59" LEFT OUTER JOIN "DT_node_data_59" ON "DT_node_lookup_59".node_id_2 = "DT_node_data_59".node_id), 
"LGBM_Model_3_14" AS 
(SELECT "DT_Output_59"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_59"."Score" AS "Score_3" 
FROM "DT_Output_59")
 SELECT "LGBM_B5"."KEY", "LGBM_B5"."Score_0", "LGBM_B5"."Score_1", "LGBM_B5"."Score_2", "LGBM_B5"."Score_3" 
FROM (SELECT "LGBM_esu_5"."KEY" AS "KEY", "LGBM_esu_5"."Score_0" AS "Score_0", "LGBM_esu_5"."Score_1" AS "Score_1", "LGBM_esu_5"."Score_2" AS "Score_2", "LGBM_esu_5"."Score_3" AS "Score_3" 
FROM (SELECT "LGBM_Model_2_12"."KEY" AS "KEY", "LGBM_Model_2_12"."Score_0" AS "Score_0", "LGBM_Model_2_12"."Score_1" AS "Score_1", "LGBM_Model_2_12"."Score_2" AS "Score_2", "LGBM_Model_2_12"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_12" UNION ALL SELECT "LGBM_Model_3_12"."KEY" AS "KEY", "LGBM_Model_3_12"."Score_0" AS "Score_0", "LGBM_Model_3_12"."Score_1" AS "Score_1", "LGBM_Model_3_12"."Score_2" AS "Score_2", "LGBM_Model_3_12"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_12" UNION ALL SELECT "LGBM_Model_0_13"."KEY" AS "KEY", "LGBM_Model_0_13"."Score_0" AS "Score_0", "LGBM_Model_0_13"."Score_1" AS "Score_1", "LGBM_Model_0_13"."Score_2" AS "Score_2", "LGBM_Model_0_13"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_13" UNION ALL SELECT "LGBM_Model_1_13"."KEY" AS "KEY", "LGBM_Model_1_13"."Score_0" AS "Score_0", "LGBM_Model_1_13"."Score_1" AS "Score_1", "LGBM_Model_1_13"."Score_2" AS "Score_2", "LGBM_Model_1_13"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_13" UNION ALL SELECT "LGBM_Model_2_13"."KEY" AS "KEY", "LGBM_Model_2_13"."Score_0" AS "Score_0", "LGBM_Model_2_13"."Score_1" AS "Score_1", "LGBM_Model_2_13"."Score_2" AS "Score_2", "LGBM_Model_2_13"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_13" UNION ALL SELECT "LGBM_Model_3_13"."KEY" AS "KEY", "LGBM_Model_3_13"."Score_0" AS "Score_0", "LGBM_Model_3_13"."Score_1" AS "Score_1", "LGBM_Model_3_13"."Score_2" AS "Score_2", "LGBM_Model_3_13"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_13" UNION ALL SELECT "LGBM_Model_0_14"."KEY" AS "KEY", "LGBM_Model_0_14"."Score_0" AS "Score_0", "LGBM_Model_0_14"."Score_1" AS "Score_1", "LGBM_Model_0_14"."Score_2" AS "Score_2", "LGBM_Model_0_14"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_14" UNION ALL SELECT "LGBM_Model_1_14"."KEY" AS "KEY", "LGBM_Model_1_14"."Score_0" AS "Score_0", "LGBM_Model_1_14"."Score_1" AS "Score_1", "LGBM_Model_1_14"."Score_2" AS "Score_2", "LGBM_Model_1_14"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_14" UNION ALL SELECT "LGBM_Model_2_14"."KEY" AS "KEY", "LGBM_Model_2_14"."Score_0" AS "Score_0", "LGBM_Model_2_14"."Score_1" AS "Score_1", "LGBM_Model_2_14"."Score_2" AS "Score_2", "LGBM_Model_2_14"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_14" UNION ALL SELECT "LGBM_Model_3_14"."KEY" AS "KEY", "LGBM_Model_3_14"."Score_0" AS "Score_0", "LGBM_Model_3_14"."Score_1" AS "Score_1", "LGBM_Model_3_14"."Score_2" AS "Score_2", "LGBM_Model_3_14"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_14") AS "LGBM_esu_5") AS "LGBM_B5") AS "U"

-- Code For temporary table tmp_20180416233648_z4e9qe_lgbm part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416233648_z4e9qe_lgbm  (
	"KEY" BIGINT, 
	"Score_0" FLOAT, 
	"Score_1" FLOAT, 
	"Score_2" FLOAT, 
	"Score_3" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416233648_z4e9qe_lgbm part 2/2. Populate

INSERT INTO tmp_20180416233648_z4e9qe_lgbm ("KEY", "Score_0", "Score_1", "Score_2", "Score_3") SELECT "U"."KEY", "U"."Score_0", "U"."Score_1", "U"."Score_2", "U"."Score_3" 
FROM (WITH "DT_node_lookup_60" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= -0.397498703526244) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.79602768915845) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.549648527181562) THEN 8 ELSE 9 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= 0.081119450256599) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_96 <= 0.194339779155819) THEN 40 ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_97 <= 0.397867616579586) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_35 <= 0.046906087052007) THEN 84 ELSE 85 END ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.051846325263541) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_48 <= 0.450663168268639) THEN 44 ELSE 45 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= -0.628094847787826) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.492481263797347) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.401833144904379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.411269698220365) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.147445963708952) THEN 50 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_53 <= 0.008264728017387) THEN 102 ELSE 103 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.240745697470727) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.520934551988361) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.0) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_55 <= 0.172400233596178) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.336693839055946) THEN 112 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= 0.160320080494941) THEN 226 ELSE 227 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.558504994531156) THEN 114 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.295238838905168) THEN 230 ELSE 231 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_42 <= -0.723282227963803) THEN 58 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.181461964008198) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_87 <= 0.096007696097535) THEN 236 ELSE 237 END ELSE 119 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.796113255928191) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= 0.931194279251184) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_50 <= -0.299600927341793) THEN 124 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.099006626529691) THEN 250 ELSE 251 END END ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_60" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, -0.024494983963422 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 4 AS parent_id, 0.022204977771462 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.007233039110543 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.017190641893249 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.024635017360798 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 15 AS parent_id, 0.003852272307654 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, 0.022354527512167 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.024620018602723 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.014882412752284 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.029674804759983 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 22 AS parent_id, -0.030332251573647 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.031261091684281 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 23 AS parent_id, -0.030418271726807 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.016900703637836 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, -0.019500876000753 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 63 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 31 AS parent_id, -0.023347772846669 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 84 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.030457755067623 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 85 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 42 AS parent_id, -0.031270092359235 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 102 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 51 AS parent_id, 0.055275493266963 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 103 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 51 AS parent_id, 0.035488711651163 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 112 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 56 AS parent_id, 0.028591862399048 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 114 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 57 AS parent_id, -0.010274562024197 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 119 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 59 AS parent_id, 0.003905319250788 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 124 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.03244453363824 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 226 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 113 AS parent_id, -0.031620423983092 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 227 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 113 AS parent_id, 0.001488119246425 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 230 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 115 AS parent_id, -0.032190375477797 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 231 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 115 AS parent_id, -0.030800996847162 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 236 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, 0.017418870990851 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 237 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 118 AS parent_id, 0.054382357932897 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 250 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 125 AS parent_id, -0.030303830087417 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 251 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 125 AS parent_id, -0.031335623707902 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_60" AS 
(SELECT "DT_node_lookup_60"."KEY" AS "KEY", "DT_node_lookup_60".node_id_2 AS node_id_2, "DT_node_data_60".node_id AS node_id, "DT_node_data_60".feature AS feature, "DT_node_data_60"."threshold" AS "threshold", "DT_node_data_60".depth AS depth, "DT_node_data_60".parent_id AS parent_id, "DT_node_data_60"."Score" AS "Score" 
FROM "DT_node_lookup_60" LEFT OUTER JOIN "DT_node_data_60" ON "DT_node_lookup_60".node_id_2 = "DT_node_data_60".node_id), 
"LGBM_Model_0_15" AS 
(SELECT "DT_Output_60"."KEY" AS "KEY", "DT_Output_60"."Score" AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_60"), 
"DT_node_lookup_61" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= 0.358045535778086) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.24924510348413) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.606392530350532) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_36 <= 0.354329666730895) THEN 16 ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.025941224385039) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_55 <= 0.057422429660201) THEN 36 ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.840194769298007) THEN 38 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= 0.081722782592972) THEN 78 ELSE 79 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.941923052652281) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 1.120708435836532) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= 1.142074054523165) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= 0.662409977643115) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_32 <= -0.438590904524166) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_34 <= -0.135770850509141) THEN 320 ELSE 321 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_90 <= -0.153317603604485) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.43174364062261) THEN 644 ELSE 645 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.296863103907579) THEN 646 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_81 <= 0.400137467411461) THEN 1294 ELSE 1295 END END END END ELSE 81 END ELSE 41 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_43 <= 0.029881711736595) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_69 <= -0.008652611878061) THEN 22 ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_57 <= 0.496888666263869) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 0.894206822798638) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_94 <= 0.509794960115838) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_62 <= -0.68605848640405) THEN 48 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.742856261403803) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.512769387904622) THEN 196 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= -0.0) THEN 394 ELSE 395 END END ELSE 99 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= 0.019430469204023) THEN 50 ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_32 <= 0.190599763570158) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.086038536190564) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_84 <= 0.275898462072705) THEN 28 ELSE 29 END ELSE 15 END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_61" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 7 AS parent_id, 0.004341089192884 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, -0.032098649340887 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.001566643800294 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.031027973686692 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, -0.015945628369241 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, -0.031333516003912 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 13 AS parent_id, 0.004755575430025 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.032590871925019 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, -0.024733952506687 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, -0.024237722116128 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.015306891798668 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, 0.050022650776201 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 20 AS parent_id, -0.005102644144389 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.025337318033638 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.020869519866544 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 24 AS parent_id, 0.056543134441733 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, -0.025952308068574 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 25 AS parent_id, 0.024551294006764 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 78 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 39 AS parent_id, -0.016610431790668 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 79 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 39 AS parent_id, 0.034626647418236 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 81 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 40 AS parent_id, -0.019002178816861 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 99 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 49 AS parent_id, 0.046892896626393 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 196 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 98 AS parent_id, 0.040256710212448 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 320 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 160 AS parent_id, -0.032571310087872 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 321 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 160 AS parent_id, -0.0311441077983 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 394 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 197 AS parent_id, -0.031721606348686 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 395 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 197 AS parent_id, 0.01751208556341 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 644 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 322 AS parent_id, -0.032218826407774 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 645 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 322 AS parent_id, -0.030912885698391 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 646 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 323 AS parent_id, -0.030018089575782 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1294 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 647 AS parent_id, -0.031129308162523 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1295 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 647 AS parent_id, -0.030536956799164 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_61" AS 
(SELECT "DT_node_lookup_61"."KEY" AS "KEY", "DT_node_lookup_61".node_id_2 AS node_id_2, "DT_node_data_61".node_id AS node_id, "DT_node_data_61".feature AS feature, "DT_node_data_61"."threshold" AS "threshold", "DT_node_data_61".depth AS depth, "DT_node_data_61".parent_id AS parent_id, "DT_node_data_61"."Score" AS "Score" 
FROM "DT_node_lookup_61" LEFT OUTER JOIN "DT_node_data_61" ON "DT_node_lookup_61".node_id_2 = "DT_node_data_61".node_id), 
"LGBM_Model_1_15" AS 
(SELECT "DT_Output_61"."KEY" AS "KEY", 0.0 AS "Score_0", "DT_Output_61"."Score" AS "Score_1", 0.0 AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_61"), 
"DT_node_lookup_62" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.893457035764529) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= 0.827228947189834) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.733480313458888) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -1.402903448492555) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_70 <= 0.389052634829923) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= 0.128071038349212) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_99 <= 0.663004999954013) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_63 <= -0.657883504220586) THEN 272 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_91 <= -0.46379826793068) THEN 546 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= 0.171315967337188) THEN 1094 ELSE 1095 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= 0.120941635612072) THEN 274 ELSE 275 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_39 <= -1.277688475011656) THEN 138 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= -0.697735857360325) THEN 278 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.762888747398066) THEN 558 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_58 <= -0.170340009763042) THEN 1118 ELSE 1119 END END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.140327211756681) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_48 <= -0.428608677447522) THEN 140 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= -0.439321309359097) THEN 282 ELSE 283 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_89 <= 0.260449110115409) THEN 142 ELSE 143 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.198458420544379) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 0.339309215561207) THEN 36 ELSE 37 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_76 <= -0.368672409235674) THEN 38 ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_55 <= 0.640637542569341) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_33 <= -0.424154848034445) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -0.07762149970911) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 0.18171746945123) THEN 22 ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= 0.755232002627098) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_71 <= -0.894009070401554) THEN 12 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= -0.196745581611088) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= 0.135222664670607) THEN 52 ELSE 53 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_71 <= -0.081593143949576) THEN 54 ELSE 55 END END END ELSE 7 END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_62" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 2 AS depth, 3 AS parent_id, -0.022517243716824 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 12 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.055435926109387 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.01179063385975 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, 0.025954532606632 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.051006929899407 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 11 AS parent_id, 0.010349809619575 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.003816334040759 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.043484551947505 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, 0.004784663799347 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 19 AS parent_id, -0.026843691970672 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, -0.03168150899545 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 21 AS parent_id, 0.000388650425462 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, -0.022171183320651 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 53 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 26 AS parent_id, 0.015519540871849 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.009333332053022 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 27 AS parent_id, 0.045415627487751 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 138 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 69 AS parent_id, -0.023189476752285 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 140 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 70 AS parent_id, -0.004798127999359 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 142 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 71 AS parent_id, 0.028864728326158 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 143 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 71 AS parent_id, -0.018739379387806 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 272 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 136 AS parent_id, -0.004434641456057 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 274 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 137 AS parent_id, 0.019788502847746 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 275 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 137 AS parent_id, -0.018276795920401 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 278 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 139 AS parent_id, -0.032992221536004 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 282 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 141 AS parent_id, -0.023886842624495 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 283 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 8 AS depth, 141 AS parent_id, -0.031870208206016 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 546 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 273 AS parent_id, -0.023068552677351 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 558 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 9 AS depth, 279 AS parent_id, -0.029910761869661 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1094 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 547 AS parent_id, -0.030642460338706 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1095 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 547 AS parent_id, -0.031860504299511 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1118 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 559 AS parent_id, -0.031003719287561 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1119 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 10 AS depth, 559 AS parent_id, -0.03222261292502 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_62" AS 
(SELECT "DT_node_lookup_62"."KEY" AS "KEY", "DT_node_lookup_62".node_id_2 AS node_id_2, "DT_node_data_62".node_id AS node_id, "DT_node_data_62".feature AS feature, "DT_node_data_62"."threshold" AS "threshold", "DT_node_data_62".depth AS depth, "DT_node_data_62".parent_id AS parent_id, "DT_node_data_62"."Score" AS "Score" 
FROM "DT_node_lookup_62" LEFT OUTER JOIN "DT_node_data_62" ON "DT_node_lookup_62".node_id_2 = "DT_node_data_62".node_id), 
"LGBM_Model_2_15" AS 
(SELECT "DT_Output_62"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", "DT_Output_62"."Score" AS "Score_2", 0.0 AS "Score_3" 
FROM "DT_Output_62"), 
"DT_node_lookup_63" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_86 <= -0.109690480004397) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_40 <= 0.593418384847587) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_27 <= -0.05644227342009) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_51 <= -0.854395912652681) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.272971657035475) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_52 <= -0.021727630251339) THEN 68 ELSE 69 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= -0.327898897032143) THEN 70 ELSE 71 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= 0.774431824627939) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.524498137520556) THEN 36 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= 0.424550994359482) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_81 <= -0.357560983698677) THEN 148 ELSE 149 END ELSE 75 END END ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_41 <= 0.131846105556483) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_83 <= 0.142369499456306) THEN 20 ELSE 21 END ELSE 11 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_66 <= -0.316328451954822) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_43 <= 0.819116136471358) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_64 <= -1.206021599259164) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.28641548852041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_39 <= -0.553139619281784) THEN 100 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.247857546365229) THEN 202 ELSE 203 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.581871028043936) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_88 <= 0.333188311214924) THEN 204 ELSE 205 END ELSE 103 END END END ELSE 13 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.183158906090133) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_93 <= -1.17448193964458) THEN 28 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_60 <= 0.775796509913238) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_45 <= -0.743242369385997) THEN 116 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_68 <= -0.405660450699129) THEN 234 ELSE 235 END END ELSE 59 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_38 <= -0.393063728155793) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_54 <= -0.172940614388226) THEN 60 ELSE 61 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_85 <= -0.238613216057686) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= 0.625869276065788) THEN 124 ELSE 125 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_62 <= -0.389585793389244) THEN 126 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_56 <= 0.22736898437485) THEN 254 ELSE 255 END END END END END END END AS node_id_2 
FROM tmp_20180416233645_ppmjc9_ads_ AS "ADS_sca_2_OUT"), 
"DT_node_data_63" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS FLOAT) AS feature, CAST("Values"."threshold" AS FLOAT) AS "threshold", CAST("Values".depth AS FLOAT) AS depth, CAST("Values".parent_id AS FLOAT) AS parent_id, CAST("Values"."Score" AS FLOAT) AS "Score" 
FROM (SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 5 AS parent_id, 0.006146054465596 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 3 AS depth, 6 AS parent_id, 0.002097432180167 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 8 AS parent_id, 0.055102875909847 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 9 AS parent_id, 0.030600750046353 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.031763430501048 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 10 AS parent_id, -0.017177108276354 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 12 AS parent_id, 0.003094261424934 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 4 AS depth, 14 AS parent_id, 0.015936919390817 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 18 AS parent_id, 0.021978352335247 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 59 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 29 AS parent_id, 0.000442027098603 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 60 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.048046548042288 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 61 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 5 AS depth, 30 AS parent_id, 0.005975572795639 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 68 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 34 AS parent_id, 0.050256960885998 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 69 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 34 AS parent_id, 0.01441365609409 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 70 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 35 AS parent_id, 0.029355748024776 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 71 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 35 AS parent_id, -0.010287591638576 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 75 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 37 AS parent_id, 0.000769917887043 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 100 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 50 AS parent_id, -0.030594251279912 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 103 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 51 AS parent_id, -0.030095528516498 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 116 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 58 AS parent_id, -0.017368922162863 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 124 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, 0.03342403512598 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 125 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 62 AS parent_id, -0.006383548965121 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 126 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 6 AS depth, 63 AS parent_id, 0.007496412139786 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 148 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 74 AS parent_id, -0.023571661266756 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 149 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 74 AS parent_id, -0.031560071089033 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 202 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 101 AS parent_id, -0.029569379192236 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 203 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 101 AS parent_id, -0.030131157988628 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 204 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 102 AS parent_id, -0.030579455907772 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 205 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 102 AS parent_id, -0.031366674826913 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 234 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 117 AS parent_id, -0.032462797985417 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 235 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 117 AS parent_id, -0.031125173746349 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 254 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 127 AS parent_id, -0.032273615652545 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 255 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS "threshold", 7 AS depth, 127 AS parent_id, -0.023465438191376 AS "Score" 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
"DT_Output_63" AS 
(SELECT "DT_node_lookup_63"."KEY" AS "KEY", "DT_node_lookup_63".node_id_2 AS node_id_2, "DT_node_data_63".node_id AS node_id, "DT_node_data_63".feature AS feature, "DT_node_data_63"."threshold" AS "threshold", "DT_node_data_63".depth AS depth, "DT_node_data_63".parent_id AS parent_id, "DT_node_data_63"."Score" AS "Score" 
FROM "DT_node_lookup_63" LEFT OUTER JOIN "DT_node_data_63" ON "DT_node_lookup_63".node_id_2 = "DT_node_data_63".node_id), 
"LGBM_Model_3_15" AS 
(SELECT "DT_Output_63"."KEY" AS "KEY", 0.0 AS "Score_0", 0.0 AS "Score_1", 0.0 AS "Score_2", "DT_Output_63"."Score" AS "Score_3" 
FROM "DT_Output_63")
 SELECT "LGBM_B6"."KEY", "LGBM_B6"."Score_0", "LGBM_B6"."Score_1", "LGBM_B6"."Score_2", "LGBM_B6"."Score_3" 
FROM (SELECT "LGBM_esu_6"."KEY" AS "KEY", "LGBM_esu_6"."Score_0" AS "Score_0", "LGBM_esu_6"."Score_1" AS "Score_1", "LGBM_esu_6"."Score_2" AS "Score_2", "LGBM_esu_6"."Score_3" AS "Score_3" 
FROM (SELECT "LGBM_Model_0_15"."KEY" AS "KEY", "LGBM_Model_0_15"."Score_0" AS "Score_0", "LGBM_Model_0_15"."Score_1" AS "Score_1", "LGBM_Model_0_15"."Score_2" AS "Score_2", "LGBM_Model_0_15"."Score_3" AS "Score_3" 
FROM "LGBM_Model_0_15" UNION ALL SELECT "LGBM_Model_1_15"."KEY" AS "KEY", "LGBM_Model_1_15"."Score_0" AS "Score_0", "LGBM_Model_1_15"."Score_1" AS "Score_1", "LGBM_Model_1_15"."Score_2" AS "Score_2", "LGBM_Model_1_15"."Score_3" AS "Score_3" 
FROM "LGBM_Model_1_15" UNION ALL SELECT "LGBM_Model_2_15"."KEY" AS "KEY", "LGBM_Model_2_15"."Score_0" AS "Score_0", "LGBM_Model_2_15"."Score_1" AS "Score_1", "LGBM_Model_2_15"."Score_2" AS "Score_2", "LGBM_Model_2_15"."Score_3" AS "Score_3" 
FROM "LGBM_Model_2_15" UNION ALL SELECT "LGBM_Model_3_15"."KEY" AS "KEY", "LGBM_Model_3_15"."Score_0" AS "Score_0", "LGBM_Model_3_15"."Score_1" AS "Score_1", "LGBM_Model_3_15"."Score_2" AS "Score_2", "LGBM_Model_3_15"."Score_3" AS "Score_3" 
FROM "LGBM_Model_3_15") AS "LGBM_esu_6") AS "LGBM_B6") AS "U"

-- Code For temporary table tmp_20180416233648_2m6cni_lgbm part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416233648_2m6cni_lgbm  (
	"KEY" BIGINT, 
	"Score_0" FLOAT, 
	"Score_1" FLOAT, 
	"Score_2" FLOAT, 
	"Score_3" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416233648_2m6cni_lgbm part 2/2. Populate

INSERT INTO tmp_20180416233648_2m6cni_lgbm ("KEY", "Score_0", "Score_1", "Score_2", "Score_3") SELECT "U"."KEY", "U"."Score_0", "U"."Score_1", "U"."Score_2", "U"."Score_3" 
FROM (SELECT "LGBM_Union"."KEY", "LGBM_Union"."Score_0", "LGBM_Union"."Score_1", "LGBM_Union"."Score_2", "LGBM_Union"."Score_3" 
FROM (SELECT "LGBM_EnsembleUnion"."KEY" AS "KEY", "LGBM_EnsembleUnion"."Score_0" AS "Score_0", "LGBM_EnsembleUnion"."Score_1" AS "Score_1", "LGBM_EnsembleUnion"."Score_2" AS "Score_2", "LGBM_EnsembleUnion"."Score_3" AS "Score_3" 
FROM (SELECT "LGBM_B0"."KEY" AS "KEY", "LGBM_B0"."Score_0" AS "Score_0", "LGBM_B0"."Score_1" AS "Score_1", "LGBM_B0"."Score_2" AS "Score_2", "LGBM_B0"."Score_3" AS "Score_3" 
FROM tmp_20180416233648_lb99gm_lgbm AS "LGBM_B0" UNION ALL SELECT "LGBM_B1"."KEY" AS "KEY", "LGBM_B1"."Score_0" AS "Score_0", "LGBM_B1"."Score_1" AS "Score_1", "LGBM_B1"."Score_2" AS "Score_2", "LGBM_B1"."Score_3" AS "Score_3" 
FROM tmp_20180416233648_t93had_lgbm AS "LGBM_B1" UNION ALL SELECT "LGBM_B2"."KEY" AS "KEY", "LGBM_B2"."Score_0" AS "Score_0", "LGBM_B2"."Score_1" AS "Score_1", "LGBM_B2"."Score_2" AS "Score_2", "LGBM_B2"."Score_3" AS "Score_3" 
FROM tmp_20180416233648_7ikryl_lgbm AS "LGBM_B2" UNION ALL SELECT "LGBM_B3"."KEY" AS "KEY", "LGBM_B3"."Score_0" AS "Score_0", "LGBM_B3"."Score_1" AS "Score_1", "LGBM_B3"."Score_2" AS "Score_2", "LGBM_B3"."Score_3" AS "Score_3" 
FROM tmp_20180416233648_ps4aap_lgbm AS "LGBM_B3" UNION ALL SELECT "LGBM_B4"."KEY" AS "KEY", "LGBM_B4"."Score_0" AS "Score_0", "LGBM_B4"."Score_1" AS "Score_1", "LGBM_B4"."Score_2" AS "Score_2", "LGBM_B4"."Score_3" AS "Score_3" 
FROM tmp_20180416233648_5xlkqh_lgbm AS "LGBM_B4" UNION ALL SELECT "LGBM_B5"."KEY" AS "KEY", "LGBM_B5"."Score_0" AS "Score_0", "LGBM_B5"."Score_1" AS "Score_1", "LGBM_B5"."Score_2" AS "Score_2", "LGBM_B5"."Score_3" AS "Score_3" 
FROM tmp_20180416233648_w5e6vq_lgbm AS "LGBM_B5" UNION ALL SELECT "LGBM_B6"."KEY" AS "KEY", "LGBM_B6"."Score_0" AS "Score_0", "LGBM_B6"."Score_1" AS "Score_1", "LGBM_B6"."Score_2" AS "Score_2", "LGBM_B6"."Score_3" AS "Score_3" 
FROM tmp_20180416233648_z4e9qe_lgbm AS "LGBM_B6") AS "LGBM_EnsembleUnion") AS "LGBM_Union") AS "U"

-- Code For temporary table tmp_20180416233648_185tuv_lgbm part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180416233648_185tuv_lgbm  (
	"KEY" BIGINT, 
	"Score_0" FLOAT, 
	"Score_1" FLOAT, 
	"Score_2" FLOAT, 
	"Score_3" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180416233648_185tuv_lgbm part 2/2. Populate

INSERT INTO tmp_20180416233648_185tuv_lgbm ("KEY", "Score_0", "Score_1", "Score_2", "Score_3") SELECT "U"."KEY", "U"."Score_0", "U"."Score_1", "U"."Score_2", "U"."Score_3" 
FROM (SELECT "LGBM_sum"."KEY", "LGBM_sum"."Score_0", "LGBM_sum"."Score_1", "LGBM_sum"."Score_2", "LGBM_sum"."Score_3" 
FROM (SELECT "T"."KEY" AS "KEY", CAST("T"."Score_0" AS FLOAT) AS "Score_0", CAST("T"."Score_1" AS FLOAT) AS "Score_1", CAST("T"."Score_2" AS FLOAT) AS "Score_2", CAST("T"."Score_3" AS FLOAT) AS "Score_3" 
FROM (SELECT "LGBM_Union"."KEY" AS "KEY", sum("LGBM_Union"."Score_0") AS "Score_0", sum("LGBM_Union"."Score_1") AS "Score_1", sum("LGBM_Union"."Score_2") AS "Score_2", sum("LGBM_Union"."Score_3") AS "Score_3" 
FROM tmp_20180416233648_2m6cni_lgbm AS "LGBM_Union" GROUP BY "LGBM_Union"."KEY") AS "T") AS "LGBM_sum") AS "U"

-- Model deployment code

WITH orig_cte AS 
(SELECT "LGBM_sum"."KEY" AS "KEY", "LGBM_sum"."Score_0" AS "Score_0", "LGBM_sum"."Score_1" AS "Score_1", "LGBM_sum"."Score_2" AS "Score_2", "LGBM_sum"."Score_3" AS "Score_3", CAST(NULL AS FLOAT) AS "Proba_0", CAST(NULL AS FLOAT) AS "Proba_1", CAST(NULL AS FLOAT) AS "Proba_2", CAST(NULL AS FLOAT) AS "Proba_3", CAST(NULL AS FLOAT) AS "LogProba_0", CAST(NULL AS FLOAT) AS "LogProba_1", CAST(NULL AS FLOAT) AS "LogProba_2", CAST(NULL AS FLOAT) AS "LogProba_3", CAST(NULL AS BIGINT) AS "Decision", CAST(NULL AS FLOAT) AS "DecisionProba" 
FROM tmp_20180416233648_185tuv_lgbm AS "LGBM_sum"), 
score_class_union AS 
(SELECT scu."KEY_u" AS "KEY_u", scu."class" AS "class", scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY_u", 0 AS "class", orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 1 AS "class", orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 2 AS "class", orig_cte."LogProba_2" AS "LogProba", orig_cte."Proba_2" AS "Proba", orig_cte."Score_2" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 3 AS "class", orig_cte."LogProba_3" AS "LogProba", orig_cte."Proba_3" AS "Proba", orig_cte."Score_3" AS "Score" 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Score_2" AS "Score_2", orig_cte."Score_3" AS "Score_3", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."Proba_2" AS "Proba_2", orig_cte."Proba_3" AS "Proba_3", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."LogProba_2" AS "LogProba_2", orig_cte."LogProba_3" AS "LogProba_3", orig_cte."Decision" AS "Decision", orig_cte."DecisionProba" AS "DecisionProba", max_select."KEY_m" AS "KEY_m", max_select."max_Score" AS "max_Score" 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union."KEY_u" AS "KEY_m", max(score_class_union."Score") AS "max_Score" 
FROM score_class_union GROUP BY score_class_union."KEY_u") AS max_select ON orig_cte."KEY" = max_select."KEY_m"), 
score_soft_max_deltas AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Score" AS "max_Score", exp(score_max."Score_0" - score_max."max_Score") AS "exp_delta_Score_0", exp(score_max."Score_1" - score_max."max_Score") AS "exp_delta_Score_1", exp(score_max."Score_2" - score_max."max_Score") AS "exp_delta_Score_2", exp(score_max."Score_3" - score_max."max_Score") AS "exp_delta_Score_3" 
FROM score_max), 
score_class_union_soft AS 
(SELECT soft_scu."KEY" AS "KEY", soft_scu."class" AS "class", soft_scu."exp_delta_Score" AS "exp_delta_Score" 
FROM (SELECT score_soft_max_deltas."KEY" AS "KEY", 0 AS "class", score_soft_max_deltas."exp_delta_Score_0" AS "exp_delta_Score" 
FROM score_soft_max_deltas UNION ALL SELECT score_soft_max_deltas."KEY" AS "KEY", 1 AS "class", score_soft_max_deltas."exp_delta_Score_1" AS "exp_delta_Score" 
FROM score_soft_max_deltas UNION ALL SELECT score_soft_max_deltas."KEY" AS "KEY", 2 AS "class", score_soft_max_deltas."exp_delta_Score_2" AS "exp_delta_Score" 
FROM score_soft_max_deltas UNION ALL SELECT score_soft_max_deltas."KEY" AS "KEY", 3 AS "class", score_soft_max_deltas."exp_delta_Score_3" AS "exp_delta_Score" 
FROM score_soft_max_deltas) AS soft_scu), 
score_soft_max AS 
(SELECT score_soft_max_deltas."KEY" AS "KEY", score_soft_max_deltas."Score_0" AS "Score_0", score_soft_max_deltas."Score_1" AS "Score_1", score_soft_max_deltas."Score_2" AS "Score_2", score_soft_max_deltas."Score_3" AS "Score_3", score_soft_max_deltas."Proba_0" AS "Proba_0", score_soft_max_deltas."Proba_1" AS "Proba_1", score_soft_max_deltas."Proba_2" AS "Proba_2", score_soft_max_deltas."Proba_3" AS "Proba_3", score_soft_max_deltas."LogProba_0" AS "LogProba_0", score_soft_max_deltas."LogProba_1" AS "LogProba_1", score_soft_max_deltas."LogProba_2" AS "LogProba_2", score_soft_max_deltas."LogProba_3" AS "LogProba_3", score_soft_max_deltas."Decision" AS "Decision", score_soft_max_deltas."DecisionProba" AS "DecisionProba", score_soft_max_deltas."KEY_m" AS "KEY_m", score_soft_max_deltas."max_Score" AS "max_Score", score_soft_max_deltas."exp_delta_Score_0" AS "exp_delta_Score_0", score_soft_max_deltas."exp_delta_Score_1" AS "exp_delta_Score_1", score_soft_max_deltas."exp_delta_Score_2" AS "exp_delta_Score_2", score_soft_max_deltas."exp_delta_Score_3" AS "exp_delta_Score_3", sum_exp_t."KEY_sum" AS "KEY_sum", sum_exp_t."sum_ExpDeltaScore" AS "sum_ExpDeltaScore" 
FROM score_soft_max_deltas LEFT OUTER JOIN (SELECT score_class_union_soft."KEY" AS "KEY_sum", sum(score_class_union_soft."exp_delta_Score") AS "sum_ExpDeltaScore" 
FROM score_class_union_soft GROUP BY score_class_union_soft."KEY") AS sum_exp_t ON score_soft_max_deltas."KEY" = sum_exp_t."KEY_sum"), 
union_with_max AS 
(SELECT score_class_union."KEY_u" AS "KEY_u", score_class_union."class" AS "class", score_class_union."LogProba" AS "LogProba", score_class_union."Proba" AS "Proba", score_class_union."Score" AS "Score", score_soft_max."KEY" AS "KEY", score_soft_max."Score_0" AS "Score_0", score_soft_max."Score_1" AS "Score_1", score_soft_max."Score_2" AS "Score_2", score_soft_max."Score_3" AS "Score_3", score_soft_max."Proba_0" AS "Proba_0", score_soft_max."Proba_1" AS "Proba_1", score_soft_max."Proba_2" AS "Proba_2", score_soft_max."Proba_3" AS "Proba_3", score_soft_max."LogProba_0" AS "LogProba_0", score_soft_max."LogProba_1" AS "LogProba_1", score_soft_max."LogProba_2" AS "LogProba_2", score_soft_max."LogProba_3" AS "LogProba_3", score_soft_max."Decision" AS "Decision", score_soft_max."DecisionProba" AS "DecisionProba", score_soft_max."KEY_m" AS "KEY_m", score_soft_max."max_Score" AS "max_Score", score_soft_max."exp_delta_Score_0" AS "exp_delta_Score_0", score_soft_max."exp_delta_Score_1" AS "exp_delta_Score_1", score_soft_max."exp_delta_Score_2" AS "exp_delta_Score_2", score_soft_max."exp_delta_Score_3" AS "exp_delta_Score_3", score_soft_max."KEY_sum" AS "KEY_sum", score_soft_max."sum_ExpDeltaScore" AS "sum_ExpDeltaScore" 
FROM score_class_union LEFT OUTER JOIN score_soft_max ON score_class_union."KEY_u" = score_soft_max."KEY"), 
arg_max_cte AS 
(SELECT score_soft_max."KEY" AS "KEY", score_soft_max."Score_0" AS "Score_0", score_soft_max."Score_1" AS "Score_1", score_soft_max."Score_2" AS "Score_2", score_soft_max."Score_3" AS "Score_3", score_soft_max."Proba_0" AS "Proba_0", score_soft_max."Proba_1" AS "Proba_1", score_soft_max."Proba_2" AS "Proba_2", score_soft_max."Proba_3" AS "Proba_3", score_soft_max."LogProba_0" AS "LogProba_0", score_soft_max."LogProba_1" AS "LogProba_1", score_soft_max."LogProba_2" AS "LogProba_2", score_soft_max."LogProba_3" AS "LogProba_3", score_soft_max."Decision" AS "Decision", score_soft_max."DecisionProba" AS "DecisionProba", score_soft_max."KEY_m" AS "KEY_m", score_soft_max."max_Score" AS "max_Score", score_soft_max."exp_delta_Score_0" AS "exp_delta_Score_0", score_soft_max."exp_delta_Score_1" AS "exp_delta_Score_1", score_soft_max."exp_delta_Score_2" AS "exp_delta_Score_2", score_soft_max."exp_delta_Score_3" AS "exp_delta_Score_3", score_soft_max."KEY_sum" AS "KEY_sum", score_soft_max."sum_ExpDeltaScore" AS "sum_ExpDeltaScore", "arg_max_t_Score"."KEY_Score" AS "KEY_Score", "arg_max_t_Score"."arg_max_Score" AS "arg_max_Score", soft_max_comp."KEY_softmax" AS "KEY_softmax", soft_max_comp."SoftProba_0" AS "SoftProba_0", soft_max_comp."SoftProba_1" AS "SoftProba_1", soft_max_comp."SoftProba_2" AS "SoftProba_2", soft_max_comp."SoftProba_3" AS "SoftProba_3" 
FROM score_soft_max LEFT OUTER JOIN (SELECT union_with_max."KEY" AS "KEY_Score", min(union_with_max."class") AS "arg_max_Score" 
FROM union_with_max 
WHERE union_with_max."Score" >= union_with_max."max_Score" GROUP BY union_with_max."KEY") AS "arg_max_t_Score" ON score_soft_max."KEY" = "arg_max_t_Score"."KEY_Score" LEFT OUTER JOIN (SELECT score_soft_max."KEY" AS "KEY_softmax", score_soft_max."exp_delta_Score_0" / score_soft_max."sum_ExpDeltaScore" AS "SoftProba_0", score_soft_max."exp_delta_Score_1" / score_soft_max."sum_ExpDeltaScore" AS "SoftProba_1", score_soft_max."exp_delta_Score_2" / score_soft_max."sum_ExpDeltaScore" AS "SoftProba_2", score_soft_max."exp_delta_Score_3" / score_soft_max."sum_ExpDeltaScore" AS "SoftProba_3" 
FROM score_soft_max) AS soft_max_comp ON soft_max_comp."KEY_softmax" = "arg_max_t_Score"."KEY_Score")
 SELECT arg_max_cte."KEY" AS "KEY", CAST(NULL AS FLOAT) AS "Score_0", CAST(NULL AS FLOAT) AS "Score_1", CAST(NULL AS FLOAT) AS "Score_2", CAST(NULL AS FLOAT) AS "Score_3", arg_max_cte."SoftProba_0" AS "Proba_0", arg_max_cte."SoftProba_1" AS "Proba_1", arg_max_cte."SoftProba_2" AS "Proba_2", arg_max_cte."SoftProba_3" AS "Proba_3", CASE WHEN (arg_max_cte."SoftProba_0" IS NULL OR arg_max_cte."SoftProba_0" > 0.0) THEN ln(arg_max_cte."SoftProba_0") ELSE -1.79769313486231e+308 END AS "LogProba_0", CASE WHEN (arg_max_cte."SoftProba_1" IS NULL OR arg_max_cte."SoftProba_1" > 0.0) THEN ln(arg_max_cte."SoftProba_1") ELSE -1.79769313486231e+308 END AS "LogProba_1", CASE WHEN (arg_max_cte."SoftProba_2" IS NULL OR arg_max_cte."SoftProba_2" > 0.0) THEN ln(arg_max_cte."SoftProba_2") ELSE -1.79769313486231e+308 END AS "LogProba_2", CASE WHEN (arg_max_cte."SoftProba_3" IS NULL OR arg_max_cte."SoftProba_3" > 0.0) THEN ln(arg_max_cte."SoftProba_3") ELSE -1.79769313486231e+308 END AS "LogProba_3", arg_max_cte."arg_max_Score" AS "Decision", greatest(arg_max_cte."SoftProba_0", arg_max_cte."SoftProba_1", arg_max_cte."SoftProba_2", arg_max_cte."SoftProba_3") AS "DecisionProba" 
FROM arg_max_cte