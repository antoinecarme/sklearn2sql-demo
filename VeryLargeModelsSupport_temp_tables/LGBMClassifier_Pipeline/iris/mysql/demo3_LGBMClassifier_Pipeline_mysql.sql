-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : LGBMClassifier_Pipeline
-- Dataset : iris
-- Database : mysql


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table TMP_20180417042219_QUOKF1_ADS_imp_1_OUT part 1/2. Create 


CREATE TEMPORARY TABLE `TMP_20180417042219_QUOKF1_ADS_imp_1_OUT` (
	`KEY` BIGINT NOT NULL, 
	imputer_output_2 DOUBLE, 
	imputer_output_3 DOUBLE, 
	imputer_output_4 DOUBLE, 
	imputer_output_5 DOUBLE, 
	PRIMARY KEY (`KEY`)
)

 ENGINE=MEMORY

-- Code For temporary table TMP_20180417042219_QUOKF1_ADS_imp_1_OUT part 2/2. Populate

INSERT INTO `TMP_20180417042219_QUOKF1_ADS_imp_1_OUT` (`KEY`, imputer_output_2, imputer_output_3, imputer_output_4, imputer_output_5) SELECT `U`.`KEY`, `U`.imputer_output_2, `U`.imputer_output_3, `U`.imputer_output_4, `U`.imputer_output_5 
FROM (SELECT `ADS_imp_1_OUT`.`KEY`, `ADS_imp_1_OUT`.imputer_output_2, `ADS_imp_1_OUT`.imputer_output_3, `ADS_imp_1_OUT`.imputer_output_4, `ADS_imp_1_OUT`.imputer_output_5 
FROM (SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 5.8474999999999975 ELSE `ADS`.`Feature_0` END AS imputer_output_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 3.0366666666666657 ELSE `ADS`.`Feature_1` END AS imputer_output_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 3.8450000000000006 ELSE `ADS`.`Feature_2` END AS imputer_output_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 1.245 ELSE `ADS`.`Feature_3` END AS imputer_output_5 
FROM iris AS `ADS`) AS `ADS_imp_1_OUT`) AS `U`

-- Code For temporary table TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT part 1/2. Create 


CREATE TEMPORARY TABLE `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` (
	`KEY` BIGINT NOT NULL, 
	scaler_output_2 DOUBLE, 
	scaler_output_3 DOUBLE, 
	scaler_output_4 DOUBLE, 
	scaler_output_5 DOUBLE, 
	PRIMARY KEY (`KEY`)
)

 ENGINE=MEMORY

-- Code For temporary table TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT part 2/2. Populate

INSERT INTO `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` (`KEY`, scaler_output_2, scaler_output_3, scaler_output_4, scaler_output_5) SELECT `U`.`KEY`, `U`.scaler_output_2, `U`.scaler_output_3, `U`.scaler_output_4, `U`.scaler_output_5 
FROM (SELECT `ADS_sca_2_OUT`.`KEY`, `ADS_sca_2_OUT`.scaler_output_2, `ADS_sca_2_OUT`.scaler_output_3, `ADS_sca_2_OUT`.scaler_output_4, `ADS_sca_2_OUT`.scaler_output_5 
FROM (SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (`ADS_imp_1_OUT`.imputer_output_2 - 5.8474999999999975) / 0.827039146594646 AS scaler_output_2, (`ADS_imp_1_OUT`.imputer_output_3 - 3.0366666666666657) / 0.43625935201691934 AS scaler_output_3, (`ADS_imp_1_OUT`.imputer_output_4 - 3.8450000000000006) / 1.709817241695732 AS scaler_output_4, (`ADS_imp_1_OUT`.imputer_output_5 - 1.245) / 0.7498722113355939 AS scaler_output_5 
FROM `TMP_20180417042219_QUOKF1_ADS_imp_1_OUT` AS `ADS_imp_1_OUT`) AS `ADS_sca_2_OUT`) AS `U`

-- Code For temporary table TMP_20180417042220_CJWA8N_LGBM_B0 part 1/2. Create 


CREATE TEMPORARY TABLE `TMP_20180417042220_CJWA8N_LGBM_B0` (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE
)

 ENGINE=MEMORY

-- Code For temporary table TMP_20180417042220_CJWA8N_LGBM_B0 part 2/2. Populate

INSERT INTO `TMP_20180417042220_CJWA8N_LGBM_B0` (`KEY`, `Score_0`, `Score_1`, `Score_2`) SELECT `U`.`KEY`, `U`.`Score_0`, `U`.`Score_1`, `U`.`Score_2` 
FROM (WITH `DT_node_lookup` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.07203947529441823 AS `Score` UNION ALL SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.037500000838190314 AS `Score`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.node_id_2 AS node_id_2, `DT_node_data`.node_id AS node_id, `DT_node_data`.feature AS feature, `DT_node_data`.threshold AS threshold, `DT_node_data`.depth AS depth, `DT_node_data`.parent_id AS parent_id, `DT_node_data`.`Score` AS `Score` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.node_id_2 = `DT_node_data`.node_id), 
`LGBM_Model_0_0` AS 
(SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output`), 
`DT_node_lookup_1` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.7047536839697125) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_1` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.037500000838190314 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.034539474456227924 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.0750000016763806 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.03214285786130598 AS `Score`) AS `Values`), 
`DT_Output_1` AS 
(SELECT `DT_node_lookup_1`.`KEY` AS `KEY`, `DT_node_lookup_1`.node_id_2 AS node_id_2, `DT_node_data_1`.node_id AS node_id, `DT_node_data_1`.feature AS feature, `DT_node_data_1`.threshold AS threshold, `DT_node_data_1`.depth AS depth, `DT_node_data_1`.parent_id AS parent_id, `DT_node_data_1`.`Score` AS `Score` 
FROM `DT_node_lookup_1` LEFT OUTER JOIN `DT_node_data_1` ON `DT_node_lookup_1`.node_id_2 = `DT_node_data_1`.node_id), 
`LGBM_Model_1_0` AS 
(SELECT `DT_Output_1`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_1`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_1`), 
`DT_node_lookup_2` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.2368674207533056) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN 6 ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_2` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.037500000838190314 AS `Score` UNION ALL SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.026785714884421653 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.058125001299194956 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.07500000167638063 AS `Score`) AS `Values`), 
`DT_Output_2` AS 
(SELECT `DT_node_lookup_2`.`KEY` AS `KEY`, `DT_node_lookup_2`.node_id_2 AS node_id_2, `DT_node_data_2`.node_id AS node_id, `DT_node_data_2`.feature AS feature, `DT_node_data_2`.threshold AS threshold, `DT_node_data_2`.depth AS depth, `DT_node_data_2`.parent_id AS parent_id, `DT_node_data_2`.`Score` AS `Score` 
FROM `DT_node_lookup_2` LEFT OUTER JOIN `DT_node_data_2` ON `DT_node_lookup_2`.node_id_2 = `DT_node_data_2`.node_id), 
`LGBM_Model_2_0` AS 
(SELECT `DT_Output_2`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_2`.`Score` AS `Score_2` 
FROM `DT_Output_2`), 
`DT_node_lookup_3` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.9971825984799667) THEN 14 ELSE 15 END END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_3` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.06701547810003368 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.036848632741197096 AS `Score` UNION ALL SELECT 14 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.03670404798470327 AS `Score` UNION ALL SELECT 15 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.0368327525233922 AS `Score`) AS `Values`), 
`DT_Output_3` AS 
(SELECT `DT_node_lookup_3`.`KEY` AS `KEY`, `DT_node_lookup_3`.node_id_2 AS node_id_2, `DT_node_data_3`.node_id AS node_id, `DT_node_data_3`.feature AS feature, `DT_node_data_3`.threshold AS threshold, `DT_node_data_3`.depth AS depth, `DT_node_data_3`.parent_id AS parent_id, `DT_node_data_3`.`Score` AS `Score` 
FROM `DT_node_lookup_3` LEFT OUTER JOIN `DT_node_data_3` ON `DT_node_lookup_3`.node_id_2 = `DT_node_data_3`.node_id), 
`LGBM_Model_0_1` AS 
(SELECT `DT_Output_3`.`KEY` AS `KEY`, `DT_Output_3`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_3`), 
`DT_node_lookup_4` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.1960342603469403) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.11789042925169398) THEN 12 ELSE 13 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN 14 ELSE 15 END END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_4` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.036851095375791836 AS `Score` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, 0.054726691217795456 AS `Score` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, 0.06549057703567883 AS `Score` UNION ALL SELECT 14 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.020188733800116543 AS `Score` UNION ALL SELECT 15 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.036870097433291504 AS `Score`) AS `Values`), 
`DT_Output_4` AS 
(SELECT `DT_node_lookup_4`.`KEY` AS `KEY`, `DT_node_lookup_4`.node_id_2 AS node_id_2, `DT_node_data_4`.node_id AS node_id, `DT_node_data_4`.feature AS feature, `DT_node_data_4`.threshold AS threshold, `DT_node_data_4`.depth AS depth, `DT_node_data_4`.parent_id AS parent_id, `DT_node_data_4`.`Score` AS `Score` 
FROM `DT_node_lookup_4` LEFT OUTER JOIN `DT_node_data_4` ON `DT_node_lookup_4`.node_id_2 = `DT_node_data_4`.node_id), 
`LGBM_Model_1_1` AS 
(SELECT `DT_Output_4`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_4`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_4`), 
`DT_node_lookup_5` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.2368674207533056) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.1960342603469403) THEN 8 ELSE 9 END ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN 6 ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_5` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.02622212698462553 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.05457018345983418 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.06981288130366067 AS `Score` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03679952520131128 AS `Score` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03681136968887196 AS `Score`) AS `Values`), 
`DT_Output_5` AS 
(SELECT `DT_node_lookup_5`.`KEY` AS `KEY`, `DT_node_lookup_5`.node_id_2 AS node_id_2, `DT_node_data_5`.node_id AS node_id, `DT_node_data_5`.feature AS feature, `DT_node_data_5`.threshold AS threshold, `DT_node_data_5`.depth AS depth, `DT_node_data_5`.parent_id AS parent_id, `DT_node_data_5`.`Score` AS `Score` 
FROM `DT_node_lookup_5` LEFT OUTER JOIN `DT_node_data_5` ON `DT_node_lookup_5`.node_id_2 = `DT_node_data_5`.node_id), 
`LGBM_Model_2_1` AS 
(SELECT `DT_Output_5`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_5`.`Score` AS `Score_2` 
FROM `DT_Output_5`), 
`DT_node_lookup_6` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.9971825984799667) THEN 14 ELSE 15 END END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_6` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.06281458522520018 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.036215807029371924 AS `Score` UNION ALL SELECT 14 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.03606264378577669 AS `Score` UNION ALL SELECT 15 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.03617370952044912 AS `Score`) AS `Values`), 
`DT_Output_6` AS 
(SELECT `DT_node_lookup_6`.`KEY` AS `KEY`, `DT_node_lookup_6`.node_id_2 AS node_id_2, `DT_node_data_6`.node_id AS node_id, `DT_node_data_6`.feature AS feature, `DT_node_data_6`.threshold AS threshold, `DT_node_data_6`.depth AS depth, `DT_node_data_6`.parent_id AS parent_id, `DT_node_data_6`.`Score` AS `Score` 
FROM `DT_node_lookup_6` LEFT OUTER JOIN `DT_node_data_6` ON `DT_node_lookup_6`.node_id_2 = `DT_node_data_6`.node_id), 
`LGBM_Model_0_2` AS 
(SELECT `DT_Output_6`.`KEY` AS `KEY`, `DT_Output_6`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_6`), 
`DT_node_lookup_7` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.7047536839697125) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_7` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.036280900253370184 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.03322111214566169 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.0657364736991334 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.029282983521502687 AS `Score`) AS `Values`), 
`DT_Output_7` AS 
(SELECT `DT_node_lookup_7`.`KEY` AS `KEY`, `DT_node_lookup_7`.node_id_2 AS node_id_2, `DT_node_data_7`.node_id AS node_id, `DT_node_data_7`.feature AS feature, `DT_node_data_7`.threshold AS threshold, `DT_node_data_7`.depth AS depth, `DT_node_data_7`.parent_id AS parent_id, `DT_node_data_7`.`Score` AS `Score` 
FROM `DT_node_lookup_7` LEFT OUTER JOIN `DT_node_data_7` ON `DT_node_lookup_7`.node_id_2 = `DT_node_data_7`.node_id), 
`LGBM_Model_1_2` AS 
(SELECT `DT_Output_7`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_7`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_7`), 
`DT_node_lookup_8` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.2368674207533056) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.8433699938775219) THEN 8 ELSE 9 END ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN 6 ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_8` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.025549988903108962 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.051282971320200404 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.06528030718477533 AS `Score` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03612251598152511 AS `Score` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.0362001212446578 AS `Score`) AS `Values`), 
`DT_Output_8` AS 
(SELECT `DT_node_lookup_8`.`KEY` AS `KEY`, `DT_node_lookup_8`.node_id_2 AS node_id_2, `DT_node_data_8`.node_id AS node_id, `DT_node_data_8`.feature AS feature, `DT_node_data_8`.threshold AS threshold, `DT_node_data_8`.depth AS depth, `DT_node_data_8`.parent_id AS parent_id, `DT_node_data_8`.`Score` AS `Score` 
FROM `DT_node_lookup_8` LEFT OUTER JOIN `DT_node_data_8` ON `DT_node_lookup_8`.node_id_2 = `DT_node_data_8`.node_id), 
`LGBM_Model_2_2` AS 
(SELECT `DT_Output_8`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_8`.`Score` AS `Score_2` 
FROM `DT_Output_8`), 
`DT_node_lookup_9` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.9971825984799667) THEN 14 ELSE 15 END END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_9` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.05910111908188287 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.03563786208887245 AS `Score` UNION ALL SELECT 14 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.0353889479653156 AS `Score` UNION ALL SELECT 15 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.03558226847632769 AS `Score`) AS `Values`), 
`DT_Output_9` AS 
(SELECT `DT_node_lookup_9`.`KEY` AS `KEY`, `DT_node_lookup_9`.node_id_2 AS node_id_2, `DT_node_data_9`.node_id AS node_id, `DT_node_data_9`.feature AS feature, `DT_node_data_9`.threshold AS threshold, `DT_node_data_9`.depth AS depth, `DT_node_data_9`.parent_id AS parent_id, `DT_node_data_9`.`Score` AS `Score` 
FROM `DT_node_lookup_9` LEFT OUTER JOIN `DT_node_data_9` ON `DT_node_lookup_9`.node_id_2 = `DT_node_data_9`.node_id), 
`LGBM_Model_0_3` AS 
(SELECT `DT_Output_9`.`KEY` AS `KEY`, `DT_Output_9`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_9`)
 SELECT `LGBM_B0`.`KEY`, `LGBM_B0`.`Score_0`, `LGBM_B0`.`Score_1`, `LGBM_B0`.`Score_2` 
FROM (SELECT `LGBM_esu_0`.`KEY` AS `KEY`, `LGBM_esu_0`.`Score_0` AS `Score_0`, `LGBM_esu_0`.`Score_1` AS `Score_1`, `LGBM_esu_0`.`Score_2` AS `Score_2` 
FROM (SELECT `LGBM_Model_0_0`.`KEY` AS `KEY`, `LGBM_Model_0_0`.`Score_0` AS `Score_0`, `LGBM_Model_0_0`.`Score_1` AS `Score_1`, `LGBM_Model_0_0`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_0` UNION ALL SELECT `LGBM_Model_1_0`.`KEY` AS `KEY`, `LGBM_Model_1_0`.`Score_0` AS `Score_0`, `LGBM_Model_1_0`.`Score_1` AS `Score_1`, `LGBM_Model_1_0`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_0` UNION ALL SELECT `LGBM_Model_2_0`.`KEY` AS `KEY`, `LGBM_Model_2_0`.`Score_0` AS `Score_0`, `LGBM_Model_2_0`.`Score_1` AS `Score_1`, `LGBM_Model_2_0`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_0` UNION ALL SELECT `LGBM_Model_0_1`.`KEY` AS `KEY`, `LGBM_Model_0_1`.`Score_0` AS `Score_0`, `LGBM_Model_0_1`.`Score_1` AS `Score_1`, `LGBM_Model_0_1`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_1` UNION ALL SELECT `LGBM_Model_1_1`.`KEY` AS `KEY`, `LGBM_Model_1_1`.`Score_0` AS `Score_0`, `LGBM_Model_1_1`.`Score_1` AS `Score_1`, `LGBM_Model_1_1`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_1` UNION ALL SELECT `LGBM_Model_2_1`.`KEY` AS `KEY`, `LGBM_Model_2_1`.`Score_0` AS `Score_0`, `LGBM_Model_2_1`.`Score_1` AS `Score_1`, `LGBM_Model_2_1`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_1` UNION ALL SELECT `LGBM_Model_0_2`.`KEY` AS `KEY`, `LGBM_Model_0_2`.`Score_0` AS `Score_0`, `LGBM_Model_0_2`.`Score_1` AS `Score_1`, `LGBM_Model_0_2`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_2` UNION ALL SELECT `LGBM_Model_1_2`.`KEY` AS `KEY`, `LGBM_Model_1_2`.`Score_0` AS `Score_0`, `LGBM_Model_1_2`.`Score_1` AS `Score_1`, `LGBM_Model_1_2`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_2` UNION ALL SELECT `LGBM_Model_2_2`.`KEY` AS `KEY`, `LGBM_Model_2_2`.`Score_0` AS `Score_0`, `LGBM_Model_2_2`.`Score_1` AS `Score_1`, `LGBM_Model_2_2`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_2` UNION ALL SELECT `LGBM_Model_0_3`.`KEY` AS `KEY`, `LGBM_Model_0_3`.`Score_0` AS `Score_0`, `LGBM_Model_0_3`.`Score_1` AS `Score_1`, `LGBM_Model_0_3`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_3`) AS `LGBM_esu_0`) AS `LGBM_B0`) AS `U`

-- Code For temporary table TMP_20180417042220_47ZNAG_LGBM_B1 part 1/2. Create 


CREATE TEMPORARY TABLE `TMP_20180417042220_47ZNAG_LGBM_B1` (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE
)

 ENGINE=MEMORY

-- Code For temporary table TMP_20180417042220_47ZNAG_LGBM_B1 part 2/2. Populate

INSERT INTO `TMP_20180417042220_47ZNAG_LGBM_B1` (`KEY`, `Score_0`, `Score_1`, `Score_2`) SELECT `U`.`KEY`, `U`.`Score_0`, `U`.`Score_1`, `U`.`Score_2` 
FROM (WITH `DT_node_lookup_10` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -1.0601806387571413) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.11789042925169398) THEN 12 ELSE 13 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN 14 ELSE 15 END END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_10` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.03568571838579767 AS `Score` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, 0.04925256245474603 AS `Score` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, 0.05818923981588722 AS `Score` UNION ALL SELECT 14 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.019163599112394018 AS `Score` UNION ALL SELECT 15 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.03564417082512684 AS `Score`) AS `Values`), 
`DT_Output_10` AS 
(SELECT `DT_node_lookup_10`.`KEY` AS `KEY`, `DT_node_lookup_10`.node_id_2 AS node_id_2, `DT_node_data_10`.node_id AS node_id, `DT_node_data_10`.feature AS feature, `DT_node_data_10`.threshold AS threshold, `DT_node_data_10`.depth AS depth, `DT_node_data_10`.parent_id AS parent_id, `DT_node_data_10`.`Score` AS `Score` 
FROM `DT_node_lookup_10` LEFT OUTER JOIN `DT_node_data_10` ON `DT_node_lookup_10`.node_id_2 = `DT_node_data_10`.node_id), 
`LGBM_Model_1_3` AS 
(SELECT `DT_Output_10`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_10`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_10`), 
`DT_node_lookup_11` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.2368674207533056) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.8433699938775219) THEN 8 ELSE 9 END ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN 6 ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_11` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.024999601267443654 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.04850454336800479 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.06150092082979343 AS `Score` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.035507048490941856 AS `Score` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03558639418888121 AS `Score`) AS `Values`), 
`DT_Output_11` AS 
(SELECT `DT_node_lookup_11`.`KEY` AS `KEY`, `DT_node_lookup_11`.node_id_2 AS node_id_2, `DT_node_data_11`.node_id AS node_id, `DT_node_data_11`.feature AS feature, `DT_node_data_11`.threshold AS threshold, `DT_node_data_11`.depth AS depth, `DT_node_data_11`.parent_id AS parent_id, `DT_node_data_11`.`Score` AS `Score` 
FROM `DT_node_lookup_11` LEFT OUTER JOIN `DT_node_data_11` ON `DT_node_lookup_11`.node_id_2 = `DT_node_data_11`.node_id), 
`LGBM_Model_2_3` AS 
(SELECT `DT_Output_11`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_11`.`Score` AS `Score_2` 
FROM `DT_Output_11`), 
`DT_node_lookup_12` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.9971825984799667) THEN 14 ELSE 15 END END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_12` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.055934436910049824 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.03507529231629651 AS `Score` UNION ALL SELECT 14 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.03483294958726266 AS `Score` UNION ALL SELECT 15 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.034999792257628 AS `Score`) AS `Values`), 
`DT_Output_12` AS 
(SELECT `DT_node_lookup_12`.`KEY` AS `KEY`, `DT_node_lookup_12`.node_id_2 AS node_id_2, `DT_node_data_12`.node_id AS node_id, `DT_node_data_12`.feature AS feature, `DT_node_data_12`.threshold AS threshold, `DT_node_data_12`.depth AS depth, `DT_node_data_12`.parent_id AS parent_id, `DT_node_data_12`.`Score` AS `Score` 
FROM `DT_node_lookup_12` LEFT OUTER JOIN `DT_node_data_12` ON `DT_node_lookup_12`.node_id_2 = `DT_node_data_12`.node_id), 
`LGBM_Model_0_4` AS 
(SELECT `DT_Output_12`.`KEY` AS `KEY`, `DT_Output_12`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_12`), 
`DT_node_lookup_13` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.7047536839697125) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_13` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.03518961465308414 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.03200418588727933 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.05879711625774097 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.02689209452194967 AS `Score`) AS `Values`), 
`DT_Output_13` AS 
(SELECT `DT_node_lookup_13`.`KEY` AS `KEY`, `DT_node_lookup_13`.node_id_2 AS node_id_2, `DT_node_data_13`.node_id AS node_id, `DT_node_data_13`.feature AS feature, `DT_node_data_13`.threshold AS threshold, `DT_node_data_13`.depth AS depth, `DT_node_data_13`.parent_id AS parent_id, `DT_node_data_13`.`Score` AS `Score` 
FROM `DT_node_lookup_13` LEFT OUTER JOIN `DT_node_data_13` ON `DT_node_lookup_13`.node_id_2 = `DT_node_data_13`.node_id), 
`LGBM_Model_1_4` AS 
(SELECT `DT_Output_13`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_13`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_13`), 
`DT_node_lookup_14` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.2368674207533056) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.8433699938775219) THEN 8 ELSE 9 END ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN 6 ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_14` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.02434911094173155 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.04588954856581376 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.05812476064175043 AS `Score` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03491639329356793 AS `Score` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.0350397693836978 AS `Score`) AS `Values`), 
`DT_Output_14` AS 
(SELECT `DT_node_lookup_14`.`KEY` AS `KEY`, `DT_node_lookup_14`.node_id_2 AS node_id_2, `DT_node_data_14`.node_id AS node_id, `DT_node_data_14`.feature AS feature, `DT_node_data_14`.threshold AS threshold, `DT_node_data_14`.depth AS depth, `DT_node_data_14`.parent_id AS parent_id, `DT_node_data_14`.`Score` AS `Score` 
FROM `DT_node_lookup_14` LEFT OUTER JOIN `DT_node_data_14` ON `DT_node_lookup_14`.node_id_2 = `DT_node_data_14`.node_id), 
`LGBM_Model_2_4` AS 
(SELECT `DT_Output_14`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_14`.`Score` AS `Score_2` 
FROM `DT_Output_14`), 
`DT_node_lookup_15` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.9971825984799667) THEN 14 ELSE 15 END END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_15` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.05308955525012964 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.034562076322525156 AS `Score` UNION ALL SELECT 14 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.03425658866598605 AS `Score` UNION ALL SELECT 15 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.034475408698114295 AS `Score`) AS `Values`), 
`DT_Output_15` AS 
(SELECT `DT_node_lookup_15`.`KEY` AS `KEY`, `DT_node_lookup_15`.node_id_2 AS node_id_2, `DT_node_data_15`.node_id AS node_id, `DT_node_data_15`.feature AS feature, `DT_node_data_15`.threshold AS threshold, `DT_node_data_15`.depth AS depth, `DT_node_data_15`.parent_id AS parent_id, `DT_node_data_15`.`Score` AS `Score` 
FROM `DT_node_lookup_15` LEFT OUTER JOIN `DT_node_data_15` ON `DT_node_lookup_15`.node_id_2 = `DT_node_data_15`.node_id), 
`LGBM_Model_0_5` AS 
(SELECT `DT_Output_15`.`KEY` AS `KEY`, `DT_Output_15`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_15`), 
`DT_node_lookup_16` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.7047536839697125) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_16` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.03465565742423588 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.031408276567353226 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.05583503002823799 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.025727909610459284 AS `Score`) AS `Values`), 
`DT_Output_16` AS 
(SELECT `DT_node_lookup_16`.`KEY` AS `KEY`, `DT_node_lookup_16`.node_id_2 AS node_id_2, `DT_node_data_16`.node_id AS node_id, `DT_node_data_16`.feature AS feature, `DT_node_data_16`.threshold AS threshold, `DT_node_data_16`.depth AS depth, `DT_node_data_16`.parent_id AS parent_id, `DT_node_data_16`.`Score` AS `Score` 
FROM `DT_node_lookup_16` LEFT OUTER JOIN `DT_node_data_16` ON `DT_node_lookup_16`.node_id_2 = `DT_node_data_16`.node_id), 
`LGBM_Model_1_5` AS 
(SELECT `DT_Output_16`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_16`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_16`), 
`DT_node_lookup_17` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.2368674207533056) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.8433699938775219) THEN 8 ELSE 9 END ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN 6 ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_17` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.023812322866902713 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.04365325456171853 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.055267865001404064 AS `Score` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.0343742195206776 AS `Score` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03449365159738576 AS `Score`) AS `Values`), 
`DT_Output_17` AS 
(SELECT `DT_node_lookup_17`.`KEY` AS `KEY`, `DT_node_lookup_17`.node_id_2 AS node_id_2, `DT_node_data_17`.node_id AS node_id, `DT_node_data_17`.feature AS feature, `DT_node_data_17`.threshold AS threshold, `DT_node_data_17`.depth AS depth, `DT_node_data_17`.parent_id AS parent_id, `DT_node_data_17`.`Score` AS `Score` 
FROM `DT_node_lookup_17` LEFT OUTER JOIN `DT_node_data_17` ON `DT_node_lookup_17`.node_id_2 = `DT_node_data_17`.node_id), 
`LGBM_Model_2_5` AS 
(SELECT `DT_Output_17`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_17`.`Score` AS `Score_2` 
FROM `DT_Output_17`), 
`DT_node_lookup_18` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.9971825984799667) THEN 14 ELSE 15 END END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_18` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.050575414375806295 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.03407924847800788 AS `Score` UNION ALL SELECT 14 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.03372440809135498 AS `Score` UNION ALL SELECT 15 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 7 AS parent_id, -0.033980149791297876 AS `Score`) AS `Values`), 
`DT_Output_18` AS 
(SELECT `DT_node_lookup_18`.`KEY` AS `KEY`, `DT_node_lookup_18`.node_id_2 AS node_id_2, `DT_node_data_18`.node_id AS node_id, `DT_node_data_18`.feature AS feature, `DT_node_data_18`.threshold AS threshold, `DT_node_data_18`.depth AS depth, `DT_node_data_18`.parent_id AS parent_id, `DT_node_data_18`.`Score` AS `Score` 
FROM `DT_node_lookup_18` LEFT OUTER JOIN `DT_node_data_18` ON `DT_node_lookup_18`.node_id_2 = `DT_node_data_18`.node_id), 
`LGBM_Model_0_6` AS 
(SELECT `DT_Output_18`.`KEY` AS `KEY`, `DT_Output_18`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_18`), 
`DT_node_lookup_19` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.7047536839697125) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -1.0601806387571413) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_19` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.034151628107487036 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.0340987109512769 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.049076619987162784 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.02464480416547266 AS `Score`) AS `Values`), 
`DT_Output_19` AS 
(SELECT `DT_node_lookup_19`.`KEY` AS `KEY`, `DT_node_lookup_19`.node_id_2 AS node_id_2, `DT_node_data_19`.node_id AS node_id, `DT_node_data_19`.feature AS feature, `DT_node_data_19`.threshold AS threshold, `DT_node_data_19`.depth AS depth, `DT_node_data_19`.parent_id AS parent_id, `DT_node_data_19`.`Score` AS `Score` 
FROM `DT_node_lookup_19` LEFT OUTER JOIN `DT_node_data_19` ON `DT_node_lookup_19`.node_id_2 = `DT_node_data_19`.node_id), 
`LGBM_Model_1_6` AS 
(SELECT `DT_Output_19`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_19`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_19`)
 SELECT `LGBM_B1`.`KEY`, `LGBM_B1`.`Score_0`, `LGBM_B1`.`Score_1`, `LGBM_B1`.`Score_2` 
FROM (SELECT `LGBM_esu_1`.`KEY` AS `KEY`, `LGBM_esu_1`.`Score_0` AS `Score_0`, `LGBM_esu_1`.`Score_1` AS `Score_1`, `LGBM_esu_1`.`Score_2` AS `Score_2` 
FROM (SELECT `LGBM_Model_1_3`.`KEY` AS `KEY`, `LGBM_Model_1_3`.`Score_0` AS `Score_0`, `LGBM_Model_1_3`.`Score_1` AS `Score_1`, `LGBM_Model_1_3`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_3` UNION ALL SELECT `LGBM_Model_2_3`.`KEY` AS `KEY`, `LGBM_Model_2_3`.`Score_0` AS `Score_0`, `LGBM_Model_2_3`.`Score_1` AS `Score_1`, `LGBM_Model_2_3`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_3` UNION ALL SELECT `LGBM_Model_0_4`.`KEY` AS `KEY`, `LGBM_Model_0_4`.`Score_0` AS `Score_0`, `LGBM_Model_0_4`.`Score_1` AS `Score_1`, `LGBM_Model_0_4`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_4` UNION ALL SELECT `LGBM_Model_1_4`.`KEY` AS `KEY`, `LGBM_Model_1_4`.`Score_0` AS `Score_0`, `LGBM_Model_1_4`.`Score_1` AS `Score_1`, `LGBM_Model_1_4`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_4` UNION ALL SELECT `LGBM_Model_2_4`.`KEY` AS `KEY`, `LGBM_Model_2_4`.`Score_0` AS `Score_0`, `LGBM_Model_2_4`.`Score_1` AS `Score_1`, `LGBM_Model_2_4`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_4` UNION ALL SELECT `LGBM_Model_0_5`.`KEY` AS `KEY`, `LGBM_Model_0_5`.`Score_0` AS `Score_0`, `LGBM_Model_0_5`.`Score_1` AS `Score_1`, `LGBM_Model_0_5`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_5` UNION ALL SELECT `LGBM_Model_1_5`.`KEY` AS `KEY`, `LGBM_Model_1_5`.`Score_0` AS `Score_0`, `LGBM_Model_1_5`.`Score_1` AS `Score_1`, `LGBM_Model_1_5`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_5` UNION ALL SELECT `LGBM_Model_2_5`.`KEY` AS `KEY`, `LGBM_Model_2_5`.`Score_0` AS `Score_0`, `LGBM_Model_2_5`.`Score_1` AS `Score_1`, `LGBM_Model_2_5`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_5` UNION ALL SELECT `LGBM_Model_0_6`.`KEY` AS `KEY`, `LGBM_Model_0_6`.`Score_0` AS `Score_0`, `LGBM_Model_0_6`.`Score_1` AS `Score_1`, `LGBM_Model_0_6`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_6` UNION ALL SELECT `LGBM_Model_1_6`.`KEY` AS `KEY`, `LGBM_Model_1_6`.`Score_0` AS `Score_0`, `LGBM_Model_1_6`.`Score_1` AS `Score_1`, `LGBM_Model_1_6`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_6`) AS `LGBM_esu_1`) AS `LGBM_B1`) AS `U`

-- Code For temporary table TMP_20180417042220_5OIDYM_LGBM_B2 part 1/2. Create 


CREATE TEMPORARY TABLE `TMP_20180417042220_5OIDYM_LGBM_B2` (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE
)

 ENGINE=MEMORY

-- Code For temporary table TMP_20180417042220_5OIDYM_LGBM_B2 part 2/2. Populate

INSERT INTO `TMP_20180417042220_5OIDYM_LGBM_B2` (`KEY`, `Score_0`, `Score_1`, `Score_2`) SELECT `U`.`KEY`, `U`.`Score_0`, `U`.`Score_1`, `U`.`Score_2` 
FROM (WITH `DT_node_lookup_20` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.540092023517789) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.12393609229024888) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 8 ELSE 9 END ELSE 5 END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_20` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.051095324794412644 AS `Score` UNION ALL SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.015702191957559963 AS `Score` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.033861130334129456 AS `Score` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.034240081056300053 AS `Score`) AS `Values`), 
`DT_Output_20` AS 
(SELECT `DT_node_lookup_20`.`KEY` AS `KEY`, `DT_node_lookup_20`.node_id_2 AS node_id_2, `DT_node_data_20`.node_id AS node_id, `DT_node_data_20`.feature AS feature, `DT_node_data_20`.threshold AS threshold, `DT_node_data_20`.depth AS depth, `DT_node_data_20`.parent_id AS parent_id, `DT_node_data_20`.`Score` AS `Score` 
FROM `DT_node_lookup_20` LEFT OUTER JOIN `DT_node_data_20` ON `DT_node_lookup_20`.node_id_2 = `DT_node_data_20`.node_id), 
`LGBM_Model_2_6` AS 
(SELECT `DT_Output_20`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_20`.`Score` AS `Score_2` 
FROM `DT_Output_20`), 
`DT_node_lookup_21` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_21` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.048395087047550245 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.03330773776313299 AS `Score` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.03341670408594755 AS `Score` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.03370764565371379 AS `Score`) AS `Values`), 
`DT_Output_21` AS 
(SELECT `DT_node_lookup_21`.`KEY` AS `KEY`, `DT_node_lookup_21`.node_id_2 AS node_id_2, `DT_node_data_21`.node_id AS node_id, `DT_node_data_21`.feature AS feature, `DT_node_data_21`.threshold AS threshold, `DT_node_data_21`.depth AS depth, `DT_node_data_21`.parent_id AS parent_id, `DT_node_data_21`.`Score` AS `Score` 
FROM `DT_node_lookup_21` LEFT OUTER JOIN `DT_node_data_21` ON `DT_node_lookup_21`.node_id_2 = `DT_node_data_21`.node_id), 
`LGBM_Model_0_7` AS 
(SELECT `DT_Output_21`.`KEY` AS `KEY`, `DT_Output_21`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_21`), 
`DT_node_lookup_22` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.7047536839697125) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.1960342603469403) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_22` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.033696100613114316 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.03365685440258453 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.04719909591790056 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.023685425365166476 AS `Score`) AS `Values`), 
`DT_Output_22` AS 
(SELECT `DT_node_lookup_22`.`KEY` AS `KEY`, `DT_node_lookup_22`.node_id_2 AS node_id_2, `DT_node_data_22`.node_id AS node_id, `DT_node_data_22`.feature AS feature, `DT_node_data_22`.threshold AS threshold, `DT_node_data_22`.depth AS depth, `DT_node_data_22`.parent_id AS parent_id, `DT_node_data_22`.`Score` AS `Score` 
FROM `DT_node_lookup_22` LEFT OUTER JOIN `DT_node_data_22` ON `DT_node_lookup_22`.node_id_2 = `DT_node_data_22`.node_id), 
`LGBM_Model_1_7` AS 
(SELECT `DT_Output_22`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_22`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_22`), 
`DT_node_lookup_23` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.540092023517789) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.12393609229024888) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 8 ELSE 9 END ELSE 5 END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_23` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.04889929966265169 AS `Score` UNION ALL SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.015370612266282278 AS `Score` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.033372544903161286 AS `Score` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03378177416030432 AS `Score`) AS `Values`), 
`DT_Output_23` AS 
(SELECT `DT_node_lookup_23`.`KEY` AS `KEY`, `DT_node_lookup_23`.node_id_2 AS node_id_2, `DT_node_data_23`.node_id AS node_id, `DT_node_data_23`.feature AS feature, `DT_node_data_23`.threshold AS threshold, `DT_node_data_23`.depth AS depth, `DT_node_data_23`.parent_id AS parent_id, `DT_node_data_23`.`Score` AS `Score` 
FROM `DT_node_lookup_23` LEFT OUTER JOIN `DT_node_data_23` ON `DT_node_lookup_23`.node_id_2 = `DT_node_data_23`.node_id), 
`LGBM_Model_2_7` AS 
(SELECT `DT_Output_23`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_23`.`Score` AS `Score_2` 
FROM `DT_Output_23`), 
`DT_node_lookup_24` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_24` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.04644046716785488 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.03285240381799122 AS `Score` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.03297917716650251 AS `Score` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.033301765360594635 AS `Score`) AS `Values`), 
`DT_Output_24` AS 
(SELECT `DT_node_lookup_24`.`KEY` AS `KEY`, `DT_node_lookup_24`.node_id_2 AS node_id_2, `DT_node_data_24`.node_id AS node_id, `DT_node_data_24`.feature AS feature, `DT_node_data_24`.threshold AS threshold, `DT_node_data_24`.depth AS depth, `DT_node_data_24`.parent_id AS parent_id, `DT_node_data_24`.`Score` AS `Score` 
FROM `DT_node_lookup_24` LEFT OUTER JOIN `DT_node_data_24` ON `DT_node_lookup_24`.node_id_2 = `DT_node_data_24`.node_id), 
`LGBM_Model_0_8` AS 
(SELECT `DT_Output_24`.`KEY` AS `KEY`, `DT_Output_24`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_24`), 
`DT_node_lookup_25` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.7047536839697125) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -1.0601806387571413) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_25` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.03326756702881541 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.03319571269597437 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.04533698683363785 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.022786461392573454 AS `Score`) AS `Values`), 
`DT_Output_25` AS 
(SELECT `DT_node_lookup_25`.`KEY` AS `KEY`, `DT_node_lookup_25`.node_id_2 AS node_id_2, `DT_node_data_25`.node_id AS node_id, `DT_node_data_25`.feature AS feature, `DT_node_data_25`.threshold AS threshold, `DT_node_data_25`.depth AS depth, `DT_node_data_25`.parent_id AS parent_id, `DT_node_data_25`.`Score` AS `Score` 
FROM `DT_node_lookup_25` LEFT OUTER JOIN `DT_node_data_25` ON `DT_node_lookup_25`.node_id_2 = `DT_node_data_25`.node_id), 
`LGBM_Model_1_8` AS 
(SELECT `DT_Output_25`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_25`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_25`), 
`DT_node_lookup_26` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.2368674207533056) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.8433699938775219) THEN 8 ELSE 9 END ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.9971825984799667) THEN 6 ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_26` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.02272049059071822 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.03936808638573665 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.0493361571431335 AS `Score` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03291372489830675 AS `Score` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03308336225702606 AS `Score`) AS `Values`), 
`DT_Output_26` AS 
(SELECT `DT_node_lookup_26`.`KEY` AS `KEY`, `DT_node_lookup_26`.node_id_2 AS node_id_2, `DT_node_data_26`.node_id AS node_id, `DT_node_data_26`.feature AS feature, `DT_node_data_26`.threshold AS threshold, `DT_node_data_26`.depth AS depth, `DT_node_data_26`.parent_id AS parent_id, `DT_node_data_26`.`Score` AS `Score` 
FROM `DT_node_lookup_26` LEFT OUTER JOIN `DT_node_data_26` ON `DT_node_lookup_26`.node_id_2 = `DT_node_data_26`.node_id), 
`LGBM_Model_2_8` AS 
(SELECT `DT_Output_26`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_26`.`Score` AS `Score_2` 
FROM `DT_Output_26`), 
`DT_node_lookup_27` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_27` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.0446829157058487 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.03243295312805455 AS `Score` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.03255748883414271 AS `Score` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.032911925867644486 AS `Score`) AS `Values`), 
`DT_Output_27` AS 
(SELECT `DT_node_lookup_27`.`KEY` AS `KEY`, `DT_node_lookup_27`.node_id_2 AS node_id_2, `DT_node_data_27`.node_id AS node_id, `DT_node_data_27`.feature AS feature, `DT_node_data_27`.threshold AS threshold, `DT_node_data_27`.depth AS depth, `DT_node_data_27`.parent_id AS parent_id, `DT_node_data_27`.`Score` AS `Score` 
FROM `DT_node_lookup_27` LEFT OUTER JOIN `DT_node_data_27` ON `DT_node_lookup_27`.node_id_2 = `DT_node_data_27`.node_id), 
`LGBM_Model_0_9` AS 
(SELECT `DT_Output_27`.`KEY` AS `KEY`, `DT_Output_27`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_27`), 
`DT_node_lookup_28` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.6462679010676619) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.1960342603469403) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.3538389865574075) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_28` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.029981658051287177 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.0328061423100395 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.04329095996722942 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.032289767027802854 AS `Score`) AS `Values`), 
`DT_Output_28` AS 
(SELECT `DT_node_lookup_28`.`KEY` AS `KEY`, `DT_node_lookup_28`.node_id_2 AS node_id_2, `DT_node_data_28`.node_id AS node_id, `DT_node_data_28`.feature AS feature, `DT_node_data_28`.threshold AS threshold, `DT_node_data_28`.depth AS depth, `DT_node_data_28`.parent_id AS parent_id, `DT_node_data_28`.`Score` AS `Score` 
FROM `DT_node_lookup_28` LEFT OUTER JOIN `DT_node_data_28` ON `DT_node_lookup_28`.node_id_2 = `DT_node_data_28`.node_id), 
`LGBM_Model_1_9` AS 
(SELECT `DT_Output_28`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_28`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_28`), 
`DT_node_lookup_29` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.540092023517789) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.12393609229024888) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 8 ELSE 9 END ELSE 5 END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_29` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.04540530948762556 AS `Score` UNION ALL SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.015072265692651632 AS `Score` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03248482588037635 AS `Score` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03295882311835557 AS `Score`) AS `Values`), 
`DT_Output_29` AS 
(SELECT `DT_node_lookup_29`.`KEY` AS `KEY`, `DT_node_lookup_29`.node_id_2 AS node_id_2, `DT_node_data_29`.node_id AS node_id, `DT_node_data_29`.feature AS feature, `DT_node_data_29`.threshold AS threshold, `DT_node_data_29`.depth AS depth, `DT_node_data_29`.parent_id AS parent_id, `DT_node_data_29`.`Score` AS `Score` 
FROM `DT_node_lookup_29` LEFT OUTER JOIN `DT_node_data_29` ON `DT_node_lookup_29`.node_id_2 = `DT_node_data_29`.node_id), 
`LGBM_Model_2_9` AS 
(SELECT `DT_Output_29`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_29`.`Score` AS `Score_2` 
FROM `DT_Output_29`)
 SELECT `LGBM_B2`.`KEY`, `LGBM_B2`.`Score_0`, `LGBM_B2`.`Score_1`, `LGBM_B2`.`Score_2` 
FROM (SELECT `LGBM_esu_2`.`KEY` AS `KEY`, `LGBM_esu_2`.`Score_0` AS `Score_0`, `LGBM_esu_2`.`Score_1` AS `Score_1`, `LGBM_esu_2`.`Score_2` AS `Score_2` 
FROM (SELECT `LGBM_Model_2_6`.`KEY` AS `KEY`, `LGBM_Model_2_6`.`Score_0` AS `Score_0`, `LGBM_Model_2_6`.`Score_1` AS `Score_1`, `LGBM_Model_2_6`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_6` UNION ALL SELECT `LGBM_Model_0_7`.`KEY` AS `KEY`, `LGBM_Model_0_7`.`Score_0` AS `Score_0`, `LGBM_Model_0_7`.`Score_1` AS `Score_1`, `LGBM_Model_0_7`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_7` UNION ALL SELECT `LGBM_Model_1_7`.`KEY` AS `KEY`, `LGBM_Model_1_7`.`Score_0` AS `Score_0`, `LGBM_Model_1_7`.`Score_1` AS `Score_1`, `LGBM_Model_1_7`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_7` UNION ALL SELECT `LGBM_Model_2_7`.`KEY` AS `KEY`, `LGBM_Model_2_7`.`Score_0` AS `Score_0`, `LGBM_Model_2_7`.`Score_1` AS `Score_1`, `LGBM_Model_2_7`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_7` UNION ALL SELECT `LGBM_Model_0_8`.`KEY` AS `KEY`, `LGBM_Model_0_8`.`Score_0` AS `Score_0`, `LGBM_Model_0_8`.`Score_1` AS `Score_1`, `LGBM_Model_0_8`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_8` UNION ALL SELECT `LGBM_Model_1_8`.`KEY` AS `KEY`, `LGBM_Model_1_8`.`Score_0` AS `Score_0`, `LGBM_Model_1_8`.`Score_1` AS `Score_1`, `LGBM_Model_1_8`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_8` UNION ALL SELECT `LGBM_Model_2_8`.`KEY` AS `KEY`, `LGBM_Model_2_8`.`Score_0` AS `Score_0`, `LGBM_Model_2_8`.`Score_1` AS `Score_1`, `LGBM_Model_2_8`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_8` UNION ALL SELECT `LGBM_Model_0_9`.`KEY` AS `KEY`, `LGBM_Model_0_9`.`Score_0` AS `Score_0`, `LGBM_Model_0_9`.`Score_1` AS `Score_1`, `LGBM_Model_0_9`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_9` UNION ALL SELECT `LGBM_Model_1_9`.`KEY` AS `KEY`, `LGBM_Model_1_9`.`Score_0` AS `Score_0`, `LGBM_Model_1_9`.`Score_1` AS `Score_1`, `LGBM_Model_1_9`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_9` UNION ALL SELECT `LGBM_Model_2_9`.`KEY` AS `KEY`, `LGBM_Model_2_9`.`Score_0` AS `Score_0`, `LGBM_Model_2_9`.`Score_1` AS `Score_1`, `LGBM_Model_2_9`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_9`) AS `LGBM_esu_2`) AS `LGBM_B2`) AS `U`

-- Code For temporary table TMP_20180417042220_91PZGY_LGBM_B3 part 1/2. Create 


CREATE TEMPORARY TABLE `TMP_20180417042220_91PZGY_LGBM_B3` (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE
)

 ENGINE=MEMORY

-- Code For temporary table TMP_20180417042220_91PZGY_LGBM_B3 part 2/2. Populate

INSERT INTO `TMP_20180417042220_91PZGY_LGBM_B3` (`KEY`, `Score_0`, `Score_1`, `Score_2`) SELECT `U`.`KEY`, `U`.`Score_0`, `U`.`Score_1`, `U`.`Score_2` 
FROM (WITH `DT_node_lookup_30` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.540092023517789) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.14002385794905625) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_30` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.04309157219184433 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.032102468770169715 AS `Score` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.032172024702284 AS `Score` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.03269095688766959 AS `Score`) AS `Values`), 
`DT_Output_30` AS 
(SELECT `DT_node_lookup_30`.`KEY` AS `KEY`, `DT_node_lookup_30`.node_id_2 AS node_id_2, `DT_node_data_30`.node_id AS node_id, `DT_node_data_30`.feature AS feature, `DT_node_data_30`.threshold AS threshold, `DT_node_data_30`.depth AS depth, `DT_node_data_30`.parent_id AS parent_id, `DT_node_data_30`.`Score` AS `Score` 
FROM `DT_node_lookup_30` LEFT OUTER JOIN `DT_node_data_30` ON `DT_node_lookup_30`.node_id_2 = `DT_node_data_30`.node_id), 
`LGBM_Model_0_10` AS 
(SELECT `DT_Output_30`.`KEY` AS `KEY`, `DT_Output_30`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_30`), 
`DT_node_lookup_31` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.7047536839697125) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -1.0601806387571413) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_31` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.032477012807808875 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.03239250501627685 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.04232613398334018 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.02112344906031286 AS `Score`) AS `Values`), 
`DT_Output_31` AS 
(SELECT `DT_node_lookup_31`.`KEY` AS `KEY`, `DT_node_lookup_31`.node_id_2 AS node_id_2, `DT_node_data_31`.node_id AS node_id, `DT_node_data_31`.feature AS feature, `DT_node_data_31`.threshold AS threshold, `DT_node_data_31`.depth AS depth, `DT_node_data_31`.parent_id AS parent_id, `DT_node_data_31`.`Score` AS `Score` 
FROM `DT_node_lookup_31` LEFT OUTER JOIN `DT_node_data_31` ON `DT_node_lookup_31`.node_id_2 = `DT_node_data_31`.node_id), 
`LGBM_Model_1_10` AS 
(SELECT `DT_Output_31`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_31`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_31`), 
`DT_node_lookup_32` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.2368674207533056) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.8433699938775219) THEN 8 ELSE 9 END ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN 6 ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_32` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.02192068352715347 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.03578464276635291 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.04536024877211253 AS `Score` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.032078917872632645 AS `Score` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03227169375635002 AS `Score`) AS `Values`), 
`DT_Output_32` AS 
(SELECT `DT_node_lookup_32`.`KEY` AS `KEY`, `DT_node_lookup_32`.node_id_2 AS node_id_2, `DT_node_data_32`.node_id AS node_id, `DT_node_data_32`.feature AS feature, `DT_node_data_32`.threshold AS threshold, `DT_node_data_32`.depth AS depth, `DT_node_data_32`.parent_id AS parent_id, `DT_node_data_32`.`Score` AS `Score` 
FROM `DT_node_lookup_32` LEFT OUTER JOIN `DT_node_data_32` ON `DT_node_lookup_32`.node_id_2 = `DT_node_data_32`.node_id), 
`LGBM_Model_2_10` AS 
(SELECT `DT_Output_32`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_32`.`Score` AS `Score_2` 
FROM `DT_Output_32`), 
`DT_node_lookup_33` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.540092023517789) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.14002385794905625) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_33` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.041648679740140394 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.03173763194462144 AS `Score` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.0317964121567206 AS `Score` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.03234593133672061 AS `Score`) AS `Values`), 
`DT_Output_33` AS 
(SELECT `DT_node_lookup_33`.`KEY` AS `KEY`, `DT_node_lookup_33`.node_id_2 AS node_id_2, `DT_node_data_33`.node_id AS node_id, `DT_node_data_33`.feature AS feature, `DT_node_data_33`.threshold AS threshold, `DT_node_data_33`.depth AS depth, `DT_node_data_33`.parent_id AS parent_id, `DT_node_data_33`.`Score` AS `Score` 
FROM `DT_node_lookup_33` LEFT OUTER JOIN `DT_node_data_33` ON `DT_node_lookup_33`.node_id_2 = `DT_node_data_33`.node_id), 
`LGBM_Model_0_11` AS 
(SELECT `DT_Output_33`.`KEY` AS `KEY`, `DT_Output_33`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_33`), 
`DT_node_lookup_34` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.540092023517789) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.1960342603469403) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.12393609229024888) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_34` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.0276735527461119 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.03204980581769173 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.04066472711086899 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.035987534977893386 AS `Score`) AS `Values`), 
`DT_Output_34` AS 
(SELECT `DT_node_lookup_34`.`KEY` AS `KEY`, `DT_node_lookup_34`.node_id_2 AS node_id_2, `DT_node_data_34`.node_id AS node_id, `DT_node_data_34`.feature AS feature, `DT_node_data_34`.threshold AS threshold, `DT_node_data_34`.depth AS depth, `DT_node_data_34`.parent_id AS parent_id, `DT_node_data_34`.`Score` AS `Score` 
FROM `DT_node_lookup_34` LEFT OUTER JOIN `DT_node_data_34` ON `DT_node_lookup_34`.node_id_2 = `DT_node_data_34`.node_id), 
`LGBM_Model_1_11` AS 
(SELECT `DT_Output_34`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_34`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_34`), 
`DT_node_lookup_35` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.540092023517789) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.12393609229024888) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 8 ELSE 9 END ELSE 5 END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_35` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.042530182093048235 AS `Score` UNION ALL SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.014764050438561922 AS `Score` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03170237252831367 AS `Score` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03221293335228762 AS `Score`) AS `Values`), 
`DT_Output_35` AS 
(SELECT `DT_node_lookup_35`.`KEY` AS `KEY`, `DT_node_lookup_35`.node_id_2 AS node_id_2, `DT_node_data_35`.node_id AS node_id, `DT_node_data_35`.feature AS feature, `DT_node_data_35`.threshold AS threshold, `DT_node_data_35`.depth AS depth, `DT_node_data_35`.parent_id AS parent_id, `DT_node_data_35`.`Score` AS `Score` 
FROM `DT_node_lookup_35` LEFT OUTER JOIN `DT_node_data_35` ON `DT_node_lookup_35`.node_id_2 = `DT_node_data_35`.node_id), 
`LGBM_Model_2_11` AS 
(SELECT `DT_Output_35`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_35`.`Score` AS `Score_2` 
FROM `DT_Output_35`), 
`DT_node_lookup_36` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_36` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.0403312051227808 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.031282810309940866 AS `Score` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.031462382507507276 AS `Score` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.03187195381175211 AS `Score`) AS `Values`), 
`DT_Output_36` AS 
(SELECT `DT_node_lookup_36`.`KEY` AS `KEY`, `DT_node_lookup_36`.node_id_2 AS node_id_2, `DT_node_data_36`.node_id AS node_id, `DT_node_data_36`.feature AS feature, `DT_node_data_36`.threshold AS threshold, `DT_node_data_36`.depth AS depth, `DT_node_data_36`.parent_id AS parent_id, `DT_node_data_36`.`Score` AS `Score` 
FROM `DT_node_lookup_36` LEFT OUTER JOIN `DT_node_data_36` ON `DT_node_lookup_36`.node_id_2 = `DT_node_data_36`.node_id), 
`LGBM_Model_0_12` AS 
(SELECT `DT_Output_36`.`KEY` AS `KEY`, `DT_Output_36`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_36`), 
`DT_node_lookup_37` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.7047536839697125) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.1960342603469403) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_37` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.031844856858439616 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.031678476487483176 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.03982425788862459 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.019952331232842777 AS `Score`) AS `Values`), 
`DT_Output_37` AS 
(SELECT `DT_node_lookup_37`.`KEY` AS `KEY`, `DT_node_lookup_37`.node_id_2 AS node_id_2, `DT_node_data_37`.node_id AS node_id, `DT_node_data_37`.feature AS feature, `DT_node_data_37`.threshold AS threshold, `DT_node_data_37`.depth AS depth, `DT_node_data_37`.parent_id AS parent_id, `DT_node_data_37`.`Score` AS `Score` 
FROM `DT_node_lookup_37` LEFT OUTER JOIN `DT_node_data_37` ON `DT_node_lookup_37`.node_id_2 = `DT_node_data_37`.node_id), 
`LGBM_Model_1_12` AS 
(SELECT `DT_Output_37`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_37`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_37`), 
`DT_node_lookup_38` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.52929633526356) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -0.657101481816596) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.6620001027210645) THEN 10 ELSE 11 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.8802110326758651) THEN 6 ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_38` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.024613794616943786 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.02896917696717415 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.04319829737107023 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, -0.03135992152848637 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, -0.03263372957519394 AS `Score`) AS `Values`), 
`DT_Output_38` AS 
(SELECT `DT_node_lookup_38`.`KEY` AS `KEY`, `DT_node_lookup_38`.node_id_2 AS node_id_2, `DT_node_data_38`.node_id AS node_id, `DT_node_data_38`.feature AS feature, `DT_node_data_38`.threshold AS threshold, `DT_node_data_38`.depth AS depth, `DT_node_data_38`.parent_id AS parent_id, `DT_node_data_38`.`Score` AS `Score` 
FROM `DT_node_lookup_38` LEFT OUTER JOIN `DT_node_data_38` ON `DT_node_lookup_38`.node_id_2 = `DT_node_data_38`.node_id), 
`LGBM_Model_2_12` AS 
(SELECT `DT_Output_38`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_38`.`Score` AS `Score_2` 
FROM `DT_Output_38`), 
`DT_node_lookup_39` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_39` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.039129023898422474 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.030955208621465554 AS `Score` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.031124065909043836 AS `Score` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.031567846327522575 AS `Score`) AS `Values`), 
`DT_Output_39` AS 
(SELECT `DT_node_lookup_39`.`KEY` AS `KEY`, `DT_node_lookup_39`.node_id_2 AS node_id_2, `DT_node_data_39`.node_id AS node_id, `DT_node_data_39`.feature AS feature, `DT_node_data_39`.threshold AS threshold, `DT_node_data_39`.depth AS depth, `DT_node_data_39`.parent_id AS parent_id, `DT_node_data_39`.`Score` AS `Score` 
FROM `DT_node_lookup_39` LEFT OUTER JOIN `DT_node_data_39` ON `DT_node_lookup_39`.node_id_2 = `DT_node_data_39`.node_id), 
`LGBM_Model_0_13` AS 
(SELECT `DT_Output_39`.`KEY` AS `KEY`, `DT_Output_39`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_39`)
 SELECT `LGBM_B3`.`KEY`, `LGBM_B3`.`Score_0`, `LGBM_B3`.`Score_1`, `LGBM_B3`.`Score_2` 
FROM (SELECT `LGBM_esu_3`.`KEY` AS `KEY`, `LGBM_esu_3`.`Score_0` AS `Score_0`, `LGBM_esu_3`.`Score_1` AS `Score_1`, `LGBM_esu_3`.`Score_2` AS `Score_2` 
FROM (SELECT `LGBM_Model_0_10`.`KEY` AS `KEY`, `LGBM_Model_0_10`.`Score_0` AS `Score_0`, `LGBM_Model_0_10`.`Score_1` AS `Score_1`, `LGBM_Model_0_10`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_10` UNION ALL SELECT `LGBM_Model_1_10`.`KEY` AS `KEY`, `LGBM_Model_1_10`.`Score_0` AS `Score_0`, `LGBM_Model_1_10`.`Score_1` AS `Score_1`, `LGBM_Model_1_10`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_10` UNION ALL SELECT `LGBM_Model_2_10`.`KEY` AS `KEY`, `LGBM_Model_2_10`.`Score_0` AS `Score_0`, `LGBM_Model_2_10`.`Score_1` AS `Score_1`, `LGBM_Model_2_10`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_10` UNION ALL SELECT `LGBM_Model_0_11`.`KEY` AS `KEY`, `LGBM_Model_0_11`.`Score_0` AS `Score_0`, `LGBM_Model_0_11`.`Score_1` AS `Score_1`, `LGBM_Model_0_11`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_11` UNION ALL SELECT `LGBM_Model_1_11`.`KEY` AS `KEY`, `LGBM_Model_1_11`.`Score_0` AS `Score_0`, `LGBM_Model_1_11`.`Score_1` AS `Score_1`, `LGBM_Model_1_11`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_11` UNION ALL SELECT `LGBM_Model_2_11`.`KEY` AS `KEY`, `LGBM_Model_2_11`.`Score_0` AS `Score_0`, `LGBM_Model_2_11`.`Score_1` AS `Score_1`, `LGBM_Model_2_11`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_11` UNION ALL SELECT `LGBM_Model_0_12`.`KEY` AS `KEY`, `LGBM_Model_0_12`.`Score_0` AS `Score_0`, `LGBM_Model_0_12`.`Score_1` AS `Score_1`, `LGBM_Model_0_12`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_12` UNION ALL SELECT `LGBM_Model_1_12`.`KEY` AS `KEY`, `LGBM_Model_1_12`.`Score_0` AS `Score_0`, `LGBM_Model_1_12`.`Score_1` AS `Score_1`, `LGBM_Model_1_12`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_12` UNION ALL SELECT `LGBM_Model_2_12`.`KEY` AS `KEY`, `LGBM_Model_2_12`.`Score_0` AS `Score_0`, `LGBM_Model_2_12`.`Score_1` AS `Score_1`, `LGBM_Model_2_12`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_12` UNION ALL SELECT `LGBM_Model_0_13`.`KEY` AS `KEY`, `LGBM_Model_0_13`.`Score_0` AS `Score_0`, `LGBM_Model_0_13`.`Score_1` AS `Score_1`, `LGBM_Model_0_13`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_13`) AS `LGBM_esu_3`) AS `LGBM_B3`) AS `U`

-- Code For temporary table TMP_20180417042220_P0SIQB_LGBM_B4 part 1/2. Create 


CREATE TEMPORARY TABLE `TMP_20180417042220_P0SIQB_LGBM_B4` (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE
)

 ENGINE=MEMORY

-- Code For temporary table TMP_20180417042220_P0SIQB_LGBM_B4 part 2/2. Populate

INSERT INTO `TMP_20180417042220_P0SIQB_LGBM_B4` (`KEY`, `Score_0`, `Score_1`, `Score_2`) SELECT `U`.`KEY`, `U`.`Score_0`, `U`.`Score_1`, `U`.`Score_2` 
FROM (WITH `DT_node_lookup_40` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.540092023517789) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -1.0601806387571413) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.12393609229024888) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_40` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.026844521797435295 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.031377254379556574 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.03837399317480616 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.03369128319463142 AS `Score`) AS `Values`), 
`DT_Output_40` AS 
(SELECT `DT_node_lookup_40`.`KEY` AS `KEY`, `DT_node_lookup_40`.node_id_2 AS node_id_2, `DT_node_data_40`.node_id AS node_id, `DT_node_data_40`.feature AS feature, `DT_node_data_40`.threshold AS threshold, `DT_node_data_40`.depth AS depth, `DT_node_data_40`.parent_id AS parent_id, `DT_node_data_40`.`Score` AS `Score` 
FROM `DT_node_lookup_40` LEFT OUTER JOIN `DT_node_data_40` ON `DT_node_lookup_40`.node_id_2 = `DT_node_data_40`.node_id), 
`LGBM_Model_1_13` AS 
(SELECT `DT_Output_40`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_40`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_40`), 
`DT_node_lookup_41` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.540092023517789) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.12393609229024888) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 8 ELSE 9 END ELSE 5 END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_41` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.03992866306278911 AS `Score` UNION ALL SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.014165172018767998 AS `Score` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.031011173303837694 AS `Score` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.03154298734664896 AS `Score`) AS `Values`), 
`DT_Output_41` AS 
(SELECT `DT_node_lookup_41`.`KEY` AS `KEY`, `DT_node_lookup_41`.node_id_2 AS node_id_2, `DT_node_data_41`.node_id AS node_id, `DT_node_data_41`.feature AS feature, `DT_node_data_41`.threshold AS threshold, `DT_node_data_41`.depth AS depth, `DT_node_data_41`.parent_id AS parent_id, `DT_node_data_41`.`Score` AS `Score` 
FROM `DT_node_lookup_41` LEFT OUTER JOIN `DT_node_data_41` ON `DT_node_lookup_41`.node_id_2 = `DT_node_data_41`.node_id), 
`LGBM_Model_2_13` AS 
(SELECT `DT_Output_41`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_41`.`Score` AS `Score_2` 
FROM `DT_Output_41`), 
`DT_node_lookup_42` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_42` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.03802152390407221 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.03063853183211392 AS `Score` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.03081863775642479 AS `Score` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.03126836088891469 AS `Score`) AS `Values`), 
`DT_Output_42` AS 
(SELECT `DT_node_lookup_42`.`KEY` AS `KEY`, `DT_node_lookup_42`.node_id_2 AS node_id_2, `DT_node_data_42`.node_id AS node_id, `DT_node_data_42`.feature AS feature, `DT_node_data_42`.threshold AS threshold, `DT_node_data_42`.depth AS depth, `DT_node_data_42`.parent_id AS parent_id, `DT_node_data_42`.`Score` AS `Score` 
FROM `DT_node_lookup_42` LEFT OUTER JOIN `DT_node_data_42` ON `DT_node_lookup_42`.node_id_2 = `DT_node_data_42`.node_id), 
`LGBM_Model_0_14` AS 
(SELECT `DT_Output_42`.`KEY` AS `KEY`, `DT_Output_42`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_42`), 
`DT_node_lookup_43` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.7047536839697125) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -1.0601806387571413) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_43` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.03128737834716705 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.031044526065586376 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.03775527093233315 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.018882453691262378 AS `Score`) AS `Values`), 
`DT_Output_43` AS 
(SELECT `DT_node_lookup_43`.`KEY` AS `KEY`, `DT_node_lookup_43`.node_id_2 AS node_id_2, `DT_node_data_43`.node_id AS node_id, `DT_node_data_43`.feature AS feature, `DT_node_data_43`.threshold AS threshold, `DT_node_data_43`.depth AS depth, `DT_node_data_43`.parent_id AS parent_id, `DT_node_data_43`.`Score` AS `Score` 
FROM `DT_node_lookup_43` LEFT OUTER JOIN `DT_node_data_43` ON `DT_node_lookup_43`.node_id_2 = `DT_node_data_43`.node_id), 
`LGBM_Model_1_14` AS 
(SELECT `DT_Output_43`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_43`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_43`), 
`DT_node_lookup_44` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.587782118165611) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.2368674207533056) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.8433699938775219) THEN 8 ELSE 9 END ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.9971825984799667) THEN 6 ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_44` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.02055684580595688 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.03193610952686271 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.04106016032050676 AS `Score` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.030696312336704043 AS `Score` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 4 AS parent_id, -0.030916683069578434 AS `Score`) AS `Values`), 
`DT_Output_44` AS 
(SELECT `DT_node_lookup_44`.`KEY` AS `KEY`, `DT_node_lookup_44`.node_id_2 AS node_id_2, `DT_node_data_44`.node_id AS node_id, `DT_node_data_44`.feature AS feature, `DT_node_data_44`.threshold AS threshold, `DT_node_data_44`.depth AS depth, `DT_node_data_44`.parent_id AS parent_id, `DT_node_data_44`.`Score` AS `Score` 
FROM `DT_node_lookup_44` LEFT OUTER JOIN `DT_node_data_44` ON `DT_node_lookup_44`.node_id_2 = `DT_node_data_44`.node_id), 
`LGBM_Model_2_14` AS 
(SELECT `DT_Output_44`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_44`.`Score` AS `Score_2` 
FROM `DT_Output_44`), 
`DT_node_lookup_45` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4064761911692538) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.9401601890865214) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_45` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, 0.03700278940942407 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, -0.030346639340281974 AS `Score` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.030519890506395447 AS `Score` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 6 AS parent_id, -0.030993262083417406 AS `Score`) AS `Values`), 
`DT_Output_45` AS 
(SELECT `DT_node_lookup_45`.`KEY` AS `KEY`, `DT_node_lookup_45`.node_id_2 AS node_id_2, `DT_node_data_45`.node_id AS node_id, `DT_node_data_45`.feature AS feature, `DT_node_data_45`.threshold AS threshold, `DT_node_data_45`.depth AS depth, `DT_node_data_45`.parent_id AS parent_id, `DT_node_data_45`.`Score` AS `Score` 
FROM `DT_node_lookup_45` LEFT OUTER JOIN `DT_node_data_45` ON `DT_node_lookup_45`.node_id_2 = `DT_node_data_45`.node_id), 
`LGBM_Model_0_15` AS 
(SELECT `DT_Output_45`.`KEY` AS `KEY`, `DT_Output_45`.`Score` AS `Score_0`, 0.0 AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_45`), 
`DT_node_lookup_46` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.7047536839697125) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.1960342603469403) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.2733799131386338) THEN 10 ELSE 11 END END ELSE 3 END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_46` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS depth, 1 AS parent_id, -0.030969960624712814 AS `Score` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.03077799257956071 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.036893363308531726 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, 0.01819939419695562 AS `Score`) AS `Values`), 
`DT_Output_46` AS 
(SELECT `DT_node_lookup_46`.`KEY` AS `KEY`, `DT_node_lookup_46`.node_id_2 AS node_id_2, `DT_node_data_46`.node_id AS node_id, `DT_node_data_46`.feature AS feature, `DT_node_data_46`.threshold AS threshold, `DT_node_data_46`.depth AS depth, `DT_node_data_46`.parent_id AS parent_id, `DT_node_data_46`.`Score` AS `Score` 
FROM `DT_node_lookup_46` LEFT OUTER JOIN `DT_node_data_46` ON `DT_node_lookup_46`.node_id_2 = `DT_node_data_46`.node_id), 
`LGBM_Model_1_15` AS 
(SELECT `DT_Output_46`.`KEY` AS `KEY`, 0.0 AS `Score_0`, `DT_Output_46`.`Score` AS `Score_1`, 0.0 AS `Score_2` 
FROM `DT_Output_46`), 
`DT_node_lookup_47` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.52929633526356) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -0.657101481816596) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.6620001027210645) THEN 10 ELSE 11 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.8802110326758651) THEN 6 ELSE 7 END END AS node_id_2 
FROM `TMP_20180417042219_WCIZ0O_ADS_sca_2_OUT` AS `ADS_sca_2_OUT`), 
`DT_node_data_47` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Score` AS `Score` 
FROM (SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 2 AS parent_id, -0.02318550502590008 AS `Score` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.026223214015916235 AS `Score` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS depth, 3 AS parent_id, 0.03986657062270415 AS `Score` UNION ALL SELECT 10 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, -0.0304111345638241 AS `Score` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS depth, 5 AS parent_id, -0.03175758983255726 AS `Score`) AS `Values`), 
`DT_Output_47` AS 
(SELECT `DT_node_lookup_47`.`KEY` AS `KEY`, `DT_node_lookup_47`.node_id_2 AS node_id_2, `DT_node_data_47`.node_id AS node_id, `DT_node_data_47`.feature AS feature, `DT_node_data_47`.threshold AS threshold, `DT_node_data_47`.depth AS depth, `DT_node_data_47`.parent_id AS parent_id, `DT_node_data_47`.`Score` AS `Score` 
FROM `DT_node_lookup_47` LEFT OUTER JOIN `DT_node_data_47` ON `DT_node_lookup_47`.node_id_2 = `DT_node_data_47`.node_id), 
`LGBM_Model_2_15` AS 
(SELECT `DT_Output_47`.`KEY` AS `KEY`, 0.0 AS `Score_0`, 0.0 AS `Score_1`, `DT_Output_47`.`Score` AS `Score_2` 
FROM `DT_Output_47`)
 SELECT `LGBM_B4`.`KEY`, `LGBM_B4`.`Score_0`, `LGBM_B4`.`Score_1`, `LGBM_B4`.`Score_2` 
FROM (SELECT `LGBM_esu_4`.`KEY` AS `KEY`, `LGBM_esu_4`.`Score_0` AS `Score_0`, `LGBM_esu_4`.`Score_1` AS `Score_1`, `LGBM_esu_4`.`Score_2` AS `Score_2` 
FROM (SELECT `LGBM_Model_1_13`.`KEY` AS `KEY`, `LGBM_Model_1_13`.`Score_0` AS `Score_0`, `LGBM_Model_1_13`.`Score_1` AS `Score_1`, `LGBM_Model_1_13`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_13` UNION ALL SELECT `LGBM_Model_2_13`.`KEY` AS `KEY`, `LGBM_Model_2_13`.`Score_0` AS `Score_0`, `LGBM_Model_2_13`.`Score_1` AS `Score_1`, `LGBM_Model_2_13`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_13` UNION ALL SELECT `LGBM_Model_0_14`.`KEY` AS `KEY`, `LGBM_Model_0_14`.`Score_0` AS `Score_0`, `LGBM_Model_0_14`.`Score_1` AS `Score_1`, `LGBM_Model_0_14`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_14` UNION ALL SELECT `LGBM_Model_1_14`.`KEY` AS `KEY`, `LGBM_Model_1_14`.`Score_0` AS `Score_0`, `LGBM_Model_1_14`.`Score_1` AS `Score_1`, `LGBM_Model_1_14`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_14` UNION ALL SELECT `LGBM_Model_2_14`.`KEY` AS `KEY`, `LGBM_Model_2_14`.`Score_0` AS `Score_0`, `LGBM_Model_2_14`.`Score_1` AS `Score_1`, `LGBM_Model_2_14`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_14` UNION ALL SELECT `LGBM_Model_0_15`.`KEY` AS `KEY`, `LGBM_Model_0_15`.`Score_0` AS `Score_0`, `LGBM_Model_0_15`.`Score_1` AS `Score_1`, `LGBM_Model_0_15`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_0_15` UNION ALL SELECT `LGBM_Model_1_15`.`KEY` AS `KEY`, `LGBM_Model_1_15`.`Score_0` AS `Score_0`, `LGBM_Model_1_15`.`Score_1` AS `Score_1`, `LGBM_Model_1_15`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_1_15` UNION ALL SELECT `LGBM_Model_2_15`.`KEY` AS `KEY`, `LGBM_Model_2_15`.`Score_0` AS `Score_0`, `LGBM_Model_2_15`.`Score_1` AS `Score_1`, `LGBM_Model_2_15`.`Score_2` AS `Score_2` 
FROM `LGBM_Model_2_15`) AS `LGBM_esu_4`) AS `LGBM_B4`) AS `U`

-- Code For temporary table TMP_20180417042220_PLSKBP_LGBM_Union part 1/2. Create 


CREATE TEMPORARY TABLE `TMP_20180417042220_PLSKBP_LGBM_Union` (
	`KEY` BIGINT, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE
)

 ENGINE=MEMORY

-- Code For temporary table TMP_20180417042220_PLSKBP_LGBM_Union part 2/2. Populate

INSERT INTO `TMP_20180417042220_PLSKBP_LGBM_Union` (`KEY`, `Score_0`, `Score_1`, `Score_2`) SELECT `U`.`KEY`, `U`.`Score_0`, `U`.`Score_1`, `U`.`Score_2` 
FROM (SELECT `LGBM_Union`.`KEY`, `LGBM_Union`.`Score_0`, `LGBM_Union`.`Score_1`, `LGBM_Union`.`Score_2` 
FROM (SELECT `LGBM_EnsembleUnion`.`KEY` AS `KEY`, `LGBM_EnsembleUnion`.`Score_0` AS `Score_0`, `LGBM_EnsembleUnion`.`Score_1` AS `Score_1`, `LGBM_EnsembleUnion`.`Score_2` AS `Score_2` 
FROM (SELECT `LGBM_B0`.`KEY` AS `KEY`, `LGBM_B0`.`Score_0` AS `Score_0`, `LGBM_B0`.`Score_1` AS `Score_1`, `LGBM_B0`.`Score_2` AS `Score_2` 
FROM `TMP_20180417042220_CJWA8N_LGBM_B0` AS `LGBM_B0` UNION ALL SELECT `LGBM_B1`.`KEY` AS `KEY`, `LGBM_B1`.`Score_0` AS `Score_0`, `LGBM_B1`.`Score_1` AS `Score_1`, `LGBM_B1`.`Score_2` AS `Score_2` 
FROM `TMP_20180417042220_47ZNAG_LGBM_B1` AS `LGBM_B1` UNION ALL SELECT `LGBM_B2`.`KEY` AS `KEY`, `LGBM_B2`.`Score_0` AS `Score_0`, `LGBM_B2`.`Score_1` AS `Score_1`, `LGBM_B2`.`Score_2` AS `Score_2` 
FROM `TMP_20180417042220_5OIDYM_LGBM_B2` AS `LGBM_B2` UNION ALL SELECT `LGBM_B3`.`KEY` AS `KEY`, `LGBM_B3`.`Score_0` AS `Score_0`, `LGBM_B3`.`Score_1` AS `Score_1`, `LGBM_B3`.`Score_2` AS `Score_2` 
FROM `TMP_20180417042220_91PZGY_LGBM_B3` AS `LGBM_B3` UNION ALL SELECT `LGBM_B4`.`KEY` AS `KEY`, `LGBM_B4`.`Score_0` AS `Score_0`, `LGBM_B4`.`Score_1` AS `Score_1`, `LGBM_B4`.`Score_2` AS `Score_2` 
FROM `TMP_20180417042220_P0SIQB_LGBM_B4` AS `LGBM_B4`) AS `LGBM_EnsembleUnion`) AS `LGBM_Union`) AS `U`

-- Code For temporary table TMP_20180417042220_J19208_LGBM_sum part 1/2. Create 


CREATE TEMPORARY TABLE `TMP_20180417042220_J19208_LGBM_sum` (
	`KEY` BIGINT NOT NULL, 
	`Score_0` DOUBLE, 
	`Score_1` DOUBLE, 
	`Score_2` DOUBLE, 
	PRIMARY KEY (`KEY`)
)

 ENGINE=MEMORY

-- Code For temporary table TMP_20180417042220_J19208_LGBM_sum part 2/2. Populate

INSERT INTO `TMP_20180417042220_J19208_LGBM_sum` (`KEY`, `Score_0`, `Score_1`, `Score_2`) SELECT `U`.`KEY`, `U`.`Score_0`, `U`.`Score_1`, `U`.`Score_2` 
FROM (SELECT `LGBM_sum`.`KEY`, `LGBM_sum`.`Score_0`, `LGBM_sum`.`Score_1`, `LGBM_sum`.`Score_2` 
FROM (SELECT `T`.`KEY` AS `KEY`, `T`.`Score_0` AS `Score_0`, `T`.`Score_1` AS `Score_1`, `T`.`Score_2` AS `Score_2` 
FROM (SELECT `LGBM_Union`.`KEY` AS `KEY`, sum(`LGBM_Union`.`Score_0`) AS `Score_0`, sum(`LGBM_Union`.`Score_1`) AS `Score_1`, sum(`LGBM_Union`.`Score_2`) AS `Score_2` 
FROM `TMP_20180417042220_PLSKBP_LGBM_Union` AS `LGBM_Union` GROUP BY `LGBM_Union`.`KEY`) AS `T`) AS `LGBM_sum`) AS `U`

-- Model deployment code

WITH orig_cte AS 
(SELECT `LGBM_sum`.`KEY` AS `KEY`, `LGBM_sum`.`Score_0` AS `Score_0`, `LGBM_sum`.`Score_1` AS `Score_1`, `LGBM_sum`.`Score_2` AS `Score_2`, NULL AS `Proba_0`, NULL AS `Proba_1`, NULL AS `Proba_2`, NULL AS `LogProba_0`, NULL AS `LogProba_1`, NULL AS `LogProba_2`, CAST(NULL AS SIGNED INTEGER) AS `Decision`, NULL AS `DecisionProba` 
FROM `TMP_20180417042220_J19208_LGBM_sum` AS `LGBM_sum`), 
score_class_union AS 
(SELECT scu.`KEY_u` AS `KEY_u`, scu.class AS class, scu.`LogProba` AS `LogProba`, scu.`Proba` AS `Proba`, scu.`Score` AS `Score` 
FROM (SELECT orig_cte.`KEY` AS `KEY_u`, 0 AS class, orig_cte.`LogProba_0` AS `LogProba`, orig_cte.`Proba_0` AS `Proba`, orig_cte.`Score_0` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 1 AS class, orig_cte.`LogProba_1` AS `LogProba`, orig_cte.`Proba_1` AS `Proba`, orig_cte.`Score_1` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 2 AS class, orig_cte.`LogProba_2` AS `LogProba`, orig_cte.`Proba_2` AS `Proba`, orig_cte.`Score_2` AS `Score` 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.`KEY` AS `KEY`, orig_cte.`Score_0` AS `Score_0`, orig_cte.`Score_1` AS `Score_1`, orig_cte.`Score_2` AS `Score_2`, orig_cte.`Proba_0` AS `Proba_0`, orig_cte.`Proba_1` AS `Proba_1`, orig_cte.`Proba_2` AS `Proba_2`, orig_cte.`LogProba_0` AS `LogProba_0`, orig_cte.`LogProba_1` AS `LogProba_1`, orig_cte.`LogProba_2` AS `LogProba_2`, orig_cte.`Decision` AS `Decision`, orig_cte.`DecisionProba` AS `DecisionProba`, max_select.`KEY_m` AS `KEY_m`, max_select.`max_Score` AS `max_Score` 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union.`KEY_u` AS `KEY_m`, max(score_class_union.`Score`) AS `max_Score` 
FROM score_class_union GROUP BY score_class_union.`KEY_u`) AS max_select ON orig_cte.`KEY` = max_select.`KEY_m`), 
score_soft_max_deltas AS 
(SELECT score_max.`KEY` AS `KEY`, score_max.`Score_0` AS `Score_0`, score_max.`Score_1` AS `Score_1`, score_max.`Score_2` AS `Score_2`, score_max.`Proba_0` AS `Proba_0`, score_max.`Proba_1` AS `Proba_1`, score_max.`Proba_2` AS `Proba_2`, score_max.`LogProba_0` AS `LogProba_0`, score_max.`LogProba_1` AS `LogProba_1`, score_max.`LogProba_2` AS `LogProba_2`, score_max.`Decision` AS `Decision`, score_max.`DecisionProba` AS `DecisionProba`, score_max.`KEY_m` AS `KEY_m`, score_max.`max_Score` AS `max_Score`, exp(score_max.`Score_0` - score_max.`max_Score`) AS `exp_delta_Score_0`, exp(score_max.`Score_1` - score_max.`max_Score`) AS `exp_delta_Score_1`, exp(score_max.`Score_2` - score_max.`max_Score`) AS `exp_delta_Score_2` 
FROM score_max), 
score_class_union_soft AS 
(SELECT soft_scu.`KEY` AS `KEY`, soft_scu.class AS class, soft_scu.`exp_delta_Score` AS `exp_delta_Score` 
FROM (SELECT score_soft_max_deltas.`KEY` AS `KEY`, 0 AS class, score_soft_max_deltas.`exp_delta_Score_0` AS `exp_delta_Score` 
FROM score_soft_max_deltas UNION ALL SELECT score_soft_max_deltas.`KEY` AS `KEY`, 1 AS class, score_soft_max_deltas.`exp_delta_Score_1` AS `exp_delta_Score` 
FROM score_soft_max_deltas UNION ALL SELECT score_soft_max_deltas.`KEY` AS `KEY`, 2 AS class, score_soft_max_deltas.`exp_delta_Score_2` AS `exp_delta_Score` 
FROM score_soft_max_deltas) AS soft_scu), 
score_soft_max AS 
(SELECT score_soft_max_deltas.`KEY` AS `KEY`, score_soft_max_deltas.`Score_0` AS `Score_0`, score_soft_max_deltas.`Score_1` AS `Score_1`, score_soft_max_deltas.`Score_2` AS `Score_2`, score_soft_max_deltas.`Proba_0` AS `Proba_0`, score_soft_max_deltas.`Proba_1` AS `Proba_1`, score_soft_max_deltas.`Proba_2` AS `Proba_2`, score_soft_max_deltas.`LogProba_0` AS `LogProba_0`, score_soft_max_deltas.`LogProba_1` AS `LogProba_1`, score_soft_max_deltas.`LogProba_2` AS `LogProba_2`, score_soft_max_deltas.`Decision` AS `Decision`, score_soft_max_deltas.`DecisionProba` AS `DecisionProba`, score_soft_max_deltas.`KEY_m` AS `KEY_m`, score_soft_max_deltas.`max_Score` AS `max_Score`, score_soft_max_deltas.`exp_delta_Score_0` AS `exp_delta_Score_0`, score_soft_max_deltas.`exp_delta_Score_1` AS `exp_delta_Score_1`, score_soft_max_deltas.`exp_delta_Score_2` AS `exp_delta_Score_2`, sum_exp_t.`KEY_sum` AS `KEY_sum`, sum_exp_t.`sum_ExpDeltaScore` AS `sum_ExpDeltaScore` 
FROM score_soft_max_deltas LEFT OUTER JOIN (SELECT score_class_union_soft.`KEY` AS `KEY_sum`, sum(score_class_union_soft.`exp_delta_Score`) AS `sum_ExpDeltaScore` 
FROM score_class_union_soft GROUP BY score_class_union_soft.`KEY`) AS sum_exp_t ON score_soft_max_deltas.`KEY` = sum_exp_t.`KEY_sum`), 
union_with_max AS 
(SELECT score_class_union.`KEY_u` AS `KEY_u`, score_class_union.class AS class, score_class_union.`LogProba` AS `LogProba`, score_class_union.`Proba` AS `Proba`, score_class_union.`Score` AS `Score`, score_soft_max.`KEY` AS `KEY`, score_soft_max.`Score_0` AS `Score_0`, score_soft_max.`Score_1` AS `Score_1`, score_soft_max.`Score_2` AS `Score_2`, score_soft_max.`Proba_0` AS `Proba_0`, score_soft_max.`Proba_1` AS `Proba_1`, score_soft_max.`Proba_2` AS `Proba_2`, score_soft_max.`LogProba_0` AS `LogProba_0`, score_soft_max.`LogProba_1` AS `LogProba_1`, score_soft_max.`LogProba_2` AS `LogProba_2`, score_soft_max.`Decision` AS `Decision`, score_soft_max.`DecisionProba` AS `DecisionProba`, score_soft_max.`KEY_m` AS `KEY_m`, score_soft_max.`max_Score` AS `max_Score`, score_soft_max.`exp_delta_Score_0` AS `exp_delta_Score_0`, score_soft_max.`exp_delta_Score_1` AS `exp_delta_Score_1`, score_soft_max.`exp_delta_Score_2` AS `exp_delta_Score_2`, score_soft_max.`KEY_sum` AS `KEY_sum`, score_soft_max.`sum_ExpDeltaScore` AS `sum_ExpDeltaScore` 
FROM score_class_union LEFT OUTER JOIN score_soft_max ON score_class_union.`KEY_u` = score_soft_max.`KEY`), 
arg_max_cte AS 
(SELECT score_soft_max.`KEY` AS `KEY`, score_soft_max.`Score_0` AS `Score_0`, score_soft_max.`Score_1` AS `Score_1`, score_soft_max.`Score_2` AS `Score_2`, score_soft_max.`Proba_0` AS `Proba_0`, score_soft_max.`Proba_1` AS `Proba_1`, score_soft_max.`Proba_2` AS `Proba_2`, score_soft_max.`LogProba_0` AS `LogProba_0`, score_soft_max.`LogProba_1` AS `LogProba_1`, score_soft_max.`LogProba_2` AS `LogProba_2`, score_soft_max.`Decision` AS `Decision`, score_soft_max.`DecisionProba` AS `DecisionProba`, score_soft_max.`KEY_m` AS `KEY_m`, score_soft_max.`max_Score` AS `max_Score`, score_soft_max.`exp_delta_Score_0` AS `exp_delta_Score_0`, score_soft_max.`exp_delta_Score_1` AS `exp_delta_Score_1`, score_soft_max.`exp_delta_Score_2` AS `exp_delta_Score_2`, score_soft_max.`KEY_sum` AS `KEY_sum`, score_soft_max.`sum_ExpDeltaScore` AS `sum_ExpDeltaScore`, `arg_max_t_Score`.`KEY_Score` AS `KEY_Score`, `arg_max_t_Score`.`arg_max_Score` AS `arg_max_Score`, soft_max_comp.`KEY_softmax` AS `KEY_softmax`, soft_max_comp.`SoftProba_0` AS `SoftProba_0`, soft_max_comp.`SoftProba_1` AS `SoftProba_1`, soft_max_comp.`SoftProba_2` AS `SoftProba_2` 
FROM score_soft_max LEFT OUTER JOIN (SELECT union_with_max.`KEY` AS `KEY_Score`, min(union_with_max.class) AS `arg_max_Score` 
FROM union_with_max 
WHERE union_with_max.`Score` >= union_with_max.`max_Score` GROUP BY union_with_max.`KEY`) AS `arg_max_t_Score` ON score_soft_max.`KEY` = `arg_max_t_Score`.`KEY_Score` LEFT OUTER JOIN (SELECT score_soft_max.`KEY` AS `KEY_softmax`, score_soft_max.`exp_delta_Score_0` / score_soft_max.`sum_ExpDeltaScore` AS `SoftProba_0`, score_soft_max.`exp_delta_Score_1` / score_soft_max.`sum_ExpDeltaScore` AS `SoftProba_1`, score_soft_max.`exp_delta_Score_2` / score_soft_max.`sum_ExpDeltaScore` AS `SoftProba_2` 
FROM score_soft_max) AS soft_max_comp ON soft_max_comp.`KEY_softmax` = `arg_max_t_Score`.`KEY_Score`)
 SELECT arg_max_cte.`KEY` AS `KEY`, NULL AS `Score_0`, NULL AS `Score_1`, NULL AS `Score_2`, arg_max_cte.`SoftProba_0` AS `Proba_0`, arg_max_cte.`SoftProba_1` AS `Proba_1`, arg_max_cte.`SoftProba_2` AS `Proba_2`, CASE WHEN (arg_max_cte.`SoftProba_0` IS NULL OR arg_max_cte.`SoftProba_0` > 0.0) THEN ln(arg_max_cte.`SoftProba_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (arg_max_cte.`SoftProba_1` IS NULL OR arg_max_cte.`SoftProba_1` > 0.0) THEN ln(arg_max_cte.`SoftProba_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (arg_max_cte.`SoftProba_2` IS NULL OR arg_max_cte.`SoftProba_2` > 0.0) THEN ln(arg_max_cte.`SoftProba_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, arg_max_cte.`arg_max_Score` AS `Decision`, greatest(arg_max_cte.`SoftProba_0`, arg_max_cte.`SoftProba_1`, arg_max_cte.`SoftProba_2`) AS `DecisionProba` 
FROM arg_max_cte