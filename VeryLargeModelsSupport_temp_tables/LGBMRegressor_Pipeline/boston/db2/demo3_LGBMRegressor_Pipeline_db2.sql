-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : LGBMRegressor_Pipeline
-- Dataset : boston
-- Database : db2


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180417023622_pjyu5n_ads_imp_1_out part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180417023622_pjyu5n_ads_imp_1_out (
	"KEY" BIGINT, 
	impter_2 DOUBLE, 
	impter_3 DOUBLE, 
	impter_4 DOUBLE, 
	impter_5 DOUBLE, 
	impter_6 DOUBLE, 
	impter_7 DOUBLE, 
	impter_8 DOUBLE, 
	impter_9 DOUBLE, 
	impter_10 DOUBLE, 
	impter_11 DOUBLE, 
	impter_12 DOUBLE, 
	impter_13 DOUBLE, 
	impter_14 DOUBLE
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180417023622_pjyu5n_ads_imp_1_out part 2/2. Populate

INSERT INTO tmp_20180417023622_pjyu5n_ads_imp_1_out SELECT "ADS_imp_1_OUT"."KEY", "ADS_imp_1_OUT".impter_2, "ADS_imp_1_OUT".impter_3, "ADS_imp_1_OUT".impter_4, "ADS_imp_1_OUT".impter_5, "ADS_imp_1_OUT".impter_6, "ADS_imp_1_OUT".impter_7, "ADS_imp_1_OUT".impter_8, "ADS_imp_1_OUT".impter_9, "ADS_imp_1_OUT".impter_10, "ADS_imp_1_OUT".impter_11, "ADS_imp_1_OUT".impter_12, "ADS_imp_1_OUT".impter_13, "ADS_imp_1_OUT".impter_14 
FROM (SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 3.3688565346534656 ELSE "ADS"."Feature_0" END AS impter_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 12.113861386138614 ELSE "ADS"."Feature_1" END AS impter_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 10.983613861386127 ELSE "ADS"."Feature_2" END AS impter_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 0.07178217821782178 ELSE "ADS"."Feature_3" END AS impter_5, CASE WHEN ("ADS"."Feature_4" IS NULL) THEN 0.5541153465346542 ELSE "ADS"."Feature_4" END AS impter_6, CASE WHEN ("ADS"."Feature_5" IS NULL) THEN 6.299148514851482 ELSE "ADS"."Feature_5" END AS impter_7, CASE WHEN ("ADS"."Feature_6" IS NULL) THEN 67.85049504950491 ELSE "ADS"."Feature_6" END AS impter_8, CASE WHEN ("ADS"."Feature_7" IS NULL) THEN 3.8198420792079233 ELSE "ADS"."Feature_7" END AS impter_9, CASE WHEN ("ADS"."Feature_8" IS NULL) THEN 9.55940594059406 ELSE "ADS"."Feature_8" END AS impter_10, CASE WHEN ("ADS"."Feature_9" IS NULL) THEN 405.8019801980198 ELSE "ADS"."Feature_9" END AS impter_11, CASE WHEN ("ADS"."Feature_10" IS NULL) THEN 18.40915841584154 ELSE "ADS"."Feature_10" END AS impter_12, CASE WHEN ("ADS"."Feature_11" IS NULL) THEN 358.3797277227715 ELSE "ADS"."Feature_11" END AS impter_13, CASE WHEN ("ADS"."Feature_12" IS NULL) THEN 12.626584158415856 ELSE "ADS"."Feature_12" END AS impter_14 
FROM "BOSTON" AS "ADS") AS "ADS_imp_1_OUT"

-- Code For temporary table tmp_20180417023622_35k7tg_ads_sca_2_out part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180417023622_35k7tg_ads_sca_2_out (
	"KEY" BIGINT, 
	scaler_2 FLOAT, 
	scaler_3 FLOAT, 
	scaler_4 FLOAT, 
	scaler_5 FLOAT, 
	scaler_6 FLOAT, 
	scaler_7 FLOAT, 
	scaler_8 FLOAT, 
	scaler_9 FLOAT, 
	scaler_10 FLOAT, 
	scaler_11 FLOAT, 
	scaler_12 FLOAT, 
	scaler_13 FLOAT, 
	scaler_14 FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180417023622_35k7tg_ads_sca_2_out part 2/2. Populate

INSERT INTO tmp_20180417023622_35k7tg_ads_sca_2_out SELECT "ADS_sca_2_OUT"."KEY", "ADS_sca_2_OUT".scaler_2, "ADS_sca_2_OUT".scaler_3, "ADS_sca_2_OUT".scaler_4, "ADS_sca_2_OUT".scaler_5, "ADS_sca_2_OUT".scaler_6, "ADS_sca_2_OUT".scaler_7, "ADS_sca_2_OUT".scaler_8, "ADS_sca_2_OUT".scaler_9, "ADS_sca_2_OUT".scaler_10, "ADS_sca_2_OUT".scaler_11, "ADS_sca_2_OUT".scaler_12, "ADS_sca_2_OUT".scaler_13, "ADS_sca_2_OUT".scaler_14 
FROM (SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".impter_2 AS DOUBLE) - 3.3688565346534656) / 7.9935268095335426 AS scaler_2, (CAST("ADS_imp_1_OUT".impter_3 AS DOUBLE) - 12.113861386138614) / 24.187656534977855 AS scaler_3, (CAST("ADS_imp_1_OUT".impter_4 AS DOUBLE) - 10.983613861386127) / 6.8177472477399235 AS scaler_4, (CAST("ADS_imp_1_OUT".impter_5 AS DOUBLE) - 0.07178217821782178) / 0.2581269011709685 AS scaler_5, (CAST("ADS_imp_1_OUT".impter_6 AS DOUBLE) - 0.5541153465346542) / 0.11800809760824685 AS scaler_6, (CAST("ADS_imp_1_OUT".impter_7 AS DOUBLE) - 6.299148514851482) / 0.7060417397996938 AS scaler_7, (CAST("ADS_imp_1_OUT".impter_8 AS DOUBLE) - 67.85049504950491) / 28.107403181658597 AS scaler_8, (CAST("ADS_imp_1_OUT".impter_9 AS DOUBLE) - 3.8198420792079233) / 2.0933726902675627 AS scaler_9, (CAST("ADS_imp_1_OUT".impter_10 AS DOUBLE) - 9.55940594059406) / 8.728803783375893 AS scaler_10, (CAST("ADS_imp_1_OUT".impter_11 AS DOUBLE) - 405.8019801980198) / 169.7858592930543 AS scaler_11, (CAST("ADS_imp_1_OUT".impter_12 AS DOUBLE) - 18.40915841584154) / 2.166792648327246 AS scaler_12, (CAST("ADS_imp_1_OUT".impter_13 AS DOUBLE) - 358.3797277227715) / 90.64691624336051 AS scaler_13, (CAST("ADS_imp_1_OUT".impter_14 AS DOUBLE) - 12.626584158415856) / 7.167938324035357 AS scaler_14 
FROM tmp_20180417023622_pjyu5n_ads_imp_1_out AS "ADS_imp_1_OUT") AS "ADS_sca_2_OUT"

-- Code For temporary table tmp_20180417023622_hqnrdd_lgbm_b0 part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180417023622_hqnrdd_lgbm_b0 (
	"KEY" BIGINT, 
	"Estimator" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180417023622_hqnrdd_lgbm_b0 part 2/2. Populate

INSERT INTO tmp_20180417023622_hqnrdd_lgbm_b0 WITH "DT_node_lookup" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.7447880989269889) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3039110749990041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.32909029601342993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.40828813336779196) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.4039401645344436) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.1283897392202328) THEN 64 ELSE 65 END ELSE 33 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.726220550471154) THEN 34 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.579621912252141) THEN 70 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 0.07647469019470782) THEN 142 ELSE 143 END END END END ELSE 9 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.3101476387606193) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.8692871974819419) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.37331601003632603) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 1.2218877235893113) THEN 22 ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.5818490921873434) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -1.0067865866280377) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 7 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 23.68019760161212 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 9 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 4 AS parent_id, 22.83501241924654 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 12 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 6 AS parent_id, 23.12476244902847 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 13 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 6 AS parent_id, 22.8224124152684 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, 22.18592151054705 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, 22.133845756612594 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, 21.977512419782457 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 33 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 16 AS parent_id, 22.760012416034588 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 34 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 17 AS parent_id, 22.54477432406451 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 42 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 21 AS parent_id, 22.437966964106998 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 43 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 21 AS parent_id, 22.28726243233917 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 64 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 32 AS parent_id, 22.485512422995207 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 65 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 32 AS parent_id, 22.625938357487197 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 70 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 35 AS parent_id, 22.400012429599947 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 142 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 71 AS parent_id, 22.52676243251798 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 143 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 71 AS parent_id, 22.444066474559584 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".node_id AS node_id, "DT_node_data".feature AS feature, "DT_node_data".threshold AS threshold, "DT_node_data".depth AS depth, "DT_node_data".parent_id AS parent_id, "DT_node_data"."Estimator" AS "Estimator" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".node_id), 
"LGBM_Model_0" AS 
(SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."Estimator" AS "Estimator" 
FROM "DT_Output"), 
"DT_node_lookup_1" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.7447880989269889) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3039110749990041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.40828813336779196) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.32909029601342993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.3567718971311092) THEN 32 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.20062342899396915) THEN 66 ELSE 67 END END ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.726220550471154) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.579621912252141) THEN 38 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 0.07647469019470782) THEN 78 ELSE 79 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.3101476387606193) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.8692871974819419) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.34190700468288376) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 1.2218877235893113) THEN 22 ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.5818490921873434) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -1.0067865866280377) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_1" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 7 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 1.046175335292463 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 12 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 6 AS parent_id, 0.5185119009017944 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 13 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 6 AS parent_id, 0.23127937006950378 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 17 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 8 AS parent_id, 0.25936048831790687 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 9 AS parent_id, -0.0324768134525844 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.3733869937333194 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.42285894155502324 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.571375617980957 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 32 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 16 AS parent_id, 0.18230336777400225 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 38 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 19 AS parent_id, -0.16674019930263362 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 42 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 21 AS parent_id, -0.12999023323257763 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 43 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 21 AS parent_id, -0.2742490901833489 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 66 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 33 AS parent_id, -0.09879467114806176 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 67 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 33 AS parent_id, 0.058645646909384855 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 78 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 39 AS parent_id, -0.04958811178803444 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 79 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 39 AS parent_id, -0.12482299310596366 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_1" AS 
(SELECT "DT_node_lookup_1"."KEY" AS "KEY", "DT_node_lookup_1".node_id_2 AS node_id_2, "DT_node_data_1".node_id AS node_id, "DT_node_data_1".feature AS feature, "DT_node_data_1".threshold AS threshold, "DT_node_data_1".depth AS depth, "DT_node_data_1".parent_id AS parent_id, "DT_node_data_1"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_1" LEFT OUTER JOIN "DT_node_data_1" ON "DT_node_lookup_1".node_id_2 = "DT_node_data_1".node_id), 
"LGBM_Model_1" AS 
(SELECT "DT_Output_1"."KEY" AS "KEY", "DT_Output_1"."Estimator" AS "Estimator" 
FROM "DT_Output_1"), 
"DT_node_lookup_2" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.13074261781607) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3039110749990041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.32909029601342993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.40828813336779196) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.4039401645344436) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.1283897392202328) THEN 64 ELSE 65 END ELSE 33 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.726220550471154) THEN 34 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.579621912252141) THEN 70 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 0.07647469019470782) THEN 142 ELSE 143 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -1.0242253527486742) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.7192425420305321) THEN 38 ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.448144276004751) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.337398197180857) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.8133035167396788) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.9003168763247735) THEN 44 ELSE 45 END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.6717871176899362) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_2" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 6 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.4872575873420353 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 7 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 1.0207646484176318 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 9 AS parent_id, 0.41737285366524823 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.13246601084963636 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 21 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.2974153137207031 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.5654426789283752 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 33 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 16 AS parent_id, 0.1676879637282003 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 34 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 17 AS parent_id, -0.030852971188280554 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 38 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 19 AS parent_id, 0.22944668382406236 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 39 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 19 AS parent_id, 0.12306558111682536 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 44 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 22 AS parent_id, -0.3007912251684401 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 45 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 22 AS parent_id, -0.4407543814700583 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 64 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 32 AS parent_id, -0.08563497792929411 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 65 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 32 AS parent_id, 0.0398647699367117 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 70 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 35 AS parent_id, -0.1616636018390241 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 142 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 71 AS parent_id, -0.0471087034791708 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 143 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 71 AS parent_id, -0.12190811891813536 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_2" AS 
(SELECT "DT_node_lookup_2"."KEY" AS "KEY", "DT_node_lookup_2".node_id_2 AS node_id_2, "DT_node_data_2".node_id AS node_id, "DT_node_data_2".feature AS feature, "DT_node_data_2".threshold AS threshold, "DT_node_data_2".depth AS depth, "DT_node_data_2".parent_id AS parent_id, "DT_node_data_2"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_2" LEFT OUTER JOIN "DT_node_data_2" ON "DT_node_lookup_2".node_id_2 = "DT_node_data_2".node_id), 
"LGBM_Model_2" AS 
(SELECT "DT_Output_2"."KEY" AS "KEY", "DT_Output_2"."Estimator" AS "Estimator" 
FROM "DT_Output_2"), 
"DT_node_lookup_3" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.13074261781607) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3039110749990041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.32909029601342993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.40828813336779196) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.3567718971311092) THEN 32 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.20062342899396915) THEN 66 ELSE 67 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.726220550471154) THEN 34 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.579621912252141) THEN 70 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 0.07647469019470782) THEN 142 ELSE 143 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -1.0242253527486742) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.7192425420305321) THEN 38 ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.448144276004751) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.337398197180857) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.8133035167396788) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.9003168763247735) THEN 44 ELSE 45 END ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.6717871176899362) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_3" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 6 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.4628946996870495 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 7 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.9697264621655146 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 9 AS parent_id, 0.39650421479473946 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.12584271324941745 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 21 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.2825445526838303 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.5371705524126689 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 32 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 16 AS parent_id, 0.16862687380751595 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 34 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 17 AS parent_id, -0.029310325502107545 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 38 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 19 AS parent_id, 0.2179743518680334 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 39 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 19 AS parent_id, 0.11691229958087207 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 44 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 22 AS parent_id, -0.28575166728761464 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 45 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 22 AS parent_id, -0.4187166654545328 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 66 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 33 AS parent_id, -0.09198578777057785 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 67 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 33 AS parent_id, 0.052118188159407254 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 70 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 35 AS parent_id, -0.15358042017273282 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 142 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 71 AS parent_id, -0.044753270074725154 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 143 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 71 AS parent_id, -0.11581271548528929 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_3" AS 
(SELECT "DT_node_lookup_3"."KEY" AS "KEY", "DT_node_lookup_3".node_id_2 AS node_id_2, "DT_node_data_3".node_id AS node_id, "DT_node_data_3".feature AS feature, "DT_node_data_3".threshold AS threshold, "DT_node_data_3".depth AS depth, "DT_node_data_3".parent_id AS parent_id, "DT_node_data_3"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_3" LEFT OUTER JOIN "DT_node_data_3" ON "DT_node_lookup_3".node_id_2 = "DT_node_data_3".node_id), 
"LGBM_Model_3" AS 
(SELECT "DT_Output_3"."KEY" AS "KEY", "DT_Output_3"."Estimator" AS "Estimator" 
FROM "DT_Output_3"), 
"DT_node_lookup_4" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.7447880989269889) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3039110749990041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.40828813336779196) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.29378023413101) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.2455258313732251) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.20062342899396915) THEN 68 ELSE 69 END ELSE 35 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.726220550471154) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.579621912252141) THEN 38 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 0.07647469019470782) THEN 78 ELSE 79 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.3101476387606193) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.8692871974819419) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.38274176187219144) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 1.2218877235893113) THEN 22 ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.5818490921873434) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -1.0067865866280377) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_4" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 7 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.9001216561705978 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 12 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 6 AS parent_id, 0.4488262629508972 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 13 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 6 AS parent_id, 0.19552444732189178 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 16 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 8 AS parent_id, 0.2758381972766735 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 9 AS parent_id, -0.027844806458978428 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.31943896873430777 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.3637155628204346 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.4923156436284384 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 35 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 17 AS parent_id, 0.16882487437961735 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 38 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 19 AS parent_id, -0.1437976984928052 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 42 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 21 AS parent_id, -0.10740145653486254 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 43 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 21 AS parent_id, -0.23098403357646685 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 68 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 34 AS parent_id, -0.07795563204740377 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 69 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 34 AS parent_id, 0.027667950552243456 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 78 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 39 AS parent_id, -0.04251560464501381 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 79 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 39 AS parent_id, -0.10732435005667962 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_4" AS 
(SELECT "DT_node_lookup_4"."KEY" AS "KEY", "DT_node_lookup_4".node_id_2 AS node_id_2, "DT_node_data_4".node_id AS node_id, "DT_node_data_4".feature AS feature, "DT_node_data_4".threshold AS threshold, "DT_node_data_4".depth AS depth, "DT_node_data_4".parent_id AS parent_id, "DT_node_data_4"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_4" LEFT OUTER JOIN "DT_node_data_4" ON "DT_node_lookup_4".node_id_2 = "DT_node_data_4".node_id), 
"LGBM_Model_4" AS 
(SELECT "DT_Output_4"."KEY" AS "KEY", "DT_Output_4"."Estimator" AS "Estimator" 
FROM "DT_Output_4"), 
"DT_node_lookup_5" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.13074261781607) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3039110749990041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.32909029601342993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.40828813336779196) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.4039401645344436) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.1283897392202328) THEN 64 ELSE 65 END ELSE 33 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 0.29307152216343385) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 0.05157021945879913) THEN 68 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.3973003074838933) THEN 138 ELSE 139 END END ELSE 35 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -1.0242253527486742) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.7192425420305321) THEN 38 ELSE 39 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.926924979576161) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.6880407247594201) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.8133035167396788) THEN 22 ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.6717871176899362) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_5" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 6 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.41951302687327074 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 7 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.876234057545662 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 9 AS parent_id, 0.3606115233153105 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.11231489549577237 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 21 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.26128859628330575 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.32022302318841983 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.4954502146819542 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 33 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 16 AS parent_id, 0.15058369689028372 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 35 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 17 AS parent_id, -0.13262193070517644 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 38 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 19 AS parent_id, 0.1974985801614821 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 39 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 19 AS parent_id, 0.10349609396420419 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 64 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 32 AS parent_id, -0.07593208227306605 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 65 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 32 AS parent_id, 0.028353116392261454 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 68 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 34 AS parent_id, -0.007674052050480476 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 138 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 69 AS parent_id, -0.12901121437549593 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 139 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 69 AS parent_id, -0.0617536703205627 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_5" AS 
(SELECT "DT_node_lookup_5"."KEY" AS "KEY", "DT_node_lookup_5".node_id_2 AS node_id_2, "DT_node_data_5".node_id AS node_id, "DT_node_data_5".feature AS feature, "DT_node_data_5".threshold AS threshold, "DT_node_data_5".depth AS depth, "DT_node_data_5".parent_id AS parent_id, "DT_node_data_5"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_5" LEFT OUTER JOIN "DT_node_data_5" ON "DT_node_lookup_5".node_id_2 = "DT_node_data_5".node_id), 
"LGBM_Model_5" AS 
(SELECT "DT_Output_5"."KEY" AS "KEY", "DT_Output_5"."Estimator" AS "Estimator" 
FROM "DT_Output_5"), 
"DT_node_lookup_6" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.7447880989269889) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3039110749990041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.40828813336779196) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.29378023413101) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.2455258313732251) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.20062342899396915) THEN 68 ELSE 69 END ELSE 35 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.6340255676363853) THEN 18 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.11115119129852609) THEN 38 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.2726140752727751) THEN 78 ELSE 79 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.3101476387606193) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.8692871974819419) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.34190700468288376) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 1.2218877235893113) THEN 22 ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.5818490921873434) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -1.0067865866280377) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_6" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 7 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.8138412051730687 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 12 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 6 AS parent_id, 0.40702908992767334 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 13 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 6 AS parent_id, 0.17512054133415222 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 16 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 8 AS parent_id, 0.2546831145205281 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 9 AS parent_id, -0.13033659788391863 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.2894724420525811 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.3285521517197291 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.44555837154388434 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 35 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 17 AS parent_id, 0.15131255820092254 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 38 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 19 AS parent_id, -0.01987848577179736 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 42 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 21 AS parent_id, -0.0984124936518215 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 43 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 21 AS parent_id, -0.20983166723024277 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 68 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 34 AS parent_id, -0.07321579882308192 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 69 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 34 AS parent_id, 0.023622583182385335 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 78 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 39 AS parent_id, -0.12316811177413911 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 79 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 39 AS parent_id, -0.06777415629476309 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_6" AS 
(SELECT "DT_node_lookup_6"."KEY" AS "KEY", "DT_node_lookup_6".node_id_2 AS node_id_2, "DT_node_data_6".node_id AS node_id, "DT_node_data_6".feature AS feature, "DT_node_data_6".threshold AS threshold, "DT_node_data_6".depth AS depth, "DT_node_data_6".parent_id AS parent_id, "DT_node_data_6"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_6" LEFT OUTER JOIN "DT_node_data_6" ON "DT_node_lookup_6".node_id_2 = "DT_node_data_6".node_id), 
"LGBM_Model_6" AS 
(SELECT "DT_Output_6"."KEY" AS "KEY", "DT_Output_6"."Estimator" AS "Estimator" 
FROM "DT_Output_6"), 
"DT_node_lookup_7" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.13074261781607) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3039110749990041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.32909029601342993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.40828813336779196) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 0.30499008789040466) THEN 32 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.7082349106427404) THEN 66 ELSE 67 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.726220550471154) THEN 34 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.579621912252141) THEN 70 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 0.07647469019470782) THEN 142 ELSE 143 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -1.0067865866280377) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.9777689480970188) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.6880407247594201) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.8133035167396788) THEN 22 ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.6717871176899362) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_7" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 6 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.3802495740708851 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 7 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.7917302926381429 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 9 AS parent_id, 0.3203236408233643 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 19 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 9 AS parent_id, 0.13006129252087129 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.10056861299276353 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 21 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.23590683834893367 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.28854868572491865 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.46528554139313877 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 32 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 16 AS parent_id, 0.1500300649739802 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 34 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 17 AS parent_id, -0.019844710489823707 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 66 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 33 AS parent_id, 0.0155150726969753 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 67 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 33 AS parent_id, -0.056125140700134496 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 70 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 35 AS parent_id, -0.12875992761034033 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 142 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 71 AS parent_id, -0.03443929900415242 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 143 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 71 AS parent_id, -0.09566262544611016 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_7" AS 
(SELECT "DT_node_lookup_7"."KEY" AS "KEY", "DT_node_lookup_7".node_id_2 AS node_id_2, "DT_node_data_7".node_id AS node_id, "DT_node_data_7".feature AS feature, "DT_node_data_7".threshold AS threshold, "DT_node_data_7".depth AS depth, "DT_node_data_7".parent_id AS parent_id, "DT_node_data_7"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_7" LEFT OUTER JOIN "DT_node_data_7" ON "DT_node_lookup_7".node_id_2 = "DT_node_data_7".node_id), 
"LGBM_Model_7" AS 
(SELECT "DT_Output_7"."KEY" AS "KEY", "DT_Output_7"."Estimator" AS "Estimator" 
FROM "DT_Output_7"), 
"DT_node_lookup_8" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.7447880989269889) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.20904418730274124) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.32909029601342993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.3973003074838933) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.34225811482482377) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.6085313241868316) THEN 64 ELSE 65 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 0.05157021945879913) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 1.1862235197473068) THEN 132 ELSE 133 END ELSE 67 END END ELSE 17 END ELSE 9 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.8333165361897209) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.5291980081059343) THEN 20 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 1.0940002088332583) THEN 42 ELSE 43 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.337398197180857) THEN 22 ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.5818490921873434) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.634929084476647) THEN 12 ELSE 13 END ELSE 7 END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_8" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 7 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.7358486272670605 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 9 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 4 AS parent_id, 0.17009809672048218 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 12 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 6 AS parent_id, 0.35831760515651223 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 13 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 6 AS parent_id, 0.1398624910549684 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 17 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 8 AS parent_id, 0.09650889705293454 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.254281646590079 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.08468868494965137 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.22882138567311425 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 42 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 21 AS parent_id, -0.41261228382587434 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 43 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 21 AS parent_id, -0.37265707403421405 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 64 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 32 AS parent_id, -0.15255204237997533 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 65 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 32 AS parent_id, -0.07146446488797664 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 67 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 33 AS parent_id, -0.07657392337918283 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 132 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 66 AS parent_id, 0.043650965502156934 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 133 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 66 AS parent_id, -0.012028764915608225 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_8" AS 
(SELECT "DT_node_lookup_8"."KEY" AS "KEY", "DT_node_lookup_8".node_id_2 AS node_id_2, "DT_node_data_8".node_id AS node_id, "DT_node_data_8".feature AS feature, "DT_node_data_8".threshold AS threshold, "DT_node_data_8".depth AS depth, "DT_node_data_8".parent_id AS parent_id, "DT_node_data_8"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_8" LEFT OUTER JOIN "DT_node_data_8" ON "DT_node_lookup_8".node_id_2 = "DT_node_data_8".node_id), 
"LGBM_Model_8" AS 
(SELECT "DT_Output_8"."KEY" AS "KEY", "DT_Output_8"."Estimator" AS "Estimator" 
FROM "DT_Output_8"), 
"DT_node_lookup_9" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.13074261781607) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3039110749990041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.32909029601342993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.40828813336779196) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.4020736542498711) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.07345345940896016) THEN 64 ELSE 65 END ELSE 33 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.726220550471154) THEN 34 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.6340255676363853) THEN 70 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 0.22234373307645808) THEN 142 ELSE 143 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -1.0067865866280377) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.9777689480970188) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.6880407247594201) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.8133035167396788) THEN 22 ELSE 23 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.6717871176899362) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_9" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 6 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.344785627864656 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 7 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.7153513232866924 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 9 AS parent_id, 0.29384627628326415 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 19 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 9 AS parent_id, 0.11359820801176523 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.0902881875038147 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 21 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.21146650850772858 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.26027932102099444 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 23 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.4241007449450316 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 33 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 16 AS parent_id, 0.14321361737325788 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 34 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 17 AS parent_id, -0.01562723091670445 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 64 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 32 AS parent_id, 0.026415278579763793 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 65 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 32 AS parent_id, -0.06379481233571742 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 70 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 35 AS parent_id, -0.12176804228552751 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 142 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 71 AS parent_id, -0.03598189964735259 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 143 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 71 AS parent_id, -0.09248016101973398 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_9" AS 
(SELECT "DT_node_lookup_9"."KEY" AS "KEY", "DT_node_lookup_9".node_id_2 AS node_id_2, "DT_node_data_9".node_id AS node_id, "DT_node_data_9".feature AS feature, "DT_node_data_9".threshold AS threshold, "DT_node_data_9".depth AS depth, "DT_node_data_9".parent_id AS parent_id, "DT_node_data_9"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_9" LEFT OUTER JOIN "DT_node_data_9" ON "DT_node_lookup_9".node_id_2 = "DT_node_data_9".node_id), 
"LGBM_Model_9" AS 
(SELECT "DT_Output_9"."KEY" AS "KEY", "DT_Output_9"."Estimator" AS "Estimator" 
FROM "DT_Output_9")
 SELECT "LGBM_B0"."KEY", "LGBM_B0"."Estimator" 
FROM (SELECT "LGBM_esu_0"."KEY" AS "KEY", "LGBM_esu_0"."Estimator" AS "Estimator" 
FROM (SELECT "LGBM_Model_0"."KEY" AS "KEY", "LGBM_Model_0"."Estimator" AS "Estimator" 
FROM "LGBM_Model_0" UNION ALL SELECT "LGBM_Model_1"."KEY" AS "KEY", "LGBM_Model_1"."Estimator" AS "Estimator" 
FROM "LGBM_Model_1" UNION ALL SELECT "LGBM_Model_2"."KEY" AS "KEY", "LGBM_Model_2"."Estimator" AS "Estimator" 
FROM "LGBM_Model_2" UNION ALL SELECT "LGBM_Model_3"."KEY" AS "KEY", "LGBM_Model_3"."Estimator" AS "Estimator" 
FROM "LGBM_Model_3" UNION ALL SELECT "LGBM_Model_4"."KEY" AS "KEY", "LGBM_Model_4"."Estimator" AS "Estimator" 
FROM "LGBM_Model_4" UNION ALL SELECT "LGBM_Model_5"."KEY" AS "KEY", "LGBM_Model_5"."Estimator" AS "Estimator" 
FROM "LGBM_Model_5" UNION ALL SELECT "LGBM_Model_6"."KEY" AS "KEY", "LGBM_Model_6"."Estimator" AS "Estimator" 
FROM "LGBM_Model_6" UNION ALL SELECT "LGBM_Model_7"."KEY" AS "KEY", "LGBM_Model_7"."Estimator" AS "Estimator" 
FROM "LGBM_Model_7" UNION ALL SELECT "LGBM_Model_8"."KEY" AS "KEY", "LGBM_Model_8"."Estimator" AS "Estimator" 
FROM "LGBM_Model_8" UNION ALL SELECT "LGBM_Model_9"."KEY" AS "KEY", "LGBM_Model_9"."Estimator" AS "Estimator" 
FROM "LGBM_Model_9") AS "LGBM_esu_0") AS "LGBM_B0"

-- Code For temporary table tmp_20180417023622_60s5ti_lgbm_b1 part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180417023622_60s5ti_lgbm_b1 (
	"KEY" BIGINT, 
	"Estimator" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180417023622_60s5ti_lgbm_b1 part 2/2. Populate

INSERT INTO tmp_20180417023622_60s5ti_lgbm_b1 WITH "DT_node_lookup_10" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.40828813336779196) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.2015599607314973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.5188807750267758) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.1074543870060579) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.20062342899396915) THEN 34 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -1.0637942913565344) THEN 70 ELSE 71 END END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3394861578851025) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.726220550471154) THEN 12 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.03579608903099569) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.4650586771494674) THEN 52 ELSE 53 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.10720179315822383) THEN 54 ELSE 55 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.9777689480970188) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.6880407247594201) THEN 28 ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.8133035167396788) THEN 30 ELSE 31 END END END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_10" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 5 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 2 AS parent_id, 0.5860378956183409 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 9 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 4 AS parent_id, 0.2369123419125875 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 12 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 6 AS parent_id, 0.010687275538625925 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 16 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 8 AS parent_id, 0.1723293763274948 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 28 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 14 AS parent_id, -0.08577377879619599 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 29 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 14 AS parent_id, -0.20638745029767358 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 30 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 15 AS parent_id, -0.2523488861723588 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 31 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 15 AS parent_id, -0.415586670086934 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 34 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 17 AS parent_id, -0.059697724021971224 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 52 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 26 AS parent_id, -0.07692863578381746 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 53 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 26 AS parent_id, -0.012688198667906582 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 54 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 27 AS parent_id, -0.08688661362975836 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 55 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 27 AS parent_id, -0.12314495328068734 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 70 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 35 AS parent_id, 0.06621908084847607 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 71 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 35 AS parent_id, 0.006382044980471785 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_10" AS 
(SELECT "DT_node_lookup_10"."KEY" AS "KEY", "DT_node_lookup_10".node_id_2 AS node_id_2, "DT_node_data_10".node_id AS node_id, "DT_node_data_10".feature AS feature, "DT_node_data_10".threshold AS threshold, "DT_node_data_10".depth AS depth, "DT_node_data_10".parent_id AS parent_id, "DT_node_data_10"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_10" LEFT OUTER JOIN "DT_node_data_10" ON "DT_node_lookup_10".node_id_2 = "DT_node_data_10".node_id), 
"LGBM_Model_10" AS 
(SELECT "DT_Output_10"."KEY" AS "KEY", "DT_Output_10"."Estimator" AS "Estimator" 
FROM "DT_Output_10"), 
"DT_node_lookup_11" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -1.0423616695141362) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.5818490921873434) THEN 4 ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3039110749990041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.44027352439065054) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.4180538423953485) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 0.30499008789040466) THEN 48 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.7186981703151222) THEN 98 ELSE 99 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 0.29307152216343385) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= -0.16198334624554048) THEN 100 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.3973003074838933) THEN 202 ELSE 203 END END ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.9597912072136919) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.448144276004751) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.337398197180857) THEN 28 ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.9003168763247735) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.8133035167396788) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_11" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 4 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 2 AS parent_id, 0.27813502214848995 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 5 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 2 AS parent_id, 0.7071466809227354 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 26 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 13 AS parent_id, 0.31520777115225795 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 27 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 13 AS parent_id, 0.03358277840458829 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 28 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 14 AS parent_id, -0.08044419689820365 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 29 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 14 AS parent_id, -0.18190037835389378 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 30 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 15 AS parent_id, -0.20513861862676486 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 48 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 24 AS parent_id, 0.14149738650607027 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 51 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 25 AS parent_id, -0.10736661529927344 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 62 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 31 AS parent_id, -0.2934186678865682 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 63 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 31 AS parent_id, -0.3881442344706991 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 98 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 49 AS parent_id, 0.020779516376554966 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 99 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 49 AS parent_id, -0.0472535876184702 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 100 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 50 AS parent_id, 0.008565739200760921 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 202 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 101 AS parent_id, -0.10093725570650013 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 203 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 101 AS parent_id, -0.039664213582873344 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_11" AS 
(SELECT "DT_node_lookup_11"."KEY" AS "KEY", "DT_node_lookup_11".node_id_2 AS node_id_2, "DT_node_data_11".node_id AS node_id, "DT_node_data_11".feature AS feature, "DT_node_data_11".threshold AS threshold, "DT_node_data_11".depth AS depth, "DT_node_data_11".parent_id AS parent_id, "DT_node_data_11"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_11" LEFT OUTER JOIN "DT_node_data_11" ON "DT_node_lookup_11".node_id_2 = "DT_node_data_11".node_id), 
"LGBM_Model_11" AS 
(SELECT "DT_Output_11"."KEY" AS "KEY", "DT_Output_11"."Estimator" AS "Estimator" 
FROM "DT_Output_11"), 
"DT_node_lookup_12" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -1.0423616695141362) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.5818490921873434) THEN 4 ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3039110749990041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.44027352439065054) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.4180538423953485) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 0.30499008789040466) THEN 48 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.7186981703151222) THEN 98 ELSE 99 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 0.29307152216343385) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 0.05157021945879913) THEN 100 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.3973003074838933) THEN 202 ELSE 203 END END ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.9597912072136919) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.9777689480970188) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.6880407247594201) THEN 28 ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.8133035167396788) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.38152476848007216) THEN 60 ELSE 61 END ELSE 31 END END END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_12" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 4 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 2 AS parent_id, 0.2642282729968429 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 5 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 2 AS parent_id, 0.6717893282572429 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 26 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 13 AS parent_id, 0.29944738399982457 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 27 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 13 AS parent_id, 0.031903639824494075 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 28 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 14 AS parent_id, -0.07746288108825684 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 29 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 14 AS parent_id, -0.18036946827811856 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 31 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 15 AS parent_id, -0.36528411397227534 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 48 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 24 AS parent_id, 0.13442252288349785 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 51 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 25 AS parent_id, -0.1019982845970878 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 60 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 30 AS parent_id, -0.18643117494881156 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 61 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 30 AS parent_id, -0.26576447844505313 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 98 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 49 AS parent_id, 0.019740541125647725 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 99 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 49 AS parent_id, -0.04489090898633003 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 100 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 50 AS parent_id, 0.0027095008375389237 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 202 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 101 AS parent_id, -0.09935476269200444 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 203 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 101 AS parent_id, -0.04033755559636199 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_12" AS 
(SELECT "DT_node_lookup_12"."KEY" AS "KEY", "DT_node_lookup_12".node_id_2 AS node_id_2, "DT_node_data_12".node_id AS node_id, "DT_node_data_12".feature AS feature, "DT_node_data_12".threshold AS threshold, "DT_node_data_12".depth AS depth, "DT_node_data_12".parent_id AS parent_id, "DT_node_data_12"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_12" LEFT OUTER JOIN "DT_node_data_12" ON "DT_node_lookup_12".node_id_2 = "DT_node_data_12".node_id), 
"LGBM_Model_12" AS 
(SELECT "DT_Output_12"."KEY" AS "KEY", "DT_Output_12"."Estimator" AS "Estimator" 
FROM "DT_Output_12"), 
"DT_node_lookup_13" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.13074261781607) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3039110749990041) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.32909029601342993) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.5498322130464665) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.5726628180672414) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.5299240735507066) THEN 64 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.8218651470648513) THEN 130 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.634929084476647) THEN 262 ELSE 263 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.07473102498759422) THEN 66 ELSE 67 END END ELSE 17 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -1.0067865866280377) THEN 18 ELSE 19 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.448144276004751) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.337398197180857) THEN 20 ELSE 21 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.9003168763247735) THEN 22 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -1.0874041157558876) THEN 46 ELSE 47 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.6717871176899362) THEN 6 ELSE 7 END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_13" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 6 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.2778251965840658 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 7 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 3 AS parent_id, 0.5904404312372208 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 17 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 8 AS parent_id, 0.08624173411252824 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 18 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 9 AS parent_id, 0.2437617585659027 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 19 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 9 AS parent_id, 0.08886685785102216 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 20 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.07235094687113396 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 21 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 10 AS parent_id, -0.16378688897937538 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 22 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 11 AS parent_id, -0.17785070959259483 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 46 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 23 AS parent_id, -0.2611170622706413 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 47 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 23 AS parent_id, -0.3467451115067189 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 64 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 32 AS parent_id, -0.07489209748538476 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 66 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 33 AS parent_id, -0.08121572191871348 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 67 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 33 AS parent_id, -0.13498292073607446 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 130 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 65 AS parent_id, 0.04055355044068112 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 262 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 8 AS depth, 131 AS parent_id, 0.010120408366555754 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 263 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 8 AS depth, 131 AS parent_id, -0.047323842143470594 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_13" AS 
(SELECT "DT_node_lookup_13"."KEY" AS "KEY", "DT_node_lookup_13".node_id_2 AS node_id_2, "DT_node_data_13".node_id AS node_id, "DT_node_data_13".feature AS feature, "DT_node_data_13".threshold AS threshold, "DT_node_data_13".depth AS depth, "DT_node_data_13".parent_id AS parent_id, "DT_node_data_13"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_13" LEFT OUTER JOIN "DT_node_data_13" ON "DT_node_lookup_13".node_id_2 = "DT_node_data_13".node_id), 
"LGBM_Model_13" AS 
(SELECT "DT_Output_13"."KEY" AS "KEY", "DT_Output_13"."Estimator" AS "Estimator" 
FROM "DT_Output_13"), 
"DT_node_lookup_14" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.40828813336779196) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.2015599607314973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.3198262824956072) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.2455258313732251) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.34190700468288376) THEN 32 ELSE 33 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.8322364464647749) THEN 34 ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.926924979576161) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3394861578851025) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.25805811011644636) THEN 24 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.10026975722996248) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 0.2662726629536914) THEN 100 ELSE 101 END ELSE 51 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.6880407247594201) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.4786364712986806) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 1.2697891315308967) THEN 30 ELSE 31 END END END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_14" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 5 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 2 AS parent_id, 0.4838804786021893 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 9 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 4 AS parent_id, 0.24461604736068032 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 14 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 3 AS depth, 7 AS parent_id, -0.1374418410886493 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 24 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 12 AS parent_id, 0.01811343641685588 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 26 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 13 AS parent_id, -0.06997218775749207 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 27 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 13 AS parent_id, -0.16743840346893957 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 30 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 15 AS parent_id, -0.25352145356160627 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 31 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 15 AS parent_id, -0.3598889911174774 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 32 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 16 AS parent_id, 0.013426186778815463 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 33 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 16 AS parent_id, -0.0769073468943437 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 34 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 17 AS parent_id, 0.21766106594692577 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 35 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 17 AS parent_id, 0.06459294282380612 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 51 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 25 AS parent_id, -0.01978655711683477 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 100 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 50 AS parent_id, -0.07455676801147915 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 101 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 50 AS parent_id, -0.11477068863809109 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_14" AS 
(SELECT "DT_node_lookup_14"."KEY" AS "KEY", "DT_node_lookup_14".node_id_2 AS node_id_2, "DT_node_data_14".node_id AS node_id, "DT_node_data_14".feature AS feature, "DT_node_data_14".threshold AS threshold, "DT_node_data_14".depth AS depth, "DT_node_data_14".parent_id AS parent_id, "DT_node_data_14"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_14" LEFT OUTER JOIN "DT_node_data_14" ON "DT_node_lookup_14".node_id_2 = "DT_node_data_14".node_id), 
"LGBM_Model_14" AS 
(SELECT "DT_Output_14"."KEY" AS "KEY", "DT_Output_14"."Estimator" AS "Estimator" 
FROM "DT_Output_14"), 
"DT_node_lookup_15" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -1.0423616695141362) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 1.5818490921873434) THEN 4 ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.3394861578851025) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.44027352439065054) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.4180538423953485) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 0.30499008789040466) THEN 48 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.7082349106427404) THEN 98 ELSE 99 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -0.6340255676363853) THEN 50 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 0.22234373307645808) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.11115119129852609) THEN 204 ELSE 205 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.01024225352748477) THEN 206 ELSE 207 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.9597912072136919) THEN 26 ELSE 27 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.9777689480970188) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.6880407247594201) THEN 28 ELSE 29 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.8133035167396788) THEN 30 ELSE 31 END END END END AS node_id_2 
FROM tmp_20180417023622_35k7tg_ads_sca_2_out AS "ADS_sca_2_OUT"), 
"DT_node_data_15" AS 
(SELECT "Values".node_id AS node_id, CAST("Values".feature AS DOUBLE) AS feature, CAST("Values".threshold AS DOUBLE) AS threshold, CAST("Values".depth AS DOUBLE) AS depth, CAST("Values".parent_id AS DOUBLE) AS parent_id, CAST("Values"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT 4 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 2 AS parent_id, 0.22665122368489393 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 5 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 2 AS depth, 2 AS parent_id, 0.5859724743025644 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 26 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 13 AS parent_id, 0.25888366854190825 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 27 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 13 AS parent_id, 0.01886988653113013 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 28 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 14 AS parent_id, -0.0664735803604126 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 29 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 14 AS parent_id, -0.15823653076041602 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 30 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 15 AS parent_id, -0.1951319062556976 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 31 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 4 AS depth, 15 AS parent_id, -0.3281416402413295 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 48 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 24 AS parent_id, 0.12245360463857652 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 50 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 5 AS depth, 25 AS parent_id, -0.09622043544892223 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 98 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 49 AS parent_id, 0.015658052445009906 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 99 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 6 AS depth, 49 AS parent_id, -0.04483703297117483 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 204 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 102 AS parent_id, 0.024247768111526968 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 205 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 102 AS parent_id, -0.04361225565274557 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 206 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 103 AS parent_id, -0.04406948298215866 AS "Estimator" FROM SYSIBM.SYSDUMMY1 UNION ALL SELECT 207 AS node_id, NULL AS feature, CAST(NULL AS DOUBLE) AS threshold, 7 AS depth, 103 AS parent_id, -0.09185876397504694 AS "Estimator" FROM SYSIBM.SYSDUMMY1) AS "Values"), 
"DT_Output_15" AS 
(SELECT "DT_node_lookup_15"."KEY" AS "KEY", "DT_node_lookup_15".node_id_2 AS node_id_2, "DT_node_data_15".node_id AS node_id, "DT_node_data_15".feature AS feature, "DT_node_data_15".threshold AS threshold, "DT_node_data_15".depth AS depth, "DT_node_data_15".parent_id AS parent_id, "DT_node_data_15"."Estimator" AS "Estimator" 
FROM "DT_node_lookup_15" LEFT OUTER JOIN "DT_node_data_15" ON "DT_node_lookup_15".node_id_2 = "DT_node_data_15".node_id), 
"LGBM_Model_15" AS 
(SELECT "DT_Output_15"."KEY" AS "KEY", "DT_Output_15"."Estimator" AS "Estimator" 
FROM "DT_Output_15")
 SELECT "LGBM_B1"."KEY", "LGBM_B1"."Estimator" 
FROM (SELECT "LGBM_esu_1"."KEY" AS "KEY", "LGBM_esu_1"."Estimator" AS "Estimator" 
FROM (SELECT "LGBM_Model_10"."KEY" AS "KEY", "LGBM_Model_10"."Estimator" AS "Estimator" 
FROM "LGBM_Model_10" UNION ALL SELECT "LGBM_Model_11"."KEY" AS "KEY", "LGBM_Model_11"."Estimator" AS "Estimator" 
FROM "LGBM_Model_11" UNION ALL SELECT "LGBM_Model_12"."KEY" AS "KEY", "LGBM_Model_12"."Estimator" AS "Estimator" 
FROM "LGBM_Model_12" UNION ALL SELECT "LGBM_Model_13"."KEY" AS "KEY", "LGBM_Model_13"."Estimator" AS "Estimator" 
FROM "LGBM_Model_13" UNION ALL SELECT "LGBM_Model_14"."KEY" AS "KEY", "LGBM_Model_14"."Estimator" AS "Estimator" 
FROM "LGBM_Model_14" UNION ALL SELECT "LGBM_Model_15"."KEY" AS "KEY", "LGBM_Model_15"."Estimator" AS "Estimator" 
FROM "LGBM_Model_15") AS "LGBM_esu_1") AS "LGBM_B1"

-- Code For temporary table tmp_20180417023622_xvf8z2_lgbm_union part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180417023622_xvf8z2_lgbm_union (
	"KEY" BIGINT, 
	"Estimator" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180417023622_xvf8z2_lgbm_union part 2/2. Populate

INSERT INTO tmp_20180417023622_xvf8z2_lgbm_union SELECT "LGBM_Union"."KEY", "LGBM_Union"."Estimator" 
FROM (SELECT "LGBM_EnsembleUnion"."KEY" AS "KEY", "LGBM_EnsembleUnion"."Estimator" AS "Estimator" 
FROM (SELECT "LGBM_B0"."KEY" AS "KEY", "LGBM_B0"."Estimator" AS "Estimator" 
FROM tmp_20180417023622_hqnrdd_lgbm_b0 AS "LGBM_B0" UNION ALL SELECT "LGBM_B1"."KEY" AS "KEY", "LGBM_B1"."Estimator" AS "Estimator" 
FROM tmp_20180417023622_60s5ti_lgbm_b1 AS "LGBM_B1") AS "LGBM_EnsembleUnion") AS "LGBM_Union"

-- Code For temporary table tmp_20180417023622_2sf59i_lgbm_sum part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180417023622_2sf59i_lgbm_sum (
	"KEY" BIGINT, 
	"Estimator" FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180417023622_2sf59i_lgbm_sum part 2/2. Populate

INSERT INTO tmp_20180417023622_2sf59i_lgbm_sum SELECT "LGBM_sum"."KEY", "LGBM_sum"."Estimator" 
FROM (SELECT "T"."KEY" AS "KEY", CAST("T"."Estimator" AS DOUBLE) AS "Estimator" 
FROM (SELECT "LGBM_Union"."KEY" AS "KEY", sum("LGBM_Union"."Estimator") AS "Estimator" 
FROM tmp_20180417023622_xvf8z2_lgbm_union AS "LGBM_Union" GROUP BY "LGBM_Union"."KEY") AS "T") AS "LGBM_sum"

-- Model deployment code

SELECT "LGBM_sum"."KEY" AS "KEY", "LGBM_sum"."Estimator" AS "Estimator" 
FROM tmp_20180417023622_2sf59i_lgbm_sum AS "LGBM_sum"