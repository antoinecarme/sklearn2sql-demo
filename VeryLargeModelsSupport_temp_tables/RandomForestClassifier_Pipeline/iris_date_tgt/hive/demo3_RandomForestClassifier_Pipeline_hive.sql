-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : RandomForestClassifier_Pipeline
-- Dataset : iris_date_tgt
-- Database : hive


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180417042738_p3s4wl_ads_imp_1_out part 1/2. Create 

CREATE TEMPORARY TABLE `tmp_20180417042738_p3s4wl_ads_imp_1_out` STORED AS ORC AS SELECT `ADS_imp_1_OUT`.`KEY`, `ADS_imp_1_OUT`.`imputer_output_2`, `ADS_imp_1_OUT`.`imputer_output_3`, `ADS_imp_1_OUT`.`imputer_output_4`, `ADS_imp_1_OUT`.`imputer_output_5` 
FROM (SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 5.8474999999999975 ELSE `ADS`.`Feature_0` END AS `imputer_output_2`, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 3.0366666666666657 ELSE `ADS`.`Feature_1` END AS `imputer_output_3`, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 3.8450000000000006 ELSE `ADS`.`Feature_2` END AS `imputer_output_4`, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 1.245 ELSE `ADS`.`Feature_3` END AS `imputer_output_5` 
FROM `iris_date_tgt` AS `ADS`) AS `ADS_imp_1_OUT`

-- Code For temporary table tmp_20180417042738_p3s4wl_ads_imp_1_out part 2/2. Populate

SELECT * FROM `tmp_20180417042738_p3s4wl_ads_imp_1_out`

-- Code For temporary table tmp_20180417042738_youdcv_ads_sca_2_out part 1/2. Create 

CREATE TEMPORARY TABLE `tmp_20180417042738_youdcv_ads_sca_2_out` STORED AS ORC AS SELECT `ADS_sca_2_OUT`.`KEY`, `ADS_sca_2_OUT`.`scaler_output_2`, `ADS_sca_2_OUT`.`scaler_output_3`, `ADS_sca_2_OUT`.`scaler_output_4`, `ADS_sca_2_OUT`.`scaler_output_5` 
FROM (SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.`imputer_output_2` AS FLOAT) - 5.8474999999999975) / 0.827039146594646 AS `scaler_output_2`, (CAST(`ADS_imp_1_OUT`.`imputer_output_3` AS FLOAT) - 3.0366666666666657) / 0.43625935201691934 AS `scaler_output_3`, (CAST(`ADS_imp_1_OUT`.`imputer_output_4` AS FLOAT) - 3.8450000000000006) / 1.709817241695732 AS `scaler_output_4`, (CAST(`ADS_imp_1_OUT`.`imputer_output_5` AS FLOAT) - 1.245) / 0.7498722113355939 AS `scaler_output_5` 
FROM `tmp_20180417042738_p3s4wl_ads_imp_1_out` AS `ADS_imp_1_OUT`) AS `ADS_sca_2_OUT`

-- Code For temporary table tmp_20180417042738_youdcv_ads_sca_2_out part 2/2. Populate

SELECT * FROM `tmp_20180417042738_youdcv_ads_sca_2_out`

-- Code For temporary table tmp_20180417042738_esfsxw_rf_b0 part 1/2. Create 

CREATE TEMPORARY TABLE `tmp_20180417042738_esfsxw_rf_b0` STORED AS ORC AS WITH `DT_node_lookup` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_2` <= -0.48063021898269653) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= -0.5934344530105591) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.47341400384902954) THEN 4 ELSE 5 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.6734480857849121) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= -0.7267905473709106) THEN 8 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.6462678909301758) THEN 10 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_3` <= -1.0009336471557617) THEN 12 ELSE 13 END END END ELSE 14 END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 2 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 23 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 5 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 8 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 3 AS `depth`, 7 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 10 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 19 AS `count`, 4 AS `depth`, 9 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 12 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 11 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 13 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 11 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 14 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 24 AS `count`, 2 AS `depth`, 6 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.`node_id_2` AS `node_id_2`, `DT_node_data`.`node_id` AS `node_id`, `DT_node_data`.`feature` AS `feature`, `DT_node_data`.`threshold` AS `threshold`, `DT_node_data`.`count` AS `count`, `DT_node_data`.`depth` AS `depth`, `DT_node_data`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data`.`Decision` AS `Decision`, `DT_node_data`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.`node_id_2` = `DT_node_data`.`node_id`), 
`RF_Model_0` AS 
(SELECT `DT_Output`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output`), 
`DT_node_lookup_1` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= -0.7281479835510254) THEN 1 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.5877821445465088) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.6067700386047363) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_3` <= 0.1451735943555832) THEN 6 ELSE 7 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.6734480857849121) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_3` <= -1.5739872455596924) THEN 10 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.7047536373138428) THEN 12 ELSE 13 END END ELSE 14 END END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_1` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 1 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 20 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 18 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 7 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 10 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 9 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 12 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 5 AS `depth`, 11 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 13 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 5 AS `depth`, 11 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 14 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 23 AS `count`, 3 AS `depth`, 8 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_1` AS 
(SELECT `DT_node_lookup_1`.`KEY` AS `KEY`, `DT_node_lookup_1`.`node_id_2` AS `node_id_2`, `DT_node_data_1`.`node_id` AS `node_id`, `DT_node_data_1`.`feature` AS `feature`, `DT_node_data_1`.`threshold` AS `threshold`, `DT_node_data_1`.`count` AS `count`, `DT_node_data_1`.`depth` AS `depth`, `DT_node_data_1`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_1`.`Decision` AS `Decision`, `DT_node_data_1`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_1` LEFT OUTER JOIN `DT_node_data_1` ON `DT_node_lookup_1`.`node_id_2` = `DT_node_data_1`.`node_id`), 
`RF_Model_1` AS 
(SELECT `DT_Output_1`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_1`), 
`DT_node_lookup_2` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.6734480857849121) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= -0.5934344530105591) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.273379921913147) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_3` <= -0.42788004875183105) THEN 6 ELSE 7 END END END ELSE 8 END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_2` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 2 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 22 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 19 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 3 AS `count`, 4 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 7 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 8 AS `count`, 4 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 8 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 23 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_2` AS 
(SELECT `DT_node_lookup_2`.`KEY` AS `KEY`, `DT_node_lookup_2`.`node_id_2` AS `node_id_2`, `DT_node_data_2`.`node_id` AS `node_id`, `DT_node_data_2`.`feature` AS `feature`, `DT_node_data_2`.`threshold` AS `threshold`, `DT_node_data_2`.`count` AS `count`, `DT_node_data_2`.`depth` AS `depth`, `DT_node_data_2`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_2`.`Decision` AS `Decision`, `DT_node_data_2`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_2` LEFT OUTER JOIN `DT_node_data_2` ON `DT_node_lookup_2`.`node_id_2` = `DT_node_data_2`.`node_id`), 
`RF_Model_2` AS 
(SELECT `DT_Output_2`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_2`), 
`DT_node_lookup_3` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= -0.6601125001907349) THEN 1 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.5877821445465088) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.5400919914245605) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.47081053256988525) THEN 6 ELSE 7 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.7047536373138428) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_2` <= 0.7889590263366699) THEN 10 ELSE 11 END ELSE 12 END END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_3` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 1 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 25 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 24 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 7 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 10 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 5 AS `count`, 4 AS `depth`, 9 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 11 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 4 AS `depth`, 9 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 12 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 19 AS `count`, 3 AS `depth`, 8 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_3` AS 
(SELECT `DT_node_lookup_3`.`KEY` AS `KEY`, `DT_node_lookup_3`.`node_id_2` AS `node_id_2`, `DT_node_data_3`.`node_id` AS `node_id`, `DT_node_data_3`.`feature` AS `feature`, `DT_node_data_3`.`threshold` AS `threshold`, `DT_node_data_3`.`count` AS `count`, `DT_node_data_3`.`depth` AS `depth`, `DT_node_data_3`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_3`.`Decision` AS `Decision`, `DT_node_data_3`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_3` LEFT OUTER JOIN `DT_node_data_3` ON `DT_node_lookup_3`.`node_id_2` = `DT_node_data_3`.`node_id`), 
`RF_Model_3` AS 
(SELECT `DT_Output_3`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_3`), 
`DT_node_lookup_4` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= -0.8158766627311707) THEN 1 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_2` <= -0.2388036847114563) THEN 3 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.6734480857849121) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.6462678909301758) THEN 6 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_3` <= -0.31326931715011597) THEN 8 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_2` <= 1.3330687284469604) THEN 10 ELSE 11 END END END ELSE 12 END END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_4` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 1 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 24 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 3 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 8 AS `count`, 2 AS `depth`, 2 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 14 AS `count`, 4 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 8 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 3 AS `count`, 5 AS `depth`, 7 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 10 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 9 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 11 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 9 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 12 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 23 AS `count`, 3 AS `depth`, 4 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_4` AS 
(SELECT `DT_node_lookup_4`.`KEY` AS `KEY`, `DT_node_lookup_4`.`node_id_2` AS `node_id_2`, `DT_node_data_4`.`node_id` AS `node_id`, `DT_node_data_4`.`feature` AS `feature`, `DT_node_data_4`.`threshold` AS `threshold`, `DT_node_data_4`.`count` AS `count`, `DT_node_data_4`.`depth` AS `depth`, `DT_node_data_4`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_4`.`Decision` AS `Decision`, `DT_node_data_4`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_4` LEFT OUTER JOIN `DT_node_data_4` ON `DT_node_lookup_4`.`node_id_2` = `DT_node_data_4`.`node_id`), 
`RF_Model_4` AS 
(SELECT `DT_Output_4`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_4`), 
`DT_node_lookup_5` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_2` <= -0.48063021898269653) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= -0.8743624687194824) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_3` <= -1.3447659015655518) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.2067018747329712) THEN 6 ELSE 7 END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.529296338558197) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= -0.7934684753417969) THEN 10 ELSE 11 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.6462678909301758) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.5400920510292053) THEN 14 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_3` <= 0.1451735943555832) THEN 16 ELSE 17 END END ELSE 18 END END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_5` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 2 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 18 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 3 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 7 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 10 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 3 AS `depth`, 9 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 11 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 23 AS `count`, 3 AS `depth`, 9 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 14 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 13 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 16 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 3 AS `count`, 5 AS `depth`, 15 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 17 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 15 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 18 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 25 AS `count`, 3 AS `depth`, 12 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_5` AS 
(SELECT `DT_node_lookup_5`.`KEY` AS `KEY`, `DT_node_lookup_5`.`node_id_2` AS `node_id_2`, `DT_node_data_5`.`node_id` AS `node_id`, `DT_node_data_5`.`feature` AS `feature`, `DT_node_data_5`.`threshold` AS `threshold`, `DT_node_data_5`.`count` AS `count`, `DT_node_data_5`.`depth` AS `depth`, `DT_node_data_5`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_5`.`Decision` AS `Decision`, `DT_node_data_5`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_5` LEFT OUTER JOIN `DT_node_data_5` ON `DT_node_lookup_5`.`node_id_2` = `DT_node_data_5`.`node_id`), 
`RF_Model_5` AS 
(SELECT `DT_Output_5`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_5`), 
`DT_node_lookup_6` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= -0.5934344530105591) THEN 1 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.5877821445465088) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.5400919914245605) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_3` <= 0.1451735943555832) THEN 6 ELSE 7 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.40673595666885376) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.6755107641220093) THEN 10 ELSE 11 END ELSE 12 END END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_6` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 1 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 19 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 28 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 4 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 7 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 10 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 9 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 11 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 9 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 12 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 24 AS `count`, 3 AS `depth`, 8 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_6` AS 
(SELECT `DT_node_lookup_6`.`KEY` AS `KEY`, `DT_node_lookup_6`.`node_id_2` AS `node_id_2`, `DT_node_data_6`.`node_id` AS `node_id`, `DT_node_data_6`.`feature` AS `feature`, `DT_node_data_6`.`threshold` AS `threshold`, `DT_node_data_6`.`count` AS `count`, `DT_node_data_6`.`depth` AS `depth`, `DT_node_data_6`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_6`.`Decision` AS `Decision`, `DT_node_data_6`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_6` LEFT OUTER JOIN `DT_node_data_6` ON `DT_node_lookup_6`.`node_id_2` = `DT_node_data_6`.`node_id`), 
`RF_Model_6` AS 
(SELECT `DT_Output_6`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_6`), 
`DT_node_lookup_7` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= -0.8158766627311707) THEN 1 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.5400919914245605) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.6170250177383423) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.5877821445465088) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_2` <= 0.12393608689308167) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_3` <= -0.42788004875183105) THEN 9 ELSE 10 END ELSE 11 END ELSE 12 END END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_7` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 1 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 28 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 25 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 3 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 9 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 8 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 10 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 8 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 11 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 7 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 12 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 24 AS `count`, 3 AS `depth`, 6 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_7` AS 
(SELECT `DT_node_lookup_7`.`KEY` AS `KEY`, `DT_node_lookup_7`.`node_id_2` AS `node_id_2`, `DT_node_data_7`.`node_id` AS `node_id`, `DT_node_data_7`.`feature` AS `feature`, `DT_node_data_7`.`threshold` AS `threshold`, `DT_node_data_7`.`count` AS `count`, `DT_node_data_7`.`depth` AS `depth`, `DT_node_data_7`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_7`.`Decision` AS `Decision`, `DT_node_data_7`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_7` LEFT OUTER JOIN `DT_node_data_7` ON `DT_node_lookup_7`.`node_id_2` = `DT_node_data_7`.`node_id`), 
`RF_Model_7` AS 
(SELECT `DT_Output_7`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_7`), 
`DT_node_lookup_8` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.5877821445465088) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_2` <= -0.48063021898269653) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= -0.7267905473709106) THEN 3 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.20762452483177185) THEN 5 ELSE 6 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= -0.6696621775627136) THEN 8 ELSE 9 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.6462678909301758) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_3` <= 0.030562859028577805) THEN 12 ELSE 13 END ELSE 14 END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_8` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 3 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 18 AS `count`, 3 AS `depth`, 2 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 5 AS `count`, 4 AS `depth`, 4 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 4 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 8 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 7 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 9 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 18 AS `count`, 3 AS `depth`, 7 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 12 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 3 AS `depth`, 11 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 13 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 11 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 14 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 30 AS `count`, 2 AS `depth`, 10 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_8` AS 
(SELECT `DT_node_lookup_8`.`KEY` AS `KEY`, `DT_node_lookup_8`.`node_id_2` AS `node_id_2`, `DT_node_data_8`.`node_id` AS `node_id`, `DT_node_data_8`.`feature` AS `feature`, `DT_node_data_8`.`threshold` AS `threshold`, `DT_node_data_8`.`count` AS `count`, `DT_node_data_8`.`depth` AS `depth`, `DT_node_data_8`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_8`.`Decision` AS `Decision`, `DT_node_data_8`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_8` LEFT OUTER JOIN `DT_node_data_8` ON `DT_node_lookup_8`.`node_id_2` = `DT_node_data_8`.`node_id`), 
`RF_Model_8` AS 
(SELECT `DT_Output_8`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_8`), 
`DT_node_lookup_9` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= -0.5934344530105591) THEN 1 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.40673595666885376) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.6462678909301758) THEN 4 ELSE 5 END ELSE 6 END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_9` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 1 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 23 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 25 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 26 AS `count`, 2 AS `depth`, 2 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_9` AS 
(SELECT `DT_node_lookup_9`.`KEY` AS `KEY`, `DT_node_lookup_9`.`node_id_2` AS `node_id_2`, `DT_node_data_9`.`node_id` AS `node_id`, `DT_node_data_9`.`feature` AS `feature`, `DT_node_data_9`.`threshold` AS `threshold`, `DT_node_data_9`.`count` AS `count`, `DT_node_data_9`.`depth` AS `depth`, `DT_node_data_9`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_9`.`Decision` AS `Decision`, `DT_node_data_9`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_9` LEFT OUTER JOIN `DT_node_data_9` ON `DT_node_lookup_9`.`node_id_2` = `DT_node_data_9`.`node_id`), 
`RF_Model_9` AS 
(SELECT `DT_Output_9`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_9`)
 SELECT `RF_B0`.`KEY`, `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` 
FROM (SELECT `RF_esu_0`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM (SELECT `RF_Model_0`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_0` UNION ALL SELECT `RF_Model_1`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_1` UNION ALL SELECT `RF_Model_2`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_2` UNION ALL SELECT `RF_Model_3`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_3` UNION ALL SELECT `RF_Model_4`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_4` UNION ALL SELECT `RF_Model_5`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_5` UNION ALL SELECT `RF_Model_6`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_6` UNION ALL SELECT `RF_Model_7`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_7` UNION ALL SELECT `RF_Model_8`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_8` UNION ALL SELECT `RF_Model_9`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_9`) AS `RF_esu_0`) AS `RF_B0`

-- Code For temporary table tmp_20180417042738_esfsxw_rf_b0 part 2/2. Populate

SELECT * FROM `tmp_20180417042738_esfsxw_rf_b0`

-- Code For temporary table tmp_20180417042738_38qkz3_rf_b1 part 1/2. Create 

CREATE TEMPORARY TABLE `tmp_20180417042738_38qkz3_rf_b1` STORED AS ORC AS WITH `DT_node_lookup_10` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_2` <= -0.48063021898269653) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= -0.7281479835510254) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.47341400384902954) THEN 4 ELSE 5 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.5877821445465088) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_3` <= 1.1766700744628906) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.529296338558197) THEN 9 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_2` <= 0.12393608689308167) THEN 11 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.47341400384902954) THEN 13 ELSE 14 END END END ELSE 15 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.6462678909301758) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_2` <= 0.42621922492980957) THEN 18 ELSE 19 END ELSE 20 END END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_10` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 2 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 22 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 4 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 9 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 21 AS `count`, 4 AS `depth`, 8 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 11 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 10 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 13 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 12 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 14 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 12 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 15 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 3 AS `depth`, 7 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 18 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 4 AS `depth`, 17 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 19 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 17 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 20 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 19 AS `count`, 3 AS `depth`, 16 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_10` AS 
(SELECT `DT_node_lookup_10`.`KEY` AS `KEY`, `DT_node_lookup_10`.`node_id_2` AS `node_id_2`, `DT_node_data_10`.`node_id` AS `node_id`, `DT_node_data_10`.`feature` AS `feature`, `DT_node_data_10`.`threshold` AS `threshold`, `DT_node_data_10`.`count` AS `count`, `DT_node_data_10`.`depth` AS `depth`, `DT_node_data_10`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_10`.`Decision` AS `Decision`, `DT_node_data_10`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_10` LEFT OUTER JOIN `DT_node_data_10` ON `DT_node_lookup_10`.`node_id_2` = `DT_node_data_10`.`node_id`), 
`RF_Model_10` AS 
(SELECT `DT_Output_10`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_10`), 
`DT_node_lookup_11` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.6462678909301758) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= -0.8158766627311707) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.8734821677207947) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_2` <= -1.0851964950561523) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_3` <= -1.3447659015655518) THEN 6 ELSE 7 END ELSE 8 END ELSE 9 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.7047536373138428) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.7401261329650879) THEN 12 ELSE 13 END ELSE 14 END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_11` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 2 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 21 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 7 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 8 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 24 AS `count`, 4 AS `depth`, 4 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 9 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 12 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 11 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 13 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 3 AS `depth`, 11 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 14 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 23 AS `count`, 2 AS `depth`, 10 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_11` AS 
(SELECT `DT_node_lookup_11`.`KEY` AS `KEY`, `DT_node_lookup_11`.`node_id_2` AS `node_id_2`, `DT_node_data_11`.`node_id` AS `node_id`, `DT_node_data_11`.`feature` AS `feature`, `DT_node_data_11`.`threshold` AS `threshold`, `DT_node_data_11`.`count` AS `count`, `DT_node_data_11`.`depth` AS `depth`, `DT_node_data_11`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_11`.`Decision` AS `Decision`, `DT_node_data_11`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_11` LEFT OUTER JOIN `DT_node_data_11` ON `DT_node_lookup_11`.`node_id_2` = `DT_node_data_11`.`node_id`), 
`RF_Model_11` AS 
(SELECT `DT_Output_11`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_11`), 
`DT_node_lookup_12` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= -0.6601125001907349) THEN 1 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.5400919914245605) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.6462678909301758) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.7047536373138428) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_2` <= 0.7889590263366699) THEN 8 ELSE 9 END ELSE 10 END END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_12` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 1 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 19 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 31 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 4 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 8 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 6 AS `count`, 4 AS `depth`, 7 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 9 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 7 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 10 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 18 AS `count`, 3 AS `depth`, 6 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_12` AS 
(SELECT `DT_node_lookup_12`.`KEY` AS `KEY`, `DT_node_lookup_12`.`node_id_2` AS `node_id_2`, `DT_node_data_12`.`node_id` AS `node_id`, `DT_node_data_12`.`feature` AS `feature`, `DT_node_data_12`.`threshold` AS `threshold`, `DT_node_data_12`.`count` AS `count`, `DT_node_data_12`.`depth` AS `depth`, `DT_node_data_12`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_12`.`Decision` AS `Decision`, `DT_node_data_12`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_12` LEFT OUTER JOIN `DT_node_data_12` ON `DT_node_lookup_12`.`node_id_2` = `DT_node_data_12`.`node_id`), 
`RF_Model_12` AS 
(SELECT `DT_Output_12`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_12`), 
`DT_node_lookup_13` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.5877821445465088) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= -0.8158766627311707) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.5400919914245605) THEN 4 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.47081053256988525) THEN 6 ELSE 7 END END END ELSE 8 END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_13` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 2 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 23 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 22 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 7 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 5 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 8 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 29 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_13` AS 
(SELECT `DT_node_lookup_13`.`KEY` AS `KEY`, `DT_node_lookup_13`.`node_id_2` AS `node_id_2`, `DT_node_data_13`.`node_id` AS `node_id`, `DT_node_data_13`.`feature` AS `feature`, `DT_node_data_13`.`threshold` AS `threshold`, `DT_node_data_13`.`count` AS `count`, `DT_node_data_13`.`depth` AS `depth`, `DT_node_data_13`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_13`.`Decision` AS `Decision`, `DT_node_data_13`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_13` LEFT OUTER JOIN `DT_node_data_13` ON `DT_node_lookup_13`.`node_id_2` = `DT_node_data_13`.`node_id`), 
`RF_Model_13` AS 
(SELECT `DT_Output_13`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_13`), 
`DT_node_lookup_14` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= -0.8158766627311707) THEN 1 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.6462678909301758) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.6067700386047363) THEN 4 ELSE 5 END ELSE 6 END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_14` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 1 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 23 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 24 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 30 AS `count`, 2 AS `depth`, 2 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_14` AS 
(SELECT `DT_node_lookup_14`.`KEY` AS `KEY`, `DT_node_lookup_14`.`node_id_2` AS `node_id_2`, `DT_node_data_14`.`node_id` AS `node_id`, `DT_node_data_14`.`feature` AS `feature`, `DT_node_data_14`.`threshold` AS `threshold`, `DT_node_data_14`.`count` AS `count`, `DT_node_data_14`.`depth` AS `depth`, `DT_node_data_14`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_14`.`Decision` AS `Decision`, `DT_node_data_14`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_14` LEFT OUTER JOIN `DT_node_data_14` ON `DT_node_lookup_14`.`node_id_2` = `DT_node_data_14`.`node_id`), 
`RF_Model_14` AS 
(SELECT `DT_Output_14`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_14`), 
`DT_node_lookup_15` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= -0.8158766627311707) THEN 1 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.6734480857849121) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.8509681224822998) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.5400919914245605) THEN 5 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_4` <= 0.529296338558197) THEN 7 ELSE 8 END END ELSE 9 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_5` <= 0.8068041801452637) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_output_2` <= 0.12393608689308167) THEN 12 ELSE 13 END ELSE 14 END END END AS `node_id_2` 
FROM `tmp_20180417042738_youdcv_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_15` AS 
(SELECT `Values`.`node_id` AS `node_id`, CAST(`Values`.`feature` AS FLOAT) AS `feature`, CAST(`Values`.`threshold` AS FLOAT) AS `threshold`, CAST(`Values`.`count` AS FLOAT) AS `count`, CAST(`Values`.`depth` AS FLOAT) AS `depth`, CAST(`Values`.`parent_id` AS FLOAT) AS `parent_id`, CAST(`Proba_0.0` AS FLOAT) AS `Proba_0.0`, CAST(`LogProba_0.0` AS FLOAT) AS `LogProba_0.0`, CAST(`Proba_1.0` AS FLOAT) AS `Proba_1.0`, CAST(`LogProba_1.0` AS FLOAT) AS `LogProba_1.0`, CAST(`Proba_2.0` AS FLOAT) AS `Proba_2.0`, CAST(`LogProba_2.0` AS FLOAT) AS `LogProba_2.0`, CAST(`Values`.`Decision` AS FLOAT) AS `Decision`, CAST(`Values`.`DecisionProba` AS FLOAT) AS `DecisionProba` 
FROM (SELECT 1 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 24 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 0.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 23 AS `count`, 4 AS `depth`, 4 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 7 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 6 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 8 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 6 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 9 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 12 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 11 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 0.0 AS `Proba_2.0`, -1.79769313486231e+308 AS `LogProba_2.0`, 1.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 13 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 5 AS `count`, 4 AS `depth`, 11 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 14 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 17 AS `count`, 3 AS `depth`, 10 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 1.0 AS `Proba_2.0`, 0.0 AS `LogProba_2.0`, 2.0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_15` AS 
(SELECT `DT_node_lookup_15`.`KEY` AS `KEY`, `DT_node_lookup_15`.`node_id_2` AS `node_id_2`, `DT_node_data_15`.`node_id` AS `node_id`, `DT_node_data_15`.`feature` AS `feature`, `DT_node_data_15`.`threshold` AS `threshold`, `DT_node_data_15`.`count` AS `count`, `DT_node_data_15`.`depth` AS `depth`, `DT_node_data_15`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Proba_2.0` AS `Proba_2.0`, `LogProba_2.0` AS `LogProba_2.0`, `DT_node_data_15`.`Decision` AS `Decision`, `DT_node_data_15`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_15` LEFT OUTER JOIN `DT_node_data_15` ON `DT_node_lookup_15`.`node_id_2` = `DT_node_data_15`.`node_id`), 
`RF_Model_15` AS 
(SELECT `DT_Output_15`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, `Proba_0.0` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_0.0` AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1.0` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1.0` AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, `Proba_2.0` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_2.0` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `DT_Output_15`)
 SELECT `RF_B1`.`KEY`, `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` 
FROM (SELECT `RF_esu_1`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM (SELECT `RF_Model_10`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_10` UNION ALL SELECT `RF_Model_11`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_11` UNION ALL SELECT `RF_Model_12`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_12` UNION ALL SELECT `RF_Model_13`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_13` UNION ALL SELECT `RF_Model_14`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_14` UNION ALL SELECT `RF_Model_15`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `RF_Model_15`) AS `RF_esu_1`) AS `RF_B1`

-- Code For temporary table tmp_20180417042738_38qkz3_rf_b1 part 2/2. Populate

SELECT * FROM `tmp_20180417042738_38qkz3_rf_b1`

-- Code For temporary table tmp_20180417042738_lvcqwj_rf_union part 1/2. Create 

CREATE TEMPORARY TABLE `tmp_20180417042738_lvcqwj_rf_union` STORED AS ORC AS SELECT `RF_Union`.`KEY`, `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` 
FROM (SELECT `RF_EnsembleUnion`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM (SELECT `RF_B0`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `tmp_20180417042738_esfsxw_rf_b0` AS `RF_B0` UNION ALL SELECT `RF_B1`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `tmp_20180417042738_38qkz3_rf_b1` AS `RF_B1`) AS `RF_EnsembleUnion`) AS `RF_Union`

-- Code For temporary table tmp_20180417042738_lvcqwj_rf_union part 2/2. Populate

SELECT * FROM `tmp_20180417042738_lvcqwj_rf_union`

-- Code For temporary table tmp_20180417042738_ofrrav_rf_avg part 1/2. Create 

CREATE TEMPORARY TABLE `tmp_20180417042738_ofrrav_rf_avg` STORED AS ORC AS SELECT `RF_avg`.`KEY`, `Score_1789-07-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` 
FROM (SELECT `T`.`KEY` AS `KEY`, CAST(`Score_1789-07-14T00:00:00.000000000` AS FLOAT) AS `Score_1789-07-14T00:00:00.000000000`, CAST(`Proba_1789-07-14T00:00:00.000000000` AS FLOAT) AS `Proba_1789-07-14T00:00:00.000000000`, CAST(`LogProba_1789-07-14T00:00:00.000000000` AS FLOAT) AS `LogProba_1789-07-14T00:00:00.000000000`, CAST(`Score_1789-08-14T00:00:00.000000000` AS FLOAT) AS `Score_1789-08-14T00:00:00.000000000`, CAST(`Proba_1789-08-14T00:00:00.000000000` AS FLOAT) AS `Proba_1789-08-14T00:00:00.000000000`, CAST(`LogProba_1789-08-14T00:00:00.000000000` AS FLOAT) AS `LogProba_1789-08-14T00:00:00.000000000`, CAST(`Score_1789-09-14T00:00:00.000000000` AS FLOAT) AS `Score_1789-09-14T00:00:00.000000000`, CAST(`Proba_1789-09-14T00:00:00.000000000` AS FLOAT) AS `Proba_1789-09-14T00:00:00.000000000`, CAST(`LogProba_1789-09-14T00:00:00.000000000` AS FLOAT) AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM (SELECT `RF_Union`.`KEY` AS `KEY`, avg(CAST(`Score_1789-07-14T00:00:00.000000000` AS FLOAT)) AS `Score_1789-07-14T00:00:00.000000000`, avg(CAST(`Proba_1789-07-14T00:00:00.000000000` AS FLOAT)) AS `Proba_1789-07-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `LogProba_1789-07-14T00:00:00.000000000`, avg(CAST(`Score_1789-08-14T00:00:00.000000000` AS FLOAT)) AS `Score_1789-08-14T00:00:00.000000000`, avg(CAST(`Proba_1789-08-14T00:00:00.000000000` AS FLOAT)) AS `Proba_1789-08-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `LogProba_1789-08-14T00:00:00.000000000`, avg(CAST(`Score_1789-09-14T00:00:00.000000000` AS FLOAT)) AS `Score_1789-09-14T00:00:00.000000000`, avg(CAST(`Proba_1789-09-14T00:00:00.000000000` AS FLOAT)) AS `Proba_1789-09-14T00:00:00.000000000`, CAST(NULL AS FLOAT) AS `LogProba_1789-09-14T00:00:00.000000000` 
FROM `tmp_20180417042738_lvcqwj_rf_union` AS `RF_Union` GROUP BY `RF_Union`.`KEY`) AS `T`) AS `RF_avg`

-- Code For temporary table tmp_20180417042738_ofrrav_rf_avg part 2/2. Populate

SELECT * FROM `tmp_20180417042738_ofrrav_rf_avg`

-- Model deployment code

WITH `orig_cte` AS 
(SELECT `RF_avg`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000`, CAST(NULL AS BIGINT) AS `Decision`, CAST(NULL AS FLOAT) AS `DecisionProba` 
FROM `tmp_20180417042738_ofrrav_rf_avg` AS `RF_avg`), 
`score_class_union` AS 
(SELECT `scu`.`KEY_u` AS `KEY_u`, `scu`.`class` AS `class`, `scu`.`LogProba` AS `LogProba`, `scu`.`Proba` AS `Proba`, `scu`.`Score` AS `Score` 
FROM (SELECT `orig_cte`.`KEY` AS `KEY_u`, '1789-07-14T00:00:00.000000000' AS `class`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba`, `Score_1789-07-14T00:00:00.000000000` AS `Score` 
FROM `orig_cte` UNION ALL SELECT `orig_cte`.`KEY` AS `KEY_u`, '1789-08-14T00:00:00.000000000' AS `class`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba`, `Score_1789-08-14T00:00:00.000000000` AS `Score` 
FROM `orig_cte` UNION ALL SELECT `orig_cte`.`KEY` AS `KEY_u`, '1789-09-14T00:00:00.000000000' AS `class`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba`, `Score_1789-09-14T00:00:00.000000000` AS `Score` 
FROM `orig_cte`) AS `scu`), 
`score_max` AS 
(SELECT `orig_cte`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000`, `orig_cte`.`Decision` AS `Decision`, `orig_cte`.`DecisionProba` AS `DecisionProba`, `max_select`.`KEY_m` AS `KEY_m`, `max_select`.`max_Proba` AS `max_Proba` 
FROM `orig_cte` LEFT OUTER JOIN (SELECT `score_class_union`.`KEY_u` AS `KEY_m`, max(`score_class_union`.`Proba`) AS `max_Proba` 
FROM `score_class_union` GROUP BY `score_class_union`.`KEY_u`) AS `max_select` ON `orig_cte`.`KEY` = `max_select`.`KEY_m`), 
`union_with_max` AS 
(SELECT `score_class_union`.`KEY_u` AS `KEY_u`, `score_class_union`.`class` AS `class`, `score_class_union`.`LogProba` AS `LogProba`, `score_class_union`.`Proba` AS `Proba`, `score_class_union`.`Score` AS `Score`, `score_max`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000`, `score_max`.`Decision` AS `Decision`, `score_max`.`DecisionProba` AS `DecisionProba`, `score_max`.`KEY_m` AS `KEY_m`, `score_max`.`max_Proba` AS `max_Proba` 
FROM `score_class_union` LEFT OUTER JOIN `score_max` ON `score_class_union`.`KEY_u` = `score_max`.`KEY`), 
`arg_max_cte` AS 
(SELECT `score_max`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, `LogProba_1789-07-14T00:00:00.000000000` AS `LogProba_1789-07-14T00:00:00.000000000`, `LogProba_1789-08-14T00:00:00.000000000` AS `LogProba_1789-08-14T00:00:00.000000000`, `LogProba_1789-09-14T00:00:00.000000000` AS `LogProba_1789-09-14T00:00:00.000000000`, `score_max`.`Decision` AS `Decision`, `score_max`.`DecisionProba` AS `DecisionProba`, `score_max`.`KEY_m` AS `KEY_m`, `score_max`.`max_Proba` AS `max_Proba`, `arg_max_t_Proba`.`KEY_Proba` AS `KEY_Proba`, `arg_max_t_Proba`.`arg_max_Proba` AS `arg_max_Proba` 
FROM `score_max` LEFT OUTER JOIN (SELECT `union_with_max`.`KEY` AS `KEY_Proba`, min(`union_with_max`.`class`) AS `arg_max_Proba` 
FROM `union_with_max` 
WHERE `union_with_max`.`Proba` >= `union_with_max`.`max_Proba` GROUP BY `union_with_max`.`KEY`) AS `arg_max_t_Proba` ON `score_max`.`KEY` = `arg_max_t_Proba`.`KEY_Proba`)
 SELECT `arg_max_cte`.`KEY` AS `KEY`, `Score_1789-07-14T00:00:00.000000000` AS `Score_1789-07-14T00:00:00.000000000`, `Score_1789-08-14T00:00:00.000000000` AS `Score_1789-08-14T00:00:00.000000000`, `Score_1789-09-14T00:00:00.000000000` AS `Score_1789-09-14T00:00:00.000000000`, `Proba_1789-07-14T00:00:00.000000000` AS `Proba_1789-07-14T00:00:00.000000000`, `Proba_1789-08-14T00:00:00.000000000` AS `Proba_1789-08-14T00:00:00.000000000`, `Proba_1789-09-14T00:00:00.000000000` AS `Proba_1789-09-14T00:00:00.000000000`, CASE WHEN (`Proba_1789-07-14T00:00:00.000000000` IS NULL OR `Proba_1789-07-14T00:00:00.000000000` > 0.0) THEN log(`Proba_1789-07-14T00:00:00.000000000`) ELSE -1.79769313486231e+308 END AS `LogProba_1789-07-14T00:00:00.000000000`, CASE WHEN (`Proba_1789-08-14T00:00:00.000000000` IS NULL OR `Proba_1789-08-14T00:00:00.000000000` > 0.0) THEN log(`Proba_1789-08-14T00:00:00.000000000`) ELSE -1.79769313486231e+308 END AS `LogProba_1789-08-14T00:00:00.000000000`, CASE WHEN (`Proba_1789-09-14T00:00:00.000000000` IS NULL OR `Proba_1789-09-14T00:00:00.000000000` > 0.0) THEN log(`Proba_1789-09-14T00:00:00.000000000`) ELSE -1.79769313486231e+308 END AS `LogProba_1789-09-14T00:00:00.000000000`, `arg_max_cte`.`arg_max_Proba` AS `Decision`, `arg_max_cte`.`max_Proba` AS `DecisionProba` 
FROM `arg_max_cte`