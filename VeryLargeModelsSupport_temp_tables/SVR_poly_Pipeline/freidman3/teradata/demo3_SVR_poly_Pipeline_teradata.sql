-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : SVR_poly_Pipeline
-- Dataset : freidman3
-- Database : teradata


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180417041939_kthnqg_ads_ part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180417041939_kthnqg_ads_  (
	"KEY" BIGINT, 
	imputer_output_2 FLOAT, 
	imputer_output_3 FLOAT, 
	imputer_output_4 FLOAT, 
	imputer_output_5 FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180417041939_kthnqg_ads_ part 2/2. Populate

INSERT INTO tmp_20180417041939_kthnqg_ads_ ("KEY", imputer_output_2, imputer_output_3, imputer_output_4, imputer_output_5) SELECT "U"."KEY", "U".imputer_output_2, "U".imputer_output_3, "U".imputer_output_4, "U".imputer_output_5 
FROM (SELECT "ADS_imp_1_OUT"."KEY", "ADS_imp_1_OUT".imputer_output_2, "ADS_imp_1_OUT".imputer_output_3, "ADS_imp_1_OUT".imputer_output_4, "ADS_imp_1_OUT".imputer_output_5 
FROM (SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 43.79128122207401 ELSE "ADS"."Feature_0" END AS imputer_output_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 945.9672833084396 ELSE "ADS"."Feature_1" END AS imputer_output_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 0.5310009099975209 ELSE "ADS"."Feature_2" END AS imputer_output_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 6.139967152050499 ELSE "ADS"."Feature_3" END AS imputer_output_5 
FROM freidman3 AS "ADS") AS "ADS_imp_1_OUT") AS "U"

-- Code For temporary table tmp_20180417041939_sdc3hg_ads_ part 1/2. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180417041939_sdc3hg_ads_  (
	"KEY" BIGINT, 
	scaler_output_2 FLOAT, 
	scaler_output_3 FLOAT, 
	scaler_output_4 FLOAT, 
	scaler_output_5 FLOAT
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180417041939_sdc3hg_ads_ part 2/2. Populate

INSERT INTO tmp_20180417041939_sdc3hg_ads_ ("KEY", scaler_output_2, scaler_output_3, scaler_output_4, scaler_output_5) SELECT "U"."KEY", "U".scaler_output_2, "U".scaler_output_3, "U".scaler_output_4, "U".scaler_output_5 
FROM (SELECT "ADS_sca_2_OUT"."KEY", "ADS_sca_2_OUT".scaler_output_2, "ADS_sca_2_OUT".scaler_output_3, "ADS_sca_2_OUT".scaler_output_4, "ADS_sca_2_OUT".scaler_output_5 
FROM (SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".imputer_output_2 AS FLOAT) - 43.79128122207402) / 26.03562357622511 AS scaler_output_2, (CAST("ADS_imp_1_OUT".imputer_output_3 AS FLOAT) - 945.9672833084397) / 461.4552766146446 AS scaler_output_3, (CAST("ADS_imp_1_OUT".imputer_output_4 AS FLOAT) - 0.531000909997521) / 0.290186328214479 AS scaler_output_4, (CAST("ADS_imp_1_OUT".imputer_output_5 AS FLOAT) - 6.139967152050499) / 3.072917242564058 AS scaler_output_5 
FROM tmp_20180417041939_kthnqg_ads_ AS "ADS_imp_1_OUT") AS "ADS_sca_2_OUT") AS "U"

-- Model deployment code

WITH kernel_input AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CAST("ADS_sca_2_OUT".scaler_output_2 AS FLOAT) AS scaler_output_2, CAST("ADS_sca_2_OUT".scaler_output_3 AS FLOAT) AS scaler_output_3, CAST("ADS_sca_2_OUT".scaler_output_4 AS FLOAT) AS scaler_output_4, CAST("ADS_sca_2_OUT".scaler_output_5 AS FLOAT) AS scaler_output_5 
FROM tmp_20180417041939_sdc3hg_ads_ AS "ADS_sca_2_OUT"), 
"SV_data" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS FLOAT) AS dual_coeff, CAST("Values".sv_0 AS FLOAT) AS sv_0, CAST("Values".sv_1 AS FLOAT) AS sv_1, CAST("Values".sv_2 AS FLOAT) AS sv_2, CAST("Values".sv_3 AS FLOAT) AS sv_3 
FROM (SELECT 0 AS sv_idx, -0.1 AS dual_coeff, -0.128629540716648 AS sv_0, -0.855762437264239 AS sv_1, -1.696627692807715 AS sv_2, -0.508276249018738 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 1 AS sv_idx, 0.025028939824075 AS dual_coeff, 0.188322837867617 AS sv_0, 1.556571202461176 AS sv_1, -0.756591612265666 AS sv_2, -0.490525026050968 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 2 AS sv_idx, 0.004175725621421 AS dual_coeff, 0.715223115868063 AS sv_0, 0.183824893669536 AS sv_1, 0.626533125970769 AS sv_2, 1.38791677943489 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 3 AS sv_idx, 0.1 AS dual_coeff, -0.061839864587315 AS sv_0, 0.379833212745227 AS sv_1, 0.808251474852461 AS sv_2, 0.304112923070517 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 4 AS sv_idx, -0.066070478558283 AS dual_coeff, -0.212861866158679 AS sv_0, -1.75545003256683 AS sv_1, 0.40296624747161 AS sv_2, -1.288842312688892 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 5 AS sv_idx, -0.1 AS dual_coeff, 0.262295051031869 AS sv_0, -1.156436226701534 AS sv_1, -1.469826707772466 AS sv_2, -1.059119640920314 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 6 AS sv_idx, -0.1 AS dual_coeff, 0.734401135308558 AS sv_0, -1.061279569066753 AS sv_1, -1.64272067072607 AS sv_2, 1.28389871222053 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 7 AS sv_idx, -0.1 AS dual_coeff, -0.185280428471124 AS sv_0, 0.469948210657082 AS sv_1, -1.783277894836552 AS sv_2, 0.208534293223346 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 8 AS sv_idx, 0.028293482445526 AS dual_coeff, -1.072806128611992 AS sv_0, -0.011274498105027 AS sv_1, 0.158710100039567 AS sv_2, 1.366300036238356 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 9 AS sv_idx, -0.1 AS dual_coeff, -1.130653018190199 AS sv_0, 1.693815859594952 AS sv_1, -1.809849193272349 AS sv_2, -0.853115053657762 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 10 AS sv_idx, 0.057058955753627 AS dual_coeff, -1.468587753657723 AS sv_0, 0.706265857711276 AS sv_1, -0.915855280051702 AS sv_2, -1.2834679369914 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 11 AS sv_idx, 0.06006089809664 AS dual_coeff, 0.645167022605794 AS sv_0, 1.135268744400895 AS sv_1, 0.268621569111373 AS sv_2, -1.23764227872756 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 12 AS sv_idx, 0.1 AS dual_coeff, -0.883913938809592 AS sv_0, -0.210463335500846 AS sv_1, 0.465219122686826 AS sv_2, 0.730461822885395 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 13 AS sv_idx, -0.006014126301536 AS dual_coeff, -1.303870138217631 AS sv_0, 1.5082277717145 AS sv_1, 0.608346026197214 AS sv_2, -0.049792963322016 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 14 AS sv_idx, 0.1 AS dual_coeff, -0.710888619986789 AS sv_0, -0.914407867644047 AS sv_1, 0.40580456863468 AS sv_2, -0.755341550199863 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 15 AS sv_idx, 0.1 AS dual_coeff, -0.593770432267414 AS sv_0, 0.002038778458289 AS sv_1, 0.412858567474831 AS sv_2, 1.011121496858055 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 16 AS sv_idx, -0.1 AS dual_coeff, -0.175416482534578 AS sv_0, 1.157357979471062 AS sv_1, 1.546077643505364 AS sv_2, 1.56148404527743 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 17 AS sv_idx, 0.1 AS dual_coeff, 0.61644120598175 AS sv_0, 0.513531327146482 AS sv_1, 0.1901494810657 AS sv_2, -1.1516753084143 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 18 AS sv_idx, -0.1 AS dual_coeff, 0.215420405866088 AS sv_0, -1.521343805623405 AS sv_1, -0.404061522441028 AS sv_2, -0.039263686954211 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 19 AS sv_idx, 0.1 AS dual_coeff, -0.503173227813537 AS sv_0, 0.679095067810605 AS sv_1, -0.927914767969166 AS sv_2, -0.088869584414411 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 20 AS sv_idx, 0.023217743956215 AS dual_coeff, -1.2241246362115 AS sv_0, 1.512795119938024 AS sv_1, -1.676492473707462 AS sv_2, -1.354123235499923 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 21 AS sv_idx, -0.071300558996715 AS dual_coeff, 0.965886790803339 AS sv_0, -0.80119621990515 AS sv_1, -1.002975179920882 AS sv_2, 0.535944005146783 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 22 AS sv_idx, 0.1 AS dual_coeff, -0.643421690432257 AS sv_0, 0.458153752848955 AS sv_1, 0.04561705282486 AS sv_2, -0.42841875716131 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 23 AS sv_idx, -0.1 AS dual_coeff, 1.25609745057753 AS sv_0, -1.573495992128003 AS sv_1, 0.806979259164098 AS sv_2, 0.185938500416681 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 24 AS sv_idx, -0.1 AS dual_coeff, -0.084825141436289 AS sv_0, -1.106871678746354 AS sv_1, -1.485414738414908 AS sv_2, -1.190410371070792 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 25 AS sv_idx, 0.035958738212745 AS dual_coeff, -1.624280289386995 AS sv_0, -1.775508653244122 AS sv_1, -0.656813160988098 AS sv_2, 1.195304544325356 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 26 AS sv_idx, 0.1 AS dual_coeff, -1.314278861233416 AS sv_0, 0.228052176609166 AS sv_1, 0.305700563413897 AS sv_2, 0.710181620860122 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 27 AS sv_idx, -0.025399649250069 AS dual_coeff, 0.983310970922164 AS sv_0, -1.515041962798084 AS sv_1, 1.393918836611841 AS sv_2, -0.162446226528031 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 28 AS sv_idx, 0.018417719884694 AS dual_coeff, -0.923065553671842 AS sv_0, -1.460057588221313 AS sv_1, -0.280397076082255 AS sv_2, -1.391523762632961 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte UNION ALL SELECT 29 AS sv_idx, 0.016572609311659 AS dual_coeff, -0.337961164229412 AS sv_0, -0.573081537507758 AS sv_1, 0.283241254346836 AS sv_2, 1.577095288586448 AS sv_3 
FROM (SELECT 0.0 AS "X") AS dummy_cte) AS "Values"), 
kernel_dp AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(CAST(full_join_data_sv.dot_prod1 AS FLOAT)) + 1.385690461760779 AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data".dual_coeff * power(0.25 * (kernel_input.scaler_output_2 * "SV_data".sv_0 + kernel_input.scaler_output_3 * "SV_data".sv_1 + kernel_input.scaler_output_4 * "SV_data".sv_2 + kernel_input.scaler_output_5 * "SV_data".sv_3) + 0.0, 3) AS dot_prod1 
FROM kernel_input, "SV_data") AS full_join_data_sv GROUP BY full_join_data_sv."KEY") AS t)
 SELECT kernel_dp."KEY" AS "KEY", kernel_dp.dot_product AS "Estimator" 
FROM kernel_dp