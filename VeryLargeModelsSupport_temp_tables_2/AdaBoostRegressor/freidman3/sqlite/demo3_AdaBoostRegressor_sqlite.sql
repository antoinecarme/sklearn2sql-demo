-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : AdaBoostRegressor
-- Dataset : freidman3
-- Database : sqlite


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table TMP_20180508185046_CODEGEN_Q1RV23_WE_B0 part 1. Create 


CREATE TEMPORARY TABLE "TMP_20180508185046_CODEGEN_Q1RV23_WE_B0" (
	"KEY" BIGINT, 
	"Estimator" FLOAT, 
	"Weight" FLOAT, 
	est_index BIGINT
)



-- Code For temporary table TMP_20180508185046_CODEGEN_Q1RV23_WE_B0 part 2. Populate

WITH "DT_node_lookup" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.20348544418811798) THEN CASE WHEN ("ADS"."Feature_1" <= 574.9090576171875) THEN CASE WHEN ("ADS"."Feature_3" <= 3.7317280769348145) THEN 3 ELSE 4 END ELSE CASE WHEN ("ADS"."Feature_2" <= 0.025156566873192787) THEN 6 ELSE 7 END END ELSE CASE WHEN ("ADS"."Feature_1" <= 450.96368408203125) THEN CASE WHEN ("ADS"."Feature_2" <= 0.5044680237770081) THEN 10 ELSE 11 END ELSE CASE WHEN ("ADS"."Feature_0" <= 42.91398620605469) THEN 13 ELSE 14 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 3 AS nid, 0.7050714675464733 AS "E" UNION ALL SELECT 4 AS nid, 0.43001724369176697 AS "E" UNION ALL SELECT 6 AS nid, 0.6100168381304848 AS "E" UNION ALL SELECT 7 AS nid, 1.2443297616327034 AS "E" UNION ALL SELECT 10 AS nid, 1.4733555133692287 AS "E" UNION ALL SELECT 11 AS nid, 1.1552266207505864 AS "E" UNION ALL SELECT 13 AS nid, 1.5354636129407508 AS "E" UNION ALL SELECT 14 AS nid, 1.4648826319981552 AS "E") AS "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".nid AS nid, "DT_node_data"."E" AS "E" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".nid), 
"ADB_Model_0" AS 
(SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."E" AS "Estimator", 0.051954275848813736 AS "Weight", 0 AS est_index 
FROM "DT_Output"), 
"DT_node_lookup_1" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.041584230959415436) THEN CASE WHEN ("ADS"."Feature_0" <= 39.704856872558594) THEN 2 ELSE 3 END ELSE CASE WHEN ("ADS"."Feature_2" <= 0.3052070736885071) THEN CASE WHEN ("ADS"."Feature_1" <= 516.2426147460938) THEN 6 ELSE 7 END ELSE CASE WHEN ("ADS"."Feature_0" <= 46.51478958129883) THEN 9 ELSE 10 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_1" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 2 AS nid, 0.38342473185592096 AS "E" UNION ALL SELECT 3 AS nid, 0.4848669214064692 AS "E" UNION ALL SELECT 6 AS nid, 0.5915392445044317 AS "E" UNION ALL SELECT 7 AS nid, 1.2541519017473017 AS "E" UNION ALL SELECT 9 AS nid, 1.5287311749770354 AS "E" UNION ALL SELECT 10 AS nid, 1.3679828024550929 AS "E") AS "Values"), 
"DT_Output_1" AS 
(SELECT "DT_node_lookup_1"."KEY" AS "KEY", "DT_node_lookup_1".node_id_2 AS node_id_2, "DT_node_data_1".nid AS nid, "DT_node_data_1"."E" AS "E" 
FROM "DT_node_lookup_1" LEFT OUTER JOIN "DT_node_data_1" ON "DT_node_lookup_1".node_id_2 = "DT_node_data_1".nid), 
"ADB_Model_1" AS 
(SELECT "DT_Output_1"."KEY" AS "KEY", "DT_Output_1"."E" AS "Estimator", 0.0372441445409521 AS "Weight", 1 AS est_index 
FROM "DT_Output_1"), 
"DT_node_lookup_2" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.041584230959415436) THEN CASE WHEN ("ADS"."Feature_1" <= 1445.20751953125) THEN CASE WHEN ("ADS"."Feature_0" <= 39.704856872558594) THEN 3 ELSE 4 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_1" <= 766.9921875) THEN CASE WHEN ("ADS"."Feature_2" <= 0.056316666305065155) THEN 8 ELSE 9 END ELSE CASE WHEN ("ADS"."Feature_2" <= 0.1915559023618698) THEN 11 ELSE 12 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_2" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 3 AS nid, 0.38342473185592096 AS "E" UNION ALL SELECT 4 AS nid, 0.4848669214064692 AS "E" UNION ALL SELECT 5 AS nid, 0.6100168381304848 AS "E" UNION ALL SELECT 8 AS nid, 0.3751675659770648 AS "E" UNION ALL SELECT 9 AS nid, 1.2189678231486023 AS "E" UNION ALL SELECT 11 AS nid, 1.377641769292083 AS "E" UNION ALL SELECT 12 AS nid, 1.5145094173378104 AS "E") AS "Values"), 
"DT_Output_2" AS 
(SELECT "DT_node_lookup_2"."KEY" AS "KEY", "DT_node_lookup_2".node_id_2 AS node_id_2, "DT_node_data_2".nid AS nid, "DT_node_data_2"."E" AS "E" 
FROM "DT_node_lookup_2" LEFT OUTER JOIN "DT_node_data_2" ON "DT_node_lookup_2".node_id_2 = "DT_node_data_2".nid), 
"ADB_Model_2" AS 
(SELECT "DT_Output_2"."KEY" AS "KEY", "DT_Output_2"."E" AS "Estimator", 0.05272668474595339 AS "Weight", 2 AS est_index 
FROM "DT_Output_2"), 
"DT_node_lookup_3" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.1157732754945755) THEN CASE WHEN ("ADS"."Feature_2" <= 0.056316666305065155) THEN CASE WHEN ("ADS"."Feature_3" <= 5.679426193237305) THEN 3 ELSE 4 END ELSE CASE WHEN ("ADS"."Feature_1" <= 516.97119140625) THEN 6 ELSE 7 END END ELSE CASE WHEN ("ADS"."Feature_0" <= 49.2326774597168) THEN CASE WHEN ("ADS"."Feature_3" <= 2.0892207622528076) THEN 10 ELSE 11 END ELSE CASE WHEN ("ADS"."Feature_1" <= 850.1043701171875) THEN 13 ELSE 14 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_3" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 3 AS nid, 0.4848669214064692 AS "E" UNION ALL SELECT 4 AS nid, 0.38177329868014975 AS "E" UNION ALL SELECT 6 AS nid, 0.7736311045366903 AS "E" UNION ALL SELECT 7 AS nid, 1.2168500273152194 AS "E" UNION ALL SELECT 10 AS nid, 1.4286748402499525 AS "E" UNION ALL SELECT 11 AS nid, 1.5097423878118206 AS "E" UNION ALL SELECT 13 AS nid, 1.142622893040531 AS "E" UNION ALL SELECT 14 AS nid, 1.398314530314508 AS "E") AS "Values"), 
"DT_Output_3" AS 
(SELECT "DT_node_lookup_3"."KEY" AS "KEY", "DT_node_lookup_3".node_id_2 AS node_id_2, "DT_node_data_3".nid AS nid, "DT_node_data_3"."E" AS "E" 
FROM "DT_node_lookup_3" LEFT OUTER JOIN "DT_node_data_3" ON "DT_node_lookup_3".node_id_2 = "DT_node_data_3".nid), 
"ADB_Model_3" AS 
(SELECT "DT_Output_3"."KEY" AS "KEY", "DT_Output_3"."E" AS "Estimator", 0.0843236269469388 AS "Weight", 3 AS est_index 
FROM "DT_Output_3"), 
"DT_node_lookup_4" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.4144279360771179) THEN CASE WHEN ("ADS"."Feature_0" <= 29.8048152923584) THEN CASE WHEN ("ADS"."Feature_0" <= 13.965950965881348) THEN 3 ELSE 4 END ELSE CASE WHEN ("ADS"."Feature_2" <= 0.11351156234741211) THEN 6 ELSE 7 END END ELSE CASE WHEN ("ADS"."Feature_1" <= 360.9476013183594) THEN CASE WHEN ("ADS"."Feature_3" <= 7.732187747955322) THEN 10 ELSE 11 END ELSE CASE WHEN ("ADS"."Feature_0" <= 22.92284393310547) THEN 13 ELSE 14 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_4" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 3 AS nid, 1.4455967910671395 AS "E" UNION ALL SELECT 4 AS nid, 1.3284094170198377 AS "E" UNION ALL SELECT 6 AS nid, 0.8079109230317987 AS "E" UNION ALL SELECT 7 AS nid, 1.1484121598646297 AS "E" UNION ALL SELECT 10 AS nid, 1.225018295065725 AS "E" UNION ALL SELECT 11 AS nid, 1.448477991055055 AS "E" UNION ALL SELECT 13 AS nid, 1.5608250367469139 AS "E" UNION ALL SELECT 14 AS nid, 1.5038401763272644 AS "E") AS "Values"), 
"DT_Output_4" AS 
(SELECT "DT_node_lookup_4"."KEY" AS "KEY", "DT_node_lookup_4".node_id_2 AS node_id_2, "DT_node_data_4".nid AS nid, "DT_node_data_4"."E" AS "E" 
FROM "DT_node_lookup_4" LEFT OUTER JOIN "DT_node_data_4" ON "DT_node_lookup_4".node_id_2 = "DT_node_data_4".nid), 
"ADB_Model_4" AS 
(SELECT "DT_Output_4"."KEY" AS "KEY", "DT_Output_4"."E" AS "Estimator", 0.07947676307318342 AS "Weight", 4 AS est_index 
FROM "DT_Output_4"), 
"DT_node_lookup_5" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.029011880978941917) THEN CASE WHEN ("ADS"."Feature_1" <= 1445.20751953125) THEN 2 ELSE 3 END ELSE CASE WHEN ("ADS"."Feature_0" <= 40.930686950683594) THEN CASE WHEN ("ADS"."Feature_2" <= 0.13676801323890686) THEN 6 ELSE 7 END ELSE CASE WHEN ("ADS"."Feature_2" <= 0.1157732754945755) THEN 9 ELSE 10 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_5" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 2 AS nid, 0.38342473185592096 AS "E" UNION ALL SELECT 3 AS nid, 0.6100168381304848 AS "E" UNION ALL SELECT 6 AS nid, 1.3689832528589367 AS "E" UNION ALL SELECT 7 AS nid, 1.493650541136645 AS "E" UNION ALL SELECT 9 AS nid, 0.7186471209417888 AS "E" UNION ALL SELECT 10 AS nid, 1.2565834181238955 AS "E") AS "Values"), 
"DT_Output_5" AS 
(SELECT "DT_node_lookup_5"."KEY" AS "KEY", "DT_node_lookup_5".node_id_2 AS node_id_2, "DT_node_data_5".nid AS nid, "DT_node_data_5"."E" AS "E" 
FROM "DT_node_lookup_5" LEFT OUTER JOIN "DT_node_data_5" ON "DT_node_lookup_5".node_id_2 = "DT_node_data_5".nid), 
"ADB_Model_5" AS 
(SELECT "DT_Output_5"."KEY" AS "KEY", "DT_Output_5"."E" AS "Estimator", 0.07262877233372339 AS "Weight", 5 AS est_index 
FROM "DT_Output_5"), 
"DT_node_lookup_6" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.1157732754945755) THEN CASE WHEN ("ADS"."Feature_0" <= 28.497106552124023) THEN CASE WHEN ("ADS"."Feature_2" <= 0.025156566873192787) THEN 3 ELSE 4 END ELSE CASE WHEN ("ADS"."Feature_3" <= 3.7317280769348145) THEN 6 ELSE 7 END END ELSE CASE WHEN ("ADS"."Feature_1" <= 254.32003784179688) THEN CASE WHEN ("ADS"."Feature_0" <= 26.78800392150879) THEN 10 ELSE 11 END ELSE CASE WHEN ("ADS"."Feature_0" <= 61.13295364379883) THEN 13 ELSE 14 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_6" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 3 AS nid, 0.6100168381304848 AS "E" UNION ALL SELECT 4 AS nid, 1.3683914441949208 AS "E" UNION ALL SELECT 6 AS nid, 0.7393512860415817 AS "E" UNION ALL SELECT 7 AS nid, 0.4135689435377232 AS "E" UNION ALL SELECT 10 AS nid, 1.4518609404362353 AS "E" UNION ALL SELECT 11 AS nid, 1.0976689767809684 AS "E" UNION ALL SELECT 13 AS nid, 1.4728244799298955 AS "E" UNION ALL SELECT 14 AS nid, 1.2770565916438006 AS "E") AS "Values"), 
"DT_Output_6" AS 
(SELECT "DT_node_lookup_6"."KEY" AS "KEY", "DT_node_lookup_6".node_id_2 AS node_id_2, "DT_node_data_6".nid AS nid, "DT_node_data_6"."E" AS "E" 
FROM "DT_node_lookup_6" LEFT OUTER JOIN "DT_node_data_6" ON "DT_node_lookup_6".node_id_2 = "DT_node_data_6".nid), 
"ADB_Model_6" AS 
(SELECT "DT_Output_6"."KEY" AS "KEY", "DT_Output_6"."E" AS "Estimator", 0.025113769675465802 AS "Weight", 6 AS est_index 
FROM "DT_Output_6"), 
"DT_node_lookup_7" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.041584230959415436) THEN CASE WHEN ("ADS"."Feature_0" <= 26.66070556640625) THEN 2 ELSE CASE WHEN ("ADS"."Feature_0" <= 39.704856872558594) THEN 4 ELSE 5 END END ELSE CASE WHEN ("ADS"."Feature_1" <= 1011.352294921875) THEN CASE WHEN ("ADS"."Feature_3" <= 4.70388126373291) THEN 8 ELSE 9 END ELSE CASE WHEN ("ADS"."Feature_2" <= 0.25638625025749207) THEN 11 ELSE 12 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_7" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 2 AS nid, 0.6100168381304848 AS "E" UNION ALL SELECT 4 AS nid, 0.38342473185592096 AS "E" UNION ALL SELECT 5 AS nid, 0.4848669214064692 AS "E" UNION ALL SELECT 8 AS nid, 1.0673248517445262 AS "E" UNION ALL SELECT 9 AS nid, 1.3260623233758584 AS "E" UNION ALL SELECT 11 AS nid, 1.3781404758387157 AS "E" UNION ALL SELECT 12 AS nid, 1.5130482692998817 AS "E") AS "Values"), 
"DT_Output_7" AS 
(SELECT "DT_node_lookup_7"."KEY" AS "KEY", "DT_node_lookup_7".node_id_2 AS node_id_2, "DT_node_data_7".nid AS nid, "DT_node_data_7"."E" AS "E" 
FROM "DT_node_lookup_7" LEFT OUTER JOIN "DT_node_data_7" ON "DT_node_lookup_7".node_id_2 = "DT_node_data_7".nid), 
"ADB_Model_7" AS 
(SELECT "DT_Output_7"."KEY" AS "KEY", "DT_Output_7"."E" AS "Estimator", 0.07281837272682976 AS "Weight", 7 AS est_index 
FROM "DT_Output_7"), 
"DT_node_lookup_8" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.056316666305065155) THEN CASE WHEN ("ADS"."Feature_0" <= 28.41775894165039) THEN CASE WHEN ("ADS"."Feature_1" <= 1685.821044921875) THEN 3 ELSE 4 END ELSE CASE WHEN ("ADS"."Feature_3" <= 5.679426193237305) THEN 6 ELSE 7 END END ELSE CASE WHEN ("ADS"."Feature_2" <= 0.25084197521209717) THEN CASE WHEN ("ADS"."Feature_1" <= 505.7232666015625) THEN 10 ELSE 11 END ELSE CASE WHEN ("ADS"."Feature_1" <= 329.4079284667969) THEN 13 ELSE 14 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_8" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 3 AS nid, 1.3944974095517522 AS "E" UNION ALL SELECT 4 AS nid, 0.6100168381304848 AS "E" UNION ALL SELECT 6 AS nid, 0.4848669214064692 AS "E" UNION ALL SELECT 7 AS nid, 0.37591821742059717 AS "E" UNION ALL SELECT 10 AS nid, 0.8079109230317987 AS "E" UNION ALL SELECT 11 AS nid, 1.131672977074509 AS "E" UNION ALL SELECT 13 AS nid, 1.178222824375288 AS "E" UNION ALL SELECT 14 AS nid, 1.4591073483282648 AS "E") AS "Values"), 
"DT_Output_8" AS 
(SELECT "DT_node_lookup_8"."KEY" AS "KEY", "DT_node_lookup_8".node_id_2 AS node_id_2, "DT_node_data_8".nid AS nid, "DT_node_data_8"."E" AS "E" 
FROM "DT_node_lookup_8" LEFT OUTER JOIN "DT_node_data_8" ON "DT_node_lookup_8".node_id_2 = "DT_node_data_8".nid), 
"ADB_Model_8" AS 
(SELECT "DT_Output_8"."KEY" AS "KEY", "DT_Output_8"."E" AS "Estimator", 0.06087939831616386 AS "Weight", 8 AS est_index 
FROM "DT_Output_8"), 
"DT_node_lookup_9" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.056316666305065155) THEN CASE WHEN ("ADS"."Feature_0" <= 29.155231475830078) THEN CASE WHEN ("ADS"."Feature_2" <= 0.025156566873192787) THEN 3 ELSE 4 END ELSE CASE WHEN ("ADS"."Feature_1" <= 503.6527099609375) THEN 6 ELSE 7 END END ELSE CASE WHEN ("ADS"."Feature_0" <= 15.669092178344727) THEN CASE WHEN ("ADS"."Feature_0" <= 12.17395305633545) THEN 10 ELSE 11 END ELSE CASE WHEN ("ADS"."Feature_0" <= 78.13961791992188) THEN 13 ELSE 14 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_9" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 3 AS nid, 0.6100168381304848 AS "E" UNION ALL SELECT 4 AS nid, 1.3944974095517522 AS "E" UNION ALL SELECT 6 AS nid, 0.3751675659770647 AS "E" UNION ALL SELECT 7 AS nid, 0.4848669214064692 AS "E" UNION ALL SELECT 10 AS nid, 1.5566063302021076 AS "E" UNION ALL SELECT 11 AS nid, 1.4518609404362353 AS "E" UNION ALL SELECT 13 AS nid, 1.3214805159401062 AS "E" UNION ALL SELECT 14 AS nid, 1.1009814131399118 AS "E") AS "Values"), 
"DT_Output_9" AS 
(SELECT "DT_node_lookup_9"."KEY" AS "KEY", "DT_node_lookup_9".node_id_2 AS node_id_2, "DT_node_data_9".nid AS nid, "DT_node_data_9"."E" AS "E" 
FROM "DT_node_lookup_9" LEFT OUTER JOIN "DT_node_data_9" ON "DT_node_lookup_9".node_id_2 = "DT_node_data_9".nid), 
"ADB_Model_9" AS 
(SELECT "DT_Output_9"."KEY" AS "KEY", "DT_Output_9"."E" AS "Estimator", 0.06415244332040133 AS "Weight", 9 AS est_index 
FROM "DT_Output_9")
 INSERT INTO "TMP_20180508185046_CODEGEN_Q1RV23_WE_B0" ("KEY", "Estimator", "Weight", est_index) SELECT "WE_B0"."KEY", "WE_B0"."Estimator", "WE_B0"."Weight", "WE_B0".est_index 
FROM (SELECT "WE_esu_0"."KEY" AS "KEY", "WE_esu_0"."Estimator" AS "Estimator", "WE_esu_0"."Weight" AS "Weight", "WE_esu_0".est_index AS est_index 
FROM (SELECT "ADB_Model_0"."KEY" AS "KEY", "ADB_Model_0"."Estimator" AS "Estimator", "ADB_Model_0"."Weight" AS "Weight", "ADB_Model_0".est_index AS est_index 
FROM "ADB_Model_0" UNION ALL SELECT "ADB_Model_1"."KEY" AS "KEY", "ADB_Model_1"."Estimator" AS "Estimator", "ADB_Model_1"."Weight" AS "Weight", "ADB_Model_1".est_index AS est_index 
FROM "ADB_Model_1" UNION ALL SELECT "ADB_Model_2"."KEY" AS "KEY", "ADB_Model_2"."Estimator" AS "Estimator", "ADB_Model_2"."Weight" AS "Weight", "ADB_Model_2".est_index AS est_index 
FROM "ADB_Model_2" UNION ALL SELECT "ADB_Model_3"."KEY" AS "KEY", "ADB_Model_3"."Estimator" AS "Estimator", "ADB_Model_3"."Weight" AS "Weight", "ADB_Model_3".est_index AS est_index 
FROM "ADB_Model_3" UNION ALL SELECT "ADB_Model_4"."KEY" AS "KEY", "ADB_Model_4"."Estimator" AS "Estimator", "ADB_Model_4"."Weight" AS "Weight", "ADB_Model_4".est_index AS est_index 
FROM "ADB_Model_4" UNION ALL SELECT "ADB_Model_5"."KEY" AS "KEY", "ADB_Model_5"."Estimator" AS "Estimator", "ADB_Model_5"."Weight" AS "Weight", "ADB_Model_5".est_index AS est_index 
FROM "ADB_Model_5" UNION ALL SELECT "ADB_Model_6"."KEY" AS "KEY", "ADB_Model_6"."Estimator" AS "Estimator", "ADB_Model_6"."Weight" AS "Weight", "ADB_Model_6".est_index AS est_index 
FROM "ADB_Model_6" UNION ALL SELECT "ADB_Model_7"."KEY" AS "KEY", "ADB_Model_7"."Estimator" AS "Estimator", "ADB_Model_7"."Weight" AS "Weight", "ADB_Model_7".est_index AS est_index 
FROM "ADB_Model_7" UNION ALL SELECT "ADB_Model_8"."KEY" AS "KEY", "ADB_Model_8"."Estimator" AS "Estimator", "ADB_Model_8"."Weight" AS "Weight", "ADB_Model_8".est_index AS est_index 
FROM "ADB_Model_8" UNION ALL SELECT "ADB_Model_9"."KEY" AS "KEY", "ADB_Model_9"."Estimator" AS "Estimator", "ADB_Model_9"."Weight" AS "Weight", "ADB_Model_9".est_index AS est_index 
FROM "ADB_Model_9") AS "WE_esu_0") AS "WE_B0"

-- Code For temporary table TMP_20180508185046_CODEGEN_X78WWH_WE_B1 part 1. Create 


CREATE TEMPORARY TABLE "TMP_20180508185046_CODEGEN_X78WWH_WE_B1" (
	"KEY" BIGINT, 
	"Estimator" FLOAT, 
	"Weight" FLOAT, 
	est_index BIGINT
)



-- Code For temporary table TMP_20180508185046_CODEGEN_X78WWH_WE_B1 part 2. Populate

WITH "DT_node_lookup_10" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.1157732754945755) THEN CASE WHEN ("ADS"."Feature_1" <= 574.9090576171875) THEN CASE WHEN ("ADS"."Feature_2" <= 0.07712984085083008) THEN 3 ELSE 4 END ELSE CASE WHEN ("ADS"."Feature_1" <= 1042.344482421875) THEN 6 ELSE 7 END END ELSE CASE WHEN ("ADS"."Feature_0" <= 90.57643127441406) THEN CASE WHEN ("ADS"."Feature_0" <= 41.68732452392578) THEN 10 ELSE 11 END ELSE CASE WHEN ("ADS"."Feature_2" <= 0.6747548580169678) THEN 13 ELSE 14 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_10" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 3 AS nid, 0.38735638324699856 AS "E" UNION ALL SELECT 4 AS nid, 0.7222113767940274 AS "E" UNION ALL SELECT 6 AS nid, 1.1409162524546155 AS "E" UNION ALL SELECT 7 AS nid, 1.3648925419511007 AS "E" UNION ALL SELECT 10 AS nid, 1.51341198019395 AS "E" UNION ALL SELECT 11 AS nid, 1.3607044604395606 AS "E" UNION ALL SELECT 13 AS nid, 1.0792195428902525 AS "E" UNION ALL SELECT 14 AS nid, 1.0274843519223331 AS "E") AS "Values"), 
"DT_Output_10" AS 
(SELECT "DT_node_lookup_10"."KEY" AS "KEY", "DT_node_lookup_10".node_id_2 AS node_id_2, "DT_node_data_10".nid AS nid, "DT_node_data_10"."E" AS "E" 
FROM "DT_node_lookup_10" LEFT OUTER JOIN "DT_node_data_10" ON "DT_node_lookup_10".node_id_2 = "DT_node_data_10".nid), 
"ADB_Model_10" AS 
(SELECT "DT_Output_10"."KEY" AS "KEY", "DT_Output_10"."E" AS "Estimator", 0.08460083708429006 AS "Weight", 10 AS est_index 
FROM "DT_Output_10"), 
"DT_node_lookup_11" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.1157732754945755) THEN CASE WHEN ("ADS"."Feature_2" <= 0.041584230959415436) THEN CASE WHEN ("ADS"."Feature_2" <= 0.009662731550633907) THEN 3 ELSE 4 END ELSE CASE WHEN ("ADS"."Feature_0" <= 29.8048152923584) THEN 6 ELSE 7 END END ELSE CASE WHEN ("ADS"."Feature_0" <= 36.62077331542969) THEN CASE WHEN ("ADS"."Feature_2" <= 0.6806126832962036) THEN 10 ELSE 11 END ELSE CASE WHEN ("ADS"."Feature_1" <= 1056.046630859375) THEN 13 ELSE 14 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_11" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 3 AS nid, 0.6100168381304848 AS "E" UNION ALL SELECT 4 AS nid, 0.39264674908778896 AS "E" UNION ALL SELECT 6 AS nid, 1.3320583790487996 AS "E" UNION ALL SELECT 7 AS nid, 0.7026952969783141 AS "E" UNION ALL SELECT 10 AS nid, 1.5485994036832307 AS "E" UNION ALL SELECT 11 AS nid, 1.4675830888238124 AS "E" UNION ALL SELECT 13 AS nid, 1.1276342109819888 AS "E" UNION ALL SELECT 14 AS nid, 1.4474446279553181 AS "E") AS "Values"), 
"DT_Output_11" AS 
(SELECT "DT_node_lookup_11"."KEY" AS "KEY", "DT_node_lookup_11".node_id_2 AS node_id_2, "DT_node_data_11".nid AS nid, "DT_node_data_11"."E" AS "E" 
FROM "DT_node_lookup_11" LEFT OUTER JOIN "DT_node_data_11" ON "DT_node_lookup_11".node_id_2 = "DT_node_data_11".nid), 
"ADB_Model_11" AS 
(SELECT "DT_Output_11"."KEY" AS "KEY", "DT_Output_11"."E" AS "Estimator", 0.043064526156651704 AS "Weight", 11 AS est_index 
FROM "DT_Output_11"), 
"DT_node_lookup_12" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.1157732754945755) THEN CASE WHEN ("ADS"."Feature_3" <= 2.2303965091705322) THEN 2 ELSE CASE WHEN ("ADS"."Feature_3" <= 8.441878318786621) THEN 4 ELSE 5 END END ELSE CASE WHEN ("ADS"."Feature_0" <= 84.98217010498047) THEN CASE WHEN ("ADS"."Feature_0" <= 33.222293853759766) THEN 8 ELSE 9 END ELSE CASE WHEN ("ADS"."Feature_1" <= 256.3046569824219) THEN 11 ELSE 12 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_12" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 2 AS nid, 1.4092998433520778 AS "E" UNION ALL SELECT 4 AS nid, 0.7349170226645136 AS "E" UNION ALL SELECT 5 AS nid, 0.3751675659770648 AS "E" UNION ALL SELECT 8 AS nid, 1.5361867197208108 AS "E" UNION ALL SELECT 9 AS nid, 1.3332062095098878 AS "E" UNION ALL SELECT 11 AS nid, 1.0274843519223331 AS "E" UNION ALL SELECT 12 AS nid, 1.0927593693818933 AS "E") AS "Values"), 
"DT_Output_12" AS 
(SELECT "DT_node_lookup_12"."KEY" AS "KEY", "DT_node_lookup_12".node_id_2 AS node_id_2, "DT_node_data_12".nid AS nid, "DT_node_data_12"."E" AS "E" 
FROM "DT_node_lookup_12" LEFT OUTER JOIN "DT_node_data_12" ON "DT_node_lookup_12".node_id_2 = "DT_node_data_12".nid), 
"ADB_Model_12" AS 
(SELECT "DT_Output_12"."KEY" AS "KEY", "DT_Output_12"."E" AS "Estimator", 0.061759834984939685 AS "Weight", 12 AS est_index 
FROM "DT_Output_12"), 
"DT_node_lookup_13" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.14811982214450836) THEN CASE WHEN ("ADS"."Feature_0" <= 28.497106552124023) THEN CASE WHEN ("ADS"."Feature_2" <= 0.029701584950089455) THEN 3 ELSE 4 END ELSE CASE WHEN ("ADS"."Feature_2" <= 0.07712984085083008) THEN 6 ELSE 7 END END ELSE CASE WHEN ("ADS"."Feature_2" <= 0.6493715047836304) THEN CASE WHEN ("ADS"."Feature_0" <= 48.77195739746094) THEN 10 ELSE 11 END ELSE CASE WHEN ("ADS"."Feature_0" <= 8.543475151062012) THEN 13 ELSE 14 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_13" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 3 AS nid, 0.6100168381304848 AS "E" UNION ALL SELECT 4 AS nid, 1.2591936688286658 AS "E" UNION ALL SELECT 6 AS nid, 0.376818999152836 AS "E" UNION ALL SELECT 7 AS nid, 0.7599191771386467 AS "E" UNION ALL SELECT 10 AS nid, 1.4508204615744713 AS "E" UNION ALL SELECT 11 AS nid, 1.1481522889366162 AS "E" UNION ALL SELECT 13 AS nid, 1.5695353425561203 AS "E" UNION ALL SELECT 14 AS nid, 1.488195957723148 AS "E") AS "Values"), 
"DT_Output_13" AS 
(SELECT "DT_node_lookup_13"."KEY" AS "KEY", "DT_node_lookup_13".node_id_2 AS node_id_2, "DT_node_data_13".nid AS nid, "DT_node_data_13"."E" AS "E" 
FROM "DT_node_lookup_13" LEFT OUTER JOIN "DT_node_data_13" ON "DT_node_lookup_13".node_id_2 = "DT_node_data_13".nid), 
"ADB_Model_13" AS 
(SELECT "DT_Output_13"."KEY" AS "KEY", "DT_Output_13"."E" AS "Estimator", 0.06933737460744699 AS "Weight", 13 AS est_index 
FROM "DT_Output_13"), 
"DT_node_lookup_14" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.1157732754945755) THEN CASE WHEN ("ADS"."Feature_0" <= 28.41775894165039) THEN CASE WHEN ("ADS"."Feature_2" <= 0.05596163123846054) THEN 3 ELSE 4 END ELSE CASE WHEN ("ADS"."Feature_1" <= 445.71484375) THEN 6 ELSE 7 END END ELSE CASE WHEN ("ADS"."Feature_1" <= 736.03857421875) THEN CASE WHEN ("ADS"."Feature_0" <= 29.003992080688477) THEN 10 ELSE 11 END ELSE CASE WHEN ("ADS"."Feature_2" <= 0.3094656765460968) THEN 13 ELSE 14 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_14" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 3 AS nid, 1.3698266865512094 AS "E" UNION ALL SELECT 4 AS nid, 1.1409162524546155 AS "E" UNION ALL SELECT 6 AS nid, 0.7491455198973271 AS "E" UNION ALL SELECT 7 AS nid, 0.3948269861951082 AS "E" UNION ALL SELECT 10 AS nid, 1.514637024776693 AS "E" UNION ALL SELECT 11 AS nid, 1.1309505699917775 AS "E" UNION ALL SELECT 13 AS nid, 1.3693732776411058 AS "E" UNION ALL SELECT 14 AS nid, 1.4950879755999782 AS "E") AS "Values"), 
"DT_Output_14" AS 
(SELECT "DT_node_lookup_14"."KEY" AS "KEY", "DT_node_lookup_14".node_id_2 AS node_id_2, "DT_node_data_14".nid AS nid, "DT_node_data_14"."E" AS "E" 
FROM "DT_node_lookup_14" LEFT OUTER JOIN "DT_node_data_14" ON "DT_node_lookup_14".node_id_2 = "DT_node_data_14".nid), 
"ADB_Model_14" AS 
(SELECT "DT_Output_14"."KEY" AS "KEY", "DT_Output_14"."E" AS "Estimator", 0.0846474705277762 AS "Weight", 14 AS est_index 
FROM "DT_Output_14"), 
"DT_node_lookup_15" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_2" <= 0.033556897193193436) THEN CASE WHEN ("ADS"."Feature_1" <= 1445.20751953125) THEN 2 ELSE 3 END ELSE CASE WHEN ("ADS"."Feature_0" <= 48.903419494628906) THEN CASE WHEN ("ADS"."Feature_2" <= 0.08024388551712036) THEN 6 ELSE 7 END ELSE CASE WHEN ("ADS"."Feature_2" <= 0.14378926157951355) THEN 9 ELSE 10 END END END AS node_id_2 
FROM freidman3 AS "ADS"), 
"DT_node_data_15" AS 
(SELECT "Values".nid AS nid, CAST("Values"."E" AS FLOAT) AS "E" 
FROM (SELECT 2 AS nid, 0.38342473185592096 AS "E" UNION ALL SELECT 3 AS nid, 0.6100168381304848 AS "E" UNION ALL SELECT 6 AS nid, 1.2193564483406754 AS "E" UNION ALL SELECT 7 AS nid, 1.4510072781537933 AS "E" UNION ALL SELECT 9 AS nid, 0.5401195167617691 AS "E" UNION ALL SELECT 10 AS nid, 1.1415624629213947 AS "E") AS "Values"), 
"DT_Output_15" AS 
(SELECT "DT_node_lookup_15"."KEY" AS "KEY", "DT_node_lookup_15".node_id_2 AS node_id_2, "DT_node_data_15".nid AS nid, "DT_node_data_15"."E" AS "E" 
FROM "DT_node_lookup_15" LEFT OUTER JOIN "DT_node_data_15" ON "DT_node_lookup_15".node_id_2 = "DT_node_data_15".nid), 
"ADB_Model_15" AS 
(SELECT "DT_Output_15"."KEY" AS "KEY", "DT_Output_15"."E" AS "Estimator", 0.05527170511046976 AS "Weight", 15 AS est_index 
FROM "DT_Output_15")
 INSERT INTO "TMP_20180508185046_CODEGEN_X78WWH_WE_B1" ("KEY", "Estimator", "Weight", est_index) SELECT "WE_B1"."KEY", "WE_B1"."Estimator", "WE_B1"."Weight", "WE_B1".est_index 
FROM (SELECT "WE_esu_1"."KEY" AS "KEY", "WE_esu_1"."Estimator" AS "Estimator", "WE_esu_1"."Weight" AS "Weight", "WE_esu_1".est_index AS est_index 
FROM (SELECT "ADB_Model_10"."KEY" AS "KEY", "ADB_Model_10"."Estimator" AS "Estimator", "ADB_Model_10"."Weight" AS "Weight", "ADB_Model_10".est_index AS est_index 
FROM "ADB_Model_10" UNION ALL SELECT "ADB_Model_11"."KEY" AS "KEY", "ADB_Model_11"."Estimator" AS "Estimator", "ADB_Model_11"."Weight" AS "Weight", "ADB_Model_11".est_index AS est_index 
FROM "ADB_Model_11" UNION ALL SELECT "ADB_Model_12"."KEY" AS "KEY", "ADB_Model_12"."Estimator" AS "Estimator", "ADB_Model_12"."Weight" AS "Weight", "ADB_Model_12".est_index AS est_index 
FROM "ADB_Model_12" UNION ALL SELECT "ADB_Model_13"."KEY" AS "KEY", "ADB_Model_13"."Estimator" AS "Estimator", "ADB_Model_13"."Weight" AS "Weight", "ADB_Model_13".est_index AS est_index 
FROM "ADB_Model_13" UNION ALL SELECT "ADB_Model_14"."KEY" AS "KEY", "ADB_Model_14"."Estimator" AS "Estimator", "ADB_Model_14"."Weight" AS "Weight", "ADB_Model_14".est_index AS est_index 
FROM "ADB_Model_14" UNION ALL SELECT "ADB_Model_15"."KEY" AS "KEY", "ADB_Model_15"."Estimator" AS "Estimator", "ADB_Model_15"."Weight" AS "Weight", "ADB_Model_15".est_index AS est_index 
FROM "ADB_Model_15") AS "WE_esu_1") AS "WE_B1"

-- Code For temporary table TMP_20180508185046_CODEGEN_1BM02X_WE_Union part 1. Create 


CREATE TEMPORARY TABLE "TMP_20180508185046_CODEGEN_1BM02X_WE_Union" (
	"KEY" BIGINT, 
	"Estimator" FLOAT, 
	"Weight" FLOAT, 
	est_index BIGINT
)



-- Code For temporary table TMP_20180508185046_CODEGEN_1BM02X_WE_Union part 2. Populate

INSERT INTO "TMP_20180508185046_CODEGEN_1BM02X_WE_Union" ("KEY", "Estimator", "Weight", est_index) SELECT "WE_Union"."KEY", "WE_Union"."Estimator", "WE_Union"."Weight", "WE_Union".est_index 
FROM (SELECT "WE_EnsembleUnion"."KEY" AS "KEY", "WE_EnsembleUnion"."Estimator" AS "Estimator", "WE_EnsembleUnion"."Weight" AS "Weight", "WE_EnsembleUnion".est_index AS est_index 
FROM (SELECT "WE_B0"."KEY" AS "KEY", "WE_B0"."Estimator" AS "Estimator", "WE_B0"."Weight" AS "Weight", "WE_B0".est_index AS est_index 
FROM "TMP_20180508185046_CODEGEN_Q1RV23_WE_B0" AS "WE_B0" UNION ALL SELECT "WE_B1"."KEY" AS "KEY", "WE_B1"."Estimator" AS "Estimator", "WE_B1"."Weight" AS "Weight", "WE_B1".est_index AS est_index 
FROM "TMP_20180508185046_CODEGEN_X78WWH_WE_B1" AS "WE_B1") AS "WE_EnsembleUnion") AS "WE_Union"

-- Code For temporary table TMP_20180508185046_CODEGEN_6NFLJJ_Quantiles part 1. Create 


CREATE TEMPORARY TABLE "TMP_20180508185046_CODEGEN_6NFLJJ_Quantiles" (
	"KEY" BIGINT, 
	"Quantile" FLOAT
)



-- Code For temporary table TMP_20180508185046_CODEGEN_6NFLJJ_Quantiles part 2. Populate

WITH "Cumulative_Frequencies" AS 
(SELECT "CW"."KEY" AS "KEY", "CW"."Estimator" AS "Estimator", "CW"."Weight" AS "Weight", "CW".est_index AS est_index, "CW".cum_weight AS cum_weight 
FROM (SELECT u1."KEY" AS "KEY", u1."Estimator" AS "Estimator", u1."Weight" AS "Weight", u1.est_index AS est_index, sum(u2."Weight") AS cum_weight 
FROM "TMP_20180508185046_CODEGEN_1BM02X_WE_Union" AS u1, "TMP_20180508185046_CODEGEN_1BM02X_WE_Union" AS u2 
WHERE u1."Estimator" >= u2."Estimator" AND u1."KEY" = u2."KEY" GROUP BY u1."KEY", u1.est_index, u1."Estimator", u1."Weight") AS "CW")
 INSERT INTO "TMP_20180508185046_CODEGEN_6NFLJJ_Quantiles" ("KEY", "Quantile") SELECT "Quantiles"."KEY", "Quantiles"."Quantile" 
FROM (SELECT "CW2"."KEY" AS "KEY", "CW2"."Quantile" AS "Quantile" 
FROM (SELECT "Cumulative_Frequencies"."KEY" AS "KEY", min("Cumulative_Frequencies"."Estimator") AS "Quantile" 
FROM "Cumulative_Frequencies" 
WHERE "Cumulative_Frequencies".cum_weight >= 0.5 GROUP BY "Cumulative_Frequencies"."KEY") AS "CW2") AS "Quantiles"

-- Model deployment code

SELECT "Quantiles"."KEY" AS "KEY", "Quantiles"."Quantile" AS "Estimator" 
FROM "TMP_20180508185046_CODEGEN_6NFLJJ_Quantiles" AS "Quantiles"