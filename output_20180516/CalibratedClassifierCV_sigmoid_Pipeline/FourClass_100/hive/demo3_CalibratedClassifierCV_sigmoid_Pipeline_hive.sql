-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : CalibratedClassifierCV_sigmoid_Pipeline
-- Dataset : FourClass_100
-- Database : hive


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180602143620_oq6_ads_imp_1_out part 1. Create 

CREATE TEMPORARY TABLE `tmp_20180602143620_oq6_ads_imp_1_out` STORED AS ORC AS SELECT `ADS_imp_1_OUT`.`KEY`, `ADS_imp_1_OUT`.`impter_2`, `ADS_imp_1_OUT`.`impter_3`, `ADS_imp_1_OUT`.`impter_4`, `ADS_imp_1_OUT`.`impter_5`, `ADS_imp_1_OUT`.`impter_6`, `ADS_imp_1_OUT`.`impter_7`, `ADS_imp_1_OUT`.`impter_8`, `ADS_imp_1_OUT`.`impter_9`, `ADS_imp_1_OUT`.`impter_10`, `ADS_imp_1_OUT`.`impter_11`, `ADS_imp_1_OUT`.`impter_12`, `ADS_imp_1_OUT`.`impter_13`, `ADS_imp_1_OUT`.`impter_14`, `ADS_imp_1_OUT`.`impter_15`, `ADS_imp_1_OUT`.`impter_16`, `ADS_imp_1_OUT`.`impter_17`, `ADS_imp_1_OUT`.`impter_18`, `ADS_imp_1_OUT`.`impter_19`, `ADS_imp_1_OUT`.`impter_20`, `ADS_imp_1_OUT`.`impter_21`, `ADS_imp_1_OUT`.`impter_22`, `ADS_imp_1_OUT`.`impter_23`, `ADS_imp_1_OUT`.`impter_24`, `ADS_imp_1_OUT`.`impter_25`, `ADS_imp_1_OUT`.`impter_26`, `ADS_imp_1_OUT`.`impter_27`, `ADS_imp_1_OUT`.`impter_28`, `ADS_imp_1_OUT`.`impter_29`, `ADS_imp_1_OUT`.`impter_30`, `ADS_imp_1_OUT`.`impter_31`, `ADS_imp_1_OUT`.`impter_32`, `ADS_imp_1_OUT`.`impter_33`, `ADS_imp_1_OUT`.`impter_34`, `ADS_imp_1_OUT`.`impter_35`, `ADS_imp_1_OUT`.`impter_36`, `ADS_imp_1_OUT`.`impter_37`, `ADS_imp_1_OUT`.`impter_38`, `ADS_imp_1_OUT`.`impter_39`, `ADS_imp_1_OUT`.`impter_40`, `ADS_imp_1_OUT`.`impter_41`, `ADS_imp_1_OUT`.`impter_42`, `ADS_imp_1_OUT`.`impter_43`, `ADS_imp_1_OUT`.`impter_44`, `ADS_imp_1_OUT`.`impter_45`, `ADS_imp_1_OUT`.`impter_46`, `ADS_imp_1_OUT`.`impter_47`, `ADS_imp_1_OUT`.`impter_48`, `ADS_imp_1_OUT`.`impter_49`, `ADS_imp_1_OUT`.`impter_50`, `ADS_imp_1_OUT`.`impter_51`, `ADS_imp_1_OUT`.`impter_52`, `ADS_imp_1_OUT`.`impter_53`, `ADS_imp_1_OUT`.`impter_54`, `ADS_imp_1_OUT`.`impter_55`, `ADS_imp_1_OUT`.`impter_56`, `ADS_imp_1_OUT`.`impter_57`, `ADS_imp_1_OUT`.`impter_58`, `ADS_imp_1_OUT`.`impter_59`, `ADS_imp_1_OUT`.`impter_60`, `ADS_imp_1_OUT`.`impter_61`, `ADS_imp_1_OUT`.`impter_62`, `ADS_imp_1_OUT`.`impter_63`, `ADS_imp_1_OUT`.`impter_64`, `ADS_imp_1_OUT`.`impter_65`, `ADS_imp_1_OUT`.`impter_66`, `ADS_imp_1_OUT`.`impter_67`, `ADS_imp_1_OUT`.`impter_68`, `ADS_imp_1_OUT`.`impter_69`, `ADS_imp_1_OUT`.`impter_70`, `ADS_imp_1_OUT`.`impter_71`, `ADS_imp_1_OUT`.`impter_72`, `ADS_imp_1_OUT`.`impter_73`, `ADS_imp_1_OUT`.`impter_74`, `ADS_imp_1_OUT`.`impter_75`, `ADS_imp_1_OUT`.`impter_76`, `ADS_imp_1_OUT`.`impter_77`, `ADS_imp_1_OUT`.`impter_78`, `ADS_imp_1_OUT`.`impter_79`, `ADS_imp_1_OUT`.`impter_80`, `ADS_imp_1_OUT`.`impter_81`, `ADS_imp_1_OUT`.`impter_82`, `ADS_imp_1_OUT`.`impter_83`, `ADS_imp_1_OUT`.`impter_84`, `ADS_imp_1_OUT`.`impter_85`, `ADS_imp_1_OUT`.`impter_86`, `ADS_imp_1_OUT`.`impter_87`, `ADS_imp_1_OUT`.`impter_88`, `ADS_imp_1_OUT`.`impter_89`, `ADS_imp_1_OUT`.`impter_90`, `ADS_imp_1_OUT`.`impter_91`, `ADS_imp_1_OUT`.`impter_92`, `ADS_imp_1_OUT`.`impter_93`, `ADS_imp_1_OUT`.`impter_94`, `ADS_imp_1_OUT`.`impter_95`, `ADS_imp_1_OUT`.`impter_96`, `ADS_imp_1_OUT`.`impter_97`, `ADS_imp_1_OUT`.`impter_98`, `ADS_imp_1_OUT`.`impter_99`, `ADS_imp_1_OUT`.`impter_100`, `ADS_imp_1_OUT`.`impter_101` 
FROM (SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN -0.0014807007689716506 ELSE `ADS`.`Feature_0` END AS `impter_2`, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 0.08599214990681354 ELSE `ADS`.`Feature_1` END AS `impter_3`, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN -0.006358164676411468 ELSE `ADS`.`Feature_2` END AS `impter_4`, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN -0.024301807422776375 ELSE `ADS`.`Feature_3` END AS `impter_5`, CASE WHEN (`ADS`.`Feature_4` IS NULL) THEN 0.015786548044298444 ELSE `ADS`.`Feature_4` END AS `impter_6`, CASE WHEN (`ADS`.`Feature_5` IS NULL) THEN -0.13959329445651672 ELSE `ADS`.`Feature_5` END AS `impter_7`, CASE WHEN (`ADS`.`Feature_6` IS NULL) THEN -0.06476745048019888 ELSE `ADS`.`Feature_6` END AS `impter_8`, CASE WHEN (`ADS`.`Feature_7` IS NULL) THEN 0.025579810774090658 ELSE `ADS`.`Feature_7` END AS `impter_9`, CASE WHEN (`ADS`.`Feature_8` IS NULL) THEN -0.03173937260977112 ELSE `ADS`.`Feature_8` END AS `impter_10`, CASE WHEN (`ADS`.`Feature_9` IS NULL) THEN -0.1518141420862488 ELSE `ADS`.`Feature_9` END AS `impter_11`, CASE WHEN (`ADS`.`Feature_10` IS NULL) THEN -0.13244576558492482 ELSE `ADS`.`Feature_10` END AS `impter_12`, CASE WHEN (`ADS`.`Feature_11` IS NULL) THEN 0.044172679762224144 ELSE `ADS`.`Feature_11` END AS `impter_13`, CASE WHEN (`ADS`.`Feature_12` IS NULL) THEN 0.010165946719810038 ELSE `ADS`.`Feature_12` END AS `impter_14`, CASE WHEN (`ADS`.`Feature_13` IS NULL) THEN -0.03645872019103299 ELSE `ADS`.`Feature_13` END AS `impter_15`, CASE WHEN (`ADS`.`Feature_14` IS NULL) THEN 0.06491512811593925 ELSE `ADS`.`Feature_14` END AS `impter_16`, CASE WHEN (`ADS`.`Feature_15` IS NULL) THEN -0.11930146867074032 ELSE `ADS`.`Feature_15` END AS `impter_17`, CASE WHEN (`ADS`.`Feature_16` IS NULL) THEN 0.007738863934852773 ELSE `ADS`.`Feature_16` END AS `impter_18`, CASE WHEN (`ADS`.`Feature_17` IS NULL) THEN -0.1226774060147726 ELSE `ADS`.`Feature_17` END AS `impter_19`, CASE WHEN (`ADS`.`Feature_18` IS NULL) THEN 0.019160881669086405 ELSE `ADS`.`Feature_18` END AS `impter_20`, CASE WHEN (`ADS`.`Feature_19` IS NULL) THEN -0.26340351121131067 ELSE `ADS`.`Feature_19` END AS `impter_21`, CASE WHEN (`ADS`.`Feature_20` IS NULL) THEN 0.035692361937735194 ELSE `ADS`.`Feature_20` END AS `impter_22`, CASE WHEN (`ADS`.`Feature_21` IS NULL) THEN -0.010021324964069293 ELSE `ADS`.`Feature_21` END AS `impter_23`, CASE WHEN (`ADS`.`Feature_22` IS NULL) THEN -0.1258614387723542 ELSE `ADS`.`Feature_22` END AS `impter_24`, CASE WHEN (`ADS`.`Feature_23` IS NULL) THEN 0.09372773898231128 ELSE `ADS`.`Feature_23` END AS `impter_25`, CASE WHEN (`ADS`.`Feature_24` IS NULL) THEN -0.1687929597880227 ELSE `ADS`.`Feature_24` END AS `impter_26`, CASE WHEN (`ADS`.`Feature_25` IS NULL) THEN 0.10006283199629364 ELSE `ADS`.`Feature_25` END AS `impter_27`, CASE WHEN (`ADS`.`Feature_26` IS NULL) THEN -0.10297858086822659 ELSE `ADS`.`Feature_26` END AS `impter_28`, CASE WHEN (`ADS`.`Feature_27` IS NULL) THEN 0.19240514535870415 ELSE `ADS`.`Feature_27` END AS `impter_29`, CASE WHEN (`ADS`.`Feature_28` IS NULL) THEN -0.052866434246092435 ELSE `ADS`.`Feature_28` END AS `impter_30`, CASE WHEN (`ADS`.`Feature_29` IS NULL) THEN 0.2624612146366151 ELSE `ADS`.`Feature_29` END AS `impter_31`, CASE WHEN (`ADS`.`Feature_30` IS NULL) THEN 0.002677575140361194 ELSE `ADS`.`Feature_30` END AS `impter_32`, CASE WHEN (`ADS`.`Feature_31` IS NULL) THEN 0.09707041941284063 ELSE `ADS`.`Feature_31` END AS `impter_33`, CASE WHEN (`ADS`.`Feature_32` IS NULL) THEN -0.032793219857333473 ELSE `ADS`.`Feature_32` END AS `impter_34`, CASE WHEN (`ADS`.`Feature_33` IS NULL) THEN -0.003130273745908922 ELSE `ADS`.`Feature_33` END AS `impter_35`, CASE WHEN (`ADS`.`Feature_34` IS NULL) THEN 0.053446276216279974 ELSE `ADS`.`Feature_34` END AS `impter_36`, CASE WHEN (`ADS`.`Feature_35` IS NULL) THEN -0.18668146437412367 ELSE `ADS`.`Feature_35` END AS `impter_37`, CASE WHEN (`ADS`.`Feature_36` IS NULL) THEN -0.029335964960866243 ELSE `ADS`.`Feature_36` END AS `impter_38`, CASE WHEN (`ADS`.`Feature_37` IS NULL) THEN 0.07219772199502426 ELSE `ADS`.`Feature_37` END AS `impter_39`, CASE WHEN (`ADS`.`Feature_38` IS NULL) THEN -0.0007762839781489412 ELSE `ADS`.`Feature_38` END AS `impter_40`, CASE WHEN (`ADS`.`Feature_39` IS NULL) THEN 0.08270823712098274 ELSE `ADS`.`Feature_39` END AS `impter_41`, CASE WHEN (`ADS`.`Feature_40` IS NULL) THEN 0.10432022852347983 ELSE `ADS`.`Feature_40` END AS `impter_42`, CASE WHEN (`ADS`.`Feature_41` IS NULL) THEN 0.07058566385022276 ELSE `ADS`.`Feature_41` END AS `impter_43`, CASE WHEN (`ADS`.`Feature_42` IS NULL) THEN 0.05096693098357383 ELSE `ADS`.`Feature_42` END AS `impter_44`, CASE WHEN (`ADS`.`Feature_43` IS NULL) THEN 0.0660758203367818 ELSE `ADS`.`Feature_43` END AS `impter_45`, CASE WHEN (`ADS`.`Feature_44` IS NULL) THEN -0.07075895636353369 ELSE `ADS`.`Feature_44` END AS `impter_46`, CASE WHEN (`ADS`.`Feature_45` IS NULL) THEN 0.08422536561649958 ELSE `ADS`.`Feature_45` END AS `impter_47`, CASE WHEN (`ADS`.`Feature_46` IS NULL) THEN 0.21367580667795616 ELSE `ADS`.`Feature_46` END AS `impter_48`, CASE WHEN (`ADS`.`Feature_47` IS NULL) THEN -0.055897457335624984 ELSE `ADS`.`Feature_47` END AS `impter_49`, CASE WHEN (`ADS`.`Feature_48` IS NULL) THEN -0.17453036726139817 ELSE `ADS`.`Feature_48` END AS `impter_50`, CASE WHEN (`ADS`.`Feature_49` IS NULL) THEN -0.054944001818473996 ELSE `ADS`.`Feature_49` END AS `impter_51`, CASE WHEN (`ADS`.`Feature_50` IS NULL) THEN -0.5961651261710368 ELSE `ADS`.`Feature_50` END AS `impter_52`, CASE WHEN (`ADS`.`Feature_51` IS NULL) THEN 0.5020404526565605 ELSE `ADS`.`Feature_51` END AS `impter_53`, CASE WHEN (`ADS`.`Feature_52` IS NULL) THEN -0.052340545201383926 ELSE `ADS`.`Feature_52` END AS `impter_54`, CASE WHEN (`ADS`.`Feature_53` IS NULL) THEN 0.05294307611674654 ELSE `ADS`.`Feature_53` END AS `impter_55`, CASE WHEN (`ADS`.`Feature_54` IS NULL) THEN 0.03835884479069335 ELSE `ADS`.`Feature_54` END AS `impter_56`, CASE WHEN (`ADS`.`Feature_55` IS NULL) THEN -0.13571979014964694 ELSE `ADS`.`Feature_55` END AS `impter_57`, CASE WHEN (`ADS`.`Feature_56` IS NULL) THEN -0.21903068431411843 ELSE `ADS`.`Feature_56` END AS `impter_58`, CASE WHEN (`ADS`.`Feature_57` IS NULL) THEN -0.1191752362029383 ELSE `ADS`.`Feature_57` END AS `impter_59`, CASE WHEN (`ADS`.`Feature_58` IS NULL) THEN 0.38058346912807667 ELSE `ADS`.`Feature_58` END AS `impter_60`, CASE WHEN (`ADS`.`Feature_59` IS NULL) THEN -0.12720928974168508 ELSE `ADS`.`Feature_59` END AS `impter_61`, CASE WHEN (`ADS`.`Feature_60` IS NULL) THEN -0.09072936496613782 ELSE `ADS`.`Feature_60` END AS `impter_62`, CASE WHEN (`ADS`.`Feature_61` IS NULL) THEN -0.03915125937954538 ELSE `ADS`.`Feature_61` END AS `impter_63`, CASE WHEN (`ADS`.`Feature_62` IS NULL) THEN 0.07075412393313481 ELSE `ADS`.`Feature_62` END AS `impter_64`, CASE WHEN (`ADS`.`Feature_63` IS NULL) THEN 0.10124894587016948 ELSE `ADS`.`Feature_63` END AS `impter_65`, CASE WHEN (`ADS`.`Feature_64` IS NULL) THEN -0.1945661449475579 ELSE `ADS`.`Feature_64` END AS `impter_66`, CASE WHEN (`ADS`.`Feature_65` IS NULL) THEN -0.1759482981261233 ELSE `ADS`.`Feature_65` END AS `impter_67`, CASE WHEN (`ADS`.`Feature_66` IS NULL) THEN 0.07473228971855511 ELSE `ADS`.`Feature_66` END AS `impter_68`, CASE WHEN (`ADS`.`Feature_67` IS NULL) THEN 0.0377705562115906 ELSE `ADS`.`Feature_67` END AS `impter_69`, CASE WHEN (`ADS`.`Feature_68` IS NULL) THEN 0.0139470898598917 ELSE `ADS`.`Feature_68` END AS `impter_70`, CASE WHEN (`ADS`.`Feature_69` IS NULL) THEN 0.2582685725145942 ELSE `ADS`.`Feature_69` END AS `impter_71`, CASE WHEN (`ADS`.`Feature_70` IS NULL) THEN 0.022975786233048922 ELSE `ADS`.`Feature_70` END AS `impter_72`, CASE WHEN (`ADS`.`Feature_71` IS NULL) THEN 0.17445434061949525 ELSE `ADS`.`Feature_71` END AS `impter_73`, CASE WHEN (`ADS`.`Feature_72` IS NULL) THEN -0.011413879692078346 ELSE `ADS`.`Feature_72` END AS `impter_74`, CASE WHEN (`ADS`.`Feature_73` IS NULL) THEN 0.07898984156871978 ELSE `ADS`.`Feature_73` END AS `impter_75`, CASE WHEN (`ADS`.`Feature_74` IS NULL) THEN 0.0952547273770713 ELSE `ADS`.`Feature_74` END AS `impter_76`, CASE WHEN (`ADS`.`Feature_75` IS NULL) THEN -0.03997776839639901 ELSE `ADS`.`Feature_75` END AS `impter_77`, CASE WHEN (`ADS`.`Feature_76` IS NULL) THEN -0.020839895874293496 ELSE `ADS`.`Feature_76` END AS `impter_78`, CASE WHEN (`ADS`.`Feature_77` IS NULL) THEN -0.07284631986613152 ELSE `ADS`.`Feature_77` END AS `impter_79`, CASE WHEN (`ADS`.`Feature_78` IS NULL) THEN -0.27389951764434384 ELSE `ADS`.`Feature_78` END AS `impter_80`, CASE WHEN (`ADS`.`Feature_79` IS NULL) THEN 0.08057287885287609 ELSE `ADS`.`Feature_79` END AS `impter_81`, CASE WHEN (`ADS`.`Feature_80` IS NULL) THEN -0.06244274245437891 ELSE `ADS`.`Feature_80` END AS `impter_82`, CASE WHEN (`ADS`.`Feature_81` IS NULL) THEN -0.12290855334066887 ELSE `ADS`.`Feature_81` END AS `impter_83`, CASE WHEN (`ADS`.`Feature_82` IS NULL) THEN 0.11639531793890918 ELSE `ADS`.`Feature_82` END AS `impter_84`, CASE WHEN (`ADS`.`Feature_83` IS NULL) THEN -0.03350462786128603 ELSE `ADS`.`Feature_83` END AS `impter_85`, CASE WHEN (`ADS`.`Feature_84` IS NULL) THEN -0.03914049968144583 ELSE `ADS`.`Feature_84` END AS `impter_86`, CASE WHEN (`ADS`.`Feature_85` IS NULL) THEN 0.24193903072305167 ELSE `ADS`.`Feature_85` END AS `impter_87`, CASE WHEN (`ADS`.`Feature_86` IS NULL) THEN -0.07389719862221904 ELSE `ADS`.`Feature_86` END AS `impter_88`, CASE WHEN (`ADS`.`Feature_87` IS NULL) THEN 0.1400756228320113 ELSE `ADS`.`Feature_87` END AS `impter_89`, CASE WHEN (`ADS`.`Feature_88` IS NULL) THEN 0.2765301935136145 ELSE `ADS`.`Feature_88` END AS `impter_90`, CASE WHEN (`ADS`.`Feature_89` IS NULL) THEN -0.07957147169250885 ELSE `ADS`.`Feature_89` END AS `impter_91`, CASE WHEN (`ADS`.`Feature_90` IS NULL) THEN 0.16295767680642717 ELSE `ADS`.`Feature_90` END AS `impter_92`, CASE WHEN (`ADS`.`Feature_91` IS NULL) THEN 0.07062813888509549 ELSE `ADS`.`Feature_91` END AS `impter_93`, CASE WHEN (`ADS`.`Feature_92` IS NULL) THEN 0.012995630151896219 ELSE `ADS`.`Feature_92` END AS `impter_94`, CASE WHEN (`ADS`.`Feature_93` IS NULL) THEN 0.1055212408190415 ELSE `ADS`.`Feature_93` END AS `impter_95`, CASE WHEN (`ADS`.`Feature_94` IS NULL) THEN -0.1408434425354362 ELSE `ADS`.`Feature_94` END AS `impter_96`, CASE WHEN (`ADS`.`Feature_95` IS NULL) THEN -0.1574012366732725 ELSE `ADS`.`Feature_95` END AS `impter_97`, CASE WHEN (`ADS`.`Feature_96` IS NULL) THEN 0.05477536676313335 ELSE `ADS`.`Feature_96` END AS `impter_98`, CASE WHEN (`ADS`.`Feature_97` IS NULL) THEN 0.05673272205919614 ELSE `ADS`.`Feature_97` END AS `impter_99`, CASE WHEN (`ADS`.`Feature_98` IS NULL) THEN -0.14226649213619527 ELSE `ADS`.`Feature_98` END AS `impter_100`, CASE WHEN (`ADS`.`Feature_99` IS NULL) THEN -0.04042675289131955 ELSE `ADS`.`Feature_99` END AS `impter_101` 
FROM `FourClass_100` AS `ADS`) AS `ADS_imp_1_OUT`

-- Code For temporary table tmp_20180602143620_oq6_ads_imp_1_out part 2. Populate

SELECT * FROM `tmp_20180602143620_oq6_ads_imp_1_out`

-- Code For temporary table tmp_20180602143620_57h_ads_sca_2_out part 1. Create 

CREATE TEMPORARY TABLE `tmp_20180602143620_57h_ads_sca_2_out` STORED AS ORC AS SELECT `ADS_sca_2_OUT`.`KEY`, `ADS_sca_2_OUT`.`scaler_2`, `ADS_sca_2_OUT`.`scaler_3`, `ADS_sca_2_OUT`.`scaler_4`, `ADS_sca_2_OUT`.`scaler_5`, `ADS_sca_2_OUT`.`scaler_6`, `ADS_sca_2_OUT`.`scaler_7`, `ADS_sca_2_OUT`.`scaler_8`, `ADS_sca_2_OUT`.`scaler_9`, `ADS_sca_2_OUT`.`scaler_10`, `ADS_sca_2_OUT`.`scaler_11`, `ADS_sca_2_OUT`.`scaler_12`, `ADS_sca_2_OUT`.`scaler_13`, `ADS_sca_2_OUT`.`scaler_14`, `ADS_sca_2_OUT`.`scaler_15`, `ADS_sca_2_OUT`.`scaler_16`, `ADS_sca_2_OUT`.`scaler_17`, `ADS_sca_2_OUT`.`scaler_18`, `ADS_sca_2_OUT`.`scaler_19`, `ADS_sca_2_OUT`.`scaler_20`, `ADS_sca_2_OUT`.`scaler_21`, `ADS_sca_2_OUT`.`scaler_22`, `ADS_sca_2_OUT`.`scaler_23`, `ADS_sca_2_OUT`.`scaler_24`, `ADS_sca_2_OUT`.`scaler_25`, `ADS_sca_2_OUT`.`scaler_26`, `ADS_sca_2_OUT`.`scaler_27`, `ADS_sca_2_OUT`.`scaler_28`, `ADS_sca_2_OUT`.`scaler_29`, `ADS_sca_2_OUT`.`scaler_30`, `ADS_sca_2_OUT`.`scaler_31`, `ADS_sca_2_OUT`.`scaler_32`, `ADS_sca_2_OUT`.`scaler_33`, `ADS_sca_2_OUT`.`scaler_34`, `ADS_sca_2_OUT`.`scaler_35`, `ADS_sca_2_OUT`.`scaler_36`, `ADS_sca_2_OUT`.`scaler_37`, `ADS_sca_2_OUT`.`scaler_38`, `ADS_sca_2_OUT`.`scaler_39`, `ADS_sca_2_OUT`.`scaler_40`, `ADS_sca_2_OUT`.`scaler_41`, `ADS_sca_2_OUT`.`scaler_42`, `ADS_sca_2_OUT`.`scaler_43`, `ADS_sca_2_OUT`.`scaler_44`, `ADS_sca_2_OUT`.`scaler_45`, `ADS_sca_2_OUT`.`scaler_46`, `ADS_sca_2_OUT`.`scaler_47`, `ADS_sca_2_OUT`.`scaler_48`, `ADS_sca_2_OUT`.`scaler_49`, `ADS_sca_2_OUT`.`scaler_50`, `ADS_sca_2_OUT`.`scaler_51`, `ADS_sca_2_OUT`.`scaler_52`, `ADS_sca_2_OUT`.`scaler_53`, `ADS_sca_2_OUT`.`scaler_54`, `ADS_sca_2_OUT`.`scaler_55`, `ADS_sca_2_OUT`.`scaler_56`, `ADS_sca_2_OUT`.`scaler_57`, `ADS_sca_2_OUT`.`scaler_58`, `ADS_sca_2_OUT`.`scaler_59`, `ADS_sca_2_OUT`.`scaler_60`, `ADS_sca_2_OUT`.`scaler_61`, `ADS_sca_2_OUT`.`scaler_62`, `ADS_sca_2_OUT`.`scaler_63`, `ADS_sca_2_OUT`.`scaler_64`, `ADS_sca_2_OUT`.`scaler_65`, `ADS_sca_2_OUT`.`scaler_66`, `ADS_sca_2_OUT`.`scaler_67`, `ADS_sca_2_OUT`.`scaler_68`, `ADS_sca_2_OUT`.`scaler_69`, `ADS_sca_2_OUT`.`scaler_70`, `ADS_sca_2_OUT`.`scaler_71`, `ADS_sca_2_OUT`.`scaler_72`, `ADS_sca_2_OUT`.`scaler_73`, `ADS_sca_2_OUT`.`scaler_74`, `ADS_sca_2_OUT`.`scaler_75`, `ADS_sca_2_OUT`.`scaler_76`, `ADS_sca_2_OUT`.`scaler_77`, `ADS_sca_2_OUT`.`scaler_78`, `ADS_sca_2_OUT`.`scaler_79`, `ADS_sca_2_OUT`.`scaler_80`, `ADS_sca_2_OUT`.`scaler_81`, `ADS_sca_2_OUT`.`scaler_82`, `ADS_sca_2_OUT`.`scaler_83`, `ADS_sca_2_OUT`.`scaler_84`, `ADS_sca_2_OUT`.`scaler_85`, `ADS_sca_2_OUT`.`scaler_86`, `ADS_sca_2_OUT`.`scaler_87`, `ADS_sca_2_OUT`.`scaler_88`, `ADS_sca_2_OUT`.`scaler_89`, `ADS_sca_2_OUT`.`scaler_90`, `ADS_sca_2_OUT`.`scaler_91`, `ADS_sca_2_OUT`.`scaler_92`, `ADS_sca_2_OUT`.`scaler_93`, `ADS_sca_2_OUT`.`scaler_94`, `ADS_sca_2_OUT`.`scaler_95`, `ADS_sca_2_OUT`.`scaler_96`, `ADS_sca_2_OUT`.`scaler_97`, `ADS_sca_2_OUT`.`scaler_98`, `ADS_sca_2_OUT`.`scaler_99`, `ADS_sca_2_OUT`.`scaler_100`, `ADS_sca_2_OUT`.`scaler_101` 
FROM (SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.`impter_2` AS DOUBLE) - -0.0014807007689716506) / 0.9211229790312512 AS `scaler_2`, (CAST(`ADS_imp_1_OUT`.`impter_3` AS DOUBLE) - 0.08599214990681354) / 0.9627516809237073 AS `scaler_3`, (CAST(`ADS_imp_1_OUT`.`impter_4` AS DOUBLE) - -0.006358164676411468) / 0.7890687835102894 AS `scaler_4`, (CAST(`ADS_imp_1_OUT`.`impter_5` AS DOUBLE) - -0.024301807422776375) / 1.0265272189083172 AS `scaler_5`, (CAST(`ADS_imp_1_OUT`.`impter_6` AS DOUBLE) - 0.015786548044298444) / 1.0198090908026474 AS `scaler_6`, (CAST(`ADS_imp_1_OUT`.`impter_7` AS DOUBLE) - -0.13959329445651672) / 0.9185551763293686 AS `scaler_7`, (CAST(`ADS_imp_1_OUT`.`impter_8` AS DOUBLE) - -0.06476745048019888) / 1.0393547249617474 AS `scaler_8`, (CAST(`ADS_imp_1_OUT`.`impter_9` AS DOUBLE) - 0.025579810774090658) / 0.8722131294644917 AS `scaler_9`, (CAST(`ADS_imp_1_OUT`.`impter_10` AS DOUBLE) - -0.03173937260977112) / 1.0164588299091024 AS `scaler_10`, (CAST(`ADS_imp_1_OUT`.`impter_11` AS DOUBLE) - -0.1518141420862488) / 1.0075402114297496 AS `scaler_11`, (CAST(`ADS_imp_1_OUT`.`impter_12` AS DOUBLE) - -0.13244576558492482) / 0.9215325459816371 AS `scaler_12`, (CAST(`ADS_imp_1_OUT`.`impter_13` AS DOUBLE) - 0.044172679762224144) / 0.9053279964066308 AS `scaler_13`, (CAST(`ADS_imp_1_OUT`.`impter_14` AS DOUBLE) - 0.010165946719810038) / 1.2190371046063362 AS `scaler_14`, (CAST(`ADS_imp_1_OUT`.`impter_15` AS DOUBLE) - -0.03645872019103299) / 1.0879005786584215 AS `scaler_15`, (CAST(`ADS_imp_1_OUT`.`impter_16` AS DOUBLE) - 0.06491512811593925) / 1.0274670201407186 AS `scaler_16`, (CAST(`ADS_imp_1_OUT`.`impter_17` AS DOUBLE) - -0.11930146867074032) / 0.9506312349761404 AS `scaler_17`, (CAST(`ADS_imp_1_OUT`.`impter_18` AS DOUBLE) - 0.007738863934852773) / 1.0928477585203984 AS `scaler_18`, (CAST(`ADS_imp_1_OUT`.`impter_19` AS DOUBLE) - -0.1226774060147726) / 0.9830561715965196 AS `scaler_19`, (CAST(`ADS_imp_1_OUT`.`impter_20` AS DOUBLE) - 0.019160881669086405) / 1.2117417920836373 AS `scaler_20`, (CAST(`ADS_imp_1_OUT`.`impter_21` AS DOUBLE) - -0.26340351121131067) / 0.9807419262255984 AS `scaler_21`, (CAST(`ADS_imp_1_OUT`.`impter_22` AS DOUBLE) - 0.035692361937735194) / 1.115824498468156 AS `scaler_22`, (CAST(`ADS_imp_1_OUT`.`impter_23` AS DOUBLE) - -0.010021324964069293) / 1.0790959803413318 AS `scaler_23`, (CAST(`ADS_imp_1_OUT`.`impter_24` AS DOUBLE) - -0.1258614387723542) / 1.0279672611547366 AS `scaler_24`, (CAST(`ADS_imp_1_OUT`.`impter_25` AS DOUBLE) - 0.09372773898231128) / 0.9690760299303989 AS `scaler_25`, (CAST(`ADS_imp_1_OUT`.`impter_26` AS DOUBLE) - -0.1687929597880227) / 0.8845858581996813 AS `scaler_26`, (CAST(`ADS_imp_1_OUT`.`impter_27` AS DOUBLE) - 0.10006283199629364) / 0.9149346104000894 AS `scaler_27`, (CAST(`ADS_imp_1_OUT`.`impter_28` AS DOUBLE) - -0.10297858086822659) / 1.0761397500557328 AS `scaler_28`, (CAST(`ADS_imp_1_OUT`.`impter_29` AS DOUBLE) - 0.19240514535870415) / 2.089882492597775 AS `scaler_29`, (CAST(`ADS_imp_1_OUT`.`impter_30` AS DOUBLE) - -0.052866434246092435) / 1.0030777529896888 AS `scaler_30`, (CAST(`ADS_imp_1_OUT`.`impter_31` AS DOUBLE) - 0.2624612146366151) / 1.9778491038473625 AS `scaler_31`, (CAST(`ADS_imp_1_OUT`.`impter_32` AS DOUBLE) - 0.002677575140361194) / 0.8833924915211555 AS `scaler_32`, (CAST(`ADS_imp_1_OUT`.`impter_33` AS DOUBLE) - 0.09707041941284063) / 0.8720005351713555 AS `scaler_33`, (CAST(`ADS_imp_1_OUT`.`impter_34` AS DOUBLE) - -0.032793219857333473) / 0.8745989090443193 AS `scaler_34`, (CAST(`ADS_imp_1_OUT`.`impter_35` AS DOUBLE) - -0.003130273745908922) / 0.9967699097535561 AS `scaler_35`, (CAST(`ADS_imp_1_OUT`.`impter_36` AS DOUBLE) - 0.053446276216279974) / 0.9997289112199433 AS `scaler_36`, (CAST(`ADS_imp_1_OUT`.`impter_37` AS DOUBLE) - -0.18668146437412367) / 1.0272287171310865 AS `scaler_37`, (CAST(`ADS_imp_1_OUT`.`impter_38` AS DOUBLE) - -0.029335964960866243) / 1.0427555960451658 AS `scaler_38`, (CAST(`ADS_imp_1_OUT`.`impter_39` AS DOUBLE) - 0.07219772199502426) / 0.8328229890456742 AS `scaler_39`, (CAST(`ADS_imp_1_OUT`.`impter_40` AS DOUBLE) - -0.0007762839781489412) / 0.9666524356457794 AS `scaler_40`, (CAST(`ADS_imp_1_OUT`.`impter_41` AS DOUBLE) - 0.08270823712098274) / 1.083670494683493 AS `scaler_41`, (CAST(`ADS_imp_1_OUT`.`impter_42` AS DOUBLE) - 0.10432022852347983) / 1.075472547982714 AS `scaler_42`, (CAST(`ADS_imp_1_OUT`.`impter_43` AS DOUBLE) - 0.07058566385022276) / 0.9993462791463713 AS `scaler_43`, (CAST(`ADS_imp_1_OUT`.`impter_44` AS DOUBLE) - 0.05096693098357383) / 0.8876971252794036 AS `scaler_44`, (CAST(`ADS_imp_1_OUT`.`impter_45` AS DOUBLE) - 0.0660758203367818) / 1.041246125313479 AS `scaler_45`, (CAST(`ADS_imp_1_OUT`.`impter_46` AS DOUBLE) - -0.07075895636353369) / 2.238310207242139 AS `scaler_46`, (CAST(`ADS_imp_1_OUT`.`impter_47` AS DOUBLE) - 0.08422536561649958) / 0.9520959686676432 AS `scaler_47`, (CAST(`ADS_imp_1_OUT`.`impter_48` AS DOUBLE) - 0.21367580667795616) / 0.9907230316111766 AS `scaler_48`, (CAST(`ADS_imp_1_OUT`.`impter_49` AS DOUBLE) - -0.055897457335624984) / 1.0392400714320487 AS `scaler_49`, (CAST(`ADS_imp_1_OUT`.`impter_50` AS DOUBLE) - -0.17453036726139817) / 2.001507098381001 AS `scaler_50`, (CAST(`ADS_imp_1_OUT`.`impter_51` AS DOUBLE) - -0.054944001818473996) / 1.0041645540091246 AS `scaler_51`, (CAST(`ADS_imp_1_OUT`.`impter_52` AS DOUBLE) - -0.5961651261710368) / 2.467511153399545 AS `scaler_52`, (CAST(`ADS_imp_1_OUT`.`impter_53` AS DOUBLE) - 0.5020404526565605) / 2.1929325118287792 AS `scaler_53`, (CAST(`ADS_imp_1_OUT`.`impter_54` AS DOUBLE) - -0.052340545201383926) / 0.98465558791252 AS `scaler_54`, (CAST(`ADS_imp_1_OUT`.`impter_55` AS DOUBLE) - 0.05294307611674654) / 1.8137042567337183 AS `scaler_55`, (CAST(`ADS_imp_1_OUT`.`impter_56` AS DOUBLE) - 0.03835884479069335) / 0.9241326354411343 AS `scaler_56`, (CAST(`ADS_imp_1_OUT`.`impter_57` AS DOUBLE) - -0.13571979014964694) / 0.8679095755948701 AS `scaler_57`, (CAST(`ADS_imp_1_OUT`.`impter_58` AS DOUBLE) - -0.21903068431411843) / 4.150428869748413 AS `scaler_58`, (CAST(`ADS_imp_1_OUT`.`impter_59` AS DOUBLE) - -0.1191752362029383) / 0.9123333408128436 AS `scaler_59`, (CAST(`ADS_imp_1_OUT`.`impter_60` AS DOUBLE) - 0.38058346912807667) / 3.5635011086986927 AS `scaler_60`, (CAST(`ADS_imp_1_OUT`.`impter_61` AS DOUBLE) - -0.12720928974168508) / 0.9301024475991629 AS `scaler_61`, (CAST(`ADS_imp_1_OUT`.`impter_62` AS DOUBLE) - -0.09072936496613782) / 0.9490501277306023 AS `scaler_62`, (CAST(`ADS_imp_1_OUT`.`impter_63` AS DOUBLE) - -0.03915125937954538) / 0.9029504608473613 AS `scaler_63`, (CAST(`ADS_imp_1_OUT`.`impter_64` AS DOUBLE) - 0.07075412393313481) / 0.9726561682528103 AS `scaler_64`, (CAST(`ADS_imp_1_OUT`.`impter_65` AS DOUBLE) - 0.10124894587016948) / 0.9403075920249493 AS `scaler_65`, (CAST(`ADS_imp_1_OUT`.`impter_66` AS DOUBLE) - -0.1945661449475579) / 0.9400903625732654 AS `scaler_66`, (CAST(`ADS_imp_1_OUT`.`impter_67` AS DOUBLE) - -0.1759482981261233) / 0.9435422049943787 AS `scaler_67`, (CAST(`ADS_imp_1_OUT`.`impter_68` AS DOUBLE) - 0.07473228971855511) / 0.8871003964319768 AS `scaler_68`, (CAST(`ADS_imp_1_OUT`.`impter_69` AS DOUBLE) - 0.0377705562115906) / 1.0228978549196588 AS `scaler_69`, (CAST(`ADS_imp_1_OUT`.`impter_70` AS DOUBLE) - 0.0139470898598917) / 0.9465728329079491 AS `scaler_70`, (CAST(`ADS_imp_1_OUT`.`impter_71` AS DOUBLE) - 0.2582685725145942) / 1.1027232016521478 AS `scaler_71`, (CAST(`ADS_imp_1_OUT`.`impter_72` AS DOUBLE) - 0.022975786233048922) / 0.9200436904809381 AS `scaler_72`, (CAST(`ADS_imp_1_OUT`.`impter_73` AS DOUBLE) - 0.17445434061949525) / 0.9009964742482128 AS `scaler_73`, (CAST(`ADS_imp_1_OUT`.`impter_74` AS DOUBLE) - -0.011413879692078346) / 0.9483377025565977 AS `scaler_74`, (CAST(`ADS_imp_1_OUT`.`impter_75` AS DOUBLE) - 0.07898984156871978) / 0.9726668138861088 AS `scaler_75`, (CAST(`ADS_imp_1_OUT`.`impter_76` AS DOUBLE) - 0.0952547273770713) / 0.9607867245873394 AS `scaler_76`, (CAST(`ADS_imp_1_OUT`.`impter_77` AS DOUBLE) - -0.03997776839639901) / 1.0318828686080972 AS `scaler_77`, (CAST(`ADS_imp_1_OUT`.`impter_78` AS DOUBLE) - -0.020839895874293496) / 0.945141993694461 AS `scaler_78`, (CAST(`ADS_imp_1_OUT`.`impter_79` AS DOUBLE) - -0.07284631986613152) / 0.9103416784348913 AS `scaler_79`, (CAST(`ADS_imp_1_OUT`.`impter_80` AS DOUBLE) - -0.27389951764434384) / 2.0362603862996735 AS `scaler_80`, (CAST(`ADS_imp_1_OUT`.`impter_81` AS DOUBLE) - 0.08057287885287609) / 0.9919292944224015 AS `scaler_81`, (CAST(`ADS_imp_1_OUT`.`impter_82` AS DOUBLE) - -0.06244274245437891) / 0.8113039293824552 AS `scaler_82`, (CAST(`ADS_imp_1_OUT`.`impter_83` AS DOUBLE) - -0.12290855334066887) / 1.0307302654711112 AS `scaler_83`, (CAST(`ADS_imp_1_OUT`.`impter_84` AS DOUBLE) - 0.11639531793890918) / 0.9993591951135242 AS `scaler_84`, (CAST(`ADS_imp_1_OUT`.`impter_85` AS DOUBLE) - -0.03350462786128603) / 1.0197598648594488 AS `scaler_85`, (CAST(`ADS_imp_1_OUT`.`impter_86` AS DOUBLE) - -0.03914049968144583) / 0.9022051622058084 AS `scaler_86`, (CAST(`ADS_imp_1_OUT`.`impter_87` AS DOUBLE) - 0.24193903072305167) / 0.9625742678392476 AS `scaler_87`, (CAST(`ADS_imp_1_OUT`.`impter_88` AS DOUBLE) - -0.07389719862221904) / 1.0080070985430696 AS `scaler_88`, (CAST(`ADS_imp_1_OUT`.`impter_89` AS DOUBLE) - 0.1400756228320113) / 0.9315791274848828 AS `scaler_89`, (CAST(`ADS_imp_1_OUT`.`impter_90` AS DOUBLE) - 0.2765301935136145) / 1.9455982323178656 AS `scaler_90`, (CAST(`ADS_imp_1_OUT`.`impter_91` AS DOUBLE) - -0.07957147169250885) / 0.9688848077884671 AS `scaler_91`, (CAST(`ADS_imp_1_OUT`.`impter_92` AS DOUBLE) - 0.16295767680642717) / 0.8952741904110189 AS `scaler_92`, (CAST(`ADS_imp_1_OUT`.`impter_93` AS DOUBLE) - 0.07062813888509549) / 0.8331748322730601 AS `scaler_93`, (CAST(`ADS_imp_1_OUT`.`impter_94` AS DOUBLE) - 0.012995630151896219) / 1.059167248118017 AS `scaler_94`, (CAST(`ADS_imp_1_OUT`.`impter_95` AS DOUBLE) - 0.1055212408190415) / 1.0525988978000902 AS `scaler_95`, (CAST(`ADS_imp_1_OUT`.`impter_96` AS DOUBLE) - -0.1408434425354362) / 0.9172372033996682 AS `scaler_96`, (CAST(`ADS_imp_1_OUT`.`impter_97` AS DOUBLE) - -0.1574012366732725) / 0.9930125433643069 AS `scaler_97`, (CAST(`ADS_imp_1_OUT`.`impter_98` AS DOUBLE) - 0.05477536676313335) / 0.9803136353653645 AS `scaler_98`, (CAST(`ADS_imp_1_OUT`.`impter_99` AS DOUBLE) - 0.05673272205919614) / 0.9296338032188498 AS `scaler_99`, (CAST(`ADS_imp_1_OUT`.`impter_100` AS DOUBLE) - -0.14226649213619527) / 1.174442941822933 AS `scaler_100`, (CAST(`ADS_imp_1_OUT`.`impter_101` AS DOUBLE) - -0.04042675289131955) / 1.983747550989713 AS `scaler_101` 
FROM `tmp_20180602143620_oq6_ads_imp_1_out` AS `ADS_imp_1_OUT`) AS `ADS_sca_2_OUT`

-- Code For temporary table tmp_20180602143620_57h_ads_sca_2_out part 2. Populate

SELECT * FROM `tmp_20180602143620_57h_ads_sca_2_out`

-- Code For temporary table tmp_20180602143620_yty_calprob_b0 part 1. Create 

CREATE TEMPORARY TABLE `tmp_20180602143620_yty_calprob_b0` STORED AS ORC AS WITH `DT_node_lookup` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_46` <= -0.9744701385498047) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_98` <= -1.210394024848938) THEN 2 ELSE 3 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_31` <= 0.0994705930352211) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_50` <= -0.20437878370285034) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_74` <= -0.9353350400924683) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_34` <= -1.788744330406189) THEN 8 ELSE 9 END ELSE 10 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_90` <= -0.43670594692230225) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_67` <= 0.37025201320648193) THEN 13 ELSE 14 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_7` <= 0.8822286128997803) THEN 16 ELSE 17 END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_91` <= -0.4576895833015442) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_27` <= 0.28470051288604736) THEN 20 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_3` <= 1.2280025482177734) THEN 22 ELSE 23 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_73` <= 0.7871303558349609) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_25` <= 1.7956860065460205) THEN 26 ELSE 27 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_57` <= -0.03813178092241287) THEN 29 ELSE 30 END END END END END AS `node_id_2` 
FROM `tmp_20180602143620_57h_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`P_0` AS DOUBLE) AS `P_0`, CAST(`Values`.`P_1` AS DOUBLE) AS `P_1`, CAST(`Values`.`P_2` AS DOUBLE) AS `P_2`, CAST(`Values`.`P_3` AS DOUBLE) AS `P_3`, CAST(`Values`.`D` AS DOUBLE) AS `D`, CAST(`Values`.`DP` AS DOUBLE) AS `DP` 
FROM (SELECT 2 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP` UNION ALL SELECT 3 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP` UNION ALL SELECT 8 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP` UNION ALL SELECT 9 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 1.0 AS `P_3`, 3 AS `D`, 1.0 AS `DP` UNION ALL SELECT 10 AS `nid`, 1.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 0 AS `D`, 1.0 AS `DP` UNION ALL SELECT 13 AS `nid`, 1.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 0 AS `D`, 1.0 AS `DP` UNION ALL SELECT 14 AS `nid`, 0.0 AS `P_0`, 0.3333333333333333 AS `P_1`, 0.3333333333333333 AS `P_2`, 0.3333333333333333 AS `P_3`, 1 AS `D`, 0.3333333333333333 AS `DP` UNION ALL SELECT 16 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP` UNION ALL SELECT 17 AS `nid`, 0.5 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.5 AS `P_3`, 0 AS `D`, 0.5 AS `DP` UNION ALL SELECT 20 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP` UNION ALL SELECT 22 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP` UNION ALL SELECT 23 AS `nid`, 0.5 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.5 AS `P_3`, 0 AS `D`, 0.5 AS `DP` UNION ALL SELECT 26 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 1.0 AS `P_3`, 3 AS `D`, 1.0 AS `DP` UNION ALL SELECT 27 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP` UNION ALL SELECT 29 AS `nid`, 0.0 AS `P_0`, 0.5 AS `P_1`, 0.5 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 0.5 AS `DP` UNION ALL SELECT 30 AS `nid`, 1.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 0 AS `D`, 1.0 AS `DP`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.`node_id_2` AS `node_id_2`, `DT_node_data`.`nid` AS `nid`, `DT_node_data`.`P_0` AS `P_0`, `DT_node_data`.`P_1` AS `P_1`, `DT_node_data`.`P_2` AS `P_2`, `DT_node_data`.`P_3` AS `P_3`, `DT_node_data`.`D` AS `D`, `DT_node_data`.`DP` AS `DP` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.`node_id_2` = `DT_node_data`.`nid`), 
`Calibrated_Model_0` AS 
(SELECT `DT_Output`.`KEY` AS `KEY`, CAST(NULL AS DOUBLE) AS `Score_0`, CAST(NULL AS DOUBLE) AS `Score_1`, CAST(NULL AS DOUBLE) AS `Score_2`, CAST(NULL AS DOUBLE) AS `Score_3`, `DT_Output`.`P_0` AS `Proba_0`, `DT_Output`.`P_1` AS `Proba_1`, `DT_Output`.`P_2` AS `Proba_2`, `DT_Output`.`P_3` AS `Proba_3`, CASE WHEN (`DT_Output`.`P_0` IS NULL OR `DT_Output`.`P_0` > 0.0) THEN log(`DT_Output`.`P_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (`DT_Output`.`P_1` IS NULL OR `DT_Output`.`P_1` > 0.0) THEN log(`DT_Output`.`P_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (`DT_Output`.`P_2` IS NULL OR `DT_Output`.`P_2` > 0.0) THEN log(`DT_Output`.`P_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, CASE WHEN (`DT_Output`.`P_3` IS NULL OR `DT_Output`.`P_3` > 0.0) THEN log(`DT_Output`.`P_3`) ELSE -1.79769313486231e+308 END AS `LogProba_3`, CAST(NULL AS BIGINT) AS `Decision`, CAST(NULL AS DOUBLE) AS `DecisionProba`, coalesce(CAST(NULL AS DOUBLE), `DT_Output`.`P_0`) AS `ScoreOrProba_0`, coalesce(CAST(NULL AS DOUBLE), `DT_Output`.`P_1`) AS `ScoreOrProba_1`, coalesce(CAST(NULL AS DOUBLE), `DT_Output`.`P_2`) AS `ScoreOrProba_2`, coalesce(CAST(NULL AS DOUBLE), `DT_Output`.`P_3`) AS `ScoreOrProba_3` 
FROM `DT_Output`), 
`sigmoid_calibration_0` AS 
(SELECT `Calibrated_Model_0`.`KEY` AS `KEY`, 1.0 / (1.0 + exp(-(1.00568628681973 * `Calibrated_Model_0`.`ScoreOrProba_0` + -1.4701027466284406))) AS `Proba_0`, 1.0 / (1.0 + exp(-(0.4904074089858073 * `Calibrated_Model_0`.`ScoreOrProba_1` + -1.0534679407644512))) AS `Proba_1`, 1.0 / (1.0 + exp(-(-0.05354705495103326 * `Calibrated_Model_0`.`ScoreOrProba_2` + -1.1098503406893812))) AS `Proba_2`, 1.0 / (1.0 + exp(-(-0.6981963782957894 * `Calibrated_Model_0`.`ScoreOrProba_3` + -0.9507144468287336))) AS `Proba_3` 
FROM `Calibrated_Model_0`), 
`Normalized_Probas` AS 
(SELECT `sigmoid_calibration_0`.`KEY` AS `KEY`, `sigmoid_calibration_0`.`Proba_0` / (`sigmoid_calibration_0`.`Proba_0` + `sigmoid_calibration_0`.`Proba_1` + `sigmoid_calibration_0`.`Proba_2` + `sigmoid_calibration_0`.`Proba_3`) AS `Proba_0`, `sigmoid_calibration_0`.`Proba_1` / (`sigmoid_calibration_0`.`Proba_0` + `sigmoid_calibration_0`.`Proba_1` + `sigmoid_calibration_0`.`Proba_2` + `sigmoid_calibration_0`.`Proba_3`) AS `Proba_1`, `sigmoid_calibration_0`.`Proba_2` / (`sigmoid_calibration_0`.`Proba_0` + `sigmoid_calibration_0`.`Proba_1` + `sigmoid_calibration_0`.`Proba_2` + `sigmoid_calibration_0`.`Proba_3`) AS `Proba_2`, `sigmoid_calibration_0`.`Proba_3` / (`sigmoid_calibration_0`.`Proba_0` + `sigmoid_calibration_0`.`Proba_1` + `sigmoid_calibration_0`.`Proba_2` + `sigmoid_calibration_0`.`Proba_3`) AS `Proba_3` 
FROM `sigmoid_calibration_0`), 
`DT_node_lookup_1` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_46` <= -0.9075416326522827) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_29` <= -1.3260471820831299) THEN 2 ELSE 3 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_21` <= -0.08402862399816513) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_46` <= 0.045341748744249344) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_80` <= -0.12905026972293854) THEN 7 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= -0.6934743523597717) THEN 9 ELSE 10 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_26` <= 0.8874503374099731) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_25` <= 0.701154887676239) THEN 13 ELSE 14 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_10` <= -0.9598292112350464) THEN 16 ELSE 17 END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_94` <= -0.31149446964263916) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_8` <= 1.4168765544891357) THEN 20 ELSE 21 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_22` <= -0.9015023708343506) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_34` <= 1.1722487211227417) THEN 24 ELSE 25 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_30` <= -1.259319543838501) THEN 27 ELSE 28 END END END END END AS `node_id_2` 
FROM `tmp_20180602143620_57h_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_1` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`P_0` AS DOUBLE) AS `P_0`, CAST(`Values`.`P_1` AS DOUBLE) AS `P_1`, CAST(`Values`.`P_2` AS DOUBLE) AS `P_2`, CAST(`Values`.`P_3` AS DOUBLE) AS `P_3`, CAST(`Values`.`D` AS DOUBLE) AS `D`, CAST(`Values`.`DP` AS DOUBLE) AS `DP` 
FROM (SELECT 2 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP` UNION ALL SELECT 3 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP` UNION ALL SELECT 7 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP` UNION ALL SELECT 9 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP` UNION ALL SELECT 10 AS `nid`, 1.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 0 AS `D`, 1.0 AS `DP` UNION ALL SELECT 13 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP` UNION ALL SELECT 14 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP` UNION ALL SELECT 16 AS `nid`, 1.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 0 AS `D`, 1.0 AS `DP` UNION ALL SELECT 17 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 1.0 AS `P_3`, 3 AS `D`, 1.0 AS `DP` UNION ALL SELECT 20 AS `nid`, 1.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 0 AS `D`, 1.0 AS `DP` UNION ALL SELECT 21 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 1.0 AS `P_3`, 3 AS `D`, 1.0 AS `DP` UNION ALL SELECT 24 AS `nid`, 1.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 0 AS `D`, 1.0 AS `DP` UNION ALL SELECT 25 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP` UNION ALL SELECT 27 AS `nid`, 0.0 AS `P_0`, 0.75 AS `P_1`, 0.0 AS `P_2`, 0.25 AS `P_3`, 1 AS `D`, 0.75 AS `DP` UNION ALL SELECT 28 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 1.0 AS `P_3`, 3 AS `D`, 1.0 AS `DP`) AS `Values`), 
`DT_Output_1` AS 
(SELECT `DT_node_lookup_1`.`KEY` AS `KEY`, `DT_node_lookup_1`.`node_id_2` AS `node_id_2`, `DT_node_data_1`.`nid` AS `nid`, `DT_node_data_1`.`P_0` AS `P_0`, `DT_node_data_1`.`P_1` AS `P_1`, `DT_node_data_1`.`P_2` AS `P_2`, `DT_node_data_1`.`P_3` AS `P_3`, `DT_node_data_1`.`D` AS `D`, `DT_node_data_1`.`DP` AS `DP` 
FROM `DT_node_lookup_1` LEFT OUTER JOIN `DT_node_data_1` ON `DT_node_lookup_1`.`node_id_2` = `DT_node_data_1`.`nid`), 
`Calibrated_Model_1` AS 
(SELECT `DT_Output_1`.`KEY` AS `KEY`, CAST(NULL AS DOUBLE) AS `Score_0`, CAST(NULL AS DOUBLE) AS `Score_1`, CAST(NULL AS DOUBLE) AS `Score_2`, CAST(NULL AS DOUBLE) AS `Score_3`, `DT_Output_1`.`P_0` AS `Proba_0`, `DT_Output_1`.`P_1` AS `Proba_1`, `DT_Output_1`.`P_2` AS `Proba_2`, `DT_Output_1`.`P_3` AS `Proba_3`, CASE WHEN (`DT_Output_1`.`P_0` IS NULL OR `DT_Output_1`.`P_0` > 0.0) THEN log(`DT_Output_1`.`P_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (`DT_Output_1`.`P_1` IS NULL OR `DT_Output_1`.`P_1` > 0.0) THEN log(`DT_Output_1`.`P_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (`DT_Output_1`.`P_2` IS NULL OR `DT_Output_1`.`P_2` > 0.0) THEN log(`DT_Output_1`.`P_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, CASE WHEN (`DT_Output_1`.`P_3` IS NULL OR `DT_Output_1`.`P_3` > 0.0) THEN log(`DT_Output_1`.`P_3`) ELSE -1.79769313486231e+308 END AS `LogProba_3`, CAST(NULL AS BIGINT) AS `Decision`, CAST(NULL AS DOUBLE) AS `DecisionProba`, coalesce(CAST(NULL AS DOUBLE), `DT_Output_1`.`P_0`) AS `ScoreOrProba_0`, coalesce(CAST(NULL AS DOUBLE), `DT_Output_1`.`P_1`) AS `ScoreOrProba_1`, coalesce(CAST(NULL AS DOUBLE), `DT_Output_1`.`P_2`) AS `ScoreOrProba_2`, coalesce(CAST(NULL AS DOUBLE), `DT_Output_1`.`P_3`) AS `ScoreOrProba_3` 
FROM `DT_Output_1`), 
`sigmoid_calibration_1` AS 
(SELECT `Calibrated_Model_1`.`KEY` AS `KEY`, 1.0 / (1.0 + exp(-(0.21394252761946847 * `Calibrated_Model_1`.`ScoreOrProba_0` + -1.1302338593460968))) AS `Proba_0`, 1.0 / (1.0 + exp(-(-0.7183281215311701 * `Calibrated_Model_1`.`ScoreOrProba_1` + -0.8825624769332785))) AS `Proba_1`, 1.0 / (1.0 + exp(-(2.737153903483464 * `Calibrated_Model_1`.`ScoreOrProba_2` + -1.8417698417441246))) AS `Proba_2`, 1.0 / (1.0 + exp(-(-0.285686600159873 * `Calibrated_Model_1`.`ScoreOrProba_3` + -1.0093591526805594))) AS `Proba_3` 
FROM `Calibrated_Model_1`), 
`Normalized_Probas_1` AS 
(SELECT `sigmoid_calibration_1`.`KEY` AS `KEY`, `sigmoid_calibration_1`.`Proba_0` / (`sigmoid_calibration_1`.`Proba_0` + `sigmoid_calibration_1`.`Proba_1` + `sigmoid_calibration_1`.`Proba_2` + `sigmoid_calibration_1`.`Proba_3`) AS `Proba_0`, `sigmoid_calibration_1`.`Proba_1` / (`sigmoid_calibration_1`.`Proba_0` + `sigmoid_calibration_1`.`Proba_1` + `sigmoid_calibration_1`.`Proba_2` + `sigmoid_calibration_1`.`Proba_3`) AS `Proba_1`, `sigmoid_calibration_1`.`Proba_2` / (`sigmoid_calibration_1`.`Proba_0` + `sigmoid_calibration_1`.`Proba_1` + `sigmoid_calibration_1`.`Proba_2` + `sigmoid_calibration_1`.`Proba_3`) AS `Proba_2`, `sigmoid_calibration_1`.`Proba_3` / (`sigmoid_calibration_1`.`Proba_0` + `sigmoid_calibration_1`.`Proba_1` + `sigmoid_calibration_1`.`Proba_2` + `sigmoid_calibration_1`.`Proba_3`) AS `Proba_3` 
FROM `sigmoid_calibration_1`), 
`DT_node_lookup_2` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_46` <= -0.9107336401939392) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_91` <= -0.7591977715492249) THEN 2 ELSE 3 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_80` <= -0.16562548279762268) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_43` <= 0.3289739489555359) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_21` <= -0.27451857924461365) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_73` <= -0.93479323387146) THEN 8 ELSE 9 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_16` <= 0.7783232927322388) THEN 11 ELSE 12 END END ELSE 13 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_4` <= -0.4460938572883606) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_55` <= 1.459143877029419) THEN 16 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_55` <= 1.6242711544036865) THEN 18 ELSE 19 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_50` <= -0.18425396084785461) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_28` <= 0.6462103724479675) THEN 22 ELSE 23 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_49` <= 0.031280066817998886) THEN 25 ELSE 26 END END END END END AS `node_id_2` 
FROM `tmp_20180602143620_57h_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_2` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`P_0` AS DOUBLE) AS `P_0`, CAST(`Values`.`P_1` AS DOUBLE) AS `P_1`, CAST(`Values`.`P_2` AS DOUBLE) AS `P_2`, CAST(`Values`.`P_3` AS DOUBLE) AS `P_3`, CAST(`Values`.`D` AS DOUBLE) AS `D`, CAST(`Values`.`DP` AS DOUBLE) AS `DP` 
FROM (SELECT 2 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP` UNION ALL SELECT 3 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP` UNION ALL SELECT 8 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP` UNION ALL SELECT 9 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP` UNION ALL SELECT 11 AS `nid`, 0.16666666666666666 AS `P_0`, 0.8333333333333334 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 0.8333333333333334 AS `DP` UNION ALL SELECT 12 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 1.0 AS `P_3`, 3 AS `D`, 1.0 AS `DP` UNION ALL SELECT 13 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 1.0 AS `P_3`, 3 AS `D`, 1.0 AS `DP` UNION ALL SELECT 16 AS `nid`, 1.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 0 AS `D`, 1.0 AS `DP` UNION ALL SELECT 18 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP` UNION ALL SELECT 19 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP` UNION ALL SELECT 22 AS `nid`, 1.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 0 AS `D`, 1.0 AS `DP` UNION ALL SELECT 23 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 1.0 AS `P_3`, 3 AS `D`, 1.0 AS `DP` UNION ALL SELECT 25 AS `nid`, 0.0 AS `P_0`, 0.16666666666666666 AS `P_1`, 0.0 AS `P_2`, 0.8333333333333334 AS `P_3`, 3 AS `D`, 0.8333333333333334 AS `DP` UNION ALL SELECT 26 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP`) AS `Values`), 
`DT_Output_2` AS 
(SELECT `DT_node_lookup_2`.`KEY` AS `KEY`, `DT_node_lookup_2`.`node_id_2` AS `node_id_2`, `DT_node_data_2`.`nid` AS `nid`, `DT_node_data_2`.`P_0` AS `P_0`, `DT_node_data_2`.`P_1` AS `P_1`, `DT_node_data_2`.`P_2` AS `P_2`, `DT_node_data_2`.`P_3` AS `P_3`, `DT_node_data_2`.`D` AS `D`, `DT_node_data_2`.`DP` AS `DP` 
FROM `DT_node_lookup_2` LEFT OUTER JOIN `DT_node_data_2` ON `DT_node_lookup_2`.`node_id_2` = `DT_node_data_2`.`nid`), 
`Calibrated_Model_2` AS 
(SELECT `DT_Output_2`.`KEY` AS `KEY`, CAST(NULL AS DOUBLE) AS `Score_0`, CAST(NULL AS DOUBLE) AS `Score_1`, CAST(NULL AS DOUBLE) AS `Score_2`, CAST(NULL AS DOUBLE) AS `Score_3`, `DT_Output_2`.`P_0` AS `Proba_0`, `DT_Output_2`.`P_1` AS `Proba_1`, `DT_Output_2`.`P_2` AS `Proba_2`, `DT_Output_2`.`P_3` AS `Proba_3`, CASE WHEN (`DT_Output_2`.`P_0` IS NULL OR `DT_Output_2`.`P_0` > 0.0) THEN log(`DT_Output_2`.`P_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (`DT_Output_2`.`P_1` IS NULL OR `DT_Output_2`.`P_1` > 0.0) THEN log(`DT_Output_2`.`P_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (`DT_Output_2`.`P_2` IS NULL OR `DT_Output_2`.`P_2` > 0.0) THEN log(`DT_Output_2`.`P_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, CASE WHEN (`DT_Output_2`.`P_3` IS NULL OR `DT_Output_2`.`P_3` > 0.0) THEN log(`DT_Output_2`.`P_3`) ELSE -1.79769313486231e+308 END AS `LogProba_3`, CAST(NULL AS BIGINT) AS `Decision`, CAST(NULL AS DOUBLE) AS `DecisionProba`, coalesce(CAST(NULL AS DOUBLE), `DT_Output_2`.`P_0`) AS `ScoreOrProba_0`, coalesce(CAST(NULL AS DOUBLE), `DT_Output_2`.`P_1`) AS `ScoreOrProba_1`, coalesce(CAST(NULL AS DOUBLE), `DT_Output_2`.`P_2`) AS `ScoreOrProba_2`, coalesce(CAST(NULL AS DOUBLE), `DT_Output_2`.`P_3`) AS `ScoreOrProba_3` 
FROM `DT_Output_2`), 
`sigmoid_calibration_2` AS 
(SELECT `Calibrated_Model_2`.`KEY` AS `KEY`, 1.0 / (1.0 + exp(-(1.8436247099820837 * `Calibrated_Model_2`.`ScoreOrProba_0` + -1.757857880020436))) AS `Proba_0`, 1.0 / (1.0 + exp(-(-1.583104098016066 * `Calibrated_Model_2`.`ScoreOrProba_1` + -0.9462183936537009))) AS `Proba_1`, 1.0 / (1.0 + exp(-(3.277420526455033 * `Calibrated_Model_2`.`ScoreOrProba_2` + -2.2444049551885428))) AS `Proba_2`, 1.0 / (1.0 + exp(-(1.4269233631128861 * `Calibrated_Model_2`.`ScoreOrProba_3` + -1.6723071852272757))) AS `Proba_3` 
FROM `Calibrated_Model_2`), 
`Normalized_Probas_2` AS 
(SELECT `sigmoid_calibration_2`.`KEY` AS `KEY`, `sigmoid_calibration_2`.`Proba_0` / (`sigmoid_calibration_2`.`Proba_0` + `sigmoid_calibration_2`.`Proba_1` + `sigmoid_calibration_2`.`Proba_2` + `sigmoid_calibration_2`.`Proba_3`) AS `Proba_0`, `sigmoid_calibration_2`.`Proba_1` / (`sigmoid_calibration_2`.`Proba_0` + `sigmoid_calibration_2`.`Proba_1` + `sigmoid_calibration_2`.`Proba_2` + `sigmoid_calibration_2`.`Proba_3`) AS `Proba_1`, `sigmoid_calibration_2`.`Proba_2` / (`sigmoid_calibration_2`.`Proba_0` + `sigmoid_calibration_2`.`Proba_1` + `sigmoid_calibration_2`.`Proba_2` + `sigmoid_calibration_2`.`Proba_3`) AS `Proba_2`, `sigmoid_calibration_2`.`Proba_3` / (`sigmoid_calibration_2`.`Proba_0` + `sigmoid_calibration_2`.`Proba_1` + `sigmoid_calibration_2`.`Proba_2` + `sigmoid_calibration_2`.`Proba_3`) AS `Proba_3` 
FROM `sigmoid_calibration_2`), 
`DT_node_lookup_3` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_46` <= -0.9107336401939392) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_63` <= 0.9709796905517578) THEN 2 ELSE 3 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_31` <= -0.41341549158096313) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_62` <= 0.4198065996170044) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_71` <= -0.4526420831680298) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_34` <= -0.6147451996803284) THEN 8 ELSE 9 END ELSE 10 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_48` <= 0.0654413029551506) THEN 12 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_25` <= 2.1687135696411133) THEN 14 ELSE 15 END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_101` <= -0.029002565890550613) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_91` <= -0.4576895833015442) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_8` <= 0.6312097311019897) THEN 19 ELSE 20 END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_13` <= -1.8270423412322998) THEN 22 ELSE 23 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_50` <= 0.6239084005355835) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_38` <= 0.38787025213241577) THEN 26 ELSE 27 END ELSE 28 END END END END AS `node_id_2` 
FROM `tmp_20180602143620_57h_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_3` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`P_0` AS DOUBLE) AS `P_0`, CAST(`Values`.`P_1` AS DOUBLE) AS `P_1`, CAST(`Values`.`P_2` AS DOUBLE) AS `P_2`, CAST(`Values`.`P_3` AS DOUBLE) AS `P_3`, CAST(`Values`.`D` AS DOUBLE) AS `D`, CAST(`Values`.`DP` AS DOUBLE) AS `DP` 
FROM (SELECT 2 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP` UNION ALL SELECT 3 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP` UNION ALL SELECT 8 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 1.0 AS `P_3`, 3 AS `D`, 1.0 AS `DP` UNION ALL SELECT 9 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP` UNION ALL SELECT 10 AS `nid`, 1.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 0 AS `D`, 1.0 AS `DP` UNION ALL SELECT 12 AS `nid`, 1.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 0 AS `D`, 1.0 AS `DP` UNION ALL SELECT 14 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP` UNION ALL SELECT 15 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 1.0 AS `P_3`, 3 AS `D`, 1.0 AS `DP` UNION ALL SELECT 19 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP` UNION ALL SELECT 20 AS `nid`, 1.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 0 AS `D`, 1.0 AS `DP` UNION ALL SELECT 22 AS `nid`, 1.0 AS `P_0`, 0.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 0 AS `D`, 1.0 AS `DP` UNION ALL SELECT 23 AS `nid`, 0.0 AS `P_0`, 0.07142857142857142 AS `P_1`, 0.0 AS `P_2`, 0.9285714285714286 AS `P_3`, 3 AS `D`, 0.9285714285714286 AS `DP` UNION ALL SELECT 26 AS `nid`, 0.0 AS `P_0`, 1.0 AS `P_1`, 0.0 AS `P_2`, 0.0 AS `P_3`, 1 AS `D`, 1.0 AS `DP` UNION ALL SELECT 27 AS `nid`, 0.3333333333333333 AS `P_0`, 0.0 AS `P_1`, 0.3333333333333333 AS `P_2`, 0.3333333333333333 AS `P_3`, 0 AS `D`, 0.3333333333333333 AS `DP` UNION ALL SELECT 28 AS `nid`, 0.0 AS `P_0`, 0.0 AS `P_1`, 1.0 AS `P_2`, 0.0 AS `P_3`, 2 AS `D`, 1.0 AS `DP`) AS `Values`), 
`DT_Output_3` AS 
(SELECT `DT_node_lookup_3`.`KEY` AS `KEY`, `DT_node_lookup_3`.`node_id_2` AS `node_id_2`, `DT_node_data_3`.`nid` AS `nid`, `DT_node_data_3`.`P_0` AS `P_0`, `DT_node_data_3`.`P_1` AS `P_1`, `DT_node_data_3`.`P_2` AS `P_2`, `DT_node_data_3`.`P_3` AS `P_3`, `DT_node_data_3`.`D` AS `D`, `DT_node_data_3`.`DP` AS `DP` 
FROM `DT_node_lookup_3` LEFT OUTER JOIN `DT_node_data_3` ON `DT_node_lookup_3`.`node_id_2` = `DT_node_data_3`.`nid`), 
`Calibrated_Model_3` AS 
(SELECT `DT_Output_3`.`KEY` AS `KEY`, CAST(NULL AS DOUBLE) AS `Score_0`, CAST(NULL AS DOUBLE) AS `Score_1`, CAST(NULL AS DOUBLE) AS `Score_2`, CAST(NULL AS DOUBLE) AS `Score_3`, `DT_Output_3`.`P_0` AS `Proba_0`, `DT_Output_3`.`P_1` AS `Proba_1`, `DT_Output_3`.`P_2` AS `Proba_2`, `DT_Output_3`.`P_3` AS `Proba_3`, CASE WHEN (`DT_Output_3`.`P_0` IS NULL OR `DT_Output_3`.`P_0` > 0.0) THEN log(`DT_Output_3`.`P_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (`DT_Output_3`.`P_1` IS NULL OR `DT_Output_3`.`P_1` > 0.0) THEN log(`DT_Output_3`.`P_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (`DT_Output_3`.`P_2` IS NULL OR `DT_Output_3`.`P_2` > 0.0) THEN log(`DT_Output_3`.`P_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, CASE WHEN (`DT_Output_3`.`P_3` IS NULL OR `DT_Output_3`.`P_3` > 0.0) THEN log(`DT_Output_3`.`P_3`) ELSE -1.79769313486231e+308 END AS `LogProba_3`, CAST(NULL AS BIGINT) AS `Decision`, CAST(NULL AS DOUBLE) AS `DecisionProba`, coalesce(CAST(NULL AS DOUBLE), `DT_Output_3`.`P_0`) AS `ScoreOrProba_0`, coalesce(CAST(NULL AS DOUBLE), `DT_Output_3`.`P_1`) AS `ScoreOrProba_1`, coalesce(CAST(NULL AS DOUBLE), `DT_Output_3`.`P_2`) AS `ScoreOrProba_2`, coalesce(CAST(NULL AS DOUBLE), `DT_Output_3`.`P_3`) AS `ScoreOrProba_3` 
FROM `DT_Output_3`), 
`sigmoid_calibration_3` AS 
(SELECT `Calibrated_Model_3`.`KEY` AS `KEY`, 1.0 / (1.0 + exp(-(0.6206414655992062 * `Calibrated_Model_3`.`ScoreOrProba_0` + -1.1673213405522938))) AS `Proba_0`, 1.0 / (1.0 + exp(-(-2.7761738984683926 * `Calibrated_Model_3`.`ScoreOrProba_1` + -0.19966605688539338))) AS `Proba_1`, 1.0 / (1.0 + exp(-(-2.1447257820345906 * `Calibrated_Model_3`.`ScoreOrProba_2` + -1.0509872207997617))) AS `Proba_2`, 1.0 / (1.0 + exp(-(1.0703910789584594 * `Calibrated_Model_3`.`ScoreOrProba_3` + -1.2268123832374258))) AS `Proba_3` 
FROM `Calibrated_Model_3`), 
`Normalized_Probas_3` AS 
(SELECT `sigmoid_calibration_3`.`KEY` AS `KEY`, `sigmoid_calibration_3`.`Proba_0` / (`sigmoid_calibration_3`.`Proba_0` + `sigmoid_calibration_3`.`Proba_1` + `sigmoid_calibration_3`.`Proba_2` + `sigmoid_calibration_3`.`Proba_3`) AS `Proba_0`, `sigmoid_calibration_3`.`Proba_1` / (`sigmoid_calibration_3`.`Proba_0` + `sigmoid_calibration_3`.`Proba_1` + `sigmoid_calibration_3`.`Proba_2` + `sigmoid_calibration_3`.`Proba_3`) AS `Proba_1`, `sigmoid_calibration_3`.`Proba_2` / (`sigmoid_calibration_3`.`Proba_0` + `sigmoid_calibration_3`.`Proba_1` + `sigmoid_calibration_3`.`Proba_2` + `sigmoid_calibration_3`.`Proba_3`) AS `Proba_2`, `sigmoid_calibration_3`.`Proba_3` / (`sigmoid_calibration_3`.`Proba_0` + `sigmoid_calibration_3`.`Proba_1` + `sigmoid_calibration_3`.`Proba_2` + `sigmoid_calibration_3`.`Proba_3`) AS `Proba_3` 
FROM `sigmoid_calibration_3`)
 SELECT `CalProb_B0`.`KEY`, `CalProb_B0`.`Proba_0`, `CalProb_B0`.`Proba_1`, `CalProb_B0`.`Proba_2`, `CalProb_B0`.`Proba_3` 
FROM (SELECT `CalProb_esu_0`.`KEY` AS `KEY`, `CalProb_esu_0`.`Proba_0` AS `Proba_0`, `CalProb_esu_0`.`Proba_1` AS `Proba_1`, `CalProb_esu_0`.`Proba_2` AS `Proba_2`, `CalProb_esu_0`.`Proba_3` AS `Proba_3` 
FROM (SELECT `Normalized_Probas`.`KEY` AS `KEY`, `Normalized_Probas`.`Proba_0` AS `Proba_0`, `Normalized_Probas`.`Proba_1` AS `Proba_1`, `Normalized_Probas`.`Proba_2` AS `Proba_2`, `Normalized_Probas`.`Proba_3` AS `Proba_3` 
FROM `Normalized_Probas` UNION ALL SELECT `Normalized_Probas_1`.`KEY` AS `KEY`, `Normalized_Probas_1`.`Proba_0` AS `Proba_0`, `Normalized_Probas_1`.`Proba_1` AS `Proba_1`, `Normalized_Probas_1`.`Proba_2` AS `Proba_2`, `Normalized_Probas_1`.`Proba_3` AS `Proba_3` 
FROM `Normalized_Probas_1` UNION ALL SELECT `Normalized_Probas_2`.`KEY` AS `KEY`, `Normalized_Probas_2`.`Proba_0` AS `Proba_0`, `Normalized_Probas_2`.`Proba_1` AS `Proba_1`, `Normalized_Probas_2`.`Proba_2` AS `Proba_2`, `Normalized_Probas_2`.`Proba_3` AS `Proba_3` 
FROM `Normalized_Probas_2` UNION ALL SELECT `Normalized_Probas_3`.`KEY` AS `KEY`, `Normalized_Probas_3`.`Proba_0` AS `Proba_0`, `Normalized_Probas_3`.`Proba_1` AS `Proba_1`, `Normalized_Probas_3`.`Proba_2` AS `Proba_2`, `Normalized_Probas_3`.`Proba_3` AS `Proba_3` 
FROM `Normalized_Probas_3`) AS `CalProb_esu_0`) AS `CalProb_B0`

-- Code For temporary table tmp_20180602143620_yty_calprob_b0 part 2. Populate

SELECT * FROM `tmp_20180602143620_yty_calprob_b0`

-- Code For temporary table tmp_20180602143620_620_calprob_avg part 1. Create 

CREATE TEMPORARY TABLE `tmp_20180602143620_620_calprob_avg` STORED AS ORC AS WITH `CalProb_Union` AS 
(SELECT `CalProb_EnsembleUnion`.`KEY` AS `KEY`, `CalProb_EnsembleUnion`.`Proba_0` AS `Proba_0`, `CalProb_EnsembleUnion`.`Proba_1` AS `Proba_1`, `CalProb_EnsembleUnion`.`Proba_2` AS `Proba_2`, `CalProb_EnsembleUnion`.`Proba_3` AS `Proba_3` 
FROM (SELECT `CalProb_B0`.`KEY` AS `KEY`, `CalProb_B0`.`Proba_0` AS `Proba_0`, `CalProb_B0`.`Proba_1` AS `Proba_1`, `CalProb_B0`.`Proba_2` AS `Proba_2`, `CalProb_B0`.`Proba_3` AS `Proba_3` 
FROM `tmp_20180602143620_yty_calprob_b0` AS `CalProb_B0`) AS `CalProb_EnsembleUnion`)
 SELECT `CalProb_avg`.`KEY`, `CalProb_avg`.`Proba_0`, `CalProb_avg`.`Proba_1`, `CalProb_avg`.`Proba_2`, `CalProb_avg`.`Proba_3` 
FROM (SELECT `T`.`KEY` AS `KEY`, CAST(`T`.`Proba_0` AS DOUBLE) AS `Proba_0`, CAST(`T`.`Proba_1` AS DOUBLE) AS `Proba_1`, CAST(`T`.`Proba_2` AS DOUBLE) AS `Proba_2`, CAST(`T`.`Proba_3` AS DOUBLE) AS `Proba_3` 
FROM (SELECT `CalProb_Union`.`KEY` AS `KEY`, avg(CAST(`CalProb_Union`.`Proba_0` AS DOUBLE)) AS `Proba_0`, avg(CAST(`CalProb_Union`.`Proba_1` AS DOUBLE)) AS `Proba_1`, avg(CAST(`CalProb_Union`.`Proba_2` AS DOUBLE)) AS `Proba_2`, avg(CAST(`CalProb_Union`.`Proba_3` AS DOUBLE)) AS `Proba_3` 
FROM `CalProb_Union` GROUP BY `CalProb_Union`.`KEY`) AS `T`) AS `CalProb_avg`

-- Code For temporary table tmp_20180602143620_620_calprob_avg part 2. Populate

SELECT * FROM `tmp_20180602143620_620_calprob_avg`

-- Model deployment code

WITH `orig_cte` AS 
(SELECT `CalProb_avg`.`KEY` AS `KEY`, CAST(NULL AS DOUBLE) AS `Score_0`, CAST(NULL AS DOUBLE) AS `Score_1`, CAST(NULL AS DOUBLE) AS `Score_2`, CAST(NULL AS DOUBLE) AS `Score_3`, `CalProb_avg`.`Proba_0` AS `Proba_0`, `CalProb_avg`.`Proba_1` AS `Proba_1`, `CalProb_avg`.`Proba_2` AS `Proba_2`, `CalProb_avg`.`Proba_3` AS `Proba_3`, CAST(NULL AS DOUBLE) AS `LogProba_0`, CAST(NULL AS DOUBLE) AS `LogProba_1`, CAST(NULL AS DOUBLE) AS `LogProba_2`, CAST(NULL AS DOUBLE) AS `LogProba_3`, CAST(NULL AS BIGINT) AS `Decision`, CAST(NULL AS DOUBLE) AS `DecisionProba` 
FROM `tmp_20180602143620_620_calprob_avg` AS `CalProb_avg`), 
`score_class_union` AS 
(SELECT `scu`.`KEY_u` AS `KEY_u`, `scu`.`class` AS `class`, `scu`.`LogProba` AS `LogProba`, `scu`.`Proba` AS `Proba`, `scu`.`Score` AS `Score` 
FROM (SELECT `orig_cte`.`KEY` AS `KEY_u`, 0 AS `class`, `orig_cte`.`LogProba_0` AS `LogProba`, `orig_cte`.`Proba_0` AS `Proba`, `orig_cte`.`Score_0` AS `Score` 
FROM `orig_cte` UNION ALL SELECT `orig_cte`.`KEY` AS `KEY_u`, 1 AS `class`, `orig_cte`.`LogProba_1` AS `LogProba`, `orig_cte`.`Proba_1` AS `Proba`, `orig_cte`.`Score_1` AS `Score` 
FROM `orig_cte` UNION ALL SELECT `orig_cte`.`KEY` AS `KEY_u`, 2 AS `class`, `orig_cte`.`LogProba_2` AS `LogProba`, `orig_cte`.`Proba_2` AS `Proba`, `orig_cte`.`Score_2` AS `Score` 
FROM `orig_cte` UNION ALL SELECT `orig_cte`.`KEY` AS `KEY_u`, 3 AS `class`, `orig_cte`.`LogProba_3` AS `LogProba`, `orig_cte`.`Proba_3` AS `Proba`, `orig_cte`.`Score_3` AS `Score` 
FROM `orig_cte`) AS `scu`), 
`score_max` AS 
(SELECT `orig_cte`.`KEY` AS `KEY`, `orig_cte`.`Score_0` AS `Score_0`, `orig_cte`.`Score_1` AS `Score_1`, `orig_cte`.`Score_2` AS `Score_2`, `orig_cte`.`Score_3` AS `Score_3`, `orig_cte`.`Proba_0` AS `Proba_0`, `orig_cte`.`Proba_1` AS `Proba_1`, `orig_cte`.`Proba_2` AS `Proba_2`, `orig_cte`.`Proba_3` AS `Proba_3`, `orig_cte`.`LogProba_0` AS `LogProba_0`, `orig_cte`.`LogProba_1` AS `LogProba_1`, `orig_cte`.`LogProba_2` AS `LogProba_2`, `orig_cte`.`LogProba_3` AS `LogProba_3`, `orig_cte`.`Decision` AS `Decision`, `orig_cte`.`DecisionProba` AS `DecisionProba`, `max_select`.`KEY_m` AS `KEY_m`, `max_select`.`max_Proba` AS `max_Proba` 
FROM `orig_cte` LEFT OUTER JOIN (SELECT `score_class_union`.`KEY_u` AS `KEY_m`, max(`score_class_union`.`Proba`) AS `max_Proba` 
FROM `score_class_union` GROUP BY `score_class_union`.`KEY_u`) AS `max_select` ON `orig_cte`.`KEY` = `max_select`.`KEY_m`), 
`union_with_max` AS 
(SELECT `score_class_union`.`KEY_u` AS `KEY_u`, `score_class_union`.`class` AS `class`, `score_class_union`.`LogProba` AS `LogProba`, `score_class_union`.`Proba` AS `Proba`, `score_class_union`.`Score` AS `Score`, `score_max`.`KEY` AS `KEY`, `score_max`.`Score_0` AS `Score_0`, `score_max`.`Score_1` AS `Score_1`, `score_max`.`Score_2` AS `Score_2`, `score_max`.`Score_3` AS `Score_3`, `score_max`.`Proba_0` AS `Proba_0`, `score_max`.`Proba_1` AS `Proba_1`, `score_max`.`Proba_2` AS `Proba_2`, `score_max`.`Proba_3` AS `Proba_3`, `score_max`.`LogProba_0` AS `LogProba_0`, `score_max`.`LogProba_1` AS `LogProba_1`, `score_max`.`LogProba_2` AS `LogProba_2`, `score_max`.`LogProba_3` AS `LogProba_3`, `score_max`.`Decision` AS `Decision`, `score_max`.`DecisionProba` AS `DecisionProba`, `score_max`.`KEY_m` AS `KEY_m`, `score_max`.`max_Proba` AS `max_Proba` 
FROM `score_class_union` LEFT OUTER JOIN `score_max` ON `score_class_union`.`KEY_u` = `score_max`.`KEY`), 
`arg_max_cte` AS 
(SELECT `score_max`.`KEY` AS `KEY`, `score_max`.`Score_0` AS `Score_0`, `score_max`.`Score_1` AS `Score_1`, `score_max`.`Score_2` AS `Score_2`, `score_max`.`Score_3` AS `Score_3`, `score_max`.`Proba_0` AS `Proba_0`, `score_max`.`Proba_1` AS `Proba_1`, `score_max`.`Proba_2` AS `Proba_2`, `score_max`.`Proba_3` AS `Proba_3`, `score_max`.`LogProba_0` AS `LogProba_0`, `score_max`.`LogProba_1` AS `LogProba_1`, `score_max`.`LogProba_2` AS `LogProba_2`, `score_max`.`LogProba_3` AS `LogProba_3`, `score_max`.`Decision` AS `Decision`, `score_max`.`DecisionProba` AS `DecisionProba`, `score_max`.`KEY_m` AS `KEY_m`, `score_max`.`max_Proba` AS `max_Proba`, `arg_max_t_Proba`.`KEY_Proba` AS `KEY_Proba`, `arg_max_t_Proba`.`arg_max_Proba` AS `arg_max_Proba` 
FROM `score_max` LEFT OUTER JOIN (SELECT `union_with_max`.`KEY` AS `KEY_Proba`, min(`union_with_max`.`class`) AS `arg_max_Proba` 
FROM `union_with_max` 
WHERE `union_with_max`.`Proba` >= `union_with_max`.`max_Proba` GROUP BY `union_with_max`.`KEY`) AS `arg_max_t_Proba` ON `score_max`.`KEY` = `arg_max_t_Proba`.`KEY_Proba`)
 SELECT `arg_max_cte`.`KEY` AS `KEY`, `arg_max_cte`.`Score_0` AS `Score_0`, `arg_max_cte`.`Score_1` AS `Score_1`, `arg_max_cte`.`Score_2` AS `Score_2`, `arg_max_cte`.`Score_3` AS `Score_3`, `arg_max_cte`.`Proba_0` AS `Proba_0`, `arg_max_cte`.`Proba_1` AS `Proba_1`, `arg_max_cte`.`Proba_2` AS `Proba_2`, `arg_max_cte`.`Proba_3` AS `Proba_3`, CASE WHEN (`arg_max_cte`.`Proba_0` IS NULL OR `arg_max_cte`.`Proba_0` > 0.0) THEN log(`arg_max_cte`.`Proba_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (`arg_max_cte`.`Proba_1` IS NULL OR `arg_max_cte`.`Proba_1` > 0.0) THEN log(`arg_max_cte`.`Proba_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (`arg_max_cte`.`Proba_2` IS NULL OR `arg_max_cte`.`Proba_2` > 0.0) THEN log(`arg_max_cte`.`Proba_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, CASE WHEN (`arg_max_cte`.`Proba_3` IS NULL OR `arg_max_cte`.`Proba_3` > 0.0) THEN log(`arg_max_cte`.`Proba_3`) ELSE -1.79769313486231e+308 END AS `LogProba_3`, `arg_max_cte`.`arg_max_Proba` AS `Decision`, `arg_max_cte`.`max_Proba` AS `DecisionProba` 
FROM `arg_max_cte`