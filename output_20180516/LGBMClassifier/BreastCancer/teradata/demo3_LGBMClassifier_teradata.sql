-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : LGBMClassifier
-- Dataset : BreastCancer
-- Database : teradata


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180508180813_codegen_n76qrf_lgbm_b0 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180508180813_codegen_n76qrf_lgbm_b0  (
	"KEY" BIGINT, 
	"Score_0" DOUBLE PRECISION
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180508180813_codegen_n76qrf_lgbm_b0 part 2. Populate

INSERT INTO tmp_20180508180813_codegen_n76qrf_lgbm_b0 ("KEY", "Score_0") SELECT "U"."KEY", "U"."Score_0" 
FROM (WITH "DT_node_lookup" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= CAST(0.14545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_0" <= CAST(15.475000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(32.85000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_1" <= CAST(24.355000000000004 AS DOUBLE PRECISION)) THEN 16 ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= CAST(822.8500000000001 AS DOUBLE PRECISION)) THEN 6 ELSE 7 END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
dummy_cte AS 
(SELECT CAST(0.0 AS DOUBLE PRECISION) AS "X"), 
"DT_node_data" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.04 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.04 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 7 AS nid, CAST(-0.1 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.067741935483871 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 16 AS nid, CAST(0.1 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17 AS nid, CAST(0.09 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".nid AS nid, "DT_node_data"."Score" AS "Score" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".nid), 
"LGBM_Model_0_0" AS 
(SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."Score" AS "Score_0" 
FROM "DT_Output"), 
"DT_node_lookup_1" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= CAST(0.14545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_23" <= CAST(896.9500000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(32.85000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_28" <= CAST(0.33055 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_5" <= CAST(0.11675 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_1" <= CAST(22.645000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_2" <= CAST(84.48500000000001 AS DOUBLE PRECISION)) THEN 128 ELSE 129 END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= CAST(822.8500000000001 AS DOUBLE PRECISION)) THEN 6 ELSE 7 END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_1" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.03872342243694 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.038015466079827 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 7 AS nid, CAST(-0.09524187224606 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.064429995408274 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17 AS nid, CAST(0.08526281527025 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 33 AS nid, CAST(0.095991191759292 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 65 AS nid, CAST(0.095582925622854 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 128 AS nid, CAST(0.09524187224606 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 129 AS nid, CAST(0.09524187224606 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_1" AS 
(SELECT "DT_node_lookup_1"."KEY" AS "KEY", "DT_node_lookup_1".node_id_2 AS node_id_2, "DT_node_data_1".nid AS nid, "DT_node_data_1"."Score" AS "Score" 
FROM "DT_node_lookup_1" LEFT OUTER JOIN "DT_node_data_1" ON "DT_node_lookup_1".node_id_2 = "DT_node_data_1".nid), 
"LGBM_Model_0_1" AS 
(SELECT "DT_Output_1"."KEY" AS "KEY", "DT_Output_1"."Score" AS "Score_0" 
FROM "DT_Output_1"), 
"DT_node_lookup_2" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= CAST(0.14545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_23" <= CAST(896.9500000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(32.85000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0015535 AS DOUBLE PRECISION)) THEN 16 ELSE CASE WHEN ("ADS"."Feature_5" <= CAST(0.12075 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_28" <= CAST(0.32245 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_1" <= CAST(22.415000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_5" <= CAST(0.1057 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_0" <= CAST(12.020000000000001 AS DOUBLE PRECISION)) THEN 544 ELSE 545 END ELSE 273 END ELSE 137 END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= CAST(822.8500000000001 AS DOUBLE PRECISION)) THEN 6 ELSE CASE WHEN ("ADS"."Feature_0" <= CAST(17.325000000000006 AS DOUBLE PRECISION)) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_2" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.036820304575049 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.036156163482734 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.061410364362711 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(-0.091131780775724 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 15 AS nid, CAST(-0.091131780775724 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 16 AS nid, CAST(0.081119558754403 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 35 AS nid, CAST(0.091853285541436 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 69 AS nid, CAST(0.091436432244703 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 137 AS nid, CAST(0.091387004952255 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 273 AS nid, CAST(0.091127379688908 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 544 AS nid, CAST(0.091131780775724 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 545 AS nid, CAST(0.091131780775724 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_2" AS 
(SELECT "DT_node_lookup_2"."KEY" AS "KEY", "DT_node_lookup_2".node_id_2 AS node_id_2, "DT_node_data_2".nid AS nid, "DT_node_data_2"."Score" AS "Score" 
FROM "DT_node_lookup_2" LEFT OUTER JOIN "DT_node_data_2" ON "DT_node_lookup_2".node_id_2 = "DT_node_data_2".nid), 
"LGBM_Model_0_2" AS 
(SELECT "DT_Output_2"."KEY" AS "KEY", "DT_Output_2"."Score" AS "Score_0" 
FROM "DT_Output_2"), 
"DT_node_lookup_3" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= CAST(0.14545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_0" <= CAST(15.475000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.1223 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_11" <= CAST(2.0975 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(32.85000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_0" <= CAST(14.045000000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_21" <= CAST(29.470000000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_28" <= CAST(0.3219 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0017905 AS DOUBLE PRECISION)) THEN 512 ELSE CASE WHEN ("ADS"."Feature_5" <= CAST(0.10685 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_1" <= CAST(19.790000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_1" <= CAST(18.310000000000002 AS DOUBLE PRECISION)) THEN 4104 ELSE 4105 END ELSE 2053 END ELSE 1027 END END ELSE 257 END ELSE 129 END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= CAST(822.8500000000001 AS DOUBLE PRECISION)) THEN 6 ELSE CASE WHEN ("ADS"."Feature_0" <= CAST(20.145000000000003 AS DOUBLE PRECISION)) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_3" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.035670519995233 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.034409502171933 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.049560847861214 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(-0.087549100739152 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 15 AS nid, CAST(-0.087549100739152 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17 AS nid, CAST(0.068554653510437 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 33 AS nid, CAST(0.091200098188949 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 65 AS nid, CAST(0.088837083902667 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 129 AS nid, CAST(0.087872467143038 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 257 AS nid, CAST(0.087799496499977 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 512 AS nid, CAST(0.087757043778643 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 1027 AS nid, CAST(0.087525724507376 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2053 AS nid, CAST(0.087546391279815 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4104 AS nid, CAST(0.087549100739152 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4105 AS nid, CAST(0.087549109026436 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_3" AS 
(SELECT "DT_node_lookup_3"."KEY" AS "KEY", "DT_node_lookup_3".node_id_2 AS node_id_2, "DT_node_data_3".nid AS nid, "DT_node_data_3"."Score" AS "Score" 
FROM "DT_node_lookup_3" LEFT OUTER JOIN "DT_node_data_3" ON "DT_node_lookup_3".node_id_2 = "DT_node_data_3".nid), 
"LGBM_Model_0_3" AS 
(SELECT "DT_Output_3"."KEY" AS "KEY", "DT_Output_3"."Score" AS "Score_0" 
FROM "DT_Output_3"), 
"DT_node_lookup_4" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= CAST(0.14545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_23" <= CAST(896.9500000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(32.85000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0015535 AS DOUBLE PRECISION)) THEN 16 ELSE CASE WHEN ("ADS"."Feature_27" <= CAST(0.1217 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_11" <= CAST(1.9615 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_28" <= CAST(0.3219 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_21" <= CAST(28.895000000000007 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_5" <= CAST(0.10805 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_20" <= CAST(15.075000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0020995 AS DOUBLE PRECISION)) THEN 2176 ELSE CASE WHEN ("ADS"."Feature_11" <= CAST(1.3955 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_1" <= CAST(17.100000000000005 AS DOUBLE PRECISION)) THEN 8708 ELSE 8709 END ELSE 4355 END END ELSE 1089 END ELSE 545 END ELSE 273 END ELSE 137 END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= CAST(822.8500000000001 AS DOUBLE PRECISION)) THEN 6 ELSE CASE WHEN ("ADS"."Feature_0" <= CAST(20.595000000000002 AS DOUBLE PRECISION)) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_4" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.033959081667976 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.032764749644905 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.055140475796121 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(-0.084401502427522 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 15 AS nid, CAST(-0.084401502427522 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 16 AS nid, CAST(0.074540334502473 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 35 AS nid, CAST(0.086470516275403 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 69 AS nid, CAST(0.084890012061737 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 137 AS nid, CAST(0.084672324141348 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 273 AS nid, CAST(0.084563401495246 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 545 AS nid, CAST(0.084376059575083 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 1089 AS nid, CAST(0.084383077288024 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2176 AS nid, CAST(0.084397978038455 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4355 AS nid, CAST(0.084400109600964 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8708 AS nid, CAST(0.084401502427522 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8709 AS nid, CAST(0.084401572340135 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_4" AS 
(SELECT "DT_node_lookup_4"."KEY" AS "KEY", "DT_node_lookup_4".node_id_2 AS node_id_2, "DT_node_data_4".nid AS nid, "DT_node_data_4"."Score" AS "Score" 
FROM "DT_node_lookup_4" LEFT OUTER JOIN "DT_node_data_4" ON "DT_node_lookup_4".node_id_2 = "DT_node_data_4".nid), 
"LGBM_Model_0_4" AS 
(SELECT "DT_Output_4"."KEY" AS "KEY", "DT_Output_4"."Score" AS "Score_0" 
FROM "DT_Output_4"), 
"DT_node_lookup_5" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= CAST(0.14545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_0" <= CAST(15.475000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.1223 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_28" <= CAST(0.21285 AS DOUBLE PRECISION)) THEN 16 ELSE CASE WHEN ("ADS"."Feature_13" <= CAST(32.85000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_3" <= CAST(603.1500000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0016715 AS DOUBLE PRECISION)) THEN 136 ELSE CASE WHEN ("ADS"."Feature_21" <= CAST(29.470000000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_28" <= CAST(0.32125 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_14" <= CAST(0.01044 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_5" <= CAST(0.09956 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_1" <= CAST(18.945000000000004 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(16.720000000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0025815 AS DOUBLE PRECISION)) THEN 17536 ELSE 17537 END ELSE CASE WHEN ("ADS"."Feature_13" <= CAST(19.69 AS DOUBLE PRECISION)) THEN 17538 ELSE 17539 END END ELSE 4385 END ELSE 2193 END ELSE 1097 END ELSE 549 END ELSE 275 END END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= CAST(822.8500000000001 AS DOUBLE PRECISION)) THEN 6 ELSE 7 END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_5" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.032966094280203 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.03121269290752 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 7 AS nid, CAST(-0.081617122023786 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.044089669895415 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 16 AS nid, CAST(0.062894826841958 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 35 AS nid, CAST(0.085739924718474 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 69 AS nid, CAST(0.083208728810398 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 136 AS nid, CAST(0.082076348840802 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 275 AS nid, CAST(0.081959644323649 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 549 AS nid, CAST(0.081823730838233 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 1097 AS nid, CAST(0.081725196593821 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2193 AS nid, CAST(0.081604101396833 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4385 AS nid, CAST(0.081614089727407 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17536 AS nid, CAST(0.081617185307993 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17537 AS nid, CAST(0.081617123568151 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17538 AS nid, CAST(0.081614825124819 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17539 AS nid, CAST(0.081617251981393 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_5" AS 
(SELECT "DT_node_lookup_5"."KEY" AS "KEY", "DT_node_lookup_5".node_id_2 AS node_id_2, "DT_node_data_5".nid AS nid, "DT_node_data_5"."Score" AS "Score" 
FROM "DT_node_lookup_5" LEFT OUTER JOIN "DT_node_data_5" ON "DT_node_lookup_5".node_id_2 = "DT_node_data_5".nid), 
"LGBM_Model_0_5" AS 
(SELECT "DT_Output_5"."KEY" AS "KEY", "DT_Output_5"."Score" AS "Score_0" 
FROM "DT_Output_5"), 
"DT_node_lookup_6" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= CAST(0.14545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_0" <= CAST(15.475000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.1223 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_11" <= CAST(2.0975 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(32.85000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_18" <= CAST(0.012835 AS DOUBLE PRECISION)) THEN 64 ELSE CASE WHEN ("ADS"."Feature_19" <= CAST(0.0016575 AS DOUBLE PRECISION)) THEN 130 ELSE CASE WHEN ("ADS"."Feature_28" <= CAST(0.2256 AS DOUBLE PRECISION)) THEN 262 ELSE CASE WHEN ("ADS"."Feature_28" <= CAST(0.32795 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_21" <= CAST(28.695000000000004 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_22" <= CAST(95.915 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_4" <= CAST(0.1038 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_11" <= CAST(1.357 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_24" <= CAST(0.1319 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.05652 AS DOUBLE PRECISION)) THEN 33664 ELSE 33665 END ELSE 16833 END ELSE 8417 END ELSE 4209 END ELSE 2105 END ELSE 1053 END ELSE 527 END END END END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_22" <= CAST(112.80000000000001 AS DOUBLE PRECISION)) THEN 6 ELSE CASE WHEN ("ADS"."Feature_13" <= CAST(39.96500000000001 AS DOUBLE PRECISION)) THEN 14 ELSE CASE WHEN ("ADS"."Feature_0" <= CAST(19.570000000000004 AS DOUBLE PRECISION)) THEN 30 ELSE 31 END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_6" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.031404004078072 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.030614014856393 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.042276361330599 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(-0.080330994015642 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17 AS nid, CAST(0.060129329188322 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 30 AS nid, CAST(-0.079139124155677 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 31 AS nid, CAST(-0.079139124155677 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 33 AS nid, CAST(0.082742635254302 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 64 AS nid, CAST(0.080721514670946 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 130 AS nid, CAST(0.079587870320776 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 262 AS nid, CAST(0.079400495899149 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 527 AS nid, CAST(0.079361838598372 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 1053 AS nid, CAST(0.0792484066868 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2105 AS nid, CAST(0.079097741712832 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4209 AS nid, CAST(0.079130466446788 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8417 AS nid, CAST(0.079134767034795 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 16833 AS nid, CAST(0.079136577737546 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 33664 AS nid, CAST(0.079138718450052 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 33665 AS nid, CAST(0.079139293946625 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_6" AS 
(SELECT "DT_node_lookup_6"."KEY" AS "KEY", "DT_node_lookup_6".node_id_2 AS node_id_2, "DT_node_data_6".nid AS nid, "DT_node_data_6"."Score" AS "Score" 
FROM "DT_node_lookup_6" LEFT OUTER JOIN "DT_node_data_6" ON "DT_node_lookup_6".node_id_2 = "DT_node_data_6".nid), 
"LGBM_Model_0_6" AS 
(SELECT "DT_Output_6"."KEY" AS "KEY", "DT_Output_6"."Score" AS "Score_0" 
FROM "DT_Output_6"), 
"DT_node_lookup_7" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= CAST(0.14545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_23" <= CAST(896.9500000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(32.85000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0015535 AS DOUBLE PRECISION)) THEN 16 ELSE CASE WHEN ("ADS"."Feature_27" <= CAST(0.1217 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_11" <= CAST(1.9615 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_28" <= CAST(0.2234 AS DOUBLE PRECISION)) THEN 136 ELSE CASE WHEN ("ADS"."Feature_28" <= CAST(0.3219 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_21" <= CAST(28.470000000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_23" <= CAST(685.5500000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_7" <= CAST(0.02867 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_9" <= CAST(0.06225 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_0" <= CAST(12.020000000000001 AS DOUBLE PRECISION)) THEN 8768 ELSE 8769 END ELSE CASE WHEN ("ADS"."Feature_10" <= CAST(0.25525 AS DOUBLE PRECISION)) THEN 8770 ELSE 8771 END END ELSE 2193 END ELSE 1097 END ELSE 549 END ELSE 275 END END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= CAST(822.8500000000001 AS DOUBLE PRECISION)) THEN 6 ELSE CASE WHEN ("ADS"."Feature_2" <= CAST(101.45000000000002 AS DOUBLE PRECISION)) THEN 14 ELSE CASE WHEN ("ADS"."Feature_10" <= CAST(0.4461 AS DOUBLE PRECISION)) THEN 30 ELSE CASE WHEN ("ADS"."Feature_0" <= CAST(20.455 AS DOUBLE PRECISION)) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_7" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.030506545346804 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.028086185830407 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.046872924999376 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(-0.07711398978952 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 16 AS nid, CAST(0.066732157467464 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 30 AS nid, CAST(-0.076904330514392 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 35 AS nid, CAST(0.081037943955667 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 62 AS nid, CAST(-0.076921967446683 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 63 AS nid, CAST(-0.076921967446683 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 69 AS nid, CAST(0.077763286036081 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 136 AS nid, CAST(0.07717142227197 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 275 AS nid, CAST(0.077112208479197 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 549 AS nid, CAST(0.077013135461647 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 1097 AS nid, CAST(0.076883746912884 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2193 AS nid, CAST(0.076909686165843 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8768 AS nid, CAST(0.076912512681155 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8769 AS nid, CAST(0.076921352990593 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8770 AS nid, CAST(0.076922054893583 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8771 AS nid, CAST(0.076920181797283 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_7" AS 
(SELECT "DT_node_lookup_7"."KEY" AS "KEY", "DT_node_lookup_7".node_id_2 AS node_id_2, "DT_node_data_7".nid AS nid, "DT_node_data_7"."Score" AS "Score" 
FROM "DT_node_lookup_7" LEFT OUTER JOIN "DT_node_data_7" ON "DT_node_lookup_7".node_id_2 = "DT_node_data_7".nid), 
"LGBM_Model_0_7" AS 
(SELECT "DT_Output_7"."KEY" AS "KEY", "DT_Output_7"."Score" AS "Score_0" 
FROM "DT_Output_7"), 
"DT_node_lookup_8" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= CAST(0.14545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(35.18500000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_9" <= CAST(0.05551 AS DOUBLE PRECISION)) THEN 8 ELSE CASE WHEN ("ADS"."Feature_1" <= CAST(24.355000000000004 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_20" <= CAST(15.995000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_12" <= CAST(2.8585 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.10975 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_11" <= CAST(1.6785 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.001897 AS DOUBLE PRECISION)) THEN 576 ELSE CASE WHEN ("ADS"."Feature_28" <= CAST(0.2303 AS DOUBLE PRECISION)) THEN 1154 ELSE CASE WHEN ("ADS"."Feature_28" <= CAST(0.3154 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_23" <= CAST(581.7500000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.058075 AS DOUBLE PRECISION)) THEN 9240 ELSE 9241 END ELSE 4621 END ELSE 2311 END END END ELSE 289 END ELSE 145 END ELSE 73 END ELSE 37 END ELSE 19 END END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_22" <= CAST(112.80000000000001 AS DOUBLE PRECISION)) THEN 6 ELSE CASE WHEN ("ADS"."Feature_23" <= CAST(1030.5000000000002 AS DOUBLE PRECISION)) THEN 14 ELSE CASE WHEN ("ADS"."Feature_13" <= CAST(52.41500000000001 AS DOUBLE PRECISION)) THEN 30 ELSE CASE WHEN ("ADS"."Feature_0" <= CAST(17.970000000000002 AS DOUBLE PRECISION)) THEN 62 ELSE CASE WHEN ("ADS"."Feature_8" <= CAST(0.17925 AS DOUBLE PRECISION)) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_8" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.009907191190807 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.027649083273577 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8 AS nid, CAST(0.04965779331699 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(-0.076144776417722 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 19 AS nid, CAST(0.064843109055368 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 30 AS nid, CAST(-0.074916173954961 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 37 AS nid, CAST(0.08498015094376 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 62 AS nid, CAST(-0.074928239216612 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 73 AS nid, CAST(0.076610812887991 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 126 AS nid, CAST(-0.074928762074787 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 127 AS nid, CAST(-0.07492871773404 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 145 AS nid, CAST(0.075945665783162 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 289 AS nid, CAST(0.07543409647182 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 576 AS nid, CAST(0.075217318399233 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 1154 AS nid, CAST(0.075089734643214 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2311 AS nid, CAST(0.075017407845982 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4621 AS nid, CAST(0.074918566929217 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9240 AS nid, CAST(0.074926063102908 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9241 AS nid, CAST(0.074928844820586 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_8" AS 
(SELECT "DT_node_lookup_8"."KEY" AS "KEY", "DT_node_lookup_8".node_id_2 AS node_id_2, "DT_node_data_8".nid AS nid, "DT_node_data_8"."Score" AS "Score" 
FROM "DT_node_lookup_8" LEFT OUTER JOIN "DT_node_data_8" ON "DT_node_lookup_8".node_id_2 = "DT_node_data_8".nid), 
"LGBM_Model_0_8" AS 
(SELECT "DT_Output_8"."KEY" AS "KEY", "DT_Output_8"."Score" AS "Score_0" 
FROM "DT_Output_8"), 
"DT_node_lookup_9" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_22" <= CAST(114.40000000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.14895 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(32.85000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_1" <= CAST(22.645000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.1217 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_20" <= CAST(15.495000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0017905 AS DOUBLE PRECISION)) THEN 128 ELSE CASE WHEN ("ADS"."Feature_11" <= CAST(1.8545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_28" <= CAST(0.22675 AS DOUBLE PRECISION)) THEN 516 ELSE CASE WHEN ("ADS"."Feature_28" <= CAST(0.31775 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_9" <= CAST(0.059095 AS DOUBLE PRECISION)) THEN 2068 ELSE CASE WHEN ("ADS"."Feature_17" <= CAST(0.01008 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_8" <= CAST(0.1699 AS DOUBLE PRECISION)) THEN 8276 ELSE 8277 END ELSE 4139 END END ELSE 1035 END END ELSE 259 END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_20" <= CAST(18.225000000000005 AS DOUBLE PRECISION)) THEN 6 ELSE CASE WHEN ("ADS"."Feature_27" <= CAST(0.1527 AS DOUBLE PRECISION)) THEN 14 ELSE CASE WHEN ("ADS"."Feature_22" <= CAST(140.40000000000003 AS DOUBLE PRECISION)) THEN 30 ELSE CASE WHEN ("ADS"."Feature_28" <= CAST(0.2748 AS DOUBLE PRECISION)) THEN 62 ELSE CASE WHEN ("ADS"."Feature_13" <= CAST(72.00000000000001 AS DOUBLE PRECISION)) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_9" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.042089263334306 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.037155584559077 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.035905380145938 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(-0.08184015262726 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17 AS nid, CAST(0.059858033873759 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 30 AS nid, CAST(-0.073116106037881 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 33 AS nid, CAST(0.082225178880863 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 62 AS nid, CAST(-0.073127763901505 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 65 AS nid, CAST(0.074989356937457 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 126 AS nid, CAST(-0.073129303603266 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 127 AS nid, CAST(-0.073129108853019 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 128 AS nid, CAST(0.073667735607011 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 259 AS nid, CAST(0.073498571122349 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 516 AS nid, CAST(0.073306737980892 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 1035 AS nid, CAST(0.073236369600275 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2068 AS nid, CAST(0.073186318642677 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4139 AS nid, CAST(0.073113538506245 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8276 AS nid, CAST(0.073123214766535 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8277 AS nid, CAST(0.073128725623728 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_9" AS 
(SELECT "DT_node_lookup_9"."KEY" AS "KEY", "DT_node_lookup_9".node_id_2 AS node_id_2, "DT_node_data_9".nid AS nid, "DT_node_data_9"."Score" AS "Score" 
FROM "DT_node_lookup_9" LEFT OUTER JOIN "DT_node_data_9" ON "DT_node_lookup_9".node_id_2 = "DT_node_data_9".nid), 
"LGBM_Model_0_9" AS 
(SELECT "DT_Output_9"."KEY" AS "KEY", "DT_Output_9"."Score" AS "Score_0" 
FROM "DT_Output_9")
 SELECT "LGBM_B0"."KEY", "LGBM_B0"."Score_0" 
FROM (SELECT "LGBM_esu_0"."KEY" AS "KEY", "LGBM_esu_0"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_Model_0_0"."KEY" AS "KEY", "LGBM_Model_0_0"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_0" UNION ALL SELECT "LGBM_Model_0_1"."KEY" AS "KEY", "LGBM_Model_0_1"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_1" UNION ALL SELECT "LGBM_Model_0_2"."KEY" AS "KEY", "LGBM_Model_0_2"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_2" UNION ALL SELECT "LGBM_Model_0_3"."KEY" AS "KEY", "LGBM_Model_0_3"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_3" UNION ALL SELECT "LGBM_Model_0_4"."KEY" AS "KEY", "LGBM_Model_0_4"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_4" UNION ALL SELECT "LGBM_Model_0_5"."KEY" AS "KEY", "LGBM_Model_0_5"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_5" UNION ALL SELECT "LGBM_Model_0_6"."KEY" AS "KEY", "LGBM_Model_0_6"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_6" UNION ALL SELECT "LGBM_Model_0_7"."KEY" AS "KEY", "LGBM_Model_0_7"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_7" UNION ALL SELECT "LGBM_Model_0_8"."KEY" AS "KEY", "LGBM_Model_0_8"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_8" UNION ALL SELECT "LGBM_Model_0_9"."KEY" AS "KEY", "LGBM_Model_0_9"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_9") AS "LGBM_esu_0") AS "LGBM_B0") AS "U"

-- Code For temporary table tmp_20180508180813_codegen_hhgppa_lgbm_b1 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180508180813_codegen_hhgppa_lgbm_b1  (
	"KEY" BIGINT, 
	"Score_0" DOUBLE PRECISION
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180508180813_codegen_hhgppa_lgbm_b1 part 2. Populate

INSERT INTO tmp_20180508180813_codegen_hhgppa_lgbm_b1 ("KEY", "Score_0") SELECT "U"."KEY", "U"."Score_0" 
FROM (WITH "DT_node_lookup_10" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= CAST(0.14545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_22" <= CAST(112.80000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(32.85000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.11325 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_21" <= CAST(30.890000000000004 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0016575 AS DOUBLE PRECISION)) THEN 64 ELSE CASE WHEN ("ADS"."Feature_28" <= CAST(0.22495 AS DOUBLE PRECISION)) THEN 130 ELSE CASE WHEN ("ADS"."Feature_11" <= CAST(1.6615 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_28" <= CAST(0.3197 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_7" <= CAST(0.02867 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_9" <= CAST(0.0585 AS DOUBLE PRECISION)) THEN 2096 ELSE CASE WHEN ("ADS"."Feature_13" <= CAST(17.030000000000005 AS DOUBLE PRECISION)) THEN 4194 ELSE 4195 END END ELSE 1049 END ELSE 525 END ELSE 263 END END END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= CAST(822.8500000000001 AS DOUBLE PRECISION)) THEN 6 ELSE CASE WHEN ("ADS"."Feature_23" <= CAST(1030.5000000000002 AS DOUBLE PRECISION)) THEN 14 ELSE CASE WHEN ("ADS"."Feature_27" <= CAST(0.16135 AS DOUBLE PRECISION)) THEN 30 ELSE CASE WHEN ("ADS"."Feature_12" <= CAST(3.363000000000001 AS DOUBLE PRECISION)) THEN 62 ELSE CASE WHEN ("ADS"."Feature_11" <= CAST(1.5195 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.20805 AS DOUBLE PRECISION)) THEN 252 ELSE 253 END ELSE 127 END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
dummy_cte AS 
(SELECT CAST(0.0 AS DOUBLE PRECISION) AS "X"), 
"DT_node_data_10" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.01910886125218 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.024139613395792 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.04174755330156 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(-0.072605877282488 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17 AS nid, CAST(0.075214293902556 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 30 AS nid, CAST(-0.071411311738791 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 33 AS nid, CAST(0.072389530293673 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 62 AS nid, CAST(-0.071490503841551 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 64 AS nid, CAST(0.072188813691966 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 127 AS nid, CAST(-0.071497875704714 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 130 AS nid, CAST(0.071797357585257 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 252 AS nid, CAST(-0.071498162746801 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 253 AS nid, CAST(-0.071498070175299 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 263 AS nid, CAST(0.071672105062964 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 525 AS nid, CAST(0.071590983084339 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 1049 AS nid, CAST(0.071440654926345 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2096 AS nid, CAST(0.071602422690384 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4194 AS nid, CAST(0.071496827804167 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4195 AS nid, CAST(0.071487921429611 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_10" AS 
(SELECT "DT_node_lookup_10"."KEY" AS "KEY", "DT_node_lookup_10".node_id_2 AS node_id_2, "DT_node_data_10".nid AS nid, "DT_node_data_10"."Score" AS "Score" 
FROM "DT_node_lookup_10" LEFT OUTER JOIN "DT_node_data_10" ON "DT_node_lookup_10".node_id_2 = "DT_node_data_10".nid), 
"LGBM_Model_0_10" AS 
(SELECT "DT_Output_10"."KEY" AS "KEY", "DT_Output_10"."Score" AS "Score_0" 
FROM "DT_Output_10"), 
"DT_node_lookup_11" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_22" <= CAST(114.40000000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.14895 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(32.85000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_1" <= CAST(22.645000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.1217 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_20" <= CAST(15.495000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0017905 AS DOUBLE PRECISION)) THEN 128 ELSE CASE WHEN ("ADS"."Feature_11" <= CAST(1.8545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_28" <= CAST(0.22675 AS DOUBLE PRECISION)) THEN 516 ELSE CASE WHEN ("ADS"."Feature_28" <= CAST(0.31775 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_9" <= CAST(0.059095 AS DOUBLE PRECISION)) THEN 2068 ELSE CASE WHEN ("ADS"."Feature_27" <= CAST(0.088875 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(17.695000000000004 AS DOUBLE PRECISION)) THEN 8276 ELSE 8277 END ELSE 4139 END END ELSE 1035 END END ELSE 259 END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_20" <= CAST(18.225000000000005 AS DOUBLE PRECISION)) THEN 6 ELSE CASE WHEN ("ADS"."Feature_27" <= CAST(0.1527 AS DOUBLE PRECISION)) THEN 14 ELSE CASE WHEN ("ADS"."Feature_22" <= CAST(140.40000000000003 AS DOUBLE PRECISION)) THEN 30 ELSE CASE WHEN ("ADS"."Feature_3" <= CAST(1323.0000000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.18305 AS DOUBLE PRECISION)) THEN 124 ELSE 125 END ELSE 63 END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_11" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.03896434599623 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.033673787557454 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.033006252304316 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(-0.078509058850938 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17 AS nid, CAST(0.056546482896203 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 30 AS nid, CAST(-0.070002043828891 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 33 AS nid, CAST(0.07877505566611 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 63 AS nid, CAST(-0.070013598206095 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 65 AS nid, CAST(0.071809545098516 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 124 AS nid, CAST(-0.070015199511383 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 125 AS nid, CAST(-0.070014728716263 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 128 AS nid, CAST(0.070458999870363 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 259 AS nid, CAST(0.0703220076665 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 516 AS nid, CAST(0.070159340671036 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 1035 AS nid, CAST(0.070099973540562 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2068 AS nid, CAST(0.070061590079004 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4139 AS nid, CAST(0.06998709331954 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8276 AS nid, CAST(0.070013768736061 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8277 AS nid, CAST(0.070006302806867 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_11" AS 
(SELECT "DT_node_lookup_11"."KEY" AS "KEY", "DT_node_lookup_11".node_id_2 AS node_id_2, "DT_node_data_11".nid AS nid, "DT_node_data_11"."Score" AS "Score" 
FROM "DT_node_lookup_11" LEFT OUTER JOIN "DT_node_data_11" ON "DT_node_lookup_11".node_id_2 = "DT_node_data_11".nid), 
"LGBM_Model_0_11" AS 
(SELECT "DT_Output_11"."KEY" AS "KEY", "DT_Output_11"."Score" AS "Score_0" 
FROM "DT_Output_11"), 
"DT_node_lookup_12" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= CAST(0.14545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(35.18500000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_9" <= CAST(0.05551 AS DOUBLE PRECISION)) THEN 8 ELSE CASE WHEN ("ADS"."Feature_28" <= CAST(0.33055 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_22" <= CAST(103.80000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(28.995 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_21" <= CAST(30.890000000000004 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_7" <= CAST(0.03631 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_11" <= CAST(1.6785 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0019715 AS DOUBLE PRECISION)) THEN 1152 ELSE CASE WHEN ("ADS"."Feature_8" <= CAST(0.1507 AS DOUBLE PRECISION)) THEN 2306 ELSE CASE WHEN ("ADS"."Feature_18" <= CAST(0.01586 AS DOUBLE PRECISION)) THEN 4614 ELSE CASE WHEN ("ADS"."Feature_5" <= CAST(0.084835 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_18" <= CAST(0.020865 AS DOUBLE PRECISION)) THEN 18460 ELSE 18461 END ELSE 9231 END END END END ELSE 577 END ELSE 289 END ELSE 145 END ELSE 73 END ELSE 37 END ELSE 19 END END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_23" <= CAST(822.8500000000001 AS DOUBLE PRECISION)) THEN 6 ELSE CASE WHEN ("ADS"."Feature_23" <= CAST(1030.5000000000002 AS DOUBLE PRECISION)) THEN 14 ELSE CASE WHEN ("ADS"."Feature_27" <= CAST(0.16135 AS DOUBLE PRECISION)) THEN 30 ELSE CASE WHEN ("ADS"."Feature_12" <= CAST(3.363000000000001 AS DOUBLE PRECISION)) THEN 62 ELSE CASE WHEN ("ADS"."Feature_11" <= CAST(1.5195 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_25" <= CAST(0.4144 AS DOUBLE PRECISION)) THEN 252 ELSE 253 END ELSE 127 END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_12" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.009589512551273 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.022012828651374 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8 AS nid, CAST(0.042978181607982 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(-0.070367906547866 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 19 AS nid, CAST(0.057728490374698 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 30 AS nid, CAST(-0.068517688826505 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 37 AS nid, CAST(0.07905701899446 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 62 AS nid, CAST(-0.068654964988493 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 73 AS nid, CAST(0.071020174541192 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 127 AS nid, CAST(-0.068661119665667 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 145 AS nid, CAST(0.069613563254129 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 252 AS nid, CAST(-0.068661280078397 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 253 AS nid, CAST(-0.068661388255367 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 289 AS nid, CAST(0.06910418058998 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 577 AS nid, CAST(0.068890635291303 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 1152 AS nid, CAST(0.068807774080414 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2306 AS nid, CAST(0.068771259722272 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4614 AS nid, CAST(0.068597556940232 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9231 AS nid, CAST(0.068650125566592 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 18460 AS nid, CAST(0.068661464251349 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 18461 AS nid, CAST(0.068656497299847 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_12" AS 
(SELECT "DT_node_lookup_12"."KEY" AS "KEY", "DT_node_lookup_12".node_id_2 AS node_id_2, "DT_node_data_12".nid AS nid, "DT_node_data_12"."Score" AS "Score" 
FROM "DT_node_lookup_12" LEFT OUTER JOIN "DT_node_data_12" ON "DT_node_lookup_12".node_id_2 = "DT_node_data_12".nid), 
"LGBM_Model_0_12" AS 
(SELECT "DT_Output_12"."KEY" AS "KEY", "DT_Output_12"."Score" AS "Score_0" 
FROM "DT_Output_12"), 
"DT_node_lookup_13" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_22" <= CAST(114.40000000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.14895 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(32.85000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_1" <= CAST(22.645000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.1217 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_9" <= CAST(0.056755 AS DOUBLE PRECISION)) THEN 64 ELSE CASE WHEN ("ADS"."Feature_11" <= CAST(1.8545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_28" <= CAST(0.3204 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0019235 AS DOUBLE PRECISION)) THEN 520 ELSE CASE WHEN ("ADS"."Feature_28" <= CAST(0.22675 AS DOUBLE PRECISION)) THEN 1042 ELSE CASE WHEN ("ADS"."Feature_22" <= CAST(91.42 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_10" <= CAST(0.29495 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_12" <= CAST(1.621 AS DOUBLE PRECISION)) THEN 8344 ELSE 8345 END ELSE 4173 END ELSE 2087 END END END ELSE 261 END ELSE 131 END END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_20" <= CAST(18.225000000000005 AS DOUBLE PRECISION)) THEN 6 ELSE CASE WHEN ("ADS"."Feature_27" <= CAST(0.1527 AS DOUBLE PRECISION)) THEN 14 ELSE CASE WHEN ("ADS"."Feature_22" <= CAST(140.40000000000003 AS DOUBLE PRECISION)) THEN 30 ELSE CASE WHEN ("ADS"."Feature_27" <= CAST(0.18165 AS DOUBLE PRECISION)) THEN 62 ELSE CASE WHEN ("ADS"."Feature_2" <= CAST(136.85000000000005 AS DOUBLE PRECISION)) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_13" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.036111616887041 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.0314417467541 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.031072801985245 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(-0.075962458786988 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17 AS nid, CAST(0.053430879543274 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 30 AS nid, CAST(-0.067410035152113 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 33 AS nid, CAST(0.07560957325638 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 62 AS nid, CAST(-0.067424266219025 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 64 AS nid, CAST(0.068917300297271 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 126 AS nid, CAST(-0.06742303990723 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 127 AS nid, CAST(-0.067421981296541 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 131 AS nid, CAST(0.067699048001898 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 261 AS nid, CAST(0.067619054567741 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 520 AS nid, CAST(0.067586997237382 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 1042 AS nid, CAST(0.067554938582244 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2087 AS nid, CAST(0.067355789926538 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4173 AS nid, CAST(0.067407898359672 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8344 AS nid, CAST(0.067422188779107 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8345 AS nid, CAST(0.06741854251653 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_13" AS 
(SELECT "DT_node_lookup_13"."KEY" AS "KEY", "DT_node_lookup_13".node_id_2 AS node_id_2, "DT_node_data_13".nid AS nid, "DT_node_data_13"."Score" AS "Score" 
FROM "DT_node_lookup_13" LEFT OUTER JOIN "DT_node_data_13" ON "DT_node_lookup_13".node_id_2 = "DT_node_data_13".nid), 
"LGBM_Model_0_13" AS 
(SELECT "DT_Output_13"."KEY" AS "KEY", "DT_Output_13"."Score" AS "Score_0" 
FROM "DT_Output_13"), 
"DT_node_lookup_14" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_27" <= CAST(0.14545 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(35.18500000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_21" <= CAST(31.63000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_4" <= CAST(0.07534 AS DOUBLE PRECISION)) THEN 16 ELSE CASE WHEN ("ADS"."Feature_22" <= CAST(104.45000000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(29.295000000000005 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0017905 AS DOUBLE PRECISION)) THEN 136 ELSE CASE WHEN ("ADS"."Feature_7" <= CAST(0.037625 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_18" <= CAST(0.02738 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_28" <= CAST(0.31085 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_8" <= CAST(0.1527 AS DOUBLE PRECISION)) THEN 2192 ELSE CASE WHEN ("ADS"."Feature_10" <= CAST(0.2977 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_5" <= CAST(0.056105 AS DOUBLE PRECISION)) THEN 8772 ELSE CASE WHEN ("ADS"."Feature_12" <= CAST(1.604 AS DOUBLE PRECISION)) THEN 17546 ELSE 17547 END END ELSE 4387 END END ELSE 1097 END ELSE 549 END ELSE 275 END END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_21" <= CAST(23.785000000000004 AS DOUBLE PRECISION)) THEN 6 ELSE CASE WHEN ("ADS"."Feature_0" <= CAST(14.415 AS DOUBLE PRECISION)) THEN 14 ELSE CASE WHEN ("ADS"."Feature_1" <= CAST(19.635 AS DOUBLE PRECISION)) THEN 30 ELSE CASE WHEN ("ADS"."Feature_10" <= CAST(0.50055 AS DOUBLE PRECISION)) THEN 62 ELSE CASE WHEN ("ADS"."Feature_23" <= CAST(1571.0000000000002 AS DOUBLE PRECISION)) THEN 126 ELSE CASE WHEN ("ADS"."Feature_25" <= CAST(0.3622 AS DOUBLE PRECISION)) THEN 254 ELSE 255 END END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_14" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.008796738222932 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.020437408201738 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.042335542046678 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(-0.077642745777726 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 16 AS nid, CAST(0.057829809565125 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 30 AS nid, CAST(-0.054978383361735 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 35 AS nid, CAST(0.076950251514048 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 62 AS nid, CAST(-0.068247577661402 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 69 AS nid, CAST(0.069188463466897 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 126 AS nid, CAST(-0.066165404002675 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 136 AS nid, CAST(0.066764659515777 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 254 AS nid, CAST(-0.066287742736884 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 255 AS nid, CAST(-0.066286991937291 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 275 AS nid, CAST(0.066710954019096 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 549 AS nid, CAST(0.066509463467658 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 1097 AS nid, CAST(0.066387439947505 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2192 AS nid, CAST(0.066378722982521 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4387 AS nid, CAST(0.066201856776909 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 8772 AS nid, CAST(0.066348008338347 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17546 AS nid, CAST(0.066287247224995 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17547 AS nid, CAST(0.066271848604542 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_14" AS 
(SELECT "DT_node_lookup_14"."KEY" AS "KEY", "DT_node_lookup_14".node_id_2 AS node_id_2, "DT_node_data_14".nid AS nid, "DT_node_data_14"."Score" AS "Score" 
FROM "DT_node_lookup_14" LEFT OUTER JOIN "DT_node_data_14" ON "DT_node_lookup_14".node_id_2 = "DT_node_data_14".nid), 
"LGBM_Model_0_14" AS 
(SELECT "DT_Output_14"."KEY" AS "KEY", "DT_Output_14"."Score" AS "Score_0" 
FROM "DT_Output_14"), 
"DT_node_lookup_15" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_22" <= CAST(114.40000000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_27" <= CAST(0.1327 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(34.73000000000001 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_13" <= CAST(28.995 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_3" <= CAST(609.9000000000002 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_21" <= CAST(31.555000000000003 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_19" <= CAST(0.0017905 AS DOUBLE PRECISION)) THEN 128 ELSE CASE WHEN ("ADS"."Feature_28" <= CAST(0.32625 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_4" <= CAST(0.079425 AS DOUBLE PRECISION)) THEN 516 ELSE CASE WHEN ("ADS"."Feature_14" <= CAST(0.008316 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_1" <= CAST(14.940000000000001 AS DOUBLE PRECISION)) THEN 2068 ELSE CASE WHEN ("ADS"."Feature_22" <= CAST(88.62000000000002 AS DOUBLE PRECISION)) THEN 4138 ELSE 4139 END END ELSE CASE WHEN ("ADS"."Feature_24" <= CAST(0.1387 AS DOUBLE PRECISION)) THEN 2070 ELSE 2071 END END END ELSE 259 END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS"."Feature_20" <= CAST(18.225000000000005 AS DOUBLE PRECISION)) THEN 6 ELSE CASE WHEN ("ADS"."Feature_27" <= CAST(0.1527 AS DOUBLE PRECISION)) THEN 14 ELSE CASE WHEN ("ADS"."Feature_1" <= CAST(18.515000000000004 AS DOUBLE PRECISION)) THEN 30 ELSE CASE WHEN ("ADS"."Feature_1" <= CAST(20.450000000000003 AS DOUBLE PRECISION)) THEN 62 ELSE CASE WHEN ("ADS"."Feature_17" <= CAST(0.01386 AS DOUBLE PRECISION)) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM "BreastCancer" AS "ADS"), 
"DT_node_data_15" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, CAST(-0.007082024263555 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 6 AS nid, CAST(-0.029386564916185 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 9 AS nid, CAST(0.03501580696441 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(-0.073848054207074 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 17 AS nid, CAST(0.067746609267086 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 30 AS nid, CAST(-0.065781283599435 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 33 AS nid, CAST(0.067434231893614 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 62 AS nid, CAST(-0.065307194197167 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 65 AS nid, CAST(0.066658389852525 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 126 AS nid, CAST(-0.065225316173445 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 127 AS nid, CAST(-0.065243384108622 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 128 AS nid, CAST(0.065691351016558 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 259 AS nid, CAST(0.065506459207722 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 516 AS nid, CAST(0.065467434513647 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2068 AS nid, CAST(0.065285373227336 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2070 AS nid, CAST(0.065434166423645 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 2071 AS nid, CAST(0.065288631298404 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4138 AS nid, CAST(0.065233473997014 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte UNION ALL SELECT 4139 AS nid, CAST(0.065192570708224 AS DOUBLE PRECISION) AS "Score" 
FROM dummy_cte) AS "Values"), 
"DT_Output_15" AS 
(SELECT "DT_node_lookup_15"."KEY" AS "KEY", "DT_node_lookup_15".node_id_2 AS node_id_2, "DT_node_data_15".nid AS nid, "DT_node_data_15"."Score" AS "Score" 
FROM "DT_node_lookup_15" LEFT OUTER JOIN "DT_node_data_15" ON "DT_node_lookup_15".node_id_2 = "DT_node_data_15".nid), 
"LGBM_Model_0_15" AS 
(SELECT "DT_Output_15"."KEY" AS "KEY", "DT_Output_15"."Score" AS "Score_0" 
FROM "DT_Output_15")
 SELECT "LGBM_B1"."KEY", "LGBM_B1"."Score_0" 
FROM (SELECT "LGBM_esu_1"."KEY" AS "KEY", "LGBM_esu_1"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_Model_0_10"."KEY" AS "KEY", "LGBM_Model_0_10"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_10" UNION ALL SELECT "LGBM_Model_0_11"."KEY" AS "KEY", "LGBM_Model_0_11"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_11" UNION ALL SELECT "LGBM_Model_0_12"."KEY" AS "KEY", "LGBM_Model_0_12"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_12" UNION ALL SELECT "LGBM_Model_0_13"."KEY" AS "KEY", "LGBM_Model_0_13"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_13" UNION ALL SELECT "LGBM_Model_0_14"."KEY" AS "KEY", "LGBM_Model_0_14"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_14" UNION ALL SELECT "LGBM_Model_0_15"."KEY" AS "KEY", "LGBM_Model_0_15"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_15") AS "LGBM_esu_1") AS "LGBM_B1") AS "U"

-- Code For temporary table tmp_20180508180813_codegen_hdaxjt_lgbm_union part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180508180813_codegen_hdaxjt_lgbm_union  (
	"KEY" BIGINT, 
	"Score_0" DOUBLE PRECISION
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180508180813_codegen_hdaxjt_lgbm_union part 2. Populate

INSERT INTO tmp_20180508180813_codegen_hdaxjt_lgbm_union ("KEY", "Score_0") SELECT "U"."KEY", "U"."Score_0" 
FROM (SELECT "LGBM_Union"."KEY", "LGBM_Union"."Score_0" 
FROM (SELECT "LGBM_EnsembleUnion"."KEY" AS "KEY", "LGBM_EnsembleUnion"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_B0"."KEY" AS "KEY", "LGBM_B0"."Score_0" AS "Score_0" 
FROM tmp_20180508180813_codegen_n76qrf_lgbm_b0 AS "LGBM_B0" UNION ALL SELECT "LGBM_B1"."KEY" AS "KEY", "LGBM_B1"."Score_0" AS "Score_0" 
FROM tmp_20180508180813_codegen_hhgppa_lgbm_b1 AS "LGBM_B1") AS "LGBM_EnsembleUnion") AS "LGBM_Union") AS "U"

-- Code For temporary table tmp_20180508180813_codegen_8257d6_lgbm_sum part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180508180813_codegen_8257d6_lgbm_sum  (
	"KEY" BIGINT, 
	"Score_0" DOUBLE PRECISION
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180508180813_codegen_8257d6_lgbm_sum part 2. Populate

INSERT INTO tmp_20180508180813_codegen_8257d6_lgbm_sum ("KEY", "Score_0") SELECT "U"."KEY", "U"."Score_0" 
FROM (SELECT "LGBM_sum"."KEY", "LGBM_sum"."Score_0" 
FROM (SELECT "T"."KEY" AS "KEY", CAST("T"."Score_0" AS DOUBLE PRECISION) AS "Score_0" 
FROM (SELECT "LGBM_Union"."KEY" AS "KEY", sum("LGBM_Union"."Score_0") AS "Score_0" 
FROM tmp_20180508180813_codegen_hdaxjt_lgbm_union AS "LGBM_Union" GROUP BY "LGBM_Union"."KEY") AS "T") AS "LGBM_sum") AS "U"

-- Model deployment code

WITH orig_cte AS 
(SELECT "LGBM_sum"."KEY" AS "KEY", "LGBM_sum"."Score_0" AS "Score_0", CAST(NULL AS DOUBLE PRECISION) AS "Score_1", CAST(1.0 AS DOUBLE PRECISION) - CAST(1.0 AS DOUBLE PRECISION) / (CAST(1.0 AS DOUBLE PRECISION) + exp(least(greatest(-CAST(100.0 AS DOUBLE PRECISION), -"LGBM_sum"."Score_0"), CAST(100.0 AS DOUBLE PRECISION)))) AS "Proba_0", CAST(1.0 AS DOUBLE PRECISION) / (CAST(1.0 AS DOUBLE PRECISION) + exp(least(greatest(-CAST(100.0 AS DOUBLE PRECISION), -"LGBM_sum"."Score_0"), CAST(100.0 AS DOUBLE PRECISION)))) AS "Proba_1", CAST(NULL AS DOUBLE PRECISION) AS "LogProba_0", CAST(NULL AS DOUBLE PRECISION) AS "LogProba_1", CAST(NULL AS BIGINT) AS "Decision", CAST(NULL AS DOUBLE PRECISION) AS "DecisionProba" 
FROM tmp_20180508180813_codegen_8257d6_lgbm_sum AS "LGBM_sum"), 
score_class_union AS 
(SELECT scu."KEY_u" AS "KEY_u", scu."class" AS "class", scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY_u", 0 AS "class", orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 1 AS "class", orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."Decision" AS "Decision", orig_cte."DecisionProba" AS "DecisionProba", max_select."KEY_m" AS "KEY_m", max_select."max_Proba" AS "max_Proba" 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union."KEY_u" AS "KEY_m", max(score_class_union."Proba") AS "max_Proba" 
FROM score_class_union GROUP BY score_class_union."KEY_u") AS max_select ON orig_cte."KEY" = max_select."KEY_m"), 
union_with_max AS 
(SELECT score_class_union."KEY_u" AS "KEY_u", score_class_union."class" AS "class", score_class_union."LogProba" AS "LogProba", score_class_union."Proba" AS "Proba", score_class_union."Score" AS "Score", score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Proba" AS "max_Proba" 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union."KEY_u" = score_max."KEY"), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Proba" AS "max_Proba", "arg_max_t_Proba"."KEY_Proba" AS "KEY_Proba", "arg_max_t_Proba"."arg_max_Proba" AS "arg_max_Proba" 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max."KEY" AS "KEY_Proba", min(union_with_max."class") AS "arg_max_Proba" 
FROM union_with_max 
WHERE union_with_max."max_Proba" <= union_with_max."Proba" GROUP BY union_with_max."KEY") AS "arg_max_t_Proba" ON score_max."KEY" = "arg_max_t_Proba"."KEY_Proba")
 SELECT arg_max_cte."KEY" AS "KEY", CAST(NULL AS DOUBLE PRECISION) AS "Score_0", CAST(NULL AS DOUBLE PRECISION) AS "Score_1", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > CAST(0.0 AS DOUBLE PRECISION)) THEN ln(arg_max_cte."Proba_0") ELSE -1.79769313486231e+308 END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > CAST(0.0 AS DOUBLE PRECISION)) THEN ln(arg_max_cte."Proba_1") ELSE -1.79769313486231e+308 END AS "LogProba_1", arg_max_cte."arg_max_Proba" AS "Decision", arg_max_cte."max_Proba" AS "DecisionProba" 
FROM arg_max_cte