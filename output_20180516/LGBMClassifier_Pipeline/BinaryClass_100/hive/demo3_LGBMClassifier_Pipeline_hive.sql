-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : LGBMClassifier_Pipeline
-- Dataset : BinaryClass_100
-- Database : hive


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180516111032_codegen_pa6yg5_ads_imp_1_out part 1. Create 

CREATE TEMPORARY TABLE `tmp_20180516111032_codegen_pa6yg5_ads_imp_1_out` STORED AS ORC AS SELECT `ADS_imp_1_OUT`.`KEY`, `ADS_imp_1_OUT`.`impter_2`, `ADS_imp_1_OUT`.`impter_3`, `ADS_imp_1_OUT`.`impter_4`, `ADS_imp_1_OUT`.`impter_5`, `ADS_imp_1_OUT`.`impter_6`, `ADS_imp_1_OUT`.`impter_7`, `ADS_imp_1_OUT`.`impter_8`, `ADS_imp_1_OUT`.`impter_9`, `ADS_imp_1_OUT`.`impter_10`, `ADS_imp_1_OUT`.`impter_11`, `ADS_imp_1_OUT`.`impter_12`, `ADS_imp_1_OUT`.`impter_13`, `ADS_imp_1_OUT`.`impter_14`, `ADS_imp_1_OUT`.`impter_15`, `ADS_imp_1_OUT`.`impter_16`, `ADS_imp_1_OUT`.`impter_17`, `ADS_imp_1_OUT`.`impter_18`, `ADS_imp_1_OUT`.`impter_19`, `ADS_imp_1_OUT`.`impter_20`, `ADS_imp_1_OUT`.`impter_21`, `ADS_imp_1_OUT`.`impter_22`, `ADS_imp_1_OUT`.`impter_23`, `ADS_imp_1_OUT`.`impter_24`, `ADS_imp_1_OUT`.`impter_25`, `ADS_imp_1_OUT`.`impter_26`, `ADS_imp_1_OUT`.`impter_27`, `ADS_imp_1_OUT`.`impter_28`, `ADS_imp_1_OUT`.`impter_29`, `ADS_imp_1_OUT`.`impter_30`, `ADS_imp_1_OUT`.`impter_31`, `ADS_imp_1_OUT`.`impter_32`, `ADS_imp_1_OUT`.`impter_33`, `ADS_imp_1_OUT`.`impter_34`, `ADS_imp_1_OUT`.`impter_35`, `ADS_imp_1_OUT`.`impter_36`, `ADS_imp_1_OUT`.`impter_37`, `ADS_imp_1_OUT`.`impter_38`, `ADS_imp_1_OUT`.`impter_39`, `ADS_imp_1_OUT`.`impter_40`, `ADS_imp_1_OUT`.`impter_41`, `ADS_imp_1_OUT`.`impter_42`, `ADS_imp_1_OUT`.`impter_43`, `ADS_imp_1_OUT`.`impter_44`, `ADS_imp_1_OUT`.`impter_45`, `ADS_imp_1_OUT`.`impter_46`, `ADS_imp_1_OUT`.`impter_47`, `ADS_imp_1_OUT`.`impter_48`, `ADS_imp_1_OUT`.`impter_49`, `ADS_imp_1_OUT`.`impter_50`, `ADS_imp_1_OUT`.`impter_51`, `ADS_imp_1_OUT`.`impter_52`, `ADS_imp_1_OUT`.`impter_53`, `ADS_imp_1_OUT`.`impter_54`, `ADS_imp_1_OUT`.`impter_55`, `ADS_imp_1_OUT`.`impter_56`, `ADS_imp_1_OUT`.`impter_57`, `ADS_imp_1_OUT`.`impter_58`, `ADS_imp_1_OUT`.`impter_59`, `ADS_imp_1_OUT`.`impter_60`, `ADS_imp_1_OUT`.`impter_61`, `ADS_imp_1_OUT`.`impter_62`, `ADS_imp_1_OUT`.`impter_63`, `ADS_imp_1_OUT`.`impter_64`, `ADS_imp_1_OUT`.`impter_65`, `ADS_imp_1_OUT`.`impter_66`, `ADS_imp_1_OUT`.`impter_67`, `ADS_imp_1_OUT`.`impter_68`, `ADS_imp_1_OUT`.`impter_69`, `ADS_imp_1_OUT`.`impter_70`, `ADS_imp_1_OUT`.`impter_71`, `ADS_imp_1_OUT`.`impter_72`, `ADS_imp_1_OUT`.`impter_73`, `ADS_imp_1_OUT`.`impter_74`, `ADS_imp_1_OUT`.`impter_75`, `ADS_imp_1_OUT`.`impter_76`, `ADS_imp_1_OUT`.`impter_77`, `ADS_imp_1_OUT`.`impter_78`, `ADS_imp_1_OUT`.`impter_79`, `ADS_imp_1_OUT`.`impter_80`, `ADS_imp_1_OUT`.`impter_81`, `ADS_imp_1_OUT`.`impter_82`, `ADS_imp_1_OUT`.`impter_83`, `ADS_imp_1_OUT`.`impter_84`, `ADS_imp_1_OUT`.`impter_85`, `ADS_imp_1_OUT`.`impter_86`, `ADS_imp_1_OUT`.`impter_87`, `ADS_imp_1_OUT`.`impter_88`, `ADS_imp_1_OUT`.`impter_89`, `ADS_imp_1_OUT`.`impter_90`, `ADS_imp_1_OUT`.`impter_91`, `ADS_imp_1_OUT`.`impter_92`, `ADS_imp_1_OUT`.`impter_93`, `ADS_imp_1_OUT`.`impter_94`, `ADS_imp_1_OUT`.`impter_95`, `ADS_imp_1_OUT`.`impter_96`, `ADS_imp_1_OUT`.`impter_97`, `ADS_imp_1_OUT`.`impter_98`, `ADS_imp_1_OUT`.`impter_99`, `ADS_imp_1_OUT`.`impter_100`, `ADS_imp_1_OUT`.`impter_101` 
FROM (SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 0.14903440845324958 ELSE `ADS`.`Feature_0` END AS `impter_2`, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN -0.03367636493032261 ELSE `ADS`.`Feature_1` END AS `impter_3`, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 0.11933316355610842 ELSE `ADS`.`Feature_2` END AS `impter_4`, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN -0.17369203130189262 ELSE `ADS`.`Feature_3` END AS `impter_5`, CASE WHEN (`ADS`.`Feature_4` IS NULL) THEN 0.06534355492106358 ELSE `ADS`.`Feature_4` END AS `impter_6`, CASE WHEN (`ADS`.`Feature_5` IS NULL) THEN 0.2436228993764152 ELSE `ADS`.`Feature_5` END AS `impter_7`, CASE WHEN (`ADS`.`Feature_6` IS NULL) THEN -0.11367357911147091 ELSE `ADS`.`Feature_6` END AS `impter_8`, CASE WHEN (`ADS`.`Feature_7` IS NULL) THEN -0.21176443876708548 ELSE `ADS`.`Feature_7` END AS `impter_9`, CASE WHEN (`ADS`.`Feature_8` IS NULL) THEN 0.11513979914587343 ELSE `ADS`.`Feature_8` END AS `impter_10`, CASE WHEN (`ADS`.`Feature_9` IS NULL) THEN 0.029111924938589835 ELSE `ADS`.`Feature_9` END AS `impter_11`, CASE WHEN (`ADS`.`Feature_10` IS NULL) THEN 0.1107718926861467 ELSE `ADS`.`Feature_10` END AS `impter_12`, CASE WHEN (`ADS`.`Feature_11` IS NULL) THEN 0.0014580375424568769 ELSE `ADS`.`Feature_11` END AS `impter_13`, CASE WHEN (`ADS`.`Feature_12` IS NULL) THEN -0.0773739291867229 ELSE `ADS`.`Feature_12` END AS `impter_14`, CASE WHEN (`ADS`.`Feature_13` IS NULL) THEN -0.1139572875884789 ELSE `ADS`.`Feature_13` END AS `impter_15`, CASE WHEN (`ADS`.`Feature_14` IS NULL) THEN -0.12567631285043362 ELSE `ADS`.`Feature_14` END AS `impter_16`, CASE WHEN (`ADS`.`Feature_15` IS NULL) THEN -0.05799597833985687 ELSE `ADS`.`Feature_15` END AS `impter_17`, CASE WHEN (`ADS`.`Feature_16` IS NULL) THEN -0.14181264174476002 ELSE `ADS`.`Feature_16` END AS `impter_18`, CASE WHEN (`ADS`.`Feature_17` IS NULL) THEN -0.1265454286904762 ELSE `ADS`.`Feature_17` END AS `impter_19`, CASE WHEN (`ADS`.`Feature_18` IS NULL) THEN -0.07812248683518369 ELSE `ADS`.`Feature_18` END AS `impter_20`, CASE WHEN (`ADS`.`Feature_19` IS NULL) THEN -0.07648737683022465 ELSE `ADS`.`Feature_19` END AS `impter_21`, CASE WHEN (`ADS`.`Feature_20` IS NULL) THEN 0.05864262427869482 ELSE `ADS`.`Feature_20` END AS `impter_22`, CASE WHEN (`ADS`.`Feature_21` IS NULL) THEN 0.10844037074552852 ELSE `ADS`.`Feature_21` END AS `impter_23`, CASE WHEN (`ADS`.`Feature_22` IS NULL) THEN 0.060065969333441514 ELSE `ADS`.`Feature_22` END AS `impter_24`, CASE WHEN (`ADS`.`Feature_23` IS NULL) THEN 0.15255771271935042 ELSE `ADS`.`Feature_23` END AS `impter_25`, CASE WHEN (`ADS`.`Feature_24` IS NULL) THEN -0.047123256877991036 ELSE `ADS`.`Feature_24` END AS `impter_26`, CASE WHEN (`ADS`.`Feature_25` IS NULL) THEN -0.05696296914089203 ELSE `ADS`.`Feature_25` END AS `impter_27`, CASE WHEN (`ADS`.`Feature_26` IS NULL) THEN 0.09614684099943512 ELSE `ADS`.`Feature_26` END AS `impter_28`, CASE WHEN (`ADS`.`Feature_27` IS NULL) THEN 0.10433833409752227 ELSE `ADS`.`Feature_27` END AS `impter_29`, CASE WHEN (`ADS`.`Feature_28` IS NULL) THEN 0.03257716191960926 ELSE `ADS`.`Feature_28` END AS `impter_30`, CASE WHEN (`ADS`.`Feature_29` IS NULL) THEN 0.06142905749366723 ELSE `ADS`.`Feature_29` END AS `impter_31`, CASE WHEN (`ADS`.`Feature_30` IS NULL) THEN -0.014540423460679405 ELSE `ADS`.`Feature_30` END AS `impter_32`, CASE WHEN (`ADS`.`Feature_31` IS NULL) THEN -0.1123380099941879 ELSE `ADS`.`Feature_31` END AS `impter_33`, CASE WHEN (`ADS`.`Feature_32` IS NULL) THEN 0.1189128446049145 ELSE `ADS`.`Feature_32` END AS `impter_34`, CASE WHEN (`ADS`.`Feature_33` IS NULL) THEN 0.2286864930078044 ELSE `ADS`.`Feature_33` END AS `impter_35`, CASE WHEN (`ADS`.`Feature_34` IS NULL) THEN 0.23566181549921908 ELSE `ADS`.`Feature_34` END AS `impter_36`, CASE WHEN (`ADS`.`Feature_35` IS NULL) THEN 0.07316970399964386 ELSE `ADS`.`Feature_35` END AS `impter_37`, CASE WHEN (`ADS`.`Feature_36` IS NULL) THEN -0.03319409827469623 ELSE `ADS`.`Feature_36` END AS `impter_38`, CASE WHEN (`ADS`.`Feature_37` IS NULL) THEN 0.2734938774177451 ELSE `ADS`.`Feature_37` END AS `impter_39`, CASE WHEN (`ADS`.`Feature_38` IS NULL) THEN -0.023289567742236165 ELSE `ADS`.`Feature_38` END AS `impter_40`, CASE WHEN (`ADS`.`Feature_39` IS NULL) THEN 0.030288379260645946 ELSE `ADS`.`Feature_39` END AS `impter_41`, CASE WHEN (`ADS`.`Feature_40` IS NULL) THEN -0.10736826233135917 ELSE `ADS`.`Feature_40` END AS `impter_42`, CASE WHEN (`ADS`.`Feature_41` IS NULL) THEN 0.026402950097887946 ELSE `ADS`.`Feature_41` END AS `impter_43`, CASE WHEN (`ADS`.`Feature_42` IS NULL) THEN -0.09677146654911453 ELSE `ADS`.`Feature_42` END AS `impter_44`, CASE WHEN (`ADS`.`Feature_43` IS NULL) THEN 0.005974248342970334 ELSE `ADS`.`Feature_43` END AS `impter_45`, CASE WHEN (`ADS`.`Feature_44` IS NULL) THEN 0.036917268127071114 ELSE `ADS`.`Feature_44` END AS `impter_46`, CASE WHEN (`ADS`.`Feature_45` IS NULL) THEN -0.14525717382374131 ELSE `ADS`.`Feature_45` END AS `impter_47`, CASE WHEN (`ADS`.`Feature_46` IS NULL) THEN -0.16675269881177787 ELSE `ADS`.`Feature_46` END AS `impter_48`, CASE WHEN (`ADS`.`Feature_47` IS NULL) THEN 0.25084465695652713 ELSE `ADS`.`Feature_47` END AS `impter_49`, CASE WHEN (`ADS`.`Feature_48` IS NULL) THEN 0.14623398322257627 ELSE `ADS`.`Feature_48` END AS `impter_50`, CASE WHEN (`ADS`.`Feature_49` IS NULL) THEN 0.10185431133406106 ELSE `ADS`.`Feature_49` END AS `impter_51`, CASE WHEN (`ADS`.`Feature_50` IS NULL) THEN -0.13292560945085755 ELSE `ADS`.`Feature_50` END AS `impter_52`, CASE WHEN (`ADS`.`Feature_51` IS NULL) THEN -0.042191791365440365 ELSE `ADS`.`Feature_51` END AS `impter_53`, CASE WHEN (`ADS`.`Feature_52` IS NULL) THEN 0.15214028404681929 ELSE `ADS`.`Feature_52` END AS `impter_54`, CASE WHEN (`ADS`.`Feature_53` IS NULL) THEN -0.15821372314298002 ELSE `ADS`.`Feature_53` END AS `impter_55`, CASE WHEN (`ADS`.`Feature_54` IS NULL) THEN 0.17926260535776073 ELSE `ADS`.`Feature_54` END AS `impter_56`, CASE WHEN (`ADS`.`Feature_55` IS NULL) THEN 0.05077533210437681 ELSE `ADS`.`Feature_55` END AS `impter_57`, CASE WHEN (`ADS`.`Feature_56` IS NULL) THEN -0.011884551362322174 ELSE `ADS`.`Feature_56` END AS `impter_58`, CASE WHEN (`ADS`.`Feature_57` IS NULL) THEN -0.04948745069141103 ELSE `ADS`.`Feature_57` END AS `impter_59`, CASE WHEN (`ADS`.`Feature_58` IS NULL) THEN -0.13256733552482858 ELSE `ADS`.`Feature_58` END AS `impter_60`, CASE WHEN (`ADS`.`Feature_59` IS NULL) THEN 0.11866238202513515 ELSE `ADS`.`Feature_59` END AS `impter_61`, CASE WHEN (`ADS`.`Feature_60` IS NULL) THEN -0.06590828520229039 ELSE `ADS`.`Feature_60` END AS `impter_62`, CASE WHEN (`ADS`.`Feature_61` IS NULL) THEN 0.1554857338869047 ELSE `ADS`.`Feature_61` END AS `impter_63`, CASE WHEN (`ADS`.`Feature_62` IS NULL) THEN -0.006608301490984002 ELSE `ADS`.`Feature_62` END AS `impter_64`, CASE WHEN (`ADS`.`Feature_63` IS NULL) THEN -0.01827580148493827 ELSE `ADS`.`Feature_63` END AS `impter_65`, CASE WHEN (`ADS`.`Feature_64` IS NULL) THEN -0.027366317428668574 ELSE `ADS`.`Feature_64` END AS `impter_66`, CASE WHEN (`ADS`.`Feature_65` IS NULL) THEN 0.01436625003668961 ELSE `ADS`.`Feature_65` END AS `impter_67`, CASE WHEN (`ADS`.`Feature_66` IS NULL) THEN 0.054075300089557875 ELSE `ADS`.`Feature_66` END AS `impter_68`, CASE WHEN (`ADS`.`Feature_67` IS NULL) THEN -0.23085273383923544 ELSE `ADS`.`Feature_67` END AS `impter_69`, CASE WHEN (`ADS`.`Feature_68` IS NULL) THEN -0.24396528808375115 ELSE `ADS`.`Feature_68` END AS `impter_70`, CASE WHEN (`ADS`.`Feature_69` IS NULL) THEN 0.06545065787659607 ELSE `ADS`.`Feature_69` END AS `impter_71`, CASE WHEN (`ADS`.`Feature_70` IS NULL) THEN 0.04266518302023082 ELSE `ADS`.`Feature_70` END AS `impter_72`, CASE WHEN (`ADS`.`Feature_71` IS NULL) THEN -0.1540451820349279 ELSE `ADS`.`Feature_71` END AS `impter_73`, CASE WHEN (`ADS`.`Feature_72` IS NULL) THEN -0.2222352564572451 ELSE `ADS`.`Feature_72` END AS `impter_74`, CASE WHEN (`ADS`.`Feature_73` IS NULL) THEN 0.0685606372972674 ELSE `ADS`.`Feature_73` END AS `impter_75`, CASE WHEN (`ADS`.`Feature_74` IS NULL) THEN -0.09639592085393558 ELSE `ADS`.`Feature_74` END AS `impter_76`, CASE WHEN (`ADS`.`Feature_75` IS NULL) THEN 0.20747518927524572 ELSE `ADS`.`Feature_75` END AS `impter_77`, CASE WHEN (`ADS`.`Feature_76` IS NULL) THEN -0.13945256367132464 ELSE `ADS`.`Feature_76` END AS `impter_78`, CASE WHEN (`ADS`.`Feature_77` IS NULL) THEN 0.021954208773706758 ELSE `ADS`.`Feature_77` END AS `impter_79`, CASE WHEN (`ADS`.`Feature_78` IS NULL) THEN 0.07033517037026028 ELSE `ADS`.`Feature_78` END AS `impter_80`, CASE WHEN (`ADS`.`Feature_79` IS NULL) THEN 0.12062472190694748 ELSE `ADS`.`Feature_79` END AS `impter_81`, CASE WHEN (`ADS`.`Feature_80` IS NULL) THEN -0.03376594744247921 ELSE `ADS`.`Feature_80` END AS `impter_82`, CASE WHEN (`ADS`.`Feature_81` IS NULL) THEN -0.11063521313283846 ELSE `ADS`.`Feature_81` END AS `impter_83`, CASE WHEN (`ADS`.`Feature_82` IS NULL) THEN 0.040264280436689885 ELSE `ADS`.`Feature_82` END AS `impter_84`, CASE WHEN (`ADS`.`Feature_83` IS NULL) THEN 0.047619698634703535 ELSE `ADS`.`Feature_83` END AS `impter_85`, CASE WHEN (`ADS`.`Feature_84` IS NULL) THEN 0.10294542896565007 ELSE `ADS`.`Feature_84` END AS `impter_86`, CASE WHEN (`ADS`.`Feature_85` IS NULL) THEN 0.03543139086541035 ELSE `ADS`.`Feature_85` END AS `impter_87`, CASE WHEN (`ADS`.`Feature_86` IS NULL) THEN 0.15812674995414752 ELSE `ADS`.`Feature_86` END AS `impter_88`, CASE WHEN (`ADS`.`Feature_87` IS NULL) THEN -0.09370679202503561 ELSE `ADS`.`Feature_87` END AS `impter_89`, CASE WHEN (`ADS`.`Feature_88` IS NULL) THEN -0.05352174133125283 ELSE `ADS`.`Feature_88` END AS `impter_90`, CASE WHEN (`ADS`.`Feature_89` IS NULL) THEN -0.05671142135749989 ELSE `ADS`.`Feature_89` END AS `impter_91`, CASE WHEN (`ADS`.`Feature_90` IS NULL) THEN 0.1683501919918398 ELSE `ADS`.`Feature_90` END AS `impter_92`, CASE WHEN (`ADS`.`Feature_91` IS NULL) THEN -0.08014687785959375 ELSE `ADS`.`Feature_91` END AS `impter_93`, CASE WHEN (`ADS`.`Feature_92` IS NULL) THEN 0.06732751721128641 ELSE `ADS`.`Feature_92` END AS `impter_94`, CASE WHEN (`ADS`.`Feature_93` IS NULL) THEN -0.00888651681786575 ELSE `ADS`.`Feature_93` END AS `impter_95`, CASE WHEN (`ADS`.`Feature_94` IS NULL) THEN 0.026095385517810564 ELSE `ADS`.`Feature_94` END AS `impter_96`, CASE WHEN (`ADS`.`Feature_95` IS NULL) THEN 0.04435425200996614 ELSE `ADS`.`Feature_95` END AS `impter_97`, CASE WHEN (`ADS`.`Feature_96` IS NULL) THEN 0.026895408070568623 ELSE `ADS`.`Feature_96` END AS `impter_98`, CASE WHEN (`ADS`.`Feature_97` IS NULL) THEN 0.18232971539070067 ELSE `ADS`.`Feature_97` END AS `impter_99`, CASE WHEN (`ADS`.`Feature_98` IS NULL) THEN -0.12132540363011564 ELSE `ADS`.`Feature_98` END AS `impter_100`, CASE WHEN (`ADS`.`Feature_99` IS NULL) THEN 0.004420132524286926 ELSE `ADS`.`Feature_99` END AS `impter_101` 
FROM `BinaryClass_100` AS `ADS`) AS `ADS_imp_1_OUT`

-- Code For temporary table tmp_20180516111032_codegen_pa6yg5_ads_imp_1_out part 2. Populate

SELECT * FROM `tmp_20180516111032_codegen_pa6yg5_ads_imp_1_out`

-- Code For temporary table tmp_20180516111032_codegen_rpdivm_ads_sca_2_out part 1. Create 

CREATE TEMPORARY TABLE `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` STORED AS ORC AS SELECT `ADS_sca_2_OUT`.`KEY`, `ADS_sca_2_OUT`.`scaler_2`, `ADS_sca_2_OUT`.`scaler_3`, `ADS_sca_2_OUT`.`scaler_4`, `ADS_sca_2_OUT`.`scaler_5`, `ADS_sca_2_OUT`.`scaler_6`, `ADS_sca_2_OUT`.`scaler_7`, `ADS_sca_2_OUT`.`scaler_8`, `ADS_sca_2_OUT`.`scaler_9`, `ADS_sca_2_OUT`.`scaler_10`, `ADS_sca_2_OUT`.`scaler_11`, `ADS_sca_2_OUT`.`scaler_12`, `ADS_sca_2_OUT`.`scaler_13`, `ADS_sca_2_OUT`.`scaler_14`, `ADS_sca_2_OUT`.`scaler_15`, `ADS_sca_2_OUT`.`scaler_16`, `ADS_sca_2_OUT`.`scaler_17`, `ADS_sca_2_OUT`.`scaler_18`, `ADS_sca_2_OUT`.`scaler_19`, `ADS_sca_2_OUT`.`scaler_20`, `ADS_sca_2_OUT`.`scaler_21`, `ADS_sca_2_OUT`.`scaler_22`, `ADS_sca_2_OUT`.`scaler_23`, `ADS_sca_2_OUT`.`scaler_24`, `ADS_sca_2_OUT`.`scaler_25`, `ADS_sca_2_OUT`.`scaler_26`, `ADS_sca_2_OUT`.`scaler_27`, `ADS_sca_2_OUT`.`scaler_28`, `ADS_sca_2_OUT`.`scaler_29`, `ADS_sca_2_OUT`.`scaler_30`, `ADS_sca_2_OUT`.`scaler_31`, `ADS_sca_2_OUT`.`scaler_32`, `ADS_sca_2_OUT`.`scaler_33`, `ADS_sca_2_OUT`.`scaler_34`, `ADS_sca_2_OUT`.`scaler_35`, `ADS_sca_2_OUT`.`scaler_36`, `ADS_sca_2_OUT`.`scaler_37`, `ADS_sca_2_OUT`.`scaler_38`, `ADS_sca_2_OUT`.`scaler_39`, `ADS_sca_2_OUT`.`scaler_40`, `ADS_sca_2_OUT`.`scaler_41`, `ADS_sca_2_OUT`.`scaler_42`, `ADS_sca_2_OUT`.`scaler_43`, `ADS_sca_2_OUT`.`scaler_44`, `ADS_sca_2_OUT`.`scaler_45`, `ADS_sca_2_OUT`.`scaler_46`, `ADS_sca_2_OUT`.`scaler_47`, `ADS_sca_2_OUT`.`scaler_48`, `ADS_sca_2_OUT`.`scaler_49`, `ADS_sca_2_OUT`.`scaler_50`, `ADS_sca_2_OUT`.`scaler_51`, `ADS_sca_2_OUT`.`scaler_52`, `ADS_sca_2_OUT`.`scaler_53`, `ADS_sca_2_OUT`.`scaler_54`, `ADS_sca_2_OUT`.`scaler_55`, `ADS_sca_2_OUT`.`scaler_56`, `ADS_sca_2_OUT`.`scaler_57`, `ADS_sca_2_OUT`.`scaler_58`, `ADS_sca_2_OUT`.`scaler_59`, `ADS_sca_2_OUT`.`scaler_60`, `ADS_sca_2_OUT`.`scaler_61`, `ADS_sca_2_OUT`.`scaler_62`, `ADS_sca_2_OUT`.`scaler_63`, `ADS_sca_2_OUT`.`scaler_64`, `ADS_sca_2_OUT`.`scaler_65`, `ADS_sca_2_OUT`.`scaler_66`, `ADS_sca_2_OUT`.`scaler_67`, `ADS_sca_2_OUT`.`scaler_68`, `ADS_sca_2_OUT`.`scaler_69`, `ADS_sca_2_OUT`.`scaler_70`, `ADS_sca_2_OUT`.`scaler_71`, `ADS_sca_2_OUT`.`scaler_72`, `ADS_sca_2_OUT`.`scaler_73`, `ADS_sca_2_OUT`.`scaler_74`, `ADS_sca_2_OUT`.`scaler_75`, `ADS_sca_2_OUT`.`scaler_76`, `ADS_sca_2_OUT`.`scaler_77`, `ADS_sca_2_OUT`.`scaler_78`, `ADS_sca_2_OUT`.`scaler_79`, `ADS_sca_2_OUT`.`scaler_80`, `ADS_sca_2_OUT`.`scaler_81`, `ADS_sca_2_OUT`.`scaler_82`, `ADS_sca_2_OUT`.`scaler_83`, `ADS_sca_2_OUT`.`scaler_84`, `ADS_sca_2_OUT`.`scaler_85`, `ADS_sca_2_OUT`.`scaler_86`, `ADS_sca_2_OUT`.`scaler_87`, `ADS_sca_2_OUT`.`scaler_88`, `ADS_sca_2_OUT`.`scaler_89`, `ADS_sca_2_OUT`.`scaler_90`, `ADS_sca_2_OUT`.`scaler_91`, `ADS_sca_2_OUT`.`scaler_92`, `ADS_sca_2_OUT`.`scaler_93`, `ADS_sca_2_OUT`.`scaler_94`, `ADS_sca_2_OUT`.`scaler_95`, `ADS_sca_2_OUT`.`scaler_96`, `ADS_sca_2_OUT`.`scaler_97`, `ADS_sca_2_OUT`.`scaler_98`, `ADS_sca_2_OUT`.`scaler_99`, `ADS_sca_2_OUT`.`scaler_100`, `ADS_sca_2_OUT`.`scaler_101` 
FROM (SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.`impter_2` AS DOUBLE) - 0.14903440845324958) / 0.8636609678928474 AS `scaler_2`, (CAST(`ADS_imp_1_OUT`.`impter_3` AS DOUBLE) - -0.03367636493032261) / 0.9578461188823892 AS `scaler_3`, (CAST(`ADS_imp_1_OUT`.`impter_4` AS DOUBLE) - 0.11933316355610842) / 0.988940710894537 AS `scaler_4`, (CAST(`ADS_imp_1_OUT`.`impter_5` AS DOUBLE) - -0.17369203130189262) / 0.9255555424369695 AS `scaler_5`, (CAST(`ADS_imp_1_OUT`.`impter_6` AS DOUBLE) - 0.06534355492106358) / 1.2549066590522007 AS `scaler_6`, (CAST(`ADS_imp_1_OUT`.`impter_7` AS DOUBLE) - 0.2436228993764152) / 1.0289985897454397 AS `scaler_7`, (CAST(`ADS_imp_1_OUT`.`impter_8` AS DOUBLE) - -0.11367357911147091) / 0.8923136895775531 AS `scaler_8`, (CAST(`ADS_imp_1_OUT`.`impter_9` AS DOUBLE) - -0.21176443876708548) / 0.9002988999952058 AS `scaler_9`, (CAST(`ADS_imp_1_OUT`.`impter_10` AS DOUBLE) - 0.11513979914587343) / 1.0407931178174141 AS `scaler_10`, (CAST(`ADS_imp_1_OUT`.`impter_11` AS DOUBLE) - 0.029111924938589835) / 0.8191882677751 AS `scaler_11`, (CAST(`ADS_imp_1_OUT`.`impter_12` AS DOUBLE) - 0.1107718926861467) / 1.1250344343026408 AS `scaler_12`, (CAST(`ADS_imp_1_OUT`.`impter_13` AS DOUBLE) - 0.0014580375424568769) / 1.0581752782303462 AS `scaler_13`, (CAST(`ADS_imp_1_OUT`.`impter_14` AS DOUBLE) - -0.0773739291867229) / 0.9419092604618728 AS `scaler_14`, (CAST(`ADS_imp_1_OUT`.`impter_15` AS DOUBLE) - -0.1139572875884789) / 0.9844340172570488 AS `scaler_15`, (CAST(`ADS_imp_1_OUT`.`impter_16` AS DOUBLE) - -0.12567631285043362) / 1.0696960659875883 AS `scaler_16`, (CAST(`ADS_imp_1_OUT`.`impter_17` AS DOUBLE) - -0.05799597833985687) / 0.9572246869765944 AS `scaler_17`, (CAST(`ADS_imp_1_OUT`.`impter_18` AS DOUBLE) - -0.14181264174476002) / 0.9402782318020427 AS `scaler_18`, (CAST(`ADS_imp_1_OUT`.`impter_19` AS DOUBLE) - -0.1265454286904762) / 1.0394075774622935 AS `scaler_19`, (CAST(`ADS_imp_1_OUT`.`impter_20` AS DOUBLE) - -0.07812248683518369) / 1.3223760230644108 AS `scaler_20`, (CAST(`ADS_imp_1_OUT`.`impter_21` AS DOUBLE) - -0.07648737683022465) / 0.9488949379248575 AS `scaler_21`, (CAST(`ADS_imp_1_OUT`.`impter_22` AS DOUBLE) - 0.05864262427869482) / 0.9538581426644901 AS `scaler_22`, (CAST(`ADS_imp_1_OUT`.`impter_23` AS DOUBLE) - 0.10844037074552852) / 1.210930082570065 AS `scaler_23`, (CAST(`ADS_imp_1_OUT`.`impter_24` AS DOUBLE) - 0.060065969333441514) / 0.9191502156507799 AS `scaler_24`, (CAST(`ADS_imp_1_OUT`.`impter_25` AS DOUBLE) - 0.15255771271935042) / 0.9299576154754636 AS `scaler_25`, (CAST(`ADS_imp_1_OUT`.`impter_26` AS DOUBLE) - -0.047123256877991036) / 0.7721855440773565 AS `scaler_26`, (CAST(`ADS_imp_1_OUT`.`impter_27` AS DOUBLE) - -0.05696296914089203) / 0.8655084393513448 AS `scaler_27`, (CAST(`ADS_imp_1_OUT`.`impter_28` AS DOUBLE) - 0.09614684099943512) / 0.96937898078964 AS `scaler_28`, (CAST(`ADS_imp_1_OUT`.`impter_29` AS DOUBLE) - 0.10433833409752227) / 1.0974731508769155 AS `scaler_29`, (CAST(`ADS_imp_1_OUT`.`impter_30` AS DOUBLE) - 0.03257716191960926) / 0.9435063968783003 AS `scaler_30`, (CAST(`ADS_imp_1_OUT`.`impter_31` AS DOUBLE) - 0.06142905749366723) / 1.1170732733267863 AS `scaler_31`, (CAST(`ADS_imp_1_OUT`.`impter_32` AS DOUBLE) - -0.014540423460679405) / 1.0573168197323033 AS `scaler_32`, (CAST(`ADS_imp_1_OUT`.`impter_33` AS DOUBLE) - -0.1123380099941879) / 0.9786151659749657 AS `scaler_33`, (CAST(`ADS_imp_1_OUT`.`impter_34` AS DOUBLE) - 0.1189128446049145) / 1.0063563400772833 AS `scaler_34`, (CAST(`ADS_imp_1_OUT`.`impter_35` AS DOUBLE) - 0.2286864930078044) / 0.9987517899102172 AS `scaler_35`, (CAST(`ADS_imp_1_OUT`.`impter_36` AS DOUBLE) - 0.23566181549921908) / 0.8892125575448739 AS `scaler_36`, (CAST(`ADS_imp_1_OUT`.`impter_37` AS DOUBLE) - 0.07316970399964386) / 0.8478593314579883 AS `scaler_37`, (CAST(`ADS_imp_1_OUT`.`impter_38` AS DOUBLE) - -0.03319409827469623) / 0.9417761591755847 AS `scaler_38`, (CAST(`ADS_imp_1_OUT`.`impter_39` AS DOUBLE) - 0.2734938774177451) / 0.8842710941098582 AS `scaler_39`, (CAST(`ADS_imp_1_OUT`.`impter_40` AS DOUBLE) - -0.023289567742236165) / 0.9947645749252034 AS `scaler_40`, (CAST(`ADS_imp_1_OUT`.`impter_41` AS DOUBLE) - 0.030288379260645946) / 1.038539402148216 AS `scaler_41`, (CAST(`ADS_imp_1_OUT`.`impter_42` AS DOUBLE) - -0.10736826233135917) / 0.9830117951146878 AS `scaler_42`, (CAST(`ADS_imp_1_OUT`.`impter_43` AS DOUBLE) - 0.026402950097887946) / 1.0398287539710105 AS `scaler_43`, (CAST(`ADS_imp_1_OUT`.`impter_44` AS DOUBLE) - -0.09677146654911453) / 1.0015225564098231 AS `scaler_44`, (CAST(`ADS_imp_1_OUT`.`impter_45` AS DOUBLE) - 0.005974248342970334) / 0.9192248357286628 AS `scaler_45`, (CAST(`ADS_imp_1_OUT`.`impter_46` AS DOUBLE) - 0.036917268127071114) / 1.069754938973098 AS `scaler_46`, (CAST(`ADS_imp_1_OUT`.`impter_47` AS DOUBLE) - -0.14525717382374131) / 1.0022143023048327 AS `scaler_47`, (CAST(`ADS_imp_1_OUT`.`impter_48` AS DOUBLE) - -0.16675269881177787) / 1.0264976173555715 AS `scaler_48`, (CAST(`ADS_imp_1_OUT`.`impter_49` AS DOUBLE) - 0.25084465695652713) / 1.0176351295531831 AS `scaler_49`, (CAST(`ADS_imp_1_OUT`.`impter_50` AS DOUBLE) - 0.14623398322257627) / 0.9499010882454708 AS `scaler_50`, (CAST(`ADS_imp_1_OUT`.`impter_51` AS DOUBLE) - 0.10185431133406106) / 1.0834913023248847 AS `scaler_51`, (CAST(`ADS_imp_1_OUT`.`impter_52` AS DOUBLE) - -0.13292560945085755) / 1.203043012940759 AS `scaler_52`, (CAST(`ADS_imp_1_OUT`.`impter_53` AS DOUBLE) - -0.042191791365440365) / 1.0890718481954653 AS `scaler_53`, (CAST(`ADS_imp_1_OUT`.`impter_54` AS DOUBLE) - 0.15214028404681929) / 1.0355928162656227 AS `scaler_54`, (CAST(`ADS_imp_1_OUT`.`impter_55` AS DOUBLE) - -0.15821372314298002) / 0.8130848573586256 AS `scaler_55`, (CAST(`ADS_imp_1_OUT`.`impter_56` AS DOUBLE) - 0.17926260535776073) / 1.0704671463335236 AS `scaler_56`, (CAST(`ADS_imp_1_OUT`.`impter_57` AS DOUBLE) - 0.05077533210437681) / 1.0052564941217246 AS `scaler_57`, (CAST(`ADS_imp_1_OUT`.`impter_58` AS DOUBLE) - -0.011884551362322174) / 0.9691413097866551 AS `scaler_58`, (CAST(`ADS_imp_1_OUT`.`impter_59` AS DOUBLE) - -0.04948745069141103) / 1.2609768269937562 AS `scaler_59`, (CAST(`ADS_imp_1_OUT`.`impter_60` AS DOUBLE) - -0.13256733552482858) / 0.8686251022330442 AS `scaler_60`, (CAST(`ADS_imp_1_OUT`.`impter_61` AS DOUBLE) - 0.11866238202513515) / 1.0631654849592418 AS `scaler_61`, (CAST(`ADS_imp_1_OUT`.`impter_62` AS DOUBLE) - -0.06590828520229039) / 1.0418727908296095 AS `scaler_62`, (CAST(`ADS_imp_1_OUT`.`impter_63` AS DOUBLE) - 0.1554857338869047) / 0.8946519794042862 AS `scaler_63`, (CAST(`ADS_imp_1_OUT`.`impter_64` AS DOUBLE) - -0.006608301490984002) / 0.9166153141716471 AS `scaler_64`, (CAST(`ADS_imp_1_OUT`.`impter_65` AS DOUBLE) - -0.01827580148493827) / 1.037281466599587 AS `scaler_65`, (CAST(`ADS_imp_1_OUT`.`impter_66` AS DOUBLE) - -0.027366317428668574) / 0.8876680722044222 AS `scaler_66`, (CAST(`ADS_imp_1_OUT`.`impter_67` AS DOUBLE) - 0.01436625003668961) / 0.9184976645949744 AS `scaler_67`, (CAST(`ADS_imp_1_OUT`.`impter_68` AS DOUBLE) - 0.054075300089557875) / 0.929588489370402 AS `scaler_68`, (CAST(`ADS_imp_1_OUT`.`impter_69` AS DOUBLE) - -0.23085273383923544) / 0.944088767881375 AS `scaler_69`, (CAST(`ADS_imp_1_OUT`.`impter_70` AS DOUBLE) - -0.24396528808375115) / 1.04592379692413 AS `scaler_70`, (CAST(`ADS_imp_1_OUT`.`impter_71` AS DOUBLE) - 0.06545065787659607) / 0.8967701639849762 AS `scaler_71`, (CAST(`ADS_imp_1_OUT`.`impter_72` AS DOUBLE) - 0.04266518302023082) / 0.8835391881690846 AS `scaler_72`, (CAST(`ADS_imp_1_OUT`.`impter_73` AS DOUBLE) - -0.1540451820349279) / 0.9869791561020547 AS `scaler_73`, (CAST(`ADS_imp_1_OUT`.`impter_74` AS DOUBLE) - -0.2222352564572451) / 0.9537927411956955 AS `scaler_74`, (CAST(`ADS_imp_1_OUT`.`impter_75` AS DOUBLE) - 0.0685606372972674) / 0.953717717145669 AS `scaler_75`, (CAST(`ADS_imp_1_OUT`.`impter_76` AS DOUBLE) - -0.09639592085393558) / 1.035877532027052 AS `scaler_76`, (CAST(`ADS_imp_1_OUT`.`impter_77` AS DOUBLE) - 0.20747518927524572) / 1.0611076222257592 AS `scaler_77`, (CAST(`ADS_imp_1_OUT`.`impter_78` AS DOUBLE) - -0.13945256367132464) / 1.022370053319208 AS `scaler_78`, (CAST(`ADS_imp_1_OUT`.`impter_79` AS DOUBLE) - 0.021954208773706758) / 0.48752447532965937 AS `scaler_79`, (CAST(`ADS_imp_1_OUT`.`impter_80` AS DOUBLE) - 0.07033517037026028) / 0.9984278761892057 AS `scaler_80`, (CAST(`ADS_imp_1_OUT`.`impter_81` AS DOUBLE) - 0.12062472190694748) / 1.0482914370539298 AS `scaler_81`, (CAST(`ADS_imp_1_OUT`.`impter_82` AS DOUBLE) - -0.03376594744247921) / 1.0120395039819923 AS `scaler_82`, (CAST(`ADS_imp_1_OUT`.`impter_83` AS DOUBLE) - -0.11063521313283846) / 0.8487965281981553 AS `scaler_83`, (CAST(`ADS_imp_1_OUT`.`impter_84` AS DOUBLE) - 0.040264280436689885) / 0.9278865519978795 AS `scaler_84`, (CAST(`ADS_imp_1_OUT`.`impter_85` AS DOUBLE) - 0.047619698634703535) / 1.0173681676828843 AS `scaler_85`, (CAST(`ADS_imp_1_OUT`.`impter_86` AS DOUBLE) - 0.10294542896565007) / 0.9363751138268347 AS `scaler_86`, (CAST(`ADS_imp_1_OUT`.`impter_87` AS DOUBLE) - 0.03543139086541035) / 0.9766573952044824 AS `scaler_87`, (CAST(`ADS_imp_1_OUT`.`impter_88` AS DOUBLE) - 0.15812674995414752) / 1.0065679998415296 AS `scaler_88`, (CAST(`ADS_imp_1_OUT`.`impter_89` AS DOUBLE) - -0.09370679202503561) / 0.9521441609239362 AS `scaler_89`, (CAST(`ADS_imp_1_OUT`.`impter_90` AS DOUBLE) - -0.05352174133125283) / 1.0336679876781851 AS `scaler_90`, (CAST(`ADS_imp_1_OUT`.`impter_91` AS DOUBLE) - -0.05671142135749989) / 1.0851107811586167 AS `scaler_91`, (CAST(`ADS_imp_1_OUT`.`impter_92` AS DOUBLE) - 0.1683501919918398) / 0.8286544432716997 AS `scaler_92`, (CAST(`ADS_imp_1_OUT`.`impter_93` AS DOUBLE) - -0.08014687785959375) / 1.070420432549587 AS `scaler_93`, (CAST(`ADS_imp_1_OUT`.`impter_94` AS DOUBLE) - 0.06732751721128641) / 1.1749792199760318 AS `scaler_94`, (CAST(`ADS_imp_1_OUT`.`impter_95` AS DOUBLE) - -0.00888651681786575) / 1.0750073377154254 AS `scaler_95`, (CAST(`ADS_imp_1_OUT`.`impter_96` AS DOUBLE) - 0.026095385517810564) / 1.1078183878209036 AS `scaler_96`, (CAST(`ADS_imp_1_OUT`.`impter_97` AS DOUBLE) - 0.04435425200996614) / 0.8861375411199117 AS `scaler_97`, (CAST(`ADS_imp_1_OUT`.`impter_98` AS DOUBLE) - 0.026895408070568623) / 1.0095288823928932 AS `scaler_98`, (CAST(`ADS_imp_1_OUT`.`impter_99` AS DOUBLE) - 0.18232971539070067) / 0.9551382056239349 AS `scaler_99`, (CAST(`ADS_imp_1_OUT`.`impter_100` AS DOUBLE) - -0.12132540363011564) / 0.9258857556869412 AS `scaler_100`, (CAST(`ADS_imp_1_OUT`.`impter_101` AS DOUBLE) - 0.004420132524286926) / 0.9371965982210728 AS `scaler_101` 
FROM `tmp_20180516111032_codegen_pa6yg5_ads_imp_1_out` AS `ADS_imp_1_OUT`) AS `ADS_sca_2_OUT`

-- Code For temporary table tmp_20180516111032_codegen_rpdivm_ads_sca_2_out part 2. Populate

SELECT * FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out`

-- Code For temporary table tmp_20180516111032_codegen_hnpyys_lgbm_b0 part 1. Create 

CREATE TEMPORARY TABLE `tmp_20180516111032_codegen_hnpyys_lgbm_b0` STORED AS ORC AS WITH `DT_node_lookup` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= 1.0000000180025095e-35) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_6` <= 0.7430911729095393) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.08181818181818183 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.03599999999999998 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.09999999999999999 AS `Score`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.`node_id_2` AS `node_id_2`, `DT_node_data`.`nid` AS `nid`, `DT_node_data`.`Score` AS `Score` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.`node_id_2` = `DT_node_data`.`nid`), 
`LGBM_Model_0_0` AS 
(SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`Score` AS `Score_0` 
FROM `DT_Output`), 
`DT_node_lookup_1` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= 1.0000000180025095e-35) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_69` <= -1.0000000180025095e-35) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_1` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.07785970941192365 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.09673857117668469 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.03283595664042763 AS `Score`) AS `Values`), 
`DT_Output_1` AS 
(SELECT `DT_node_lookup_1`.`KEY` AS `KEY`, `DT_node_lookup_1`.`node_id_2` AS `node_id_2`, `DT_node_data_1`.`nid` AS `nid`, `DT_node_data_1`.`Score` AS `Score` 
FROM `DT_node_lookup_1` LEFT OUTER JOIN `DT_node_data_1` ON `DT_node_lookup_1`.`node_id_2` = `DT_node_data_1`.`nid`), 
`LGBM_Model_0_1` AS 
(SELECT `DT_Output_1`.`KEY` AS `KEY`, `DT_Output_1`.`Score` AS `Score_0` 
FROM `DT_Output_1`), 
`DT_node_lookup_2` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= 1.0000000180025095e-35) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_79` <= 0.73434668090569) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_2` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.07432295598691702 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.030996531781855366 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.09267555851824433 AS `Score`) AS `Values`), 
`DT_Output_2` AS 
(SELECT `DT_node_lookup_2`.`KEY` AS `KEY`, `DT_node_lookup_2`.`node_id_2` AS `node_id_2`, `DT_node_data_2`.`nid` AS `nid`, `DT_node_data_2`.`Score` AS `Score` 
FROM `DT_node_lookup_2` LEFT OUTER JOIN `DT_node_data_2` ON `DT_node_lookup_2`.`node_id_2` = `DT_node_data_2`.`nid`), 
`LGBM_Model_0_2` AS 
(SELECT `DT_Output_2`.`KEY` AS `KEY`, `DT_Output_2`.`Score` AS `Score_0` 
FROM `DT_Output_2`), 
`DT_node_lookup_3` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= -0.12473853899602892) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_35` <= -0.12595241060847376) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_3` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.06741724615167421 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.027380638961790382 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.09119865708847386 AS `Score`) AS `Values`), 
`DT_Output_3` AS 
(SELECT `DT_node_lookup_3`.`KEY` AS `KEY`, `DT_node_lookup_3`.`node_id_2` AS `node_id_2`, `DT_node_data_3`.`nid` AS `nid`, `DT_node_data_3`.`Score` AS `Score` 
FROM `DT_node_lookup_3` LEFT OUTER JOIN `DT_node_data_3` ON `DT_node_lookup_3`.`node_id_2` = `DT_node_data_3`.`nid`), 
`LGBM_Model_0_3` AS 
(SELECT `DT_Output_3`.`KEY` AS `KEY`, `DT_Output_3`.`Score` AS `Score_0` 
FROM `DT_Output_3`), 
`DT_node_lookup_4` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= 1.0000000180025095e-35) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_69` <= -1.0000000180025095e-35) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_4` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.06839050087526723 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.08785355253204136 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.025913580168755546 AS `Score`) AS `Values`), 
`DT_Output_4` AS 
(SELECT `DT_node_lookup_4`.`KEY` AS `KEY`, `DT_node_lookup_4`.`node_id_2` AS `node_id_2`, `DT_node_data_4`.`nid` AS `nid`, `DT_node_data_4`.`Score` AS `Score` 
FROM `DT_node_lookup_4` LEFT OUTER JOIN `DT_node_data_4` ON `DT_node_lookup_4`.`node_id_2` = `DT_node_data_4`.`nid`), 
`LGBM_Model_0_4` AS 
(SELECT `DT_Output_4`.`KEY` AS `KEY`, `DT_Output_4`.`Score` AS `Score_0` 
FROM `DT_Output_4`), 
`DT_node_lookup_5` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= -0.12473853899602892) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_35` <= -0.12595241060847376) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_5` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.062228331449722674 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.023575173547320145 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.08564442830549451 AS `Score`) AS `Values`), 
`DT_Output_5` AS 
(SELECT `DT_node_lookup_5`.`KEY` AS `KEY`, `DT_node_lookup_5`.`node_id_2` AS `node_id_2`, `DT_node_data_5`.`nid` AS `nid`, `DT_node_data_5`.`Score` AS `Score` 
FROM `DT_node_lookup_5` LEFT OUTER JOIN `DT_node_data_5` ON `DT_node_lookup_5`.`node_id_2` = `DT_node_data_5`.`nid`), 
`LGBM_Model_0_5` AS 
(SELECT `DT_Output_5`.`KEY` AS `KEY`, `DT_Output_5`.`Score` AS `Score_0` 
FROM `DT_Output_5`), 
`DT_node_lookup_6` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= 0.43659448686368074) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_79` <= 0.73434668090569) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_6` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.08245927048178334 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.013365798467164647 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.08291398123871146 AS `Score`) AS `Values`), 
`DT_Output_6` AS 
(SELECT `DT_node_lookup_6`.`KEY` AS `KEY`, `DT_node_lookup_6`.`node_id_2` AS `node_id_2`, `DT_node_data_6`.`nid` AS `nid`, `DT_node_data_6`.`Score` AS `Score` 
FROM `DT_node_lookup_6` LEFT OUTER JOIN `DT_node_data_6` ON `DT_node_lookup_6`.`node_id_2` = `DT_node_data_6`.`nid`), 
`LGBM_Model_0_6` AS 
(SELECT `DT_Output_6`.`KEY` AS `KEY`, `DT_Output_6`.`Score` AS `Score_0` 
FROM `DT_Output_6`), 
`DT_node_lookup_7` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= 1.0000000180025095e-35) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_69` <= 1.0000000180025095e-35) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_7` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.06142804449865933 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.08162877916120868 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.02040059253644598 AS `Score`) AS `Values`), 
`DT_Output_7` AS 
(SELECT `DT_node_lookup_7`.`KEY` AS `KEY`, `DT_node_lookup_7`.`node_id_2` AS `node_id_2`, `DT_node_data_7`.`nid` AS `nid`, `DT_node_data_7`.`Score` AS `Score` 
FROM `DT_node_lookup_7` LEFT OUTER JOIN `DT_node_data_7` ON `DT_node_lookup_7`.`node_id_2` = `DT_node_data_7`.`nid`), 
`LGBM_Model_0_7` AS 
(SELECT `DT_Output_7`.`KEY` AS `KEY`, `DT_Output_7`.`Score` AS `Score_0` 
FROM `DT_Output_7`), 
`DT_node_lookup_8` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= 0.43659448686368074) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_69` <= -1.0000000180025095e-35) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_8` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.07810925053835979 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.07294274026665538 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.005863559300908972 AS `Score`) AS `Values`), 
`DT_Output_8` AS 
(SELECT `DT_node_lookup_8`.`KEY` AS `KEY`, `DT_node_lookup_8`.`node_id_2` AS `node_id_2`, `DT_node_data_8`.`nid` AS `nid`, `DT_node_data_8`.`Score` AS `Score` 
FROM `DT_node_lookup_8` LEFT OUTER JOIN `DT_node_data_8` ON `DT_node_lookup_8`.`node_id_2` = `DT_node_data_8`.`nid`), 
`LGBM_Model_0_8` AS 
(SELECT `DT_Output_8`.`KEY` AS `KEY`, `DT_Output_8`.`Score` AS `Score_0` 
FROM `DT_Output_8`), 
`DT_node_lookup_9` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= -0.12473853899602892) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_35` <= -0.12595241060847376) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_9` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.054859981056349455 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.01648023217582348 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.07894508830748041 AS `Score`) AS `Values`), 
`DT_Output_9` AS 
(SELECT `DT_node_lookup_9`.`KEY` AS `KEY`, `DT_node_lookup_9`.`node_id_2` AS `node_id_2`, `DT_node_data_9`.`nid` AS `nid`, `DT_node_data_9`.`Score` AS `Score` 
FROM `DT_node_lookup_9` LEFT OUTER JOIN `DT_node_data_9` ON `DT_node_lookup_9`.`node_id_2` = `DT_node_data_9`.`nid`), 
`LGBM_Model_0_9` AS 
(SELECT `DT_Output_9`.`KEY` AS `KEY`, `DT_Output_9`.`Score` AS `Score_0` 
FROM `DT_Output_9`)
 SELECT `LGBM_B0`.`KEY`, `LGBM_B0`.`Score_0` 
FROM (SELECT `LGBM_esu_0`.`KEY` AS `KEY`, `LGBM_esu_0`.`Score_0` AS `Score_0` 
FROM (SELECT `LGBM_Model_0_0`.`KEY` AS `KEY`, `LGBM_Model_0_0`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_0` UNION ALL SELECT `LGBM_Model_0_1`.`KEY` AS `KEY`, `LGBM_Model_0_1`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_1` UNION ALL SELECT `LGBM_Model_0_2`.`KEY` AS `KEY`, `LGBM_Model_0_2`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_2` UNION ALL SELECT `LGBM_Model_0_3`.`KEY` AS `KEY`, `LGBM_Model_0_3`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_3` UNION ALL SELECT `LGBM_Model_0_4`.`KEY` AS `KEY`, `LGBM_Model_0_4`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_4` UNION ALL SELECT `LGBM_Model_0_5`.`KEY` AS `KEY`, `LGBM_Model_0_5`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_5` UNION ALL SELECT `LGBM_Model_0_6`.`KEY` AS `KEY`, `LGBM_Model_0_6`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_6` UNION ALL SELECT `LGBM_Model_0_7`.`KEY` AS `KEY`, `LGBM_Model_0_7`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_7` UNION ALL SELECT `LGBM_Model_0_8`.`KEY` AS `KEY`, `LGBM_Model_0_8`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_8` UNION ALL SELECT `LGBM_Model_0_9`.`KEY` AS `KEY`, `LGBM_Model_0_9`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_9`) AS `LGBM_esu_0`) AS `LGBM_B0`

-- Code For temporary table tmp_20180516111032_codegen_hnpyys_lgbm_b0 part 2. Populate

SELECT * FROM `tmp_20180516111032_codegen_hnpyys_lgbm_b0`

-- Code For temporary table tmp_20180516111032_codegen_pgwhey_lgbm_b1 part 1. Create 

CREATE TEMPORARY TABLE `tmp_20180516111032_codegen_pgwhey_lgbm_b1` STORED AS ORC AS WITH `DT_node_lookup_10` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= 0.43659448686368074) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_69` <= -1.0000000180025095e-35) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_10` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.07460942774447822 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.07006385064146675 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.004144784333954733 AS `Score`) AS `Values`), 
`DT_Output_10` AS 
(SELECT `DT_node_lookup_10`.`KEY` AS `KEY`, `DT_node_lookup_10`.`node_id_2` AS `node_id_2`, `DT_node_data_10`.`nid` AS `nid`, `DT_node_data_10`.`Score` AS `Score` 
FROM `DT_node_lookup_10` LEFT OUTER JOIN `DT_node_data_10` ON `DT_node_lookup_10`.`node_id_2` = `DT_node_data_10`.`nid`), 
`LGBM_Model_0_10` AS 
(SELECT `DT_Output_10`.`KEY` AS `KEY`, `DT_Output_10`.`Score` AS `Score_0` 
FROM `DT_Output_10`), 
`DT_node_lookup_11` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= 0.43659448686368074) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_79` <= 0.73434668090569) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_11` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.07284015624878848 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.007785792508336553 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.07585509271957948 AS `Score`) AS `Values`), 
`DT_Output_11` AS 
(SELECT `DT_node_lookup_11`.`KEY` AS `KEY`, `DT_node_lookup_11`.`node_id_2` AS `node_id_2`, `DT_node_data_11`.`nid` AS `nid`, `DT_node_data_11`.`Score` AS `Score` 
FROM `DT_node_lookup_11` LEFT OUTER JOIN `DT_node_data_11` ON `DT_node_lookup_11`.`node_id_2` = `DT_node_data_11`.`nid`), 
`LGBM_Model_0_11` AS 
(SELECT `DT_Output_11`.`KEY` AS `KEY`, `DT_Output_11`.`Score` AS `Score_0` 
FROM `DT_Output_11`), 
`DT_node_lookup_12` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= -0.12473853899602892) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_35` <= -0.12595241060847376) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_12` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.05060905874934717 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.0123554001606472 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.0751030280309172 AS `Score`) AS `Values`), 
`DT_Output_12` AS 
(SELECT `DT_node_lookup_12`.`KEY` AS `KEY`, `DT_node_lookup_12`.`node_id_2` AS `node_id_2`, `DT_node_data_12`.`nid` AS `nid`, `DT_node_data_12`.`Score` AS `Score` 
FROM `DT_node_lookup_12` LEFT OUTER JOIN `DT_node_data_12` ON `DT_node_lookup_12`.`node_id_2` = `DT_node_data_12`.`nid`), 
`LGBM_Model_0_12` AS 
(SELECT `DT_Output_12`.`KEY` AS `KEY`, `DT_Output_12`.`Score` AS `Score_0` 
FROM `DT_Output_12`), 
`DT_node_lookup_13` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= 0.43659448686368074) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_69` <= -1.0000000180025095e-35) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_13` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.07018764956421157 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.06675491108606207 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.001022453214534634 AS `Score`) AS `Values`), 
`DT_Output_13` AS 
(SELECT `DT_node_lookup_13`.`KEY` AS `KEY`, `DT_node_lookup_13`.`node_id_2` AS `node_id_2`, `DT_node_data_13`.`nid` AS `nid`, `DT_node_data_13`.`Score` AS `Score` 
FROM `DT_node_lookup_13` LEFT OUTER JOIN `DT_node_data_13` ON `DT_node_lookup_13`.`node_id_2` = `DT_node_data_13`.`nid`), 
`LGBM_Model_0_13` AS 
(SELECT `DT_Output_13`.`KEY` AS `KEY`, `DT_Output_13`.`Score` AS `Score_0` 
FROM `DT_Output_13`), 
`DT_node_lookup_14` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= 0.43659448686368074) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_79` <= 0.73434668090569) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_14` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.06881930045814363 AS `Score` UNION ALL SELECT 4 AS `nid`, -0.0053395535624281565 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.07247379904915023 AS `Score`) AS `Values`), 
`DT_Output_14` AS 
(SELECT `DT_node_lookup_14`.`KEY` AS `KEY`, `DT_node_lookup_14`.`node_id_2` AS `node_id_2`, `DT_node_data_14`.`nid` AS `nid`, `DT_node_data_14`.`Score` AS `Score` 
FROM `DT_node_lookup_14` LEFT OUTER JOIN `DT_node_data_14` ON `DT_node_lookup_14`.`node_id_2` = `DT_node_data_14`.`nid`), 
`LGBM_Model_0_14` AS 
(SELECT `DT_Output_14`.`KEY` AS `KEY`, `DT_Output_14`.`Score` AS `Score_0` 
FROM `DT_Output_14`), 
`DT_node_lookup_15` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_59` <= 0.43659448686368074) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_46` <= -0.17209687191999412) THEN 4 ELSE 5 END ELSE 3 END AS `node_id_2` 
FROM `tmp_20180516111032_codegen_rpdivm_ads_sca_2_out` AS `ADS_sca_2_OUT`), 
`DT_node_data_15` AS 
(SELECT `Values`.`nid` AS `nid`, CAST(`Values`.`Score` AS DOUBLE) AS `Score` 
FROM (SELECT 3 AS `nid`, 0.06756773879157398 AS `Score` UNION ALL SELECT 4 AS `nid`, 0.00971361452718884 AS `Score` UNION ALL SELECT 5 AS `nid`, -0.05611229182065938 AS `Score`) AS `Values`), 
`DT_Output_15` AS 
(SELECT `DT_node_lookup_15`.`KEY` AS `KEY`, `DT_node_lookup_15`.`node_id_2` AS `node_id_2`, `DT_node_data_15`.`nid` AS `nid`, `DT_node_data_15`.`Score` AS `Score` 
FROM `DT_node_lookup_15` LEFT OUTER JOIN `DT_node_data_15` ON `DT_node_lookup_15`.`node_id_2` = `DT_node_data_15`.`nid`), 
`LGBM_Model_0_15` AS 
(SELECT `DT_Output_15`.`KEY` AS `KEY`, `DT_Output_15`.`Score` AS `Score_0` 
FROM `DT_Output_15`)
 SELECT `LGBM_B1`.`KEY`, `LGBM_B1`.`Score_0` 
FROM (SELECT `LGBM_esu_1`.`KEY` AS `KEY`, `LGBM_esu_1`.`Score_0` AS `Score_0` 
FROM (SELECT `LGBM_Model_0_10`.`KEY` AS `KEY`, `LGBM_Model_0_10`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_10` UNION ALL SELECT `LGBM_Model_0_11`.`KEY` AS `KEY`, `LGBM_Model_0_11`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_11` UNION ALL SELECT `LGBM_Model_0_12`.`KEY` AS `KEY`, `LGBM_Model_0_12`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_12` UNION ALL SELECT `LGBM_Model_0_13`.`KEY` AS `KEY`, `LGBM_Model_0_13`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_13` UNION ALL SELECT `LGBM_Model_0_14`.`KEY` AS `KEY`, `LGBM_Model_0_14`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_14` UNION ALL SELECT `LGBM_Model_0_15`.`KEY` AS `KEY`, `LGBM_Model_0_15`.`Score_0` AS `Score_0` 
FROM `LGBM_Model_0_15`) AS `LGBM_esu_1`) AS `LGBM_B1`

-- Code For temporary table tmp_20180516111032_codegen_pgwhey_lgbm_b1 part 2. Populate

SELECT * FROM `tmp_20180516111032_codegen_pgwhey_lgbm_b1`

-- Code For temporary table tmp_20180516111032_codegen_244228_lgbm_sum part 1. Create 

CREATE TEMPORARY TABLE `tmp_20180516111032_codegen_244228_lgbm_sum` STORED AS ORC AS WITH `LGBM_Union` AS 
(SELECT `LGBM_EnsembleUnion`.`KEY` AS `KEY`, `LGBM_EnsembleUnion`.`Score_0` AS `Score_0` 
FROM (SELECT `LGBM_B0`.`KEY` AS `KEY`, `LGBM_B0`.`Score_0` AS `Score_0` 
FROM `tmp_20180516111032_codegen_hnpyys_lgbm_b0` AS `LGBM_B0` UNION ALL SELECT `LGBM_B1`.`KEY` AS `KEY`, `LGBM_B1`.`Score_0` AS `Score_0` 
FROM `tmp_20180516111032_codegen_pgwhey_lgbm_b1` AS `LGBM_B1`) AS `LGBM_EnsembleUnion`)
 SELECT `LGBM_sum`.`KEY`, `LGBM_sum`.`Score_0` 
FROM (SELECT `T`.`KEY` AS `KEY`, CAST(`T`.`Score_0` AS DOUBLE) AS `Score_0` 
FROM (SELECT `LGBM_Union`.`KEY` AS `KEY`, sum(`LGBM_Union`.`Score_0`) AS `Score_0` 
FROM `LGBM_Union` GROUP BY `LGBM_Union`.`KEY`) AS `T`) AS `LGBM_sum`

-- Code For temporary table tmp_20180516111032_codegen_244228_lgbm_sum part 2. Populate

SELECT * FROM `tmp_20180516111032_codegen_244228_lgbm_sum`

-- Model deployment code

WITH `orig_cte` AS 
(SELECT `LGBM_sum`.`KEY` AS `KEY`, `LGBM_sum`.`Score_0` AS `Score_0`, CAST(NULL AS DOUBLE) AS `Score_1`, 1.0 - 1.0 / (1.0 + exp(-`LGBM_sum`.`Score_0`)) AS `Proba_0`, 1.0 / (1.0 + exp(-`LGBM_sum`.`Score_0`)) AS `Proba_1`, CAST(NULL AS DOUBLE) AS `LogProba_0`, CAST(NULL AS DOUBLE) AS `LogProba_1`, CAST(NULL AS BIGINT) AS `Decision`, CAST(NULL AS DOUBLE) AS `DecisionProba` 
FROM `tmp_20180516111032_codegen_244228_lgbm_sum` AS `LGBM_sum`), 
`score_class_union` AS 
(SELECT `scu`.`KEY_u` AS `KEY_u`, `scu`.`class` AS `class`, `scu`.`LogProba` AS `LogProba`, `scu`.`Proba` AS `Proba`, `scu`.`Score` AS `Score` 
FROM (SELECT `orig_cte`.`KEY` AS `KEY_u`, 0 AS `class`, `orig_cte`.`LogProba_0` AS `LogProba`, `orig_cte`.`Proba_0` AS `Proba`, `orig_cte`.`Score_0` AS `Score` 
FROM `orig_cte` UNION ALL SELECT `orig_cte`.`KEY` AS `KEY_u`, 1 AS `class`, `orig_cte`.`LogProba_1` AS `LogProba`, `orig_cte`.`Proba_1` AS `Proba`, `orig_cte`.`Score_1` AS `Score` 
FROM `orig_cte`) AS `scu`), 
`score_max` AS 
(SELECT `orig_cte`.`KEY` AS `KEY`, `orig_cte`.`Score_0` AS `Score_0`, `orig_cte`.`Score_1` AS `Score_1`, `orig_cte`.`Proba_0` AS `Proba_0`, `orig_cte`.`Proba_1` AS `Proba_1`, `orig_cte`.`LogProba_0` AS `LogProba_0`, `orig_cte`.`LogProba_1` AS `LogProba_1`, `orig_cte`.`Decision` AS `Decision`, `orig_cte`.`DecisionProba` AS `DecisionProba`, `max_select`.`KEY_m` AS `KEY_m`, `max_select`.`max_Proba` AS `max_Proba` 
FROM `orig_cte` LEFT OUTER JOIN (SELECT `score_class_union`.`KEY_u` AS `KEY_m`, max(`score_class_union`.`Proba`) AS `max_Proba` 
FROM `score_class_union` GROUP BY `score_class_union`.`KEY_u`) AS `max_select` ON `orig_cte`.`KEY` = `max_select`.`KEY_m`), 
`union_with_max` AS 
(SELECT `score_class_union`.`KEY_u` AS `KEY_u`, `score_class_union`.`class` AS `class`, `score_class_union`.`LogProba` AS `LogProba`, `score_class_union`.`Proba` AS `Proba`, `score_class_union`.`Score` AS `Score`, `score_max`.`KEY` AS `KEY`, `score_max`.`Score_0` AS `Score_0`, `score_max`.`Score_1` AS `Score_1`, `score_max`.`Proba_0` AS `Proba_0`, `score_max`.`Proba_1` AS `Proba_1`, `score_max`.`LogProba_0` AS `LogProba_0`, `score_max`.`LogProba_1` AS `LogProba_1`, `score_max`.`Decision` AS `Decision`, `score_max`.`DecisionProba` AS `DecisionProba`, `score_max`.`KEY_m` AS `KEY_m`, `score_max`.`max_Proba` AS `max_Proba` 
FROM `score_class_union` LEFT OUTER JOIN `score_max` ON `score_class_union`.`KEY_u` = `score_max`.`KEY`), 
`arg_max_cte` AS 
(SELECT `score_max`.`KEY` AS `KEY`, `score_max`.`Score_0` AS `Score_0`, `score_max`.`Score_1` AS `Score_1`, `score_max`.`Proba_0` AS `Proba_0`, `score_max`.`Proba_1` AS `Proba_1`, `score_max`.`LogProba_0` AS `LogProba_0`, `score_max`.`LogProba_1` AS `LogProba_1`, `score_max`.`Decision` AS `Decision`, `score_max`.`DecisionProba` AS `DecisionProba`, `score_max`.`KEY_m` AS `KEY_m`, `score_max`.`max_Proba` AS `max_Proba`, `arg_max_t_Proba`.`KEY_Proba` AS `KEY_Proba`, `arg_max_t_Proba`.`arg_max_Proba` AS `arg_max_Proba` 
FROM `score_max` LEFT OUTER JOIN (SELECT `union_with_max`.`KEY` AS `KEY_Proba`, min(`union_with_max`.`class`) AS `arg_max_Proba` 
FROM `union_with_max` 
WHERE `union_with_max`.`max_Proba` <= `union_with_max`.`Proba` GROUP BY `union_with_max`.`KEY`) AS `arg_max_t_Proba` ON `score_max`.`KEY` = `arg_max_t_Proba`.`KEY_Proba`)
 SELECT `arg_max_cte`.`KEY` AS `KEY`, CAST(NULL AS DOUBLE) AS `Score_0`, CAST(NULL AS DOUBLE) AS `Score_1`, `arg_max_cte`.`Proba_0` AS `Proba_0`, `arg_max_cte`.`Proba_1` AS `Proba_1`, CASE WHEN (`arg_max_cte`.`Proba_0` IS NULL OR `arg_max_cte`.`Proba_0` > 0.0) THEN log(`arg_max_cte`.`Proba_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (`arg_max_cte`.`Proba_1` IS NULL OR `arg_max_cte`.`Proba_1` > 0.0) THEN log(`arg_max_cte`.`Proba_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, `arg_max_cte`.`arg_max_Proba` AS `Decision`, `arg_max_cte`.`max_Proba` AS `DecisionProba` 
FROM `arg_max_cte`