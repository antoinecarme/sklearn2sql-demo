-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : LGBMClassifier_Pipeline
-- Dataset : BreastCancer
-- Database : firebird


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table TMP_20180516_CODEGEN_F8WTN5_ADS part 1. Create 


CREATE GLOBAL TEMPORARY TABLE "TMP_20180516_CODEGEN_F8WTN5_ADS" (
	"KEY" BIGINT NOT NULL, 
	impter_2 DOUBLE PRECISION, 
	impter_3 DOUBLE PRECISION, 
	impter_4 DOUBLE PRECISION, 
	impter_5 DOUBLE PRECISION, 
	impter_6 DOUBLE PRECISION, 
	impter_7 DOUBLE PRECISION, 
	impter_8 DOUBLE PRECISION, 
	impter_9 DOUBLE PRECISION, 
	impter_10 DOUBLE PRECISION, 
	impter_11 DOUBLE PRECISION, 
	impter_12 DOUBLE PRECISION, 
	impter_13 DOUBLE PRECISION, 
	impter_14 DOUBLE PRECISION, 
	impter_15 DOUBLE PRECISION, 
	impter_16 DOUBLE PRECISION, 
	impter_17 DOUBLE PRECISION, 
	impter_18 DOUBLE PRECISION, 
	impter_19 DOUBLE PRECISION, 
	impter_20 DOUBLE PRECISION, 
	impter_21 DOUBLE PRECISION, 
	impter_22 DOUBLE PRECISION, 
	impter_23 DOUBLE PRECISION, 
	impter_24 DOUBLE PRECISION, 
	impter_25 DOUBLE PRECISION, 
	impter_26 DOUBLE PRECISION, 
	impter_27 DOUBLE PRECISION, 
	impter_28 DOUBLE PRECISION, 
	impter_29 DOUBLE PRECISION, 
	impter_30 DOUBLE PRECISION, 
	impter_31 DOUBLE PRECISION, 
	PRIMARY KEY ("KEY")
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20180516_CODEGEN_F8WTN5_ADS part 2. Populate

INSERT INTO "TMP_20180516_CODEGEN_F8WTN5_ADS" ("KEY", impter_2, impter_3, impter_4, impter_5, impter_6, impter_7, impter_8, impter_9, impter_10, impter_11, impter_12, impter_13, impter_14, impter_15, impter_16, impter_17, impter_18, impter_19, impter_20, impter_21, impter_22, impter_23, impter_24, impter_25, impter_26, impter_27, impter_28, impter_29, impter_30, impter_31) SELECT "U"."KEY", "U".impter_2, "U".impter_3, "U".impter_4, "U".impter_5, "U".impter_6, "U".impter_7, "U".impter_8, "U".impter_9, "U".impter_10, "U".impter_11, "U".impter_12, "U".impter_13, "U".impter_14, "U".impter_15, "U".impter_16, "U".impter_17, "U".impter_18, "U".impter_19, "U".impter_20, "U".impter_21, "U".impter_22, "U".impter_23, "U".impter_24, "U".impter_25, "U".impter_26, "U".impter_27, "U".impter_28, "U".impter_29, "U".impter_30, "U".impter_31 
FROM (SELECT "ADS_imp_1_OUT"."KEY", "ADS_imp_1_OUT".impter_2, "ADS_imp_1_OUT".impter_3, "ADS_imp_1_OUT".impter_4, "ADS_imp_1_OUT".impter_5, "ADS_imp_1_OUT".impter_6, "ADS_imp_1_OUT".impter_7, "ADS_imp_1_OUT".impter_8, "ADS_imp_1_OUT".impter_9, "ADS_imp_1_OUT".impter_10, "ADS_imp_1_OUT".impter_11, "ADS_imp_1_OUT".impter_12, "ADS_imp_1_OUT".impter_13, "ADS_imp_1_OUT".impter_14, "ADS_imp_1_OUT".impter_15, "ADS_imp_1_OUT".impter_16, "ADS_imp_1_OUT".impter_17, "ADS_imp_1_OUT".impter_18, "ADS_imp_1_OUT".impter_19, "ADS_imp_1_OUT".impter_20, "ADS_imp_1_OUT".impter_21, "ADS_imp_1_OUT".impter_22, "ADS_imp_1_OUT".impter_23, "ADS_imp_1_OUT".impter_24, "ADS_imp_1_OUT".impter_25, "ADS_imp_1_OUT".impter_26, "ADS_imp_1_OUT".impter_27, "ADS_imp_1_OUT".impter_28, "ADS_imp_1_OUT".impter_29, "ADS_imp_1_OUT".impter_30, "ADS_imp_1_OUT".impter_31 
FROM (SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 14.077712087912083 ELSE "ADS"."Feature_0" END AS impter_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 19.03905494505495 ELSE "ADS"."Feature_1" END AS impter_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 91.66178021978023 ELSE "ADS"."Feature_2" END AS impter_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 650.9676923076925 ELSE "ADS"."Feature_3" END AS impter_5, CASE WHEN ("ADS"."Feature_4" IS NULL) THEN 0.09642184615384615 ELSE "ADS"."Feature_4" END AS impter_6, CASE WHEN ("ADS"."Feature_5" IS NULL) THEN 0.10441613186813191 ELSE "ADS"."Feature_5" END AS impter_7, CASE WHEN ("ADS"."Feature_6" IS NULL) THEN 0.08826232681318694 ELSE "ADS"."Feature_6" END AS impter_8, CASE WHEN ("ADS"."Feature_7" IS NULL) THEN 0.048516399999999966 ELSE "ADS"."Feature_7" END AS impter_9, CASE WHEN ("ADS"."Feature_8" IS NULL) THEN 0.1815885714285715 ELSE "ADS"."Feature_8" END AS impter_10, CASE WHEN ("ADS"."Feature_9" IS NULL) THEN 0.06294030769230768 ELSE "ADS"."Feature_9" END AS impter_11, CASE WHEN ("ADS"."Feature_10" IS NULL) THEN 0.4099173626373627 ELSE "ADS"."Feature_10" END AS impter_12, CASE WHEN ("ADS"."Feature_11" IS NULL) THEN 1.2170694505494501 ELSE "ADS"."Feature_11" END AS impter_13, CASE WHEN ("ADS"."Feature_12" IS NULL) THEN 2.90524901098901 ELSE "ADS"."Feature_12" END AS impter_14, CASE WHEN ("ADS"."Feature_13" IS NULL) THEN 40.87988571428572 ELSE "ADS"."Feature_13" END AS impter_15, CASE WHEN ("ADS"."Feature_14" IS NULL) THEN 0.007055971428571433 ELSE "ADS"."Feature_14" END AS impter_16, CASE WHEN ("ADS"."Feature_15" IS NULL) THEN 0.025567830769230776 ELSE "ADS"."Feature_15" END AS impter_17, CASE WHEN ("ADS"."Feature_16" IS NULL) THEN 0.03199925626373623 ELSE "ADS"."Feature_16" END AS impter_18, CASE WHEN ("ADS"."Feature_17" IS NULL) THEN 0.011972369230769237 ELSE "ADS"."Feature_17" END AS impter_19, CASE WHEN ("ADS"."Feature_18" IS NULL) THEN 0.020896200000000014 ELSE "ADS"."Feature_18" END AS impter_20, CASE WHEN ("ADS"."Feature_19" IS NULL) THEN 0.0038465518681318647 ELSE "ADS"."Feature_19" END AS impter_21, CASE WHEN ("ADS"."Feature_20" IS NULL) THEN 16.17776483516484 ELSE "ADS"."Feature_20" END AS impter_22, CASE WHEN ("ADS"."Feature_21" IS NULL) THEN 25.26505494505494 ELSE "ADS"."Feature_21" END AS impter_23, CASE WHEN ("ADS"."Feature_22" IS NULL) THEN 106.68156043956041 ELSE "ADS"."Feature_22" END AS impter_24, CASE WHEN ("ADS"."Feature_23" IS NULL) THEN 870.8639560439567 ELSE "ADS"."Feature_23" END AS impter_25, CASE WHEN ("ADS"."Feature_24" IS NULL) THEN 0.1318275604395605 ELSE "ADS"."Feature_24" END AS impter_26, CASE WHEN ("ADS"."Feature_25" IS NULL) THEN 0.24991806593406582 ELSE "ADS"."Feature_25" END AS impter_27, CASE WHEN ("ADS"."Feature_26" IS NULL) THEN 0.2654615934065932 ELSE "ADS"."Feature_26" END AS impter_28, CASE WHEN ("ADS"."Feature_27" IS NULL) THEN 0.11348798021978022 ELSE "ADS"."Feature_27" END AS impter_29, CASE WHEN ("ADS"."Feature_28" IS NULL) THEN 0.2897881318681319 ELSE "ADS"."Feature_28" END AS impter_30, CASE WHEN ("ADS"."Feature_29" IS NULL) THEN 0.08364145054945049 ELSE "ADS"."Feature_29" END AS impter_31 
FROM "BreastCancer" AS "ADS") AS "ADS_imp_1_OUT") AS "U"

-- Code For temporary table TMP_20180516_CODEGEN_F8WTN5_ADS part 3. Create Index 

CREATE INDEX "ix_TMP_20180516_CODEGEN_1ff1" ON "TMP_20180516_CODEGEN_F8WTN5_ADS" ("KEY")

-- Code For temporary table TMP_20180516_CODEGEN_LLWBSE_ADS part 1. Create 


CREATE GLOBAL TEMPORARY TABLE "TMP_20180516_CODEGEN_LLWBSE_ADS" (
	"KEY" BIGINT NOT NULL, 
	scaler_2 DOUBLE PRECISION, 
	scaler_3 DOUBLE PRECISION, 
	scaler_4 DOUBLE PRECISION, 
	scaler_5 DOUBLE PRECISION, 
	scaler_6 DOUBLE PRECISION, 
	scaler_7 DOUBLE PRECISION, 
	scaler_8 DOUBLE PRECISION, 
	scaler_9 DOUBLE PRECISION, 
	scaler_10 DOUBLE PRECISION, 
	scaler_11 DOUBLE PRECISION, 
	scaler_12 DOUBLE PRECISION, 
	scaler_13 DOUBLE PRECISION, 
	scaler_14 DOUBLE PRECISION, 
	scaler_15 DOUBLE PRECISION, 
	scaler_16 DOUBLE PRECISION, 
	scaler_17 DOUBLE PRECISION, 
	scaler_18 DOUBLE PRECISION, 
	scaler_19 DOUBLE PRECISION, 
	scaler_20 DOUBLE PRECISION, 
	scaler_21 DOUBLE PRECISION, 
	scaler_22 DOUBLE PRECISION, 
	scaler_23 DOUBLE PRECISION, 
	scaler_24 DOUBLE PRECISION, 
	scaler_25 DOUBLE PRECISION, 
	scaler_26 DOUBLE PRECISION, 
	scaler_27 DOUBLE PRECISION, 
	scaler_28 DOUBLE PRECISION, 
	scaler_29 DOUBLE PRECISION, 
	scaler_30 DOUBLE PRECISION, 
	scaler_31 DOUBLE PRECISION, 
	PRIMARY KEY ("KEY")
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20180516_CODEGEN_LLWBSE_ADS part 2. Populate

INSERT INTO "TMP_20180516_CODEGEN_LLWBSE_ADS" ("KEY", scaler_2, scaler_3, scaler_4, scaler_5, scaler_6, scaler_7, scaler_8, scaler_9, scaler_10, scaler_11, scaler_12, scaler_13, scaler_14, scaler_15, scaler_16, scaler_17, scaler_18, scaler_19, scaler_20, scaler_21, scaler_22, scaler_23, scaler_24, scaler_25, scaler_26, scaler_27, scaler_28, scaler_29, scaler_30, scaler_31) SELECT "U"."KEY", "U".scaler_2, "U".scaler_3, "U".scaler_4, "U".scaler_5, "U".scaler_6, "U".scaler_7, "U".scaler_8, "U".scaler_9, "U".scaler_10, "U".scaler_11, "U".scaler_12, "U".scaler_13, "U".scaler_14, "U".scaler_15, "U".scaler_16, "U".scaler_17, "U".scaler_18, "U".scaler_19, "U".scaler_20, "U".scaler_21, "U".scaler_22, "U".scaler_23, "U".scaler_24, "U".scaler_25, "U".scaler_26, "U".scaler_27, "U".scaler_28, "U".scaler_29, "U".scaler_30, "U".scaler_31 
FROM (SELECT "ADS_sca_2_OUT"."KEY", "ADS_sca_2_OUT".scaler_2, "ADS_sca_2_OUT".scaler_3, "ADS_sca_2_OUT".scaler_4, "ADS_sca_2_OUT".scaler_5, "ADS_sca_2_OUT".scaler_6, "ADS_sca_2_OUT".scaler_7, "ADS_sca_2_OUT".scaler_8, "ADS_sca_2_OUT".scaler_9, "ADS_sca_2_OUT".scaler_10, "ADS_sca_2_OUT".scaler_11, "ADS_sca_2_OUT".scaler_12, "ADS_sca_2_OUT".scaler_13, "ADS_sca_2_OUT".scaler_14, "ADS_sca_2_OUT".scaler_15, "ADS_sca_2_OUT".scaler_16, "ADS_sca_2_OUT".scaler_17, "ADS_sca_2_OUT".scaler_18, "ADS_sca_2_OUT".scaler_19, "ADS_sca_2_OUT".scaler_20, "ADS_sca_2_OUT".scaler_21, "ADS_sca_2_OUT".scaler_22, "ADS_sca_2_OUT".scaler_23, "ADS_sca_2_OUT".scaler_24, "ADS_sca_2_OUT".scaler_25, "ADS_sca_2_OUT".scaler_26, "ADS_sca_2_OUT".scaler_27, "ADS_sca_2_OUT".scaler_28, "ADS_sca_2_OUT".scaler_29, "ADS_sca_2_OUT".scaler_30, "ADS_sca_2_OUT".scaler_31 
FROM (SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".impter_2 AS DOUBLE PRECISION) - 14.077712087912083) / 3.5451492987000814 AS scaler_2, (CAST("ADS_imp_1_OUT".impter_3 AS DOUBLE PRECISION) - 19.03905494505495) / 4.1622971504218205 AS scaler_3, (CAST("ADS_imp_1_OUT".impter_4 AS DOUBLE PRECISION) - 91.66178021978023) / 24.503971943475648 AS scaler_4, (CAST("ADS_imp_1_OUT".impter_5 AS DOUBLE PRECISION) - 650.9676923076925) / 355.702823163891 AS scaler_5, (CAST("ADS_imp_1_OUT".impter_6 AS DOUBLE PRECISION) - 0.09642184615384615) / 0.014197819663072304 AS scaler_6, (CAST("ADS_imp_1_OUT".impter_7 AS DOUBLE PRECISION) - 0.10441613186813191) / 0.05340369466973436 AS scaler_7, (CAST("ADS_imp_1_OUT".impter_8 AS DOUBLE PRECISION) - 0.08826232681318694) / 0.08191200162631372 AS scaler_8, (CAST("ADS_imp_1_OUT".impter_9 AS DOUBLE PRECISION) - 0.048516399999999966) / 0.039373117396730245 AS scaler_9, (CAST("ADS_imp_1_OUT".impter_10 AS DOUBLE PRECISION) - 0.1815885714285715) / 0.02779005832874822 AS scaler_10, (CAST("ADS_imp_1_OUT".impter_11 AS DOUBLE PRECISION) - 0.06294030769230768) / 0.007019354586172742 AS scaler_11, (CAST("ADS_imp_1_OUT".impter_12 AS DOUBLE PRECISION) - 0.4099173626373627) / 0.29120400836827026 AS scaler_12, (CAST("ADS_imp_1_OUT".impter_13 AS DOUBLE PRECISION) - 1.2170694505494501) / 0.5363896396336265 AS scaler_13, (CAST("ADS_imp_1_OUT".impter_14 AS DOUBLE PRECISION) - 2.90524901098901) / 2.1424944299808626 AS scaler_14, (CAST("ADS_imp_1_OUT".impter_15 AS DOUBLE PRECISION) - 40.87988571428572) / 48.224754479577314 AS scaler_15, (CAST("ADS_imp_1_OUT".impter_16 AS DOUBLE PRECISION) - 0.007055971428571433) / 0.002863651656569403 AS scaler_16, (CAST("ADS_imp_1_OUT".impter_17 AS DOUBLE PRECISION) - 0.025567830769230776) / 0.017947013631032318 AS scaler_17, (CAST("ADS_imp_1_OUT".impter_18 AS DOUBLE PRECISION) - 0.03199925626373623) / 0.03166493672136351 AS scaler_18, (CAST("ADS_imp_1_OUT".impter_19 AS DOUBLE PRECISION) - 0.011972369230769237) / 0.006392005589396607 AS scaler_19, (CAST("ADS_imp_1_OUT".impter_20 AS DOUBLE PRECISION) - 0.020896200000000014) / 0.008582910079869234 AS scaler_20, (CAST("ADS_imp_1_OUT".impter_21 AS DOUBLE PRECISION) - 0.0038465518681318647) / 0.0027436075866190575 AS scaler_21, (CAST("ADS_imp_1_OUT".impter_22 AS DOUBLE PRECISION) - 16.17776483516484) / 4.817458816201383 AS scaler_22, (CAST("ADS_imp_1_OUT".impter_23 AS DOUBLE PRECISION) - 25.26505494505494) / 5.92332412866667 AS scaler_23, (CAST("ADS_imp_1_OUT".impter_24 AS DOUBLE PRECISION) - 106.68156043956041) / 33.70385837605481 AS scaler_24, (CAST("ADS_imp_1_OUT".impter_25 AS DOUBLE PRECISION) - 870.8639560439567) / 566.9950559872813 AS scaler_25, (CAST("ADS_imp_1_OUT".impter_26 AS DOUBLE PRECISION) - 0.1318275604395605) / 0.02274820752228878 AS scaler_26, (CAST("ADS_imp_1_OUT".impter_27 AS DOUBLE PRECISION) - 0.24991806593406582) / 0.15246893644279044 AS scaler_27, (CAST("ADS_imp_1_OUT".impter_28 AS DOUBLE PRECISION) - 0.2654615934065932) / 0.20692568678204093 AS scaler_28, (CAST("ADS_imp_1_OUT".impter_29 AS DOUBLE PRECISION) - 0.11348798021978022) / 0.06638141278520703 AS scaler_29, (CAST("ADS_imp_1_OUT".impter_30 AS DOUBLE PRECISION) - 0.2897881318681319) / 0.06220470665051894 AS scaler_30, (CAST("ADS_imp_1_OUT".impter_31 AS DOUBLE PRECISION) - 0.08364145054945049) / 0.01706514580694785 AS scaler_31 
FROM "TMP_20180516_CODEGEN_F8WTN5_ADS" AS "ADS_imp_1_OUT") AS "ADS_sca_2_OUT") AS "U"

-- Code For temporary table TMP_20180516_CODEGEN_LLWBSE_ADS part 3. Create Index 

CREATE INDEX "ix_TMP_20180516_CODEGEN_3452" ON "TMP_20180516_CODEGEN_LLWBSE_ADS" ("KEY")

-- Code For temporary table TMP_20180516_CODEGEN_BDBX0D_LGB part 1. Create 


CREATE GLOBAL TEMPORARY TABLE "TMP_20180516_CODEGEN_BDBX0D_LGB" (
	"KEY" BIGINT, 
	"Score_0" DOUBLE PRECISION
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20180516_CODEGEN_BDBX0D_LGB part 2. Populate

INSERT INTO "TMP_20180516_CODEGEN_BDBX0D_LGB" ("KEY", "Score_0") SELECT "U"."KEY", "U"."Score_0" 
FROM (WITH "DT_node_lookup" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.4814905022229727) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.39414078064364416) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.12223775481909689) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.12370962647016474) THEN 16 ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.08468143687840854) THEN 6 ELSE 7 END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.04000000000000001 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.04000000000000001 AS "Score" FROM rdb$database UNION ALL SELECT 7 AS nid, -0.1 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.06 AS "Score" FROM rdb$database UNION ALL SELECT 16 AS nid, 0.1 AS "Score" FROM rdb$database UNION ALL SELECT 17 AS nid, 0.08095238095238096 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".nid AS nid, "DT_node_data"."Score" AS "Score" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".nid), 
"LGBM_Model_0_0" AS 
(SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."Score" AS "Score_0" 
FROM "DT_Output"), 
"DT_node_lookup_1" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.4814905022229727) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 0.03868824555770973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.16650962355207619) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.8357798248245799) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.12370962647016474) THEN 34 ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.08468143687840854) THEN 6 ELSE 7 END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_1" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.03872342243693988 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.03801546607982693 AS "Score" FROM rdb$database UNION ALL SELECT 7 AS nid, -0.09524187224606034 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.06415724277379706 AS "Score" FROM rdb$database UNION ALL SELECT 16 AS nid, 0.08526081895893341 AS "Score" FROM rdb$database UNION ALL SELECT 34 AS nid, 0.09524187224606034 AS "Score" FROM rdb$database UNION ALL SELECT 35 AS nid, 0.09667714578913264 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_1" AS 
(SELECT "DT_node_lookup_1"."KEY" AS "KEY", "DT_node_lookup_1".node_id_2 AS node_id_2, "DT_node_data_1".nid AS nid, "DT_node_data_1"."Score" AS "Score" 
FROM "DT_node_lookup_1" LEFT OUTER JOIN "DT_node_data_1" ON "DT_node_lookup_1".node_id_2 = "DT_node_data_1".nid), 
"LGBM_Model_0_1" AS 
(SELECT "DT_Output_1"."KEY" AS "KEY", "DT_Output_1"."Score" AS "Score_0" 
FROM "DT_Output_1"), 
"DT_node_lookup_2" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.4814905022229727) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 0.03868824555770973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.12223775481909689) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.13274830122602513) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.23110300580183282) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.8086257958142556) THEN 64 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.12033459193806632) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.21187504751296346) THEN 260 ELSE 261 END ELSE 131 END END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.08468143687840854) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.9159805803604996) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_2" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.03682030457504874 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.03615616348273377 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.054007699282570654 AS "Score" FROM rdb$database UNION ALL SELECT 14 AS nid, -0.09113178077572358 AS "Score" FROM rdb$database UNION ALL SELECT 15 AS nid, -0.09113178077572359 AS "Score" FROM rdb$database UNION ALL SELECT 17 AS nid, 0.07235729037003415 AS "Score" FROM rdb$database UNION ALL SELECT 33 AS nid, 0.09180259785402088 AS "Score" FROM rdb$database UNION ALL SELECT 64 AS nid, 0.0914854829751507 AS "Score" FROM rdb$database UNION ALL SELECT 131 AS nid, 0.09124156037379381 AS "Score" FROM rdb$database UNION ALL SELECT 260 AS nid, 0.09113178077572362 AS "Score" FROM rdb$database UNION ALL SELECT 261 AS nid, 0.09113178077572359 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_2" AS 
(SELECT "DT_node_lookup_2"."KEY" AS "KEY", "DT_node_lookup_2".node_id_2 AS node_id_2, "DT_node_data_2".nid AS nid, "DT_node_data_2"."Score" AS "Score" 
FROM "DT_node_lookup_2" LEFT OUTER JOIN "DT_node_data_2" ON "DT_node_lookup_2".node_id_2 = "DT_node_data_2".nid), 
"LGBM_Model_0_2" AS 
(SELECT "DT_Output_2"."KEY" AS "KEY", "DT_Output_2"."Score" AS "Score_0" 
FROM "DT_Output_2"), 
"DT_node_lookup_3" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.4814905022229727) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.39414078064364416) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.13274830122602513) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.2368538654219348) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.15085376364884465) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= -0.13443157937956637) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.792770758741113) THEN 136 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= -0.13656186554640773) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= 0.0388468281459605) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.6104670001005438) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.492884518247762) THEN 2192 ELSE 2193 END ELSE 1097 END ELSE 549 END ELSE 275 END END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.08468143687840854) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 1.7184855696547983) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_3" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.03557196879802641 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.034409502171933046 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.05079859401202999 AS "Score" FROM rdb$database UNION ALL SELECT 14 AS nid, -0.08754910073915208 AS "Score" FROM rdb$database UNION ALL SELECT 15 AS nid, -0.08754910073915209 AS "Score" FROM rdb$database UNION ALL SELECT 16 AS nid, 0.06887692755809435 AS "Score" FROM rdb$database UNION ALL SELECT 35 AS nid, 0.09090627295655655 AS "Score" FROM rdb$database UNION ALL SELECT 69 AS nid, 0.08875538456969538 AS "Score" FROM rdb$database UNION ALL SELECT 136 AS nid, 0.0877887073887226 AS "Score" FROM rdb$database UNION ALL SELECT 275 AS nid, 0.08766171146740767 AS "Score" FROM rdb$database UNION ALL SELECT 549 AS nid, 0.08761451313923382 AS "Score" FROM rdb$database UNION ALL SELECT 1097 AS nid, 0.08754617059923987 AS "Score" FROM rdb$database UNION ALL SELECT 2192 AS nid, 0.08754910073915212 AS "Score" FROM rdb$database UNION ALL SELECT 2193 AS nid, 0.08754786335035256 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_3" AS 
(SELECT "DT_node_lookup_3"."KEY" AS "KEY", "DT_node_lookup_3".node_id_2 AS node_id_2, "DT_node_data_3".nid AS nid, "DT_node_data_3"."Score" AS "Score" 
FROM "DT_node_lookup_3" LEFT OUTER JOIN "DT_node_data_3" ON "DT_node_lookup_3".node_id_2 = "DT_node_data_3".nid), 
"LGBM_Model_0_3" AS 
(SELECT "DT_Output_3"."KEY" AS "KEY", "DT_Output_3"."Score" AS "Score_0" 
FROM "DT_Output_3"), 
"DT_node_lookup_4" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.4814905022229727) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 0.03868824555770973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.16650962355207619) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 1.2771661567714638) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.12370962647016474) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.0994044590926684) THEN 64 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.8086257958142556) THEN 130 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.29006241643074554) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.20291721878263796) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.25885228257162696) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.20680027436229373) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.4246045755505435) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.46415310332187976) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= -0.6481284409529936) THEN 16768 ELSE 16769 END ELSE 8385 END ELSE 4193 END ELSE 2097 END ELSE 1049 END ELSE 525 END ELSE 263 END END END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.08468143687840854) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 1.832726174457677) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.4230704803876367) THEN 28 ELSE 29 END ELSE 15 END END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_4" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.0339628630043236 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.03276474964490477 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.05464668129194551 AS "Score" FROM rdb$database UNION ALL SELECT 15 AS nid, -0.0844015024275224 AS "Score" FROM rdb$database UNION ALL SELECT 17 AS nid, 0.07441013570278752 AS "Score" FROM rdb$database UNION ALL SELECT 28 AS nid, -0.08440150242752234 AS "Score" FROM rdb$database UNION ALL SELECT 29 AS nid, -0.0844015024275224 AS "Score" FROM rdb$database UNION ALL SELECT 33 AS nid, 0.08758162396382087 AS "Score" FROM rdb$database UNION ALL SELECT 64 AS nid, 0.08488337578474006 AS "Score" FROM rdb$database UNION ALL SELECT 130 AS nid, 0.08466538181316721 AS "Score" FROM rdb$database UNION ALL SELECT 263 AS nid, 0.08437601828006863 AS "Score" FROM rdb$database UNION ALL SELECT 525 AS nid, 0.08439521116260168 AS "Score" FROM rdb$database UNION ALL SELECT 1049 AS nid, 0.0843980234984501 AS "Score" FROM rdb$database UNION ALL SELECT 2097 AS nid, 0.08440046506340697 AS "Score" FROM rdb$database UNION ALL SELECT 4193 AS nid, 0.08440106267178245 AS "Score" FROM rdb$database UNION ALL SELECT 8385 AS nid, 0.08440152277024804 AS "Score" FROM rdb$database UNION ALL SELECT 16768 AS nid, 0.08440150242752241 AS "Score" FROM rdb$database UNION ALL SELECT 16769 AS nid, 0.08440150242752237 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_4" AS 
(SELECT "DT_node_lookup_4"."KEY" AS "KEY", "DT_node_lookup_4".node_id_2 AS node_id_2, "DT_node_data_4".nid AS nid, "DT_node_data_4"."Score" AS "Score" 
FROM "DT_node_lookup_4" LEFT OUTER JOIN "DT_node_data_4" ON "DT_node_lookup_4".node_id_2 = "DT_node_data_4".nid), 
"LGBM_Model_0_4" AS 
(SELECT "DT_Output_4"."KEY" AS "KEY", "DT_Output_4"."Score" AS "Score_0" 
FROM "DT_Output_4"), 
"DT_node_lookup_5" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.4814905022229727) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.39414078064364416) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.13274830122602513) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 1.641401109186068) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.16650962355207619) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.9432931167471074) THEN 64 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.0318854524747831) THEN 130 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.6609371646569524) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.7741820945863944) THEN 524 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.08302549400914215) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.3181687469771545) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.3494753594275147) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.3634715176072611) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.05403299534225956) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.765178796376186) THEN 33600 ELSE 33601 END ELSE 16801 END ELSE 8401 END ELSE 4201 END ELSE 2101 END ELSE 1051 END END ELSE 263 END END END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.08468143687840854) THEN 6 ELSE 7 END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_5" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.032876653894358364 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.031212692907520073 AS "Score" FROM rdb$database UNION ALL SELECT 7 AS nid, -0.08161712202378635 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.045206619562706093 AS "Score" FROM rdb$database UNION ALL SELECT 17 AS nid, 0.0625244689531874 AS "Score" FROM rdb$database UNION ALL SELECT 33 AS nid, 0.0850521141342685 AS "Score" FROM rdb$database UNION ALL SELECT 64 AS nid, 0.0832784031223782 AS "Score" FROM rdb$database UNION ALL SELECT 130 AS nid, 0.08190545585374014 AS "Score" FROM rdb$database UNION ALL SELECT 263 AS nid, 0.08185682540206007 AS "Score" FROM rdb$database UNION ALL SELECT 524 AS nid, 0.08179173169763698 AS "Score" FROM rdb$database UNION ALL SELECT 1051 AS nid, 0.08165700818932689 AS "Score" FROM rdb$database UNION ALL SELECT 2101 AS nid, 0.08160079310223653 AS "Score" FROM rdb$database UNION ALL SELECT 4201 AS nid, 0.08161343521572201 AS "Score" FROM rdb$database UNION ALL SELECT 8401 AS nid, 0.08161621426304494 AS "Score" FROM rdb$database UNION ALL SELECT 16801 AS nid, 0.0816171569277635 AS "Score" FROM rdb$database UNION ALL SELECT 33600 AS nid, 0.08161712202378638 AS "Score" FROM rdb$database UNION ALL SELECT 33601 AS nid, 0.08161713305824708 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_5" AS 
(SELECT "DT_node_lookup_5"."KEY" AS "KEY", "DT_node_lookup_5".node_id_2 AS node_id_2, "DT_node_data_5".nid AS nid, "DT_node_data_5"."Score" AS "Score" 
FROM "DT_node_lookup_5" LEFT OUTER JOIN "DT_node_data_5" ON "DT_node_lookup_5".node_id_2 = "DT_node_data_5".nid), 
"LGBM_Model_0_5" AS 
(SELECT "DT_Output_5"."KEY" AS "KEY", "DT_Output_5"."Score" AS "Score_0" 
FROM "DT_Output_5"), 
"DT_node_lookup_6" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.4814905022229727) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 0.03868824555770973) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.16650962355207619) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.8357798248245799) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.12370962647016474) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 1.387854079282782) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.0672525511793898) THEN 136 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.6765362858967612) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.7795957242630182) THEN 548 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.41052202058209486) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.9120921789977602) THEN 2196 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.11301135780724918) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.450803450404135) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= 0.12638703010108174) THEN 17576 ELSE 17577 END ELSE 8789 END ELSE 4395 END END ELSE 1099 END END ELSE 275 END END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.18153528572819072) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.0258142468058166) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 1.5492402292060885) THEN 30 ELSE 31 END END END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_6" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.03139507945384355 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.030614014856393115 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.049351077340023954 AS "Score" FROM rdb$database UNION ALL SELECT 14 AS nid, -0.08033099401564248 AS "Score" FROM rdb$database UNION ALL SELECT 16 AS nid, 0.06890795228439286 AS "Score" FROM rdb$database UNION ALL SELECT 30 AS nid, -0.07913912415567703 AS "Score" FROM rdb$database UNION ALL SELECT 31 AS nid, -0.07913912415567705 AS "Score" FROM rdb$database UNION ALL SELECT 35 AS nid, 0.08309092995698653 AS "Score" FROM rdb$database UNION ALL SELECT 69 AS nid, 0.07968362284618594 AS "Score" FROM rdb$database UNION ALL SELECT 136 AS nid, 0.07940581388226561 AS "Score" FROM rdb$database UNION ALL SELECT 275 AS nid, 0.07930333675277955 AS "Score" FROM rdb$database UNION ALL SELECT 548 AS nid, 0.07911128510259312 AS "Score" FROM rdb$database UNION ALL SELECT 1099 AS nid, 0.07912469798670464 AS "Score" FROM rdb$database UNION ALL SELECT 2196 AS nid, 0.07913383982101248 AS "Score" FROM rdb$database UNION ALL SELECT 4395 AS nid, 0.0791350426103549 AS "Score" FROM rdb$database UNION ALL SELECT 8789 AS nid, 0.07913769786279123 AS "Score" FROM rdb$database UNION ALL SELECT 17576 AS nid, 0.07913914746517438 AS "Score" FROM rdb$database UNION ALL SELECT 17577 AS nid, 0.07913864890481614 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_6" AS 
(SELECT "DT_node_lookup_6"."KEY" AS "KEY", "DT_node_lookup_6".node_id_2 AS node_id_2, "DT_node_data_6".nid AS nid, "DT_node_data_6"."Score" AS "Score" 
FROM "DT_node_lookup_6" LEFT OUTER JOIN "DT_node_data_6" ON "DT_node_lookup_6".node_id_2 = "DT_node_data_6".nid), 
"LGBM_Model_0_6" AS 
(SELECT "DT_Output_6"."KEY" AS "KEY", "DT_Output_6"."Score" AS "Score_0" 
FROM "DT_Output_6"), 
"DT_node_lookup_7" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.4814905022229727) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.047172572236715275) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.08671892196771332) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.22446740955145653) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 1.0000000180025095e-35) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.9496264146212148) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.7493972090467694) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.0672525511793898) THEN 258 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.8285591603784741) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.525602617063506) THEN 1036 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.4930575008706997) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= -0.41341951633308177) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.13528804133446998) THEN 8296 ELSE 8297 END ELSE 4149 END ELSE 2075 END END ELSE 519 END END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.08468143687840854) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.3994544150964048) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.12425185204483523) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.15038451901052183) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_7" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.016778388263403898 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.028086185830407354 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.055306028713149075 AS "Score" FROM rdb$database UNION ALL SELECT 14 AS nid, -0.0771139897895199 AS "Score" FROM rdb$database UNION ALL SELECT 17 AS nid, 0.07896869779926916 AS "Score" FROM rdb$database UNION ALL SELECT 30 AS nid, -0.07690433051439245 AS "Score" FROM rdb$database UNION ALL SELECT 33 AS nid, 0.07846163444505044 AS "Score" FROM rdb$database UNION ALL SELECT 62 AS nid, -0.07692196744668278 AS "Score" FROM rdb$database UNION ALL SELECT 63 AS nid, -0.07692196744668282 AS "Score" FROM rdb$database UNION ALL SELECT 65 AS nid, 0.07736585274070729 AS "Score" FROM rdb$database UNION ALL SELECT 128 AS nid, 0.07722560876409244 AS "Score" FROM rdb$database UNION ALL SELECT 258 AS nid, 0.07716093984136602 AS "Score" FROM rdb$database UNION ALL SELECT 519 AS nid, 0.07704253327303179 AS "Score" FROM rdb$database UNION ALL SELECT 1036 AS nid, 0.07691571086825517 AS "Score" FROM rdb$database UNION ALL SELECT 2075 AS nid, 0.07691932391319566 AS "Score" FROM rdb$database UNION ALL SELECT 4149 AS nid, 0.0769208072538407 AS "Score" FROM rdb$database UNION ALL SELECT 8296 AS nid, 0.0769222110722792 AS "Score" FROM rdb$database UNION ALL SELECT 8297 AS nid, 0.07692196838943438 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_7" AS 
(SELECT "DT_node_lookup_7"."KEY" AS "KEY", "DT_node_lookup_7".node_id_2 AS node_id_2, "DT_node_data_7".nid AS nid, "DT_node_data_7"."Score" AS "Score" 
FROM "DT_node_lookup_7" LEFT OUTER JOIN "DT_node_data_7" ON "DT_node_lookup_7".node_id_2 = "DT_node_data_7".nid), 
"LGBM_Model_0_7" AS 
(SELECT "DT_Output_7"."KEY" AS "KEY", "DT_Output_7"."Score" AS "Score_0" 
FROM "DT_Output_7"), 
"DT_node_lookup_8" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.4814905022229727) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.39414078064364416) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.13274830122602513) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.2368538654219348) THEN 16 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.15085376364884465) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.22983261435507094) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.9496264146212148) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.7798315905549854) THEN 272 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -1.3222523675986038) THEN 546 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.6197557239875325) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -0.6782144654287176) THEN 2188 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_16 <= 0.3406589517236291) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.4160702512810716) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_28 <= -0.3095874388667395) THEN 17512 ELSE 17513 END ELSE 8757 END ELSE 4379 END END ELSE 1095 END END END ELSE 137 END ELSE 69 END ELSE 35 END END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.18153528572819072) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.0258142468058166) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.6198268515510499) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_14 <= 0.43792458728556455) THEN 62 ELSE 63 END END END END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_8" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.03089283383083773 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.027649083273576753 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.037863760180938115 AS "Score" FROM rdb$database UNION ALL SELECT 14 AS nid, -0.07613426848391092 AS "Score" FROM rdb$database UNION ALL SELECT 16 AS nid, 0.055770223392602306 AS "Score" FROM rdb$database UNION ALL SELECT 30 AS nid, -0.07492639160078489 AS "Score" FROM rdb$database UNION ALL SELECT 35 AS nid, 0.08032083599377728 AS "Score" FROM rdb$database UNION ALL SELECT 62 AS nid, -0.07492885075612388 AS "Score" FROM rdb$database UNION ALL SELECT 63 AS nid, -0.07492871773403978 AS "Score" FROM rdb$database UNION ALL SELECT 69 AS nid, 0.07718929054527812 AS "Score" FROM rdb$database UNION ALL SELECT 137 AS nid, 0.07533201350278079 AS "Score" FROM rdb$database UNION ALL SELECT 272 AS nid, 0.07522097039612041 AS "Score" FROM rdb$database UNION ALL SELECT 546 AS nid, 0.07508475912789513 AS "Score" FROM rdb$database UNION ALL SELECT 1095 AS nid, 0.0750119643504328 AS "Score" FROM rdb$database UNION ALL SELECT 2188 AS nid, 0.07490211625255971 AS "Score" FROM rdb$database UNION ALL SELECT 4379 AS nid, 0.07493812382276714 AS "Score" FROM rdb$database UNION ALL SELECT 8757 AS nid, 0.07491650088909606 AS "Score" FROM rdb$database UNION ALL SELECT 17512 AS nid, 0.0749283044022344 AS "Score" FROM rdb$database UNION ALL SELECT 17513 AS nid, 0.07492529549588277 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_8" AS 
(SELECT "DT_node_lookup_8"."KEY" AS "KEY", "DT_node_lookup_8".node_id_2 AS node_id_2, "DT_node_data_8".nid AS nid, "DT_node_data_8"."Score" AS "Score" 
FROM "DT_node_lookup_8" LEFT OUTER JOIN "DT_node_data_8" ON "DT_node_lookup_8".node_id_2 = "DT_node_data_8".nid), 
"LGBM_Model_0_8" AS 
(SELECT "DT_Output_8"."KEY" AS "KEY", "DT_Output_8"."Score" AS "Score_0" 
FROM "DT_Output_8"), 
"DT_node_lookup_9" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.2290075953417611) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.5342161049654915) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.16650962355207619) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.8663353250931668) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.12370962647016474) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.14172717634215443) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.0672525511793898) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.7798315905549854) THEN 258 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.9711793646990726) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -0.6782144654287176) THEN 1036 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.35602019526060164) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -1.0084267200050607) THEN 4148 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.7375254331840676) THEN 8298 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.007879313066280641) THEN 16598 ELSE 16599 END END END ELSE 2075 END END ELSE 519 END END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.4249616328737868) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.5907078221896193) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= 0.2391948784435862) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 1.2564583346422478) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.06256091325914839) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_9" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.042089312546468235 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.03690609000317493 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.03519682417988506 AS "Score" FROM rdb$database UNION ALL SELECT 14 AS nid, -0.08170311154688632 AS "Score" FROM rdb$database UNION ALL SELECT 17 AS nid, 0.05967774251690508 AS "Score" FROM rdb$database UNION ALL SELECT 30 AS nid, -0.07310613497336384 AS "Score" FROM rdb$database UNION ALL SELECT 33 AS nid, 0.08316719964603045 AS "Score" FROM rdb$database UNION ALL SELECT 62 AS nid, -0.0731286787614261 AS "Score" FROM rdb$database UNION ALL SELECT 65 AS nid, 0.07522094380484144 AS "Score" FROM rdb$database UNION ALL SELECT 126 AS nid, -0.07312914902028507 AS "Score" FROM rdb$database UNION ALL SELECT 127 AS nid, -0.07312910831310288 AS "Score" FROM rdb$database UNION ALL SELECT 128 AS nid, 0.07370378547675407 AS "Score" FROM rdb$database UNION ALL SELECT 258 AS nid, 0.07337009415963981 AS "Score" FROM rdb$database UNION ALL SELECT 519 AS nid, 0.07326924597017977 AS "Score" FROM rdb$database UNION ALL SELECT 1036 AS nid, 0.0731146785607607 AS "Score" FROM rdb$database UNION ALL SELECT 2075 AS nid, 0.0731181590778487 AS "Score" FROM rdb$database UNION ALL SELECT 4148 AS nid, 0.07312399367335531 AS "Score" FROM rdb$database UNION ALL SELECT 8298 AS nid, 0.07312765052508306 AS "Score" FROM rdb$database UNION ALL SELECT 16598 AS nid, 0.07312935638410367 AS "Score" FROM rdb$database UNION ALL SELECT 16599 AS nid, 0.07312838563478911 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_9" AS 
(SELECT "DT_node_lookup_9"."KEY" AS "KEY", "DT_node_lookup_9".node_id_2 AS node_id_2, "DT_node_data_9".nid AS nid, "DT_node_data_9"."Score" AS "Score" 
FROM "DT_node_lookup_9" LEFT OUTER JOIN "DT_node_data_9" ON "DT_node_lookup_9".node_id_2 = "DT_node_data_9".nid), 
"LGBM_Model_0_9" AS 
(SELECT "DT_Output_9"."KEY" AS "KEY", "DT_Output_9"."Score" AS "Score_0" 
FROM "DT_Output_9")
 SELECT "LGBM_B0"."KEY", "LGBM_B0"."Score_0" 
FROM (SELECT "LGBM_esu_0"."KEY" AS "KEY", "LGBM_esu_0"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_Model_0_0"."KEY" AS "KEY", "LGBM_Model_0_0"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_0" UNION ALL SELECT "LGBM_Model_0_1"."KEY" AS "KEY", "LGBM_Model_0_1"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_1" UNION ALL SELECT "LGBM_Model_0_2"."KEY" AS "KEY", "LGBM_Model_0_2"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_2" UNION ALL SELECT "LGBM_Model_0_3"."KEY" AS "KEY", "LGBM_Model_0_3"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_3" UNION ALL SELECT "LGBM_Model_0_4"."KEY" AS "KEY", "LGBM_Model_0_4"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_4" UNION ALL SELECT "LGBM_Model_0_5"."KEY" AS "KEY", "LGBM_Model_0_5"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_5" UNION ALL SELECT "LGBM_Model_0_6"."KEY" AS "KEY", "LGBM_Model_0_6"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_6" UNION ALL SELECT "LGBM_Model_0_7"."KEY" AS "KEY", "LGBM_Model_0_7"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_7" UNION ALL SELECT "LGBM_Model_0_8"."KEY" AS "KEY", "LGBM_Model_0_8"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_8" UNION ALL SELECT "LGBM_Model_0_9"."KEY" AS "KEY", "LGBM_Model_0_9"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_9") AS "LGBM_esu_0") AS "LGBM_B0") AS "U"

-- Code For temporary table TMP_20180516_CODEGEN_HWWBDI_LGB part 1. Create 


CREATE GLOBAL TEMPORARY TABLE "TMP_20180516_CODEGEN_HWWBDI_LGB" (
	"KEY" BIGINT, 
	"Score_0" DOUBLE PRECISION
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20180516_CODEGEN_HWWBDI_LGB part 2. Populate

INSERT INTO "TMP_20180516_CODEGEN_HWWBDI_LGB" ("KEY", "Score_0") SELECT "U"."KEY", "U"."Score_0" 
FROM (WITH "DT_node_lookup_10" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.4814905022229727) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.047172572236715275) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.08671892196771332) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.22446740955145653) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 1.0000000180025095e-35) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.0994044590926684) THEN 64 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.8331377698987934) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.7741820945863944) THEN 260 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= 0.7554314258991714) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.9529348814987179) THEN 1044 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.4034950220112002) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.5605557969533469) THEN 4180 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= 0.13850780084347555) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.13066697925658857) THEN 16724 ELSE 16725 END ELSE 8363 END END ELSE 2091 END END ELSE 523 END END ELSE 131 END END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.08468143687840854) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 0.2762564546234015) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.33763896952153566) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 1.237630749386758) THEN 60 ELSE 61 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.3130989355297951) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 1.2564583346422478) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_10" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.016514786348657554 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.02414362157884811 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.04995929137393105 AS "Score" FROM rdb$database UNION ALL SELECT 14 AS nid, -0.07263837364939374 AS "Score" FROM rdb$database UNION ALL SELECT 17 AS nid, 0.0737043166133568 AS "Score" FROM rdb$database UNION ALL SELECT 33 AS nid, 0.07323087476710446 AS "Score" FROM rdb$database UNION ALL SELECT 60 AS nid, -0.0714097418227018 AS "Score" FROM rdb$database UNION ALL SELECT 61 AS nid, -0.07149603760655208 AS "Score" FROM rdb$database UNION ALL SELECT 62 AS nid, -0.0715353350707039 AS "Score" FROM rdb$database UNION ALL SELECT 64 AS nid, 0.07217903901790801 AS "Score" FROM rdb$database UNION ALL SELECT 126 AS nid, -0.07148530502974197 AS "Score" FROM rdb$database UNION ALL SELECT 127 AS nid, -0.07149814345095516 AS "Score" FROM rdb$database UNION ALL SELECT 131 AS nid, 0.07197093490336108 AS "Score" FROM rdb$database UNION ALL SELECT 260 AS nid, 0.07171661376535457 AS "Score" FROM rdb$database UNION ALL SELECT 523 AS nid, 0.0715872979200132 AS "Score" FROM rdb$database UNION ALL SELECT 1044 AS nid, 0.07152535318811849 AS "Score" FROM rdb$database UNION ALL SELECT 2091 AS nid, 0.07148303058681718 AS "Score" FROM rdb$database UNION ALL SELECT 4180 AS nid, 0.07149262730041803 AS "Score" FROM rdb$database UNION ALL SELECT 8363 AS nid, 0.07149615994915863 AS "Score" FROM rdb$database UNION ALL SELECT 16724 AS nid, 0.0714980665472603 AS "Score" FROM rdb$database UNION ALL SELECT 16725 AS nid, 0.07149725696643605 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_10" AS 
(SELECT "DT_node_lookup_10"."KEY" AS "KEY", "DT_node_lookup_10".node_id_2 AS node_id_2, "DT_node_data_10".nid AS nid, "DT_node_data_10"."Score" AS "Score" 
FROM "DT_node_lookup_10" LEFT OUTER JOIN "DT_node_data_10" ON "DT_node_lookup_10".node_id_2 = "DT_node_data_10".nid), 
"LGBM_Model_0_10" AS 
(SELECT "DT_Output_10"."KEY" AS "KEY", "DT_Output_10"."Score" AS "Score_0" 
FROM "DT_Output_10"), 
"DT_node_lookup_11" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.2290075953417611) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.5342161049654915) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.16650962355207619) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.8663353250931668) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.12370962647016474) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.14172717634215443) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.0672525511793898) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.7798315905549854) THEN 258 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.9711793646990726) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.25885228257162696) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -0.6782144654287176) THEN 2072 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -1.0084267200050607) THEN 4146 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= -0.7919978671467575) THEN 8294 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.48377406927319216) THEN 16590 ELSE 16591 END END END END ELSE 1037 END ELSE 519 END END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.4249616328737868) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.5907078221896193) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= 0.2391948784435862) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= 0.7788028743991082) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.42795987521210904) THEN 124 ELSE 125 END ELSE 63 END END END END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_11" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.03896400917783613 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.034261966311745044 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.03285546687934552 AS "Score" FROM rdb$database UNION ALL SELECT 14 AS nid, -0.07857453577600587 AS "Score" FROM rdb$database UNION ALL SELECT 17 AS nid, 0.05623692404833569 AS "Score" FROM rdb$database UNION ALL SELECT 30 AS nid, -0.0699949292362282 AS "Score" FROM rdb$database UNION ALL SELECT 33 AS nid, 0.07949698969077551 AS "Score" FROM rdb$database UNION ALL SELECT 63 AS nid, -0.07001313721574971 AS "Score" FROM rdb$database UNION ALL SELECT 65 AS nid, 0.07218446711620323 AS "Score" FROM rdb$database UNION ALL SELECT 124 AS nid, -0.07001493487885747 AS "Score" FROM rdb$database UNION ALL SELECT 125 AS nid, -0.0700143695171359 AS "Score" FROM rdb$database UNION ALL SELECT 128 AS nid, 0.07048556108103786 AS "Score" FROM rdb$database UNION ALL SELECT 258 AS nid, 0.0702114718645677 AS "Score" FROM rdb$database UNION ALL SELECT 519 AS nid, 0.07013156900150673 AS "Score" FROM rdb$database UNION ALL SELECT 1037 AS nid, 0.06999094476836583 AS "Score" FROM rdb$database UNION ALL SELECT 2072 AS nid, 0.07000135884465551 AS "Score" FROM rdb$database UNION ALL SELECT 4146 AS nid, 0.07000980975147011 AS "Score" FROM rdb$database UNION ALL SELECT 8294 AS nid, 0.07001477641139196 AS "Score" FROM rdb$database UNION ALL SELECT 16590 AS nid, 0.07001438351936916 AS "Score" FROM rdb$database UNION ALL SELECT 16591 AS nid, 0.07001282446340361 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_11" AS 
(SELECT "DT_node_lookup_11"."KEY" AS "KEY", "DT_node_lookup_11".node_id_2 AS node_id_2, "DT_node_data_11".nid AS nid, "DT_node_data_11"."Score" AS "Score" 
FROM "DT_node_lookup_11" LEFT OUTER JOIN "DT_node_data_11" ON "DT_node_lookup_11".node_id_2 = "DT_node_data_11".nid), 
"LGBM_Model_0_11" AS 
(SELECT "DT_Output_11"."KEY" AS "KEY", "DT_Output_11"."Score" AS "Score_0" 
FROM "DT_Output_11"), 
"DT_node_lookup_12" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.4814905022229727) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.047172572236715275) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.08671892196771332) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.22446740955145653) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 1.0000000180025095e-35) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.8663353250931668) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.0672525511793898) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.7798315905549854) THEN 258 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.9711793646990726) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.3083900127380073) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= -0.5459919719992464) THEN 2072 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_20 <= 0.21598734959928992) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= -0.6982166920312963) THEN 8292 ELSE 8293 END ELSE 4147 END END ELSE 1037 END ELSE 519 END END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= -0.08468143687840854) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 0.2762564546234015) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.33763896952153566) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_25 <= 1.0990149514990153) THEN 60 ELSE 61 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= -0.5406918322353981) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.7239248060662956) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_12" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.015076628880380326 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.022017427329214245 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.046524181609464366 AS "Score" FROM rdb$database UNION ALL SELECT 14 AS nid, -0.07039083550484013 AS "Score" FROM rdb$database UNION ALL SELECT 17 AS nid, 0.07100951018552396 AS "Score" FROM rdb$database UNION ALL SELECT 33 AS nid, 0.07022428794674981 AS "Score" FROM rdb$database UNION ALL SELECT 60 AS nid, -0.06852366596585376 AS "Score" FROM rdb$database UNION ALL SELECT 61 AS nid, -0.0686596268284067 AS "Score" FROM rdb$database UNION ALL SELECT 62 AS nid, -0.06872993029305652 AS "Score" FROM rdb$database UNION ALL SELECT 65 AS nid, 0.06948505898906011 AS "Score" FROM rdb$database UNION ALL SELECT 126 AS nid, -0.06864268554991465 AS "Score" FROM rdb$database UNION ALL SELECT 127 AS nid, -0.06866118982427533 AS "Score" FROM rdb$database UNION ALL SELECT 128 AS nid, 0.06906571614708823 AS "Score" FROM rdb$database UNION ALL SELECT 258 AS nid, 0.06884132684665632 AS "Score" FROM rdb$database UNION ALL SELECT 519 AS nid, 0.06876812215248128 AS "Score" FROM rdb$database UNION ALL SELECT 1037 AS nid, 0.06864689278822284 AS "Score" FROM rdb$database UNION ALL SELECT 2072 AS nid, 0.06865521315868599 AS "Score" FROM rdb$database UNION ALL SELECT 4147 AS nid, 0.06865919011292825 AS "Score" FROM rdb$database UNION ALL SELECT 8292 AS nid, 0.06866127328768673 AS "Score" FROM rdb$database UNION ALL SELECT 8293 AS nid, 0.0686605654503328 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_12" AS 
(SELECT "DT_node_lookup_12"."KEY" AS "KEY", "DT_node_lookup_12".node_id_2 AS node_id_2, "DT_node_data_12".nid AS nid, "DT_node_data_12"."Score" AS "Score" 
FROM "DT_node_lookup_12" LEFT OUTER JOIN "DT_node_data_12" ON "DT_node_lookup_12".node_id_2 = "DT_node_data_12".nid), 
"LGBM_Model_0_12" AS 
(SELECT "DT_Output_12"."KEY" AS "KEY", "DT_Output_12"."Score" AS "Score_0" 
FROM "DT_Output_12"), 
"DT_node_lookup_13" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.2290075953417611) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.5342161049654915) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.16650962355207619) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.8663353250931668) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.12370962647016474) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.14172717634215443) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.0672525511793898) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.7798315905549854) THEN 258 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= 0.9711793646990726) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= -0.25885228257162696) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -0.6782144654287176) THEN 2072 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -1.0084267200050607) THEN 4146 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_13 <= -0.7919978671467575) THEN 8294 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.48377406927319216) THEN 16590 ELSE 16591 END END END END ELSE 1037 END ELSE 519 END END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.4249616328737868) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.5907078221896193) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 1.0004326265622796) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= -0.18803945037732497) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 1.3653760067166014) THEN 126 ELSE 127 END END END END END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_13" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.03611097851581999 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.03181932313553328 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.03068749502889036 AS "Score" FROM rdb$database UNION ALL SELECT 14 AS nid, -0.07593983332859662 AS "Score" FROM rdb$database UNION ALL SELECT 17 AS nid, 0.05316577334276195 AS "Score" FROM rdb$database UNION ALL SELECT 30 AS nid, -0.06740549436705828 AS "Score" FROM rdb$database UNION ALL SELECT 33 AS nid, 0.07648150800105012 AS "Score" FROM rdb$database UNION ALL SELECT 62 AS nid, -0.06742030724344228 AS "Score" FROM rdb$database UNION ALL SELECT 65 AS nid, 0.069641134045665 AS "Score" FROM rdb$database UNION ALL SELECT 126 AS nid, -0.06742374825494978 AS "Score" FROM rdb$database UNION ALL SELECT 127 AS nid, -0.06742273945317455 AS "Score" FROM rdb$database UNION ALL SELECT 128 AS nid, 0.06781425282372186 AS "Score" FROM rdb$database UNION ALL SELECT 258 AS nid, 0.06758582987395294 AS "Score" FROM rdb$database UNION ALL SELECT 519 AS nid, 0.06752088824794668 AS "Score" FROM rdb$database UNION ALL SELECT 1037 AS nid, 0.0673944395621863 AS "Score" FROM rdb$database UNION ALL SELECT 2072 AS nid, 0.06740833079066924 AS "Score" FROM rdb$database UNION ALL SELECT 4146 AS nid, 0.06741891414594693 AS "Score" FROM rdb$database UNION ALL SELECT 8294 AS nid, 0.06742313452165187 AS "Score" FROM rdb$database UNION ALL SELECT 16590 AS nid, 0.0674227506978624 AS "Score" FROM rdb$database UNION ALL SELECT 16591 AS nid, 0.0674214378807726 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_13" AS 
(SELECT "DT_node_lookup_13"."KEY" AS "KEY", "DT_node_lookup_13".node_id_2 AS node_id_2, "DT_node_data_13".nid AS nid, "DT_node_data_13"."Score" AS "Score" 
FROM "DT_node_lookup_13" LEFT OUTER JOIN "DT_node_data_13" ON "DT_node_lookup_13".node_id_2 = "DT_node_data_13".nid), 
"LGBM_Model_0_13" AS 
(SELECT "DT_Output_13"."KEY" AS "KEY", "DT_Output_13"."Score" AS "Score_0" 
FROM "DT_Output_13"), 
"DT_node_lookup_14" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= 1.0000000180025095e-35) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 1.0458561646093025) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.1886260035520169) THEN 8 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.2766202099329947) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= 0.6392099613178771) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.24893617072471905) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= -0.22891007006768385) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.6806920483964857) THEN 288 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= 0.22705438449227833) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_19 <= -0.34157811663855925) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.7162602776873837) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.7278553991090603) THEN 4624 ELSE 4625 END ELSE 2313 END ELSE 1157 END ELSE 579 END END ELSE 145 END ELSE 73 END ELSE 37 END ELSE 19 END END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 1.0000000180025095e-35) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.456678528187152) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.5907078221896193) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_22 <= 0.5391297079905517) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.43193198397304394) THEN 126 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 0.48873655941511157) THEN 254 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_26 <= 0.563668128483355) THEN 510 ELSE 511 END END END END END END END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_14" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, 0.030674450042139412 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, 0.017952804520307883 AS "Score" FROM rdb$database UNION ALL SELECT 8 AS nid, 0.04563238890651711 AS "Score" FROM rdb$database UNION ALL SELECT 14 AS nid, -0.03861139037074292 AS "Score" FROM rdb$database UNION ALL SELECT 19 AS nid, 0.08110440310858931 AS "Score" FROM rdb$database UNION ALL SELECT 30 AS nid, -0.07699989633468136 AS "Score" FROM rdb$database UNION ALL SELECT 37 AS nid, 0.056944838061214344 AS "Score" FROM rdb$database UNION ALL SELECT 62 AS nid, -0.07008774459703444 AS "Score" FROM rdb$database UNION ALL SELECT 73 AS nid, 0.07399910716833029 AS "Score" FROM rdb$database UNION ALL SELECT 126 AS nid, -0.06628173390860316 AS "Score" FROM rdb$database UNION ALL SELECT 145 AS nid, 0.06853202813853372 AS "Score" FROM rdb$database UNION ALL SELECT 254 AS nid, -0.06628742799718611 AS "Score" FROM rdb$database UNION ALL SELECT 288 AS nid, 0.06640724828109161 AS "Score" FROM rdb$database UNION ALL SELECT 510 AS nid, -0.06628628749893971 AS "Score" FROM rdb$database UNION ALL SELECT 511 AS nid, -0.06628701179942759 AS "Score" FROM rdb$database UNION ALL SELECT 579 AS nid, 0.0663753081290589 AS "Score" FROM rdb$database UNION ALL SELECT 1157 AS nid, 0.06625069259920188 AS "Score" FROM rdb$database UNION ALL SELECT 2313 AS nid, 0.0663168015673976 AS "Score" FROM rdb$database UNION ALL SELECT 4624 AS nid, 0.06628587482561724 AS "Score" FROM rdb$database UNION ALL SELECT 4625 AS nid, 0.06627875257528591 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_14" AS 
(SELECT "DT_node_lookup_14"."KEY" AS "KEY", "DT_node_lookup_14".node_id_2 AS node_id_2, "DT_node_data_14".nid AS nid, "DT_node_data_14"."Score" AS "Score" 
FROM "DT_node_lookup_14" LEFT OUTER JOIN "DT_node_data_14" ON "DT_node_lookup_14".node_id_2 = "DT_node_data_14".nid), 
"LGBM_Model_0_14" AS 
(SELECT "DT_Output_14"."KEY" AS "KEY", "DT_Output_14"."Score" AS "Score_0" 
FROM "DT_Output_14"), 
"DT_node_lookup_15" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 0.4814905022229727) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_24 <= 0.18153528572819072) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.16650962355207619) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.020069408376512787) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= 1.0618944562739838) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_9 <= -0.2766202099329947) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= -1.0672525511793898) THEN 128 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_21 <= -0.7493972090467694) THEN 258 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_30 <= 0.5057795434777707) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= -0.10908758520735011) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_15 <= -0.4207359048946175) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_18 <= -0.3860502350376984) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_17 <= -0.7551579916224319) THEN 8288 ELSE 8289 END ELSE 4145 END ELSE 2073 END ELSE 1037 END ELSE 519 END END END ELSE 65 END ELSE 33 END ELSE 17 END ELSE 9 END ELSE 5 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_23 <= -0.24986897777415668) THEN 6 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 0.09514067918425671) THEN 14 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_3 <= 0.14317696056002513) THEN 30 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_12 <= 0.3112341683429681) THEN 62 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_29 <= 1.0268238791598836) THEN 126 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_31 <= 0.6459686647424611) THEN 254 ELSE 255 END END END END END END END AS node_id_2 
FROM "TMP_20180516_CODEGEN_LLWBSE_ADS" AS "ADS_sca_2_OUT"), 
"DT_node_data_15" AS 
(SELECT "Values".nid AS nid, CAST("Values"."Score" AS DOUBLE PRECISION) AS "Score" 
FROM (SELECT 5 AS nid, -0.017762811687231254 AS "Score" FROM rdb$database UNION ALL SELECT 6 AS nid, -0.019401130940274357 AS "Score" FROM rdb$database UNION ALL SELECT 9 AS nid, 0.035213039116728885 AS "Score" FROM rdb$database UNION ALL SELECT 14 AS nid, -0.07739550748649766 AS "Score" FROM rdb$database UNION ALL SELECT 17 AS nid, 0.06937844640628348 AS "Score" FROM rdb$database UNION ALL SELECT 30 AS nid, -0.05387365054022436 AS "Score" FROM rdb$database UNION ALL SELECT 33 AS nid, 0.06673518963867736 AS "Score" FROM rdb$database UNION ALL SELECT 62 AS nid, -0.06730001856539584 AS "Score" FROM rdb$database UNION ALL SELECT 65 AS nid, 0.06618191350679944 AS "Score" FROM rdb$database UNION ALL SELECT 126 AS nid, -0.06508203525367383 AS "Score" FROM rdb$database UNION ALL SELECT 128 AS nid, 0.06583527634164521 AS "Score" FROM rdb$database UNION ALL SELECT 254 AS nid, -0.06524177482725951 AS "Score" FROM rdb$database UNION ALL SELECT 255 AS nid, -0.06524246238157791 AS "Score" FROM rdb$database UNION ALL SELECT 258 AS nid, 0.06546885743343826 AS "Score" FROM rdb$database UNION ALL SELECT 519 AS nid, 0.06533851134014357 AS "Score" FROM rdb$database UNION ALL SELECT 1037 AS nid, 0.06529080587320826 AS "Score" FROM rdb$database UNION ALL SELECT 2073 AS nid, 0.06519795516001435 AS "Score" FROM rdb$database UNION ALL SELECT 4145 AS nid, 0.06526947208504051 AS "Score" FROM rdb$database UNION ALL SELECT 8288 AS nid, 0.06524127510291594 AS "Score" FROM rdb$database UNION ALL SELECT 8289 AS nid, 0.06523066211444702 AS "Score" FROM rdb$database) AS "Values"), 
"DT_Output_15" AS 
(SELECT "DT_node_lookup_15"."KEY" AS "KEY", "DT_node_lookup_15".node_id_2 AS node_id_2, "DT_node_data_15".nid AS nid, "DT_node_data_15"."Score" AS "Score" 
FROM "DT_node_lookup_15" LEFT OUTER JOIN "DT_node_data_15" ON "DT_node_lookup_15".node_id_2 = "DT_node_data_15".nid), 
"LGBM_Model_0_15" AS 
(SELECT "DT_Output_15"."KEY" AS "KEY", "DT_Output_15"."Score" AS "Score_0" 
FROM "DT_Output_15")
 SELECT "LGBM_B1"."KEY", "LGBM_B1"."Score_0" 
FROM (SELECT "LGBM_esu_1"."KEY" AS "KEY", "LGBM_esu_1"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_Model_0_10"."KEY" AS "KEY", "LGBM_Model_0_10"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_10" UNION ALL SELECT "LGBM_Model_0_11"."KEY" AS "KEY", "LGBM_Model_0_11"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_11" UNION ALL SELECT "LGBM_Model_0_12"."KEY" AS "KEY", "LGBM_Model_0_12"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_12" UNION ALL SELECT "LGBM_Model_0_13"."KEY" AS "KEY", "LGBM_Model_0_13"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_13" UNION ALL SELECT "LGBM_Model_0_14"."KEY" AS "KEY", "LGBM_Model_0_14"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_14" UNION ALL SELECT "LGBM_Model_0_15"."KEY" AS "KEY", "LGBM_Model_0_15"."Score_0" AS "Score_0" 
FROM "LGBM_Model_0_15") AS "LGBM_esu_1") AS "LGBM_B1") AS "U"

-- Code For temporary table TMP_20180516_CODEGEN_5FV6BV_LGB part 1. Create 


CREATE GLOBAL TEMPORARY TABLE "TMP_20180516_CODEGEN_5FV6BV_LGB" (
	"KEY" BIGINT NOT NULL, 
	"Score_0" DOUBLE PRECISION, 
	PRIMARY KEY ("KEY")
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table TMP_20180516_CODEGEN_5FV6BV_LGB part 2. Populate

INSERT INTO "TMP_20180516_CODEGEN_5FV6BV_LGB" ("KEY", "Score_0") SELECT "U"."KEY", "U"."Score_0" 
FROM (WITH "LGBM_Union" AS 
(SELECT "LGBM_EnsembleUnion"."KEY" AS "KEY", "LGBM_EnsembleUnion"."Score_0" AS "Score_0" 
FROM (SELECT "LGBM_B0"."KEY" AS "KEY", "LGBM_B0"."Score_0" AS "Score_0" 
FROM "TMP_20180516_CODEGEN_BDBX0D_LGB" AS "LGBM_B0" UNION ALL SELECT "LGBM_B1"."KEY" AS "KEY", "LGBM_B1"."Score_0" AS "Score_0" 
FROM "TMP_20180516_CODEGEN_HWWBDI_LGB" AS "LGBM_B1") AS "LGBM_EnsembleUnion")
 SELECT "LGBM_sum"."KEY", "LGBM_sum"."Score_0" 
FROM (SELECT "T"."KEY" AS "KEY", CAST("T"."Score_0" AS DOUBLE PRECISION) AS "Score_0" 
FROM (SELECT "LGBM_Union"."KEY" AS "KEY", sum("LGBM_Union"."Score_0") AS "Score_0" 
FROM "LGBM_Union" GROUP BY "LGBM_Union"."KEY") AS "T") AS "LGBM_sum") AS "U"

-- Code For temporary table TMP_20180516_CODEGEN_5FV6BV_LGB part 3. Create Index 

CREATE INDEX "ix_TMP_20180516_CODEGEN_45c5" ON "TMP_20180516_CODEGEN_5FV6BV_LGB" ("KEY")

-- Model deployment code

WITH orig_cte AS 
(SELECT "LGBM_sum"."KEY" AS "KEY", "LGBM_sum"."Score_0" AS "Score_0", CAST(NULL AS DOUBLE PRECISION) AS "Score_1", 1.0 - 1.0 / (1.0 + exp(CASE WHEN (minvalue(maxvalue(-100.0, -"LGBM_sum"."Score_0"), 100.0) >= -709.782712893384) THEN minvalue(maxvalue(-100.0, -"LGBM_sum"."Score_0"), 100.0) ELSE -709.782712893384 END)) AS "Proba_0", 1.0 / (1.0 + exp(CASE WHEN (minvalue(maxvalue(-100.0, -"LGBM_sum"."Score_0"), 100.0) >= -709.782712893384) THEN minvalue(maxvalue(-100.0, -"LGBM_sum"."Score_0"), 100.0) ELSE -709.782712893384 END)) AS "Proba_1", CAST(NULL AS DOUBLE PRECISION) AS "LogProba_0", CAST(NULL AS DOUBLE PRECISION) AS "LogProba_1", CAST(NULL AS BIGINT) AS "Decision", CAST(NULL AS DOUBLE PRECISION) AS "DecisionProba" 
FROM "TMP_20180516_CODEGEN_5FV6BV_LGB" AS "LGBM_sum"), 
score_class_union AS 
(SELECT scu."KEY_u" AS "KEY_u", scu.class AS class, scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY_u", 0 AS class, orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 1 AS class, orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."Decision" AS "Decision", orig_cte."DecisionProba" AS "DecisionProba", max_select."KEY_m" AS "KEY_m", max_select."max_Proba" AS "max_Proba" 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union."KEY_u" AS "KEY_m", max(score_class_union."Proba") AS "max_Proba" 
FROM score_class_union GROUP BY score_class_union."KEY_u") AS max_select ON orig_cte."KEY" = max_select."KEY_m"), 
union_with_max AS 
(SELECT score_class_union."KEY_u" AS "KEY_u", score_class_union.class AS class, score_class_union."LogProba" AS "LogProba", score_class_union."Proba" AS "Proba", score_class_union."Score" AS "Score", score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Proba" AS "max_Proba" 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union."KEY_u" = score_max."KEY"), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Proba" AS "max_Proba", "arg_max_t_Proba"."KEY_Proba" AS "KEY_Proba", "arg_max_t_Proba"."arg_max_Proba" AS "arg_max_Proba" 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max."KEY" AS "KEY_Proba", min(union_with_max.class) AS "arg_max_Proba" 
FROM union_with_max 
WHERE union_with_max."max_Proba" <= union_with_max."Proba" GROUP BY union_with_max."KEY") AS "arg_max_t_Proba" ON score_max."KEY" = "arg_max_t_Proba"."KEY_Proba")
 SELECT arg_max_cte."KEY" AS "KEY", CAST(NULL AS DOUBLE PRECISION) AS "Score_0", CAST(NULL AS DOUBLE PRECISION) AS "Score_1", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN ln(arg_max_cte."Proba_0") ELSE -1.79769313486231e+308 END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN ln(arg_max_cte."Proba_1") ELSE -1.79769313486231e+308 END AS "LogProba_1", arg_max_cte."arg_max_Proba" AS "Decision", arg_max_cte."max_Proba" AS "DecisionProba" 
FROM arg_max_cte