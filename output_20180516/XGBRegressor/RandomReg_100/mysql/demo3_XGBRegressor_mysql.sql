-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : XGBRegressor
-- Dataset : RandomReg_100
-- Database : mysql


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table TMP_20180516114546_CODEGEN_C6XZBJ_XGB_B0 part 1. Create 


CREATE TEMPORARY TABLE `TMP_20180516114546_CODEGEN_C6XZBJ_XGB_B0` (
	`KEY` BIGINT, 
	`Estimator` DOUBLE
)

 ENGINE=MEMORY

-- Code For temporary table TMP_20180516114546_CODEGEN_C6XZBJ_XGB_B0 part 2. Populate

INSERT INTO `TMP_20180516114546_CODEGEN_C6XZBJ_XGB_B0` (`KEY`, `Estimator`) SELECT `U`.`KEY`, `U`.`Estimator` 
FROM (WITH `DT_node_lookup` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_80` < -0.20716172456741333) THEN CASE WHEN (`ADS`.`Feature_41` < -0.5217077136039734) THEN 3 ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_39` < 0.45573797821998596) THEN CASE WHEN (`ADS`.`Feature_1` < -0.20646128058433533) THEN 7 ELSE 8 END ELSE 6 END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 3 AS nid, -28.410009384155273 AS `Estimator` UNION ALL SELECT 4 AS nid, -3.1539788246154785 AS `Estimator` UNION ALL SELECT 6 AS nid, 18.046173095703125 AS `Estimator` UNION ALL SELECT 7 AS nid, 9.786873817443848 AS `Estimator` UNION ALL SELECT 8 AS nid, -2.8145415782928467 AS `Estimator`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.node_id_2 AS node_id_2, `DT_node_data`.nid AS nid, `DT_node_data`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.node_id_2 = `DT_node_data`.nid), 
`XGB_Model_0` AS 
(SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`Estimator` AS `Estimator` 
FROM `DT_Output`), 
`DT_node_lookup_1` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_80` < -0.20716172456741333) THEN CASE WHEN (`ADS`.`Feature_63` < -0.05232740938663483) THEN 3 ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_1` < 0.4291309118270874) THEN CASE WHEN (`ADS`.`Feature_70` < -0.4974871277809143) THEN 7 ELSE 8 END ELSE 6 END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_1` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 3 AS nid, -24.256071090698242 AS `Estimator` UNION ALL SELECT 4 AS nid, -0.5576338171958923 AS `Estimator` UNION ALL SELECT 6 AS nid, -1.8566820621490479 AS `Estimator` UNION ALL SELECT 7 AS nid, 3.0265614986419678 AS `Estimator` UNION ALL SELECT 8 AS nid, 17.198657989501953 AS `Estimator`) AS `Values`), 
`DT_Output_1` AS 
(SELECT `DT_node_lookup_1`.`KEY` AS `KEY`, `DT_node_lookup_1`.node_id_2 AS node_id_2, `DT_node_data_1`.nid AS nid, `DT_node_data_1`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_1` LEFT OUTER JOIN `DT_node_data_1` ON `DT_node_lookup_1`.node_id_2 = `DT_node_data_1`.nid), 
`XGB_Model_1` AS 
(SELECT `DT_Output_1`.`KEY` AS `KEY`, `DT_Output_1`.`Estimator` AS `Estimator` 
FROM `DT_Output_1`), 
`DT_node_lookup_2` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_80` < -0.20716172456741333) THEN CASE WHEN (`ADS`.`Feature_41` < -0.5217077136039734) THEN 3 ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_39` < 0.45573797821998596) THEN CASE WHEN (`ADS`.`Feature_20` < 0.16611027717590332) THEN 7 ELSE 8 END ELSE 6 END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_2` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 3 AS nid, -24.15021514892578 AS `Estimator` UNION ALL SELECT 4 AS nid, -1.8534382581710815 AS `Estimator` UNION ALL SELECT 6 AS nid, 15.231833457946777 AS `Estimator` UNION ALL SELECT 7 AS nid, -2.0477664470672607 AS `Estimator` UNION ALL SELECT 8 AS nid, 9.518328666687012 AS `Estimator`) AS `Values`), 
`DT_Output_2` AS 
(SELECT `DT_node_lookup_2`.`KEY` AS `KEY`, `DT_node_lookup_2`.node_id_2 AS node_id_2, `DT_node_data_2`.nid AS nid, `DT_node_data_2`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_2` LEFT OUTER JOIN `DT_node_data_2` ON `DT_node_lookup_2`.node_id_2 = `DT_node_data_2`.nid), 
`XGB_Model_2` AS 
(SELECT `DT_Output_2`.`KEY` AS `KEY`, `DT_Output_2`.`Estimator` AS `Estimator` 
FROM `DT_Output_2`), 
`DT_node_lookup_3` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_80` < -0.20716172456741333) THEN CASE WHEN (`ADS`.`Feature_95` < -0.23302042484283447) THEN 3 ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_94` < -0.725760817527771) THEN CASE WHEN (`ADS`.`Feature_20` < 0.2668744623661041) THEN 7 ELSE 8 END ELSE CASE WHEN (`ADS`.`Feature_16` < 0.2266543060541153) THEN 9 ELSE 10 END END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_3` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 3 AS nid, -21.71302604675293 AS `Estimator` UNION ALL SELECT 4 AS nid, -0.7697945833206177 AS `Estimator` UNION ALL SELECT 7 AS nid, 7.725564479827881 AS `Estimator` UNION ALL SELECT 8 AS nid, 18.214473724365234 AS `Estimator` UNION ALL SELECT 9 AS nid, -4.456724166870117 AS `Estimator` UNION ALL SELECT 10 AS nid, 8.558111190795898 AS `Estimator`) AS `Values`), 
`DT_Output_3` AS 
(SELECT `DT_node_lookup_3`.`KEY` AS `KEY`, `DT_node_lookup_3`.node_id_2 AS node_id_2, `DT_node_data_3`.nid AS nid, `DT_node_data_3`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_3` LEFT OUTER JOIN `DT_node_data_3` ON `DT_node_lookup_3`.node_id_2 = `DT_node_data_3`.nid), 
`XGB_Model_3` AS 
(SELECT `DT_Output_3`.`KEY` AS `KEY`, `DT_Output_3`.`Estimator` AS `Estimator` 
FROM `DT_Output_3`), 
`DT_node_lookup_4` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_80` < -0.08977922052145004) THEN CASE WHEN (`ADS`.`Feature_41` < -0.5217077136039734) THEN 3 ELSE CASE WHEN (`ADS`.`Feature_63` < 0.025700129568576813) THEN 7 ELSE 8 END END ELSE CASE WHEN (`ADS`.`Feature_94` < -0.674340009689331) THEN 5 ELSE CASE WHEN (`ADS`.`Feature_17` < -0.17455044388771057) THEN 9 ELSE 10 END END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_4` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 3 AS nid, -20.44965171813965 AS `Estimator` UNION ALL SELECT 5 AS nid, 13.91840648651123 AS `Estimator` UNION ALL SELECT 7 AS nid, -9.988748550415039 AS `Estimator` UNION ALL SELECT 8 AS nid, 7.893120765686035 AS `Estimator` UNION ALL SELECT 9 AS nid, -4.138180732727051 AS `Estimator` UNION ALL SELECT 10 AS nid, 8.574945449829102 AS `Estimator`) AS `Values`), 
`DT_Output_4` AS 
(SELECT `DT_node_lookup_4`.`KEY` AS `KEY`, `DT_node_lookup_4`.node_id_2 AS node_id_2, `DT_node_data_4`.nid AS nid, `DT_node_data_4`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_4` LEFT OUTER JOIN `DT_node_data_4` ON `DT_node_lookup_4`.node_id_2 = `DT_node_data_4`.nid), 
`XGB_Model_4` AS 
(SELECT `DT_Output_4`.`KEY` AS `KEY`, `DT_Output_4`.`Estimator` AS `Estimator` 
FROM `DT_Output_4`), 
`DT_node_lookup_5` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_80` < -0.08977922052145004) THEN CASE WHEN (`ADS`.`Feature_63` < -0.05232740938663483) THEN CASE WHEN (`ADS`.`Feature_71` < -0.08045637607574463) THEN 7 ELSE 8 END ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_59` < 0.035378627479076385) THEN CASE WHEN (`ADS`.`Feature_37` < 0.07651043683290482) THEN 9 ELSE 10 END ELSE CASE WHEN (`ADS`.`Feature_1` < -0.10279124975204468) THEN 11 ELSE 12 END END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_5` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 4 AS nid, 0.7459381818771362 AS `Estimator` UNION ALL SELECT 7 AS nid, -21.00839614868164 AS `Estimator` UNION ALL SELECT 8 AS nid, -10.986132621765137 AS `Estimator` UNION ALL SELECT 9 AS nid, 16.906192779541016 AS `Estimator` UNION ALL SELECT 10 AS nid, 4.195286273956299 AS `Estimator` UNION ALL SELECT 11 AS nid, 6.471360683441162 AS `Estimator` UNION ALL SELECT 12 AS nid, -5.164093494415283 AS `Estimator`) AS `Values`), 
`DT_Output_5` AS 
(SELECT `DT_node_lookup_5`.`KEY` AS `KEY`, `DT_node_lookup_5`.node_id_2 AS node_id_2, `DT_node_data_5`.nid AS nid, `DT_node_data_5`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_5` LEFT OUTER JOIN `DT_node_data_5` ON `DT_node_lookup_5`.node_id_2 = `DT_node_data_5`.nid), 
`XGB_Model_5` AS 
(SELECT `DT_Output_5`.`KEY` AS `KEY`, `DT_Output_5`.`Estimator` AS `Estimator` 
FROM `DT_Output_5`), 
`DT_node_lookup_6` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_41` < -0.5153412222862244) THEN CASE WHEN (`ADS`.`Feature_80` < 0.07958017289638519) THEN 3 ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_92` < -1.1308966875076294) THEN 5 ELSE CASE WHEN (`ADS`.`Feature_63` < -0.3466222882270813) THEN 7 ELSE 8 END END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_6` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 3 AS nid, -16.98235511779785 AS `Estimator` UNION ALL SELECT 4 AS nid, 1.3266820907592773 AS `Estimator` UNION ALL SELECT 5 AS nid, -5.528151035308838 AS `Estimator` UNION ALL SELECT 7 AS nid, 1.3559454679489136 AS `Estimator` UNION ALL SELECT 8 AS nid, 10.946196556091309 AS `Estimator`) AS `Values`), 
`DT_Output_6` AS 
(SELECT `DT_node_lookup_6`.`KEY` AS `KEY`, `DT_node_lookup_6`.node_id_2 AS node_id_2, `DT_node_data_6`.nid AS nid, `DT_node_data_6`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_6` LEFT OUTER JOIN `DT_node_data_6` ON `DT_node_lookup_6`.node_id_2 = `DT_node_data_6`.nid), 
`XGB_Model_6` AS 
(SELECT `DT_Output_6`.`KEY` AS `KEY`, `DT_Output_6`.`Estimator` AS `Estimator` 
FROM `DT_Output_6`), 
`DT_node_lookup_7` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_95` < -0.2972280979156494) THEN CASE WHEN (`ADS`.`Feature_41` < -0.2632381319999695) THEN 3 ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_79` < -0.027673793956637383) THEN CASE WHEN (`ADS`.`Feature_62` < 0.23806703090667725) THEN 7 ELSE 8 END ELSE CASE WHEN (`ADS`.`Feature_20` < 0.357879638671875) THEN 9 ELSE 10 END END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_7` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 3 AS nid, -16.830724716186523 AS `Estimator` UNION ALL SELECT 4 AS nid, -0.5987619161605835 AS `Estimator` UNION ALL SELECT 7 AS nid, 2.337512731552124 AS `Estimator` UNION ALL SELECT 8 AS nid, -6.233788967132568 AS `Estimator` UNION ALL SELECT 9 AS nid, 3.093033790588379 AS `Estimator` UNION ALL SELECT 10 AS nid, 16.23433494567871 AS `Estimator`) AS `Values`), 
`DT_Output_7` AS 
(SELECT `DT_node_lookup_7`.`KEY` AS `KEY`, `DT_node_lookup_7`.node_id_2 AS node_id_2, `DT_node_data_7`.nid AS nid, `DT_node_data_7`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_7` LEFT OUTER JOIN `DT_node_data_7` ON `DT_node_lookup_7`.node_id_2 = `DT_node_data_7`.nid), 
`XGB_Model_7` AS 
(SELECT `DT_Output_7`.`KEY` AS `KEY`, `DT_Output_7`.`Estimator` AS `Estimator` 
FROM `DT_Output_7`), 
`DT_node_lookup_8` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_80` < -0.08977922052145004) THEN CASE WHEN (`ADS`.`Feature_63` < -0.05232740938663483) THEN CASE WHEN (`ADS`.`Feature_71` < -0.08045637607574463) THEN 7 ELSE 8 END ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_59` < 0.035378627479076385) THEN CASE WHEN (`ADS`.`Feature_37` < 0.07651043683290482) THEN 9 ELSE 10 END ELSE CASE WHEN (`ADS`.`Feature_42` < 0.3635293245315552) THEN 11 ELSE 12 END END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_8` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 4 AS nid, 0.6488110423088074 AS `Estimator` UNION ALL SELECT 7 AS nid, -16.728473663330078 AS `Estimator` UNION ALL SELECT 8 AS nid, -8.828224182128906 AS `Estimator` UNION ALL SELECT 9 AS nid, 13.875309944152832 AS `Estimator` UNION ALL SELECT 10 AS nid, 3.6735312938690186 AS `Estimator` UNION ALL SELECT 11 AS nid, -4.748672962188721 AS `Estimator` UNION ALL SELECT 12 AS nid, 5.149220943450928 AS `Estimator`) AS `Values`), 
`DT_Output_8` AS 
(SELECT `DT_node_lookup_8`.`KEY` AS `KEY`, `DT_node_lookup_8`.node_id_2 AS node_id_2, `DT_node_data_8`.nid AS nid, `DT_node_data_8`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_8` LEFT OUTER JOIN `DT_node_data_8` ON `DT_node_lookup_8`.node_id_2 = `DT_node_data_8`.nid), 
`XGB_Model_8` AS 
(SELECT `DT_Output_8`.`KEY` AS `KEY`, `DT_Output_8`.`Estimator` AS `Estimator` 
FROM `DT_Output_8`), 
`DT_node_lookup_9` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_41` < -0.5153412222862244) THEN CASE WHEN (`ADS`.`Feature_80` < 0.07958017289638519) THEN 3 ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_92` < -1.1308966875076294) THEN 5 ELSE CASE WHEN (`ADS`.`Feature_9` < 0.43099725246429443) THEN 7 ELSE 8 END END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_9` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 3 AS nid, -13.433259963989258 AS `Estimator` UNION ALL SELECT 4 AS nid, 0.5465708374977112 AS `Estimator` UNION ALL SELECT 5 AS nid, -4.398776531219482 AS `Estimator` UNION ALL SELECT 7 AS nid, 3.353100299835205 AS `Estimator` UNION ALL SELECT 8 AS nid, 12.32241153717041 AS `Estimator`) AS `Values`), 
`DT_Output_9` AS 
(SELECT `DT_node_lookup_9`.`KEY` AS `KEY`, `DT_node_lookup_9`.node_id_2 AS node_id_2, `DT_node_data_9`.nid AS nid, `DT_node_data_9`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_9` LEFT OUTER JOIN `DT_node_data_9` ON `DT_node_lookup_9`.node_id_2 = `DT_node_data_9`.nid), 
`XGB_Model_9` AS 
(SELECT `DT_Output_9`.`KEY` AS `KEY`, `DT_Output_9`.`Estimator` AS `Estimator` 
FROM `DT_Output_9`)
 SELECT `XGB_B0`.`KEY`, `XGB_B0`.`Estimator` 
FROM (SELECT `XGB_esu_0`.`KEY` AS `KEY`, `XGB_esu_0`.`Estimator` AS `Estimator` 
FROM (SELECT `XGB_Model_0`.`KEY` AS `KEY`, `XGB_Model_0`.`Estimator` AS `Estimator` 
FROM `XGB_Model_0` UNION ALL SELECT `XGB_Model_1`.`KEY` AS `KEY`, `XGB_Model_1`.`Estimator` AS `Estimator` 
FROM `XGB_Model_1` UNION ALL SELECT `XGB_Model_2`.`KEY` AS `KEY`, `XGB_Model_2`.`Estimator` AS `Estimator` 
FROM `XGB_Model_2` UNION ALL SELECT `XGB_Model_3`.`KEY` AS `KEY`, `XGB_Model_3`.`Estimator` AS `Estimator` 
FROM `XGB_Model_3` UNION ALL SELECT `XGB_Model_4`.`KEY` AS `KEY`, `XGB_Model_4`.`Estimator` AS `Estimator` 
FROM `XGB_Model_4` UNION ALL SELECT `XGB_Model_5`.`KEY` AS `KEY`, `XGB_Model_5`.`Estimator` AS `Estimator` 
FROM `XGB_Model_5` UNION ALL SELECT `XGB_Model_6`.`KEY` AS `KEY`, `XGB_Model_6`.`Estimator` AS `Estimator` 
FROM `XGB_Model_6` UNION ALL SELECT `XGB_Model_7`.`KEY` AS `KEY`, `XGB_Model_7`.`Estimator` AS `Estimator` 
FROM `XGB_Model_7` UNION ALL SELECT `XGB_Model_8`.`KEY` AS `KEY`, `XGB_Model_8`.`Estimator` AS `Estimator` 
FROM `XGB_Model_8` UNION ALL SELECT `XGB_Model_9`.`KEY` AS `KEY`, `XGB_Model_9`.`Estimator` AS `Estimator` 
FROM `XGB_Model_9`) AS `XGB_esu_0`) AS `XGB_B0`) AS `U`

-- Code For temporary table TMP_20180516114546_CODEGEN_UGP12U_XGB_B1 part 1. Create 


CREATE TEMPORARY TABLE `TMP_20180516114546_CODEGEN_UGP12U_XGB_B1` (
	`KEY` BIGINT, 
	`Estimator` DOUBLE
)

 ENGINE=MEMORY

-- Code For temporary table TMP_20180516114546_CODEGEN_UGP12U_XGB_B1 part 2. Populate

INSERT INTO `TMP_20180516114546_CODEGEN_UGP12U_XGB_B1` (`KEY`, `Estimator`) SELECT `U`.`KEY`, `U`.`Estimator` 
FROM (WITH `DT_node_lookup_10` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_95` < -0.2972280979156494) THEN CASE WHEN (`ADS`.`Feature_80` < -0.2714426815509796) THEN 3 ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_39` < 0.6278812289237976) THEN CASE WHEN (`ADS`.`Feature_80` < 0.679784893989563) THEN 7 ELSE 8 END ELSE 6 END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_10` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 3 AS nid, -12.652628898620605 AS `Estimator` UNION ALL SELECT 4 AS nid, 0.31296008825302124 AS `Estimator` UNION ALL SELECT 6 AS nid, 10.400899887084961 AS `Estimator` UNION ALL SELECT 7 AS nid, -2.0537214279174805 AS `Estimator` UNION ALL SELECT 8 AS nid, 7.250884532928467 AS `Estimator`) AS `Values`), 
`DT_Output_10` AS 
(SELECT `DT_node_lookup_10`.`KEY` AS `KEY`, `DT_node_lookup_10`.node_id_2 AS node_id_2, `DT_node_data_10`.nid AS nid, `DT_node_data_10`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_10` LEFT OUTER JOIN `DT_node_data_10` ON `DT_node_lookup_10`.node_id_2 = `DT_node_data_10`.nid), 
`XGB_Model_10` AS 
(SELECT `DT_Output_10`.`KEY` AS `KEY`, `DT_Output_10`.`Estimator` AS `Estimator` 
FROM `DT_Output_10`), 
`DT_node_lookup_11` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_41` < -0.5153412222862244) THEN CASE WHEN (`ADS`.`Feature_63` < 0.2756973206996918) THEN 3 ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_49` < 0.43731117248535156) THEN CASE WHEN (`ADS`.`Feature_92` < -0.4292681813240051) THEN 7 ELSE 8 END ELSE 6 END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_11` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 3 AS nid, -11.64395523071289 AS `Estimator` UNION ALL SELECT 4 AS nid, 0.7143625020980835 AS `Estimator` UNION ALL SELECT 6 AS nid, 9.47675895690918 AS `Estimator` UNION ALL SELECT 7 AS nid, -5.33989953994751 AS `Estimator` UNION ALL SELECT 8 AS nid, 4.510807991027832 AS `Estimator`) AS `Values`), 
`DT_Output_11` AS 
(SELECT `DT_node_lookup_11`.`KEY` AS `KEY`, `DT_node_lookup_11`.node_id_2 AS node_id_2, `DT_node_data_11`.nid AS nid, `DT_node_data_11`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_11` LEFT OUTER JOIN `DT_node_data_11` ON `DT_node_lookup_11`.node_id_2 = `DT_node_data_11`.nid), 
`XGB_Model_11` AS 
(SELECT `DT_Output_11`.`KEY` AS `KEY`, `DT_Output_11`.`Estimator` AS `Estimator` 
FROM `DT_Output_11`), 
`DT_node_lookup_12` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_95` < -0.2972280979156494) THEN CASE WHEN (`ADS`.`Feature_41` < -0.2632381319999695) THEN 3 ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_39` < -0.5276219844818115) THEN 5 ELSE CASE WHEN (`ADS`.`Feature_63` < -0.3466222882270813) THEN 7 ELSE 8 END END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_12` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 3 AS nid, -11.679736137390137 AS `Estimator` UNION ALL SELECT 4 AS nid, -0.43651118874549866 AS `Estimator` UNION ALL SELECT 5 AS nid, -2.581087112426758 AS `Estimator` UNION ALL SELECT 7 AS nid, -0.1379074901342392 AS `Estimator` UNION ALL SELECT 8 AS nid, 8.293339729309082 AS `Estimator`) AS `Values`), 
`DT_Output_12` AS 
(SELECT `DT_node_lookup_12`.`KEY` AS `KEY`, `DT_node_lookup_12`.node_id_2 AS node_id_2, `DT_node_data_12`.nid AS nid, `DT_node_data_12`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_12` LEFT OUTER JOIN `DT_node_data_12` ON `DT_node_lookup_12`.node_id_2 = `DT_node_data_12`.nid), 
`XGB_Model_12` AS 
(SELECT `DT_Output_12`.`KEY` AS `KEY`, `DT_Output_12`.`Estimator` AS `Estimator` 
FROM `DT_Output_12`), 
`DT_node_lookup_13` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_80` < 0.19070805609226227) THEN CASE WHEN (`ADS`.`Feature_63` < 0.4683714210987091) THEN CASE WHEN (`ADS`.`Feature_41` < -0.15443572402000427) THEN 7 ELSE 8 END ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_85` < -0.5696703195571899) THEN 5 ELSE CASE WHEN (`ADS`.`Feature_40` < -0.4686127007007599) THEN 9 ELSE 10 END END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_13` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 4 AS nid, 3.4273037910461426 AS `Estimator` UNION ALL SELECT 5 AS nid, -0.30381205677986145 AS `Estimator` UNION ALL SELECT 7 AS nid, -10.537165641784668 AS `Estimator` UNION ALL SELECT 8 AS nid, -3.0081183910369873 AS `Estimator` UNION ALL SELECT 9 AS nid, 11.40748119354248 AS `Estimator` UNION ALL SELECT 10 AS nid, 4.0954670906066895 AS `Estimator`) AS `Values`), 
`DT_Output_13` AS 
(SELECT `DT_node_lookup_13`.`KEY` AS `KEY`, `DT_node_lookup_13`.node_id_2 AS node_id_2, `DT_node_data_13`.nid AS nid, `DT_node_data_13`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_13` LEFT OUTER JOIN `DT_node_data_13` ON `DT_node_lookup_13`.node_id_2 = `DT_node_data_13`.nid), 
`XGB_Model_13` AS 
(SELECT `DT_Output_13`.`KEY` AS `KEY`, `DT_Output_13`.`Estimator` AS `Estimator` 
FROM `DT_Output_13`), 
`DT_node_lookup_14` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_80` < 0.21524569392204285) THEN CASE WHEN (`ADS`.`Feature_63` < 0.4683714210987091) THEN CASE WHEN (`ADS`.`Feature_41` < -0.15443572402000427) THEN 7 ELSE 8 END ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_17` < -0.3528504967689514) THEN 5 ELSE 6 END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_14` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 4 AS nid, 3.1059937477111816 AS `Estimator` UNION ALL SELECT 5 AS nid, 0.13643670082092285 AS `Estimator` UNION ALL SELECT 6 AS nid, 8.293133735656738 AS `Estimator` UNION ALL SELECT 7 AS nid, -9.538908004760742 AS `Estimator` UNION ALL SELECT 8 AS nid, -2.5585989952087402 AS `Estimator`) AS `Values`), 
`DT_Output_14` AS 
(SELECT `DT_node_lookup_14`.`KEY` AS `KEY`, `DT_node_lookup_14`.node_id_2 AS node_id_2, `DT_node_data_14`.nid AS nid, `DT_node_data_14`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_14` LEFT OUTER JOIN `DT_node_data_14` ON `DT_node_lookup_14`.node_id_2 = `DT_node_data_14`.nid), 
`XGB_Model_14` AS 
(SELECT `DT_Output_14`.`KEY` AS `KEY`, `DT_Output_14`.`Estimator` AS `Estimator` 
FROM `DT_Output_14`), 
`DT_node_lookup_15` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_95` < -0.2972280979156494) THEN CASE WHEN (`ADS`.`Feature_63` < -0.05645234137773514) THEN 3 ELSE 4 END ELSE CASE WHEN (`ADS`.`Feature_39` < 0.6278812289237976) THEN CASE WHEN (`ADS`.`Feature_80` < 0.8136154413223267) THEN 7 ELSE 8 END ELSE 6 END END AS node_id_2 
FROM `RandomReg_100` AS `ADS`), 
`DT_node_data_15` AS 
(SELECT `Values`.nid AS nid, CAST(`Values`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT 3 AS nid, -8.579630851745605 AS `Estimator` UNION ALL SELECT 4 AS nid, 0.4133908748626709 AS `Estimator` UNION ALL SELECT 6 AS nid, 7.813511848449707 AS `Estimator` UNION ALL SELECT 7 AS nid, -1.6575729846954346 AS `Estimator` UNION ALL SELECT 8 AS nid, 5.987321853637695 AS `Estimator`) AS `Values`), 
`DT_Output_15` AS 
(SELECT `DT_node_lookup_15`.`KEY` AS `KEY`, `DT_node_lookup_15`.node_id_2 AS node_id_2, `DT_node_data_15`.nid AS nid, `DT_node_data_15`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_15` LEFT OUTER JOIN `DT_node_data_15` ON `DT_node_lookup_15`.node_id_2 = `DT_node_data_15`.nid), 
`XGB_Model_15` AS 
(SELECT `DT_Output_15`.`KEY` AS `KEY`, `DT_Output_15`.`Estimator` AS `Estimator` 
FROM `DT_Output_15`)
 SELECT `XGB_B1`.`KEY`, `XGB_B1`.`Estimator` 
FROM (SELECT `XGB_esu_1`.`KEY` AS `KEY`, `XGB_esu_1`.`Estimator` AS `Estimator` 
FROM (SELECT `XGB_Model_10`.`KEY` AS `KEY`, `XGB_Model_10`.`Estimator` AS `Estimator` 
FROM `XGB_Model_10` UNION ALL SELECT `XGB_Model_11`.`KEY` AS `KEY`, `XGB_Model_11`.`Estimator` AS `Estimator` 
FROM `XGB_Model_11` UNION ALL SELECT `XGB_Model_12`.`KEY` AS `KEY`, `XGB_Model_12`.`Estimator` AS `Estimator` 
FROM `XGB_Model_12` UNION ALL SELECT `XGB_Model_13`.`KEY` AS `KEY`, `XGB_Model_13`.`Estimator` AS `Estimator` 
FROM `XGB_Model_13` UNION ALL SELECT `XGB_Model_14`.`KEY` AS `KEY`, `XGB_Model_14`.`Estimator` AS `Estimator` 
FROM `XGB_Model_14` UNION ALL SELECT `XGB_Model_15`.`KEY` AS `KEY`, `XGB_Model_15`.`Estimator` AS `Estimator` 
FROM `XGB_Model_15`) AS `XGB_esu_1`) AS `XGB_B1`) AS `U`

-- Code For temporary table TMP_20180516114546_CODEGEN_2TM7NK_XGB_sum part 1. Create 


CREATE TEMPORARY TABLE `TMP_20180516114546_CODEGEN_2TM7NK_XGB_sum` (
	`KEY` BIGINT NOT NULL, 
	`Estimator` DOUBLE, 
	PRIMARY KEY (`KEY`)
)

 ENGINE=MEMORY

-- Code For temporary table TMP_20180516114546_CODEGEN_2TM7NK_XGB_sum part 2. Populate

INSERT INTO `TMP_20180516114546_CODEGEN_2TM7NK_XGB_sum` (`KEY`, `Estimator`) SELECT `U`.`KEY`, `U`.`Estimator` 
FROM (WITH `XGB_Union` AS 
(SELECT `XGB_EnsembleUnion`.`KEY` AS `KEY`, `XGB_EnsembleUnion`.`Estimator` AS `Estimator` 
FROM (SELECT `XGB_B0`.`KEY` AS `KEY`, `XGB_B0`.`Estimator` AS `Estimator` 
FROM `TMP_20180516114546_CODEGEN_C6XZBJ_XGB_B0` AS `XGB_B0` UNION ALL SELECT `XGB_B1`.`KEY` AS `KEY`, `XGB_B1`.`Estimator` AS `Estimator` 
FROM `TMP_20180516114546_CODEGEN_UGP12U_XGB_B1` AS `XGB_B1`) AS `XGB_EnsembleUnion`)
 SELECT `XGB_sum`.`KEY`, `XGB_sum`.`Estimator` 
FROM (SELECT `T`.`KEY` AS `KEY`, CAST(`T`.`Estimator` AS DOUBLE) AS `Estimator` 
FROM (SELECT `XGB_Union`.`KEY` AS `KEY`, sum(`XGB_Union`.`Estimator`) AS `Estimator` 
FROM `XGB_Union` GROUP BY `XGB_Union`.`KEY`) AS `T`) AS `XGB_sum`) AS `U`

-- Code For temporary table TMP_20180516114546_CODEGEN_2TM7NK_XGB_sum part 3. Create Index 

CREATE INDEX `ix_TMP_20180516114546_CODEGEN_2TM7NK_XGB_sum_KEY` ON `TMP_20180516114546_CODEGEN_2TM7NK_XGB_sum` (`KEY`)

-- Model deployment code

SELECT `XGB_sum`.`KEY` AS `KEY`, `XGB_sum`.`Estimator` + 0.5 AS `Estimator` 
FROM `TMP_20180516114546_CODEGEN_2TM7NK_XGB_sum` AS `XGB_sum`