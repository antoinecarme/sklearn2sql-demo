-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : SVC_linear
-- Dataset : FourClass_10
-- Database : teradata


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Code For temporary table tmp_20180602143429_mqu_kernagg_b0 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143429_mqu_kernagg_b0  (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE PRECISION
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143429_mqu_kernagg_b0 part 2. Populate

INSERT INTO tmp_20180602143429_mqu_kernagg_b0 ("KEY", "OVO_Class1", "OVO_Class2", "OVO_Decision", "OVO_Conf") SELECT "U"."KEY", "U"."OVO_Class1", "U"."OVO_Class2", "U"."OVO_Decision", "U"."OVO_Conf" 
FROM (WITH kernel_input AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE PRECISION) AS "Feature_0", CAST("ADS"."Feature_1" AS DOUBLE PRECISION) AS "Feature_1", CAST("ADS"."Feature_2" AS DOUBLE PRECISION) AS "Feature_2", CAST("ADS"."Feature_3" AS DOUBLE PRECISION) AS "Feature_3", CAST("ADS"."Feature_4" AS DOUBLE PRECISION) AS "Feature_4", CAST("ADS"."Feature_5" AS DOUBLE PRECISION) AS "Feature_5", CAST("ADS"."Feature_6" AS DOUBLE PRECISION) AS "Feature_6", CAST("ADS"."Feature_7" AS DOUBLE PRECISION) AS "Feature_7", CAST("ADS"."Feature_8" AS DOUBLE PRECISION) AS "Feature_8", CAST("ADS"."Feature_9" AS DOUBLE PRECISION) AS "Feature_9", CAST("ADS"."TGT" AS DOUBLE PRECISION) AS "TGT" 
FROM "FourClass_10" AS "ADS"), 
dummy_cte AS 
(SELECT CAST(0.0 AS DOUBLE PRECISION) AS "X"), 
"SV_data_0_1" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE PRECISION) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE PRECISION) AS sv_0, CAST("Values".sv_1 AS DOUBLE PRECISION) AS sv_1, CAST("Values".sv_2 AS DOUBLE PRECISION) AS sv_2, CAST("Values".sv_3 AS DOUBLE PRECISION) AS sv_3, CAST("Values".sv_4 AS DOUBLE PRECISION) AS sv_4, CAST("Values".sv_5 AS DOUBLE PRECISION) AS sv_5, CAST("Values".sv_6 AS DOUBLE PRECISION) AS sv_6, CAST("Values".sv_7 AS DOUBLE PRECISION) AS sv_7, CAST("Values".sv_8 AS DOUBLE PRECISION) AS sv_8, CAST("Values".sv_9 AS DOUBLE PRECISION) AS sv_9 
FROM (SELECT 0 AS sv_idx, CAST(0.000328852838187 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.947598012521973 AS DOUBLE PRECISION) AS sv_0, CAST(-0.964306420204744 AS DOUBLE PRECISION) AS sv_1, CAST(2.155773785219882 AS DOUBLE PRECISION) AS sv_2, CAST(1.161788643602634 AS DOUBLE PRECISION) AS sv_3, CAST(2.259484322098266 AS DOUBLE PRECISION) AS sv_4, CAST(-1.363122165456921 AS DOUBLE PRECISION) AS sv_5, CAST(-0.567040154048362 AS DOUBLE PRECISION) AS sv_6, CAST(1.064763318975707 AS DOUBLE PRECISION) AS sv_7, CAST(-0.901723878924819 AS DOUBLE PRECISION) AS sv_8, CAST(0.629911630159176 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 1 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.501049774810359 AS DOUBLE PRECISION) AS sv_0, CAST(-0.596190161513311 AS DOUBLE PRECISION) AS sv_1, CAST(-0.322133522472416 AS DOUBLE PRECISION) AS sv_2, CAST(-1.093693306132184 AS DOUBLE PRECISION) AS sv_3, CAST(-0.693695436549092 AS DOUBLE PRECISION) AS sv_4, CAST(-0.06504197370882 AS DOUBLE PRECISION) AS sv_5, CAST(0.412455701691278 AS DOUBLE PRECISION) AS sv_6, CAST(-0.835510460407414 AS DOUBLE PRECISION) AS sv_7, CAST(0.247959867435887 AS DOUBLE PRECISION) AS sv_8, CAST(2.614818878550584 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 2 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.731997715261604 AS DOUBLE PRECISION) AS sv_0, CAST(-0.656676772961274 AS DOUBLE PRECISION) AS sv_1, CAST(0.469655166626363 AS DOUBLE PRECISION) AS sv_2, CAST(0.501273915016597 AS DOUBLE PRECISION) AS sv_3, CAST(-0.085786095263703 AS DOUBLE PRECISION) AS sv_4, CAST(0.231390795551295 AS DOUBLE PRECISION) AS sv_5, CAST(-0.374617044234245 AS DOUBLE PRECISION) AS sv_6, CAST(1.063850356375259 AS DOUBLE PRECISION) AS sv_7, CAST(0.805366893216856 AS DOUBLE PRECISION) AS sv_8, CAST(-0.485988492097471 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 3 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.760485454596022 AS DOUBLE PRECISION) AS sv_0, CAST(-1.502020411528053 AS DOUBLE PRECISION) AS sv_1, CAST(-0.060961804509021 AS DOUBLE PRECISION) AS sv_2, CAST(-1.14772070089846 AS DOUBLE PRECISION) AS sv_3, CAST(0.456107072554643 AS DOUBLE PRECISION) AS sv_4, CAST(0.135780203515399 AS DOUBLE PRECISION) AS sv_5, CAST(0.31155055276143 AS DOUBLE PRECISION) AS sv_6, CAST(0.572721322772484 AS DOUBLE PRECISION) AS sv_7, CAST(-0.48017811399064 AS DOUBLE PRECISION) AS sv_8, CAST(0.112949399265271 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 4 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-1.622625438296457 AS DOUBLE PRECISION) AS sv_0, CAST(-0.759668380229279 AS DOUBLE PRECISION) AS sv_1, CAST(-0.470315254555039 AS DOUBLE PRECISION) AS sv_2, CAST(-0.346907110598383 AS DOUBLE PRECISION) AS sv_3, CAST(-1.170431020982439 AS DOUBLE PRECISION) AS sv_4, CAST(0.86508363385815 AS DOUBLE PRECISION) AS sv_5, CAST(-0.05783750341403 AS DOUBLE PRECISION) AS sv_6, CAST(0.74094877905919 AS DOUBLE PRECISION) AS sv_7, CAST(-0.977958419350837 AS DOUBLE PRECISION) AS sv_8, CAST(-0.131874231036755 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 5 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.761397272856422 AS DOUBLE PRECISION) AS sv_0, CAST(1.497622761800882 AS DOUBLE PRECISION) AS sv_1, CAST(-1.310008913184782 AS DOUBLE PRECISION) AS sv_2, CAST(-1.399082774382091 AS DOUBLE PRECISION) AS sv_3, CAST(1.428589673725849 AS DOUBLE PRECISION) AS sv_4, CAST(0.083561590715411 AS DOUBLE PRECISION) AS sv_5, CAST(1.016272602659387 AS DOUBLE PRECISION) AS sv_6, CAST(-1.882003086352109 AS DOUBLE PRECISION) AS sv_7, CAST(0.664799705649394 AS DOUBLE PRECISION) AS sv_8, CAST(1.270641951361375 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 6 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.363416926383829 AS DOUBLE PRECISION) AS sv_0, CAST(0.7380946344925 AS DOUBLE PRECISION) AS sv_1, CAST(-1.678061770884348 AS DOUBLE PRECISION) AS sv_2, CAST(-0.887322308013405 AS DOUBLE PRECISION) AS sv_3, CAST(0.719486469440514 AS DOUBLE PRECISION) AS sv_4, CAST(-0.016060972879918 AS DOUBLE PRECISION) AS sv_5, CAST(0.518055042935235 AS DOUBLE PRECISION) AS sv_6, CAST(0.430950067776268 AS DOUBLE PRECISION) AS sv_7, CAST(0.615167979407533 AS DOUBLE PRECISION) AS sv_8, CAST(-0.221530659441987 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 7 AS sv_idx, CAST(0.309722199276389 AS DOUBLE PRECISION) AS dual_coeff, CAST(-2.005925047177862 AS DOUBLE PRECISION) AS sv_0, CAST(2.845674045044503 AS DOUBLE PRECISION) AS sv_1, CAST(-2.362907056590556 AS DOUBLE PRECISION) AS sv_2, CAST(-1.22481267287389 AS DOUBLE PRECISION) AS sv_3, CAST(2.300436326577796 AS DOUBLE PRECISION) AS sv_4, CAST(-1.183702222518716 AS DOUBLE PRECISION) AS sv_5, CAST(1.149504587617434 AS DOUBLE PRECISION) AS sv_6, CAST(-1.456471132667488 AS DOUBLE PRECISION) AS sv_7, CAST(3.070620490630201 AS DOUBLE PRECISION) AS sv_8, CAST(0.331992174863624 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 8 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.886266325029851 AS DOUBLE PRECISION) AS sv_0, CAST(-0.365906895382019 AS DOUBLE PRECISION) AS sv_1, CAST(-0.249704995709357 AS DOUBLE PRECISION) AS sv_2, CAST(0.437587372701161 AS DOUBLE PRECISION) AS sv_3, CAST(0.596417834647446 AS DOUBLE PRECISION) AS sv_4, CAST(-0.398644937160245 AS DOUBLE PRECISION) AS sv_5, CAST(-0.31649986582031 AS DOUBLE PRECISION) AS sv_6, CAST(2.028875965999351 AS DOUBLE PRECISION) AS sv_7, CAST(-0.81831930171055 AS DOUBLE PRECISION) AS sv_8, CAST(-1.322897896328765 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 9 AS sv_idx, CAST(0.275769902694515 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.583422676885443 AS DOUBLE PRECISION) AS sv_0, CAST(0.957021248759702 AS DOUBLE PRECISION) AS sv_1, CAST(0.302573623470522 AS DOUBLE PRECISION) AS sv_2, CAST(-1.234343473537793 AS DOUBLE PRECISION) AS sv_3, CAST(1.020503343612735 AS DOUBLE PRECISION) AS sv_4, CAST(-0.260498566987446 AS DOUBLE PRECISION) AS sv_5, CAST(0.937998335121495 AS DOUBLE PRECISION) AS sv_6, CAST(-3.627183375067522 AS DOUBLE PRECISION) AS sv_7, CAST(-0.248179493236782 AS DOUBLE PRECISION) AS sv_8, CAST(1.188145862385599 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 10 AS sv_idx, CAST(0.225268171939328 AS DOUBLE PRECISION) AS dual_coeff, CAST(-2.008322049942688 AS DOUBLE PRECISION) AS sv_0, CAST(0.64560303672471 AS DOUBLE PRECISION) AS sv_1, CAST(-0.644199123074621 AS DOUBLE PRECISION) AS sv_2, CAST(0.153841086912192 AS DOUBLE PRECISION) AS sv_3, CAST(1.551762915758032 AS DOUBLE PRECISION) AS sv_4, CAST(-0.286080252964044 AS DOUBLE PRECISION) AS sv_5, CAST(0.053873553267069 AS DOUBLE PRECISION) AS sv_6, CAST(1.112552517400386 AS DOUBLE PRECISION) AS sv_7, CAST(0.786512492701302 AS DOUBLE PRECISION) AS sv_8, CAST(1.36879310667777 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 11 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(2.810770228151144 AS DOUBLE PRECISION) AS sv_0, CAST(-0.201158831548198 AS DOUBLE PRECISION) AS sv_1, CAST(-1.507667890140605 AS DOUBLE PRECISION) AS sv_2, CAST(-1.638094132150707 AS DOUBLE PRECISION) AS sv_3, CAST(-0.340941107273218 AS DOUBLE PRECISION) AS sv_4, CAST(-0.234873636351903 AS DOUBLE PRECISION) AS sv_5, CAST(0.701031172677405 AS DOUBLE PRECISION) AS sv_6, CAST(-0.270023389945754 AS DOUBLE PRECISION) AS sv_7, CAST(1.996147651770403 AS DOUBLE PRECISION) AS sv_8, CAST(0.8693112756684 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 12 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.168261988037994 AS DOUBLE PRECISION) AS sv_0, CAST(-0.231802161756199 AS DOUBLE PRECISION) AS sv_1, CAST(1.21796040423015 AS DOUBLE PRECISION) AS sv_2, CAST(1.483200645687304 AS DOUBLE PRECISION) AS sv_3, CAST(0.854260454302263 AS DOUBLE PRECISION) AS sv_4, CAST(-0.387010233853507 AS DOUBLE PRECISION) AS sv_5, CAST(-0.716935868035528 AS DOUBLE PRECISION) AS sv_6, CAST(1.380221074796965 AS DOUBLE PRECISION) AS sv_7, CAST(-0.75428256920248 AS DOUBLE PRECISION) AS sv_8, CAST(-1.753119623650515 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 13 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.604295155104202 AS DOUBLE PRECISION) AS sv_0, CAST(-1.053307032668267 AS DOUBLE PRECISION) AS sv_1, CAST(0.295948311199612 AS DOUBLE PRECISION) AS sv_2, CAST(0.20667994839922 AS DOUBLE PRECISION) AS sv_3, CAST(0.09345472486932 AS DOUBLE PRECISION) AS sv_4, CAST(0.433591560637776 AS DOUBLE PRECISION) AS sv_5, CAST(-0.308688088583257 AS DOUBLE PRECISION) AS sv_6, CAST(1.518288966818283 AS DOUBLE PRECISION) AS sv_7, CAST(1.209321437249917 AS DOUBLE PRECISION) AS sv_8, CAST(0.515610598609226 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 14 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.629257184949878 AS DOUBLE PRECISION) AS sv_0, CAST(1.61290186830246 AS DOUBLE PRECISION) AS sv_1, CAST(-0.001256620853366 AS DOUBLE PRECISION) AS sv_2, CAST(1.224914794167675 AS DOUBLE PRECISION) AS sv_3, CAST(0.161250826728139 AS DOUBLE PRECISION) AS sv_4, CAST(0.435055795643038 AS DOUBLE PRECISION) AS sv_5, CAST(-0.313050938259077 AS DOUBLE PRECISION) AS sv_6, CAST(-0.200373484555756 AS DOUBLE PRECISION) AS sv_7, CAST(1.020498192809712 AS DOUBLE PRECISION) AS sv_8, CAST(0.502325828918589 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 15 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.502667491441903 AS DOUBLE PRECISION) AS sv_0, CAST(2.24343377461446 AS DOUBLE PRECISION) AS sv_1, CAST(-0.68281529749554 AS DOUBLE PRECISION) AS sv_2, CAST(0.750218462509449 AS DOUBLE PRECISION) AS sv_3, CAST(1.493763045699863 AS DOUBLE PRECISION) AS sv_4, CAST(-0.34013734463915 AS DOUBLE PRECISION) AS sv_5, CAST(0.067493858211081 AS DOUBLE PRECISION) AS sv_6, CAST(-0.219722113167559 AS DOUBLE PRECISION) AS sv_7, CAST(0.740963770035668 AS DOUBLE PRECISION) AS sv_8, CAST(-1.105790583631475 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 16 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.463949979402301 AS DOUBLE PRECISION) AS sv_0, CAST(2.684104588576153 AS DOUBLE PRECISION) AS sv_1, CAST(-1.333164862031727 AS DOUBLE PRECISION) AS sv_2, CAST(1.832576776928172 AS DOUBLE PRECISION) AS sv_3, CAST(-1.67203697184364 AS DOUBLE PRECISION) AS sv_4, CAST(0.110983645334723 AS DOUBLE PRECISION) AS sv_5, CAST(-0.595534634403866 AS DOUBLE PRECISION) AS sv_6, CAST(0.547026927091312 AS DOUBLE PRECISION) AS sv_7, CAST(1.01971405964078 AS DOUBLE PRECISION) AS sv_8, CAST(-1.426588063900455 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 17 AS sv_idx, CAST(-0.534881271981973 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.608032628452502 AS DOUBLE PRECISION) AS sv_0, CAST(0.313089765108707 AS DOUBLE PRECISION) AS sv_1, CAST(0.721979720680206 AS DOUBLE PRECISION) AS sv_2, CAST(1.192551632100606 AS DOUBLE PRECISION) AS sv_3, CAST(0.426011491180697 AS DOUBLE PRECISION) AS sv_4, CAST(-2.019076907942007 AS DOUBLE PRECISION) AS sv_5, CAST(-0.501255545318046 AS DOUBLE PRECISION) AS sv_6, CAST(0.649553953206439 AS DOUBLE PRECISION) AS sv_7, CAST(-0.80036730534689 AS DOUBLE PRECISION) AS sv_8, CAST(-0.200862044148103 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 18 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.459523687179593 AS DOUBLE PRECISION) AS sv_0, CAST(2.297718186877674 AS DOUBLE PRECISION) AS sv_1, CAST(0.257620422852261 AS DOUBLE PRECISION) AS sv_2, CAST(3.260725404429864 AS DOUBLE PRECISION) AS sv_3, CAST(-0.438872353967862 AS DOUBLE PRECISION) AS sv_4, CAST(-0.536216408533669 AS DOUBLE PRECISION) AS sv_5, CAST(-1.269463881964628 AS DOUBLE PRECISION) AS sv_6, CAST(1.63544705796198 AS DOUBLE PRECISION) AS sv_7, CAST(-1.277994412610604 AS DOUBLE PRECISION) AS sv_8, CAST(1.43629280498466 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 19 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.005572703655875 AS DOUBLE PRECISION) AS sv_0, CAST(2.308181057340788 AS DOUBLE PRECISION) AS sv_1, CAST(3.651855414298892 AS DOUBLE PRECISION) AS sv_2, CAST(7.30307216309809 AS DOUBLE PRECISION) AS sv_3, CAST(-3.750315814533895 AS DOUBLE PRECISION) AS sv_4, CAST(-1.189570689903679 AS DOUBLE PRECISION) AS sv_5, CAST(-3.280717993715776 AS DOUBLE PRECISION) AS sv_6, CAST(1.546094534719291 AS DOUBLE PRECISION) AS sv_7, CAST(0.19378283133607 AS DOUBLE PRECISION) AS sv_8, CAST(0.216365191728417 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 20 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.707345853261733 AS DOUBLE PRECISION) AS sv_0, CAST(1.277402038245135 AS DOUBLE PRECISION) AS sv_1, CAST(0.362828015755179 AS DOUBLE PRECISION) AS sv_2, CAST(3.375831172834355 AS DOUBLE PRECISION) AS sv_3, CAST(-1.13003668545944 AS DOUBLE PRECISION) AS sv_4, CAST(-0.527303437893496 AS DOUBLE PRECISION) AS sv_5, CAST(-1.566191239527718 AS DOUBLE PRECISION) AS sv_6, CAST(2.872921317009621 AS DOUBLE PRECISION) AS sv_7, CAST(-1.135143383507464 AS DOUBLE PRECISION) AS sv_8, CAST(0.737556975240543 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 21 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.381302698650035 AS DOUBLE PRECISION) AS sv_0, CAST(0.142894275019143 AS DOUBLE PRECISION) AS sv_1, CAST(1.766774815777937 AS DOUBLE PRECISION) AS sv_2, CAST(2.235787179574087 AS DOUBLE PRECISION) AS sv_3, CAST(1.616160804871235 AS DOUBLE PRECISION) AS sv_4, CAST(-0.597973382691771 AS DOUBLE PRECISION) AS sv_5, CAST(-0.969472400216295 AS DOUBLE PRECISION) AS sv_6, CAST(1.609333047616631 AS DOUBLE PRECISION) AS sv_7, CAST(0.143574433900628 AS DOUBLE PRECISION) AS sv_8, CAST(-0.242824068812346 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 22 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-1.270142172271626 AS DOUBLE PRECISION) AS sv_0, CAST(1.397600297456189 AS DOUBLE PRECISION) AS sv_1, CAST(0.053460651128554 AS DOUBLE PRECISION) AS sv_2, CAST(1.640976043106811 AS DOUBLE PRECISION) AS sv_3, CAST(0.564307121751988 AS DOUBLE PRECISION) AS sv_4, CAST(1.456377543159662 AS DOUBLE PRECISION) AS sv_5, CAST(-0.565749372117931 AS DOUBLE PRECISION) AS sv_6, CAST(0.966704046659169 AS DOUBLE PRECISION) AS sv_7, CAST(0.617244297737013 AS DOUBLE PRECISION) AS sv_8, CAST(0.552805168880046 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 23 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.36214192469288 AS DOUBLE PRECISION) AS sv_0, CAST(1.148551055104887 AS DOUBLE PRECISION) AS sv_1, CAST(0.381384199135603 AS DOUBLE PRECISION) AS sv_2, CAST(1.833834725170746 AS DOUBLE PRECISION) AS sv_3, CAST(-0.766983073167534 AS DOUBLE PRECISION) AS sv_4, CAST(-0.419320738816896 AS DOUBLE PRECISION) AS sv_5, CAST(-0.742584426392529 AS DOUBLE PRECISION) AS sv_6, CAST(0.493851471811817 AS DOUBLE PRECISION) AS sv_7, CAST(0.547080062802479 AS DOUBLE PRECISION) AS sv_8, CAST(-1.273868108974052 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 24 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.12240188653635 AS DOUBLE PRECISION) AS sv_0, CAST(1.519619083048972 AS DOUBLE PRECISION) AS sv_1, CAST(-0.299666316236091 AS DOUBLE PRECISION) AS sv_2, CAST(1.543376365851341 AS DOUBLE PRECISION) AS sv_3, CAST(-1.092618337480973 AS DOUBLE PRECISION) AS sv_4, CAST(0.858729406740151 AS DOUBLE PRECISION) AS sv_5, CAST(-0.576870481186498 AS DOUBLE PRECISION) AS sv_6, CAST(0.381639848946456 AS DOUBLE PRECISION) AS sv_7, CAST(-1.490139684399622 AS DOUBLE PRECISION) AS sv_8, CAST(-0.197535430352856 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 25 AS sv_idx, CAST(-0.276207854766446 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.513567547036479 AS DOUBLE PRECISION) AS sv_0, CAST(-1.499522139254715 AS DOUBLE PRECISION) AS sv_1, CAST(3.681000724546332 AS DOUBLE PRECISION) AS sv_2, CAST(1.609309028081592 AS DOUBLE PRECISION) AS sv_3, CAST(0.024684048707125 AS DOUBLE PRECISION) AS sv_4, CAST(1.09653515269854 AS DOUBLE PRECISION) AS sv_5, CAST(-0.870556030109111 AS DOUBLE PRECISION) AS sv_6, CAST(-0.938180404630373 AS DOUBLE PRECISION) AS sv_7, CAST(-0.320582689182142 AS DOUBLE PRECISION) AS sv_8, CAST(1.46903207688595 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 26 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.937809821356064 AS DOUBLE PRECISION) AS sv_0, CAST(2.063038682551624 AS DOUBLE PRECISION) AS sv_1, CAST(1.799702287317565 AS DOUBLE PRECISION) AS sv_2, CAST(5.775992485862361 AS DOUBLE PRECISION) AS sv_3, CAST(-2.766395871746766 AS DOUBLE PRECISION) AS sv_4, CAST(-0.757307886484841 AS DOUBLE PRECISION) AS sv_5, CAST(-2.632248226618178 AS DOUBLE PRECISION) AS sv_6, CAST(2.753067320210772 AS DOUBLE PRECISION) AS sv_7, CAST(1.900964596518774 AS DOUBLE PRECISION) AS sv_8, CAST(-1.363738338668413 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte) AS "Values"), 
kernel_dp_0_1 AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(CAST(full_join_data_sv.dot_prod1 AS DOUBLE PRECISION)) + CAST(1.094531311701186 AS DOUBLE PRECISION) AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_0_1".dual_coeff * (kernel_input."Feature_0" * "SV_data_0_1".sv_0 + kernel_input."Feature_1" * "SV_data_0_1".sv_1 + kernel_input."Feature_2" * "SV_data_0_1".sv_2 + kernel_input."Feature_3" * "SV_data_0_1".sv_3 + kernel_input."Feature_4" * "SV_data_0_1".sv_4 + kernel_input."Feature_5" * "SV_data_0_1".sv_5 + kernel_input."Feature_6" * "SV_data_0_1".sv_6 + kernel_input."Feature_7" * "SV_data_0_1".sv_7 + kernel_input."Feature_8" * "SV_data_0_1".sv_8 + kernel_input."Feature_9" * "SV_data_0_1".sv_9) AS dot_prod1 
FROM kernel_input, "SV_data_0_1") AS full_join_data_sv GROUP BY full_join_data_sv."KEY") AS t), 
kernel_cte_0_1 AS 
(SELECT kernel_dp_0_1."KEY" AS "KEY", 0 AS "OVO_Class1", 1 AS "OVO_Class2", CASE WHEN (-kernel_dp_0_1.dot_product >= CAST(0.0 AS DOUBLE PRECISION)) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_0_1.dot_product, CAST(1.0 AS DOUBLE PRECISION) / (CAST(1.0 AS DOUBLE PRECISION) + exp(least(greatest(-CAST(100.0 AS DOUBLE PRECISION), -(-((-kernel_dp_0_1.dot_product) * CAST(-0.806966870514634 AS DOUBLE PRECISION) + CAST(-0.133214496311468 AS DOUBLE PRECISION)))), CAST(100.0 AS DOUBLE PRECISION))))) AS "OVO_Conf" 
FROM kernel_dp_0_1)
 SELECT "KernAgg_B0"."KEY", "KernAgg_B0"."OVO_Class1", "KernAgg_B0"."OVO_Class2", "KernAgg_B0"."OVO_Decision", "KernAgg_B0"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_0"."KEY" AS "KEY", "KernAgg_esu_0"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_0"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_0"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_0"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_0_1."KEY" AS "KEY", kernel_cte_0_1."OVO_Class1" AS "OVO_Class1", kernel_cte_0_1."OVO_Class2" AS "OVO_Class2", kernel_cte_0_1."OVO_Decision" AS "OVO_Decision", kernel_cte_0_1."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_0_1) AS "KernAgg_esu_0") AS "KernAgg_B0") AS "U"

-- Code For temporary table tmp_20180602143429_r6c_kernagg_b1 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143429_r6c_kernagg_b1  (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE PRECISION
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143429_r6c_kernagg_b1 part 2. Populate

INSERT INTO tmp_20180602143429_r6c_kernagg_b1 ("KEY", "OVO_Class1", "OVO_Class2", "OVO_Decision", "OVO_Conf") SELECT "U"."KEY", "U"."OVO_Class1", "U"."OVO_Class2", "U"."OVO_Decision", "U"."OVO_Conf" 
FROM (WITH kernel_input AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE PRECISION) AS "Feature_0", CAST("ADS"."Feature_1" AS DOUBLE PRECISION) AS "Feature_1", CAST("ADS"."Feature_2" AS DOUBLE PRECISION) AS "Feature_2", CAST("ADS"."Feature_3" AS DOUBLE PRECISION) AS "Feature_3", CAST("ADS"."Feature_4" AS DOUBLE PRECISION) AS "Feature_4", CAST("ADS"."Feature_5" AS DOUBLE PRECISION) AS "Feature_5", CAST("ADS"."Feature_6" AS DOUBLE PRECISION) AS "Feature_6", CAST("ADS"."Feature_7" AS DOUBLE PRECISION) AS "Feature_7", CAST("ADS"."Feature_8" AS DOUBLE PRECISION) AS "Feature_8", CAST("ADS"."Feature_9" AS DOUBLE PRECISION) AS "Feature_9", CAST("ADS"."TGT" AS DOUBLE PRECISION) AS "TGT" 
FROM "FourClass_10" AS "ADS"), 
dummy_cte AS 
(SELECT CAST(0.0 AS DOUBLE PRECISION) AS "X"), 
"SV_data_0_2" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE PRECISION) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE PRECISION) AS sv_0, CAST("Values".sv_1 AS DOUBLE PRECISION) AS sv_1, CAST("Values".sv_2 AS DOUBLE PRECISION) AS sv_2, CAST("Values".sv_3 AS DOUBLE PRECISION) AS sv_3, CAST("Values".sv_4 AS DOUBLE PRECISION) AS sv_4, CAST("Values".sv_5 AS DOUBLE PRECISION) AS sv_5, CAST("Values".sv_6 AS DOUBLE PRECISION) AS sv_6, CAST("Values".sv_7 AS DOUBLE PRECISION) AS sv_7, CAST("Values".sv_8 AS DOUBLE PRECISION) AS sv_8, CAST("Values".sv_9 AS DOUBLE PRECISION) AS sv_9 
FROM (SELECT 0 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.947598012521973 AS DOUBLE PRECISION) AS sv_0, CAST(-0.964306420204744 AS DOUBLE PRECISION) AS sv_1, CAST(2.155773785219882 AS DOUBLE PRECISION) AS sv_2, CAST(1.161788643602634 AS DOUBLE PRECISION) AS sv_3, CAST(2.259484322098266 AS DOUBLE PRECISION) AS sv_4, CAST(-1.363122165456921 AS DOUBLE PRECISION) AS sv_5, CAST(-0.567040154048362 AS DOUBLE PRECISION) AS sv_6, CAST(1.064763318975707 AS DOUBLE PRECISION) AS sv_7, CAST(-0.901723878924819 AS DOUBLE PRECISION) AS sv_8, CAST(0.629911630159176 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 1 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.501049774810359 AS DOUBLE PRECISION) AS sv_0, CAST(-0.596190161513311 AS DOUBLE PRECISION) AS sv_1, CAST(-0.322133522472416 AS DOUBLE PRECISION) AS sv_2, CAST(-1.093693306132184 AS DOUBLE PRECISION) AS sv_3, CAST(-0.693695436549092 AS DOUBLE PRECISION) AS sv_4, CAST(-0.06504197370882 AS DOUBLE PRECISION) AS sv_5, CAST(0.412455701691278 AS DOUBLE PRECISION) AS sv_6, CAST(-0.835510460407414 AS DOUBLE PRECISION) AS sv_7, CAST(0.247959867435887 AS DOUBLE PRECISION) AS sv_8, CAST(2.614818878550584 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 2 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.731997715261604 AS DOUBLE PRECISION) AS sv_0, CAST(-0.656676772961274 AS DOUBLE PRECISION) AS sv_1, CAST(0.469655166626363 AS DOUBLE PRECISION) AS sv_2, CAST(0.501273915016597 AS DOUBLE PRECISION) AS sv_3, CAST(-0.085786095263703 AS DOUBLE PRECISION) AS sv_4, CAST(0.231390795551295 AS DOUBLE PRECISION) AS sv_5, CAST(-0.374617044234245 AS DOUBLE PRECISION) AS sv_6, CAST(1.063850356375259 AS DOUBLE PRECISION) AS sv_7, CAST(0.805366893216856 AS DOUBLE PRECISION) AS sv_8, CAST(-0.485988492097471 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 3 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.760485454596022 AS DOUBLE PRECISION) AS sv_0, CAST(-1.502020411528053 AS DOUBLE PRECISION) AS sv_1, CAST(-0.060961804509021 AS DOUBLE PRECISION) AS sv_2, CAST(-1.14772070089846 AS DOUBLE PRECISION) AS sv_3, CAST(0.456107072554643 AS DOUBLE PRECISION) AS sv_4, CAST(0.135780203515399 AS DOUBLE PRECISION) AS sv_5, CAST(0.31155055276143 AS DOUBLE PRECISION) AS sv_6, CAST(0.572721322772484 AS DOUBLE PRECISION) AS sv_7, CAST(-0.48017811399064 AS DOUBLE PRECISION) AS sv_8, CAST(0.112949399265271 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 4 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-1.622625438296457 AS DOUBLE PRECISION) AS sv_0, CAST(-0.759668380229279 AS DOUBLE PRECISION) AS sv_1, CAST(-0.470315254555039 AS DOUBLE PRECISION) AS sv_2, CAST(-0.346907110598383 AS DOUBLE PRECISION) AS sv_3, CAST(-1.170431020982439 AS DOUBLE PRECISION) AS sv_4, CAST(0.86508363385815 AS DOUBLE PRECISION) AS sv_5, CAST(-0.05783750341403 AS DOUBLE PRECISION) AS sv_6, CAST(0.74094877905919 AS DOUBLE PRECISION) AS sv_7, CAST(-0.977958419350837 AS DOUBLE PRECISION) AS sv_8, CAST(-0.131874231036755 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 5 AS sv_idx, CAST(0.063859378619578 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.761397272856422 AS DOUBLE PRECISION) AS sv_0, CAST(1.497622761800882 AS DOUBLE PRECISION) AS sv_1, CAST(-1.310008913184782 AS DOUBLE PRECISION) AS sv_2, CAST(-1.399082774382091 AS DOUBLE PRECISION) AS sv_3, CAST(1.428589673725849 AS DOUBLE PRECISION) AS sv_4, CAST(0.083561590715411 AS DOUBLE PRECISION) AS sv_5, CAST(1.016272602659387 AS DOUBLE PRECISION) AS sv_6, CAST(-1.882003086352109 AS DOUBLE PRECISION) AS sv_7, CAST(0.664799705649394 AS DOUBLE PRECISION) AS sv_8, CAST(1.270641951361375 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 6 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.363416926383829 AS DOUBLE PRECISION) AS sv_0, CAST(0.7380946344925 AS DOUBLE PRECISION) AS sv_1, CAST(-1.678061770884348 AS DOUBLE PRECISION) AS sv_2, CAST(-0.887322308013405 AS DOUBLE PRECISION) AS sv_3, CAST(0.719486469440514 AS DOUBLE PRECISION) AS sv_4, CAST(-0.016060972879918 AS DOUBLE PRECISION) AS sv_5, CAST(0.518055042935235 AS DOUBLE PRECISION) AS sv_6, CAST(0.430950067776268 AS DOUBLE PRECISION) AS sv_7, CAST(0.615167979407533 AS DOUBLE PRECISION) AS sv_8, CAST(-0.221530659441987 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 7 AS sv_idx, CAST(0.521298669735776 AS DOUBLE PRECISION) AS dual_coeff, CAST(-2.005925047177862 AS DOUBLE PRECISION) AS sv_0, CAST(2.845674045044503 AS DOUBLE PRECISION) AS sv_1, CAST(-2.362907056590556 AS DOUBLE PRECISION) AS sv_2, CAST(-1.22481267287389 AS DOUBLE PRECISION) AS sv_3, CAST(2.300436326577796 AS DOUBLE PRECISION) AS sv_4, CAST(-1.183702222518716 AS DOUBLE PRECISION) AS sv_5, CAST(1.149504587617434 AS DOUBLE PRECISION) AS sv_6, CAST(-1.456471132667488 AS DOUBLE PRECISION) AS sv_7, CAST(3.070620490630201 AS DOUBLE PRECISION) AS sv_8, CAST(0.331992174863624 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 8 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.886266325029851 AS DOUBLE PRECISION) AS sv_0, CAST(-0.365906895382019 AS DOUBLE PRECISION) AS sv_1, CAST(-0.249704995709357 AS DOUBLE PRECISION) AS sv_2, CAST(0.437587372701161 AS DOUBLE PRECISION) AS sv_3, CAST(0.596417834647446 AS DOUBLE PRECISION) AS sv_4, CAST(-0.398644937160245 AS DOUBLE PRECISION) AS sv_5, CAST(-0.31649986582031 AS DOUBLE PRECISION) AS sv_6, CAST(2.028875965999351 AS DOUBLE PRECISION) AS sv_7, CAST(-0.81831930171055 AS DOUBLE PRECISION) AS sv_8, CAST(-1.322897896328765 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 9 AS sv_idx, CAST(0.530877073119264 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.583422676885443 AS DOUBLE PRECISION) AS sv_0, CAST(0.957021248759702 AS DOUBLE PRECISION) AS sv_1, CAST(0.302573623470522 AS DOUBLE PRECISION) AS sv_2, CAST(-1.234343473537793 AS DOUBLE PRECISION) AS sv_3, CAST(1.020503343612735 AS DOUBLE PRECISION) AS sv_4, CAST(-0.260498566987446 AS DOUBLE PRECISION) AS sv_5, CAST(0.937998335121495 AS DOUBLE PRECISION) AS sv_6, CAST(-3.627183375067522 AS DOUBLE PRECISION) AS sv_7, CAST(-0.248179493236782 AS DOUBLE PRECISION) AS sv_8, CAST(1.188145862385599 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 10 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-2.008322049942688 AS DOUBLE PRECISION) AS sv_0, CAST(0.64560303672471 AS DOUBLE PRECISION) AS sv_1, CAST(-0.644199123074621 AS DOUBLE PRECISION) AS sv_2, CAST(0.153841086912192 AS DOUBLE PRECISION) AS sv_3, CAST(1.551762915758032 AS DOUBLE PRECISION) AS sv_4, CAST(-0.286080252964044 AS DOUBLE PRECISION) AS sv_5, CAST(0.053873553267069 AS DOUBLE PRECISION) AS sv_6, CAST(1.112552517400386 AS DOUBLE PRECISION) AS sv_7, CAST(0.786512492701302 AS DOUBLE PRECISION) AS sv_8, CAST(1.36879310667777 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 11 AS sv_idx, CAST(0.956924280031721 AS DOUBLE PRECISION) AS dual_coeff, CAST(2.810770228151144 AS DOUBLE PRECISION) AS sv_0, CAST(-0.201158831548198 AS DOUBLE PRECISION) AS sv_1, CAST(-1.507667890140605 AS DOUBLE PRECISION) AS sv_2, CAST(-1.638094132150707 AS DOUBLE PRECISION) AS sv_3, CAST(-0.340941107273218 AS DOUBLE PRECISION) AS sv_4, CAST(-0.234873636351903 AS DOUBLE PRECISION) AS sv_5, CAST(0.701031172677405 AS DOUBLE PRECISION) AS sv_6, CAST(-0.270023389945754 AS DOUBLE PRECISION) AS sv_7, CAST(1.996147651770403 AS DOUBLE PRECISION) AS sv_8, CAST(0.8693112756684 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 12 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.168261988037994 AS DOUBLE PRECISION) AS sv_0, CAST(-0.231802161756199 AS DOUBLE PRECISION) AS sv_1, CAST(1.21796040423015 AS DOUBLE PRECISION) AS sv_2, CAST(1.483200645687304 AS DOUBLE PRECISION) AS sv_3, CAST(0.854260454302263 AS DOUBLE PRECISION) AS sv_4, CAST(-0.387010233853507 AS DOUBLE PRECISION) AS sv_5, CAST(-0.716935868035528 AS DOUBLE PRECISION) AS sv_6, CAST(1.380221074796965 AS DOUBLE PRECISION) AS sv_7, CAST(-0.75428256920248 AS DOUBLE PRECISION) AS sv_8, CAST(-1.753119623650515 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 13 AS sv_idx, CAST(0.06376750213156 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.604295155104202 AS DOUBLE PRECISION) AS sv_0, CAST(-1.053307032668267 AS DOUBLE PRECISION) AS sv_1, CAST(0.295948311199612 AS DOUBLE PRECISION) AS sv_2, CAST(0.20667994839922 AS DOUBLE PRECISION) AS sv_3, CAST(0.09345472486932 AS DOUBLE PRECISION) AS sv_4, CAST(0.433591560637776 AS DOUBLE PRECISION) AS sv_5, CAST(-0.308688088583257 AS DOUBLE PRECISION) AS sv_6, CAST(1.518288966818283 AS DOUBLE PRECISION) AS sv_7, CAST(1.209321437249917 AS DOUBLE PRECISION) AS sv_8, CAST(0.515610598609226 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 27 AS sv_idx, CAST(-0.198806001470219 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.361303302354855 AS DOUBLE PRECISION) AS sv_0, CAST(0.914175466575273 AS DOUBLE PRECISION) AS sv_1, CAST(0.168388083675704 AS DOUBLE PRECISION) AS sv_2, CAST(2.411209755672496 AS DOUBLE PRECISION) AS sv_3, CAST(-1.66455830072177 AS DOUBLE PRECISION) AS sv_4, CAST(0.536387932603133 AS DOUBLE PRECISION) AS sv_5, CAST(-1.156901062068719 AS DOUBLE PRECISION) AS sv_6, CAST(1.77985878165691 AS DOUBLE PRECISION) AS sv_7, CAST(1.059777422108876 AS DOUBLE PRECISION) AS sv_8, CAST(0.691603843905504 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 28 AS sv_idx, CAST(-0.348016359251609 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.379437953273724 AS DOUBLE PRECISION) AS sv_0, CAST(1.846959637904463 AS DOUBLE PRECISION) AS sv_1, CAST(-2.860740678919198 AS DOUBLE PRECISION) AS sv_2, CAST(0.596585070411824 AS DOUBLE PRECISION) AS sv_3, CAST(-1.526408656424032 AS DOUBLE PRECISION) AS sv_4, CAST(-2.594699659221376 AS DOUBLE PRECISION) AS sv_5, CAST(-0.233413811291256 AS DOUBLE PRECISION) AS sv_6, CAST(2.220248771600248 AS DOUBLE PRECISION) AS sv_7, CAST(-1.117434817605979 AS DOUBLE PRECISION) AS sv_8, CAST(-0.823444079071461 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 29 AS sv_idx, CAST(-0.42819881086795 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.373952009072348 AS DOUBLE PRECISION) AS sv_0, CAST(-2.05123576749633 AS DOUBLE PRECISION) AS sv_1, CAST(-0.734694883086547 AS DOUBLE PRECISION) AS sv_2, CAST(-2.660264830802954 AS DOUBLE PRECISION) AS sv_3, CAST(-0.918229863465946 AS DOUBLE PRECISION) AS sv_4, CAST(0.278813758281544 AS DOUBLE PRECISION) AS sv_5, CAST(0.90612345655797 AS DOUBLE PRECISION) AS sv_6, CAST(-0.826634179907608 AS DOUBLE PRECISION) AS sv_7, CAST(-0.327086252682693 AS DOUBLE PRECISION) AS sv_8, CAST(-0.64509385600711 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 30 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.62021156059666 AS DOUBLE PRECISION) AS sv_0, CAST(0.881017178904949 AS DOUBLE PRECISION) AS sv_1, CAST(-2.715948023932418 AS DOUBLE PRECISION) AS sv_2, CAST(-1.093632737746486 AS DOUBLE PRECISION) AS sv_3, CAST(0.495317534653339 AS DOUBLE PRECISION) AS sv_4, CAST(1.662672460930335 AS DOUBLE PRECISION) AS sv_5, CAST(0.561474393475218 AS DOUBLE PRECISION) AS sv_6, CAST(1.449881491737058 AS DOUBLE PRECISION) AS sv_7, CAST(0.118466026836145 AS DOUBLE PRECISION) AS sv_8, CAST(1.079344397529145 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 31 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.323418269596483 AS DOUBLE PRECISION) AS sv_0, CAST(-3.085841957318085 AS DOUBLE PRECISION) AS sv_1, CAST(0.160156329159101 AS DOUBLE PRECISION) AS sv_2, CAST(-3.567935865688834 AS DOUBLE PRECISION) AS sv_3, CAST(-0.419126013959254 AS DOUBLE PRECISION) AS sv_4, CAST(0.436510447653906 AS DOUBLE PRECISION) AS sv_5, CAST(1.273152505631734 AS DOUBLE PRECISION) AS sv_6, CAST(-2.091028647908177 AS DOUBLE PRECISION) AS sv_7, CAST(0.938013690495561 AS DOUBLE PRECISION) AS sv_8, CAST(1.722604072299372 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 32 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.261521257875381 AS DOUBLE PRECISION) AS sv_0, CAST(-2.234782454040228 AS DOUBLE PRECISION) AS sv_1, CAST(-0.636827993972484 AS DOUBLE PRECISION) AS sv_2, CAST(-3.057892967435802 AS DOUBLE PRECISION) AS sv_3, CAST(1.287862508348779 AS DOUBLE PRECISION) AS sv_4, CAST(0.332910563741039 AS DOUBLE PRECISION) AS sv_5, CAST(1.16995439425405 AS DOUBLE PRECISION) AS sv_6, CAST(-0.333670227152575 AS DOUBLE PRECISION) AS sv_7, CAST(0.462380601291665 AS DOUBLE PRECISION) AS sv_8, CAST(-0.184407790990692 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 33 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.70246016344005 AS DOUBLE PRECISION) AS sv_0, CAST(2.640972044465206 AS DOUBLE PRECISION) AS sv_1, CAST(0.102741007508274 AS DOUBLE PRECISION) AS sv_2, CAST(4.723622290474969 AS DOUBLE PRECISION) AS sv_3, CAST(-1.04105819656609 AS DOUBLE PRECISION) AS sv_4, CAST(-1.008019210377428 AS DOUBLE PRECISION) AS sv_5, CAST(-2.024695828837066 AS DOUBLE PRECISION) AS sv_6, CAST(3.65786415122394 AS DOUBLE PRECISION) AS sv_7, CAST(-0.359929475822864 AS DOUBLE PRECISION) AS sv_8, CAST(1.173904485168846 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 34 AS sv_idx, CAST(-0.210795814978267 AS DOUBLE PRECISION) AS dual_coeff, CAST(-2.312125684215552 AS DOUBLE PRECISION) AS sv_0, CAST(0.194709707398724 AS DOUBLE PRECISION) AS sv_1, CAST(-0.427177016374113 AS DOUBLE PRECISION) AS sv_2, CAST(0.214520984346692 AS DOUBLE PRECISION) AS sv_3, CAST(-0.513752164272871 AS DOUBLE PRECISION) AS sv_4, CAST(0.300120499181337 AS DOUBLE PRECISION) AS sv_5, CAST(-0.130517591389897 AS DOUBLE PRECISION) AS sv_6, CAST(0.536047505261867 AS DOUBLE PRECISION) AS sv_7, CAST(-0.379258263065664 AS DOUBLE PRECISION) AS sv_8, CAST(0.303836228551192 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 35 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.877453233191471 AS DOUBLE PRECISION) AS sv_0, CAST(0.852519310507478 AS DOUBLE PRECISION) AS sv_1, CAST(-0.045512890057632 AS DOUBLE PRECISION) AS sv_2, CAST(1.953171242442738 AS DOUBLE PRECISION) AS sv_3, CAST(-1.890023530710722 AS DOUBLE PRECISION) AS sv_4, CAST(2.134932485670478 AS DOUBLE PRECISION) AS sv_5, CAST(-0.948453835694261 AS DOUBLE PRECISION) AS sv_6, CAST(1.307028570732714 AS DOUBLE PRECISION) AS sv_7, CAST(1.668753501114158 AS DOUBLE PRECISION) AS sv_8, CAST(0.434472004966192 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 36 AS sv_idx, CAST(-0.950909917069854 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.659408824021896 AS DOUBLE PRECISION) AS sv_0, CAST(2.105346528065548 AS DOUBLE PRECISION) AS sv_1, CAST(0.82763491415082 AS DOUBLE PRECISION) AS sv_2, CAST(4.619051035933396 AS DOUBLE PRECISION) AS sv_3, CAST(-0.42767878702292 AS DOUBLE PRECISION) AS sv_4, CAST(0.995938123567801 AS DOUBLE PRECISION) AS sv_5, CAST(-1.99723430530971 AS DOUBLE PRECISION) AS sv_6, CAST(3.390607716535005 AS DOUBLE PRECISION) AS sv_7, CAST(1.050379708514938 AS DOUBLE PRECISION) AS sv_8, CAST(-2.784423798446642 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 37 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-1.411313057128544 AS DOUBLE PRECISION) AS sv_0, CAST(-1.077874385285497 AS DOUBLE PRECISION) AS sv_1, CAST(0.087053389561302 AS DOUBLE PRECISION) AS sv_2, CAST(-3.63597761003692 AS DOUBLE PRECISION) AS sv_3, CAST(0.590949568646418 AS DOUBLE PRECISION) AS sv_4, CAST(-1.271007766915173 AS DOUBLE PRECISION) AS sv_5, CAST(1.770367863655151 AS DOUBLE PRECISION) AS sv_6, CAST(-4.638300055036927 AS DOUBLE PRECISION) AS sv_7, CAST(0.999564916000194 AS DOUBLE PRECISION) AS sv_8, CAST(0.643007239330219 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 38 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.032340697730724 AS DOUBLE PRECISION) AS sv_0, CAST(-0.28184395289124 AS DOUBLE PRECISION) AS sv_1, CAST(-1.628840420019178 AS DOUBLE PRECISION) AS sv_2, CAST(-2.873412526216492 AS DOUBLE PRECISION) AS sv_3, CAST(1.211440453470976 AS DOUBLE PRECISION) AS sv_4, CAST(-0.144661843644594 AS DOUBLE PRECISION) AS sv_5, CAST(1.398816518165714 AS DOUBLE PRECISION) AS sv_6, CAST(-1.369748546437102 AS DOUBLE PRECISION) AS sv_7, CAST(-0.032772530203207 AS DOUBLE PRECISION) AS sv_8, CAST(0.458287938766164 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 39 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.919723457692772 AS DOUBLE PRECISION) AS sv_0, CAST(-0.725777519599824 AS DOUBLE PRECISION) AS sv_1, CAST(-1.582274274543365 AS DOUBLE PRECISION) AS sv_2, CAST(-3.44998409321108 AS DOUBLE PRECISION) AS sv_3, CAST(-1.214931148686492 AS DOUBLE PRECISION) AS sv_4, CAST(1.421875453224298 AS DOUBLE PRECISION) AS sv_5, CAST(1.533797857261079 AS DOUBLE PRECISION) AS sv_6, CAST(-2.976925103446512 AS DOUBLE PRECISION) AS sv_7, CAST(0.657503889500295 AS DOUBLE PRECISION) AS sv_8, CAST(1.331086979608724 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte) AS "Values"), 
kernel_dp_0_2 AS 
(SELECT t_1."KEY" AS "KEY", t_1.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_1."KEY" AS "KEY", sum(CAST(full_join_data_sv_1.dot_prod1 AS DOUBLE PRECISION)) + CAST(-0.004008683281689 AS DOUBLE PRECISION) AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_0_2".dual_coeff * (kernel_input."Feature_0" * "SV_data_0_2".sv_0 + kernel_input."Feature_1" * "SV_data_0_2".sv_1 + kernel_input."Feature_2" * "SV_data_0_2".sv_2 + kernel_input."Feature_3" * "SV_data_0_2".sv_3 + kernel_input."Feature_4" * "SV_data_0_2".sv_4 + kernel_input."Feature_5" * "SV_data_0_2".sv_5 + kernel_input."Feature_6" * "SV_data_0_2".sv_6 + kernel_input."Feature_7" * "SV_data_0_2".sv_7 + kernel_input."Feature_8" * "SV_data_0_2".sv_8 + kernel_input."Feature_9" * "SV_data_0_2".sv_9) AS dot_prod1 
FROM kernel_input, "SV_data_0_2") AS full_join_data_sv_1 GROUP BY full_join_data_sv_1."KEY") AS t_1), 
kernel_cte_0_2 AS 
(SELECT kernel_dp_0_2."KEY" AS "KEY", 0 AS "OVO_Class1", 2 AS "OVO_Class2", CASE WHEN (-kernel_dp_0_2.dot_product >= CAST(0.0 AS DOUBLE PRECISION)) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_0_2.dot_product, CAST(1.0 AS DOUBLE PRECISION) / (CAST(1.0 AS DOUBLE PRECISION) + exp(least(greatest(-CAST(100.0 AS DOUBLE PRECISION), -(-((-kernel_dp_0_2.dot_product) * CAST(-0.621316892731004 AS DOUBLE PRECISION) + CAST(0.108226701137507 AS DOUBLE PRECISION)))), CAST(100.0 AS DOUBLE PRECISION))))) AS "OVO_Conf" 
FROM kernel_dp_0_2)
 SELECT "KernAgg_B1"."KEY", "KernAgg_B1"."OVO_Class1", "KernAgg_B1"."OVO_Class2", "KernAgg_B1"."OVO_Decision", "KernAgg_B1"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_1"."KEY" AS "KEY", "KernAgg_esu_1"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_1"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_1"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_1"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_0_2."KEY" AS "KEY", kernel_cte_0_2."OVO_Class1" AS "OVO_Class1", kernel_cte_0_2."OVO_Class2" AS "OVO_Class2", kernel_cte_0_2."OVO_Decision" AS "OVO_Decision", kernel_cte_0_2."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_0_2) AS "KernAgg_esu_1") AS "KernAgg_B1") AS "U"

-- Code For temporary table tmp_20180602143429_hxp_kernagg_b2 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143429_hxp_kernagg_b2  (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE PRECISION
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143429_hxp_kernagg_b2 part 2. Populate

INSERT INTO tmp_20180602143429_hxp_kernagg_b2 ("KEY", "OVO_Class1", "OVO_Class2", "OVO_Decision", "OVO_Conf") SELECT "U"."KEY", "U"."OVO_Class1", "U"."OVO_Class2", "U"."OVO_Decision", "U"."OVO_Conf" 
FROM (WITH kernel_input AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE PRECISION) AS "Feature_0", CAST("ADS"."Feature_1" AS DOUBLE PRECISION) AS "Feature_1", CAST("ADS"."Feature_2" AS DOUBLE PRECISION) AS "Feature_2", CAST("ADS"."Feature_3" AS DOUBLE PRECISION) AS "Feature_3", CAST("ADS"."Feature_4" AS DOUBLE PRECISION) AS "Feature_4", CAST("ADS"."Feature_5" AS DOUBLE PRECISION) AS "Feature_5", CAST("ADS"."Feature_6" AS DOUBLE PRECISION) AS "Feature_6", CAST("ADS"."Feature_7" AS DOUBLE PRECISION) AS "Feature_7", CAST("ADS"."Feature_8" AS DOUBLE PRECISION) AS "Feature_8", CAST("ADS"."Feature_9" AS DOUBLE PRECISION) AS "Feature_9", CAST("ADS"."TGT" AS DOUBLE PRECISION) AS "TGT" 
FROM "FourClass_10" AS "ADS"), 
dummy_cte AS 
(SELECT CAST(0.0 AS DOUBLE PRECISION) AS "X"), 
"SV_data_0_3" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE PRECISION) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE PRECISION) AS sv_0, CAST("Values".sv_1 AS DOUBLE PRECISION) AS sv_1, CAST("Values".sv_2 AS DOUBLE PRECISION) AS sv_2, CAST("Values".sv_3 AS DOUBLE PRECISION) AS sv_3, CAST("Values".sv_4 AS DOUBLE PRECISION) AS sv_4, CAST("Values".sv_5 AS DOUBLE PRECISION) AS sv_5, CAST("Values".sv_6 AS DOUBLE PRECISION) AS sv_6, CAST("Values".sv_7 AS DOUBLE PRECISION) AS sv_7, CAST("Values".sv_8 AS DOUBLE PRECISION) AS sv_8, CAST("Values".sv_9 AS DOUBLE PRECISION) AS sv_9 
FROM (SELECT 0 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.947598012521973 AS DOUBLE PRECISION) AS sv_0, CAST(-0.964306420204744 AS DOUBLE PRECISION) AS sv_1, CAST(2.155773785219882 AS DOUBLE PRECISION) AS sv_2, CAST(1.161788643602634 AS DOUBLE PRECISION) AS sv_3, CAST(2.259484322098266 AS DOUBLE PRECISION) AS sv_4, CAST(-1.363122165456921 AS DOUBLE PRECISION) AS sv_5, CAST(-0.567040154048362 AS DOUBLE PRECISION) AS sv_6, CAST(1.064763318975707 AS DOUBLE PRECISION) AS sv_7, CAST(-0.901723878924819 AS DOUBLE PRECISION) AS sv_8, CAST(0.629911630159176 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 1 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.501049774810359 AS DOUBLE PRECISION) AS sv_0, CAST(-0.596190161513311 AS DOUBLE PRECISION) AS sv_1, CAST(-0.322133522472416 AS DOUBLE PRECISION) AS sv_2, CAST(-1.093693306132184 AS DOUBLE PRECISION) AS sv_3, CAST(-0.693695436549092 AS DOUBLE PRECISION) AS sv_4, CAST(-0.06504197370882 AS DOUBLE PRECISION) AS sv_5, CAST(0.412455701691278 AS DOUBLE PRECISION) AS sv_6, CAST(-0.835510460407414 AS DOUBLE PRECISION) AS sv_7, CAST(0.247959867435887 AS DOUBLE PRECISION) AS sv_8, CAST(2.614818878550584 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 2 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.731997715261604 AS DOUBLE PRECISION) AS sv_0, CAST(-0.656676772961274 AS DOUBLE PRECISION) AS sv_1, CAST(0.469655166626363 AS DOUBLE PRECISION) AS sv_2, CAST(0.501273915016597 AS DOUBLE PRECISION) AS sv_3, CAST(-0.085786095263703 AS DOUBLE PRECISION) AS sv_4, CAST(0.231390795551295 AS DOUBLE PRECISION) AS sv_5, CAST(-0.374617044234245 AS DOUBLE PRECISION) AS sv_6, CAST(1.063850356375259 AS DOUBLE PRECISION) AS sv_7, CAST(0.805366893216856 AS DOUBLE PRECISION) AS sv_8, CAST(-0.485988492097471 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 3 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.760485454596022 AS DOUBLE PRECISION) AS sv_0, CAST(-1.502020411528053 AS DOUBLE PRECISION) AS sv_1, CAST(-0.060961804509021 AS DOUBLE PRECISION) AS sv_2, CAST(-1.14772070089846 AS DOUBLE PRECISION) AS sv_3, CAST(0.456107072554643 AS DOUBLE PRECISION) AS sv_4, CAST(0.135780203515399 AS DOUBLE PRECISION) AS sv_5, CAST(0.31155055276143 AS DOUBLE PRECISION) AS sv_6, CAST(0.572721322772484 AS DOUBLE PRECISION) AS sv_7, CAST(-0.48017811399064 AS DOUBLE PRECISION) AS sv_8, CAST(0.112949399265271 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 4 AS sv_idx, CAST(0.86616688147543 AS DOUBLE PRECISION) AS dual_coeff, CAST(-1.622625438296457 AS DOUBLE PRECISION) AS sv_0, CAST(-0.759668380229279 AS DOUBLE PRECISION) AS sv_1, CAST(-0.470315254555039 AS DOUBLE PRECISION) AS sv_2, CAST(-0.346907110598383 AS DOUBLE PRECISION) AS sv_3, CAST(-1.170431020982439 AS DOUBLE PRECISION) AS sv_4, CAST(0.86508363385815 AS DOUBLE PRECISION) AS sv_5, CAST(-0.05783750341403 AS DOUBLE PRECISION) AS sv_6, CAST(0.74094877905919 AS DOUBLE PRECISION) AS sv_7, CAST(-0.977958419350837 AS DOUBLE PRECISION) AS sv_8, CAST(-0.131874231036755 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 5 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.761397272856422 AS DOUBLE PRECISION) AS sv_0, CAST(1.497622761800882 AS DOUBLE PRECISION) AS sv_1, CAST(-1.310008913184782 AS DOUBLE PRECISION) AS sv_2, CAST(-1.399082774382091 AS DOUBLE PRECISION) AS sv_3, CAST(1.428589673725849 AS DOUBLE PRECISION) AS sv_4, CAST(0.083561590715411 AS DOUBLE PRECISION) AS sv_5, CAST(1.016272602659387 AS DOUBLE PRECISION) AS sv_6, CAST(-1.882003086352109 AS DOUBLE PRECISION) AS sv_7, CAST(0.664799705649394 AS DOUBLE PRECISION) AS sv_8, CAST(1.270641951361375 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 6 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.363416926383829 AS DOUBLE PRECISION) AS sv_0, CAST(0.7380946344925 AS DOUBLE PRECISION) AS sv_1, CAST(-1.678061770884348 AS DOUBLE PRECISION) AS sv_2, CAST(-0.887322308013405 AS DOUBLE PRECISION) AS sv_3, CAST(0.719486469440514 AS DOUBLE PRECISION) AS sv_4, CAST(-0.016060972879918 AS DOUBLE PRECISION) AS sv_5, CAST(0.518055042935235 AS DOUBLE PRECISION) AS sv_6, CAST(0.430950067776268 AS DOUBLE PRECISION) AS sv_7, CAST(0.615167979407533 AS DOUBLE PRECISION) AS sv_8, CAST(-0.221530659441987 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 7 AS sv_idx, CAST(0.07126136897023 AS DOUBLE PRECISION) AS dual_coeff, CAST(-2.005925047177862 AS DOUBLE PRECISION) AS sv_0, CAST(2.845674045044503 AS DOUBLE PRECISION) AS sv_1, CAST(-2.362907056590556 AS DOUBLE PRECISION) AS sv_2, CAST(-1.22481267287389 AS DOUBLE PRECISION) AS sv_3, CAST(2.300436326577796 AS DOUBLE PRECISION) AS sv_4, CAST(-1.183702222518716 AS DOUBLE PRECISION) AS sv_5, CAST(1.149504587617434 AS DOUBLE PRECISION) AS sv_6, CAST(-1.456471132667488 AS DOUBLE PRECISION) AS sv_7, CAST(3.070620490630201 AS DOUBLE PRECISION) AS sv_8, CAST(0.331992174863624 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 8 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.886266325029851 AS DOUBLE PRECISION) AS sv_0, CAST(-0.365906895382019 AS DOUBLE PRECISION) AS sv_1, CAST(-0.249704995709357 AS DOUBLE PRECISION) AS sv_2, CAST(0.437587372701161 AS DOUBLE PRECISION) AS sv_3, CAST(0.596417834647446 AS DOUBLE PRECISION) AS sv_4, CAST(-0.398644937160245 AS DOUBLE PRECISION) AS sv_5, CAST(-0.31649986582031 AS DOUBLE PRECISION) AS sv_6, CAST(2.028875965999351 AS DOUBLE PRECISION) AS sv_7, CAST(-0.81831930171055 AS DOUBLE PRECISION) AS sv_8, CAST(-1.322897896328765 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 9 AS sv_idx, CAST(0.703726116923915 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.583422676885443 AS DOUBLE PRECISION) AS sv_0, CAST(0.957021248759702 AS DOUBLE PRECISION) AS sv_1, CAST(0.302573623470522 AS DOUBLE PRECISION) AS sv_2, CAST(-1.234343473537793 AS DOUBLE PRECISION) AS sv_3, CAST(1.020503343612735 AS DOUBLE PRECISION) AS sv_4, CAST(-0.260498566987446 AS DOUBLE PRECISION) AS sv_5, CAST(0.937998335121495 AS DOUBLE PRECISION) AS sv_6, CAST(-3.627183375067522 AS DOUBLE PRECISION) AS sv_7, CAST(-0.248179493236782 AS DOUBLE PRECISION) AS sv_8, CAST(1.188145862385599 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 10 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-2.008322049942688 AS DOUBLE PRECISION) AS sv_0, CAST(0.64560303672471 AS DOUBLE PRECISION) AS sv_1, CAST(-0.644199123074621 AS DOUBLE PRECISION) AS sv_2, CAST(0.153841086912192 AS DOUBLE PRECISION) AS sv_3, CAST(1.551762915758032 AS DOUBLE PRECISION) AS sv_4, CAST(-0.286080252964044 AS DOUBLE PRECISION) AS sv_5, CAST(0.053873553267069 AS DOUBLE PRECISION) AS sv_6, CAST(1.112552517400386 AS DOUBLE PRECISION) AS sv_7, CAST(0.786512492701302 AS DOUBLE PRECISION) AS sv_8, CAST(1.36879310667777 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 11 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(2.810770228151144 AS DOUBLE PRECISION) AS sv_0, CAST(-0.201158831548198 AS DOUBLE PRECISION) AS sv_1, CAST(-1.507667890140605 AS DOUBLE PRECISION) AS sv_2, CAST(-1.638094132150707 AS DOUBLE PRECISION) AS sv_3, CAST(-0.340941107273218 AS DOUBLE PRECISION) AS sv_4, CAST(-0.234873636351903 AS DOUBLE PRECISION) AS sv_5, CAST(0.701031172677405 AS DOUBLE PRECISION) AS sv_6, CAST(-0.270023389945754 AS DOUBLE PRECISION) AS sv_7, CAST(1.996147651770403 AS DOUBLE PRECISION) AS sv_8, CAST(0.8693112756684 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 12 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.168261988037994 AS DOUBLE PRECISION) AS sv_0, CAST(-0.231802161756199 AS DOUBLE PRECISION) AS sv_1, CAST(1.21796040423015 AS DOUBLE PRECISION) AS sv_2, CAST(1.483200645687304 AS DOUBLE PRECISION) AS sv_3, CAST(0.854260454302263 AS DOUBLE PRECISION) AS sv_4, CAST(-0.387010233853507 AS DOUBLE PRECISION) AS sv_5, CAST(-0.716935868035528 AS DOUBLE PRECISION) AS sv_6, CAST(1.380221074796965 AS DOUBLE PRECISION) AS sv_7, CAST(-0.75428256920248 AS DOUBLE PRECISION) AS sv_8, CAST(-1.753119623650515 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 13 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.604295155104202 AS DOUBLE PRECISION) AS sv_0, CAST(-1.053307032668267 AS DOUBLE PRECISION) AS sv_1, CAST(0.295948311199612 AS DOUBLE PRECISION) AS sv_2, CAST(0.20667994839922 AS DOUBLE PRECISION) AS sv_3, CAST(0.09345472486932 AS DOUBLE PRECISION) AS sv_4, CAST(0.433591560637776 AS DOUBLE PRECISION) AS sv_5, CAST(-0.308688088583257 AS DOUBLE PRECISION) AS sv_6, CAST(1.518288966818283 AS DOUBLE PRECISION) AS sv_7, CAST(1.209321437249917 AS DOUBLE PRECISION) AS sv_8, CAST(0.515610598609226 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 40 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.003077309068269 AS DOUBLE PRECISION) AS sv_0, CAST(2.031845553628207 AS DOUBLE PRECISION) AS sv_1, CAST(-1.523343407131356 AS DOUBLE PRECISION) AS sv_2, CAST(0.412495310562481 AS DOUBLE PRECISION) AS sv_3, CAST(-0.738633992984463 AS DOUBLE PRECISION) AS sv_4, CAST(0.755448892846376 AS DOUBLE PRECISION) AS sv_5, CAST(0.051734789904433 AS DOUBLE PRECISION) AS sv_6, CAST(-0.201869716266698 AS DOUBLE PRECISION) AS sv_7, CAST(-2.06933020213559 AS DOUBLE PRECISION) AS sv_8, CAST(0.09421466978184 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 41 AS sv_idx, CAST(-0.360290921662154 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.561651563112807 AS DOUBLE PRECISION) AS sv_0, CAST(0.54932743997605 AS DOUBLE PRECISION) AS sv_1, CAST(-1.78784131744186 AS DOUBLE PRECISION) AS sv_2, CAST(-1.592336079742726 AS DOUBLE PRECISION) AS sv_3, CAST(-0.968801731764567 AS DOUBLE PRECISION) AS sv_4, CAST(1.554754456022626 AS DOUBLE PRECISION) AS sv_5, CAST(0.790097590894606 AS DOUBLE PRECISION) AS sv_6, CAST(-1.171296904125234 AS DOUBLE PRECISION) AS sv_7, CAST(-1.670292043200369 AS DOUBLE PRECISION) AS sv_8, CAST(0.120620762404786 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 42 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.636305156382388 AS DOUBLE PRECISION) AS sv_0, CAST(1.743788490051133 AS DOUBLE PRECISION) AS sv_1, CAST(0.765717801134649 AS DOUBLE PRECISION) AS sv_2, CAST(2.546249335882604 AS DOUBLE PRECISION) AS sv_3, CAST(-2.097832522439988 AS DOUBLE PRECISION) AS sv_4, CAST(1.755082975978213 AS DOUBLE PRECISION) AS sv_5, CAST(-1.015282792026085 AS DOUBLE PRECISION) AS sv_6, CAST(-0.43351762342622 AS DOUBLE PRECISION) AS sv_7, CAST(0.540747310632309 AS DOUBLE PRECISION) AS sv_8, CAST(0.838281766139096 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 43 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-2.063295162834261 AS DOUBLE PRECISION) AS sv_0, CAST(2.733808388165165 AS DOUBLE PRECISION) AS sv_1, CAST(2.988845446966221 AS DOUBLE PRECISION) AS sv_2, CAST(5.185680756371328 AS DOUBLE PRECISION) AS sv_3, CAST(0.519963941902523 AS DOUBLE PRECISION) AS sv_4, CAST(-0.147525969102668 AS DOUBLE PRECISION) AS sv_5, CAST(-1.946205856146665 AS DOUBLE PRECISION) AS sv_6, CAST(0.343057625083097 AS DOUBLE PRECISION) AS sv_7, CAST(-0.222744448532082 AS DOUBLE PRECISION) AS sv_8, CAST(-0.505800386513862 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 44 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.321429771524548 AS DOUBLE PRECISION) AS sv_0, CAST(1.822224799379486 AS DOUBLE PRECISION) AS sv_1, CAST(-0.707341899412946 AS DOUBLE PRECISION) AS sv_2, CAST(0.694412071956306 AS DOUBLE PRECISION) AS sv_3, CAST(-0.437546982852218 AS DOUBLE PRECISION) AS sv_4, CAST(0.158535232818123 AS DOUBLE PRECISION) AS sv_5, CAST(-0.063747299055815 AS DOUBLE PRECISION) AS sv_6, CAST(-0.58344181233108 AS DOUBLE PRECISION) AS sv_7, CAST(-0.071171133350216 AS DOUBLE PRECISION) AS sv_8, CAST(0.008195345837627 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 45 AS sv_idx, CAST(-0.372299258960921 AS DOUBLE PRECISION) AS dual_coeff, CAST(-1.11848880136501 AS DOUBLE PRECISION) AS sv_0, CAST(-0.168868458457724 AS DOUBLE PRECISION) AS sv_1, CAST(-0.223173536621175 AS DOUBLE PRECISION) AS sv_2, CAST(-1.645559529132882 AS DOUBLE PRECISION) AS sv_3, CAST(-1.357151578902304 AS DOUBLE PRECISION) AS sv_4, CAST(1.134909791555809 AS DOUBLE PRECISION) AS sv_5, CAST(0.788493895482907 AS DOUBLE PRECISION) AS sv_6, CAST(-2.943594675304676 AS DOUBLE PRECISION) AS sv_7, CAST(-0.612066500568206 AS DOUBLE PRECISION) AS sv_8, CAST(-0.830021413428143 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 46 AS sv_idx, CAST(-0.394653392877933 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.298285664132398 AS DOUBLE PRECISION) AS sv_0, CAST(1.656221916126226 AS DOUBLE PRECISION) AS sv_1, CAST(-1.520806340019603 AS DOUBLE PRECISION) AS sv_2, CAST(-0.301169297575864 AS DOUBLE PRECISION) AS sv_3, CAST(-0.368741519444877 AS DOUBLE PRECISION) AS sv_4, CAST(-0.099040859101694 AS DOUBLE PRECISION) AS sv_5, CAST(0.371835245726029 AS DOUBLE PRECISION) AS sv_6, CAST(-0.715800206350932 AS DOUBLE PRECISION) AS sv_7, CAST(-0.087982786970129 AS DOUBLE PRECISION) AS sv_8, CAST(1.474609831869072 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 47 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.25055214745489 AS DOUBLE PRECISION) AS sv_0, CAST(1.870199938079145 AS DOUBLE PRECISION) AS sv_1, CAST(1.056063881500818 AS DOUBLE PRECISION) AS sv_2, CAST(2.134063175509098 AS DOUBLE PRECISION) AS sv_3, CAST(-0.57378352805883 AS DOUBLE PRECISION) AS sv_4, CAST(-0.225342647115863 AS DOUBLE PRECISION) AS sv_5, CAST(-0.684557522718788 AS DOUBLE PRECISION) AS sv_6, CAST(-1.08581757131165 AS DOUBLE PRECISION) AS sv_7, CAST(1.732798378035335 AS DOUBLE PRECISION) AS sv_8, CAST(0.613472813994274 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 48 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.726011587435791 AS DOUBLE PRECISION) AS sv_0, CAST(0.309192578753202 AS DOUBLE PRECISION) AS sv_1, CAST(0.685614314943201 AS DOUBLE PRECISION) AS sv_2, CAST(1.762854798440782 AS DOUBLE PRECISION) AS sv_3, CAST(-3.346410143785196 AS DOUBLE PRECISION) AS sv_4, CAST(-0.543863388860001 AS DOUBLE PRECISION) AS sv_5, CAST(-0.949559891607555 AS DOUBLE PRECISION) AS sv_6, CAST(-0.121323188634264 AS DOUBLE PRECISION) AS sv_7, CAST(-1.641501700691128 AS DOUBLE PRECISION) AS sv_8, CAST(-1.085697803504388 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 49 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.290004052410514 AS DOUBLE PRECISION) AS sv_0, CAST(2.036008458489042 AS DOUBLE PRECISION) AS sv_1, CAST(1.378378409904958 AS DOUBLE PRECISION) AS sv_2, CAST(3.223910378373741 AS DOUBLE PRECISION) AS sv_3, CAST(-0.691624288181792 AS DOUBLE PRECISION) AS sv_4, CAST(-1.788536070931852 AS DOUBLE PRECISION) AS sv_5, CAST(-1.216215897650886 AS DOUBLE PRECISION) AS sv_6, CAST(-0.0020605513233 AS DOUBLE PRECISION) AS sv_7, CAST(1.34199069536543 AS DOUBLE PRECISION) AS sv_8, CAST(-0.346354130113114 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 50 AS sv_idx, CAST(-0.280454123484614 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.016631584362008 AS DOUBLE PRECISION) AS sv_0, CAST(0.913454121042985 AS DOUBLE PRECISION) AS sv_1, CAST(0.673397490805059 AS DOUBLE PRECISION) AS sv_2, CAST(-0.130980761583581 AS DOUBLE PRECISION) AS sv_3, CAST(-0.615409344779914 AS DOUBLE PRECISION) AS sv_4, CAST(-0.548574995285362 AS DOUBLE PRECISION) AS sv_5, CAST(0.304101409215499 AS DOUBLE PRECISION) AS sv_6, CAST(-3.024010503018774 AS DOUBLE PRECISION) AS sv_7, CAST(-0.080428118334958 AS DOUBLE PRECISION) AS sv_8, CAST(0.639202058718576 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 51 AS sv_idx, CAST(-0.233456670383955 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.291573587962718 AS DOUBLE PRECISION) AS sv_0, CAST(0.871828315414173 AS DOUBLE PRECISION) AS sv_1, CAST(1.830615634433919 AS DOUBLE PRECISION) AS sv_2, CAST(2.86104823525729 AS DOUBLE PRECISION) AS sv_3, CAST(-0.320821691749587 AS DOUBLE PRECISION) AS sv_4, CAST(0.552204344225314 AS DOUBLE PRECISION) AS sv_5, CAST(-1.216027512546665 AS DOUBLE PRECISION) AS sv_6, CAST(0.557278901596259 AS DOUBLE PRECISION) AS sv_7, CAST(0.471519880982001 AS DOUBLE PRECISION) AS sv_8, CAST(0.224186959112815 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 52 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.432931082918861 AS DOUBLE PRECISION) AS sv_0, CAST(1.991811281186579 AS DOUBLE PRECISION) AS sv_1, CAST(-1.178216364412042 AS DOUBLE PRECISION) AS sv_2, CAST(1.605070744977476 AS DOUBLE PRECISION) AS sv_3, CAST(-0.810536975719268 AS DOUBLE PRECISION) AS sv_4, CAST(-0.963038774873844 AS DOUBLE PRECISION) AS sv_5, CAST(-0.576157983042811 AS DOUBLE PRECISION) AS sv_6, CAST(1.359790384484652 AS DOUBLE PRECISION) AS sv_7, CAST(0.548504911132576 AS DOUBLE PRECISION) AS sv_8, CAST(0.749179211487966 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte) AS "Values"), 
kernel_dp_0_3 AS 
(SELECT t_2."KEY" AS "KEY", t_2.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_2."KEY" AS "KEY", sum(CAST(full_join_data_sv_2.dot_prod1 AS DOUBLE PRECISION)) + CAST(1.421518108793437 AS DOUBLE PRECISION) AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_0_3".dual_coeff * (kernel_input."Feature_0" * "SV_data_0_3".sv_0 + kernel_input."Feature_1" * "SV_data_0_3".sv_1 + kernel_input."Feature_2" * "SV_data_0_3".sv_2 + kernel_input."Feature_3" * "SV_data_0_3".sv_3 + kernel_input."Feature_4" * "SV_data_0_3".sv_4 + kernel_input."Feature_5" * "SV_data_0_3".sv_5 + kernel_input."Feature_6" * "SV_data_0_3".sv_6 + kernel_input."Feature_7" * "SV_data_0_3".sv_7 + kernel_input."Feature_8" * "SV_data_0_3".sv_8 + kernel_input."Feature_9" * "SV_data_0_3".sv_9) AS dot_prod1 
FROM kernel_input, "SV_data_0_3") AS full_join_data_sv_2 GROUP BY full_join_data_sv_2."KEY") AS t_2), 
kernel_cte_0_3 AS 
(SELECT kernel_dp_0_3."KEY" AS "KEY", 0 AS "OVO_Class1", 3 AS "OVO_Class2", CASE WHEN (-kernel_dp_0_3.dot_product >= CAST(0.0 AS DOUBLE PRECISION)) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_0_3.dot_product, CAST(1.0 AS DOUBLE PRECISION) / (CAST(1.0 AS DOUBLE PRECISION) + exp(least(greatest(-CAST(100.0 AS DOUBLE PRECISION), -(-((-kernel_dp_0_3.dot_product) * CAST(-1.190171462667782 AS DOUBLE PRECISION) + CAST(0.234614710253595 AS DOUBLE PRECISION)))), CAST(100.0 AS DOUBLE PRECISION))))) AS "OVO_Conf" 
FROM kernel_dp_0_3)
 SELECT "KernAgg_B2"."KEY", "KernAgg_B2"."OVO_Class1", "KernAgg_B2"."OVO_Class2", "KernAgg_B2"."OVO_Decision", "KernAgg_B2"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_2"."KEY" AS "KEY", "KernAgg_esu_2"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_2"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_2"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_2"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_0_3."KEY" AS "KEY", kernel_cte_0_3."OVO_Class1" AS "OVO_Class1", kernel_cte_0_3."OVO_Class2" AS "OVO_Class2", kernel_cte_0_3."OVO_Decision" AS "OVO_Decision", kernel_cte_0_3."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_0_3) AS "KernAgg_esu_2") AS "KernAgg_B2") AS "U"

-- Code For temporary table tmp_20180602143429_jpi_kernagg_b3 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143429_jpi_kernagg_b3  (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE PRECISION
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143429_jpi_kernagg_b3 part 2. Populate

INSERT INTO tmp_20180602143429_jpi_kernagg_b3 ("KEY", "OVO_Class1", "OVO_Class2", "OVO_Decision", "OVO_Conf") SELECT "U"."KEY", "U"."OVO_Class1", "U"."OVO_Class2", "U"."OVO_Decision", "U"."OVO_Conf" 
FROM (WITH kernel_input AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE PRECISION) AS "Feature_0", CAST("ADS"."Feature_1" AS DOUBLE PRECISION) AS "Feature_1", CAST("ADS"."Feature_2" AS DOUBLE PRECISION) AS "Feature_2", CAST("ADS"."Feature_3" AS DOUBLE PRECISION) AS "Feature_3", CAST("ADS"."Feature_4" AS DOUBLE PRECISION) AS "Feature_4", CAST("ADS"."Feature_5" AS DOUBLE PRECISION) AS "Feature_5", CAST("ADS"."Feature_6" AS DOUBLE PRECISION) AS "Feature_6", CAST("ADS"."Feature_7" AS DOUBLE PRECISION) AS "Feature_7", CAST("ADS"."Feature_8" AS DOUBLE PRECISION) AS "Feature_8", CAST("ADS"."Feature_9" AS DOUBLE PRECISION) AS "Feature_9", CAST("ADS"."TGT" AS DOUBLE PRECISION) AS "TGT" 
FROM "FourClass_10" AS "ADS"), 
dummy_cte AS 
(SELECT CAST(0.0 AS DOUBLE PRECISION) AS "X"), 
"SV_data_1_2" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE PRECISION) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE PRECISION) AS sv_0, CAST("Values".sv_1 AS DOUBLE PRECISION) AS sv_1, CAST("Values".sv_2 AS DOUBLE PRECISION) AS sv_2, CAST("Values".sv_3 AS DOUBLE PRECISION) AS sv_3, CAST("Values".sv_4 AS DOUBLE PRECISION) AS sv_4, CAST("Values".sv_5 AS DOUBLE PRECISION) AS sv_5, CAST("Values".sv_6 AS DOUBLE PRECISION) AS sv_6, CAST("Values".sv_7 AS DOUBLE PRECISION) AS sv_7, CAST("Values".sv_8 AS DOUBLE PRECISION) AS sv_8, CAST("Values".sv_9 AS DOUBLE PRECISION) AS sv_9 
FROM (SELECT 14 AS sv_idx, CAST(0.043724534631164 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.629257184949878 AS DOUBLE PRECISION) AS sv_0, CAST(1.61290186830246 AS DOUBLE PRECISION) AS sv_1, CAST(-0.001256620853366 AS DOUBLE PRECISION) AS sv_2, CAST(1.224914794167675 AS DOUBLE PRECISION) AS sv_3, CAST(0.161250826728139 AS DOUBLE PRECISION) AS sv_4, CAST(0.435055795643038 AS DOUBLE PRECISION) AS sv_5, CAST(-0.313050938259077 AS DOUBLE PRECISION) AS sv_6, CAST(-0.200373484555756 AS DOUBLE PRECISION) AS sv_7, CAST(1.020498192809712 AS DOUBLE PRECISION) AS sv_8, CAST(0.502325828918589 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 15 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.502667491441903 AS DOUBLE PRECISION) AS sv_0, CAST(2.24343377461446 AS DOUBLE PRECISION) AS sv_1, CAST(-0.68281529749554 AS DOUBLE PRECISION) AS sv_2, CAST(0.750218462509449 AS DOUBLE PRECISION) AS sv_3, CAST(1.493763045699863 AS DOUBLE PRECISION) AS sv_4, CAST(-0.34013734463915 AS DOUBLE PRECISION) AS sv_5, CAST(0.067493858211081 AS DOUBLE PRECISION) AS sv_6, CAST(-0.219722113167559 AS DOUBLE PRECISION) AS sv_7, CAST(0.740963770035668 AS DOUBLE PRECISION) AS sv_8, CAST(-1.105790583631475 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 16 AS sv_idx, CAST(0.851643820062782 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.463949979402301 AS DOUBLE PRECISION) AS sv_0, CAST(2.684104588576153 AS DOUBLE PRECISION) AS sv_1, CAST(-1.333164862031727 AS DOUBLE PRECISION) AS sv_2, CAST(1.832576776928172 AS DOUBLE PRECISION) AS sv_3, CAST(-1.67203697184364 AS DOUBLE PRECISION) AS sv_4, CAST(0.110983645334723 AS DOUBLE PRECISION) AS sv_5, CAST(-0.595534634403866 AS DOUBLE PRECISION) AS sv_6, CAST(0.547026927091312 AS DOUBLE PRECISION) AS sv_7, CAST(1.01971405964078 AS DOUBLE PRECISION) AS sv_8, CAST(-1.426588063900455 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 17 AS sv_idx, CAST(0.599372822815048 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.608032628452502 AS DOUBLE PRECISION) AS sv_0, CAST(0.313089765108707 AS DOUBLE PRECISION) AS sv_1, CAST(0.721979720680206 AS DOUBLE PRECISION) AS sv_2, CAST(1.192551632100606 AS DOUBLE PRECISION) AS sv_3, CAST(0.426011491180697 AS DOUBLE PRECISION) AS sv_4, CAST(-2.019076907942007 AS DOUBLE PRECISION) AS sv_5, CAST(-0.501255545318046 AS DOUBLE PRECISION) AS sv_6, CAST(0.649553953206439 AS DOUBLE PRECISION) AS sv_7, CAST(-0.80036730534689 AS DOUBLE PRECISION) AS sv_8, CAST(-0.200862044148103 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 18 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.459523687179593 AS DOUBLE PRECISION) AS sv_0, CAST(2.297718186877674 AS DOUBLE PRECISION) AS sv_1, CAST(0.257620422852261 AS DOUBLE PRECISION) AS sv_2, CAST(3.260725404429864 AS DOUBLE PRECISION) AS sv_3, CAST(-0.438872353967862 AS DOUBLE PRECISION) AS sv_4, CAST(-0.536216408533669 AS DOUBLE PRECISION) AS sv_5, CAST(-1.269463881964628 AS DOUBLE PRECISION) AS sv_6, CAST(1.63544705796198 AS DOUBLE PRECISION) AS sv_7, CAST(-1.277994412610604 AS DOUBLE PRECISION) AS sv_8, CAST(1.43629280498466 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 19 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.005572703655875 AS DOUBLE PRECISION) AS sv_0, CAST(2.308181057340788 AS DOUBLE PRECISION) AS sv_1, CAST(3.651855414298892 AS DOUBLE PRECISION) AS sv_2, CAST(7.30307216309809 AS DOUBLE PRECISION) AS sv_3, CAST(-3.750315814533895 AS DOUBLE PRECISION) AS sv_4, CAST(-1.189570689903679 AS DOUBLE PRECISION) AS sv_5, CAST(-3.280717993715776 AS DOUBLE PRECISION) AS sv_6, CAST(1.546094534719291 AS DOUBLE PRECISION) AS sv_7, CAST(0.19378283133607 AS DOUBLE PRECISION) AS sv_8, CAST(0.216365191728417 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 20 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.707345853261733 AS DOUBLE PRECISION) AS sv_0, CAST(1.277402038245135 AS DOUBLE PRECISION) AS sv_1, CAST(0.362828015755179 AS DOUBLE PRECISION) AS sv_2, CAST(3.375831172834355 AS DOUBLE PRECISION) AS sv_3, CAST(-1.13003668545944 AS DOUBLE PRECISION) AS sv_4, CAST(-0.527303437893496 AS DOUBLE PRECISION) AS sv_5, CAST(-1.566191239527718 AS DOUBLE PRECISION) AS sv_6, CAST(2.872921317009621 AS DOUBLE PRECISION) AS sv_7, CAST(-1.135143383507464 AS DOUBLE PRECISION) AS sv_8, CAST(0.737556975240543 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 21 AS sv_idx, CAST(0.110366618304414 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.381302698650035 AS DOUBLE PRECISION) AS sv_0, CAST(0.142894275019143 AS DOUBLE PRECISION) AS sv_1, CAST(1.766774815777937 AS DOUBLE PRECISION) AS sv_2, CAST(2.235787179574087 AS DOUBLE PRECISION) AS sv_3, CAST(1.616160804871235 AS DOUBLE PRECISION) AS sv_4, CAST(-0.597973382691771 AS DOUBLE PRECISION) AS sv_5, CAST(-0.969472400216295 AS DOUBLE PRECISION) AS sv_6, CAST(1.609333047616631 AS DOUBLE PRECISION) AS sv_7, CAST(0.143574433900628 AS DOUBLE PRECISION) AS sv_8, CAST(-0.242824068812346 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 22 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-1.270142172271626 AS DOUBLE PRECISION) AS sv_0, CAST(1.397600297456189 AS DOUBLE PRECISION) AS sv_1, CAST(0.053460651128554 AS DOUBLE PRECISION) AS sv_2, CAST(1.640976043106811 AS DOUBLE PRECISION) AS sv_3, CAST(0.564307121751988 AS DOUBLE PRECISION) AS sv_4, CAST(1.456377543159662 AS DOUBLE PRECISION) AS sv_5, CAST(-0.565749372117931 AS DOUBLE PRECISION) AS sv_6, CAST(0.966704046659169 AS DOUBLE PRECISION) AS sv_7, CAST(0.617244297737013 AS DOUBLE PRECISION) AS sv_8, CAST(0.552805168880046 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 23 AS sv_idx, CAST(0.360627068633518 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.36214192469288 AS DOUBLE PRECISION) AS sv_0, CAST(1.148551055104887 AS DOUBLE PRECISION) AS sv_1, CAST(0.381384199135603 AS DOUBLE PRECISION) AS sv_2, CAST(1.833834725170746 AS DOUBLE PRECISION) AS sv_3, CAST(-0.766983073167534 AS DOUBLE PRECISION) AS sv_4, CAST(-0.419320738816896 AS DOUBLE PRECISION) AS sv_5, CAST(-0.742584426392529 AS DOUBLE PRECISION) AS sv_6, CAST(0.493851471811817 AS DOUBLE PRECISION) AS sv_7, CAST(0.547080062802479 AS DOUBLE PRECISION) AS sv_8, CAST(-1.273868108974052 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 24 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.12240188653635 AS DOUBLE PRECISION) AS sv_0, CAST(1.519619083048972 AS DOUBLE PRECISION) AS sv_1, CAST(-0.299666316236091 AS DOUBLE PRECISION) AS sv_2, CAST(1.543376365851341 AS DOUBLE PRECISION) AS sv_3, CAST(-1.092618337480973 AS DOUBLE PRECISION) AS sv_4, CAST(0.858729406740151 AS DOUBLE PRECISION) AS sv_5, CAST(-0.576870481186498 AS DOUBLE PRECISION) AS sv_6, CAST(0.381639848946456 AS DOUBLE PRECISION) AS sv_7, CAST(-1.490139684399622 AS DOUBLE PRECISION) AS sv_8, CAST(-0.197535430352856 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 25 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.513567547036479 AS DOUBLE PRECISION) AS sv_0, CAST(-1.499522139254715 AS DOUBLE PRECISION) AS sv_1, CAST(3.681000724546332 AS DOUBLE PRECISION) AS sv_2, CAST(1.609309028081592 AS DOUBLE PRECISION) AS sv_3, CAST(0.024684048707125 AS DOUBLE PRECISION) AS sv_4, CAST(1.09653515269854 AS DOUBLE PRECISION) AS sv_5, CAST(-0.870556030109111 AS DOUBLE PRECISION) AS sv_6, CAST(-0.938180404630373 AS DOUBLE PRECISION) AS sv_7, CAST(-0.320582689182142 AS DOUBLE PRECISION) AS sv_8, CAST(1.46903207688595 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 26 AS sv_idx, CAST(0.27675745126641 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.937809821356064 AS DOUBLE PRECISION) AS sv_0, CAST(2.063038682551624 AS DOUBLE PRECISION) AS sv_1, CAST(1.799702287317565 AS DOUBLE PRECISION) AS sv_2, CAST(5.775992485862361 AS DOUBLE PRECISION) AS sv_3, CAST(-2.766395871746766 AS DOUBLE PRECISION) AS sv_4, CAST(-0.757307886484841 AS DOUBLE PRECISION) AS sv_5, CAST(-2.632248226618178 AS DOUBLE PRECISION) AS sv_6, CAST(2.753067320210772 AS DOUBLE PRECISION) AS sv_7, CAST(1.900964596518774 AS DOUBLE PRECISION) AS sv_8, CAST(-1.363738338668413 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 27 AS sv_idx, CAST(-0.693214658989962 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.361303302354855 AS DOUBLE PRECISION) AS sv_0, CAST(0.914175466575273 AS DOUBLE PRECISION) AS sv_1, CAST(0.168388083675704 AS DOUBLE PRECISION) AS sv_2, CAST(2.411209755672496 AS DOUBLE PRECISION) AS sv_3, CAST(-1.66455830072177 AS DOUBLE PRECISION) AS sv_4, CAST(0.536387932603133 AS DOUBLE PRECISION) AS sv_5, CAST(-1.156901062068719 AS DOUBLE PRECISION) AS sv_6, CAST(1.77985878165691 AS DOUBLE PRECISION) AS sv_7, CAST(1.059777422108876 AS DOUBLE PRECISION) AS sv_8, CAST(0.691603843905504 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 28 AS sv_idx, CAST(-0.218893921072422 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.379437953273724 AS DOUBLE PRECISION) AS sv_0, CAST(1.846959637904463 AS DOUBLE PRECISION) AS sv_1, CAST(-2.860740678919198 AS DOUBLE PRECISION) AS sv_2, CAST(0.596585070411824 AS DOUBLE PRECISION) AS sv_3, CAST(-1.526408656424032 AS DOUBLE PRECISION) AS sv_4, CAST(-2.594699659221376 AS DOUBLE PRECISION) AS sv_5, CAST(-0.233413811291256 AS DOUBLE PRECISION) AS sv_6, CAST(2.220248771600248 AS DOUBLE PRECISION) AS sv_7, CAST(-1.117434817605979 AS DOUBLE PRECISION) AS sv_8, CAST(-0.823444079071461 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 29 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.373952009072348 AS DOUBLE PRECISION) AS sv_0, CAST(-2.05123576749633 AS DOUBLE PRECISION) AS sv_1, CAST(-0.734694883086547 AS DOUBLE PRECISION) AS sv_2, CAST(-2.660264830802954 AS DOUBLE PRECISION) AS sv_3, CAST(-0.918229863465946 AS DOUBLE PRECISION) AS sv_4, CAST(0.278813758281544 AS DOUBLE PRECISION) AS sv_5, CAST(0.90612345655797 AS DOUBLE PRECISION) AS sv_6, CAST(-0.826634179907608 AS DOUBLE PRECISION) AS sv_7, CAST(-0.327086252682693 AS DOUBLE PRECISION) AS sv_8, CAST(-0.64509385600711 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 30 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.62021156059666 AS DOUBLE PRECISION) AS sv_0, CAST(0.881017178904949 AS DOUBLE PRECISION) AS sv_1, CAST(-2.715948023932418 AS DOUBLE PRECISION) AS sv_2, CAST(-1.093632737746486 AS DOUBLE PRECISION) AS sv_3, CAST(0.495317534653339 AS DOUBLE PRECISION) AS sv_4, CAST(1.662672460930335 AS DOUBLE PRECISION) AS sv_5, CAST(0.561474393475218 AS DOUBLE PRECISION) AS sv_6, CAST(1.449881491737058 AS DOUBLE PRECISION) AS sv_7, CAST(0.118466026836145 AS DOUBLE PRECISION) AS sv_8, CAST(1.079344397529145 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 31 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.323418269596483 AS DOUBLE PRECISION) AS sv_0, CAST(-3.085841957318085 AS DOUBLE PRECISION) AS sv_1, CAST(0.160156329159101 AS DOUBLE PRECISION) AS sv_2, CAST(-3.567935865688834 AS DOUBLE PRECISION) AS sv_3, CAST(-0.419126013959254 AS DOUBLE PRECISION) AS sv_4, CAST(0.436510447653906 AS DOUBLE PRECISION) AS sv_5, CAST(1.273152505631734 AS DOUBLE PRECISION) AS sv_6, CAST(-2.091028647908177 AS DOUBLE PRECISION) AS sv_7, CAST(0.938013690495561 AS DOUBLE PRECISION) AS sv_8, CAST(1.722604072299372 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 32 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.261521257875381 AS DOUBLE PRECISION) AS sv_0, CAST(-2.234782454040228 AS DOUBLE PRECISION) AS sv_1, CAST(-0.636827993972484 AS DOUBLE PRECISION) AS sv_2, CAST(-3.057892967435802 AS DOUBLE PRECISION) AS sv_3, CAST(1.287862508348779 AS DOUBLE PRECISION) AS sv_4, CAST(0.332910563741039 AS DOUBLE PRECISION) AS sv_5, CAST(1.16995439425405 AS DOUBLE PRECISION) AS sv_6, CAST(-0.333670227152575 AS DOUBLE PRECISION) AS sv_7, CAST(0.462380601291665 AS DOUBLE PRECISION) AS sv_8, CAST(-0.184407790990692 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 33 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.70246016344005 AS DOUBLE PRECISION) AS sv_0, CAST(2.640972044465206 AS DOUBLE PRECISION) AS sv_1, CAST(0.102741007508274 AS DOUBLE PRECISION) AS sv_2, CAST(4.723622290474969 AS DOUBLE PRECISION) AS sv_3, CAST(-1.04105819656609 AS DOUBLE PRECISION) AS sv_4, CAST(-1.008019210377428 AS DOUBLE PRECISION) AS sv_5, CAST(-2.024695828837066 AS DOUBLE PRECISION) AS sv_6, CAST(3.65786415122394 AS DOUBLE PRECISION) AS sv_7, CAST(-0.359929475822864 AS DOUBLE PRECISION) AS sv_8, CAST(1.173904485168846 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 34 AS sv_idx, CAST(-0.770248669692521 AS DOUBLE PRECISION) AS dual_coeff, CAST(-2.312125684215552 AS DOUBLE PRECISION) AS sv_0, CAST(0.194709707398724 AS DOUBLE PRECISION) AS sv_1, CAST(-0.427177016374113 AS DOUBLE PRECISION) AS sv_2, CAST(0.214520984346692 AS DOUBLE PRECISION) AS sv_3, CAST(-0.513752164272871 AS DOUBLE PRECISION) AS sv_4, CAST(0.300120499181337 AS DOUBLE PRECISION) AS sv_5, CAST(-0.130517591389897 AS DOUBLE PRECISION) AS sv_6, CAST(0.536047505261867 AS DOUBLE PRECISION) AS sv_7, CAST(-0.379258263065664 AS DOUBLE PRECISION) AS sv_8, CAST(0.303836228551192 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 35 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.877453233191471 AS DOUBLE PRECISION) AS sv_0, CAST(0.852519310507478 AS DOUBLE PRECISION) AS sv_1, CAST(-0.045512890057632 AS DOUBLE PRECISION) AS sv_2, CAST(1.953171242442738 AS DOUBLE PRECISION) AS sv_3, CAST(-1.890023530710722 AS DOUBLE PRECISION) AS sv_4, CAST(2.134932485670478 AS DOUBLE PRECISION) AS sv_5, CAST(-0.948453835694261 AS DOUBLE PRECISION) AS sv_6, CAST(1.307028570732714 AS DOUBLE PRECISION) AS sv_7, CAST(1.668753501114158 AS DOUBLE PRECISION) AS sv_8, CAST(0.434472004966192 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 36 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.659408824021896 AS DOUBLE PRECISION) AS sv_0, CAST(2.105346528065548 AS DOUBLE PRECISION) AS sv_1, CAST(0.82763491415082 AS DOUBLE PRECISION) AS sv_2, CAST(4.619051035933396 AS DOUBLE PRECISION) AS sv_3, CAST(-0.42767878702292 AS DOUBLE PRECISION) AS sv_4, CAST(0.995938123567801 AS DOUBLE PRECISION) AS sv_5, CAST(-1.99723430530971 AS DOUBLE PRECISION) AS sv_6, CAST(3.390607716535005 AS DOUBLE PRECISION) AS sv_7, CAST(1.050379708514938 AS DOUBLE PRECISION) AS sv_8, CAST(-2.784423798446642 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 37 AS sv_idx, CAST(-0.560135065958432 AS DOUBLE PRECISION) AS dual_coeff, CAST(-1.411313057128544 AS DOUBLE PRECISION) AS sv_0, CAST(-1.077874385285497 AS DOUBLE PRECISION) AS sv_1, CAST(0.087053389561302 AS DOUBLE PRECISION) AS sv_2, CAST(-3.63597761003692 AS DOUBLE PRECISION) AS sv_3, CAST(0.590949568646418 AS DOUBLE PRECISION) AS sv_4, CAST(-1.271007766915173 AS DOUBLE PRECISION) AS sv_5, CAST(1.770367863655151 AS DOUBLE PRECISION) AS sv_6, CAST(-4.638300055036927 AS DOUBLE PRECISION) AS sv_7, CAST(0.999564916000194 AS DOUBLE PRECISION) AS sv_8, CAST(0.643007239330219 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 38 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.032340697730724 AS DOUBLE PRECISION) AS sv_0, CAST(-0.28184395289124 AS DOUBLE PRECISION) AS sv_1, CAST(-1.628840420019178 AS DOUBLE PRECISION) AS sv_2, CAST(-2.873412526216492 AS DOUBLE PRECISION) AS sv_3, CAST(1.211440453470976 AS DOUBLE PRECISION) AS sv_4, CAST(-0.144661843644594 AS DOUBLE PRECISION) AS sv_5, CAST(1.398816518165714 AS DOUBLE PRECISION) AS sv_6, CAST(-1.369748546437102 AS DOUBLE PRECISION) AS sv_7, CAST(-0.032772530203207 AS DOUBLE PRECISION) AS sv_8, CAST(0.458287938766164 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 39 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.919723457692772 AS DOUBLE PRECISION) AS sv_0, CAST(-0.725777519599824 AS DOUBLE PRECISION) AS sv_1, CAST(-1.582274274543365 AS DOUBLE PRECISION) AS sv_2, CAST(-3.44998409321108 AS DOUBLE PRECISION) AS sv_3, CAST(-1.214931148686492 AS DOUBLE PRECISION) AS sv_4, CAST(1.421875453224298 AS DOUBLE PRECISION) AS sv_5, CAST(1.533797857261079 AS DOUBLE PRECISION) AS sv_6, CAST(-2.976925103446512 AS DOUBLE PRECISION) AS sv_7, CAST(0.657503889500295 AS DOUBLE PRECISION) AS sv_8, CAST(1.331086979608724 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte) AS "Values"), 
kernel_dp_1_2 AS 
(SELECT t_3."KEY" AS "KEY", t_3.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_3."KEY" AS "KEY", sum(CAST(full_join_data_sv_3.dot_prod1 AS DOUBLE PRECISION)) + CAST(-0.457290180051012 AS DOUBLE PRECISION) AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_1_2".dual_coeff * (kernel_input."Feature_0" * "SV_data_1_2".sv_0 + kernel_input."Feature_1" * "SV_data_1_2".sv_1 + kernel_input."Feature_2" * "SV_data_1_2".sv_2 + kernel_input."Feature_3" * "SV_data_1_2".sv_3 + kernel_input."Feature_4" * "SV_data_1_2".sv_4 + kernel_input."Feature_5" * "SV_data_1_2".sv_5 + kernel_input."Feature_6" * "SV_data_1_2".sv_6 + kernel_input."Feature_7" * "SV_data_1_2".sv_7 + kernel_input."Feature_8" * "SV_data_1_2".sv_8 + kernel_input."Feature_9" * "SV_data_1_2".sv_9) AS dot_prod1 
FROM kernel_input, "SV_data_1_2") AS full_join_data_sv_3 GROUP BY full_join_data_sv_3."KEY") AS t_3), 
kernel_cte_1_2 AS 
(SELECT kernel_dp_1_2."KEY" AS "KEY", 1 AS "OVO_Class1", 2 AS "OVO_Class2", CASE WHEN (-kernel_dp_1_2.dot_product >= CAST(0.0 AS DOUBLE PRECISION)) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_1_2.dot_product, CAST(1.0 AS DOUBLE PRECISION) / (CAST(1.0 AS DOUBLE PRECISION) + exp(least(greatest(-CAST(100.0 AS DOUBLE PRECISION), -(-((-kernel_dp_1_2.dot_product) * CAST(-0.723079330715068 AS DOUBLE PRECISION) + CAST(0.208017273905219 AS DOUBLE PRECISION)))), CAST(100.0 AS DOUBLE PRECISION))))) AS "OVO_Conf" 
FROM kernel_dp_1_2)
 SELECT "KernAgg_B3"."KEY", "KernAgg_B3"."OVO_Class1", "KernAgg_B3"."OVO_Class2", "KernAgg_B3"."OVO_Decision", "KernAgg_B3"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_3"."KEY" AS "KEY", "KernAgg_esu_3"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_3"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_3"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_3"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_1_2."KEY" AS "KEY", kernel_cte_1_2."OVO_Class1" AS "OVO_Class1", kernel_cte_1_2."OVO_Class2" AS "OVO_Class2", kernel_cte_1_2."OVO_Decision" AS "OVO_Decision", kernel_cte_1_2."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_1_2) AS "KernAgg_esu_3") AS "KernAgg_B3") AS "U"

-- Code For temporary table tmp_20180602143429_o5f_kernagg_b4 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143429_o5f_kernagg_b4  (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE PRECISION
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143429_o5f_kernagg_b4 part 2. Populate

INSERT INTO tmp_20180602143429_o5f_kernagg_b4 ("KEY", "OVO_Class1", "OVO_Class2", "OVO_Decision", "OVO_Conf") SELECT "U"."KEY", "U"."OVO_Class1", "U"."OVO_Class2", "U"."OVO_Decision", "U"."OVO_Conf" 
FROM (WITH kernel_input AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE PRECISION) AS "Feature_0", CAST("ADS"."Feature_1" AS DOUBLE PRECISION) AS "Feature_1", CAST("ADS"."Feature_2" AS DOUBLE PRECISION) AS "Feature_2", CAST("ADS"."Feature_3" AS DOUBLE PRECISION) AS "Feature_3", CAST("ADS"."Feature_4" AS DOUBLE PRECISION) AS "Feature_4", CAST("ADS"."Feature_5" AS DOUBLE PRECISION) AS "Feature_5", CAST("ADS"."Feature_6" AS DOUBLE PRECISION) AS "Feature_6", CAST("ADS"."Feature_7" AS DOUBLE PRECISION) AS "Feature_7", CAST("ADS"."Feature_8" AS DOUBLE PRECISION) AS "Feature_8", CAST("ADS"."Feature_9" AS DOUBLE PRECISION) AS "Feature_9", CAST("ADS"."TGT" AS DOUBLE PRECISION) AS "TGT" 
FROM "FourClass_10" AS "ADS"), 
dummy_cte AS 
(SELECT CAST(0.0 AS DOUBLE PRECISION) AS "X"), 
"SV_data_1_3" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE PRECISION) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE PRECISION) AS sv_0, CAST("Values".sv_1 AS DOUBLE PRECISION) AS sv_1, CAST("Values".sv_2 AS DOUBLE PRECISION) AS sv_2, CAST("Values".sv_3 AS DOUBLE PRECISION) AS sv_3, CAST("Values".sv_4 AS DOUBLE PRECISION) AS sv_4, CAST("Values".sv_5 AS DOUBLE PRECISION) AS sv_5, CAST("Values".sv_6 AS DOUBLE PRECISION) AS sv_6, CAST("Values".sv_7 AS DOUBLE PRECISION) AS sv_7, CAST("Values".sv_8 AS DOUBLE PRECISION) AS sv_8, CAST("Values".sv_9 AS DOUBLE PRECISION) AS sv_9 
FROM (SELECT 14 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.629257184949878 AS DOUBLE PRECISION) AS sv_0, CAST(1.61290186830246 AS DOUBLE PRECISION) AS sv_1, CAST(-0.001256620853366 AS DOUBLE PRECISION) AS sv_2, CAST(1.224914794167675 AS DOUBLE PRECISION) AS sv_3, CAST(0.161250826728139 AS DOUBLE PRECISION) AS sv_4, CAST(0.435055795643038 AS DOUBLE PRECISION) AS sv_5, CAST(-0.313050938259077 AS DOUBLE PRECISION) AS sv_6, CAST(-0.200373484555756 AS DOUBLE PRECISION) AS sv_7, CAST(1.020498192809712 AS DOUBLE PRECISION) AS sv_8, CAST(0.502325828918589 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 15 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.502667491441903 AS DOUBLE PRECISION) AS sv_0, CAST(2.24343377461446 AS DOUBLE PRECISION) AS sv_1, CAST(-0.68281529749554 AS DOUBLE PRECISION) AS sv_2, CAST(0.750218462509449 AS DOUBLE PRECISION) AS sv_3, CAST(1.493763045699863 AS DOUBLE PRECISION) AS sv_4, CAST(-0.34013734463915 AS DOUBLE PRECISION) AS sv_5, CAST(0.067493858211081 AS DOUBLE PRECISION) AS sv_6, CAST(-0.219722113167559 AS DOUBLE PRECISION) AS sv_7, CAST(0.740963770035668 AS DOUBLE PRECISION) AS sv_8, CAST(-1.105790583631475 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 16 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.463949979402301 AS DOUBLE PRECISION) AS sv_0, CAST(2.684104588576153 AS DOUBLE PRECISION) AS sv_1, CAST(-1.333164862031727 AS DOUBLE PRECISION) AS sv_2, CAST(1.832576776928172 AS DOUBLE PRECISION) AS sv_3, CAST(-1.67203697184364 AS DOUBLE PRECISION) AS sv_4, CAST(0.110983645334723 AS DOUBLE PRECISION) AS sv_5, CAST(-0.595534634403866 AS DOUBLE PRECISION) AS sv_6, CAST(0.547026927091312 AS DOUBLE PRECISION) AS sv_7, CAST(1.01971405964078 AS DOUBLE PRECISION) AS sv_8, CAST(-1.426588063900455 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 17 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.608032628452502 AS DOUBLE PRECISION) AS sv_0, CAST(0.313089765108707 AS DOUBLE PRECISION) AS sv_1, CAST(0.721979720680206 AS DOUBLE PRECISION) AS sv_2, CAST(1.192551632100606 AS DOUBLE PRECISION) AS sv_3, CAST(0.426011491180697 AS DOUBLE PRECISION) AS sv_4, CAST(-2.019076907942007 AS DOUBLE PRECISION) AS sv_5, CAST(-0.501255545318046 AS DOUBLE PRECISION) AS sv_6, CAST(0.649553953206439 AS DOUBLE PRECISION) AS sv_7, CAST(-0.80036730534689 AS DOUBLE PRECISION) AS sv_8, CAST(-0.200862044148103 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 18 AS sv_idx, CAST(0.751259411548574 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.459523687179593 AS DOUBLE PRECISION) AS sv_0, CAST(2.297718186877674 AS DOUBLE PRECISION) AS sv_1, CAST(0.257620422852261 AS DOUBLE PRECISION) AS sv_2, CAST(3.260725404429864 AS DOUBLE PRECISION) AS sv_3, CAST(-0.438872353967862 AS DOUBLE PRECISION) AS sv_4, CAST(-0.536216408533669 AS DOUBLE PRECISION) AS sv_5, CAST(-1.269463881964628 AS DOUBLE PRECISION) AS sv_6, CAST(1.63544705796198 AS DOUBLE PRECISION) AS sv_7, CAST(-1.277994412610604 AS DOUBLE PRECISION) AS sv_8, CAST(1.43629280498466 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 19 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.005572703655875 AS DOUBLE PRECISION) AS sv_0, CAST(2.308181057340788 AS DOUBLE PRECISION) AS sv_1, CAST(3.651855414298892 AS DOUBLE PRECISION) AS sv_2, CAST(7.30307216309809 AS DOUBLE PRECISION) AS sv_3, CAST(-3.750315814533895 AS DOUBLE PRECISION) AS sv_4, CAST(-1.189570689903679 AS DOUBLE PRECISION) AS sv_5, CAST(-3.280717993715776 AS DOUBLE PRECISION) AS sv_6, CAST(1.546094534719291 AS DOUBLE PRECISION) AS sv_7, CAST(0.19378283133607 AS DOUBLE PRECISION) AS sv_8, CAST(0.216365191728417 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 20 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.707345853261733 AS DOUBLE PRECISION) AS sv_0, CAST(1.277402038245135 AS DOUBLE PRECISION) AS sv_1, CAST(0.362828015755179 AS DOUBLE PRECISION) AS sv_2, CAST(3.375831172834355 AS DOUBLE PRECISION) AS sv_3, CAST(-1.13003668545944 AS DOUBLE PRECISION) AS sv_4, CAST(-0.527303437893496 AS DOUBLE PRECISION) AS sv_5, CAST(-1.566191239527718 AS DOUBLE PRECISION) AS sv_6, CAST(2.872921317009621 AS DOUBLE PRECISION) AS sv_7, CAST(-1.135143383507464 AS DOUBLE PRECISION) AS sv_8, CAST(0.737556975240543 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 21 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.381302698650035 AS DOUBLE PRECISION) AS sv_0, CAST(0.142894275019143 AS DOUBLE PRECISION) AS sv_1, CAST(1.766774815777937 AS DOUBLE PRECISION) AS sv_2, CAST(2.235787179574087 AS DOUBLE PRECISION) AS sv_3, CAST(1.616160804871235 AS DOUBLE PRECISION) AS sv_4, CAST(-0.597973382691771 AS DOUBLE PRECISION) AS sv_5, CAST(-0.969472400216295 AS DOUBLE PRECISION) AS sv_6, CAST(1.609333047616631 AS DOUBLE PRECISION) AS sv_7, CAST(0.143574433900628 AS DOUBLE PRECISION) AS sv_8, CAST(-0.242824068812346 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 22 AS sv_idx, CAST(0.082152635021726 AS DOUBLE PRECISION) AS dual_coeff, CAST(-1.270142172271626 AS DOUBLE PRECISION) AS sv_0, CAST(1.397600297456189 AS DOUBLE PRECISION) AS sv_1, CAST(0.053460651128554 AS DOUBLE PRECISION) AS sv_2, CAST(1.640976043106811 AS DOUBLE PRECISION) AS sv_3, CAST(0.564307121751988 AS DOUBLE PRECISION) AS sv_4, CAST(1.456377543159662 AS DOUBLE PRECISION) AS sv_5, CAST(-0.565749372117931 AS DOUBLE PRECISION) AS sv_6, CAST(0.966704046659169 AS DOUBLE PRECISION) AS sv_7, CAST(0.617244297737013 AS DOUBLE PRECISION) AS sv_8, CAST(0.552805168880046 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 23 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.36214192469288 AS DOUBLE PRECISION) AS sv_0, CAST(1.148551055104887 AS DOUBLE PRECISION) AS sv_1, CAST(0.381384199135603 AS DOUBLE PRECISION) AS sv_2, CAST(1.833834725170746 AS DOUBLE PRECISION) AS sv_3, CAST(-0.766983073167534 AS DOUBLE PRECISION) AS sv_4, CAST(-0.419320738816896 AS DOUBLE PRECISION) AS sv_5, CAST(-0.742584426392529 AS DOUBLE PRECISION) AS sv_6, CAST(0.493851471811817 AS DOUBLE PRECISION) AS sv_7, CAST(0.547080062802479 AS DOUBLE PRECISION) AS sv_8, CAST(-1.273868108974052 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 24 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.12240188653635 AS DOUBLE PRECISION) AS sv_0, CAST(1.519619083048972 AS DOUBLE PRECISION) AS sv_1, CAST(-0.299666316236091 AS DOUBLE PRECISION) AS sv_2, CAST(1.543376365851341 AS DOUBLE PRECISION) AS sv_3, CAST(-1.092618337480973 AS DOUBLE PRECISION) AS sv_4, CAST(0.858729406740151 AS DOUBLE PRECISION) AS sv_5, CAST(-0.576870481186498 AS DOUBLE PRECISION) AS sv_6, CAST(0.381639848946456 AS DOUBLE PRECISION) AS sv_7, CAST(-1.490139684399622 AS DOUBLE PRECISION) AS sv_8, CAST(-0.197535430352856 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 25 AS sv_idx, CAST(0.841409707403105 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.513567547036479 AS DOUBLE PRECISION) AS sv_0, CAST(-1.499522139254715 AS DOUBLE PRECISION) AS sv_1, CAST(3.681000724546332 AS DOUBLE PRECISION) AS sv_2, CAST(1.609309028081592 AS DOUBLE PRECISION) AS sv_3, CAST(0.024684048707125 AS DOUBLE PRECISION) AS sv_4, CAST(1.09653515269854 AS DOUBLE PRECISION) AS sv_5, CAST(-0.870556030109111 AS DOUBLE PRECISION) AS sv_6, CAST(-0.938180404630373 AS DOUBLE PRECISION) AS sv_7, CAST(-0.320582689182142 AS DOUBLE PRECISION) AS sv_8, CAST(1.46903207688595 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 26 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.937809821356064 AS DOUBLE PRECISION) AS sv_0, CAST(2.063038682551624 AS DOUBLE PRECISION) AS sv_1, CAST(1.799702287317565 AS DOUBLE PRECISION) AS sv_2, CAST(5.775992485862361 AS DOUBLE PRECISION) AS sv_3, CAST(-2.766395871746766 AS DOUBLE PRECISION) AS sv_4, CAST(-0.757307886484841 AS DOUBLE PRECISION) AS sv_5, CAST(-2.632248226618178 AS DOUBLE PRECISION) AS sv_6, CAST(2.753067320210772 AS DOUBLE PRECISION) AS sv_7, CAST(1.900964596518774 AS DOUBLE PRECISION) AS sv_8, CAST(-1.363738338668413 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 40 AS sv_idx, CAST(-0.747008136793799 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.003077309068269 AS DOUBLE PRECISION) AS sv_0, CAST(2.031845553628207 AS DOUBLE PRECISION) AS sv_1, CAST(-1.523343407131356 AS DOUBLE PRECISION) AS sv_2, CAST(0.412495310562481 AS DOUBLE PRECISION) AS sv_3, CAST(-0.738633992984463 AS DOUBLE PRECISION) AS sv_4, CAST(0.755448892846376 AS DOUBLE PRECISION) AS sv_5, CAST(0.051734789904433 AS DOUBLE PRECISION) AS sv_6, CAST(-0.201869716266698 AS DOUBLE PRECISION) AS sv_7, CAST(-2.06933020213559 AS DOUBLE PRECISION) AS sv_8, CAST(0.09421466978184 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 41 AS sv_idx, CAST(-0.112821203633109 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.561651563112807 AS DOUBLE PRECISION) AS sv_0, CAST(0.54932743997605 AS DOUBLE PRECISION) AS sv_1, CAST(-1.78784131744186 AS DOUBLE PRECISION) AS sv_2, CAST(-1.592336079742726 AS DOUBLE PRECISION) AS sv_3, CAST(-0.968801731764567 AS DOUBLE PRECISION) AS sv_4, CAST(1.554754456022626 AS DOUBLE PRECISION) AS sv_5, CAST(0.790097590894606 AS DOUBLE PRECISION) AS sv_6, CAST(-1.171296904125234 AS DOUBLE PRECISION) AS sv_7, CAST(-1.670292043200369 AS DOUBLE PRECISION) AS sv_8, CAST(0.120620762404786 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 42 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.636305156382388 AS DOUBLE PRECISION) AS sv_0, CAST(1.743788490051133 AS DOUBLE PRECISION) AS sv_1, CAST(0.765717801134649 AS DOUBLE PRECISION) AS sv_2, CAST(2.546249335882604 AS DOUBLE PRECISION) AS sv_3, CAST(-2.097832522439988 AS DOUBLE PRECISION) AS sv_4, CAST(1.755082975978213 AS DOUBLE PRECISION) AS sv_5, CAST(-1.015282792026085 AS DOUBLE PRECISION) AS sv_6, CAST(-0.43351762342622 AS DOUBLE PRECISION) AS sv_7, CAST(0.540747310632309 AS DOUBLE PRECISION) AS sv_8, CAST(0.838281766139096 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 43 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-2.063295162834261 AS DOUBLE PRECISION) AS sv_0, CAST(2.733808388165165 AS DOUBLE PRECISION) AS sv_1, CAST(2.988845446966221 AS DOUBLE PRECISION) AS sv_2, CAST(5.185680756371328 AS DOUBLE PRECISION) AS sv_3, CAST(0.519963941902523 AS DOUBLE PRECISION) AS sv_4, CAST(-0.147525969102668 AS DOUBLE PRECISION) AS sv_5, CAST(-1.946205856146665 AS DOUBLE PRECISION) AS sv_6, CAST(0.343057625083097 AS DOUBLE PRECISION) AS sv_7, CAST(-0.222744448532082 AS DOUBLE PRECISION) AS sv_8, CAST(-0.505800386513862 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 44 AS sv_idx, CAST(-0.323500813419697 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.321429771524548 AS DOUBLE PRECISION) AS sv_0, CAST(1.822224799379486 AS DOUBLE PRECISION) AS sv_1, CAST(-0.707341899412946 AS DOUBLE PRECISION) AS sv_2, CAST(0.694412071956306 AS DOUBLE PRECISION) AS sv_3, CAST(-0.437546982852218 AS DOUBLE PRECISION) AS sv_4, CAST(0.158535232818123 AS DOUBLE PRECISION) AS sv_5, CAST(-0.063747299055815 AS DOUBLE PRECISION) AS sv_6, CAST(-0.58344181233108 AS DOUBLE PRECISION) AS sv_7, CAST(-0.071171133350216 AS DOUBLE PRECISION) AS sv_8, CAST(0.008195345837627 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 45 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-1.11848880136501 AS DOUBLE PRECISION) AS sv_0, CAST(-0.168868458457724 AS DOUBLE PRECISION) AS sv_1, CAST(-0.223173536621175 AS DOUBLE PRECISION) AS sv_2, CAST(-1.645559529132882 AS DOUBLE PRECISION) AS sv_3, CAST(-1.357151578902304 AS DOUBLE PRECISION) AS sv_4, CAST(1.134909791555809 AS DOUBLE PRECISION) AS sv_5, CAST(0.788493895482907 AS DOUBLE PRECISION) AS sv_6, CAST(-2.943594675304676 AS DOUBLE PRECISION) AS sv_7, CAST(-0.612066500568206 AS DOUBLE PRECISION) AS sv_8, CAST(-0.830021413428143 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 46 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.298285664132398 AS DOUBLE PRECISION) AS sv_0, CAST(1.656221916126226 AS DOUBLE PRECISION) AS sv_1, CAST(-1.520806340019603 AS DOUBLE PRECISION) AS sv_2, CAST(-0.301169297575864 AS DOUBLE PRECISION) AS sv_3, CAST(-0.368741519444877 AS DOUBLE PRECISION) AS sv_4, CAST(-0.099040859101694 AS DOUBLE PRECISION) AS sv_5, CAST(0.371835245726029 AS DOUBLE PRECISION) AS sv_6, CAST(-0.715800206350932 AS DOUBLE PRECISION) AS sv_7, CAST(-0.087982786970129 AS DOUBLE PRECISION) AS sv_8, CAST(1.474609831869072 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 47 AS sv_idx, CAST(-0.205409233130008 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.25055214745489 AS DOUBLE PRECISION) AS sv_0, CAST(1.870199938079145 AS DOUBLE PRECISION) AS sv_1, CAST(1.056063881500818 AS DOUBLE PRECISION) AS sv_2, CAST(2.134063175509098 AS DOUBLE PRECISION) AS sv_3, CAST(-0.57378352805883 AS DOUBLE PRECISION) AS sv_4, CAST(-0.225342647115863 AS DOUBLE PRECISION) AS sv_5, CAST(-0.684557522718788 AS DOUBLE PRECISION) AS sv_6, CAST(-1.08581757131165 AS DOUBLE PRECISION) AS sv_7, CAST(1.732798378035335 AS DOUBLE PRECISION) AS sv_8, CAST(0.613472813994274 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 48 AS sv_idx, CAST(-0.432371093150217 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.726011587435791 AS DOUBLE PRECISION) AS sv_0, CAST(0.309192578753202 AS DOUBLE PRECISION) AS sv_1, CAST(0.685614314943201 AS DOUBLE PRECISION) AS sv_2, CAST(1.762854798440782 AS DOUBLE PRECISION) AS sv_3, CAST(-3.346410143785196 AS DOUBLE PRECISION) AS sv_4, CAST(-0.543863388860001 AS DOUBLE PRECISION) AS sv_5, CAST(-0.949559891607555 AS DOUBLE PRECISION) AS sv_6, CAST(-0.121323188634264 AS DOUBLE PRECISION) AS sv_7, CAST(-1.641501700691128 AS DOUBLE PRECISION) AS sv_8, CAST(-1.085697803504388 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 49 AS sv_idx, CAST(-0.853711273846574 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.290004052410514 AS DOUBLE PRECISION) AS sv_0, CAST(2.036008458489042 AS DOUBLE PRECISION) AS sv_1, CAST(1.378378409904958 AS DOUBLE PRECISION) AS sv_2, CAST(3.223910378373741 AS DOUBLE PRECISION) AS sv_3, CAST(-0.691624288181792 AS DOUBLE PRECISION) AS sv_4, CAST(-1.788536070931852 AS DOUBLE PRECISION) AS sv_5, CAST(-1.216215897650886 AS DOUBLE PRECISION) AS sv_6, CAST(-0.0020605513233 AS DOUBLE PRECISION) AS sv_7, CAST(1.34199069536543 AS DOUBLE PRECISION) AS sv_8, CAST(-0.346354130113114 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 50 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.016631584362008 AS DOUBLE PRECISION) AS sv_0, CAST(0.913454121042985 AS DOUBLE PRECISION) AS sv_1, CAST(0.673397490805059 AS DOUBLE PRECISION) AS sv_2, CAST(-0.130980761583581 AS DOUBLE PRECISION) AS sv_3, CAST(-0.615409344779914 AS DOUBLE PRECISION) AS sv_4, CAST(-0.548574995285362 AS DOUBLE PRECISION) AS sv_5, CAST(0.304101409215499 AS DOUBLE PRECISION) AS sv_6, CAST(-3.024010503018774 AS DOUBLE PRECISION) AS sv_7, CAST(-0.080428118334958 AS DOUBLE PRECISION) AS sv_8, CAST(0.639202058718576 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 51 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.291573587962718 AS DOUBLE PRECISION) AS sv_0, CAST(0.871828315414173 AS DOUBLE PRECISION) AS sv_1, CAST(1.830615634433919 AS DOUBLE PRECISION) AS sv_2, CAST(2.86104823525729 AS DOUBLE PRECISION) AS sv_3, CAST(-0.320821691749587 AS DOUBLE PRECISION) AS sv_4, CAST(0.552204344225314 AS DOUBLE PRECISION) AS sv_5, CAST(-1.216027512546665 AS DOUBLE PRECISION) AS sv_6, CAST(0.557278901596259 AS DOUBLE PRECISION) AS sv_7, CAST(0.471519880982001 AS DOUBLE PRECISION) AS sv_8, CAST(0.224186959112815 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 52 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.432931082918861 AS DOUBLE PRECISION) AS sv_0, CAST(1.991811281186579 AS DOUBLE PRECISION) AS sv_1, CAST(-1.178216364412042 AS DOUBLE PRECISION) AS sv_2, CAST(1.605070744977476 AS DOUBLE PRECISION) AS sv_3, CAST(-0.810536975719268 AS DOUBLE PRECISION) AS sv_4, CAST(-0.963038774873844 AS DOUBLE PRECISION) AS sv_5, CAST(-0.576157983042811 AS DOUBLE PRECISION) AS sv_6, CAST(1.359790384484652 AS DOUBLE PRECISION) AS sv_7, CAST(0.548504911132576 AS DOUBLE PRECISION) AS sv_8, CAST(0.749179211487966 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte) AS "Values"), 
kernel_dp_1_3 AS 
(SELECT t_4."KEY" AS "KEY", t_4.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_4."KEY" AS "KEY", sum(CAST(full_join_data_sv_4.dot_prod1 AS DOUBLE PRECISION)) + CAST(1.189552616710924 AS DOUBLE PRECISION) AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_1_3".dual_coeff * (kernel_input."Feature_0" * "SV_data_1_3".sv_0 + kernel_input."Feature_1" * "SV_data_1_3".sv_1 + kernel_input."Feature_2" * "SV_data_1_3".sv_2 + kernel_input."Feature_3" * "SV_data_1_3".sv_3 + kernel_input."Feature_4" * "SV_data_1_3".sv_4 + kernel_input."Feature_5" * "SV_data_1_3".sv_5 + kernel_input."Feature_6" * "SV_data_1_3".sv_6 + kernel_input."Feature_7" * "SV_data_1_3".sv_7 + kernel_input."Feature_8" * "SV_data_1_3".sv_8 + kernel_input."Feature_9" * "SV_data_1_3".sv_9) AS dot_prod1 
FROM kernel_input, "SV_data_1_3") AS full_join_data_sv_4 GROUP BY full_join_data_sv_4."KEY") AS t_4), 
kernel_cte_1_3 AS 
(SELECT kernel_dp_1_3."KEY" AS "KEY", 1 AS "OVO_Class1", 3 AS "OVO_Class2", CASE WHEN (-kernel_dp_1_3.dot_product >= CAST(0.0 AS DOUBLE PRECISION)) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_1_3.dot_product, CAST(1.0 AS DOUBLE PRECISION) / (CAST(1.0 AS DOUBLE PRECISION) + exp(least(greatest(-CAST(100.0 AS DOUBLE PRECISION), -(-((-kernel_dp_1_3.dot_product) * CAST(-0.526349491929371 AS DOUBLE PRECISION) + CAST(0.14678608487146 AS DOUBLE PRECISION)))), CAST(100.0 AS DOUBLE PRECISION))))) AS "OVO_Conf" 
FROM kernel_dp_1_3)
 SELECT "KernAgg_B4"."KEY", "KernAgg_B4"."OVO_Class1", "KernAgg_B4"."OVO_Class2", "KernAgg_B4"."OVO_Decision", "KernAgg_B4"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_4"."KEY" AS "KEY", "KernAgg_esu_4"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_4"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_4"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_4"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_1_3."KEY" AS "KEY", kernel_cte_1_3."OVO_Class1" AS "OVO_Class1", kernel_cte_1_3."OVO_Class2" AS "OVO_Class2", kernel_cte_1_3."OVO_Decision" AS "OVO_Decision", kernel_cte_1_3."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_1_3) AS "KernAgg_esu_4") AS "KernAgg_B4") AS "U"

-- Code For temporary table tmp_20180602143429_gh2_kernagg_b5 part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143429_gh2_kernagg_b5  (
	"KEY" BIGINT, 
	"OVO_Class1" BIGINT, 
	"OVO_Class2" BIGINT, 
	"OVO_Decision" BIGINT, 
	"OVO_Conf" DOUBLE PRECISION
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143429_gh2_kernagg_b5 part 2. Populate

INSERT INTO tmp_20180602143429_gh2_kernagg_b5 ("KEY", "OVO_Class1", "OVO_Class2", "OVO_Decision", "OVO_Conf") SELECT "U"."KEY", "U"."OVO_Class1", "U"."OVO_Class2", "U"."OVO_Decision", "U"."OVO_Conf" 
FROM (WITH kernel_input AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE PRECISION) AS "Feature_0", CAST("ADS"."Feature_1" AS DOUBLE PRECISION) AS "Feature_1", CAST("ADS"."Feature_2" AS DOUBLE PRECISION) AS "Feature_2", CAST("ADS"."Feature_3" AS DOUBLE PRECISION) AS "Feature_3", CAST("ADS"."Feature_4" AS DOUBLE PRECISION) AS "Feature_4", CAST("ADS"."Feature_5" AS DOUBLE PRECISION) AS "Feature_5", CAST("ADS"."Feature_6" AS DOUBLE PRECISION) AS "Feature_6", CAST("ADS"."Feature_7" AS DOUBLE PRECISION) AS "Feature_7", CAST("ADS"."Feature_8" AS DOUBLE PRECISION) AS "Feature_8", CAST("ADS"."Feature_9" AS DOUBLE PRECISION) AS "Feature_9", CAST("ADS"."TGT" AS DOUBLE PRECISION) AS "TGT" 
FROM "FourClass_10" AS "ADS"), 
dummy_cte AS 
(SELECT CAST(0.0 AS DOUBLE PRECISION) AS "X"), 
"SV_data_2_3" AS 
(SELECT "Values".sv_idx AS sv_idx, CAST("Values".dual_coeff AS DOUBLE PRECISION) AS dual_coeff, CAST("Values".sv_0 AS DOUBLE PRECISION) AS sv_0, CAST("Values".sv_1 AS DOUBLE PRECISION) AS sv_1, CAST("Values".sv_2 AS DOUBLE PRECISION) AS sv_2, CAST("Values".sv_3 AS DOUBLE PRECISION) AS sv_3, CAST("Values".sv_4 AS DOUBLE PRECISION) AS sv_4, CAST("Values".sv_5 AS DOUBLE PRECISION) AS sv_5, CAST("Values".sv_6 AS DOUBLE PRECISION) AS sv_6, CAST("Values".sv_7 AS DOUBLE PRECISION) AS sv_7, CAST("Values".sv_8 AS DOUBLE PRECISION) AS sv_8, CAST("Values".sv_9 AS DOUBLE PRECISION) AS sv_9 
FROM (SELECT 27 AS sv_idx, CAST(0.084242160149468 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.361303302354855 AS DOUBLE PRECISION) AS sv_0, CAST(0.914175466575273 AS DOUBLE PRECISION) AS sv_1, CAST(0.168388083675704 AS DOUBLE PRECISION) AS sv_2, CAST(2.411209755672496 AS DOUBLE PRECISION) AS sv_3, CAST(-1.66455830072177 AS DOUBLE PRECISION) AS sv_4, CAST(0.536387932603133 AS DOUBLE PRECISION) AS sv_5, CAST(-1.156901062068719 AS DOUBLE PRECISION) AS sv_6, CAST(1.77985878165691 AS DOUBLE PRECISION) AS sv_7, CAST(1.059777422108876 AS DOUBLE PRECISION) AS sv_8, CAST(0.691603843905504 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 28 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.379437953273724 AS DOUBLE PRECISION) AS sv_0, CAST(1.846959637904463 AS DOUBLE PRECISION) AS sv_1, CAST(-2.860740678919198 AS DOUBLE PRECISION) AS sv_2, CAST(0.596585070411824 AS DOUBLE PRECISION) AS sv_3, CAST(-1.526408656424032 AS DOUBLE PRECISION) AS sv_4, CAST(-2.594699659221376 AS DOUBLE PRECISION) AS sv_5, CAST(-0.233413811291256 AS DOUBLE PRECISION) AS sv_6, CAST(2.220248771600248 AS DOUBLE PRECISION) AS sv_7, CAST(-1.117434817605979 AS DOUBLE PRECISION) AS sv_8, CAST(-0.823444079071461 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 29 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.373952009072348 AS DOUBLE PRECISION) AS sv_0, CAST(-2.05123576749633 AS DOUBLE PRECISION) AS sv_1, CAST(-0.734694883086547 AS DOUBLE PRECISION) AS sv_2, CAST(-2.660264830802954 AS DOUBLE PRECISION) AS sv_3, CAST(-0.918229863465946 AS DOUBLE PRECISION) AS sv_4, CAST(0.278813758281544 AS DOUBLE PRECISION) AS sv_5, CAST(0.90612345655797 AS DOUBLE PRECISION) AS sv_6, CAST(-0.826634179907608 AS DOUBLE PRECISION) AS sv_7, CAST(-0.327086252682693 AS DOUBLE PRECISION) AS sv_8, CAST(-0.64509385600711 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 30 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.62021156059666 AS DOUBLE PRECISION) AS sv_0, CAST(0.881017178904949 AS DOUBLE PRECISION) AS sv_1, CAST(-2.715948023932418 AS DOUBLE PRECISION) AS sv_2, CAST(-1.093632737746486 AS DOUBLE PRECISION) AS sv_3, CAST(0.495317534653339 AS DOUBLE PRECISION) AS sv_4, CAST(1.662672460930335 AS DOUBLE PRECISION) AS sv_5, CAST(0.561474393475218 AS DOUBLE PRECISION) AS sv_6, CAST(1.449881491737058 AS DOUBLE PRECISION) AS sv_7, CAST(0.118466026836145 AS DOUBLE PRECISION) AS sv_8, CAST(1.079344397529145 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 31 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.323418269596483 AS DOUBLE PRECISION) AS sv_0, CAST(-3.085841957318085 AS DOUBLE PRECISION) AS sv_1, CAST(0.160156329159101 AS DOUBLE PRECISION) AS sv_2, CAST(-3.567935865688834 AS DOUBLE PRECISION) AS sv_3, CAST(-0.419126013959254 AS DOUBLE PRECISION) AS sv_4, CAST(0.436510447653906 AS DOUBLE PRECISION) AS sv_5, CAST(1.273152505631734 AS DOUBLE PRECISION) AS sv_6, CAST(-2.091028647908177 AS DOUBLE PRECISION) AS sv_7, CAST(0.938013690495561 AS DOUBLE PRECISION) AS sv_8, CAST(1.722604072299372 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 32 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.261521257875381 AS DOUBLE PRECISION) AS sv_0, CAST(-2.234782454040228 AS DOUBLE PRECISION) AS sv_1, CAST(-0.636827993972484 AS DOUBLE PRECISION) AS sv_2, CAST(-3.057892967435802 AS DOUBLE PRECISION) AS sv_3, CAST(1.287862508348779 AS DOUBLE PRECISION) AS sv_4, CAST(0.332910563741039 AS DOUBLE PRECISION) AS sv_5, CAST(1.16995439425405 AS DOUBLE PRECISION) AS sv_6, CAST(-0.333670227152575 AS DOUBLE PRECISION) AS sv_7, CAST(0.462380601291665 AS DOUBLE PRECISION) AS sv_8, CAST(-0.184407790990692 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 33 AS sv_idx, CAST(1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.70246016344005 AS DOUBLE PRECISION) AS sv_0, CAST(2.640972044465206 AS DOUBLE PRECISION) AS sv_1, CAST(0.102741007508274 AS DOUBLE PRECISION) AS sv_2, CAST(4.723622290474969 AS DOUBLE PRECISION) AS sv_3, CAST(-1.04105819656609 AS DOUBLE PRECISION) AS sv_4, CAST(-1.008019210377428 AS DOUBLE PRECISION) AS sv_5, CAST(-2.024695828837066 AS DOUBLE PRECISION) AS sv_6, CAST(3.65786415122394 AS DOUBLE PRECISION) AS sv_7, CAST(-0.359929475822864 AS DOUBLE PRECISION) AS sv_8, CAST(1.173904485168846 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 34 AS sv_idx, CAST(0.105371175979077 AS DOUBLE PRECISION) AS dual_coeff, CAST(-2.312125684215552 AS DOUBLE PRECISION) AS sv_0, CAST(0.194709707398724 AS DOUBLE PRECISION) AS sv_1, CAST(-0.427177016374113 AS DOUBLE PRECISION) AS sv_2, CAST(0.214520984346692 AS DOUBLE PRECISION) AS sv_3, CAST(-0.513752164272871 AS DOUBLE PRECISION) AS sv_4, CAST(0.300120499181337 AS DOUBLE PRECISION) AS sv_5, CAST(-0.130517591389897 AS DOUBLE PRECISION) AS sv_6, CAST(0.536047505261867 AS DOUBLE PRECISION) AS sv_7, CAST(-0.379258263065664 AS DOUBLE PRECISION) AS sv_8, CAST(0.303836228551192 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 35 AS sv_idx, CAST(0.030022097312374 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.877453233191471 AS DOUBLE PRECISION) AS sv_0, CAST(0.852519310507478 AS DOUBLE PRECISION) AS sv_1, CAST(-0.045512890057632 AS DOUBLE PRECISION) AS sv_2, CAST(1.953171242442738 AS DOUBLE PRECISION) AS sv_3, CAST(-1.890023530710722 AS DOUBLE PRECISION) AS sv_4, CAST(2.134932485670478 AS DOUBLE PRECISION) AS sv_5, CAST(-0.948453835694261 AS DOUBLE PRECISION) AS sv_6, CAST(1.307028570732714 AS DOUBLE PRECISION) AS sv_7, CAST(1.668753501114158 AS DOUBLE PRECISION) AS sv_8, CAST(0.434472004966192 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 36 AS sv_idx, CAST(0.560199194027392 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.659408824021896 AS DOUBLE PRECISION) AS sv_0, CAST(2.105346528065548 AS DOUBLE PRECISION) AS sv_1, CAST(0.82763491415082 AS DOUBLE PRECISION) AS sv_2, CAST(4.619051035933396 AS DOUBLE PRECISION) AS sv_3, CAST(-0.42767878702292 AS DOUBLE PRECISION) AS sv_4, CAST(0.995938123567801 AS DOUBLE PRECISION) AS sv_5, CAST(-1.99723430530971 AS DOUBLE PRECISION) AS sv_6, CAST(3.390607716535005 AS DOUBLE PRECISION) AS sv_7, CAST(1.050379708514938 AS DOUBLE PRECISION) AS sv_8, CAST(-2.784423798446642 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 37 AS sv_idx, CAST(0.63259066429205 AS DOUBLE PRECISION) AS dual_coeff, CAST(-1.411313057128544 AS DOUBLE PRECISION) AS sv_0, CAST(-1.077874385285497 AS DOUBLE PRECISION) AS sv_1, CAST(0.087053389561302 AS DOUBLE PRECISION) AS sv_2, CAST(-3.63597761003692 AS DOUBLE PRECISION) AS sv_3, CAST(0.590949568646418 AS DOUBLE PRECISION) AS sv_4, CAST(-1.271007766915173 AS DOUBLE PRECISION) AS sv_5, CAST(1.770367863655151 AS DOUBLE PRECISION) AS sv_6, CAST(-4.638300055036927 AS DOUBLE PRECISION) AS sv_7, CAST(0.999564916000194 AS DOUBLE PRECISION) AS sv_8, CAST(0.643007239330219 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 38 AS sv_idx, CAST(0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.032340697730724 AS DOUBLE PRECISION) AS sv_0, CAST(-0.28184395289124 AS DOUBLE PRECISION) AS sv_1, CAST(-1.628840420019178 AS DOUBLE PRECISION) AS sv_2, CAST(-2.873412526216492 AS DOUBLE PRECISION) AS sv_3, CAST(1.211440453470976 AS DOUBLE PRECISION) AS sv_4, CAST(-0.144661843644594 AS DOUBLE PRECISION) AS sv_5, CAST(1.398816518165714 AS DOUBLE PRECISION) AS sv_6, CAST(-1.369748546437102 AS DOUBLE PRECISION) AS sv_7, CAST(-0.032772530203207 AS DOUBLE PRECISION) AS sv_8, CAST(0.458287938766164 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 39 AS sv_idx, CAST(0.696888104761191 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.919723457692772 AS DOUBLE PRECISION) AS sv_0, CAST(-0.725777519599824 AS DOUBLE PRECISION) AS sv_1, CAST(-1.582274274543365 AS DOUBLE PRECISION) AS sv_2, CAST(-3.44998409321108 AS DOUBLE PRECISION) AS sv_3, CAST(-1.214931148686492 AS DOUBLE PRECISION) AS sv_4, CAST(1.421875453224298 AS DOUBLE PRECISION) AS sv_5, CAST(1.533797857261079 AS DOUBLE PRECISION) AS sv_6, CAST(-2.976925103446512 AS DOUBLE PRECISION) AS sv_7, CAST(0.657503889500295 AS DOUBLE PRECISION) AS sv_8, CAST(1.331086979608724 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 40 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.003077309068269 AS DOUBLE PRECISION) AS sv_0, CAST(2.031845553628207 AS DOUBLE PRECISION) AS sv_1, CAST(-1.523343407131356 AS DOUBLE PRECISION) AS sv_2, CAST(0.412495310562481 AS DOUBLE PRECISION) AS sv_3, CAST(-0.738633992984463 AS DOUBLE PRECISION) AS sv_4, CAST(0.755448892846376 AS DOUBLE PRECISION) AS sv_5, CAST(0.051734789904433 AS DOUBLE PRECISION) AS sv_6, CAST(-0.201869716266698 AS DOUBLE PRECISION) AS sv_7, CAST(-2.06933020213559 AS DOUBLE PRECISION) AS sv_8, CAST(0.09421466978184 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 41 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.561651563112807 AS DOUBLE PRECISION) AS sv_0, CAST(0.54932743997605 AS DOUBLE PRECISION) AS sv_1, CAST(-1.78784131744186 AS DOUBLE PRECISION) AS sv_2, CAST(-1.592336079742726 AS DOUBLE PRECISION) AS sv_3, CAST(-0.968801731764567 AS DOUBLE PRECISION) AS sv_4, CAST(1.554754456022626 AS DOUBLE PRECISION) AS sv_5, CAST(0.790097590894606 AS DOUBLE PRECISION) AS sv_6, CAST(-1.171296904125234 AS DOUBLE PRECISION) AS sv_7, CAST(-1.670292043200369 AS DOUBLE PRECISION) AS sv_8, CAST(0.120620762404786 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 42 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.636305156382388 AS DOUBLE PRECISION) AS sv_0, CAST(1.743788490051133 AS DOUBLE PRECISION) AS sv_1, CAST(0.765717801134649 AS DOUBLE PRECISION) AS sv_2, CAST(2.546249335882604 AS DOUBLE PRECISION) AS sv_3, CAST(-2.097832522439988 AS DOUBLE PRECISION) AS sv_4, CAST(1.755082975978213 AS DOUBLE PRECISION) AS sv_5, CAST(-1.015282792026085 AS DOUBLE PRECISION) AS sv_6, CAST(-0.43351762342622 AS DOUBLE PRECISION) AS sv_7, CAST(0.540747310632309 AS DOUBLE PRECISION) AS sv_8, CAST(0.838281766139096 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 43 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-2.063295162834261 AS DOUBLE PRECISION) AS sv_0, CAST(2.733808388165165 AS DOUBLE PRECISION) AS sv_1, CAST(2.988845446966221 AS DOUBLE PRECISION) AS sv_2, CAST(5.185680756371328 AS DOUBLE PRECISION) AS sv_3, CAST(0.519963941902523 AS DOUBLE PRECISION) AS sv_4, CAST(-0.147525969102668 AS DOUBLE PRECISION) AS sv_5, CAST(-1.946205856146665 AS DOUBLE PRECISION) AS sv_6, CAST(0.343057625083097 AS DOUBLE PRECISION) AS sv_7, CAST(-0.222744448532082 AS DOUBLE PRECISION) AS sv_8, CAST(-0.505800386513862 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 44 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.321429771524548 AS DOUBLE PRECISION) AS sv_0, CAST(1.822224799379486 AS DOUBLE PRECISION) AS sv_1, CAST(-0.707341899412946 AS DOUBLE PRECISION) AS sv_2, CAST(0.694412071956306 AS DOUBLE PRECISION) AS sv_3, CAST(-0.437546982852218 AS DOUBLE PRECISION) AS sv_4, CAST(0.158535232818123 AS DOUBLE PRECISION) AS sv_5, CAST(-0.063747299055815 AS DOUBLE PRECISION) AS sv_6, CAST(-0.58344181233108 AS DOUBLE PRECISION) AS sv_7, CAST(-0.071171133350216 AS DOUBLE PRECISION) AS sv_8, CAST(0.008195345837627 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 45 AS sv_idx, CAST(-0.550346384335806 AS DOUBLE PRECISION) AS dual_coeff, CAST(-1.11848880136501 AS DOUBLE PRECISION) AS sv_0, CAST(-0.168868458457724 AS DOUBLE PRECISION) AS sv_1, CAST(-0.223173536621175 AS DOUBLE PRECISION) AS sv_2, CAST(-1.645559529132882 AS DOUBLE PRECISION) AS sv_3, CAST(-1.357151578902304 AS DOUBLE PRECISION) AS sv_4, CAST(1.134909791555809 AS DOUBLE PRECISION) AS sv_5, CAST(0.788493895482907 AS DOUBLE PRECISION) AS sv_6, CAST(-2.943594675304676 AS DOUBLE PRECISION) AS sv_7, CAST(-0.612066500568206 AS DOUBLE PRECISION) AS sv_8, CAST(-0.830021413428143 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 46 AS sv_idx, CAST(-0.558967012185746 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.298285664132398 AS DOUBLE PRECISION) AS sv_0, CAST(1.656221916126226 AS DOUBLE PRECISION) AS sv_1, CAST(-1.520806340019603 AS DOUBLE PRECISION) AS sv_2, CAST(-0.301169297575864 AS DOUBLE PRECISION) AS sv_3, CAST(-0.368741519444877 AS DOUBLE PRECISION) AS sv_4, CAST(-0.099040859101694 AS DOUBLE PRECISION) AS sv_5, CAST(0.371835245726029 AS DOUBLE PRECISION) AS sv_6, CAST(-0.715800206350932 AS DOUBLE PRECISION) AS sv_7, CAST(-0.087982786970129 AS DOUBLE PRECISION) AS sv_8, CAST(1.474609831869072 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 47 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(1.25055214745489 AS DOUBLE PRECISION) AS sv_0, CAST(1.870199938079145 AS DOUBLE PRECISION) AS sv_1, CAST(1.056063881500818 AS DOUBLE PRECISION) AS sv_2, CAST(2.134063175509098 AS DOUBLE PRECISION) AS sv_3, CAST(-0.57378352805883 AS DOUBLE PRECISION) AS sv_4, CAST(-0.225342647115863 AS DOUBLE PRECISION) AS sv_5, CAST(-0.684557522718788 AS DOUBLE PRECISION) AS sv_6, CAST(-1.08581757131165 AS DOUBLE PRECISION) AS sv_7, CAST(1.732798378035335 AS DOUBLE PRECISION) AS sv_8, CAST(0.613472813994274 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 48 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.726011587435791 AS DOUBLE PRECISION) AS sv_0, CAST(0.309192578753202 AS DOUBLE PRECISION) AS sv_1, CAST(0.685614314943201 AS DOUBLE PRECISION) AS sv_2, CAST(1.762854798440782 AS DOUBLE PRECISION) AS sv_3, CAST(-3.346410143785196 AS DOUBLE PRECISION) AS sv_4, CAST(-0.543863388860001 AS DOUBLE PRECISION) AS sv_5, CAST(-0.949559891607555 AS DOUBLE PRECISION) AS sv_6, CAST(-0.121323188634264 AS DOUBLE PRECISION) AS sv_7, CAST(-1.641501700691128 AS DOUBLE PRECISION) AS sv_8, CAST(-1.085697803504388 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 49 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.290004052410514 AS DOUBLE PRECISION) AS sv_0, CAST(2.036008458489042 AS DOUBLE PRECISION) AS sv_1, CAST(1.378378409904958 AS DOUBLE PRECISION) AS sv_2, CAST(3.223910378373741 AS DOUBLE PRECISION) AS sv_3, CAST(-0.691624288181792 AS DOUBLE PRECISION) AS sv_4, CAST(-1.788536070931852 AS DOUBLE PRECISION) AS sv_5, CAST(-1.216215897650886 AS DOUBLE PRECISION) AS sv_6, CAST(-0.0020605513233 AS DOUBLE PRECISION) AS sv_7, CAST(1.34199069536543 AS DOUBLE PRECISION) AS sv_8, CAST(-0.346354130113114 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 50 AS sv_idx, CAST(-0.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.016631584362008 AS DOUBLE PRECISION) AS sv_0, CAST(0.913454121042985 AS DOUBLE PRECISION) AS sv_1, CAST(0.673397490805059 AS DOUBLE PRECISION) AS sv_2, CAST(-0.130980761583581 AS DOUBLE PRECISION) AS sv_3, CAST(-0.615409344779914 AS DOUBLE PRECISION) AS sv_4, CAST(-0.548574995285362 AS DOUBLE PRECISION) AS sv_5, CAST(0.304101409215499 AS DOUBLE PRECISION) AS sv_6, CAST(-3.024010503018774 AS DOUBLE PRECISION) AS sv_7, CAST(-0.080428118334958 AS DOUBLE PRECISION) AS sv_8, CAST(0.639202058718576 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 51 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(-0.291573587962718 AS DOUBLE PRECISION) AS sv_0, CAST(0.871828315414173 AS DOUBLE PRECISION) AS sv_1, CAST(1.830615634433919 AS DOUBLE PRECISION) AS sv_2, CAST(2.86104823525729 AS DOUBLE PRECISION) AS sv_3, CAST(-0.320821691749587 AS DOUBLE PRECISION) AS sv_4, CAST(0.552204344225314 AS DOUBLE PRECISION) AS sv_5, CAST(-1.216027512546665 AS DOUBLE PRECISION) AS sv_6, CAST(0.557278901596259 AS DOUBLE PRECISION) AS sv_7, CAST(0.471519880982001 AS DOUBLE PRECISION) AS sv_8, CAST(0.224186959112815 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte UNION ALL SELECT 52 AS sv_idx, CAST(-1.0 AS DOUBLE PRECISION) AS dual_coeff, CAST(0.432931082918861 AS DOUBLE PRECISION) AS sv_0, CAST(1.991811281186579 AS DOUBLE PRECISION) AS sv_1, CAST(-1.178216364412042 AS DOUBLE PRECISION) AS sv_2, CAST(1.605070744977476 AS DOUBLE PRECISION) AS sv_3, CAST(-0.810536975719268 AS DOUBLE PRECISION) AS sv_4, CAST(-0.963038774873844 AS DOUBLE PRECISION) AS sv_5, CAST(-0.576157983042811 AS DOUBLE PRECISION) AS sv_6, CAST(1.359790384484652 AS DOUBLE PRECISION) AS sv_7, CAST(0.548504911132576 AS DOUBLE PRECISION) AS sv_8, CAST(0.749179211487966 AS DOUBLE PRECISION) AS sv_9 
FROM dummy_cte) AS "Values"), 
kernel_dp_2_3 AS 
(SELECT t_5."KEY" AS "KEY", t_5.dot_product AS dot_product 
FROM (SELECT full_join_data_sv_5."KEY" AS "KEY", sum(CAST(full_join_data_sv_5.dot_prod1 AS DOUBLE PRECISION)) + CAST(1.225684144486206 AS DOUBLE PRECISION) AS dot_product 
FROM (SELECT kernel_input."KEY" AS "KEY", "SV_data_2_3".dual_coeff * (kernel_input."Feature_0" * "SV_data_2_3".sv_0 + kernel_input."Feature_1" * "SV_data_2_3".sv_1 + kernel_input."Feature_2" * "SV_data_2_3".sv_2 + kernel_input."Feature_3" * "SV_data_2_3".sv_3 + kernel_input."Feature_4" * "SV_data_2_3".sv_4 + kernel_input."Feature_5" * "SV_data_2_3".sv_5 + kernel_input."Feature_6" * "SV_data_2_3".sv_6 + kernel_input."Feature_7" * "SV_data_2_3".sv_7 + kernel_input."Feature_8" * "SV_data_2_3".sv_8 + kernel_input."Feature_9" * "SV_data_2_3".sv_9) AS dot_prod1 
FROM kernel_input, "SV_data_2_3") AS full_join_data_sv_5 GROUP BY full_join_data_sv_5."KEY") AS t_5), 
kernel_cte_2_3 AS 
(SELECT kernel_dp_2_3."KEY" AS "KEY", 2 AS "OVO_Class1", 3 AS "OVO_Class2", CASE WHEN (-kernel_dp_2_3.dot_product >= CAST(0.0 AS DOUBLE PRECISION)) THEN 1 ELSE 0 END AS "OVO_Decision", coalesce(-kernel_dp_2_3.dot_product, CAST(1.0 AS DOUBLE PRECISION) / (CAST(1.0 AS DOUBLE PRECISION) + exp(least(greatest(-CAST(100.0 AS DOUBLE PRECISION), -(-((-kernel_dp_2_3.dot_product) * CAST(-1.24771947692396 AS DOUBLE PRECISION) + CAST(-0.178098196336609 AS DOUBLE PRECISION)))), CAST(100.0 AS DOUBLE PRECISION))))) AS "OVO_Conf" 
FROM kernel_dp_2_3)
 SELECT "KernAgg_B5"."KEY", "KernAgg_B5"."OVO_Class1", "KernAgg_B5"."OVO_Class2", "KernAgg_B5"."OVO_Decision", "KernAgg_B5"."OVO_Conf" 
FROM (SELECT "KernAgg_esu_5"."KEY" AS "KEY", "KernAgg_esu_5"."OVO_Class1" AS "OVO_Class1", "KernAgg_esu_5"."OVO_Class2" AS "OVO_Class2", "KernAgg_esu_5"."OVO_Decision" AS "OVO_Decision", "KernAgg_esu_5"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT kernel_cte_2_3."KEY" AS "KEY", kernel_cte_2_3."OVO_Class1" AS "OVO_Class1", kernel_cte_2_3."OVO_Class2" AS "OVO_Class2", kernel_cte_2_3."OVO_Decision" AS "OVO_Decision", kernel_cte_2_3."OVO_Conf" AS "OVO_Conf" 
FROM kernel_cte_2_3) AS "KernAgg_esu_5") AS "KernAgg_B5") AS "U"

-- Code For temporary table tmp_20180602143429_v2k_kernagg_agg part 1. Create 


CREATE GLOBAL TEMPORARY TABLE tmp_20180602143429_v2k_kernagg_agg  (
	"KEY" BIGINT, 
	"OVO_Vote_0" BIGINT, 
	"OVO_SumConfidence_0" DOUBLE PRECISION, 
	"OVO_Vote_1" BIGINT, 
	"OVO_SumConfidence_1" DOUBLE PRECISION, 
	"OVO_Vote_2" BIGINT, 
	"OVO_SumConfidence_2" DOUBLE PRECISION, 
	"OVO_Vote_3" BIGINT, 
	"OVO_SumConfidence_3" DOUBLE PRECISION, 
	max_abs_confidence DOUBLE PRECISION, 
	"OVO_Scale" DOUBLE PRECISION, 
	"Score_0" DOUBLE PRECISION, 
	"Score_1" DOUBLE PRECISION, 
	"Score_2" DOUBLE PRECISION, 
	"Score_3" DOUBLE PRECISION
)

 ON COMMIT PRESERVE ROWS

-- Code For temporary table tmp_20180602143429_v2k_kernagg_agg part 2. Populate

INSERT INTO tmp_20180602143429_v2k_kernagg_agg ("KEY", "OVO_Vote_0", "OVO_SumConfidence_0", "OVO_Vote_1", "OVO_SumConfidence_1", "OVO_Vote_2", "OVO_SumConfidence_2", "OVO_Vote_3", "OVO_SumConfidence_3", max_abs_confidence, "OVO_Scale", "Score_0", "Score_1", "Score_2", "Score_3") SELECT "U"."KEY", "U"."OVO_Vote_0", "U"."OVO_SumConfidence_0", "U"."OVO_Vote_1", "U"."OVO_SumConfidence_1", "U"."OVO_Vote_2", "U"."OVO_SumConfidence_2", "U"."OVO_Vote_3", "U"."OVO_SumConfidence_3", "U".max_abs_confidence, "U"."OVO_Scale", "U"."Score_0", "U"."Score_1", "U"."Score_2", "U"."Score_3" 
FROM (WITH "KernAgg_Union" AS 
(SELECT "KernAgg_EnsembleUnion"."KEY" AS "KEY", "KernAgg_EnsembleUnion"."OVO_Class1" AS "OVO_Class1", "KernAgg_EnsembleUnion"."OVO_Class2" AS "OVO_Class2", "KernAgg_EnsembleUnion"."OVO_Decision" AS "OVO_Decision", "KernAgg_EnsembleUnion"."OVO_Conf" AS "OVO_Conf" 
FROM (SELECT "KernAgg_B0"."KEY" AS "KEY", "KernAgg_B0"."OVO_Class1" AS "OVO_Class1", "KernAgg_B0"."OVO_Class2" AS "OVO_Class2", "KernAgg_B0"."OVO_Decision" AS "OVO_Decision", "KernAgg_B0"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143429_mqu_kernagg_b0 AS "KernAgg_B0" UNION ALL SELECT "KernAgg_B1"."KEY" AS "KEY", "KernAgg_B1"."OVO_Class1" AS "OVO_Class1", "KernAgg_B1"."OVO_Class2" AS "OVO_Class2", "KernAgg_B1"."OVO_Decision" AS "OVO_Decision", "KernAgg_B1"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143429_r6c_kernagg_b1 AS "KernAgg_B1" UNION ALL SELECT "KernAgg_B2"."KEY" AS "KEY", "KernAgg_B2"."OVO_Class1" AS "OVO_Class1", "KernAgg_B2"."OVO_Class2" AS "OVO_Class2", "KernAgg_B2"."OVO_Decision" AS "OVO_Decision", "KernAgg_B2"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143429_hxp_kernagg_b2 AS "KernAgg_B2" UNION ALL SELECT "KernAgg_B3"."KEY" AS "KEY", "KernAgg_B3"."OVO_Class1" AS "OVO_Class1", "KernAgg_B3"."OVO_Class2" AS "OVO_Class2", "KernAgg_B3"."OVO_Decision" AS "OVO_Decision", "KernAgg_B3"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143429_jpi_kernagg_b3 AS "KernAgg_B3" UNION ALL SELECT "KernAgg_B4"."KEY" AS "KEY", "KernAgg_B4"."OVO_Class1" AS "OVO_Class1", "KernAgg_B4"."OVO_Class2" AS "OVO_Class2", "KernAgg_B4"."OVO_Decision" AS "OVO_Decision", "KernAgg_B4"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143429_o5f_kernagg_b4 AS "KernAgg_B4" UNION ALL SELECT "KernAgg_B5"."KEY" AS "KEY", "KernAgg_B5"."OVO_Class1" AS "OVO_Class1", "KernAgg_B5"."OVO_Class2" AS "OVO_Class2", "KernAgg_B5"."OVO_Decision" AS "OVO_Decision", "KernAgg_B5"."OVO_Conf" AS "OVO_Conf" 
FROM tmp_20180602143429_gh2_kernagg_b5 AS "KernAgg_B5") AS "KernAgg_EnsembleUnion"), 
"OVO_Votes" AS 
(SELECT "Votes_Sel"."KEY" AS "KEY", "Votes_Sel"."OVO_Vote_0" AS "OVO_Vote_0", "Votes_Sel"."OVO_SumConfidence_0" AS "OVO_SumConfidence_0", "Votes_Sel"."OVO_Vote_1" AS "OVO_Vote_1", "Votes_Sel"."OVO_SumConfidence_1" AS "OVO_SumConfidence_1", "Votes_Sel"."OVO_Vote_2" AS "OVO_Vote_2", "Votes_Sel"."OVO_SumConfidence_2" AS "OVO_SumConfidence_2", "Votes_Sel"."OVO_Vote_3" AS "OVO_Vote_3", "Votes_Sel"."OVO_SumConfidence_3" AS "OVO_SumConfidence_3" 
FROM (SELECT "KernAgg_Union"."KEY" AS "KEY", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 0 OR "KernAgg_Union"."OVO_Class2" = 0) THEN 1 ELSE 0 END * (CASE WHEN ("KernAgg_Union"."OVO_Decision" = 0 AND "KernAgg_Union"."OVO_Class1" = 0) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Decision" = 1 AND "KernAgg_Union"."OVO_Class2" = 0) THEN 1 ELSE 0 END)) AS "OVO_Vote_0", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 0 OR "KernAgg_Union"."OVO_Class2" = 0) THEN 1 ELSE 0 END * "KernAgg_Union"."OVO_Conf" * (-CASE WHEN ("KernAgg_Union"."OVO_Class1" = 0) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Class2" = 0) THEN 1 ELSE 0 END)) AS "OVO_SumConfidence_0", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 1 OR "KernAgg_Union"."OVO_Class2" = 1) THEN 1 ELSE 0 END * (CASE WHEN ("KernAgg_Union"."OVO_Decision" = 0 AND "KernAgg_Union"."OVO_Class1" = 1) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Decision" = 1 AND "KernAgg_Union"."OVO_Class2" = 1) THEN 1 ELSE 0 END)) AS "OVO_Vote_1", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 1 OR "KernAgg_Union"."OVO_Class2" = 1) THEN 1 ELSE 0 END * "KernAgg_Union"."OVO_Conf" * (-CASE WHEN ("KernAgg_Union"."OVO_Class1" = 1) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Class2" = 1) THEN 1 ELSE 0 END)) AS "OVO_SumConfidence_1", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 2 OR "KernAgg_Union"."OVO_Class2" = 2) THEN 1 ELSE 0 END * (CASE WHEN ("KernAgg_Union"."OVO_Decision" = 0 AND "KernAgg_Union"."OVO_Class1" = 2) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Decision" = 1 AND "KernAgg_Union"."OVO_Class2" = 2) THEN 1 ELSE 0 END)) AS "OVO_Vote_2", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 2 OR "KernAgg_Union"."OVO_Class2" = 2) THEN 1 ELSE 0 END * "KernAgg_Union"."OVO_Conf" * (-CASE WHEN ("KernAgg_Union"."OVO_Class1" = 2) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Class2" = 2) THEN 1 ELSE 0 END)) AS "OVO_SumConfidence_2", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 3 OR "KernAgg_Union"."OVO_Class2" = 3) THEN 1 ELSE 0 END * (CASE WHEN ("KernAgg_Union"."OVO_Decision" = 0 AND "KernAgg_Union"."OVO_Class1" = 3) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Decision" = 1 AND "KernAgg_Union"."OVO_Class2" = 3) THEN 1 ELSE 0 END)) AS "OVO_Vote_3", sum(CASE WHEN ("KernAgg_Union"."OVO_Class1" = 3 OR "KernAgg_Union"."OVO_Class2" = 3) THEN 1 ELSE 0 END * "KernAgg_Union"."OVO_Conf" * (-CASE WHEN ("KernAgg_Union"."OVO_Class1" = 3) THEN 1 ELSE 0 END + CASE WHEN ("KernAgg_Union"."OVO_Class2" = 3) THEN 1 ELSE 0 END)) AS "OVO_SumConfidence_3" 
FROM "KernAgg_Union" GROUP BY "KernAgg_Union"."KEY") AS "Votes_Sel"), 
dummy_cte AS 
(SELECT CAST(0.0 AS DOUBLE PRECISION) AS "X"), 
"OVO_SumConf_CTE" AS 
(SELECT "Values"."KEY" AS "KEY", CAST("Values"."OVO_SumConfidence" AS DOUBLE PRECISION) AS "OVO_SumConfidence" 
FROM (SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_SumConfidence_0" AS "OVO_SumConfidence" 
FROM "OVO_Votes", dummy_cte UNION ALL SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_SumConfidence_1" AS "OVO_SumConfidence" 
FROM "OVO_Votes", dummy_cte UNION ALL SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_SumConfidence_2" AS "OVO_SumConfidence" 
FROM "OVO_Votes", dummy_cte UNION ALL SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_SumConfidence_3" AS "OVO_SumConfidence" 
FROM "OVO_Votes", dummy_cte) AS "Values"), 
"MinMaxConf" AS 
(SELECT min("OVO_SumConf_CTE"."OVO_SumConfidence") AS "OVO_min_conf", max("OVO_SumConf_CTE"."OVO_SumConfidence") AS "OVO_max_conf" 
FROM "OVO_SumConf_CTE"), 
"OVO_Votes_WithScale" AS 
(SELECT "OVO_Votes"."KEY" AS "KEY", "OVO_Votes"."OVO_Vote_0" AS "OVO_Vote_0", "OVO_Votes"."OVO_SumConfidence_0" AS "OVO_SumConfidence_0", "OVO_Votes"."OVO_Vote_1" AS "OVO_Vote_1", "OVO_Votes"."OVO_SumConfidence_1" AS "OVO_SumConfidence_1", "OVO_Votes"."OVO_Vote_2" AS "OVO_Vote_2", "OVO_Votes"."OVO_SumConfidence_2" AS "OVO_SumConfidence_2", "OVO_Votes"."OVO_Vote_3" AS "OVO_Vote_3", "OVO_Votes"."OVO_SumConfidence_3" AS "OVO_SumConfidence_3", CAST(CASE WHEN (abs("MinMaxConf"."OVO_min_conf") >= abs("MinMaxConf"."OVO_max_conf")) THEN abs("MinMaxConf"."OVO_min_conf") ELSE abs("MinMaxConf"."OVO_max_conf") END AS DOUBLE PRECISION) AS max_abs_confidence, CASE WHEN ("MinMaxConf"."OVO_max_conf" - "MinMaxConf"."OVO_min_conf" <= CAST(0.0 AS DOUBLE PRECISION)) THEN CAST(0.0 AS DOUBLE PRECISION) ELSE CAST(0.5 AS DOUBLE PRECISION) / CAST(CASE WHEN (abs("MinMaxConf"."OVO_min_conf") >= abs("MinMaxConf"."OVO_max_conf")) THEN abs("MinMaxConf"."OVO_min_conf") ELSE abs("MinMaxConf"."OVO_max_conf") END AS DOUBLE PRECISION) END AS "OVO_Scale" 
FROM "OVO_Votes", "MinMaxConf")
 SELECT "KernAgg_agg"."KEY", "KernAgg_agg"."OVO_Vote_0", "KernAgg_agg"."OVO_SumConfidence_0", "KernAgg_agg"."OVO_Vote_1", "KernAgg_agg"."OVO_SumConfidence_1", "KernAgg_agg"."OVO_Vote_2", "KernAgg_agg"."OVO_SumConfidence_2", "KernAgg_agg"."OVO_Vote_3", "KernAgg_agg"."OVO_SumConfidence_3", "KernAgg_agg".max_abs_confidence, "KernAgg_agg"."OVO_Scale", "KernAgg_agg"."Score_0", "KernAgg_agg"."Score_1", "KernAgg_agg"."Score_2", "KernAgg_agg"."Score_3" 
FROM (SELECT "OVO_Votes_WithScale"."KEY" AS "KEY", "OVO_Votes_WithScale"."OVO_Vote_0" AS "OVO_Vote_0", "OVO_Votes_WithScale"."OVO_SumConfidence_0" AS "OVO_SumConfidence_0", "OVO_Votes_WithScale"."OVO_Vote_1" AS "OVO_Vote_1", "OVO_Votes_WithScale"."OVO_SumConfidence_1" AS "OVO_SumConfidence_1", "OVO_Votes_WithScale"."OVO_Vote_2" AS "OVO_Vote_2", "OVO_Votes_WithScale"."OVO_SumConfidence_2" AS "OVO_SumConfidence_2", "OVO_Votes_WithScale"."OVO_Vote_3" AS "OVO_Vote_3", "OVO_Votes_WithScale"."OVO_SumConfidence_3" AS "OVO_SumConfidence_3", "OVO_Votes_WithScale".max_abs_confidence AS max_abs_confidence, "OVO_Votes_WithScale"."OVO_Scale" AS "OVO_Scale", "OVO_Votes_WithScale"."OVO_Vote_0" + "OVO_Votes_WithScale"."OVO_Scale" * "OVO_Votes_WithScale"."OVO_SumConfidence_0" AS "Score_0", "OVO_Votes_WithScale"."OVO_Vote_1" + "OVO_Votes_WithScale"."OVO_Scale" * "OVO_Votes_WithScale"."OVO_SumConfidence_1" AS "Score_1", "OVO_Votes_WithScale"."OVO_Vote_2" + "OVO_Votes_WithScale"."OVO_Scale" * "OVO_Votes_WithScale"."OVO_SumConfidence_2" AS "Score_2", "OVO_Votes_WithScale"."OVO_Vote_3" + "OVO_Votes_WithScale"."OVO_Scale" * "OVO_Votes_WithScale"."OVO_SumConfidence_3" AS "Score_3" 
FROM "OVO_Votes_WithScale") AS "KernAgg_agg") AS "U"

-- Model deployment code

WITH orig_cte AS 
(SELECT "KernAgg_agg"."KEY" AS "KEY", "KernAgg_agg"."Score_0" AS "Score_0", "KernAgg_agg"."Score_1" AS "Score_1", "KernAgg_agg"."Score_2" AS "Score_2", "KernAgg_agg"."Score_3" AS "Score_3", CAST(NULL AS DOUBLE PRECISION) AS "Proba_0", CAST(NULL AS DOUBLE PRECISION) AS "Proba_1", CAST(NULL AS DOUBLE PRECISION) AS "Proba_2", CAST(NULL AS DOUBLE PRECISION) AS "Proba_3", CAST(NULL AS DOUBLE PRECISION) AS "LogProba_0", CAST(NULL AS DOUBLE PRECISION) AS "LogProba_1", CAST(NULL AS DOUBLE PRECISION) AS "LogProba_2", CAST(NULL AS DOUBLE PRECISION) AS "LogProba_3", CAST(NULL AS BIGINT) AS "Decision", CAST(NULL AS DOUBLE PRECISION) AS "DecisionProba" 
FROM tmp_20180602143429_v2k_kernagg_agg AS "KernAgg_agg"), 
score_class_union AS 
(SELECT scu."KEY_u" AS "KEY_u", scu."class" AS "class", scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY_u", 0 AS "class", orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 1 AS "class", orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 2 AS "class", orig_cte."LogProba_2" AS "LogProba", orig_cte."Proba_2" AS "Proba", orig_cte."Score_2" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 3 AS "class", orig_cte."LogProba_3" AS "LogProba", orig_cte."Proba_3" AS "Proba", orig_cte."Score_3" AS "Score" 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Score_2" AS "Score_2", orig_cte."Score_3" AS "Score_3", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."Proba_2" AS "Proba_2", orig_cte."Proba_3" AS "Proba_3", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."LogProba_2" AS "LogProba_2", orig_cte."LogProba_3" AS "LogProba_3", orig_cte."Decision" AS "Decision", orig_cte."DecisionProba" AS "DecisionProba", max_select."KEY_m" AS "KEY_m", max_select."max_Score" AS "max_Score" 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union."KEY_u" AS "KEY_m", max(score_class_union."Score") AS "max_Score" 
FROM score_class_union GROUP BY score_class_union."KEY_u") AS max_select ON orig_cte."KEY" = max_select."KEY_m"), 
union_with_max AS 
(SELECT score_class_union."KEY_u" AS "KEY_u", score_class_union."class" AS "class", score_class_union."LogProba" AS "LogProba", score_class_union."Proba" AS "Proba", score_class_union."Score" AS "Score", score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Score" AS "max_Score" 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union."KEY_u" = score_max."KEY"), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Score" AS "max_Score", "arg_max_t_Score"."KEY_Score" AS "KEY_Score", "arg_max_t_Score"."arg_max_Score" AS "arg_max_Score" 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max."KEY" AS "KEY_Score", min(union_with_max."class") AS "arg_max_Score" 
FROM union_with_max 
WHERE union_with_max."Score" >= union_with_max."max_Score" GROUP BY union_with_max."KEY") AS "arg_max_t_Score" ON score_max."KEY" = "arg_max_t_Score"."KEY_Score")
 SELECT arg_max_cte."KEY" AS "KEY", arg_max_cte."Score_0" AS "Score_0", arg_max_cte."Score_1" AS "Score_1", arg_max_cte."Score_2" AS "Score_2", arg_max_cte."Score_3" AS "Score_3", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", arg_max_cte."Proba_2" AS "Proba_2", arg_max_cte."Proba_3" AS "Proba_3", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > CAST(0.0 AS DOUBLE PRECISION)) THEN ln(arg_max_cte."Proba_0") ELSE -1.79769313486231e+308 END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > CAST(0.0 AS DOUBLE PRECISION)) THEN ln(arg_max_cte."Proba_1") ELSE -1.79769313486231e+308 END AS "LogProba_1", CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > CAST(0.0 AS DOUBLE PRECISION)) THEN ln(arg_max_cte."Proba_2") ELSE -1.79769313486231e+308 END AS "LogProba_2", CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > CAST(0.0 AS DOUBLE PRECISION)) THEN ln(arg_max_cte."Proba_3") ELSE -1.79769313486231e+308 END AS "LogProba_3", arg_max_cte."arg_max_Score" AS "Decision", CASE WHEN (arg_max_cte."arg_max_Score" = 0) THEN arg_max_cte."Proba_0" WHEN (arg_max_cte."arg_max_Score" = 1) THEN arg_max_cte."Proba_1" WHEN (arg_max_cte."arg_max_Score" = 2) THEN arg_max_cte."Proba_2" WHEN (arg_max_cte."arg_max_Score" = 3) THEN arg_max_cte."Proba_3" END AS "DecisionProba" 
FROM arg_max_cte