-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "imp1_CTE" AS 
(SELECT "ADS"."KEY" AS join_key_0, CASE WHEN ("ADS"."Feature_0" IS NULL) THEN -0.0694906390703 ELSE "ADS"."Feature_0" END AS imp1_output_1, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN -0.119163503916 ELSE "ADS"."Feature_1" END AS imp1_output_2, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN -0.127896899745 ELSE "ADS"."Feature_2" END AS imp1_output_3, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN -0.114287346209 ELSE "ADS"."Feature_3" END AS imp1_output_4, CASE WHEN ("ADS"."Feature_4" IS NULL) THEN 0.0413271968547 ELSE "ADS"."Feature_4" END AS imp1_output_5 
FROM "INPUT_DATA" AS "ADS"), 
"pca_CTE" AS 
(SELECT "ADS"."KEY" AS join_key_1, ("ADS"."Feature_0" - -0.0694906390703) * -0.053647534364 + ("ADS"."Feature_1" - -0.119163503916) * -0.452838029092 + ("ADS"."Feature_2" - -0.127896899745) * 0.689918784888 + ("ADS"."Feature_3" - -0.114287346209) * -0.33402126184 + ("ADS"."Feature_4" - 0.0413271968547) * -0.452218452037 AS pca_output_1, ("ADS"."Feature_0" - -0.0694906390703) * -0.620732053756 + ("ADS"."Feature_1" - -0.119163503916) * 0.179006433042 + ("ADS"."Feature_2" - -0.127896899745) * 0.520498333383 + ("ADS"."Feature_3" - -0.114287346209) * 0.386172344142 + ("ADS"."Feature_4" - 0.0413271968547) * 0.403237919763 AS pca_output_2, ("ADS"."Feature_0" - -0.0694906390703) * 0.534948377585 + ("ADS"."Feature_1" - -0.119163503916) * -0.502789475991 + ("ADS"."Feature_2" - -0.127896899745) * 0.167923582168 + ("ADS"."Feature_3" - -0.114287346209) * 0.610459612885 + ("ADS"."Feature_4" - 0.0413271968547) * 0.245303297449 AS pca_output_3, ("ADS"."Feature_0" - -0.0694906390703) * 0.119525555247 + ("ADS"."Feature_1" - -0.119163503916) * -0.210071806412 + ("ADS"."Feature_2" - -0.127896899745) * 0.0756568397014 + ("ADS"."Feature_3" - -0.114287346209) * -0.602658142322 + ("ADS"."Feature_4" - 0.0413271968547) * 0.756744794427 AS pca_output_4, ("ADS"."Feature_0" - -0.0694906390703) * -0.557994206474 + ("ADS"."Feature_1" - -0.119163503916) * -0.682617751982 + ("ADS"."Feature_2" - -0.127896899745) * -0.468157311555 + ("ADS"."Feature_3" - -0.114287346209) * 0.0586765863683 + ("ADS"."Feature_4" - 0.0413271968547) * -0.0078268813005 AS pca_output_5 
FROM "INPUT_DATA" AS "ADS"), 
"Feature_Join_CTE" AS 
(SELECT "imp1_CTE".join_key_0 AS join_key_0, "imp1_CTE".imp1_output_1 AS imp1_output_1, "imp1_CTE".imp1_output_2 AS imp1_output_2, "imp1_CTE".imp1_output_3 AS imp1_output_3, "imp1_CTE".imp1_output_4 AS imp1_output_4, "imp1_CTE".imp1_output_5 AS imp1_output_5, "pca_CTE".join_key_1 AS join_key_1, "pca_CTE".pca_output_1 AS pca_output_1, "pca_CTE".pca_output_2 AS pca_output_2, "pca_CTE".pca_output_3 AS pca_output_3, "pca_CTE".pca_output_4 AS pca_output_4, "pca_CTE".pca_output_5 AS pca_output_5 
FROM "imp1_CTE" LEFT OUTER JOIN "pca_CTE" ON "imp1_CTE".join_key_0 = "pca_CTE".join_key_1)
 SELECT "Feature_Join_CTE".join_key_0 AS "KEY", "Feature_Join_CTE".imp1_output_1 AS "Feature_Join_CTE_imp1_output_1", "Feature_Join_CTE".imp1_output_2 AS "Feature_Join_CTE_imp1_output_2", "Feature_Join_CTE".imp1_output_3 AS "Feature_Join_CTE_imp1_output_3", "Feature_Join_CTE".imp1_output_4 AS "Feature_Join_CTE_imp1_output_4", "Feature_Join_CTE".imp1_output_5 AS "Feature_Join_CTE_imp1_output_5", "Feature_Join_CTE".pca_output_1 AS "Feature_Join_CTE_pca_output_1", "Feature_Join_CTE".pca_output_2 AS "Feature_Join_CTE_pca_output_2", "Feature_Join_CTE".pca_output_3 AS "Feature_Join_CTE_pca_output_3", "Feature_Join_CTE".pca_output_4 AS "Feature_Join_CTE_pca_output_4", "Feature_Join_CTE".pca_output_5 AS "Feature_Join_CTE_pca_output_5" 
FROM "Feature_Join_CTE"