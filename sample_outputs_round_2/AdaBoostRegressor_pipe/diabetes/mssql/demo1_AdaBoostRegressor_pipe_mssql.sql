-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH [ADS_imp_1_OUT] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_0] IS NULL) THEN -3.63428492931e-16 ELSE [ADS].[Feature_0] END AS impute_2, CASE WHEN ([ADS].[Feature_1] IS NULL) THEN 1.30834257455e-16 ELSE [ADS].[Feature_1] END AS impute_3, CASE WHEN ([ADS].[Feature_2] IS NULL) THEN -8.04534920334e-16 ELSE [ADS].[Feature_2] END AS impute_4, CASE WHEN ([ADS].[Feature_3] IS NULL) THEN 1.28165452107e-16 ELSE [ADS].[Feature_3] END AS impute_5, CASE WHEN ([ADS].[Feature_4] IS NULL) THEN -8.83531558624e-17 ELSE [ADS].[Feature_4] END AS impute_6, CASE WHEN ([ADS].[Feature_5] IS NULL) THEN 1.32702421198e-16 ELSE [ADS].[Feature_5] END AS impute_7, CASE WHEN ([ADS].[Feature_6] IS NULL) THEN -4.57464634298e-16 ELSE [ADS].[Feature_6] END AS impute_8, CASE WHEN ([ADS].[Feature_7] IS NULL) THEN 3.77730149823e-16 ELSE [ADS].[Feature_7] END AS impute_9, CASE WHEN ([ADS].[Feature_8] IS NULL) THEN -3.83085421731e-16 ELSE [ADS].[Feature_8] END AS impute_10, CASE WHEN ([ADS].[Feature_9] IS NULL) THEN -3.41288201508e-16 ELSE [ADS].[Feature_9] END AS impute_11 
FROM [INPUT_DATA] AS [ADS]), 
[CenteredDataForPCA] AS 
(SELECT [ADS_imp_1_OUT].[KEY] AS [KEY], [ADS_imp_1_OUT].impute_2 - -3.63428492931e-16 AS impute_2, [ADS_imp_1_OUT].impute_3 - 1.30834257455e-16 AS impute_3, [ADS_imp_1_OUT].impute_4 - -8.04534920334e-16 AS impute_4, [ADS_imp_1_OUT].impute_5 - 1.28165452107e-16 AS impute_5, [ADS_imp_1_OUT].impute_6 - -8.83531558624e-17 AS impute_6, [ADS_imp_1_OUT].impute_7 - 1.32702421198e-16 AS impute_7, [ADS_imp_1_OUT].impute_8 - -4.57464634298e-16 AS impute_8, [ADS_imp_1_OUT].impute_9 - 3.77730149823e-16 AS impute_9, [ADS_imp_1_OUT].impute_10 - -3.83085421731e-16 AS impute_10, [ADS_imp_1_OUT].impute_11 - -3.41288201508e-16 AS impute_11 
FROM [ADS_imp_1_OUT]), 
[ADS_ano_2_OUT] AS 
(SELECT [CenteredDataForPCA].[KEY] AS [KEY], [CenteredDataForPCA].impute_2 * 0.21643100659 + [CenteredDataForPCA].impute_3 * 0.186967108192 + [CenteredDataForPCA].impute_4 * 0.303162498817 + [CenteredDataForPCA].impute_5 * 0.271739703287 + [CenteredDataForPCA].impute_6 * 0.34325493123 + [CenteredDataForPCA].impute_7 * 0.351860620033 + [CenteredDataForPCA].impute_8 * -0.282436391838 + [CenteredDataForPCA].impute_9 * 0.428833247772 + [CenteredDataForPCA].impute_10 * 0.378617309164 + [CenteredDataForPCA].impute_11 * 0.322182824553 AS anoova_2, [CenteredDataForPCA].impute_2 * 0.044371505804 + [CenteredDataForPCA].impute_3 * -0.386548110735 + [CenteredDataForPCA].impute_4 * -0.156280609448 + [CenteredDataForPCA].impute_5 * -0.138255640728 + [CenteredDataForPCA].impute_6 * 0.573026691953 + [CenteredDataForPCA].impute_7 * 0.455939849626 + [CenteredDataForPCA].impute_8 * 0.506242872531 + [CenteredDataForPCA].impute_9 * -0.068184234517 + [CenteredDataForPCA].impute_10 * -0.0261893037261 + [CenteredDataForPCA].impute_11 * -0.0849466000238 AS anoova_3, [CenteredDataForPCA].impute_2 * 0.49466810716 + [CenteredDataForPCA].impute_3 * -0.106858334763 + [CenteredDataForPCA].impute_4 * 0.167531700938 + [CenteredDataForPCA].impute_5 * 0.513568043314 + [CenteredDataForPCA].impute_6 * -0.0685867001784 + [CenteredDataForPCA].impute_7 * -0.269694382255 + [CenteredDataForPCA].impute_8 * 0.386027874592 + [CenteredDataForPCA].impute_9 * -0.380681209291 + [CenteredDataForPCA].impute_10 * 0.0636315032871 + [CenteredDataForPCA].impute_11 * 0.276842712702 AS anoova_4, [CenteredDataForPCA].impute_2 * -0.414009498941 + [CenteredDataForPCA].impute_3 * -0.679860516614 + [CenteredDataForPCA].impute_4 * 0.499825330253 + [CenteredDataForPCA].impute_5 * -0.019667344342 + [CenteredDataForPCA].impute_6 * -0.0683953319645 + [CenteredDataForPCA].impute_7 * -0.167773837077 + [CenteredDataForPCA].impute_8 * -0.0760200485782 + [CenteredDataForPCA].impute_9 * 0.00792120338562 + [CenteredDataForPCA].impute_10 * 0.264427419183 + [CenteredDataForPCA].impute_11 * 0.0870862356146 AS anoova_5, [CenteredDataForPCA].impute_2 * -0.686863892154 + [CenteredDataForPCA].impute_3 * 0.373456115735 + [CenteredDataForPCA].impute_4 * 0.12935935855 + [CenteredDataForPCA].impute_5 * 0.486890138051 + [CenteredDataForPCA].impute_6 * 0.129174145487 + [CenteredDataForPCA].impute_7 * 0.116731430474 + [CenteredDataForPCA].impute_8 * 0.244991147174 + [CenteredDataForPCA].impute_9 * -0.14364377424 + [CenteredDataForPCA].impute_10 * -0.151661098575 + [CenteredDataForPCA].impute_11 * 0.0313879194047 AS anoova_6, [CenteredDataForPCA].impute_2 * -0.225850503591 + [CenteredDataForPCA].impute_3 * 0.0417310316277 + [CenteredDataForPCA].impute_4 * -0.403141902489 + [CenteredDataForPCA].impute_5 * -0.272762738803 + [CenteredDataForPCA].impute_6 * 0.00540864137623 + [CenteredDataForPCA].impute_7 * -0.13325719548 + [CenteredDataForPCA].impute_8 * 0.106371596751 + [CenteredDataForPCA].impute_9 * -0.0339453956408 + [CenteredDataForPCA].impute_10 * 0.178730050963 + [CenteredDataForPCA].impute_11 * 0.805064466151 AS anoova_7, [CenteredDataForPCA].impute_2 * -0.109538210099 + [CenteredDataForPCA].impute_3 * -0.0676055051661 + [CenteredDataForPCA].impute_4 * -0.519857870077 + [CenteredDataForPCA].impute_5 * 0.32064908429 + [CenteredDataForPCA].impute_6 * 0.0736490780231 + [CenteredDataForPCA].impute_7 * -0.230540112449 + [CenteredDataForPCA].impute_8 * -0.00753445287491 + [CenteredDataForPCA].impute_9 * 0.0712361931688 + [CenteredDataForPCA].impute_10 * 0.647313447679 + [CenteredDataForPCA].impute_11 * -0.357272785105 AS anoova_8, [CenteredDataForPCA].impute_2 * 0.0149346777542 + [CenteredDataForPCA].impute_3 * 0.442939663138 + [CenteredDataForPCA].impute_4 * 0.392941868456 + [CenteredDataForPCA].impute_5 * -0.477364351173 + [CenteredDataForPCA].impute_6 * 0.129413507459 + [CenteredDataForPCA].impute_7 * -0.191311206733 + [CenteredDataForPCA].impute_8 * 0.324636408704 + [CenteredDataForPCA].impute_9 * -0.180588338623 + [CenteredDataForPCA].impute_10 * 0.449660024059 + [CenteredDataForPCA].impute_11 * -0.166608696019 AS anoova_9, [CenteredDataForPCA].impute_2 * 0.00810057312789 + [CenteredDataForPCA].impute_3 * -0.00210552195289 + [CenteredDataForPCA].impute_4 * 0.0423775137715 + [CenteredDataForPCA].impute_5 * 0.027194101566 + [CenteredDataForPCA].impute_6 * -0.0420398366517 + [CenteredDataForPCA].impute_7 * -0.359315489659 + [CenteredDataForPCA].impute_8 * 0.481247705071 + [CenteredDataForPCA].impute_9 * 0.773816561846 + [CenteredDataForPCA].impute_10 * -0.18945947188 + [CenteredDataForPCA].impute_11 * -0.0152738068842 AS anoova_10, [CenteredDataForPCA].impute_2 * 0.00326308608059 + [CenteredDataForPCA].impute_3 * 0.00366069256477 + [CenteredDataForPCA].impute_4 * 0.00824808535829 + [CenteredDataForPCA].impute_5 * -0.00322110536704 + [CenteredDataForPCA].impute_6 * 0.709774472551 + [CenteredDataForPCA].impute_7 * -0.563196047553 + [CenteredDataForPCA].impute_8 * -0.317444125112 + [CenteredDataForPCA].impute_9 * -0.0905946399327 + [CenteredDataForPCA].impute_10 * -0.264467346072 + [CenteredDataForPCA].impute_11 * 0.00261090257808 AS anoova_11 
FROM [CenteredDataForPCA]), 
[DT_node_lookup] AS 
(SELECT [ADS_ano_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_ano_2_OUT].anoova_2 <= 0.031214548274874687) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_5 <= 0.04340079426765442) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_10 <= -0.020054494962096214) THEN 3 ELSE 4 END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_5 <= 0.07419989258050919) THEN 6 ELSE 7 END END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_5 <= -0.031565792858600616) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_10 <= 0.0029487840365618467) THEN 10 ELSE 11 END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_4 <= 0.08002756536006927) THEN 13 ELSE 14 END END END AS node_id_2 
FROM [ADS_ano_2_OUT]), 
[DT_node_data] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].[Estimator] AS [Estimator] 
FROM (SELECT 0 AS node_id, 'anoova_2' AS feature, 0.031214548274874687 AS threshold, 442 AS count, 0 AS depth, 152.89366515837105 AS [Estimator] UNION ALL SELECT 1 AS node_id, 'anoova_5' AS feature, 0.04340079426765442 AS threshold, 260 AS count, 1 AS depth, 115.71923076923076 AS [Estimator] UNION ALL SELECT 2 AS node_id, 'anoova_10' AS feature, -0.020054494962096214 AS threshold, 212 AS count, 2 AS depth, 102.48584905660377 AS [Estimator] UNION ALL SELECT 3 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 9 AS count, 3 AS depth, 202.88888888888889 AS [Estimator] UNION ALL SELECT 4 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 203 AS count, 3 AS depth, 98.03448275862068 AS [Estimator] UNION ALL SELECT 5 AS node_id, 'anoova_5' AS feature, 0.07419989258050919 AS threshold, 48 AS count, 2 AS depth, 174.16666666666666 AS [Estimator] UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 43 AS count, 3 AS depth, 186.25581395348837 AS [Estimator] UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 5 AS count, 3 AS depth, 70.2 AS [Estimator] UNION ALL SELECT 8 AS node_id, 'anoova_5' AS feature, -0.031565792858600616 AS threshold, 182 AS count, 1 AS depth, 206.0 AS [Estimator] UNION ALL SELECT 9 AS node_id, 'anoova_10' AS feature, 0.0029487840365618467 AS threshold, 56 AS count, 2 AS depth, 152.01785714285714 AS [Estimator] UNION ALL SELECT 10 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 42 AS count, 3 AS depth, 136.54761904761904 AS [Estimator] UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 14 AS count, 3 AS depth, 198.42857142857142 AS [Estimator] UNION ALL SELECT 12 AS node_id, 'anoova_4' AS feature, 0.08002756536006927 AS threshold, 126 AS count, 2 AS depth, 229.9920634920635 AS [Estimator] UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 112 AS count, 3 AS depth, 221.32142857142858 AS [Estimator] UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 14 AS count, 3 AS depth, 299.35714285714283 AS [Estimator]) AS [Values]), 
[DT_Output] AS 
(SELECT [DT_node_lookup].[KEY] AS [KEY], [DT_node_lookup].node_id_2 AS node_id_2, [DT_node_data].node_id AS node_id, [DT_node_data].feature AS feature, [DT_node_data].threshold AS threshold, [DT_node_data].count AS count, [DT_node_data].depth AS depth, [DT_node_data].[Estimator] AS [Estimator] 
FROM [DT_node_lookup] LEFT OUTER JOIN [DT_node_data] ON [DT_node_lookup].node_id_2 = [DT_node_data].node_id), 
[AdaBoost_Estim_0] AS 
(SELECT [DT_Output].[KEY] AS join_key_0, [DT_Output].[Estimator] AS [Estimator_0] 
FROM [DT_Output]), 
[DT_node_lookup_1] AS 
(SELECT [ADS_ano_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_ano_2_OUT].anoova_2 <= 0.0034621634986251593) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_5 <= 0.032367005944252014) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_4 <= 0.016795873641967773) THEN 3 ELSE 4 END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_2 <= -0.13615643978118896) THEN 6 ELSE 7 END END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_5 <= -0.04020959883928299) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_7 <= -0.01153608039021492) THEN 10 ELSE 11 END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_3 <= 0.00039059919072315097) THEN 13 ELSE 14 END END END AS node_id_2 
FROM [ADS_ano_2_OUT]), 
[DT_node_data_1] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].[Estimator] AS [Estimator] 
FROM (SELECT 0 AS node_id, 'anoova_2' AS feature, 0.0034621634986251593 AS threshold, 442 AS count, 0 AS depth, 155.9841628959276 AS [Estimator] UNION ALL SELECT 1 AS node_id, 'anoova_5' AS feature, 0.032367005944252014 AS threshold, 234 AS count, 1 AS depth, 125.86752136752136 AS [Estimator] UNION ALL SELECT 2 AS node_id, 'anoova_4' AS feature, 0.016795873641967773 AS threshold, 174 AS count, 2 AS depth, 109.30459770114942 AS [Estimator] UNION ALL SELECT 3 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 107 AS count, 3 AS depth, 90.59813084112149 AS [Estimator] UNION ALL SELECT 4 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 67 AS count, 3 AS depth, 139.17910447761193 AS [Estimator] UNION ALL SELECT 5 AS node_id, 'anoova_2' AS feature, -0.13615643978118896 AS threshold, 60 AS count, 2 AS depth, 173.9 AS [Estimator] UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 12 AS count, 3 AS depth, 115.08333333333333 AS [Estimator] UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 48 AS count, 3 AS depth, 188.60416666666666 AS [Estimator] UNION ALL SELECT 8 AS node_id, 'anoova_5' AS feature, -0.04020959883928299 AS threshold, 208 AS count, 1 AS depth, 189.8653846153846 AS [Estimator] UNION ALL SELECT 9 AS node_id, 'anoova_7' AS feature, -0.01153608039021492 AS threshold, 61 AS count, 2 AS depth, 144.70491803278688 AS [Estimator] UNION ALL SELECT 10 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 32 AS count, 3 AS depth, 176.40625 AS [Estimator] UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 29 AS count, 3 AS depth, 109.72413793103448 AS [Estimator] UNION ALL SELECT 12 AS node_id, 'anoova_3' AS feature, 0.00039059919072315097 AS threshold, 147 AS count, 2 AS depth, 208.60544217687075 AS [Estimator] UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 91 AS count, 3 AS depth, 228.1978021978022 AS [Estimator] UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 56 AS count, 3 AS depth, 176.76785714285714 AS [Estimator]) AS [Values]), 
[DT_Output_1] AS 
(SELECT [DT_node_lookup_1].[KEY] AS [KEY], [DT_node_lookup_1].node_id_2 AS node_id_2, [DT_node_data_1].node_id AS node_id, [DT_node_data_1].feature AS feature, [DT_node_data_1].threshold AS threshold, [DT_node_data_1].count AS count, [DT_node_data_1].depth AS depth, [DT_node_data_1].[Estimator] AS [Estimator] 
FROM [DT_node_lookup_1] LEFT OUTER JOIN [DT_node_data_1] ON [DT_node_lookup_1].node_id_2 = [DT_node_data_1].node_id), 
[AdaBoost_Estim_1] AS 
(SELECT [DT_Output_1].[KEY] AS join_key_1, [DT_Output_1].[Estimator] AS [Estimator_1] 
FROM [DT_Output_1]), 
[DT_node_lookup_2] AS 
(SELECT [ADS_ano_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_ano_2_OUT].anoova_2 <= 0.062239352613687515) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_5 <= 0.055580563843250275) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_2 <= -0.05446382611989975) THEN 3 ELSE 4 END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_2 <= -0.049433521926403046) THEN 6 ELSE 7 END END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_8 <= -0.03738218918442726) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_9 <= -0.005144236143678427) THEN 10 ELSE 11 END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_4 <= 0.025931144133210182) THEN 13 ELSE 14 END END END AS node_id_2 
FROM [ADS_ano_2_OUT]), 
[DT_node_data_2] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].[Estimator] AS [Estimator] 
FROM (SELECT 0 AS node_id, 'anoova_2' AS feature, 0.062239352613687515 AS threshold, 442 AS count, 0 AS depth, 160.79185520361992 AS [Estimator] UNION ALL SELECT 1 AS node_id, 'anoova_5' AS feature, 0.055580563843250275 AS threshold, 324 AS count, 1 AS depth, 137.65740740740742 AS [Estimator] UNION ALL SELECT 2 AS node_id, 'anoova_2' AS feature, -0.05446382611989975 AS threshold, 278 AS count, 2 AS depth, 124.56474820143885 AS [Estimator] UNION ALL SELECT 3 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 110 AS count, 3 AS depth, 96.4 AS [Estimator] UNION ALL SELECT 4 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 168 AS count, 3 AS depth, 143.00595238095238 AS [Estimator] UNION ALL SELECT 5 AS node_id, 'anoova_2' AS feature, -0.049433521926403046 AS threshold, 46 AS count, 2 AS depth, 216.7826086956522 AS [Estimator] UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 10 AS count, 3 AS depth, 144.7 AS [Estimator] UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 36 AS count, 3 AS depth, 236.80555555555554 AS [Estimator] UNION ALL SELECT 8 AS node_id, 'anoova_8' AS feature, -0.03738218918442726 AS threshold, 118 AS count, 1 AS depth, 224.3135593220339 AS [Estimator] UNION ALL SELECT 9 AS node_id, 'anoova_9' AS feature, -0.005144236143678427 AS threshold, 15 AS count, 2 AS depth, 312.3333333333333 AS [Estimator] UNION ALL SELECT 10 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 6 AS count, 3 AS depth, 282.8333333333333 AS [Estimator] UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 9 AS count, 3 AS depth, 332.0 AS [Estimator] UNION ALL SELECT 12 AS node_id, 'anoova_4' AS feature, 0.025931144133210182 AS threshold, 103 AS count, 2 AS depth, 211.49514563106797 AS [Estimator] UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 65 AS count, 3 AS depth, 187.1846153846154 AS [Estimator] UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 38 AS count, 3 AS depth, 253.07894736842104 AS [Estimator]) AS [Values]), 
[DT_Output_2] AS 
(SELECT [DT_node_lookup_2].[KEY] AS [KEY], [DT_node_lookup_2].node_id_2 AS node_id_2, [DT_node_data_2].node_id AS node_id, [DT_node_data_2].feature AS feature, [DT_node_data_2].threshold AS threshold, [DT_node_data_2].count AS count, [DT_node_data_2].depth AS depth, [DT_node_data_2].[Estimator] AS [Estimator] 
FROM [DT_node_lookup_2] LEFT OUTER JOIN [DT_node_data_2] ON [DT_node_lookup_2].node_id_2 = [DT_node_data_2].node_id), 
[AdaBoost_Estim_2] AS 
(SELECT [DT_Output_2].[KEY] AS join_key_2, [DT_Output_2].[Estimator] AS [Estimator_2] 
FROM [DT_Output_2]), 
[DT_node_lookup_3] AS 
(SELECT [ADS_ano_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_ano_2_OUT].anoova_2 <= -0.03873599320650101) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_6 <= -0.07683068513870239) THEN 2 ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_5 <= 0.0439368300139904) THEN 4 ELSE 5 END END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_5 <= 0.015399656258523464) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_2 <= 0.09598531574010849) THEN 8 ELSE 9 END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_3 <= -0.03743133693933487) THEN 11 ELSE 12 END END END AS node_id_2 
FROM [ADS_ano_2_OUT]), 
[DT_node_data_3] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].[Estimator] AS [Estimator] 
FROM (SELECT 0 AS node_id, 'anoova_2' AS feature, -0.03873599320650101 AS threshold, 442 AS count, 0 AS depth, 163.4389140271493 AS [Estimator] UNION ALL SELECT 1 AS node_id, 'anoova_6' AS feature, -0.07683068513870239 AS threshold, 168 AS count, 1 AS depth, 116.6547619047619 AS [Estimator] UNION ALL SELECT 2 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 10 AS count, 2 AS depth, 252.0 AS [Estimator] UNION ALL SELECT 3 AS node_id, 'anoova_5' AS feature, 0.0439368300139904 AS threshold, 158 AS count, 2 AS depth, 108.0886075949367 AS [Estimator] UNION ALL SELECT 4 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 139 AS count, 3 AS depth, 99.61870503597122 AS [Estimator] UNION ALL SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 19 AS count, 3 AS depth, 170.05263157894737 AS [Estimator] UNION ALL SELECT 6 AS node_id, 'anoova_5' AS feature, 0.015399656258523464 AS threshold, 274 AS count, 1 AS depth, 192.12408759124088 AS [Estimator] UNION ALL SELECT 7 AS node_id, 'anoova_2' AS feature, 0.09598531574010849 AS threshold, 155 AS count, 2 AS depth, 160.49032258064517 AS [Estimator] UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 112 AS count, 3 AS depth, 138.33035714285714 AS [Estimator] UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 43 AS count, 3 AS depth, 218.2093023255814 AS [Estimator] UNION ALL SELECT 10 AS node_id, 'anoova_3' AS feature, -0.03743133693933487 AS threshold, 119 AS count, 2 AS depth, 233.32773109243698 AS [Estimator] UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 33 AS count, 3 AS depth, 297.6060606060606 AS [Estimator] UNION ALL SELECT 12 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 86 AS count, 3 AS depth, 208.6627906976744 AS [Estimator]) AS [Values]), 
[DT_Output_3] AS 
(SELECT [DT_node_lookup_3].[KEY] AS [KEY], [DT_node_lookup_3].node_id_2 AS node_id_2, [DT_node_data_3].node_id AS node_id, [DT_node_data_3].feature AS feature, [DT_node_data_3].threshold AS threshold, [DT_node_data_3].count AS count, [DT_node_data_3].depth AS depth, [DT_node_data_3].[Estimator] AS [Estimator] 
FROM [DT_node_lookup_3] LEFT OUTER JOIN [DT_node_data_3] ON [DT_node_lookup_3].node_id_2 = [DT_node_data_3].node_id), 
[AdaBoost_Estim_3] AS 
(SELECT [DT_Output_3].[KEY] AS join_key_3, [DT_Output_3].[Estimator] AS [Estimator_3] 
FROM [DT_Output_3]), 
[DT_node_lookup_4] AS 
(SELECT [ADS_ano_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_ano_2_OUT].anoova_5 <= 0.0911175012588501) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_4 <= 0.017094865441322327) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_5 <= 0.031191857531666756) THEN 3 ELSE 4 END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_3 <= 0.0285981185734272) THEN 6 ELSE 7 END END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_4 <= -0.034240879118442535) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_8 <= -0.045723751187324524) THEN 10 ELSE 11 END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_11 <= -0.0014069885946810246) THEN 13 ELSE 14 END END END AS node_id_2 
FROM [ADS_ano_2_OUT]), 
[DT_node_data_4] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].[Estimator] AS [Estimator] 
FROM (SELECT 0 AS node_id, 'anoova_5' AS feature, 0.0911175012588501 AS threshold, 442 AS count, 0 AS depth, 158.3733031674208 AS [Estimator] UNION ALL SELECT 1 AS node_id, 'anoova_4' AS feature, 0.017094865441322327 AS threshold, 421 AS count, 1 AS depth, 151.53681710213777 AS [Estimator] UNION ALL SELECT 2 AS node_id, 'anoova_5' AS feature, 0.031191857531666756 AS threshold, 247 AS count, 2 AS depth, 126.10931174089069 AS [Estimator] UNION ALL SELECT 3 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 185 AS count, 3 AS depth, 113.16756756756757 AS [Estimator] UNION ALL SELECT 4 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 62 AS count, 3 AS depth, 164.7258064516129 AS [Estimator] UNION ALL SELECT 5 AS node_id, 'anoova_3' AS feature, 0.0285981185734272 AS threshold, 174 AS count, 2 AS depth, 187.632183908046 AS [Estimator] UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 115 AS count, 3 AS depth, 216.90434782608696 AS [Estimator] UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 59 AS count, 3 AS depth, 130.57627118644066 AS [Estimator] UNION ALL SELECT 8 AS node_id, 'anoova_4' AS feature, -0.034240879118442535 AS threshold, 21 AS count, 1 AS depth, 295.42857142857144 AS [Estimator] UNION ALL SELECT 9 AS node_id, 'anoova_8' AS feature, -0.045723751187324524 AS threshold, 13 AS count, 2 AS depth, 322.61538461538464 AS [Estimator] UNION ALL SELECT 10 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 5 AS count, 3 AS depth, 346.0 AS [Estimator] UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 8 AS count, 3 AS depth, 308.0 AS [Estimator] UNION ALL SELECT 12 AS node_id, 'anoova_11' AS feature, -0.0014069885946810246 AS threshold, 8 AS count, 2 AS depth, 251.25 AS [Estimator] UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 3 AS depth, 128.0 AS [Estimator] UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 7 AS count, 3 AS depth, 268.85714285714283 AS [Estimator]) AS [Values]), 
[DT_Output_4] AS 
(SELECT [DT_node_lookup_4].[KEY] AS [KEY], [DT_node_lookup_4].node_id_2 AS node_id_2, [DT_node_data_4].node_id AS node_id, [DT_node_data_4].feature AS feature, [DT_node_data_4].threshold AS threshold, [DT_node_data_4].count AS count, [DT_node_data_4].depth AS depth, [DT_node_data_4].[Estimator] AS [Estimator] 
FROM [DT_node_lookup_4] LEFT OUTER JOIN [DT_node_data_4] ON [DT_node_lookup_4].node_id_2 = [DT_node_data_4].node_id), 
[AdaBoost_Estim_4] AS 
(SELECT [DT_Output_4].[KEY] AS join_key_4, [DT_Output_4].[Estimator] AS [Estimator_4] 
FROM [DT_Output_4]), 
[DT_node_lookup_5] AS 
(SELECT [ADS_ano_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_ano_2_OUT].anoova_2 <= 0.10561374574899673) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_11 <= -0.0008645701454952359) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_3 <= -0.05291302502155304) THEN 3 ELSE 4 END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_5 <= 0.01445391308516264) THEN 6 ELSE 7 END END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_2 <= 0.23514457046985626) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_3 <= -0.020511489361524582) THEN 10 ELSE 11 END ELSE 12 END END AS node_id_2 
FROM [ADS_ano_2_OUT]), 
[DT_node_data_5] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].[Estimator] AS [Estimator] 
FROM (SELECT 0 AS node_id, 'anoova_2' AS feature, 0.10561374574899673 AS threshold, 442 AS count, 0 AS depth, 163.81674208144796 AS [Estimator] UNION ALL SELECT 1 AS node_id, 'anoova_11' AS feature, -0.0008645701454952359 AS threshold, 389 AS count, 1 AS depth, 152.19537275064266 AS [Estimator] UNION ALL SELECT 2 AS node_id, 'anoova_3' AS feature, -0.05291302502155304 AS threshold, 223 AS count, 2 AS depth, 176.03139013452915 AS [Estimator] UNION ALL SELECT 3 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 55 AS count, 3 AS depth, 225.8 AS [Estimator] UNION ALL SELECT 4 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 168 AS count, 3 AS depth, 159.73809523809524 AS [Estimator] UNION ALL SELECT 5 AS node_id, 'anoova_5' AS feature, 0.01445391308516264 AS threshold, 166 AS count, 2 AS depth, 120.17469879518072 AS [Estimator] UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 92 AS count, 3 AS depth, 94.56521739130434 AS [Estimator] UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 74 AS count, 3 AS depth, 152.01351351351352 AS [Estimator] UNION ALL SELECT 8 AS node_id, 'anoova_2' AS feature, 0.23514457046985626 AS threshold, 53 AS count, 1 AS depth, 249.11320754716982 AS [Estimator] UNION ALL SELECT 9 AS node_id, 'anoova_3' AS feature, -0.020511489361524582 AS threshold, 50 AS count, 2 AS depth, 259.02 AS [Estimator] UNION ALL SELECT 10 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 21 AS count, 3 AS depth, 297.14285714285717 AS [Estimator] UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 29 AS count, 3 AS depth, 231.41379310344828 AS [Estimator] UNION ALL SELECT 12 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 2 AS depth, 84.0 AS [Estimator]) AS [Values]), 
[DT_Output_5] AS 
(SELECT [DT_node_lookup_5].[KEY] AS [KEY], [DT_node_lookup_5].node_id_2 AS node_id_2, [DT_node_data_5].node_id AS node_id, [DT_node_data_5].feature AS feature, [DT_node_data_5].threshold AS threshold, [DT_node_data_5].count AS count, [DT_node_data_5].depth AS depth, [DT_node_data_5].[Estimator] AS [Estimator] 
FROM [DT_node_lookup_5] LEFT OUTER JOIN [DT_node_data_5] ON [DT_node_lookup_5].node_id_2 = [DT_node_data_5].node_id), 
[AdaBoost_Estim_5] AS 
(SELECT [DT_Output_5].[KEY] AS join_key_5, [DT_Output_5].[Estimator] AS [Estimator_5] 
FROM [DT_Output_5]), 
[AdaBoost_Join_CTE] AS 
(SELECT [AdaBoost_Estim_0].join_key_0 AS join_key_0, [AdaBoost_Estim_0].[Estimator_0] AS [Estimator_0], [AdaBoost_Estim_1].join_key_1 AS join_key_1, [AdaBoost_Estim_1].[Estimator_1] AS [Estimator_1], [AdaBoost_Estim_2].join_key_2 AS join_key_2, [AdaBoost_Estim_2].[Estimator_2] AS [Estimator_2], [AdaBoost_Estim_3].join_key_3 AS join_key_3, [AdaBoost_Estim_3].[Estimator_3] AS [Estimator_3], [AdaBoost_Estim_4].join_key_4 AS join_key_4, [AdaBoost_Estim_4].[Estimator_4] AS [Estimator_4], [AdaBoost_Estim_5].join_key_5 AS join_key_5, [AdaBoost_Estim_5].[Estimator_5] AS [Estimator_5] 
FROM [AdaBoost_Estim_0] LEFT OUTER JOIN [AdaBoost_Estim_1] ON [AdaBoost_Estim_0].join_key_0 = [AdaBoost_Estim_1].join_key_1 LEFT OUTER JOIN [AdaBoost_Estim_2] ON [AdaBoost_Estim_2].join_key_2 = [AdaBoost_Estim_1].join_key_1 LEFT OUTER JOIN [AdaBoost_Estim_3] ON [AdaBoost_Estim_3].join_key_3 = [AdaBoost_Estim_2].join_key_2 LEFT OUTER JOIN [AdaBoost_Estim_4] ON [AdaBoost_Estim_4].join_key_4 = [AdaBoost_Estim_3].join_key_3 LEFT OUTER JOIN [AdaBoost_Estim_5] ON [AdaBoost_Estim_5].join_key_5 = [AdaBoost_Estim_4].join_key_4), 
[WeightedEstimators] AS 
(SELECT [Values].[Key] AS [Key], [Values].sub_estimator AS sub_estimator, [Values].[Weight] AS [Weight], [Values].[Value] AS [Value] 
FROM (SELECT [AdaBoost_Join_CTE].join_key_0 AS [Key], 0 AS sub_estimator, 0.257562251251 AS [Weight], [AdaBoost_Join_CTE].[Estimator_0] AS [Value] 
FROM [AdaBoost_Join_CTE] UNION ALL SELECT [AdaBoost_Join_CTE].join_key_0 AS [Key], 1 AS sub_estimator, 0.150647093187 AS [Weight], [AdaBoost_Join_CTE].[Estimator_1] AS [Value] 
FROM [AdaBoost_Join_CTE] UNION ALL SELECT [AdaBoost_Join_CTE].join_key_0 AS [Key], 2 AS sub_estimator, 0.186998616447 AS [Weight], [AdaBoost_Join_CTE].[Estimator_2] AS [Value] 
FROM [AdaBoost_Join_CTE] UNION ALL SELECT [AdaBoost_Join_CTE].join_key_0 AS [Key], 3 AS sub_estimator, 0.128228266648 AS [Weight], [AdaBoost_Join_CTE].[Estimator_3] AS [Value] 
FROM [AdaBoost_Join_CTE] UNION ALL SELECT [AdaBoost_Join_CTE].join_key_0 AS [Key], 4 AS sub_estimator, 0.17998774786 AS [Weight], [AdaBoost_Join_CTE].[Estimator_4] AS [Value] 
FROM [AdaBoost_Join_CTE] UNION ALL SELECT [AdaBoost_Join_CTE].join_key_0 AS [Key], 5 AS sub_estimator, 0.0965760246083 AS [Weight], [AdaBoost_Join_CTE].[Estimator_5] AS [Value] 
FROM [AdaBoost_Join_CTE]) AS [Values]), 
[Cumulative_Frequencies] AS 
(SELECT u1.[Key] AS [Key], u1.sub_estimator AS sub_estimator, u1.[Weight] AS [Weight], u1.[Value] AS [Value], (SELECT sum(u2.[Weight]) AS sum_1 
FROM [WeightedEstimators] AS u2 
WHERE u1.[Key] = u2.[Key] AND u1.[Value] >= u2.[Value]) AS cum_weight 
FROM [WeightedEstimators] AS u1), 
[Quantiles] AS 
(SELECT [AdaBoost_Join_CTE].join_key_0 AS join_key_0, [AdaBoost_Join_CTE].[Estimator_0] AS [Estimator_0], [AdaBoost_Join_CTE].join_key_1 AS join_key_1, [AdaBoost_Join_CTE].[Estimator_1] AS [Estimator_1], [AdaBoost_Join_CTE].join_key_2 AS join_key_2, [AdaBoost_Join_CTE].[Estimator_2] AS [Estimator_2], [AdaBoost_Join_CTE].join_key_3 AS join_key_3, [AdaBoost_Join_CTE].[Estimator_3] AS [Estimator_3], [AdaBoost_Join_CTE].join_key_4 AS join_key_4, [AdaBoost_Join_CTE].[Estimator_4] AS [Estimator_4], [AdaBoost_Join_CTE].join_key_5 AS join_key_5, [AdaBoost_Join_CTE].[Estimator_5] AS [Estimator_5], (SELECT min([Cumulative_Frequencies].[Value]) AS min_1 
FROM [Cumulative_Frequencies] 
WHERE [AdaBoost_Join_CTE].join_key_0 = [Cumulative_Frequencies].[Key] AND [Cumulative_Frequencies].cum_weight >= 0.5) AS [Median] 
FROM [AdaBoost_Join_CTE])
 SELECT [Quantiles].join_key_0 AS [KEY], [Quantiles].[Median] AS [Estimator] 
FROM [Quantiles]