-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH [DT_node_lookup] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_22] <= 91.56745080902397) THEN CASE WHEN ([ADS].[Feature_4] <= 0.11026188321941072) THEN CASE WHEN ([ADS].[Feature_13] <= 48.881321431105356) THEN 3 ELSE 4 END ELSE CASE WHEN ([ADS].[Feature_8] <= 0.19112088993390708) THEN 6 ELSE 7 END END ELSE CASE WHEN ([ADS].[Feature_6] <= 0.06770218264116855) THEN CASE WHEN ([ADS].[Feature_22] <= 133.41958763330575) THEN 10 ELSE 11 END ELSE CASE WHEN ([ADS].[Feature_25] <= 0.14870953864364614) THEN 13 ELSE 14 END END END AS node_id_2 
FROM [INPUT_DATA] AS [ADS]), 
[DT_node_data] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].[Proba_0] AS [Proba_0], [Values].[LogProba_0] AS [LogProba_0], [Values].[Proba_1] AS [Proba_1], [Values].[LogProba_1] AS [LogProba_1], [Values].[Decision] AS [Decision] 
FROM (SELECT 0 AS node_id, 'Feature_22' AS feature, 91.56745080902397 AS threshold, 569 AS count, 0 AS depth, 0.37258347978910367 AS [Proba_0], -0.987294159454 AS [LogProba_0], 0.6274165202108963 AS [Proba_1], -0.466144652347 AS [LogProba_1], 1 AS [Decision] UNION ALL SELECT 1 AS node_id, 'Feature_4' AS feature, 0.11026188321941072 AS threshold, 231 AS count, 1 AS depth, 0.008658008658008658 AS [Proba_0], -4.74927052996 AS [LogProba_0], 0.9913419913419913 AS [Proba_1], -0.00869570696755 AS [LogProba_1], 1 AS [Decision] UNION ALL SELECT 2 AS node_id, 'Feature_13' AS feature, 48.881321431105356 AS threshold, 208 AS count, 2 AS depth, 0.004807692307692308 AS [Proba_0], -5.3375380797 AS [LogProba_0], 0.9951923076923077 AS [Proba_1], -0.00481928643595 AS [LogProba_1], 1 AS [Decision] UNION ALL SELECT 3 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 205 AS count, 3 AS depth, 0.0 AS [Proba_0], -1.79769313486231e+308 AS [LogProba_0], 1.0 AS [Proba_1], 0.0 AS [LogProba_1], 1 AS [Decision] UNION ALL SELECT 4 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 3 AS depth, 0.3333333333333333 AS [Proba_0], -1.09861228867 AS [LogProba_0], 0.6666666666666666 AS [Proba_1], -0.405465108108 AS [LogProba_1], 1 AS [Decision] UNION ALL SELECT 5 AS node_id, 'Feature_8' AS feature, 0.19112088993390708 AS threshold, 23 AS count, 2 AS depth, 0.043478260869565216 AS [Proba_0], -3.13549421593 AS [LogProba_0], 0.9565217391304348 AS [Proba_1], -0.0444517625708 AS [LogProba_1], 1 AS [Decision] UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 6 AS count, 3 AS depth, 0.16666666666666666 AS [Proba_0], -1.79175946923 AS [LogProba_0], 0.8333333333333334 AS [Proba_1], -0.182321556794 AS [LogProba_1], 1 AS [Decision] UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 17 AS count, 3 AS depth, 0.0 AS [Proba_0], -1.79769313486231e+308 AS [LogProba_0], 1.0 AS [Proba_1], 0.0 AS [LogProba_1], 1 AS [Decision] UNION ALL SELECT 8 AS node_id, 'Feature_6' AS feature, 0.06770218264116855 AS threshold, 338 AS count, 1 AS depth, 0.621301775147929 AS [Proba_0], -0.475938364766 AS [LogProba_0], 0.378698224852071 AS [Proba_1], -0.971015631563 AS [LogProba_1], 0 AS [Decision] UNION ALL SELECT 9 AS node_id, 'Feature_22' AS feature, 133.41958763330575 AS threshold, 105 AS count, 2 AS depth, 0.13333333333333333 AS [Proba_0], -2.01490302054 AS [LogProba_0], 0.8666666666666667 AS [Proba_1], -0.143100843641 AS [LogProba_1], 1 AS [Decision] UNION ALL SELECT 10 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 104 AS count, 3 AS depth, 0.125 AS [Proba_0], -2.07944154168 AS [LogProba_0], 0.875 AS [Proba_1], -0.133531392625 AS [LogProba_1], 1 AS [Decision] UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 3 AS depth, 1.0 AS [Proba_0], 0.0 AS [LogProba_0], 0.0 AS [Proba_1], -1.79769313486231e+308 AS [LogProba_1], 0 AS [Decision] UNION ALL SELECT 12 AS node_id, 'Feature_25' AS feature, 0.14870953864364614 AS threshold, 233 AS count, 2 AS depth, 0.8412017167381974 AS [Proba_0], -0.172923794335 AS [LogProba_0], 0.15879828326180256 AS [Proba_1], -1.84012054092 AS [LogProba_1], 0 AS [Decision] UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 6 AS count, 3 AS depth, 0.5 AS [Proba_0], -0.69314718056 AS [LogProba_0], 0.5 AS [Proba_1], -0.69314718056 AS [LogProba_1], 0 AS [Decision] UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 227 AS count, 3 AS depth, 0.8502202643171806 AS [Proba_0], -0.162259828577 AS [LogProba_0], 0.14977973568281938 AS [Proba_1], -1.89858949287 AS [LogProba_1], 0 AS [Decision]) AS [Values]), 
[DT_Output] AS 
(SELECT [DT_node_lookup].[KEY] AS [KEY], [DT_node_lookup].node_id_2 AS node_id_2, [DT_node_data].node_id AS node_id, [DT_node_data].feature AS feature, [DT_node_data].threshold AS threshold, [DT_node_data].count AS count, [DT_node_data].depth AS depth, [DT_node_data].[Proba_0] AS [Proba_0], [DT_node_data].[LogProba_0] AS [LogProba_0], [DT_node_data].[Proba_1] AS [Proba_1], [DT_node_data].[LogProba_1] AS [LogProba_1], [DT_node_data].[Decision] AS [Decision] 
FROM [DT_node_lookup] LEFT OUTER JOIN [DT_node_data] ON [DT_node_lookup].node_id_2 = [DT_node_data].node_id)
 SELECT [DT_Output].[KEY] AS [KEY], CAST(NULL AS FLOAT) AS [Score_0], CAST(NULL AS FLOAT) AS [Score_1], [DT_Output].[Proba_0] AS [Proba_0], [DT_Output].[Proba_1] AS [Proba_1], [DT_Output].[LogProba_0] AS [LogProba_0], [DT_Output].[LogProba_1] AS [LogProba_1], [DT_Output].[Decision] AS [Decision] 
FROM [DT_Output]