-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH [ADS_imp_1_OUT] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_0] IS NULL) THEN 0.0744092046538 ELSE [ADS].[Feature_0] END AS impute_2, CASE WHEN ([ADS].[Feature_1] IS NULL) THEN -0.228525648842 ELSE [ADS].[Feature_1] END AS impute_3, CASE WHEN ([ADS].[Feature_2] IS NULL) THEN -0.0196614726036 ELSE [ADS].[Feature_2] END AS impute_4, CASE WHEN ([ADS].[Feature_3] IS NULL) THEN 0.0747043986171 ELSE [ADS].[Feature_3] END AS impute_5, CASE WHEN ([ADS].[Feature_4] IS NULL) THEN 0.159222763454 ELSE [ADS].[Feature_4] END AS impute_6, CASE WHEN ([ADS].[Feature_5] IS NULL) THEN -0.136374172716 ELSE [ADS].[Feature_5] END AS impute_7, CASE WHEN ([ADS].[Feature_6] IS NULL) THEN -0.0346276103782 ELSE [ADS].[Feature_6] END AS impute_8, CASE WHEN ([ADS].[Feature_7] IS NULL) THEN -0.0329307540028 ELSE [ADS].[Feature_7] END AS impute_9, CASE WHEN ([ADS].[Feature_8] IS NULL) THEN -0.10394355107 ELSE [ADS].[Feature_8] END AS impute_10, CASE WHEN ([ADS].[Feature_9] IS NULL) THEN -0.0870324604905 ELSE [ADS].[Feature_9] END AS impute_11, CASE WHEN ([ADS].[Feature_10] IS NULL) THEN -0.053446813238 ELSE [ADS].[Feature_10] END AS impute_12, CASE WHEN ([ADS].[Feature_11] IS NULL) THEN 0.0279932707486 ELSE [ADS].[Feature_11] END AS impute_13, CASE WHEN ([ADS].[Feature_12] IS NULL) THEN 0.718463021481 ELSE [ADS].[Feature_12] END AS impute_14, CASE WHEN ([ADS].[Feature_13] IS NULL) THEN 0.0853659871147 ELSE [ADS].[Feature_13] END AS impute_15, CASE WHEN ([ADS].[Feature_14] IS NULL) THEN -0.03968512249 ELSE [ADS].[Feature_14] END AS impute_16, CASE WHEN ([ADS].[Feature_15] IS NULL) THEN 0.163279377672 ELSE [ADS].[Feature_15] END AS impute_17, CASE WHEN ([ADS].[Feature_16] IS NULL) THEN 0.224539814004 ELSE [ADS].[Feature_16] END AS impute_18, CASE WHEN ([ADS].[Feature_17] IS NULL) THEN 0.0543965428835 ELSE [ADS].[Feature_17] END AS impute_19, CASE WHEN ([ADS].[Feature_18] IS NULL) THEN 0.0620472007054 ELSE [ADS].[Feature_18] END AS impute_20, CASE WHEN ([ADS].[Feature_19] IS NULL) THEN -0.0589405202817 ELSE [ADS].[Feature_19] END AS impute_21 
FROM [INPUT_DATA] AS [ADS]), 
[CenteredDataForPCA] AS 
(SELECT [ADS_imp_1_OUT].[KEY] AS [KEY], [ADS_imp_1_OUT].impute_2 - 0.0744092046538 AS impute_2, [ADS_imp_1_OUT].impute_3 - -0.228525648842 AS impute_3, [ADS_imp_1_OUT].impute_4 - -0.0196614726036 AS impute_4, [ADS_imp_1_OUT].impute_5 - 0.0747043986171 AS impute_5, [ADS_imp_1_OUT].impute_6 - 0.159222763454 AS impute_6, [ADS_imp_1_OUT].impute_7 - -0.136374172716 AS impute_7, [ADS_imp_1_OUT].impute_8 - -0.0346276103782 AS impute_8, [ADS_imp_1_OUT].impute_9 - -0.0329307540028 AS impute_9, [ADS_imp_1_OUT].impute_10 - -0.10394355107 AS impute_10, [ADS_imp_1_OUT].impute_11 - -0.0870324604905 AS impute_11, [ADS_imp_1_OUT].impute_12 - -0.053446813238 AS impute_12, [ADS_imp_1_OUT].impute_13 - 0.0279932707486 AS impute_13, [ADS_imp_1_OUT].impute_14 - 0.718463021481 AS impute_14, [ADS_imp_1_OUT].impute_15 - 0.0853659871147 AS impute_15, [ADS_imp_1_OUT].impute_16 - -0.03968512249 AS impute_16, [ADS_imp_1_OUT].impute_17 - 0.163279377672 AS impute_17, [ADS_imp_1_OUT].impute_18 - 0.224539814004 AS impute_18, [ADS_imp_1_OUT].impute_19 - 0.0543965428835 AS impute_19, [ADS_imp_1_OUT].impute_20 - 0.0620472007054 AS impute_20, [ADS_imp_1_OUT].impute_21 - -0.0589405202817 AS impute_21 
FROM [ADS_imp_1_OUT]), 
[ADS_ano_2_OUT] AS 
(SELECT [CenteredDataForPCA].[KEY] AS [KEY], [CenteredDataForPCA].impute_2 * -0.0829992744622 + [CenteredDataForPCA].impute_3 * 0.0157509118026 + [CenteredDataForPCA].impute_4 * 0.528313058385 + [CenteredDataForPCA].impute_5 * 0.0221286369222 + [CenteredDataForPCA].impute_6 * -0.205999845527 + [CenteredDataForPCA].impute_7 * -0.0981882080693 + [CenteredDataForPCA].impute_8 * 0.108839311071 + [CenteredDataForPCA].impute_9 * 0.734857120962 + [CenteredDataForPCA].impute_10 * -0.0327808909074 + [CenteredDataForPCA].impute_11 * 0.11002718865 + [CenteredDataForPCA].impute_12 * 0.0637430857593 + [CenteredDataForPCA].impute_13 * -0.0297988368861 + [CenteredDataForPCA].impute_14 * 0.248591848165 + [CenteredDataForPCA].impute_15 * 0.0495215357599 + [CenteredDataForPCA].impute_16 * -0.104904369857 + [CenteredDataForPCA].impute_17 * -0.0272489074916 + [CenteredDataForPCA].impute_18 * 0.0676277741796 + [CenteredDataForPCA].impute_19 * 0.0415588177797 + [CenteredDataForPCA].impute_20 * -0.05195698313 + [CenteredDataForPCA].impute_21 * 0.0786841872502 AS anoova_2, [CenteredDataForPCA].impute_2 * -0.229446207406 + [CenteredDataForPCA].impute_3 * -0.820392176106 + [CenteredDataForPCA].impute_4 * -0.143698603873 + [CenteredDataForPCA].impute_5 * 0.0104412265747 + [CenteredDataForPCA].impute_6 * 0.323282437246 + [CenteredDataForPCA].impute_7 * -0.0451567213244 + [CenteredDataForPCA].impute_8 * -0.0621167063886 + [CenteredDataForPCA].impute_9 * 0.164095777036 + [CenteredDataForPCA].impute_10 * 0.0766480141386 + [CenteredDataForPCA].impute_11 * 0.0874777922654 + [CenteredDataForPCA].impute_12 * -0.0124236191997 + [CenteredDataForPCA].impute_13 * -0.0302392961851 + [CenteredDataForPCA].impute_14 * -0.0484504063359 + [CenteredDataForPCA].impute_15 * -0.0242496923131 + [CenteredDataForPCA].impute_16 * -0.00175576087912 + [CenteredDataForPCA].impute_17 * -0.101316821737 + [CenteredDataForPCA].impute_18 * -0.065088473239 + [CenteredDataForPCA].impute_19 * 0.0897304162901 + [CenteredDataForPCA].impute_20 * -0.254177530342 + [CenteredDataForPCA].impute_21 * 0.107341727194 AS anoova_3, [CenteredDataForPCA].impute_2 * -0.0508070468588 + [CenteredDataForPCA].impute_3 * 0.199260496488 + [CenteredDataForPCA].impute_4 * 0.0481811346991 + [CenteredDataForPCA].impute_5 * 0.0693070864516 + [CenteredDataForPCA].impute_6 * 0.14489796188 + [CenteredDataForPCA].impute_7 * 0.0381241355085 + [CenteredDataForPCA].impute_8 * -0.00901734255942 + [CenteredDataForPCA].impute_9 * 0.317281235588 + [CenteredDataForPCA].impute_10 * 0.0412483674043 + [CenteredDataForPCA].impute_11 * -0.100473157492 + [CenteredDataForPCA].impute_12 * -0.0361978337596 + [CenteredDataForPCA].impute_13 * 0.0266219036444 + [CenteredDataForPCA].impute_14 * -0.887742567221 + [CenteredDataForPCA].impute_15 * -0.0592235891072 + [CenteredDataForPCA].impute_16 * 0.00508558271304 + [CenteredDataForPCA].impute_17 * -0.124500275757 + [CenteredDataForPCA].impute_18 * 0.00768868633715 + [CenteredDataForPCA].impute_19 * 0.0761374797893 + [CenteredDataForPCA].impute_20 * -0.0181985456041 + [CenteredDataForPCA].impute_21 * -0.0163844038041 AS anoova_4, [CenteredDataForPCA].impute_2 * 0.262332846564 + [CenteredDataForPCA].impute_3 * 0.181393155035 + [CenteredDataForPCA].impute_4 * -0.058801091603 + [CenteredDataForPCA].impute_5 * 0.214808530905 + [CenteredDataForPCA].impute_6 * 0.61252011014 + [CenteredDataForPCA].impute_7 * 0.131957045512 + [CenteredDataForPCA].impute_8 * -0.0302109568247 + [CenteredDataForPCA].impute_9 * 0.182039367239 + [CenteredDataForPCA].impute_10 * 0.227721461121 + [CenteredDataForPCA].impute_11 * -0.234125444271 + [CenteredDataForPCA].impute_12 * 0.0210952242019 + [CenteredDataForPCA].impute_13 * 0.0148701249344 + [CenteredDataForPCA].impute_14 * 0.257737012211 + [CenteredDataForPCA].impute_15 * 0.103040298557 + [CenteredDataForPCA].impute_16 * -0.371403393669 + [CenteredDataForPCA].impute_17 * -0.0380229584407 + [CenteredDataForPCA].impute_18 * -0.0978785478677 + [CenteredDataForPCA].impute_19 * 0.118632548273 + [CenteredDataForPCA].impute_20 * -0.00403875596028 + [CenteredDataForPCA].impute_21 * -0.273117430209 AS anoova_5, [CenteredDataForPCA].impute_2 * 0.0547228251684 + [CenteredDataForPCA].impute_3 * 0.0695607849019 + [CenteredDataForPCA].impute_4 * 0.0518810374662 + [CenteredDataForPCA].impute_5 * -0.133617573515 + [CenteredDataForPCA].impute_6 * 0.1040788695 + [CenteredDataForPCA].impute_7 * -0.225466584761 + [CenteredDataForPCA].impute_8 * -0.3913828625 + [CenteredDataForPCA].impute_9 * 0.122900767428 + [CenteredDataForPCA].impute_10 * -0.00692718167384 + [CenteredDataForPCA].impute_11 * -0.16859227895 + [CenteredDataForPCA].impute_12 * -0.329357148063 + [CenteredDataForPCA].impute_13 * -0.238200615 + [CenteredDataForPCA].impute_14 * 0.0737796289506 + [CenteredDataForPCA].impute_15 * 0.362826566637 + [CenteredDataForPCA].impute_16 * 0.527506413891 + [CenteredDataForPCA].impute_17 * -0.145780221114 + [CenteredDataForPCA].impute_18 * -0.0362362877331 + [CenteredDataForPCA].impute_19 * -0.200507039455 + [CenteredDataForPCA].impute_20 * -0.129915127677 + [CenteredDataForPCA].impute_21 * -0.230187200279 AS anoova_6, [CenteredDataForPCA].impute_2 * -0.183810658881 + [CenteredDataForPCA].impute_3 * -0.243957523006 + [CenteredDataForPCA].impute_4 * 0.0108998707616 + [CenteredDataForPCA].impute_5 * 0.417880782618 + [CenteredDataForPCA].impute_6 * -0.318521023565 + [CenteredDataForPCA].impute_7 * -0.0946091248827 + [CenteredDataForPCA].impute_8 * -0.0725188272883 + [CenteredDataForPCA].impute_9 * -0.101404162405 + [CenteredDataForPCA].impute_10 * -0.0203015919418 + [CenteredDataForPCA].impute_11 * -0.0893864139475 + [CenteredDataForPCA].impute_12 * 0.0640124018249 + [CenteredDataForPCA].impute_13 * -0.100277500888 + [CenteredDataForPCA].impute_14 * -0.0916012559758 + [CenteredDataForPCA].impute_15 * 0.278906338894 + [CenteredDataForPCA].impute_16 * -0.204451475143 + [CenteredDataForPCA].impute_17 * -0.0880390572792 + [CenteredDataForPCA].impute_18 * 0.295878287503 + [CenteredDataForPCA].impute_19 * 0.089935513722 + [CenteredDataForPCA].impute_20 * 0.257844714033 + [CenteredDataForPCA].impute_21 * -0.534419851509 AS anoova_7, [CenteredDataForPCA].impute_2 * -0.0140920579018 + [CenteredDataForPCA].impute_3 * 0.0942289927897 + [CenteredDataForPCA].impute_4 * 0.0251992789404 + [CenteredDataForPCA].impute_5 * 0.0948288290509 + [CenteredDataForPCA].impute_6 * -0.173042648589 + [CenteredDataForPCA].impute_7 * -0.0597892325637 + [CenteredDataForPCA].impute_8 * -0.338252954598 + [CenteredDataForPCA].impute_9 * -0.0785765271213 + [CenteredDataForPCA].impute_10 * 0.656577278034 + [CenteredDataForPCA].impute_11 * 0.177143026235 + [CenteredDataForPCA].impute_12 * 0.0923738984557 + [CenteredDataForPCA].impute_13 * -0.377844662771 + [CenteredDataForPCA].impute_14 * -0.0429607061257 + [CenteredDataForPCA].impute_15 * -0.162734277908 + [CenteredDataForPCA].impute_16 * -0.222721046619 + [CenteredDataForPCA].impute_17 * 0.0286215675313 + [CenteredDataForPCA].impute_18 * 0.0710181648167 + [CenteredDataForPCA].impute_19 * -0.254023565556 + [CenteredDataForPCA].impute_20 * -0.217832663643 + [CenteredDataForPCA].impute_21 * 0.132813819481 AS anoova_8, [CenteredDataForPCA].impute_2 * -0.033768239825 + [CenteredDataForPCA].impute_3 * -0.0695603929845 + [CenteredDataForPCA].impute_4 * 0.0552945518335 + [CenteredDataForPCA].impute_5 * -0.172603581011 + [CenteredDataForPCA].impute_6 * -0.0518194981331 + [CenteredDataForPCA].impute_7 * 0.167939534405 + [CenteredDataForPCA].impute_8 * -0.26075432317 + [CenteredDataForPCA].impute_9 * 0.0637609451923 + [CenteredDataForPCA].impute_10 * 0.236252076863 + [CenteredDataForPCA].impute_11 * -0.385239800842 + [CenteredDataForPCA].impute_12 * 0.0382480920111 + [CenteredDataForPCA].impute_13 * -0.0796185047927 + [CenteredDataForPCA].impute_14 * 0.0800115469899 + [CenteredDataForPCA].impute_15 * -0.263710701082 + [CenteredDataForPCA].impute_16 * 0.263438321693 + [CenteredDataForPCA].impute_17 * 0.239764779381 + [CenteredDataForPCA].impute_18 * 0.250867291187 + [CenteredDataForPCA].impute_19 * 0.560465787157 + [CenteredDataForPCA].impute_20 * 0.247783719102 + [CenteredDataForPCA].impute_21 * 0.0700887463122 AS anoova_9, [CenteredDataForPCA].impute_2 * -0.0830544216515 + [CenteredDataForPCA].impute_3 * -0.00992400415753 + [CenteredDataForPCA].impute_4 * 0.050136057619 + [CenteredDataForPCA].impute_5 * 0.094807101154 + [CenteredDataForPCA].impute_6 * -0.275360631783 + [CenteredDataForPCA].impute_7 * 0.0815396138633 + [CenteredDataForPCA].impute_8 * -0.169291597286 + [CenteredDataForPCA].impute_9 * -0.0718334168896 + [CenteredDataForPCA].impute_10 * -0.000389261193611 + [CenteredDataForPCA].impute_11 * -0.353549290242 + [CenteredDataForPCA].impute_12 * 0.203221992627 + [CenteredDataForPCA].impute_13 * 0.0353120134978 + [CenteredDataForPCA].impute_14 * -0.0519322297265 + [CenteredDataForPCA].impute_15 * 0.427841348995 + [CenteredDataForPCA].impute_16 * -0.122829464874 + [CenteredDataForPCA].impute_17 * 0.0841390279729 + [CenteredDataForPCA].impute_18 * -0.603796005325 + [CenteredDataForPCA].impute_19 * 0.18444728152 + [CenteredDataForPCA].impute_20 * -0.158416910111 + [CenteredDataForPCA].impute_21 * 0.257037475681 AS anoova_10, [CenteredDataForPCA].impute_2 * 0.0120057125328 + [CenteredDataForPCA].impute_3 * 0.0572999212859 + [CenteredDataForPCA].impute_4 * 0.0129740121535 + [CenteredDataForPCA].impute_5 * 0.217745231399 + [CenteredDataForPCA].impute_6 * -0.0312047179135 + [CenteredDataForPCA].impute_7 * 0.637001700723 + [CenteredDataForPCA].impute_8 * -0.0270211265442 + [CenteredDataForPCA].impute_9 * -0.00975465813513 + [CenteredDataForPCA].impute_10 * -0.155373370604 + [CenteredDataForPCA].impute_11 * 0.184777358973 + [CenteredDataForPCA].impute_12 * -0.125044904208 + [CenteredDataForPCA].impute_13 * -0.0590956829451 + [CenteredDataForPCA].impute_14 * -0.00589749130204 + [CenteredDataForPCA].impute_15 * 0.196692497831 + [CenteredDataForPCA].impute_16 * 0.112882633617 + [CenteredDataForPCA].impute_17 * 0.270285713421 + [CenteredDataForPCA].impute_18 * 0.286079843333 + [CenteredDataForPCA].impute_19 * 0.0824930105166 + [CenteredDataForPCA].impute_20 * -0.499925293278 + [CenteredDataForPCA].impute_21 * -0.0302876784161 AS anoova_11, [CenteredDataForPCA].impute_2 * 0.111679351604 + [CenteredDataForPCA].impute_3 * 0.167058308622 + [CenteredDataForPCA].impute_4 * -0.0611229737213 + [CenteredDataForPCA].impute_5 * 0.479930329643 + [CenteredDataForPCA].impute_6 * 0.111955277891 + [CenteredDataForPCA].impute_7 * -0.312549739661 + [CenteredDataForPCA].impute_8 * -0.113717623244 + [CenteredDataForPCA].impute_9 * -0.0922152995098 + [CenteredDataForPCA].impute_10 * -0.319771966807 + [CenteredDataForPCA].impute_11 * 0.129519146359 + [CenteredDataForPCA].impute_12 * 0.0596361660044 + [CenteredDataForPCA].impute_13 * -0.314520099709 + [CenteredDataForPCA].impute_14 * 0.0691705369903 + [CenteredDataForPCA].impute_15 * -0.105644308766 + [CenteredDataForPCA].impute_16 * 0.0856617990838 + [CenteredDataForPCA].impute_17 * -0.258696213805 + [CenteredDataForPCA].impute_18 * 0.079857094574 + [CenteredDataForPCA].impute_19 * 0.381644050991 + [CenteredDataForPCA].impute_20 * -0.074115001082 + [CenteredDataForPCA].impute_21 * 0.353065726665 AS anoova_12, [CenteredDataForPCA].impute_2 * -0.0303759933198 + [CenteredDataForPCA].impute_3 * -0.02084902602 + [CenteredDataForPCA].impute_4 * 0.0386914846599 + [CenteredDataForPCA].impute_5 * 0.080787316059 + [CenteredDataForPCA].impute_6 * -0.0456753357913 + [CenteredDataForPCA].impute_7 * -0.060906910964 + [CenteredDataForPCA].impute_8 * 0.021691229892 + [CenteredDataForPCA].impute_9 * 0.051117744577 + [CenteredDataForPCA].impute_10 * -0.185248676329 + [CenteredDataForPCA].impute_11 * 0.13765412957 + [CenteredDataForPCA].impute_12 * -0.162486020533 + [CenteredDataForPCA].impute_13 * -0.352576411813 + [CenteredDataForPCA].impute_14 * -0.0333829968569 + [CenteredDataForPCA].impute_15 * -0.408795954956 + [CenteredDataForPCA].impute_16 * 0.00235283539517 + [CenteredDataForPCA].impute_17 * 0.415145418316 + [CenteredDataForPCA].impute_18 * -0.503234579242 + [CenteredDataForPCA].impute_19 * 0.0954296554172 + [CenteredDataForPCA].impute_20 * -0.0355316126151 + [CenteredDataForPCA].impute_21 * -0.416614740529 AS anoova_13, [CenteredDataForPCA].impute_2 * -0.0380653913136 + [CenteredDataForPCA].impute_3 * -0.0480811654719 + [CenteredDataForPCA].impute_4 * 0.0612359864581 + [CenteredDataForPCA].impute_5 * 0.0195913591838 + [CenteredDataForPCA].impute_6 * -0.121371332939 + [CenteredDataForPCA].impute_7 * 0.467217262682 + [CenteredDataForPCA].impute_8 * -0.14638459844 + [CenteredDataForPCA].impute_9 * 0.0201020743761 + [CenteredDataForPCA].impute_10 * -0.201378323839 + [CenteredDataForPCA].impute_11 * -0.244365122692 + [CenteredDataForPCA].impute_12 * 0.163543459301 + [CenteredDataForPCA].impute_13 * -0.123454872842 + [CenteredDataForPCA].impute_14 * 0.103594127814 + [CenteredDataForPCA].impute_15 * -0.39364736587 + [CenteredDataForPCA].impute_16 * 0.0336953584946 + [CenteredDataForPCA].impute_17 * -0.589922918397 + [CenteredDataForPCA].impute_18 * -0.126508426496 + [CenteredDataForPCA].impute_19 * -0.230370760813 + [CenteredDataForPCA].impute_20 * -0.0114289366844 + [CenteredDataForPCA].impute_21 * -0.104665300052 AS anoova_14, [CenteredDataForPCA].impute_2 * -0.00125387109487 + [CenteredDataForPCA].impute_3 * -0.0469860420307 + [CenteredDataForPCA].impute_4 * -0.0314354995532 + [CenteredDataForPCA].impute_5 * 0.130020175468 + [CenteredDataForPCA].impute_6 * 0.0603052959061 + [CenteredDataForPCA].impute_7 * 0.000264208819712 + [CenteredDataForPCA].impute_8 * 0.658429938926 + [CenteredDataForPCA].impute_9 * -0.00321614816177 + [CenteredDataForPCA].impute_10 * 0.160526870007 + [CenteredDataForPCA].impute_11 * -0.332968126241 + [CenteredDataForPCA].impute_12 * 0.256511499561 + [CenteredDataForPCA].impute_13 * -0.444005132303 + [CenteredDataForPCA].impute_14 * -0.0103190227499 + [CenteredDataForPCA].impute_15 * 0.0805478053126 + [CenteredDataForPCA].impute_16 * 0.297887079073 + [CenteredDataForPCA].impute_17 * 0.0884147558916 + [CenteredDataForPCA].impute_18 * 0.0497136866974 + [CenteredDataForPCA].impute_19 * -0.181864267925 + [CenteredDataForPCA].impute_20 * -0.0314364482195 + [CenteredDataForPCA].impute_21 * 0.0588404232919 AS anoova_15, [CenteredDataForPCA].impute_2 * -0.0156478118351 + [CenteredDataForPCA].impute_3 * 0.0597562264981 + [CenteredDataForPCA].impute_4 * -0.00539694329976 + [CenteredDataForPCA].impute_5 * -0.359637435147 + [CenteredDataForPCA].impute_6 * -0.185940386698 + [CenteredDataForPCA].impute_7 * -0.048453198633 + [CenteredDataForPCA].impute_8 * 0.329900027004 + [CenteredDataForPCA].impute_9 * -0.143779747932 + [CenteredDataForPCA].impute_10 * 0.117174275086 + [CenteredDataForPCA].impute_11 * -0.076630594693 + [CenteredDataForPCA].impute_12 * -0.423951147558 + [CenteredDataForPCA].impute_13 * -0.188051595618 + [CenteredDataForPCA].impute_14 * 0.0136596363166 + [CenteredDataForPCA].impute_15 * 0.0326024634024 + [CenteredDataForPCA].impute_16 * -0.267578052042 + [CenteredDataForPCA].impute_17 * -0.359773115245 + [CenteredDataForPCA].impute_18 * 0.0231420247987 + [CenteredDataForPCA].impute_19 * 0.395852371468 + [CenteredDataForPCA].impute_20 * -0.309458907405 + [CenteredDataForPCA].impute_21 * -0.102001096855 AS anoova_16, [CenteredDataForPCA].impute_2 * 0.0291518418165 + [CenteredDataForPCA].impute_3 * 0.048646913647 + [CenteredDataForPCA].impute_4 * -0.0348553560236 + [CenteredDataForPCA].impute_5 * -0.366749970482 + [CenteredDataForPCA].impute_6 * 0.0608739228803 + [CenteredDataForPCA].impute_7 * -0.268164751796 + [CenteredDataForPCA].impute_8 * -0.153259881909 + [CenteredDataForPCA].impute_9 * -0.0232061437477 + [CenteredDataForPCA].impute_10 * -0.327645208554 + [CenteredDataForPCA].impute_11 * -0.198000515685 + [CenteredDataForPCA].impute_12 * 0.518584444187 + [CenteredDataForPCA].impute_13 * -0.0704722168943 + [CenteredDataForPCA].impute_14 * -0.0525268570325 + [CenteredDataForPCA].impute_15 * -0.0510487509149 + [CenteredDataForPCA].impute_16 * -0.200885371923 + [CenteredDataForPCA].impute_17 * 0.152559047803 + [CenteredDataForPCA].impute_18 * 0.253829853985 + [CenteredDataForPCA].impute_19 * -0.0222746271488 + [CenteredDataForPCA].impute_20 * -0.413063813651 + [CenteredDataForPCA].impute_21 * -0.190852484326 AS anoova_17, [CenteredDataForPCA].impute_2 * -0.0170119132298 + [CenteredDataForPCA].impute_3 * 0.023598893149 + [CenteredDataForPCA].impute_4 * 0.0416255326339 + [CenteredDataForPCA].impute_5 * 0.370825445027 + [CenteredDataForPCA].impute_6 * -0.145161254955 + [CenteredDataForPCA].impute_7 * -0.265645099103 + [CenteredDataForPCA].impute_8 * 0.0818801594367 + [CenteredDataForPCA].impute_9 * -0.0410465383093 + [CenteredDataForPCA].impute_10 * 0.166295285165 + [CenteredDataForPCA].impute_11 * -0.309355595341 + [CenteredDataForPCA].impute_12 * -0.129370856003 + [CenteredDataForPCA].impute_13 * 0.52589485672 + [CenteredDataForPCA].impute_14 * 0.0776317883869 + [CenteredDataForPCA].impute_15 * -0.325151331653 + [CenteredDataForPCA].impute_16 * 0.183569895911 + [CenteredDataForPCA].impute_17 * 0.0204593223133 + [CenteredDataForPCA].impute_18 * 0.0240861782035 + [CenteredDataForPCA].impute_19 * -0.0454742825025 + [CenteredDataForPCA].impute_20 * -0.4273906255 + [CenteredDataForPCA].impute_21 * -0.109757023978 AS anoova_18, [CenteredDataForPCA].impute_2 * 0.035350270313 + [CenteredDataForPCA].impute_3 * 0.0915448028553 + [CenteredDataForPCA].impute_4 * 0.000119354899569 + [CenteredDataForPCA].impute_5 * -0.0727071658053 + [CenteredDataForPCA].impute_6 * -0.00993965912204 + [CenteredDataForPCA].impute_7 * 0.0308715942697 + [CenteredDataForPCA].impute_8 * 0.0753438299539 + [CenteredDataForPCA].impute_9 * -0.0312576296364 + [CenteredDataForPCA].impute_10 * 0.276321294615 + [CenteredDataForPCA].impute_11 * 0.439211072932 + [CenteredDataForPCA].impute_12 * 0.476044316388 + [CenteredDataForPCA].impute_13 * 0.155299405974 + [CenteredDataForPCA].impute_14 * 0.0128097633283 + [CenteredDataForPCA].impute_15 * 0.0807941696055 + [CenteredDataForPCA].impute_16 * 0.375848136586 + [CenteredDataForPCA].impute_17 * -0.237441130001 + [CenteredDataForPCA].impute_18 * -0.186174721435 + [CenteredDataForPCA].impute_19 * 0.320025020565 + [CenteredDataForPCA].impute_20 * -0.090510697158 + [CenteredDataForPCA].impute_21 * -0.328300059413 AS anoova_19, [CenteredDataForPCA].impute_2 * -0.185676580898 + [CenteredDataForPCA].impute_3 * 0.181729816196 + [CenteredDataForPCA].impute_4 * -0.811271898932 + [CenteredDataForPCA].impute_5 * -4.51028103754e-17 + [CenteredDataForPCA].impute_6 * -0.239306979 + [CenteredDataForPCA].impute_7 * 5.20417042793e-18 + [CenteredDataForPCA].impute_8 * 2.23996168836e-16 + [CenteredDataForPCA].impute_9 * 0.447865339342 + [CenteredDataForPCA].impute_10 * 3.17454396104e-16 + [CenteredDataForPCA].impute_11 * 3.46944695195e-16 + [CenteredDataForPCA].impute_12 * 2.94902990916e-17 + [CenteredDataForPCA].impute_13 * -6.24500451352e-17 + [CenteredDataForPCA].impute_14 * 0.128394683819 + [CenteredDataForPCA].impute_15 * 1.31405303305e-16 + [CenteredDataForPCA].impute_16 * 2.09901540593e-16 + [CenteredDataForPCA].impute_17 * -1.04083408559e-16 + [CenteredDataForPCA].impute_18 * 1.1622647289e-16 + [CenteredDataForPCA].impute_19 * 1.40512601554e-16 + [CenteredDataForPCA].impute_20 * -1.96023752785e-16 + [CenteredDataForPCA].impute_21 * 3.81639164715e-17 AS anoova_20, [CenteredDataForPCA].impute_2 * 0.878606073097 + [CenteredDataForPCA].impute_3 * -0.30312342273 + [CenteredDataForPCA].impute_4 * -0.119005219348 + [CenteredDataForPCA].impute_5 * 2.77555756156e-17 + [CenteredDataForPCA].impute_6 * -0.292328773901 + [CenteredDataForPCA].impute_7 * -7.6327832943e-17 + [CenteredDataForPCA].impute_8 * 9.54097911787e-18 + [CenteredDataForPCA].impute_9 * 0.149606370772 + [CenteredDataForPCA].impute_10 * 3.46944695195e-17 + [CenteredDataForPCA].impute_11 * 7.6327832943e-17 + [CenteredDataForPCA].impute_12 * 6.93889390391e-18 + [CenteredDataForPCA].impute_13 * -4.16333634234e-17 + [CenteredDataForPCA].impute_14 * -0.119025789016 + [CenteredDataForPCA].impute_15 * -4.25007251614e-17 + [CenteredDataForPCA].impute_16 * 7.2858385991e-17 + [CenteredDataForPCA].impute_17 * -5.20417042793e-17 + [CenteredDataForPCA].impute_18 * 4.51028103754e-17 + [CenteredDataForPCA].impute_19 * 3.46944695195e-17 + [CenteredDataForPCA].impute_20 * -1.11022302463e-16 + [CenteredDataForPCA].impute_21 * 4.16333634234e-17 AS anoova_21 
FROM [CenteredDataForPCA]), 
linear_model_cte AS 
(SELECT [ADS_ano_2_OUT].[KEY] AS [KEY], 0.5784717992657854 * [ADS_ano_2_OUT].anoova_2 + -0.9834245751675418 * [ADS_ano_2_OUT].anoova_3 + 0.890954255783696 * [ADS_ano_2_OUT].anoova_4 + 0.45291614880027997 * [ADS_ano_2_OUT].anoova_5 + 0.24117160158901624 * [ADS_ano_2_OUT].anoova_6 + -1.039550921091265 * [ADS_ano_2_OUT].anoova_7 + -0.4198112319614449 * [ADS_ano_2_OUT].anoova_8 + -0.051552397052276384 * [ADS_ano_2_OUT].anoova_9 + -0.3750048826419017 * [ADS_ano_2_OUT].anoova_10 + 0.2088644808991793 * [ADS_ano_2_OUT].anoova_11 + 0.5022560356862017 * [ADS_ano_2_OUT].anoova_12 + 0.10030976831288693 * [ADS_ano_2_OUT].anoova_13 + -0.14086922231335425 * [ADS_ano_2_OUT].anoova_14 + -0.06789365138469433 * [ADS_ano_2_OUT].anoova_15 + -0.014992852035581561 * [ADS_ano_2_OUT].anoova_16 + -0.15746742196602415 * [ADS_ano_2_OUT].anoova_17 + -0.31028561499082846 * [ADS_ano_2_OUT].anoova_18 + 0.05370688399070698 * [ADS_ano_2_OUT].anoova_19 + -1.4839653870838194e-15 * [ADS_ano_2_OUT].anoova_20 + -7.758685154595328e-16 * [ADS_ano_2_OUT].anoova_21 + -2.19520524899 AS [Score_0], -0.4273319216021718 * [ADS_ano_2_OUT].anoova_2 + -0.4897940550629827 * [ADS_ano_2_OUT].anoova_3 + -0.936896686424769 * [ADS_ano_2_OUT].anoova_4 + -0.7442738831557565 * [ADS_ano_2_OUT].anoova_5 + -0.41040061176985676 * [ADS_ano_2_OUT].anoova_6 + 1.1515184547736528 * [ADS_ano_2_OUT].anoova_7 + -0.2789385451674177 * [ADS_ano_2_OUT].anoova_8 + 0.3707392126873457 * [ADS_ano_2_OUT].anoova_9 + 0.9638165462817274 * [ADS_ano_2_OUT].anoova_10 + 0.09510680201716865 * [ADS_ano_2_OUT].anoova_11 + -0.6609403883886146 * [ADS_ano_2_OUT].anoova_12 + 0.1743088090060546 * [ADS_ano_2_OUT].anoova_13 + 0.866485025038025 * [ADS_ano_2_OUT].anoova_14 + 0.09418354551184735 * [ADS_ano_2_OUT].anoova_15 + 0.7767662413862633 * [ADS_ano_2_OUT].anoova_16 + 0.6357398623118967 * [ADS_ano_2_OUT].anoova_17 + 0.6630630738836023 * [ADS_ano_2_OUT].anoova_18 + 0.2611589927143126 * [ADS_ano_2_OUT].anoova_19 + -5.290245290657765e-16 * [ADS_ano_2_OUT].anoova_20 + -3.5821337879555173e-16 * [ADS_ano_2_OUT].anoova_21 + -2.19277937775 AS [Score_1], 0.02785810577529806 * [ADS_ano_2_OUT].anoova_2 + 0.4798128282363659 * [ADS_ano_2_OUT].anoova_3 + 0.25791925656769576 * [ADS_ano_2_OUT].anoova_4 + -0.33623691056529 * [ADS_ano_2_OUT].anoova_5 + 0.16089490678222748 * [ADS_ano_2_OUT].anoova_6 + 0.11644514806701196 * [ADS_ano_2_OUT].anoova_7 + 0.39524423525440333 * [ADS_ano_2_OUT].anoova_8 + -0.12083543876418336 * [ADS_ano_2_OUT].anoova_9 + -0.18679227025314402 * [ADS_ano_2_OUT].anoova_10 + -0.272373142926232 * [ADS_ano_2_OUT].anoova_11 + 0.18947973591560013 * [ADS_ano_2_OUT].anoova_12 + 0.002439207040340368 * [ADS_ano_2_OUT].anoova_13 + -0.2600464997941168 * [ADS_ano_2_OUT].anoova_14 + 0.3428419693604406 * [ADS_ano_2_OUT].anoova_15 + -0.07598856262410537 * [ADS_ano_2_OUT].anoova_16 + -0.3223926311291443 * [ADS_ano_2_OUT].anoova_17 + -0.22265682263909092 * [ADS_ano_2_OUT].anoova_18 + 0.08368774099259432 * [ADS_ano_2_OUT].anoova_19 + -3.1603554919496273e-16 * [ADS_ano_2_OUT].anoova_20 + 9.713887968273356e-18 * [ADS_ano_2_OUT].anoova_21 + -1.35917880236 AS [Score_2], -0.1244834379963609 * [ADS_ano_2_OUT].anoova_2 + 0.5789096283631334 * [ADS_ano_2_OUT].anoova_3 + -0.20115881144508063 * [ADS_ano_2_OUT].anoova_4 + 0.5250443232853571 * [ADS_ano_2_OUT].anoova_5 + 0.08380658464985233 * [ADS_ano_2_OUT].anoova_6 + -0.3311960691540119 * [ADS_ano_2_OUT].anoova_7 + 0.061237100516659065 * [ADS_ano_2_OUT].anoova_8 + 0.12669698021304288 * [ADS_ano_2_OUT].anoova_9 + -0.3357757025251301 * [ADS_ano_2_OUT].anoova_10 + 0.05865021322118873 * [ADS_ano_2_OUT].anoova_11 + -0.09100890650166057 * [ADS_ano_2_OUT].anoova_12 + -0.25673643100346605 * [ADS_ano_2_OUT].anoova_13 + -0.3197480705202544 * [ADS_ano_2_OUT].anoova_14 + -0.8304043152940257 * [ADS_ano_2_OUT].anoova_15 + -0.3276271809563889 * [ADS_ano_2_OUT].anoova_16 + 0.07258197538867166 * [ADS_ano_2_OUT].anoova_17 + 0.03450268687159979 * [ADS_ano_2_OUT].anoova_18 + 0.21279687460403796 * [ADS_ano_2_OUT].anoova_19 + 3.009540580661979e-15 * [ADS_ano_2_OUT].anoova_20 + 7.591888133582549e-16 * [ADS_ano_2_OUT].anoova_21 + -1.49763507619 AS [Score_3] 
FROM [ADS_ano_2_OUT]), 
orig_cte AS 
(SELECT linear_model_cte.[KEY] AS [KEY], linear_model_cte.[Score_0] AS [Score_0], linear_model_cte.[Score_1] AS [Score_1], linear_model_cte.[Score_2] AS [Score_2], linear_model_cte.[Score_3] AS [Score_3], (1.0 / (1.0 + exp(-linear_model_cte.[Score_0]))) / (1.0 / (1.0 + exp(-linear_model_cte.[Score_0])) + 1.0 / (1.0 + exp(-linear_model_cte.[Score_1])) + 1.0 / (1.0 + exp(-linear_model_cte.[Score_2])) + 1.0 / (1.0 + exp(-linear_model_cte.[Score_3]))) AS [Proba_0], (1.0 / (1.0 + exp(-linear_model_cte.[Score_1]))) / (1.0 / (1.0 + exp(-linear_model_cte.[Score_0])) + 1.0 / (1.0 + exp(-linear_model_cte.[Score_1])) + 1.0 / (1.0 + exp(-linear_model_cte.[Score_2])) + 1.0 / (1.0 + exp(-linear_model_cte.[Score_3]))) AS [Proba_1], (1.0 / (1.0 + exp(-linear_model_cte.[Score_2]))) / (1.0 / (1.0 + exp(-linear_model_cte.[Score_0])) + 1.0 / (1.0 + exp(-linear_model_cte.[Score_1])) + 1.0 / (1.0 + exp(-linear_model_cte.[Score_2])) + 1.0 / (1.0 + exp(-linear_model_cte.[Score_3]))) AS [Proba_2], (1.0 / (1.0 + exp(-linear_model_cte.[Score_3]))) / (1.0 / (1.0 + exp(-linear_model_cte.[Score_0])) + 1.0 / (1.0 + exp(-linear_model_cte.[Score_1])) + 1.0 / (1.0 + exp(-linear_model_cte.[Score_2])) + 1.0 / (1.0 + exp(-linear_model_cte.[Score_3]))) AS [Proba_3], CAST(NULL AS FLOAT(53)) AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [LogProba_3], CAST(NULL AS FLOAT(53)) AS [Decision] 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu.[KEY] AS [KEY], scu.class AS class, scu.[LogProba] AS [LogProba], scu.[Proba] AS [Proba], scu.[Score] AS [Score] 
FROM (SELECT orig_cte.[KEY] AS [KEY], 0 AS class, orig_cte.[LogProba_0] AS [LogProba], orig_cte.[Proba_0] AS [Proba], orig_cte.[Score_0] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY], 1 AS class, orig_cte.[LogProba_1] AS [LogProba], orig_cte.[Proba_1] AS [Proba], orig_cte.[Score_1] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY], 2 AS class, orig_cte.[LogProba_2] AS [LogProba], orig_cte.[Proba_2] AS [Proba], orig_cte.[Score_2] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY], 3 AS class, orig_cte.[LogProba_3] AS [LogProba], orig_cte.[Proba_3] AS [Proba], orig_cte.[Score_3] AS [Score] 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.[KEY] AS [KEY], orig_cte.[Score_0] AS [Score_0], orig_cte.[Score_1] AS [Score_1], orig_cte.[Score_2] AS [Score_2], orig_cte.[Score_3] AS [Score_3], orig_cte.[Proba_0] AS [Proba_0], orig_cte.[Proba_1] AS [Proba_1], orig_cte.[Proba_2] AS [Proba_2], orig_cte.[Proba_3] AS [Proba_3], orig_cte.[LogProba_0] AS [LogProba_0], orig_cte.[LogProba_1] AS [LogProba_1], orig_cte.[LogProba_2] AS [LogProba_2], orig_cte.[LogProba_3] AS [LogProba_3], orig_cte.[Decision] AS [Decision], (SELECT max(score_class_union.[LogProba]) AS max_1 
FROM score_class_union 
WHERE orig_cte.[KEY] = score_class_union.[KEY]) AS [max_LogProba], (SELECT max(score_class_union.[Proba]) AS max_2 
FROM score_class_union 
WHERE orig_cte.[KEY] = score_class_union.[KEY]) AS [max_Proba], (SELECT max(score_class_union.[Score]) AS max_3 
FROM score_class_union 
WHERE orig_cte.[KEY] = score_class_union.[KEY]) AS [max_Score] 
FROM orig_cte), 
arg_max_cte AS 
(SELECT score_max.[KEY] AS [KEY], score_max.[Score_0] AS [Score_0], score_max.[Score_1] AS [Score_1], score_max.[Score_2] AS [Score_2], score_max.[Score_3] AS [Score_3], score_max.[Proba_0] AS [Proba_0], score_max.[Proba_1] AS [Proba_1], score_max.[Proba_2] AS [Proba_2], score_max.[Proba_3] AS [Proba_3], score_max.[LogProba_0] AS [LogProba_0], score_max.[LogProba_1] AS [LogProba_1], score_max.[LogProba_2] AS [LogProba_2], score_max.[LogProba_3] AS [LogProba_3], score_max.[Decision] AS [Decision], score_max.[max_LogProba] AS [max_LogProba], score_max.[max_Proba] AS [max_Proba], score_max.[max_Score] AS [max_Score], (SELECT min(score_class_union.class) AS min_1 
FROM score_class_union 
WHERE score_max.[max_LogProba] = score_class_union.[LogProba] AND score_max.[KEY] = score_class_union.[KEY]) AS [arg_max_LogProba], (SELECT min(score_class_union.class) AS min_2 
FROM score_class_union 
WHERE score_max.[max_Proba] = score_class_union.[Proba] AND score_max.[KEY] = score_class_union.[KEY]) AS [arg_max_Proba], (SELECT min(score_class_union.class) AS min_3 
FROM score_class_union 
WHERE score_max.[max_Score] = score_class_union.[Score] AND score_max.[KEY] = score_class_union.[KEY]) AS [arg_max_Score] 
FROM score_max)
 SELECT arg_max_cte.[KEY] AS [KEY], arg_max_cte.[Score_0] AS [Score_0], arg_max_cte.[Score_1] AS [Score_1], arg_max_cte.[Score_2] AS [Score_2], arg_max_cte.[Score_3] AS [Score_3], arg_max_cte.[Proba_0] AS [Proba_0], arg_max_cte.[Proba_1] AS [Proba_1], arg_max_cte.[Proba_2] AS [Proba_2], arg_max_cte.[Proba_3] AS [Proba_3], CASE WHEN (arg_max_cte.[Proba_0] IS NULL OR arg_max_cte.[Proba_0] > 0.0) THEN log(arg_max_cte.[Proba_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CASE WHEN (arg_max_cte.[Proba_1] IS NULL OR arg_max_cte.[Proba_1] > 0.0) THEN log(arg_max_cte.[Proba_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CASE WHEN (arg_max_cte.[Proba_2] IS NULL OR arg_max_cte.[Proba_2] > 0.0) THEN log(arg_max_cte.[Proba_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CASE WHEN (arg_max_cte.[Proba_3] IS NULL OR arg_max_cte.[Proba_3] > 0.0) THEN log(arg_max_cte.[Proba_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3], arg_max_cte.[arg_max_Score] AS [Decision] 
FROM arg_max_cte