-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH [ADS_imp_1_OUT] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_0] IS NULL) THEN -0.0933574247358 ELSE [ADS].[Feature_0] END AS impute_2, CASE WHEN ([ADS].[Feature_1] IS NULL) THEN -0.0316063299885 ELSE [ADS].[Feature_1] END AS impute_3, CASE WHEN ([ADS].[Feature_2] IS NULL) THEN -0.307849718782 ELSE [ADS].[Feature_2] END AS impute_4, CASE WHEN ([ADS].[Feature_3] IS NULL) THEN 0.0577872984523 ELSE [ADS].[Feature_3] END AS impute_5, CASE WHEN ([ADS].[Feature_4] IS NULL) THEN -0.0670475469295 ELSE [ADS].[Feature_4] END AS impute_6, CASE WHEN ([ADS].[Feature_5] IS NULL) THEN -0.535864386457 ELSE [ADS].[Feature_5] END AS impute_7, CASE WHEN ([ADS].[Feature_6] IS NULL) THEN 0.116966682063 ELSE [ADS].[Feature_6] END AS impute_8, CASE WHEN ([ADS].[Feature_7] IS NULL) THEN -0.0815549779793 ELSE [ADS].[Feature_7] END AS impute_9, CASE WHEN ([ADS].[Feature_8] IS NULL) THEN -0.014965544558 ELSE [ADS].[Feature_8] END AS impute_10, CASE WHEN ([ADS].[Feature_9] IS NULL) THEN -0.0343589091774 ELSE [ADS].[Feature_9] END AS impute_11, CASE WHEN ([ADS].[Feature_10] IS NULL) THEN 0.333225323819 ELSE [ADS].[Feature_10] END AS impute_12, CASE WHEN ([ADS].[Feature_11] IS NULL) THEN -0.122577675176 ELSE [ADS].[Feature_11] END AS impute_13, CASE WHEN ([ADS].[Feature_12] IS NULL) THEN 0.217743202944 ELSE [ADS].[Feature_12] END AS impute_14, CASE WHEN ([ADS].[Feature_13] IS NULL) THEN -0.0403465924363 ELSE [ADS].[Feature_13] END AS impute_15, CASE WHEN ([ADS].[Feature_14] IS NULL) THEN -0.0867198429204 ELSE [ADS].[Feature_14] END AS impute_16, CASE WHEN ([ADS].[Feature_15] IS NULL) THEN -0.290983912226 ELSE [ADS].[Feature_15] END AS impute_17, CASE WHEN ([ADS].[Feature_16] IS NULL) THEN 0.0527296617922 ELSE [ADS].[Feature_16] END AS impute_18, CASE WHEN ([ADS].[Feature_17] IS NULL) THEN 0.0482338225625 ELSE [ADS].[Feature_17] END AS impute_19, CASE WHEN ([ADS].[Feature_18] IS NULL) THEN -0.220238013503 ELSE [ADS].[Feature_18] END AS impute_20, CASE WHEN ([ADS].[Feature_19] IS NULL) THEN 0.156272239054 ELSE [ADS].[Feature_19] END AS impute_21 
FROM [INPUT_DATA] AS [ADS]), 
[CenteredDataForPCA] AS 
(SELECT [ADS_imp_1_OUT].[KEY] AS [KEY], [ADS_imp_1_OUT].impute_2 - -0.0933574247358 AS impute_2, [ADS_imp_1_OUT].impute_3 - -0.0316063299885 AS impute_3, [ADS_imp_1_OUT].impute_4 - -0.307849718782 AS impute_4, [ADS_imp_1_OUT].impute_5 - 0.0577872984523 AS impute_5, [ADS_imp_1_OUT].impute_6 - -0.0670475469295 AS impute_6, [ADS_imp_1_OUT].impute_7 - -0.535864386457 AS impute_7, [ADS_imp_1_OUT].impute_8 - 0.116966682063 AS impute_8, [ADS_imp_1_OUT].impute_9 - -0.0815549779793 AS impute_9, [ADS_imp_1_OUT].impute_10 - -0.014965544558 AS impute_10, [ADS_imp_1_OUT].impute_11 - -0.0343589091774 AS impute_11, [ADS_imp_1_OUT].impute_12 - 0.333225323819 AS impute_12, [ADS_imp_1_OUT].impute_13 - -0.122577675176 AS impute_13, [ADS_imp_1_OUT].impute_14 - 0.217743202944 AS impute_14, [ADS_imp_1_OUT].impute_15 - -0.0403465924363 AS impute_15, [ADS_imp_1_OUT].impute_16 - -0.0867198429204 AS impute_16, [ADS_imp_1_OUT].impute_17 - -0.290983912226 AS impute_17, [ADS_imp_1_OUT].impute_18 - 0.0527296617922 AS impute_18, [ADS_imp_1_OUT].impute_19 - 0.0482338225625 AS impute_19, [ADS_imp_1_OUT].impute_20 - -0.220238013503 AS impute_20, [ADS_imp_1_OUT].impute_21 - 0.156272239054 AS impute_21 
FROM [ADS_imp_1_OUT]), 
[ADS_ano_2_OUT] AS 
(SELECT [CenteredDataForPCA].[KEY] AS [KEY], [CenteredDataForPCA].impute_2 * 0.0606075005162 + [CenteredDataForPCA].impute_3 * 0.0196669005277 + [CenteredDataForPCA].impute_4 * -0.683730293971 + [CenteredDataForPCA].impute_5 * 0.0456379039396 + [CenteredDataForPCA].impute_6 * 0.0817578211076 + [CenteredDataForPCA].impute_7 * -0.354867962408 + [CenteredDataForPCA].impute_8 * 0.0484847221499 + [CenteredDataForPCA].impute_9 * 0.0276035724941 + [CenteredDataForPCA].impute_10 * 0.0367589414617 + [CenteredDataForPCA].impute_11 * -0.367062841279 + [CenteredDataForPCA].impute_12 * -0.182093416404 + [CenteredDataForPCA].impute_13 * 0.00956902039805 + [CenteredDataForPCA].impute_14 * 0.0319693077296 + [CenteredDataForPCA].impute_15 * 0.0204076254557 + [CenteredDataForPCA].impute_16 * 0.0549821885591 + [CenteredDataForPCA].impute_17 * -0.45400783388 + [CenteredDataForPCA].impute_18 * -0.0685128803655 + [CenteredDataForPCA].impute_19 * 0.058153198298 + [CenteredDataForPCA].impute_20 * 0.0458907269406 + [CenteredDataForPCA].impute_21 * 0.0232231639505 AS anoova_2, [CenteredDataForPCA].impute_2 * -0.12995928387 + [CenteredDataForPCA].impute_3 * 0.159434975075 + [CenteredDataForPCA].impute_4 * -0.124616277218 + [CenteredDataForPCA].impute_5 * 0.0872669156121 + [CenteredDataForPCA].impute_6 * 0.0790404974763 + [CenteredDataForPCA].impute_7 * -0.679687494824 + [CenteredDataForPCA].impute_8 * 0.0490805173564 + [CenteredDataForPCA].impute_9 * 0.0916706590306 + [CenteredDataForPCA].impute_10 * 0.0223982815143 + [CenteredDataForPCA].impute_11 * 0.465347064677 + [CenteredDataForPCA].impute_12 * 0.0173354012148 + [CenteredDataForPCA].impute_13 * -0.00364858294177 + [CenteredDataForPCA].impute_14 * 0.0212981037405 + [CenteredDataForPCA].impute_15 * -0.163847229561 + [CenteredDataForPCA].impute_16 * -0.0650008985725 + [CenteredDataForPCA].impute_17 * 0.366821779818 + [CenteredDataForPCA].impute_18 * -0.00515680337294 + [CenteredDataForPCA].impute_19 * 0.00854976300023 + [CenteredDataForPCA].impute_20 * 0.0421956626946 + [CenteredDataForPCA].impute_21 * 0.264924552705 AS anoova_3, [CenteredDataForPCA].impute_2 * -0.0928595967049 + [CenteredDataForPCA].impute_3 * -0.0737650194582 + [CenteredDataForPCA].impute_4 * -0.253778344646 + [CenteredDataForPCA].impute_5 * -0.0199646161387 + [CenteredDataForPCA].impute_6 * -0.15649120947 + [CenteredDataForPCA].impute_7 * -0.0131452954006 + [CenteredDataForPCA].impute_8 * -0.024450033073 + [CenteredDataForPCA].impute_9 * 0.0665555298586 + [CenteredDataForPCA].impute_10 * 0.0826079960352 + [CenteredDataForPCA].impute_11 * -0.386510563468 + [CenteredDataForPCA].impute_12 * 0.0364022063025 + [CenteredDataForPCA].impute_13 * -0.00922291209577 + [CenteredDataForPCA].impute_14 * -0.0828028780464 + [CenteredDataForPCA].impute_15 * -0.0576808558707 + [CenteredDataForPCA].impute_16 * -0.0568517278129 + [CenteredDataForPCA].impute_17 * 0.53028027219 + [CenteredDataForPCA].impute_18 * 0.611446794723 + [CenteredDataForPCA].impute_19 * 0.0785229667815 + [CenteredDataForPCA].impute_20 * -0.145857383339 + [CenteredDataForPCA].impute_21 * -0.194677334167 AS anoova_4, [CenteredDataForPCA].impute_2 * -0.117340666055 + [CenteredDataForPCA].impute_3 * -0.0144375313569 + [CenteredDataForPCA].impute_4 * -0.112157246896 + [CenteredDataForPCA].impute_5 * 0.0402706705871 + [CenteredDataForPCA].impute_6 * -0.138170743584 + [CenteredDataForPCA].impute_7 * 0.186517693128 + [CenteredDataForPCA].impute_8 * 0.0216024656324 + [CenteredDataForPCA].impute_9 * 0.0865650429393 + [CenteredDataForPCA].impute_10 * -0.141571659186 + [CenteredDataForPCA].impute_11 * 0.108259488098 + [CenteredDataForPCA].impute_12 * -0.763231225473 + [CenteredDataForPCA].impute_13 * 0.0194361443053 + [CenteredDataForPCA].impute_14 * -0.19226971935 + [CenteredDataForPCA].impute_15 * -0.0893187837813 + [CenteredDataForPCA].impute_16 * -0.188451333042 + [CenteredDataForPCA].impute_17 * 0.227533418737 + [CenteredDataForPCA].impute_18 * -0.291839617188 + [CenteredDataForPCA].impute_19 * 0.207731955539 + [CenteredDataForPCA].impute_20 * 0.0525282349184 + [CenteredDataForPCA].impute_21 * -0.178902934785 AS anoova_5, [CenteredDataForPCA].impute_2 * -0.143993580497 + [CenteredDataForPCA].impute_3 * -0.383637860155 + [CenteredDataForPCA].impute_4 * 0.0199973214526 + [CenteredDataForPCA].impute_5 * -0.410463304214 + [CenteredDataForPCA].impute_6 * -0.34961530966 + [CenteredDataForPCA].impute_7 * -0.273293676216 + [CenteredDataForPCA].impute_8 * 0.036221639639 + [CenteredDataForPCA].impute_9 * 0.0287472609148 + [CenteredDataForPCA].impute_10 * -0.179104036574 + [CenteredDataForPCA].impute_11 * 0.178754131424 + [CenteredDataForPCA].impute_12 * 0.218894749194 + [CenteredDataForPCA].impute_13 * -0.0594148234123 + [CenteredDataForPCA].impute_14 * -0.154125401496 + [CenteredDataForPCA].impute_15 * 0.0338297277007 + [CenteredDataForPCA].impute_16 * 0.195125505265 + [CenteredDataForPCA].impute_17 * -0.145004881968 + [CenteredDataForPCA].impute_18 * -0.0840824749257 + [CenteredDataForPCA].impute_19 * 0.36600321371 + [CenteredDataForPCA].impute_20 * -0.0187748618847 + [CenteredDataForPCA].impute_21 * -0.351130469831 AS anoova_6, [CenteredDataForPCA].impute_2 * 0.399376486471 + [CenteredDataForPCA].impute_3 * -0.275974276646 + [CenteredDataForPCA].impute_4 * -0.0562529951967 + [CenteredDataForPCA].impute_5 * -0.0181347819691 + [CenteredDataForPCA].impute_6 * 0.341377581561 + [CenteredDataForPCA].impute_7 * -0.131062073035 + [CenteredDataForPCA].impute_8 * 0.0849966667863 + [CenteredDataForPCA].impute_9 * -0.0220269668182 + [CenteredDataForPCA].impute_10 * -0.2440325798 + [CenteredDataForPCA].impute_11 * 0.113134587572 + [CenteredDataForPCA].impute_12 * -0.124358477001 + [CenteredDataForPCA].impute_13 * -0.0589495531766 + [CenteredDataForPCA].impute_14 * -0.136180753414 + [CenteredDataForPCA].impute_15 * 0.570382256692 + [CenteredDataForPCA].impute_16 * 0.0485153916327 + [CenteredDataForPCA].impute_17 * 0.191781616705 + [CenteredDataForPCA].impute_18 * 0.00160610698263 + [CenteredDataForPCA].impute_19 * -0.21970247865 + [CenteredDataForPCA].impute_20 * -0.290317781328 + [CenteredDataForPCA].impute_21 * -0.112049871108 AS anoova_7, [CenteredDataForPCA].impute_2 * -0.139557545402 + [CenteredDataForPCA].impute_3 * 0.0719567455053 + [CenteredDataForPCA].impute_4 * -0.0132703643703 + [CenteredDataForPCA].impute_5 * -0.118288189788 + [CenteredDataForPCA].impute_6 * -0.346017389284 + [CenteredDataForPCA].impute_7 * 0.0797656556194 + [CenteredDataForPCA].impute_8 * 0.792246801245 + [CenteredDataForPCA].impute_9 * -0.035973136879 + [CenteredDataForPCA].impute_10 * -0.0936627498815 + [CenteredDataForPCA].impute_11 * -0.0686622505919 + [CenteredDataForPCA].impute_12 * -0.0499172332372 + [CenteredDataForPCA].impute_13 * 0.00549227829934 + [CenteredDataForPCA].impute_14 * -0.0208900836133 + [CenteredDataForPCA].impute_15 * 0.176737135348 + [CenteredDataForPCA].impute_16 * 0.111595184184 + [CenteredDataForPCA].impute_17 * 0.0284187163503 + [CenteredDataForPCA].impute_18 * 0.0334053568045 + [CenteredDataForPCA].impute_19 * -0.189053505258 + [CenteredDataForPCA].impute_20 * 0.0246362279665 + [CenteredDataForPCA].impute_21 * 0.328224536614 AS anoova_8, [CenteredDataForPCA].impute_2 * 0.0898939875043 + [CenteredDataForPCA].impute_3 * 0.152684896397 + [CenteredDataForPCA].impute_4 * 0.0145170513537 + [CenteredDataForPCA].impute_5 * -0.365395937331 + [CenteredDataForPCA].impute_6 * 0.174718333199 + [CenteredDataForPCA].impute_7 * -0.0047842015 + [CenteredDataForPCA].impute_8 * 0.164742784532 + [CenteredDataForPCA].impute_9 * 0.393652163057 + [CenteredDataForPCA].impute_10 * 0.0204543862569 + [CenteredDataForPCA].impute_11 * -0.00321737456658 + [CenteredDataForPCA].impute_12 * 0.0364939857719 + [CenteredDataForPCA].impute_13 * -0.0144595659439 + [CenteredDataForPCA].impute_14 * 0.387891079354 + [CenteredDataForPCA].impute_15 * 0.19267052068 + [CenteredDataForPCA].impute_16 * -0.355071609379 + [CenteredDataForPCA].impute_17 * 0.0450447317137 + [CenteredDataForPCA].impute_18 * 0.0467864844048 + [CenteredDataForPCA].impute_19 * 0.00160708095887 + [CenteredDataForPCA].impute_20 * 0.469744251743 + [CenteredDataForPCA].impute_21 * -0.285871867431 AS anoova_9, [CenteredDataForPCA].impute_2 * 0.336875743484 + [CenteredDataForPCA].impute_3 * -0.391231260584 + [CenteredDataForPCA].impute_4 * 0.0489167339325 + [CenteredDataForPCA].impute_5 * 0.206049300037 + [CenteredDataForPCA].impute_6 * 0.195443239294 + [CenteredDataForPCA].impute_7 * 0.068579831896 + [CenteredDataForPCA].impute_8 * 0.220305919948 + [CenteredDataForPCA].impute_9 * 0.00748768779497 + [CenteredDataForPCA].impute_10 * 0.0632445351705 + [CenteredDataForPCA].impute_11 * -0.012934369073 + [CenteredDataForPCA].impute_12 * -0.00828611907634 + [CenteredDataForPCA].impute_13 * 0.375420335087 + [CenteredDataForPCA].impute_14 * 0.070726599401 + [CenteredDataForPCA].impute_15 * -0.146706853246 + [CenteredDataForPCA].impute_16 * 0.247655518288 + [CenteredDataForPCA].impute_17 * 0.124723393032 + [CenteredDataForPCA].impute_18 * 0.0745245948926 + [CenteredDataForPCA].impute_19 * 0.434574435508 + [CenteredDataForPCA].impute_20 * 0.350721799498 + [CenteredDataForPCA].impute_21 * 0.176370151628 AS anoova_10, [CenteredDataForPCA].impute_2 * -0.110124563131 + [CenteredDataForPCA].impute_3 * -0.11234079849 + [CenteredDataForPCA].impute_4 * -0.0585452746334 + [CenteredDataForPCA].impute_5 * -0.588589275766 + [CenteredDataForPCA].impute_6 * 0.199766804293 + [CenteredDataForPCA].impute_7 * 0.069380724593 + [CenteredDataForPCA].impute_8 * -0.108662407617 + [CenteredDataForPCA].impute_9 * -0.143510262137 + [CenteredDataForPCA].impute_10 * 0.191675668444 + [CenteredDataForPCA].impute_11 * 0.00602763332196 + [CenteredDataForPCA].impute_12 * -0.271474208999 + [CenteredDataForPCA].impute_13 * 0.0588075345947 + [CenteredDataForPCA].impute_14 * 0.418874590659 + [CenteredDataForPCA].impute_15 * -0.162809547534 + [CenteredDataForPCA].impute_16 * 0.356360062109 + [CenteredDataForPCA].impute_17 * 0.136962957367 + [CenteredDataForPCA].impute_18 * -0.0471472200864 + [CenteredDataForPCA].impute_19 * -0.102806539927 + [CenteredDataForPCA].impute_20 * -0.219141173066 + [CenteredDataForPCA].impute_21 * 0.160631514237 AS anoova_11, [CenteredDataForPCA].impute_2 * -0.285447462222 + [CenteredDataForPCA].impute_3 * 0.240292743917 + [CenteredDataForPCA].impute_4 * 0.0410765328657 + [CenteredDataForPCA].impute_5 * 0.198869407799 + [CenteredDataForPCA].impute_6 * 0.0112464169296 + [CenteredDataForPCA].impute_7 * -0.0132733333134 + [CenteredDataForPCA].impute_8 * 0.0302498923585 + [CenteredDataForPCA].impute_9 * 0.0197430976084 + [CenteredDataForPCA].impute_10 * 0.542250274681 + [CenteredDataForPCA].impute_11 * 0.0866114401379 + [CenteredDataForPCA].impute_12 * -0.0386131977359 + [CenteredDataForPCA].impute_13 * 0.201659196484 + [CenteredDataForPCA].impute_14 * 0.0440020948625 + [CenteredDataForPCA].impute_15 * 0.530672564665 + [CenteredDataForPCA].impute_16 * 0.26465260025 + [CenteredDataForPCA].impute_17 * 0.0216291540153 + [CenteredDataForPCA].impute_18 * -0.061522329557 + [CenteredDataForPCA].impute_19 * 0.25375109571 + [CenteredDataForPCA].impute_20 * -0.0928613908301 + [CenteredDataForPCA].impute_21 * -0.208290112731 AS anoova_12, [CenteredDataForPCA].impute_2 * 0.0142576741944 + [CenteredDataForPCA].impute_3 * -0.225678159461 + [CenteredDataForPCA].impute_4 * -0.0431285492243 + [CenteredDataForPCA].impute_5 * -0.0760230951782 + [CenteredDataForPCA].impute_6 * -0.401978738626 + [CenteredDataForPCA].impute_7 * 0.0067787490439 + [CenteredDataForPCA].impute_8 * -0.447631735771 + [CenteredDataForPCA].impute_9 * 0.0844604725891 + [CenteredDataForPCA].impute_10 * 0.0160113923099 + [CenteredDataForPCA].impute_11 * -0.0323745888305 + [CenteredDataForPCA].impute_12 * -0.0542254050594 + [CenteredDataForPCA].impute_13 * 0.0564466340001 + [CenteredDataForPCA].impute_14 * 0.107307796144 + [CenteredDataForPCA].impute_15 * 0.436856691046 + [CenteredDataForPCA].impute_16 * -0.200712257455 + [CenteredDataForPCA].impute_17 * 0.0316464599612 + [CenteredDataForPCA].impute_18 * 0.0171065072325 + [CenteredDataForPCA].impute_19 * 0.0646081084417 + [CenteredDataForPCA].impute_20 * 0.157826376053 + [CenteredDataForPCA].impute_21 * 0.540030705558 AS anoova_13, [CenteredDataForPCA].impute_2 * 0.144485068632 + [CenteredDataForPCA].impute_3 * 0.447814381709 + [CenteredDataForPCA].impute_4 * 0.0407666645324 + [CenteredDataForPCA].impute_5 * -0.246433689066 + [CenteredDataForPCA].impute_6 * 0.215824725629 + [CenteredDataForPCA].impute_7 * 0.106009662438 + [CenteredDataForPCA].impute_8 * 0.00301483633286 + [CenteredDataForPCA].impute_9 * 0.0968003210755 + [CenteredDataForPCA].impute_10 * -0.186129245599 + [CenteredDataForPCA].impute_11 * -0.0800933255008 + [CenteredDataForPCA].impute_12 * 0.0457684542943 + [CenteredDataForPCA].impute_13 * -0.266729456175 + [CenteredDataForPCA].impute_14 * -0.188777485481 + [CenteredDataForPCA].impute_15 * 0.0719641011835 + [CenteredDataForPCA].impute_16 * 0.0402927335916 + [CenteredDataForPCA].impute_17 * -0.00159653892491 + [CenteredDataForPCA].impute_18 * 0.0618194179421 + [CenteredDataForPCA].impute_19 * 0.595547941092 + [CenteredDataForPCA].impute_20 * -0.194454217211 + [CenteredDataForPCA].impute_21 * 0.309750641466 AS anoova_14, [CenteredDataForPCA].impute_2 * -0.195859232713 + [CenteredDataForPCA].impute_3 * -0.111622452184 + [CenteredDataForPCA].impute_4 * -0.00541318033293 + [CenteredDataForPCA].impute_5 * 0.331857259487 + [CenteredDataForPCA].impute_6 * 0.0119338074018 + [CenteredDataForPCA].impute_7 * -0.00135478544486 + [CenteredDataForPCA].impute_8 * 0.0826817329406 + [CenteredDataForPCA].impute_9 * -0.354354904793 + [CenteredDataForPCA].impute_10 * -0.291974012427 + [CenteredDataForPCA].impute_11 * -0.00598968401379 + [CenteredDataForPCA].impute_12 * -0.00480627039788 + [CenteredDataForPCA].impute_13 * -0.359648754854 + [CenteredDataForPCA].impute_14 * 0.623359737672 + [CenteredDataForPCA].impute_15 * 0.0951868421207 + [CenteredDataForPCA].impute_16 * -0.0982239188547 + [CenteredDataForPCA].impute_17 * 0.0327482615706 + [CenteredDataForPCA].impute_18 * 0.0224418500058 + [CenteredDataForPCA].impute_19 * 0.26935397093 + [CenteredDataForPCA].impute_20 * -0.077286409555 + [CenteredDataForPCA].impute_21 * -0.0665689728302 AS anoova_15, [CenteredDataForPCA].impute_2 * 0.140964318417 + [CenteredDataForPCA].impute_3 * 0.355116226805 + [CenteredDataForPCA].impute_4 * -0.0533118300399 + [CenteredDataForPCA].impute_5 * -0.0202278643299 + [CenteredDataForPCA].impute_6 * -0.150657867355 + [CenteredDataForPCA].impute_7 * -0.0372850956036 + [CenteredDataForPCA].impute_8 * -0.21924561776 + [CenteredDataForPCA].impute_9 * -0.313187563873 + [CenteredDataForPCA].impute_10 * -0.265852629717 + [CenteredDataForPCA].impute_11 * -0.00322263465504 + [CenteredDataForPCA].impute_12 * -0.0734321545882 + [CenteredDataForPCA].impute_13 * -0.0828933479218 + [CenteredDataForPCA].impute_14 * -0.0420412479022 + [CenteredDataForPCA].impute_15 * 0.108441957399 + [CenteredDataForPCA].impute_16 * 0.500071247229 + [CenteredDataForPCA].impute_17 * 0.159964527613 + [CenteredDataForPCA].impute_18 * 0.0732820585095 + [CenteredDataForPCA].impute_19 * -0.135252579172 + [CenteredDataForPCA].impute_20 * 0.515557884549 + [CenteredDataForPCA].impute_21 * -0.137568426803 AS anoova_16, [CenteredDataForPCA].impute_2 * -0.608718266808 + [CenteredDataForPCA].impute_3 * -0.204596191439 + [CenteredDataForPCA].impute_4 * 0.0121128251918 + [CenteredDataForPCA].impute_5 * 0.106626489166 + [CenteredDataForPCA].impute_6 * 0.383298193663 + [CenteredDataForPCA].impute_7 * 0.0994119174849 + [CenteredDataForPCA].impute_8 * -0.0829039226436 + [CenteredDataForPCA].impute_9 * 0.384237996132 + [CenteredDataForPCA].impute_10 * -0.284405126369 + [CenteredDataForPCA].impute_11 * -0.0955976571946 + [CenteredDataForPCA].impute_12 * 0.0245060853093 + [CenteredDataForPCA].impute_13 * -0.099810169302 + [CenteredDataForPCA].impute_14 * -0.142368688557 + [CenteredDataForPCA].impute_15 * 0.0803541333509 + [CenteredDataForPCA].impute_16 * 0.259792646268 + [CenteredDataForPCA].impute_17 * -0.0192692379692 + [CenteredDataForPCA].impute_18 * 0.052890876809 + [CenteredDataForPCA].impute_19 * -0.10471365872 + [CenteredDataForPCA].impute_20 * 0.19603624902 + [CenteredDataForPCA].impute_21 * 0.131927418366 AS anoova_17, [CenteredDataForPCA].impute_2 * 0.167732772194 + [CenteredDataForPCA].impute_3 * -0.219437918392 + [CenteredDataForPCA].impute_4 * 0.0145176174622 + [CenteredDataForPCA].impute_5 * 0.0635089255845 + [CenteredDataForPCA].impute_6 * -0.0385390785496 + [CenteredDataForPCA].impute_7 * 0.0265559478574 + [CenteredDataForPCA].impute_8 * 0.0632046237419 + [CenteredDataForPCA].impute_9 * 0.119123278801 + [CenteredDataForPCA].impute_10 * 0.483323320198 + [CenteredDataForPCA].impute_11 * 0.0359082860129 + [CenteredDataForPCA].impute_12 * -0.078905493581 + [CenteredDataForPCA].impute_13 * -0.765876882517 + [CenteredDataForPCA].impute_14 * -0.10329011341 + [CenteredDataForPCA].impute_15 * -0.0547850183676 + [CenteredDataForPCA].impute_16 * 0.136399293777 + [CenteredDataForPCA].impute_17 * 0.0378113734436 + [CenteredDataForPCA].impute_18 * -0.0391236616479 + [CenteredDataForPCA].impute_19 * -0.0372682545565 + [CenteredDataForPCA].impute_20 * 0.181053037084 + [CenteredDataForPCA].impute_21 * 0.044767190578 AS anoova_18, [CenteredDataForPCA].impute_2 * 0.253330746013 + [CenteredDataForPCA].impute_3 * 0.115076949459 + [CenteredDataForPCA].impute_4 * 0.022197362499 + [CenteredDataForPCA].impute_5 * 0.225994046437 + [CenteredDataForPCA].impute_6 * -0.311162412521 + [CenteredDataForPCA].impute_7 * 0.0188660694713 + [CenteredDataForPCA].impute_8 * -0.0585740232873 + [CenteredDataForPCA].impute_9 * 0.631122600824 + [CenteredDataForPCA].impute_10 * -0.17426940725 + [CenteredDataForPCA].impute_11 * 0.0301663394852 + [CenteredDataForPCA].impute_12 * -0.0329779337118 + [CenteredDataForPCA].impute_13 * 0.006623190453 + [CenteredDataForPCA].impute_14 * 0.332679860207 + [CenteredDataForPCA].impute_15 * -0.103199686556 + [CenteredDataForPCA].impute_16 * 0.359105749411 + [CenteredDataForPCA].impute_17 * -0.0063717500887 + [CenteredDataForPCA].impute_18 * -0.0414003565476 + [CenteredDataForPCA].impute_19 * -0.058235275383 + [CenteredDataForPCA].impute_20 * -0.28428761085 + [CenteredDataForPCA].impute_21 * -0.0585707872749 AS anoova_19, [CenteredDataForPCA].impute_2 * -3.11962867621e-17 + [CenteredDataForPCA].impute_3 * 2.59528175733e-16 + [CenteredDataForPCA].impute_4 * -0.508086449425 + [CenteredDataForPCA].impute_5 * -1.96154180062e-16 + [CenteredDataForPCA].impute_6 * -1.57860341634e-16 + [CenteredDataForPCA].impute_7 * 0.332209993335 + [CenteredDataForPCA].impute_8 * -2.60648767719e-16 + [CenteredDataForPCA].impute_9 * -1.28729575372e-16 + [CenteredDataForPCA].impute_10 * -7.53953556585e-17 + [CenteredDataForPCA].impute_11 * 0.0379238696499 + [CenteredDataForPCA].impute_12 * 0.470672244755 + [CenteredDataForPCA].impute_13 * 2.33942039679e-16 + [CenteredDataForPCA].impute_14 * 2.44725709159e-16 + [CenteredDataForPCA].impute_15 * 1.0197615268e-17 + [CenteredDataForPCA].impute_16 * 1.69221136627e-16 + [CenteredDataForPCA].impute_17 * 0.365221514869 + [CenteredDataForPCA].impute_18 * -0.524525827242 + [CenteredDataForPCA].impute_19 * -2.58155315505e-17 + [CenteredDataForPCA].impute_20 * -1.68507879516e-16 + [CenteredDataForPCA].impute_21 * -2.1729229212e-17 AS anoova_20, [CenteredDataForPCA].impute_2 * 6.1905763221e-17 + [CenteredDataForPCA].impute_3 * -2.50802963637e-16 + [CenteredDataForPCA].impute_4 * -0.403914178827 + [CenteredDataForPCA].impute_5 * 4.42518872426e-17 + [CenteredDataForPCA].impute_6 * -4.28463987978e-17 + [CenteredDataForPCA].impute_7 * 0.367700165571 + [CenteredDataForPCA].impute_8 * -4.04982130264e-17 + [CenteredDataForPCA].impute_9 * -3.50293665509e-17 + [CenteredDataForPCA].impute_10 * 1.3748759784e-16 + [CenteredDataForPCA].impute_11 * 0.640420239881 + [CenteredDataForPCA].impute_12 * -0.0183308617687 + [CenteredDataForPCA].impute_13 * 1.68835478283e-17 + [CenteredDataForPCA].impute_14 * 1.19198025304e-16 + [CenteredDataForPCA].impute_15 * 2.29183936852e-17 + [CenteredDataForPCA].impute_16 * -1.91325009322e-17 + [CenteredDataForPCA].impute_17 * -0.260826932737 + [CenteredDataForPCA].impute_18 * 0.472382399543 + [CenteredDataForPCA].impute_19 * -1.14680806595e-16 + [CenteredDataForPCA].impute_20 * 2.32209511882e-17 + [CenteredDataForPCA].impute_21 * -7.82748118777e-18 AS anoova_21 
FROM [CenteredDataForPCA]), 
linear_model_cte AS 
(SELECT [ADS_ano_2_OUT].[KEY] AS [KEY], 0.21165830650553127 * [ADS_ano_2_OUT].anoova_2 + -0.4940663200612714 * [ADS_ano_2_OUT].anoova_3 + -0.16260821595105585 * [ADS_ano_2_OUT].anoova_4 + 0.7025242070423086 * [ADS_ano_2_OUT].anoova_5 + -0.3244808023791873 * [ADS_ano_2_OUT].anoova_6 + 0.10014677468243455 * [ADS_ano_2_OUT].anoova_7 + 0.43167314116478805 * [ADS_ano_2_OUT].anoova_8 + 0.5866096360208398 * [ADS_ano_2_OUT].anoova_9 + -0.5965293722621018 * [ADS_ano_2_OUT].anoova_10 + 0.18693356474738745 * [ADS_ano_2_OUT].anoova_11 + 0.06948852536965841 * [ADS_ano_2_OUT].anoova_12 + 0.05157363633048858 * [ADS_ano_2_OUT].anoova_13 + 0.26120991022225903 * [ADS_ano_2_OUT].anoova_14 + -0.165916067549928 * [ADS_ano_2_OUT].anoova_15 + -0.05072057063670401 * [ADS_ano_2_OUT].anoova_16 + -0.09798494938796451 * [ADS_ano_2_OUT].anoova_17 + -0.1503228799094618 * [ADS_ano_2_OUT].anoova_18 + -0.25135775601542987 * [ADS_ano_2_OUT].anoova_19 + -1.328152583993078e-15 * [ADS_ano_2_OUT].anoova_20 + 1.3190566182817369e-15 * [ADS_ano_2_OUT].anoova_21 + -1.70514600753 AS [Score_0], 0.2245894883931392 * [ADS_ano_2_OUT].anoova_2 + 0.30346269508716245 * [ADS_ano_2_OUT].anoova_3 + -0.5043439247580593 * [ADS_ano_2_OUT].anoova_4 + -0.37870590689447287 * [ADS_ano_2_OUT].anoova_5 + -0.11424660472347202 * [ADS_ano_2_OUT].anoova_6 + -0.26263714807869964 * [ADS_ano_2_OUT].anoova_7 + 0.20812078326156427 * [ADS_ano_2_OUT].anoova_8 + -0.28133374253527527 * [ADS_ano_2_OUT].anoova_9 + 0.3350866692803753 * [ADS_ano_2_OUT].anoova_10 + -0.2033515012159533 * [ADS_ano_2_OUT].anoova_11 + 0.013862824225989057 * [ADS_ano_2_OUT].anoova_12 + 0.06435468915835874 * [ADS_ano_2_OUT].anoova_13 + 0.26439781571244664 * [ADS_ano_2_OUT].anoova_14 + 0.23014020444848 * [ADS_ano_2_OUT].anoova_15 + 0.0665125400563226 * [ADS_ano_2_OUT].anoova_16 + -0.08793695306714977 * [ADS_ano_2_OUT].anoova_17 + 0.45776067005900717 * [ADS_ano_2_OUT].anoova_18 + -0.3150235268041259 * [ADS_ano_2_OUT].anoova_19 + 1.0789178171353593e-15 * [ADS_ano_2_OUT].anoova_20 + -1.454675325685662e-16 * [ADS_ano_2_OUT].anoova_21 + -0.869222142476 AS [Score_1], -0.11132956830294782 * [ADS_ano_2_OUT].anoova_2 + 0.3593950528912702 * [ADS_ano_2_OUT].anoova_3 + 0.08793696780788711 * [ADS_ano_2_OUT].anoova_4 + -0.5376556298236652 * [ADS_ano_2_OUT].anoova_5 + 0.9114821191114129 * [ADS_ano_2_OUT].anoova_6 + 0.06933057531006973 * [ADS_ano_2_OUT].anoova_7 + -0.3319702841765131 * [ADS_ano_2_OUT].anoova_8 + 0.18550151354130723 * [ADS_ano_2_OUT].anoova_9 + -0.1187159161533768 * [ADS_ano_2_OUT].anoova_10 + -0.33877837621149387 * [ADS_ano_2_OUT].anoova_11 + -0.18165701673651719 * [ADS_ano_2_OUT].anoova_12 + -0.4301043474871994 * [ADS_ano_2_OUT].anoova_13 + -0.4077376180634886 * [ADS_ano_2_OUT].anoova_14 + -0.17565176964863072 * [ADS_ano_2_OUT].anoova_15 + 0.010271288950086624 * [ADS_ano_2_OUT].anoova_16 + 0.04629707253965587 * [ADS_ano_2_OUT].anoova_17 + -0.06379653003512983 * [ADS_ano_2_OUT].anoova_18 + -0.07906907625686668 * [ADS_ano_2_OUT].anoova_19 + -8.278974928197314e-16 * [ADS_ano_2_OUT].anoova_20 + -1.0109429668500268e-15 * [ADS_ano_2_OUT].anoova_21 + -0.981604157377 AS [Score_2], -0.489113201560227 * [ADS_ano_2_OUT].anoova_2 + 0.16364085334260448 * [ADS_ano_2_OUT].anoova_3 + 0.6084755073648042 * [ADS_ano_2_OUT].anoova_4 + 0.7191626521878864 * [ADS_ano_2_OUT].anoova_5 + -0.14213527131191342 * [ADS_ano_2_OUT].anoova_6 + 0.18804645644623233 * [ADS_ano_2_OUT].anoova_7 + 0.1898576112290071 * [ADS_ano_2_OUT].anoova_8 + -0.5536712929717724 * [ADS_ano_2_OUT].anoova_9 + 0.3641551198738545 * [ADS_ano_2_OUT].anoova_10 + 0.4488486317074766 * [ADS_ano_2_OUT].anoova_11 + 0.29032652955196153 * [ADS_ano_2_OUT].anoova_12 + 0.316352007858692 * [ADS_ano_2_OUT].anoova_13 + -0.4353042815001416 * [ADS_ano_2_OUT].anoova_14 + -0.05204729480848916 * [ADS_ano_2_OUT].anoova_15 + -0.36910805222163395 * [ADS_ano_2_OUT].anoova_16 + 0.1074026453171167 * [ADS_ano_2_OUT].anoova_17 + -0.4040456575120453 * [ADS_ano_2_OUT].anoova_18 + 0.5581117283619017 * [ADS_ano_2_OUT].anoova_19 + 1.1926439582136744e-15 * [ADS_ano_2_OUT].anoova_20 + -4.464370689430923e-16 * [ADS_ano_2_OUT].anoova_21 + -0.986036824922 AS [Score_3] 
FROM [ADS_ano_2_OUT]), 
orig_cte AS 
(SELECT linear_model_cte.[KEY] AS [KEY], linear_model_cte.[Score_0] AS [Score_0], linear_model_cte.[Score_1] AS [Score_1], linear_model_cte.[Score_2] AS [Score_2], linear_model_cte.[Score_3] AS [Score_3], CAST(NULL AS FLOAT(53)) AS [Proba_0], CAST(NULL AS FLOAT(53)) AS [Proba_1], CAST(NULL AS FLOAT(53)) AS [Proba_2], CAST(NULL AS FLOAT(53)) AS [Proba_3], CAST(NULL AS FLOAT(53)) AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [LogProba_3], CAST(NULL AS FLOAT(53)) AS [Decision] 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu.[KEY] AS [KEY], scu.class AS class, scu.[LogProba] AS [LogProba], scu.[Proba] AS [Proba], scu.[Score] AS [Score] 
FROM (SELECT orig_cte.[KEY] AS [KEY], 0 AS class, orig_cte.[LogProba_0] AS [LogProba], orig_cte.[Proba_0] AS [Proba], orig_cte.[Score_0] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY], 1 AS class, orig_cte.[LogProba_1] AS [LogProba], orig_cte.[Proba_1] AS [Proba], orig_cte.[Score_1] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY], 2 AS class, orig_cte.[LogProba_2] AS [LogProba], orig_cte.[Proba_2] AS [Proba], orig_cte.[Score_2] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY], 3 AS class, orig_cte.[LogProba_3] AS [LogProba], orig_cte.[Proba_3] AS [Proba], orig_cte.[Score_3] AS [Score] 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.[KEY] AS [KEY], orig_cte.[Score_0] AS [Score_0], orig_cte.[Score_1] AS [Score_1], orig_cte.[Score_2] AS [Score_2], orig_cte.[Score_3] AS [Score_3], orig_cte.[Proba_0] AS [Proba_0], orig_cte.[Proba_1] AS [Proba_1], orig_cte.[Proba_2] AS [Proba_2], orig_cte.[Proba_3] AS [Proba_3], orig_cte.[LogProba_0] AS [LogProba_0], orig_cte.[LogProba_1] AS [LogProba_1], orig_cte.[LogProba_2] AS [LogProba_2], orig_cte.[LogProba_3] AS [LogProba_3], orig_cte.[Decision] AS [Decision], (SELECT max(score_class_union.[LogProba]) AS max_1 
FROM score_class_union 
WHERE orig_cte.[KEY] = score_class_union.[KEY]) AS [max_LogProba], (SELECT max(score_class_union.[Proba]) AS max_2 
FROM score_class_union 
WHERE orig_cte.[KEY] = score_class_union.[KEY]) AS [max_Proba], (SELECT max(score_class_union.[Score]) AS max_3 
FROM score_class_union 
WHERE orig_cte.[KEY] = score_class_union.[KEY]) AS [max_Score] 
FROM orig_cte), 
arg_max_cte AS 
(SELECT score_max.[KEY] AS [KEY], score_max.[Score_0] AS [Score_0], score_max.[Score_1] AS [Score_1], score_max.[Score_2] AS [Score_2], score_max.[Score_3] AS [Score_3], score_max.[Proba_0] AS [Proba_0], score_max.[Proba_1] AS [Proba_1], score_max.[Proba_2] AS [Proba_2], score_max.[Proba_3] AS [Proba_3], score_max.[LogProba_0] AS [LogProba_0], score_max.[LogProba_1] AS [LogProba_1], score_max.[LogProba_2] AS [LogProba_2], score_max.[LogProba_3] AS [LogProba_3], score_max.[Decision] AS [Decision], score_max.[max_LogProba] AS [max_LogProba], score_max.[max_Proba] AS [max_Proba], score_max.[max_Score] AS [max_Score], (SELECT min(score_class_union.class) AS min_1 
FROM score_class_union 
WHERE score_max.[max_LogProba] = score_class_union.[LogProba] AND score_max.[KEY] = score_class_union.[KEY]) AS [arg_max_LogProba], (SELECT min(score_class_union.class) AS min_2 
FROM score_class_union 
WHERE score_max.[max_Proba] = score_class_union.[Proba] AND score_max.[KEY] = score_class_union.[KEY]) AS [arg_max_Proba], (SELECT min(score_class_union.class) AS min_3 
FROM score_class_union 
WHERE score_max.[max_Score] = score_class_union.[Score] AND score_max.[KEY] = score_class_union.[KEY]) AS [arg_max_Score] 
FROM score_max)
 SELECT arg_max_cte.[KEY] AS [KEY], arg_max_cte.[Score_0] AS [Score_0], arg_max_cte.[Score_1] AS [Score_1], arg_max_cte.[Score_2] AS [Score_2], arg_max_cte.[Score_3] AS [Score_3], arg_max_cte.[Proba_0] AS [Proba_0], arg_max_cte.[Proba_1] AS [Proba_1], arg_max_cte.[Proba_2] AS [Proba_2], arg_max_cte.[Proba_3] AS [Proba_3], CASE WHEN (arg_max_cte.[Proba_0] IS NULL OR arg_max_cte.[Proba_0] > 0.0) THEN log(arg_max_cte.[Proba_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CASE WHEN (arg_max_cte.[Proba_1] IS NULL OR arg_max_cte.[Proba_1] > 0.0) THEN log(arg_max_cte.[Proba_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CASE WHEN (arg_max_cte.[Proba_2] IS NULL OR arg_max_cte.[Proba_2] > 0.0) THEN log(arg_max_cte.[Proba_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CASE WHEN (arg_max_cte.[Proba_3] IS NULL OR arg_max_cte.[Proba_3] > 0.0) THEN log(arg_max_cte.[Proba_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3], arg_max_cte.[arg_max_Score] AS [Decision] 
FROM arg_max_cte