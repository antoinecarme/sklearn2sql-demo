-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH [ADS_imp_1_OUT] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_0] IS NULL) THEN 0.184206377497 ELSE [ADS].[Feature_0] END AS impute_2, CASE WHEN ([ADS].[Feature_1] IS NULL) THEN -0.189520092838 ELSE [ADS].[Feature_1] END AS impute_3, CASE WHEN ([ADS].[Feature_2] IS NULL) THEN 0.0403453874349 ELSE [ADS].[Feature_2] END AS impute_4, CASE WHEN ([ADS].[Feature_3] IS NULL) THEN 0.335043841734 ELSE [ADS].[Feature_3] END AS impute_5, CASE WHEN ([ADS].[Feature_4] IS NULL) THEN 0.0751815225603 ELSE [ADS].[Feature_4] END AS impute_6, CASE WHEN ([ADS].[Feature_5] IS NULL) THEN -0.0831034105305 ELSE [ADS].[Feature_5] END AS impute_7, CASE WHEN ([ADS].[Feature_6] IS NULL) THEN -0.00384621176855 ELSE [ADS].[Feature_6] END AS impute_8, CASE WHEN ([ADS].[Feature_7] IS NULL) THEN -0.0138054545016 ELSE [ADS].[Feature_7] END AS impute_9, CASE WHEN ([ADS].[Feature_8] IS NULL) THEN -0.245298024945 ELSE [ADS].[Feature_8] END AS impute_10, CASE WHEN ([ADS].[Feature_9] IS NULL) THEN -0.00286960156678 ELSE [ADS].[Feature_9] END AS impute_11, CASE WHEN ([ADS].[Feature_10] IS NULL) THEN 0.0170013890631 ELSE [ADS].[Feature_10] END AS impute_12, CASE WHEN ([ADS].[Feature_11] IS NULL) THEN -0.0329651362133 ELSE [ADS].[Feature_11] END AS impute_13, CASE WHEN ([ADS].[Feature_12] IS NULL) THEN 0.149071891933 ELSE [ADS].[Feature_12] END AS impute_14, CASE WHEN ([ADS].[Feature_13] IS NULL) THEN 0.131750039098 ELSE [ADS].[Feature_13] END AS impute_15, CASE WHEN ([ADS].[Feature_14] IS NULL) THEN -0.0419208653239 ELSE [ADS].[Feature_14] END AS impute_16, CASE WHEN ([ADS].[Feature_15] IS NULL) THEN 0.0179500540451 ELSE [ADS].[Feature_15] END AS impute_17, CASE WHEN ([ADS].[Feature_16] IS NULL) THEN -0.0668286348335 ELSE [ADS].[Feature_16] END AS impute_18, CASE WHEN ([ADS].[Feature_17] IS NULL) THEN 0.0417756007412 ELSE [ADS].[Feature_17] END AS impute_19, CASE WHEN ([ADS].[Feature_18] IS NULL) THEN -0.0499131017287 ELSE [ADS].[Feature_18] END AS impute_20, CASE WHEN ([ADS].[Feature_19] IS NULL) THEN -0.0403519043274 ELSE [ADS].[Feature_19] END AS impute_21 
FROM [INPUT_DATA] AS [ADS]), 
[CenteredDataForPCA] AS 
(SELECT [ADS_imp_1_OUT].[KEY] AS [KEY], [ADS_imp_1_OUT].impute_2 - 0.184206377497 AS impute_2, [ADS_imp_1_OUT].impute_3 - -0.189520092838 AS impute_3, [ADS_imp_1_OUT].impute_4 - 0.0403453874349 AS impute_4, [ADS_imp_1_OUT].impute_5 - 0.335043841734 AS impute_5, [ADS_imp_1_OUT].impute_6 - 0.0751815225603 AS impute_6, [ADS_imp_1_OUT].impute_7 - -0.0831034105305 AS impute_7, [ADS_imp_1_OUT].impute_8 - -0.00384621176855 AS impute_8, [ADS_imp_1_OUT].impute_9 - -0.0138054545016 AS impute_9, [ADS_imp_1_OUT].impute_10 - -0.245298024945 AS impute_10, [ADS_imp_1_OUT].impute_11 - -0.00286960156678 AS impute_11, [ADS_imp_1_OUT].impute_12 - 0.0170013890631 AS impute_12, [ADS_imp_1_OUT].impute_13 - -0.0329651362133 AS impute_13, [ADS_imp_1_OUT].impute_14 - 0.149071891933 AS impute_14, [ADS_imp_1_OUT].impute_15 - 0.131750039098 AS impute_15, [ADS_imp_1_OUT].impute_16 - -0.0419208653239 AS impute_16, [ADS_imp_1_OUT].impute_17 - 0.0179500540451 AS impute_17, [ADS_imp_1_OUT].impute_18 - -0.0668286348335 AS impute_18, [ADS_imp_1_OUT].impute_19 - 0.0417756007412 AS impute_19, [ADS_imp_1_OUT].impute_20 - -0.0499131017287 AS impute_20, [ADS_imp_1_OUT].impute_21 - -0.0403519043274 AS impute_21 
FROM [ADS_imp_1_OUT]), 
[ADS_ano_2_OUT] AS 
(SELECT [CenteredDataForPCA].[KEY] AS [KEY], [CenteredDataForPCA].impute_2 * 0.422636400707 + [CenteredDataForPCA].impute_3 * -0.0674381601975 + [CenteredDataForPCA].impute_4 * -0.460868123378 + [CenteredDataForPCA].impute_5 * -0.378070874258 + [CenteredDataForPCA].impute_6 * -0.0371116994135 + [CenteredDataForPCA].impute_7 * -0.0168926830216 + [CenteredDataForPCA].impute_8 * 0.00742780611755 + [CenteredDataForPCA].impute_9 * 0.0486054020643 + [CenteredDataForPCA].impute_10 * 0.632214990264 + [CenteredDataForPCA].impute_11 * 0.181573833303 + [CenteredDataForPCA].impute_12 * 0.000944867595431 + [CenteredDataForPCA].impute_13 * 0.0359614168667 + [CenteredDataForPCA].impute_14 * -0.0138949228822 + [CenteredDataForPCA].impute_15 * 0.0230931744007 + [CenteredDataForPCA].impute_16 * -0.0750105672689 + [CenteredDataForPCA].impute_17 * -0.0360128110841 + [CenteredDataForPCA].impute_18 * -0.0264687764188 + [CenteredDataForPCA].impute_19 * -0.106301932641 + [CenteredDataForPCA].impute_20 * 0.0510753975798 + [CenteredDataForPCA].impute_21 * 0.0345691209453 AS anoova_2, [CenteredDataForPCA].impute_2 * -0.257990626273 + [CenteredDataForPCA].impute_3 * -0.62781737719 + [CenteredDataForPCA].impute_4 * 0.149428570381 + [CenteredDataForPCA].impute_5 * -0.264344720185 + [CenteredDataForPCA].impute_6 * 0.0116433243004 + [CenteredDataForPCA].impute_7 * 0.0521497589895 + [CenteredDataForPCA].impute_8 * -0.121386008666 + [CenteredDataForPCA].impute_9 * -0.00900264472027 + [CenteredDataForPCA].impute_10 * -0.0177592814047 + [CenteredDataForPCA].impute_11 * -0.0367284442249 + [CenteredDataForPCA].impute_12 * 0.069973182739 + [CenteredDataForPCA].impute_13 * 0.0353687131244 + [CenteredDataForPCA].impute_14 * 0.0444148025495 + [CenteredDataForPCA].impute_15 * -0.0571480208553 + [CenteredDataForPCA].impute_16 * 0.0671094561867 + [CenteredDataForPCA].impute_17 * 0.0490462525265 + [CenteredDataForPCA].impute_18 * -0.0227715248384 + [CenteredDataForPCA].impute_19 * -0.635137782492 + [CenteredDataForPCA].impute_20 * -0.0556745481787 + [CenteredDataForPCA].impute_21 * -0.049303403567 AS anoova_3, [CenteredDataForPCA].impute_2 * -0.0856601290582 + [CenteredDataForPCA].impute_3 * 0.407290501584 + [CenteredDataForPCA].impute_4 * 0.469734057555 + [CenteredDataForPCA].impute_5 * -0.622867678641 + [CenteredDataForPCA].impute_6 * 0.154326634304 + [CenteredDataForPCA].impute_7 * 0.124549265271 + [CenteredDataForPCA].impute_8 * -0.149924184177 + [CenteredDataForPCA].impute_9 * -0.0929308140825 + [CenteredDataForPCA].impute_10 * 0.158754354086 + [CenteredDataForPCA].impute_11 * -0.180908486309 + [CenteredDataForPCA].impute_12 * 0.14982925052 + [CenteredDataForPCA].impute_13 * -0.0676692173241 + [CenteredDataForPCA].impute_14 * -0.0269652159994 + [CenteredDataForPCA].impute_15 * 0.00167645468037 + [CenteredDataForPCA].impute_16 * 0.0369538534527 + [CenteredDataForPCA].impute_17 * 0.0770487420659 + [CenteredDataForPCA].impute_18 * 0.157895523063 + [CenteredDataForPCA].impute_19 * 0.0500274635373 + [CenteredDataForPCA].impute_20 * 0.0387948847379 + [CenteredDataForPCA].impute_21 * 0.160593787528 AS anoova_4, [CenteredDataForPCA].impute_2 * -0.129218328434 + [CenteredDataForPCA].impute_3 * -0.0385432752038 + [CenteredDataForPCA].impute_4 * -0.203416844862 + [CenteredDataForPCA].impute_5 * 0.0645614912667 + [CenteredDataForPCA].impute_6 * 0.105886285243 + [CenteredDataForPCA].impute_7 * 0.231335759458 + [CenteredDataForPCA].impute_8 * -0.0446444572781 + [CenteredDataForPCA].impute_9 * 0.0283227215785 + [CenteredDataForPCA].impute_10 * 0.0578671152635 + [CenteredDataForPCA].impute_11 * -0.121756649637 + [CenteredDataForPCA].impute_12 * -0.350640721101 + [CenteredDataForPCA].impute_13 * -0.476066713087 + [CenteredDataForPCA].impute_14 * -0.221026698108 + [CenteredDataForPCA].impute_15 * 0.239274567466 + [CenteredDataForPCA].impute_16 * 0.258517420896 + [CenteredDataForPCA].impute_17 * -0.144722560915 + [CenteredDataForPCA].impute_18 * 0.152476423713 + [CenteredDataForPCA].impute_19 * -0.0441639077318 + [CenteredDataForPCA].impute_20 * -0.332021024652 + [CenteredDataForPCA].impute_21 * 0.414326941327 AS anoova_5, [CenteredDataForPCA].impute_2 * 0.363598924553 + [CenteredDataForPCA].impute_3 * -0.0758647774244 + [CenteredDataForPCA].impute_4 * 0.170248469699 + [CenteredDataForPCA].impute_5 * -0.0378882622032 + [CenteredDataForPCA].impute_6 * -0.324995617156 + [CenteredDataForPCA].impute_7 * 0.132356027182 + [CenteredDataForPCA].impute_8 * 0.0113513023987 + [CenteredDataForPCA].impute_9 * -0.378111818547 + [CenteredDataForPCA].impute_10 * -0.0232147638373 + [CenteredDataForPCA].impute_11 * -0.199062578002 + [CenteredDataForPCA].impute_12 * -0.219872407446 + [CenteredDataForPCA].impute_13 * -0.154908997303 + [CenteredDataForPCA].impute_14 * -0.00412798221185 + [CenteredDataForPCA].impute_15 * -0.480602005743 + [CenteredDataForPCA].impute_16 * 0.00752370622478 + [CenteredDataForPCA].impute_17 * -0.279126283817 + [CenteredDataForPCA].impute_18 * 0.126759911972 + [CenteredDataForPCA].impute_19 * 0.0297776508515 + [CenteredDataForPCA].impute_20 * -0.247727880512 + [CenteredDataForPCA].impute_21 * -0.256105087528 AS anoova_6, [CenteredDataForPCA].impute_2 * 0.0595869774982 + [CenteredDataForPCA].impute_3 * -0.0292665150785 + [CenteredDataForPCA].impute_4 * 0.316046178957 + [CenteredDataForPCA].impute_5 * -0.11150947934 + [CenteredDataForPCA].impute_6 * -0.00985982648783 + [CenteredDataForPCA].impute_7 * 0.100304023252 + [CenteredDataForPCA].impute_8 * 0.329194831415 + [CenteredDataForPCA].impute_9 * 0.241027554744 + [CenteredDataForPCA].impute_10 * -0.116474122149 + [CenteredDataForPCA].impute_11 * 0.508144218491 + [CenteredDataForPCA].impute_12 * -0.296920600119 + [CenteredDataForPCA].impute_13 * 0.188538260958 + [CenteredDataForPCA].impute_14 * -0.115256784142 + [CenteredDataForPCA].impute_15 * -0.197708570662 + [CenteredDataForPCA].impute_16 * -0.0903306616272 + [CenteredDataForPCA].impute_17 * -0.305291287908 + [CenteredDataForPCA].impute_18 * -0.0675338468071 + [CenteredDataForPCA].impute_19 * -0.0392539238389 + [CenteredDataForPCA].impute_20 * 0.0884482466687 + [CenteredDataForPCA].impute_21 * 0.378822393178 AS anoova_7, [CenteredDataForPCA].impute_2 * -0.139034395255 + [CenteredDataForPCA].impute_3 * 0.0529250322153 + [CenteredDataForPCA].impute_4 * -0.11208256841 + [CenteredDataForPCA].impute_5 * -0.0091316086641 + [CenteredDataForPCA].impute_6 * 0.278458602008 + [CenteredDataForPCA].impute_7 * -0.212758284572 + [CenteredDataForPCA].impute_8 * -0.0549388556891 + [CenteredDataForPCA].impute_9 * -0.15224654284 + [CenteredDataForPCA].impute_10 * 0.0578917348131 + [CenteredDataForPCA].impute_11 * -0.167038590298 + [CenteredDataForPCA].impute_12 * -0.297945451209 + [CenteredDataForPCA].impute_13 * 0.522433948342 + [CenteredDataForPCA].impute_14 * 0.306322863525 + [CenteredDataForPCA].impute_15 * -0.0331523187183 + [CenteredDataForPCA].impute_16 * -0.273299009691 + [CenteredDataForPCA].impute_17 * -0.0638960631421 + [CenteredDataForPCA].impute_18 * 0.183399257968 + [CenteredDataForPCA].impute_19 * -0.00464060077414 + [CenteredDataForPCA].impute_20 * -0.433955912806 + [CenteredDataForPCA].impute_21 * 0.166058632552 AS anoova_8, [CenteredDataForPCA].impute_2 * -0.0779609773003 + [CenteredDataForPCA].impute_3 * 0.0533877386179 + [CenteredDataForPCA].impute_4 * 0.0414913460553 + [CenteredDataForPCA].impute_5 * -0.0468550373429 + [CenteredDataForPCA].impute_6 * 0.00548531472672 + [CenteredDataForPCA].impute_7 * 0.0409960603901 + [CenteredDataForPCA].impute_8 * -0.177327542646 + [CenteredDataForPCA].impute_9 * 0.237512757098 + [CenteredDataForPCA].impute_10 * -0.00295925115435 + [CenteredDataForPCA].impute_11 * 0.0706430227473 + [CenteredDataForPCA].impute_12 * 0.186527796484 + [CenteredDataForPCA].impute_13 * 0.0140223406997 + [CenteredDataForPCA].impute_14 * 0.10611305524 + [CenteredDataForPCA].impute_15 * 0.353116703339 + [CenteredDataForPCA].impute_16 * -0.0470453362522 + [CenteredDataForPCA].impute_17 * -0.754100204914 + [CenteredDataForPCA].impute_18 * 0.132805245319 + [CenteredDataForPCA].impute_19 * 0.00218904610173 + [CenteredDataForPCA].impute_20 * -0.0855086127343 + [CenteredDataForPCA].impute_21 * -0.354701029289 AS anoova_9, [CenteredDataForPCA].impute_2 * -0.106316845846 + [CenteredDataForPCA].impute_3 * 0.0397324141258 + [CenteredDataForPCA].impute_4 * -0.0516144231199 + [CenteredDataForPCA].impute_5 * -0.0459398011528 + [CenteredDataForPCA].impute_6 * -0.460836005021 + [CenteredDataForPCA].impute_7 * 0.348786938283 + [CenteredDataForPCA].impute_8 * 0.422669364682 + [CenteredDataForPCA].impute_9 * 0.32597408256 + [CenteredDataForPCA].impute_10 * 0.0496509556861 + [CenteredDataForPCA].impute_11 * -0.309438553322 + [CenteredDataForPCA].impute_12 * 0.0477745213863 + [CenteredDataForPCA].impute_13 * 0.0137002443926 + [CenteredDataForPCA].impute_14 * 0.464092576561 + [CenteredDataForPCA].impute_15 * 0.0821258812954 + [CenteredDataForPCA].impute_16 * -0.0984859555456 + [CenteredDataForPCA].impute_17 * 0.101363076632 + [CenteredDataForPCA].impute_18 * 0.103160065081 + [CenteredDataForPCA].impute_19 * -0.0183754342058 + [CenteredDataForPCA].impute_20 * -0.0232179001571 + [CenteredDataForPCA].impute_21 * 0.0954259024595 AS anoova_10, [CenteredDataForPCA].impute_2 * 0.111331949705 + [CenteredDataForPCA].impute_3 * 0.00502091651869 + [CenteredDataForPCA].impute_4 * -0.0190874943723 + [CenteredDataForPCA].impute_5 * 0.0375192823651 + [CenteredDataForPCA].impute_6 * 0.458699787878 + [CenteredDataForPCA].impute_7 * -0.0400335414862 + [CenteredDataForPCA].impute_8 * 0.0893469597634 + [CenteredDataForPCA].impute_9 * 0.363461911662 + [CenteredDataForPCA].impute_10 * 0.00683503983174 + [CenteredDataForPCA].impute_11 * 0.0933885179272 + [CenteredDataForPCA].impute_12 * 0.27353220948 + [CenteredDataForPCA].impute_13 * -0.254472820137 + [CenteredDataForPCA].impute_14 * 0.349422506512 + [CenteredDataForPCA].impute_15 * -0.454310350125 + [CenteredDataForPCA].impute_16 * 0.25051435495 + [CenteredDataForPCA].impute_17 * 0.0211704569476 + [CenteredDataForPCA].impute_18 * -0.0352336588855 + [CenteredDataForPCA].impute_19 * 0.0471579413318 + [CenteredDataForPCA].impute_20 * -0.296995301135 + [CenteredDataForPCA].impute_21 * -0.0446857428323 AS anoova_11, [CenteredDataForPCA].impute_2 * 0.293283108144 + [CenteredDataForPCA].impute_3 * -0.0546028664675 + [CenteredDataForPCA].impute_4 * 0.194803056698 + [CenteredDataForPCA].impute_5 * -0.0660600006891 + [CenteredDataForPCA].impute_6 * 0.182020900074 + [CenteredDataForPCA].impute_7 * 0.164705056055 + [CenteredDataForPCA].impute_8 * 0.272290741229 + [CenteredDataForPCA].impute_9 * 0.202997195407 + [CenteredDataForPCA].impute_10 * -0.0300796328691 + [CenteredDataForPCA].impute_11 * -0.207121275702 + [CenteredDataForPCA].impute_12 * -0.0347173991255 + [CenteredDataForPCA].impute_13 * 0.198290071951 + [CenteredDataForPCA].impute_14 * -0.372718401867 + [CenteredDataForPCA].impute_15 * 0.292116454119 + [CenteredDataForPCA].impute_16 * -0.0378220491698 + [CenteredDataForPCA].impute_17 * 0.176072965323 + [CenteredDataForPCA].impute_18 * -0.320665277134 + [CenteredDataForPCA].impute_19 * 0.0168624475968 + [CenteredDataForPCA].impute_20 * -0.411899480792 + [CenteredDataForPCA].impute_21 * -0.281600230563 AS anoova_12, [CenteredDataForPCA].impute_2 * 0.0928907081276 + [CenteredDataForPCA].impute_3 * -0.121733602959 + [CenteredDataForPCA].impute_4 * -0.0140411219672 + [CenteredDataForPCA].impute_5 * 0.068947229076 + [CenteredDataForPCA].impute_6 * 0.0707654683027 + [CenteredDataForPCA].impute_7 * -0.156644918477 + [CenteredDataForPCA].impute_8 * 0.475184799307 + [CenteredDataForPCA].impute_9 * -0.396658805634 + [CenteredDataForPCA].impute_10 * -0.0339527485485 + [CenteredDataForPCA].impute_11 * -0.0794844655527 + [CenteredDataForPCA].impute_12 * 0.587576789545 + [CenteredDataForPCA].impute_13 * -0.0116079648573 + [CenteredDataForPCA].impute_14 * -0.123162495529 + [CenteredDataForPCA].impute_15 * 0.107371872861 + [CenteredDataForPCA].impute_16 * -0.0528819881462 + [CenteredDataForPCA].impute_17 * -0.214581127678 + [CenteredDataForPCA].impute_18 * 0.128591781859 + [CenteredDataForPCA].impute_19 * -0.0394278183603 + [CenteredDataForPCA].impute_20 * -0.0837806493775 + [CenteredDataForPCA].impute_21 * 0.324679088454 AS anoova_13, [CenteredDataForPCA].impute_2 * 0.0643983982147 + [CenteredDataForPCA].impute_3 * -0.0902056725298 + [CenteredDataForPCA].impute_4 * 0.0922634051035 + [CenteredDataForPCA].impute_5 * -0.0429168846037 + [CenteredDataForPCA].impute_6 * 0.090305992509 + [CenteredDataForPCA].impute_7 * -0.433573408736 + [CenteredDataForPCA].impute_8 * 0.190845970444 + [CenteredDataForPCA].impute_9 * 0.293494862747 + [CenteredDataForPCA].impute_10 * -0.025907627057 + [CenteredDataForPCA].impute_11 * -0.117337463753 + [CenteredDataForPCA].impute_12 * -0.168215976688 + [CenteredDataForPCA].impute_13 * -0.326442197096 + [CenteredDataForPCA].impute_14 * -0.172378851276 + [CenteredDataForPCA].impute_15 * 0.00476203277865 + [CenteredDataForPCA].impute_16 * -0.405961985531 + [CenteredDataForPCA].impute_17 * 0.114982531186 + [CenteredDataForPCA].impute_18 * 0.506392913545 + [CenteredDataForPCA].impute_19 * -0.0641016750703 + [CenteredDataForPCA].impute_20 * 0.122736705511 + [CenteredDataForPCA].impute_21 * -0.161208311493 AS anoova_14, [CenteredDataForPCA].impute_2 * -0.355881414937 + [CenteredDataForPCA].impute_3 * 0.147624941998 + [CenteredDataForPCA].impute_4 * -0.214674954015 + [CenteredDataForPCA].impute_5 * -0.0531770985149 + [CenteredDataForPCA].impute_6 * -0.167010332219 + [CenteredDataForPCA].impute_7 * -0.173378273744 + [CenteredDataForPCA].impute_8 * 0.13878737457 + [CenteredDataForPCA].impute_9 * 0.232109120654 + [CenteredDataForPCA].impute_10 * 0.123903074844 + [CenteredDataForPCA].impute_11 * -0.223757838254 + [CenteredDataForPCA].impute_12 * 0.0658720101006 + [CenteredDataForPCA].impute_13 * 0.303765269437 + [CenteredDataForPCA].impute_14 * -0.465398886661 + [CenteredDataForPCA].impute_15 * -0.360495870424 + [CenteredDataForPCA].impute_16 * 0.357550164203 + [CenteredDataForPCA].impute_17 * -0.127924973259 + [CenteredDataForPCA].impute_18 * 0.105766166409 + [CenteredDataForPCA].impute_19 * -0.0120981601054 + [CenteredDataForPCA].impute_20 * -0.00486504363249 + [CenteredDataForPCA].impute_21 * -0.086048040975 AS anoova_15, [CenteredDataForPCA].impute_2 * 0.234009759956 + [CenteredDataForPCA].impute_3 * -0.0307894841717 + [CenteredDataForPCA].impute_4 * 0.188342450015 + [CenteredDataForPCA].impute_5 * -0.0202333025475 + [CenteredDataForPCA].impute_6 * -0.405266308701 + [CenteredDataForPCA].impute_7 * -0.34644613118 + [CenteredDataForPCA].impute_8 * -0.154414752296 + [CenteredDataForPCA].impute_9 * 0.102976208507 + [CenteredDataForPCA].impute_10 * -0.0666907189744 + [CenteredDataForPCA].impute_11 * 0.277143853442 + [CenteredDataForPCA].impute_12 * 0.0752420006925 + [CenteredDataForPCA].impute_13 * 0.131899124563 + [CenteredDataForPCA].impute_14 * 0.0787205007775 + [CenteredDataForPCA].impute_15 * 0.233269820587 + [CenteredDataForPCA].impute_16 * 0.410803503336 + [CenteredDataForPCA].impute_17 * 0.216553549843 + [CenteredDataForPCA].impute_18 * 0.29570444421 + [CenteredDataForPCA].impute_19 * 0.0370653414579 + [CenteredDataForPCA].impute_20 * -0.331853997862 + [CenteredDataForPCA].impute_21 * 0.100854514764 AS anoova_16, [CenteredDataForPCA].impute_2 * -0.18145618719 + [CenteredDataForPCA].impute_3 * 0.106509669152 + [CenteredDataForPCA].impute_4 * 0.0566080402808 + [CenteredDataForPCA].impute_5 * -0.197364179339 + [CenteredDataForPCA].impute_6 * -0.00396374546718 + [CenteredDataForPCA].impute_7 * -0.449443999019 + [CenteredDataForPCA].impute_8 * 0.397053117704 + [CenteredDataForPCA].impute_9 * -0.211980911262 + [CenteredDataForPCA].impute_10 * 0.0790319950475 + [CenteredDataForPCA].impute_11 * -0.000726131022099 + [CenteredDataForPCA].impute_12 * -0.305470711752 + [CenteredDataForPCA].impute_13 * -0.205517689177 + [CenteredDataForPCA].impute_14 * 0.259108005666 + [CenteredDataForPCA].impute_15 * 0.17759127848 + [CenteredDataForPCA].impute_16 * 0.287935752646 + [CenteredDataForPCA].impute_17 * -0.100099249095 + [CenteredDataForPCA].impute_18 * -0.3653979706 + [CenteredDataForPCA].impute_19 * -0.0446785809719 + [CenteredDataForPCA].impute_20 * 0.0503655511469 + [CenteredDataForPCA].impute_21 * -0.193706141523 AS anoova_17, [CenteredDataForPCA].impute_2 * 0.320626765065 + [CenteredDataForPCA].impute_3 * -0.125774404089 + [CenteredDataForPCA].impute_4 * 0.114414830587 + [CenteredDataForPCA].impute_5 * 0.0418426222945 + [CenteredDataForPCA].impute_6 * -0.0526824614526 + [CenteredDataForPCA].impute_7 * -0.310400435727 + [CenteredDataForPCA].impute_8 * -0.261597797163 + [CenteredDataForPCA].impute_9 * 0.264285634683 + [CenteredDataForPCA].impute_10 * -0.0559785600409 + [CenteredDataForPCA].impute_11 * -0.521411533148 + [CenteredDataForPCA].impute_12 * -0.0128264813751 + [CenteredDataForPCA].impute_13 * 0.0311614947454 + [CenteredDataForPCA].impute_14 * 0.0579576420095 + [CenteredDataForPCA].impute_15 * -0.0165373708326 + [CenteredDataForPCA].impute_16 * 0.0393437991108 + [CenteredDataForPCA].impute_17 * -0.225673767556 + [CenteredDataForPCA].impute_18 * -0.323940695222 + [CenteredDataForPCA].impute_19 * 0.0110503416333 + [CenteredDataForPCA].impute_20 * 0.210424554246 + [CenteredDataForPCA].impute_21 * 0.384118555293 AS anoova_18, [CenteredDataForPCA].impute_2 * 0.261780090961 + [CenteredDataForPCA].impute_3 * -0.132794555626 + [CenteredDataForPCA].impute_4 * 0.0250351463824 + [CenteredDataForPCA].impute_5 * 0.0724781159123 + [CenteredDataForPCA].impute_6 * 0.340845499334 + [CenteredDataForPCA].impute_7 * 0.205185090374 + [CenteredDataForPCA].impute_8 * 0.15997099148 + [CenteredDataForPCA].impute_9 * -0.0717878192008 + [CenteredDataForPCA].impute_10 * -0.0315757087962 + [CenteredDataForPCA].impute_11 * -0.145585374658 + [CenteredDataForPCA].impute_12 * -0.185222263074 + [CenteredDataForPCA].impute_13 * 0.264042168846 + [CenteredDataForPCA].impute_14 * 0.123652405114 + [CenteredDataForPCA].impute_15 * 0.129915467099 + [CenteredDataForPCA].impute_16 * 0.46260717985 + [CenteredDataForPCA].impute_17 * -0.0187934633715 + [CenteredDataForPCA].impute_18 * 0.39235096356 + [CenteredDataForPCA].impute_19 * -0.00060823509382 + [CenteredDataForPCA].impute_20 * 0.424583452166 + [CenteredDataForPCA].impute_21 * -0.109458620172 AS anoova_19, [CenteredDataForPCA].impute_2 * 0.208624621684 + [CenteredDataForPCA].impute_3 * 0.304061331515 + [CenteredDataForPCA].impute_4 * -0.423864060549 + [CenteredDataForPCA].impute_5 * -0.348181667603 + [CenteredDataForPCA].impute_6 * -4.68375338514e-17 + [CenteredDataForPCA].impute_7 * -8.10983225019e-17 + [CenteredDataForPCA].impute_8 * -5.37764277553e-17 + [CenteredDataForPCA].impute_9 * -1.33140026781e-16 + [CenteredDataForPCA].impute_10 * -0.678231361435 + [CenteredDataForPCA].impute_11 * 7.6327832943e-17 + [CenteredDataForPCA].impute_12 * 1.15792792021e-16 + [CenteredDataForPCA].impute_13 * -7.65988834861e-17 + [CenteredDataForPCA].impute_14 * -9.36750677027e-17 + [CenteredDataForPCA].impute_15 * -3.37403716077e-16 + [CenteredDataForPCA].impute_16 * 6.93889390391e-18 + [CenteredDataForPCA].impute_17 * -1.53523027624e-16 + [CenteredDataForPCA].impute_18 * -1.03216046821e-16 + [CenteredDataForPCA].impute_19 * -0.321144015655 + [CenteredDataForPCA].impute_20 * -7.8062556419e-17 + [CenteredDataForPCA].impute_21 * -4.16333634234e-17 AS anoova_20, [CenteredDataForPCA].impute_2 * 0.133936740923 + [CenteredDataForPCA].impute_3 * 0.483868991938 + [CenteredDataForPCA].impute_4 * 0.179616746262 + [CenteredDataForPCA].impute_5 * 0.440455963683 + [CenteredDataForPCA].impute_6 * 6.24500451352e-17 + [CenteredDataForPCA].impute_7 * 4.85722573274e-17 + [CenteredDataForPCA].impute_8 * 1.73472347598e-16 + [CenteredDataForPCA].impute_9 * 3.03576608296e-17 + [CenteredDataForPCA].impute_10 * 0.241985766866 + [CenteredDataForPCA].impute_11 * 0.0 + [CenteredDataForPCA].impute_12 * -1.30104260698e-16 + [CenteredDataForPCA].impute_13 * 7.329206686e-17 + [CenteredDataForPCA].impute_14 * 1.38777878078e-17 + [CenteredDataForPCA].impute_15 * 4.85722573274e-17 + [CenteredDataForPCA].impute_16 * 0.0 + [CenteredDataForPCA].impute_17 * 1.90819582357e-16 + [CenteredDataForPCA].impute_18 * 9.71445146547e-17 + [CenteredDataForPCA].impute_19 * -0.680522597145 + [CenteredDataForPCA].impute_20 * -5.20417042793e-18 + [CenteredDataForPCA].impute_21 * -1.17961196366e-16 AS anoova_21 
FROM [CenteredDataForPCA]), 
linear_model_cte AS 
(SELECT [ADS_ano_2_OUT].[KEY] AS [KEY], -0.013076764331446047 * [ADS_ano_2_OUT].anoova_2 + -0.14499130060170584 * [ADS_ano_2_OUT].anoova_3 + -0.017435800735791453 * [ADS_ano_2_OUT].anoova_4 + 0.07919284720850703 * [ADS_ano_2_OUT].anoova_5 + 0.09779888102496598 * [ADS_ano_2_OUT].anoova_6 + -0.031096743644918184 * [ADS_ano_2_OUT].anoova_7 + -0.03070402157849787 * [ADS_ano_2_OUT].anoova_8 + -0.02706958652278824 * [ADS_ano_2_OUT].anoova_9 + 0.03372357263583388 * [ADS_ano_2_OUT].anoova_10 + -0.1927338865631955 * [ADS_ano_2_OUT].anoova_11 + 0.13371928516237402 * [ADS_ano_2_OUT].anoova_12 + 0.12824256414780022 * [ADS_ano_2_OUT].anoova_13 + -0.10866038460772665 * [ADS_ano_2_OUT].anoova_14 + -0.13393807955443668 * [ADS_ano_2_OUT].anoova_15 + -0.08925945664127286 * [ADS_ano_2_OUT].anoova_16 + -0.00947547240405976 * [ADS_ano_2_OUT].anoova_17 + 0.07241724358637404 * [ADS_ano_2_OUT].anoova_18 + 0.07604367885599643 * [ADS_ano_2_OUT].anoova_19 + -3.644337947137976e-15 * [ADS_ano_2_OUT].anoova_20 + 2.0952612518779316e-17 * [ADS_ano_2_OUT].anoova_21 + -0.5 AS [Score_0], 0.19843575955945342 * [ADS_ano_2_OUT].anoova_2 + 0.12378084523774843 * [ADS_ano_2_OUT].anoova_3 + -0.19206281015359739 * [ADS_ano_2_OUT].anoova_4 + 0.030016021188843778 * [ADS_ano_2_OUT].anoova_5 + -0.04249868957320445 * [ADS_ano_2_OUT].anoova_6 + 0.01665088755825234 * [ADS_ano_2_OUT].anoova_7 + -0.02638263183156349 * [ADS_ano_2_OUT].anoova_8 + 0.030020919904468524 * [ADS_ano_2_OUT].anoova_9 + -0.0829331420201719 * [ADS_ano_2_OUT].anoova_10 + 0.10205622481732701 * [ADS_ano_2_OUT].anoova_11 + 0.006725846552594591 * [ADS_ano_2_OUT].anoova_12 + 0.07731336794755964 * [ADS_ano_2_OUT].anoova_13 + -0.03951984783476283 * [ADS_ano_2_OUT].anoova_14 + -0.05182517194251613 * [ADS_ano_2_OUT].anoova_15 + 0.011286225109754048 * [ADS_ano_2_OUT].anoova_16 + -0.1358111094971131 * [ADS_ano_2_OUT].anoova_17 + 0.08052264269955006 * [ADS_ano_2_OUT].anoova_18 + 0.11541687485119417 * [ADS_ano_2_OUT].anoova_19 + 2.6112901304907573e-16 * [ADS_ano_2_OUT].anoova_20 + 3.5907911439938337e-16 * [ADS_ano_2_OUT].anoova_21 + -0.5 AS [Score_1], -0.13711797390580632 * [ADS_ano_2_OUT].anoova_2 + 0.25292102768070224 * [ADS_ano_2_OUT].anoova_3 + 0.1612074623857935 * [ADS_ano_2_OUT].anoova_4 + -0.044871445121885456 * [ADS_ano_2_OUT].anoova_5 + 0.03768696283939028 * [ADS_ano_2_OUT].anoova_6 + 0.0653344581156036 * [ADS_ano_2_OUT].anoova_7 + -0.026837515463971104 * [ADS_ano_2_OUT].anoova_8 + -0.07138243525179028 * [ADS_ano_2_OUT].anoova_9 + -0.014848748020247651 * [ADS_ano_2_OUT].anoova_10 + 0.039939792066343724 * [ADS_ano_2_OUT].anoova_11 + 0.038410415767882206 * [ADS_ano_2_OUT].anoova_12 + -0.08312241086547656 * [ADS_ano_2_OUT].anoova_13 + 0.08608996802514667 * [ADS_ano_2_OUT].anoova_14 + 0.07968671584301405 * [ADS_ano_2_OUT].anoova_15 + 0.11477297465163508 * [ADS_ano_2_OUT].anoova_16 + 0.14477092467258296 * [ADS_ano_2_OUT].anoova_17 + -0.04240630579921321 * [ADS_ano_2_OUT].anoova_18 + -0.11408698664816419 * [ADS_ano_2_OUT].anoova_19 + 1.5533054589715352e-15 * [ADS_ano_2_OUT].anoova_20 + -7.902656356744717e-18 * [ADS_ano_2_OUT].anoova_21 + -0.5 AS [Score_2], -0.048241021322200935 * [ADS_ano_2_OUT].anoova_2 + -0.23171057231674522 * [ADS_ano_2_OUT].anoova_3 + 0.04829114850359519 * [ADS_ano_2_OUT].anoova_4 + -0.0643374232754653 * [ADS_ano_2_OUT].anoova_5 + -0.09298715429115181 * [ADS_ano_2_OUT].anoova_6 + -0.05088860202893778 * [ADS_ano_2_OUT].anoova_7 + 0.08392416887403252 * [ADS_ano_2_OUT].anoova_8 + 0.06843110187010995 * [ADS_ano_2_OUT].anoova_9 + 0.06405831740458559 * [ADS_ano_2_OUT].anoova_10 + 0.050737869679524934 * [ADS_ano_2_OUT].anoova_11 + -0.17885554748285085 * [ADS_ano_2_OUT].anoova_12 + -0.12243352122988328 * [ADS_ano_2_OUT].anoova_13 + 0.062090264417342764 * [ADS_ano_2_OUT].anoova_14 + 0.1060765356539388 * [ADS_ano_2_OUT].anoova_15 + -0.03679974312011617 * [ADS_ano_2_OUT].anoova_16 + 0.0005156572285899683 * [ADS_ano_2_OUT].anoova_17 + -0.11053358048671097 * [ADS_ano_2_OUT].anoova_18 + -0.07737356705902641 * [ADS_ano_2_OUT].anoova_19 + 1.829903475117367e-15 * [ADS_ano_2_OUT].anoova_20 + -3.721290705614181e-16 * [ADS_ano_2_OUT].anoova_21 + -0.5 AS [Score_3] 
FROM [ADS_ano_2_OUT]), 
orig_cte AS 
(SELECT linear_model_cte.[KEY] AS [KEY], linear_model_cte.[Score_0] AS [Score_0], linear_model_cte.[Score_1] AS [Score_1], linear_model_cte.[Score_2] AS [Score_2], linear_model_cte.[Score_3] AS [Score_3], CAST(NULL AS FLOAT(53)) AS [Proba_0], CAST(NULL AS FLOAT(53)) AS [Proba_1], CAST(NULL AS FLOAT(53)) AS [Proba_2], CAST(NULL AS FLOAT(53)) AS [Proba_3], CAST(NULL AS FLOAT(53)) AS [LogProba_0], CAST(NULL AS FLOAT(53)) AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [LogProba_2], CAST(NULL AS FLOAT(53)) AS [LogProba_3], CAST(NULL AS FLOAT(53)) AS [Decision] 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu.[KEY] AS [KEY], scu.class AS class, scu.[LogProba] AS [LogProba], scu.[Proba] AS [Proba], scu.[Score] AS [Score] 
FROM (SELECT orig_cte.[KEY] AS [KEY], 0 AS class, orig_cte.[LogProba_0] AS [LogProba], orig_cte.[Proba_0] AS [Proba], orig_cte.[Score_0] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY], 1 AS class, orig_cte.[LogProba_1] AS [LogProba], orig_cte.[Proba_1] AS [Proba], orig_cte.[Score_1] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY], 2 AS class, orig_cte.[LogProba_2] AS [LogProba], orig_cte.[Proba_2] AS [Proba], orig_cte.[Score_2] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY], 3 AS class, orig_cte.[LogProba_3] AS [LogProba], orig_cte.[Proba_3] AS [Proba], orig_cte.[Score_3] AS [Score] 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.[KEY] AS [KEY], orig_cte.[Score_0] AS [Score_0], orig_cte.[Score_1] AS [Score_1], orig_cte.[Score_2] AS [Score_2], orig_cte.[Score_3] AS [Score_3], orig_cte.[Proba_0] AS [Proba_0], orig_cte.[Proba_1] AS [Proba_1], orig_cte.[Proba_2] AS [Proba_2], orig_cte.[Proba_3] AS [Proba_3], orig_cte.[LogProba_0] AS [LogProba_0], orig_cte.[LogProba_1] AS [LogProba_1], orig_cte.[LogProba_2] AS [LogProba_2], orig_cte.[LogProba_3] AS [LogProba_3], orig_cte.[Decision] AS [Decision], (SELECT max(score_class_union.[LogProba]) AS max_1 
FROM score_class_union 
WHERE orig_cte.[KEY] = score_class_union.[KEY]) AS [max_LogProba], (SELECT max(score_class_union.[Proba]) AS max_2 
FROM score_class_union 
WHERE orig_cte.[KEY] = score_class_union.[KEY]) AS [max_Proba], (SELECT max(score_class_union.[Score]) AS max_3 
FROM score_class_union 
WHERE orig_cte.[KEY] = score_class_union.[KEY]) AS [max_Score] 
FROM orig_cte), 
arg_max_cte AS 
(SELECT score_max.[KEY] AS [KEY], score_max.[Score_0] AS [Score_0], score_max.[Score_1] AS [Score_1], score_max.[Score_2] AS [Score_2], score_max.[Score_3] AS [Score_3], score_max.[Proba_0] AS [Proba_0], score_max.[Proba_1] AS [Proba_1], score_max.[Proba_2] AS [Proba_2], score_max.[Proba_3] AS [Proba_3], score_max.[LogProba_0] AS [LogProba_0], score_max.[LogProba_1] AS [LogProba_1], score_max.[LogProba_2] AS [LogProba_2], score_max.[LogProba_3] AS [LogProba_3], score_max.[Decision] AS [Decision], score_max.[max_LogProba] AS [max_LogProba], score_max.[max_Proba] AS [max_Proba], score_max.[max_Score] AS [max_Score], (SELECT min(score_class_union.class) AS min_1 
FROM score_class_union 
WHERE score_max.[max_LogProba] = score_class_union.[LogProba] AND score_max.[KEY] = score_class_union.[KEY]) AS [arg_max_LogProba], (SELECT min(score_class_union.class) AS min_2 
FROM score_class_union 
WHERE score_max.[max_Proba] = score_class_union.[Proba] AND score_max.[KEY] = score_class_union.[KEY]) AS [arg_max_Proba], (SELECT min(score_class_union.class) AS min_3 
FROM score_class_union 
WHERE score_max.[max_Score] = score_class_union.[Score] AND score_max.[KEY] = score_class_union.[KEY]) AS [arg_max_Score] 
FROM score_max)
 SELECT arg_max_cte.[KEY] AS [KEY], arg_max_cte.[Score_0] AS [Score_0], arg_max_cte.[Score_1] AS [Score_1], arg_max_cte.[Score_2] AS [Score_2], arg_max_cte.[Score_3] AS [Score_3], arg_max_cte.[Proba_0] AS [Proba_0], arg_max_cte.[Proba_1] AS [Proba_1], arg_max_cte.[Proba_2] AS [Proba_2], arg_max_cte.[Proba_3] AS [Proba_3], CASE WHEN (arg_max_cte.[Proba_0] IS NULL OR arg_max_cte.[Proba_0] > 0.0) THEN log(arg_max_cte.[Proba_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CASE WHEN (arg_max_cte.[Proba_1] IS NULL OR arg_max_cte.[Proba_1] > 0.0) THEN log(arg_max_cte.[Proba_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], CASE WHEN (arg_max_cte.[Proba_2] IS NULL OR arg_max_cte.[Proba_2] > 0.0) THEN log(arg_max_cte.[Proba_2]) ELSE -1.79769313486231e+308 END AS [LogProba_2], CASE WHEN (arg_max_cte.[Proba_3] IS NULL OR arg_max_cte.[Proba_3] > 0.0) THEN log(arg_max_cte.[Proba_3]) ELSE -1.79769313486231e+308 END AS [LogProba_3], arg_max_cte.[arg_max_Score] AS [Decision] 
FROM arg_max_cte