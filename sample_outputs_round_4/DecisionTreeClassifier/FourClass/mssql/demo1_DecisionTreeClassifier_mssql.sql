-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH [DT_node_lookup] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_10] <= 0.36881667375564575) THEN CASE WHEN ([ADS].[Feature_17] <= -0.6889515519142151) THEN 2 ELSE CASE WHEN ([ADS].[Feature_5] <= 0.1169239953160286) THEN 4 ELSE 5 END END ELSE CASE WHEN ([ADS].[Feature_7] <= -1.3425401449203491) THEN 7 ELSE 8 END END AS node_id_2 
FROM [INPUT_DATA] AS [ADS]), 
[DT_node_data] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].parent_id AS parent_id, [Values].[Proba_0] AS [Proba_0], [Values].[LogProba_0] AS [LogProba_0], [Values].[Proba_1] AS [Proba_1], [Values].[LogProba_1] AS [LogProba_1], [Values].[Proba_2] AS [Proba_2], [Values].[LogProba_2] AS [LogProba_2], [Values].[Proba_3] AS [Proba_3], [Values].[LogProba_3] AS [LogProba_3], [Values].[Decision] AS [Decision] 
FROM (SELECT 0 AS node_id, 'Feature_10' AS feature, 0.36881667375564575 AS threshold, 100 AS count, 0 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.26 AS [Proba_0], -1.34707364797 AS [LogProba_0], 0.24 AS [Proba_1], -1.42711635564 AS [LogProba_1], 0.25 AS [Proba_2], -1.38629436112 AS [LogProba_2], 0.25 AS [Proba_3], -1.38629436112 AS [LogProba_3], 0 AS [Decision] UNION ALL SELECT 1 AS node_id, 'Feature_17' AS feature, -0.6889515519142151 AS threshold, 53 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.32075471698113206 AS [Proba_0], -1.1370785695 AS [LogProba_0], 0.4528301886792453 AS [Proba_1], -0.792238083204 AS [LogProba_1], 0.05660377358490566 AS [Proba_2], -2.87167962488 AS [LogProba_2], 0.16981132075471697 AS [Proba_3], -1.77306733622 AS [LogProba_3], 1 AS [Decision] UNION ALL SELECT 2 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 21 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.38095238095238093 AS [Proba_0], -0.965080896044 AS [LogProba_0], 0.047619047619047616 AS [Proba_1], -3.04452243772 AS [LogProba_1], 0.14285714285714285 AS [Proba_2], -1.94591014906 AS [LogProba_2], 0.42857142857142855 AS [Proba_3], -0.847297860387 AS [LogProba_3], 3 AS [Decision] UNION ALL SELECT 3 AS node_id, 'Feature_5' AS feature, 0.1169239953160286 AS threshold, 32 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.28125 AS [Proba_0], -1.26851132546 AS [LogProba_0], 0.71875 AS [Proba_1], -0.330241686871 AS [LogProba_1], 0.0 AS [Proba_2], -1.79769313486231e+308 AS [LogProba_2], 0.0 AS [Proba_3], -1.79769313486231e+308 AS [LogProba_3], 1 AS [Decision] UNION ALL SELECT 4 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 15 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.4666666666666667 AS [Proba_0], -0.762140052047 AS [LogProba_0], 0.5333333333333333 AS [Proba_1], -0.628608659422 AS [LogProba_1], 0.0 AS [Proba_2], -1.79769313486231e+308 AS [LogProba_2], 0.0 AS [Proba_3], -1.79769313486231e+308 AS [LogProba_3], 1 AS [Decision] UNION ALL SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 17 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.11764705882352941 AS [Proba_0], -2.1400661635 AS [LogProba_0], 0.8823529411764706 AS [Proba_1], -0.125163142954 AS [LogProba_1], 0.0 AS [Proba_2], -1.79769313486231e+308 AS [LogProba_2], 0.0 AS [Proba_3], -1.79769313486231e+308 AS [LogProba_3], 1 AS [Decision] UNION ALL SELECT 6 AS node_id, 'Feature_7' AS feature, -1.3425401449203491 AS threshold, 47 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.19148936170212766 AS [Proba_0], -1.65292302437 AS [LogProba_0], 0.0 AS [Proba_1], -1.79769313486231e+308 AS [LogProba_1], 0.46808510638297873 AS [Proba_2], -0.759105148352 AS [LogProba_2], 0.3404255319148936 AS [Proba_3], -1.07755887947 AS [LogProba_3], 2 AS [Decision] UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 25 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.24 AS [Proba_0], -1.42711635564 AS [LogProba_0], 0.0 AS [Proba_1], -1.79769313486231e+308 AS [LogProba_1], 0.2 AS [Proba_2], -1.60943791243 AS [LogProba_2], 0.56 AS [Proba_3], -0.579818495253 AS [LogProba_3], 3 AS [Decision] UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 22 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.13636363636363635 AS [Proba_0], -1.99243016469 AS [LogProba_0], 0.0 AS [Proba_1], -1.79769313486231e+308 AS [LogProba_1], 0.7727272727272727 AS [Proba_2], -0.257829109302 AS [LogProba_2], 0.09090909090909091 AS [Proba_3], -2.3978952728 AS [LogProba_3], 2 AS [Decision]) AS [Values]), 
[DT_Output] AS 
(SELECT [DT_node_lookup].[KEY] AS [KEY], [DT_node_lookup].node_id_2 AS node_id_2, [DT_node_data].node_id AS node_id, [DT_node_data].feature AS feature, [DT_node_data].threshold AS threshold, [DT_node_data].count AS count, [DT_node_data].depth AS depth, [DT_node_data].parent_id AS parent_id, [DT_node_data].[Proba_0] AS [Proba_0], [DT_node_data].[LogProba_0] AS [LogProba_0], [DT_node_data].[Proba_1] AS [Proba_1], [DT_node_data].[LogProba_1] AS [LogProba_1], [DT_node_data].[Proba_2] AS [Proba_2], [DT_node_data].[LogProba_2] AS [LogProba_2], [DT_node_data].[Proba_3] AS [Proba_3], [DT_node_data].[LogProba_3] AS [LogProba_3], [DT_node_data].[Decision] AS [Decision] 
FROM [DT_node_lookup] LEFT OUTER JOIN [DT_node_data] ON [DT_node_lookup].node_id_2 = [DT_node_data].node_id)
 SELECT [DT_Output].[KEY] AS [KEY], CAST(NULL AS FLOAT) AS [Score_0], CAST(NULL AS FLOAT) AS [Score_1], CAST(NULL AS FLOAT) AS [Score_2], CAST(NULL AS FLOAT) AS [Score_3], [DT_Output].[Proba_0] AS [Proba_0], [DT_Output].[Proba_1] AS [Proba_1], [DT_Output].[Proba_2] AS [Proba_2], [DT_Output].[Proba_3] AS [Proba_3], [DT_Output].[LogProba_0] AS [LogProba_0], [DT_Output].[LogProba_1] AS [LogProba_1], [DT_Output].[LogProba_2] AS [LogProba_2], [DT_Output].[LogProba_3] AS [LogProba_3], [DT_Output].[Decision] AS [Decision] 
FROM [DT_Output]