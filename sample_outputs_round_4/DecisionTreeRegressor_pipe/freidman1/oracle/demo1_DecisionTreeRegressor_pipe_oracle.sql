-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "ADS_imp_1_OUT" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 0.486947495919 ELSE "ADS"."Feature_0" END AS impute_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 0.48853624078 ELSE "ADS"."Feature_1" END AS impute_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 0.430119505596 ELSE "ADS"."Feature_2" END AS impute_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 0.482479961472 ELSE "ADS"."Feature_3" END AS impute_5, CASE WHEN ("ADS"."Feature_4" IS NULL) THEN 0.476411109005 ELSE "ADS"."Feature_4" END AS impute_6, CASE WHEN ("ADS"."Feature_5" IS NULL) THEN 0.511587654012 ELSE "ADS"."Feature_5" END AS impute_7, CASE WHEN ("ADS"."Feature_6" IS NULL) THEN 0.532158551694 ELSE "ADS"."Feature_6" END AS impute_8, CASE WHEN ("ADS"."Feature_7" IS NULL) THEN 0.47928414854 ELSE "ADS"."Feature_7" END AS impute_9, CASE WHEN ("ADS"."Feature_8" IS NULL) THEN 0.485665671136 ELSE "ADS"."Feature_8" END AS impute_10, CASE WHEN ("ADS"."Feature_9" IS NULL) THEN 0.543493809821 ELSE "ADS"."Feature_9" END AS impute_11 
FROM "INPUT_DATA" "ADS"), 
"CenteredDataForPCA" AS 
(SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", "ADS_imp_1_OUT".impute_2 - 0.486947495919 AS impute_2, "ADS_imp_1_OUT".impute_3 - 0.48853624078 AS impute_3, "ADS_imp_1_OUT".impute_4 - 0.430119505596 AS impute_4, "ADS_imp_1_OUT".impute_5 - 0.482479961472 AS impute_5, "ADS_imp_1_OUT".impute_6 - 0.476411109005 AS impute_6, "ADS_imp_1_OUT".impute_7 - 0.511587654012 AS impute_7, "ADS_imp_1_OUT".impute_8 - 0.532158551694 AS impute_8, "ADS_imp_1_OUT".impute_9 - 0.47928414854 AS impute_9, "ADS_imp_1_OUT".impute_10 - 0.485665671136 AS impute_10, "ADS_imp_1_OUT".impute_11 - 0.543493809821 AS impute_11 
FROM "ADS_imp_1_OUT"), 
"ADS_ano_2_OUT" AS 
(SELECT "CenteredDataForPCA"."KEY" AS "KEY", "CenteredDataForPCA".impute_2 * -0.288891063878 + "CenteredDataForPCA".impute_3 * 0.469321359432 + "CenteredDataForPCA".impute_4 * -0.00269029311075 + "CenteredDataForPCA".impute_5 * 0.403379453257 + "CenteredDataForPCA".impute_6 * 0.181917602931 + "CenteredDataForPCA".impute_7 * 0.0501339282943 + "CenteredDataForPCA".impute_8 * -0.424458369165 + "CenteredDataForPCA".impute_9 * 0.221676390405 + "CenteredDataForPCA".impute_10 * -0.370555392542 + "CenteredDataForPCA".impute_11 * 0.362399145451 AS anoova_2, "CenteredDataForPCA".impute_2 * -0.18366643294 + "CenteredDataForPCA".impute_3 * 0.250663759711 + "CenteredDataForPCA".impute_4 * -0.352441113271 + "CenteredDataForPCA".impute_5 * -0.130008951684 + "CenteredDataForPCA".impute_6 * 0.0188252201595 + "CenteredDataForPCA".impute_7 * -0.60384637925 + "CenteredDataForPCA".impute_8 * -0.29748832857 + "CenteredDataForPCA".impute_9 * -0.017939405778 + "CenteredDataForPCA".impute_10 * 0.554877509165 + "CenteredDataForPCA".impute_11 * -0.0249447067975 AS anoova_3, "CenteredDataForPCA".impute_2 * -0.400315163559 + "CenteredDataForPCA".impute_3 * 0.364802240226 + "CenteredDataForPCA".impute_4 * -0.401062196002 + "CenteredDataForPCA".impute_5 * -0.188878268043 + "CenteredDataForPCA".impute_6 * -0.451256119208 + "CenteredDataForPCA".impute_7 * 0.0983906003689 + "CenteredDataForPCA".impute_8 * 0.335284054718 + "CenteredDataForPCA".impute_9 * 0.0113056417476 + "CenteredDataForPCA".impute_10 * -0.307271595658 + "CenteredDataForPCA".impute_11 * -0.299782198279 AS anoova_4, "CenteredDataForPCA".impute_2 * 0.271832901062 + "CenteredDataForPCA".impute_3 * 0.41558055742 + "CenteredDataForPCA".impute_4 * 0.164612891229 + "CenteredDataForPCA".impute_5 * 0.428180200254 + "CenteredDataForPCA".impute_6 * 0.0908990720038 + "CenteredDataForPCA".impute_7 * 0.112354358204 + "CenteredDataForPCA".impute_8 * 0.154796593457 + "CenteredDataForPCA".impute_9 * 0.306503960503 + "CenteredDataForPCA".impute_10 * 0.29386461569 + "CenteredDataForPCA".impute_11 * -0.563750625493 AS anoova_5, "CenteredDataForPCA".impute_2 * 0.152147912587 + "CenteredDataForPCA".impute_3 * -0.348240350982 + "CenteredDataForPCA".impute_4 * -0.539546364655 + "CenteredDataForPCA".impute_5 * 0.264363223379 + "CenteredDataForPCA".impute_6 * -0.0859621592164 + "CenteredDataForPCA".impute_7 * -0.0206681390546 + "CenteredDataForPCA".impute_8 * 0.21781500451 + "CenteredDataForPCA".impute_9 * 0.606906318505 + "CenteredDataForPCA".impute_10 * 0.0554542655562 + "CenteredDataForPCA".impute_11 * 0.26059735449 AS anoova_6, "CenteredDataForPCA".impute_2 * -0.549028873865 + "CenteredDataForPCA".impute_3 * -0.304292515846 + "CenteredDataForPCA".impute_4 * -0.00784644343684 + "CenteredDataForPCA".impute_5 * 0.461116847995 + "CenteredDataForPCA".impute_6 * -0.176859227873 + "CenteredDataForPCA".impute_7 * 0.359312599614 + "CenteredDataForPCA".impute_8 * -0.0774812078551 + "CenteredDataForPCA".impute_9 * -0.248095631954 + "CenteredDataForPCA".impute_10 * 0.404298198987 + "CenteredDataForPCA".impute_11 * -0.0434338771913 AS anoova_7, "CenteredDataForPCA".impute_2 * -0.389558735781 + "CenteredDataForPCA".impute_3 * -0.203543329691 + "CenteredDataForPCA".impute_4 * 0.0800619776403 + "CenteredDataForPCA".impute_5 * -0.444127475491 + "CenteredDataForPCA".impute_6 * 0.381670704119 + "CenteredDataForPCA".impute_7 * 0.227266319435 + "CenteredDataForPCA".impute_8 * -0.214619923093 + "CenteredDataForPCA".impute_9 * 0.51368187542 + "CenteredDataForPCA".impute_10 * 0.0318663537946 + "CenteredDataForPCA".impute_11 * -0.308036066404 AS anoova_8, "CenteredDataForPCA".impute_2 * -0.27087511538 + "CenteredDataForPCA".impute_3 * 0.178515447768 + "CenteredDataForPCA".impute_4 * 0.0151337029045 + "CenteredDataForPCA".impute_5 * -0.00826537170663 + "CenteredDataForPCA".impute_6 * 0.571300468779 + "CenteredDataForPCA".impute_7 * -0.0350569742399 + "CenteredDataForPCA".impute_8 * 0.671218819851 + "CenteredDataForPCA".impute_9 * -0.110308677238 + "CenteredDataForPCA".impute_10 * 0.149003649133 + "CenteredDataForPCA".impute_11 * 0.28625783574 AS anoova_9, "CenteredDataForPCA".impute_2 * -0.127569362403 + "CenteredDataForPCA".impute_3 * 0.160344553006 + "CenteredDataForPCA".impute_4 * 0.543628006784 + "CenteredDataForPCA".impute_5 * -0.184035708125 + "CenteredDataForPCA".impute_6 * -0.493268784998 + "CenteredDataForPCA".impute_7 * -0.0309213483228 + "CenteredDataForPCA".impute_8 * 0.147392932797 + "CenteredDataForPCA".impute_9 * 0.375108188103 + "CenteredDataForPCA".impute_10 * 0.278819023931 + "CenteredDataForPCA".impute_11 * 0.379702553206 AS anoova_10, "CenteredDataForPCA".impute_2 * 0.287538289148 + "CenteredDataForPCA".impute_3 * 0.313438928477 + "CenteredDataForPCA".impute_4 * -0.307388239373 + "CenteredDataForPCA".impute_5 * -0.296084567383 + "CenteredDataForPCA".impute_6 * 0.0248464253203 + "CenteredDataForPCA".impute_7 * 0.653593229818 + "CenteredDataForPCA".impute_8 * -0.152284597409 + "CenteredDataForPCA".impute_9 * -0.0991731419845 + "CenteredDataForPCA".impute_10 * 0.326400973789 + "CenteredDataForPCA".impute_11 * 0.263740797633 AS anoova_11 
FROM "CenteredDataForPCA"), 
"DT_node_lookup" AS 
(SELECT "ADS_ano_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_ano_2_OUT".anoova_5 <= -0.2698165774345398) THEN 1 ELSE CASE WHEN ("ADS_ano_2_OUT".anoova_2 <= -0.09103690832853317) THEN CASE WHEN ("ADS_ano_2_OUT".anoova_8 <= -0.044414132833480835) THEN 4 ELSE 5 END ELSE CASE WHEN ("ADS_ano_2_OUT".anoova_8 <= -0.02208396978676319) THEN 7 ELSE 8 END END END AS node_id_2 
FROM "ADS_ano_2_OUT"), 
"DT_node_data" AS 
(SELECT "Values".node_id AS node_id, "Values".feature AS feature, "Values".threshold AS threshold, "Values".count AS count, "Values".depth AS depth, "Values".parent_id AS parent_id, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 0 AS node_id, 'anoova_5' AS feature, -0.2698165774345398 AS threshold, 100 AS count, 0 AS depth, CAST(NULL AS INTEGER) AS parent_id, 13.930542091976623 AS "Estimator" FROM DUAL UNION ALL SELECT 1 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 18 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 8.337035407858332 AS "Estimator" FROM DUAL UNION ALL SELECT 2 AS node_id, 'anoova_2' AS feature, -0.09103690832853317 AS threshold, 82 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 15.158385022636736 AS "Estimator" FROM DUAL UNION ALL SELECT 3 AS node_id, 'anoova_8' AS feature, -0.044414132833480835 AS threshold, 31 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 12.289197293132375 AS "Estimator" FROM DUAL UNION ALL SELECT 4 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 15 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 14.360140470605478 AS "Estimator" FROM DUAL UNION ALL SELECT 5 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 16 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 10.34768806425134 AS "Estimator" FROM DUAL UNION ALL SELECT 6 AS node_id, 'anoova_8' AS feature, -0.02208396978676319 AS threshold, 51 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 16.902401093511934 AS "Estimator" FROM DUAL UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 26 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 18.776298087075524 AS "Estimator" FROM DUAL UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 25 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 14.95354822020579 AS "Estimator" FROM DUAL) "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".node_id AS node_id, "DT_node_data".feature AS feature, "DT_node_data".threshold AS threshold, "DT_node_data".count AS count, "DT_node_data".depth AS depth, "DT_node_data".parent_id AS parent_id, "DT_node_data"."Estimator" AS "Estimator" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".node_id)
 SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."Estimator" AS "Estimator" 
FROM "DT_Output"