-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH [ADS_imp_1_OUT] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_0] IS NULL) THEN 0.497451657362 ELSE [ADS].[Feature_0] END AS impute_2, CASE WHEN ([ADS].[Feature_1] IS NULL) THEN 0.52811448931 ELSE [ADS].[Feature_1] END AS impute_3, CASE WHEN ([ADS].[Feature_2] IS NULL) THEN 0.554859414853 ELSE [ADS].[Feature_2] END AS impute_4, CASE WHEN ([ADS].[Feature_3] IS NULL) THEN 0.516463835863 ELSE [ADS].[Feature_3] END AS impute_5, CASE WHEN ([ADS].[Feature_4] IS NULL) THEN 0.507165598066 ELSE [ADS].[Feature_4] END AS impute_6, CASE WHEN ([ADS].[Feature_5] IS NULL) THEN 0.45991304225 ELSE [ADS].[Feature_5] END AS impute_7, CASE WHEN ([ADS].[Feature_6] IS NULL) THEN 0.541107244165 ELSE [ADS].[Feature_6] END AS impute_8, CASE WHEN ([ADS].[Feature_7] IS NULL) THEN 0.509197986711 ELSE [ADS].[Feature_7] END AS impute_9, CASE WHEN ([ADS].[Feature_8] IS NULL) THEN 0.488919186948 ELSE [ADS].[Feature_8] END AS impute_10, CASE WHEN ([ADS].[Feature_9] IS NULL) THEN 0.515685185505 ELSE [ADS].[Feature_9] END AS impute_11 
FROM [INPUT_DATA] AS [ADS]), 
[CenteredDataForPCA] AS 
(SELECT [ADS_imp_1_OUT].[KEY] AS [KEY], [ADS_imp_1_OUT].impute_2 - 0.497451657362 AS impute_2, [ADS_imp_1_OUT].impute_3 - 0.52811448931 AS impute_3, [ADS_imp_1_OUT].impute_4 - 0.554859414853 AS impute_4, [ADS_imp_1_OUT].impute_5 - 0.516463835863 AS impute_5, [ADS_imp_1_OUT].impute_6 - 0.507165598066 AS impute_6, [ADS_imp_1_OUT].impute_7 - 0.45991304225 AS impute_7, [ADS_imp_1_OUT].impute_8 - 0.541107244165 AS impute_8, [ADS_imp_1_OUT].impute_9 - 0.509197986711 AS impute_9, [ADS_imp_1_OUT].impute_10 - 0.488919186948 AS impute_10, [ADS_imp_1_OUT].impute_11 - 0.515685185505 AS impute_11 
FROM [ADS_imp_1_OUT]), 
[ADS_ano_2_OUT] AS 
(SELECT [CenteredDataForPCA].[KEY] AS [KEY], [CenteredDataForPCA].impute_2 * -0.418327849464 + [CenteredDataForPCA].impute_3 * 0.563265620299 + [CenteredDataForPCA].impute_4 * 0.129741227436 + [CenteredDataForPCA].impute_5 * -0.252270794497 + [CenteredDataForPCA].impute_6 * 0.607579647369 + [CenteredDataForPCA].impute_7 * 0.105751444295 + [CenteredDataForPCA].impute_8 * -0.0786984918999 + [CenteredDataForPCA].impute_9 * -0.159353984947 + [CenteredDataForPCA].impute_10 * 0.115424211265 + [CenteredDataForPCA].impute_11 * 0.0448778557916 AS anoova_2, [CenteredDataForPCA].impute_2 * -0.363332366402 + [CenteredDataForPCA].impute_3 * -0.271237146296 + [CenteredDataForPCA].impute_4 * 0.0385958846602 + [CenteredDataForPCA].impute_5 * -0.460347454102 + [CenteredDataForPCA].impute_6 * 0.0454005953048 + [CenteredDataForPCA].impute_7 * -0.402892084611 + [CenteredDataForPCA].impute_8 * -0.0249477757833 + [CenteredDataForPCA].impute_9 * 0.257587714794 + [CenteredDataForPCA].impute_10 * -0.589890825126 + [CenteredDataForPCA].impute_11 * 0.041016184492 AS anoova_3, [CenteredDataForPCA].impute_2 * -0.100874324039 + [CenteredDataForPCA].impute_3 * -0.373208327778 + [CenteredDataForPCA].impute_4 * 0.432447775485 + [CenteredDataForPCA].impute_5 * -0.0713685833915 + [CenteredDataForPCA].impute_6 * -0.0562699914611 + [CenteredDataForPCA].impute_7 * 0.101479720765 + [CenteredDataForPCA].impute_8 * -0.564845081402 + [CenteredDataForPCA].impute_9 * -0.143616335996 + [CenteredDataForPCA].impute_10 * 0.239870783365 + [CenteredDataForPCA].impute_11 * 0.497752252916 AS anoova_4, [CenteredDataForPCA].impute_2 * 0.233616548293 + [CenteredDataForPCA].impute_3 * 0.0908129405144 + [CenteredDataForPCA].impute_4 * 0.729573786932 + [CenteredDataForPCA].impute_5 * 0.321062024502 + [CenteredDataForPCA].impute_6 * 0.223773912412 + [CenteredDataForPCA].impute_7 * -0.273666257148 + [CenteredDataForPCA].impute_8 * 0.0339479031242 + [CenteredDataForPCA].impute_9 * 0.347919439147 + [CenteredDataForPCA].impute_10 * -0.0497253823817 + [CenteredDataForPCA].impute_11 * -0.228421955927 AS anoova_5, [CenteredDataForPCA].impute_2 * 0.410905732842 + [CenteredDataForPCA].impute_3 * -0.0260346164268 + [CenteredDataForPCA].impute_4 * -0.122035318764 + [CenteredDataForPCA].impute_5 * 0.0630652371475 + [CenteredDataForPCA].impute_6 * 0.339263609404 + [CenteredDataForPCA].impute_7 * -0.524528643084 + [CenteredDataForPCA].impute_8 * 0.167567750184 + [CenteredDataForPCA].impute_9 * -0.451029899061 + [CenteredDataForPCA].impute_10 * -0.0883270230454 + [CenteredDataForPCA].impute_11 * 0.426696796887 AS anoova_6, [CenteredDataForPCA].impute_2 * -0.495665955153 + [CenteredDataForPCA].impute_3 * 0.261364875169 + [CenteredDataForPCA].impute_4 * 0.146277014195 + [CenteredDataForPCA].impute_5 * 0.420977081982 + [CenteredDataForPCA].impute_6 * -0.463430853916 + [CenteredDataForPCA].impute_7 * -0.313945721139 + [CenteredDataForPCA].impute_8 * 0.0141650374218 + [CenteredDataForPCA].impute_9 * -0.3966132894 + [CenteredDataForPCA].impute_10 * -0.128592530421 + [CenteredDataForPCA].impute_11 * 0.00401669227744 AS anoova_7, [CenteredDataForPCA].impute_2 * -0.0868355173615 + [CenteredDataForPCA].impute_3 * -0.0998660690196 + [CenteredDataForPCA].impute_4 * 0.343337392602 + [CenteredDataForPCA].impute_5 * -0.0422210971167 + [CenteredDataForPCA].impute_6 * -0.0541181054025 + [CenteredDataForPCA].impute_7 * 0.434908053612 + [CenteredDataForPCA].impute_8 * 0.703004213893 + [CenteredDataForPCA].impute_9 * -0.0691332008297 + [CenteredDataForPCA].impute_10 * -0.180363320407 + [CenteredDataForPCA].impute_11 * 0.373127510374 AS anoova_8, [CenteredDataForPCA].impute_2 * 0.409055085934 + [CenteredDataForPCA].impute_3 * 0.243831376522 + [CenteredDataForPCA].impute_4 * 0.279393424162 + [CenteredDataForPCA].impute_5 * -0.436901607436 + [CenteredDataForPCA].impute_6 * -0.266470359785 + [CenteredDataForPCA].impute_7 * 0.164163150293 + [CenteredDataForPCA].impute_8 * -0.18325004985 + [CenteredDataForPCA].impute_9 * -0.43002589305 + [CenteredDataForPCA].impute_10 * -0.336481488655 + [CenteredDataForPCA].impute_11 * -0.273126092165 AS anoova_9, [CenteredDataForPCA].impute_2 * -0.127767232329 + [CenteredDataForPCA].impute_3 * -0.44333628175 + [CenteredDataForPCA].impute_4 * -0.039417618087 + [CenteredDataForPCA].impute_5 * 0.36549189951 + [CenteredDataForPCA].impute_6 * 0.414378995207 + [CenteredDataForPCA].impute_7 * 0.28780146444 + [CenteredDataForPCA].impute_8 * -0.119948622179 + [CenteredDataForPCA].impute_9 * -0.36570126666 + [CenteredDataForPCA].impute_10 * -0.349359025784 + [CenteredDataForPCA].impute_11 * -0.356754742794 AS anoova_10, [CenteredDataForPCA].impute_2 * -0.15006626723 + [CenteredDataForPCA].impute_3 * -0.355903604242 + [CenteredDataForPCA].impute_4 * 0.169127169149 + [CenteredDataForPCA].impute_5 * -0.329873426564 + [CenteredDataForPCA].impute_6 * -0.00561743373231 + [CenteredDataForPCA].impute_7 * -0.262081657082 + [CenteredDataForPCA].impute_8 * 0.320185810233 + [CenteredDataForPCA].impute_9 * -0.287075134426 + [CenteredDataForPCA].impute_10 * 0.535308611166 + [CenteredDataForPCA].impute_11 * -0.416158043802 AS anoova_11 
FROM [CenteredDataForPCA]), 
[DT_node_lookup] AS 
(SELECT [ADS_ano_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_ano_2_OUT].anoova_6 <= 0.08573109723612338) THEN CASE WHEN ([ADS_ano_2_OUT].anoova_11 <= -0.07142892170485465) THEN 2 ELSE 3 END ELSE CASE WHEN ([ADS_ano_2_OUT].anoova_5 <= 0.040389674806575404) THEN 5 ELSE 6 END END AS node_id_2 
FROM [ADS_ano_2_OUT]), 
[DT_node_data] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].parent_id AS parent_id, [Values].[Estimator] AS [Estimator] 
FROM (SELECT 0 AS node_id, 'anoova_6' AS feature, 0.08573109723612338 AS threshold, 100 AS count, 0 AS depth, CAST(NULL AS INTEGER) AS parent_id, 14.760277842446829 AS [Estimator] UNION ALL SELECT 1 AS node_id, 'anoova_11' AS feature, -0.07142892170485465 AS threshold, 61 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 13.542977269519687 AS [Estimator] UNION ALL SELECT 2 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 24 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 14.962438412765442 AS [Estimator] UNION ALL SELECT 3 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 37 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 12.622245717144056 AS [Estimator] UNION ALL SELECT 4 AS node_id, 'anoova_5' AS feature, 0.040389674806575404 AS threshold, 39 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 16.66426078984569 AS [Estimator] UNION ALL SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 23 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 14.278292112948943 AS [Estimator] UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 16 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 20.094090762884775 AS [Estimator]) AS [Values]), 
[DT_Output] AS 
(SELECT [DT_node_lookup].[KEY] AS [KEY], [DT_node_lookup].node_id_2 AS node_id_2, [DT_node_data].node_id AS node_id, [DT_node_data].feature AS feature, [DT_node_data].threshold AS threshold, [DT_node_data].count AS count, [DT_node_data].depth AS depth, [DT_node_data].parent_id AS parent_id, [DT_node_data].[Estimator] AS [Estimator] 
FROM [DT_node_lookup] LEFT OUTER JOIN [DT_node_data] ON [DT_node_lookup].node_id_2 = [DT_node_data].node_id)
 SELECT [DT_Output].[KEY] AS [KEY], [DT_Output].[Estimator] AS [Estimator] 
FROM [DT_Output]