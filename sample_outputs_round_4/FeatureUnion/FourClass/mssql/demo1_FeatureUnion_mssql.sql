-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH [imp1_CTE] AS 
(SELECT [ADS].[KEY] AS join_key_0, CASE WHEN ([ADS].[Feature_0] IS NULL) THEN 0.156845906442 ELSE [ADS].[Feature_0] END AS imp1_output_1, CASE WHEN ([ADS].[Feature_1] IS NULL) THEN -0.138435034098 ELSE [ADS].[Feature_1] END AS imp1_output_2, CASE WHEN ([ADS].[Feature_2] IS NULL) THEN -0.214135465148 ELSE [ADS].[Feature_2] END AS imp1_output_3, CASE WHEN ([ADS].[Feature_3] IS NULL) THEN 0.117365383105 ELSE [ADS].[Feature_3] END AS imp1_output_4, CASE WHEN ([ADS].[Feature_4] IS NULL) THEN 0.147034409984 ELSE [ADS].[Feature_4] END AS imp1_output_5, CASE WHEN ([ADS].[Feature_5] IS NULL) THEN 0.0369841572337 ELSE [ADS].[Feature_5] END AS imp1_output_6, CASE WHEN ([ADS].[Feature_6] IS NULL) THEN 0.0559388047862 ELSE [ADS].[Feature_6] END AS imp1_output_7, CASE WHEN ([ADS].[Feature_7] IS NULL) THEN 0.0955585702569 ELSE [ADS].[Feature_7] END AS imp1_output_8, CASE WHEN ([ADS].[Feature_8] IS NULL) THEN -0.159122666805 ELSE [ADS].[Feature_8] END AS imp1_output_9, CASE WHEN ([ADS].[Feature_9] IS NULL) THEN -0.541123068208 ELSE [ADS].[Feature_9] END AS imp1_output_10, CASE WHEN ([ADS].[Feature_10] IS NULL) THEN -0.122742590879 ELSE [ADS].[Feature_10] END AS imp1_output_11, CASE WHEN ([ADS].[Feature_11] IS NULL) THEN -0.0725725542333 ELSE [ADS].[Feature_11] END AS imp1_output_12, CASE WHEN ([ADS].[Feature_12] IS NULL) THEN 0.00156119597314 ELSE [ADS].[Feature_12] END AS imp1_output_13, CASE WHEN ([ADS].[Feature_13] IS NULL) THEN -0.0766910454588 ELSE [ADS].[Feature_13] END AS imp1_output_14, CASE WHEN ([ADS].[Feature_14] IS NULL) THEN -0.0365257330962 ELSE [ADS].[Feature_14] END AS imp1_output_15, CASE WHEN ([ADS].[Feature_15] IS NULL) THEN 0.112764533664 ELSE [ADS].[Feature_15] END AS imp1_output_16, CASE WHEN ([ADS].[Feature_16] IS NULL) THEN -0.136574550875 ELSE [ADS].[Feature_16] END AS imp1_output_17, CASE WHEN ([ADS].[Feature_17] IS NULL) THEN -0.0347265910754 ELSE [ADS].[Feature_17] END AS imp1_output_18, CASE WHEN ([ADS].[Feature_18] IS NULL) THEN -0.0539879736217 ELSE [ADS].[Feature_18] END AS imp1_output_19, CASE WHEN ([ADS].[Feature_19] IS NULL) THEN 0.000544583017411 ELSE [ADS].[Feature_19] END AS imp1_output_20 
FROM [INPUT_DATA] AS [ADS]), 
[CenteredDataForPCA] AS 
(SELECT [ADS].[KEY] AS [KEY], [ADS].[Feature_0] - 0.156845906442 AS [Feature_0], [ADS].[Feature_1] - -0.138435034098 AS [Feature_1], [ADS].[Feature_2] - -0.214135465148 AS [Feature_2], [ADS].[Feature_3] - 0.117365383105 AS [Feature_3], [ADS].[Feature_4] - 0.147034409984 AS [Feature_4], [ADS].[Feature_5] - 0.0369841572337 AS [Feature_5], [ADS].[Feature_6] - 0.0559388047862 AS [Feature_6], [ADS].[Feature_7] - 0.0955585702569 AS [Feature_7], [ADS].[Feature_8] - -0.159122666805 AS [Feature_8], [ADS].[Feature_9] - -0.541123068208 AS [Feature_9], [ADS].[Feature_10] - -0.122742590879 AS [Feature_10], [ADS].[Feature_11] - -0.0725725542333 AS [Feature_11], [ADS].[Feature_12] - 0.00156119597314 AS [Feature_12], [ADS].[Feature_13] - -0.0766910454588 AS [Feature_13], [ADS].[Feature_14] - -0.0365257330962 AS [Feature_14], [ADS].[Feature_15] - 0.112764533664 AS [Feature_15], [ADS].[Feature_16] - -0.136574550875 AS [Feature_16], [ADS].[Feature_17] - -0.0347265910754 AS [Feature_17], [ADS].[Feature_18] - -0.0539879736217 AS [Feature_18], [ADS].[Feature_19] - 0.000544583017411 AS [Feature_19] 
FROM [INPUT_DATA] AS [ADS]), 
[pca_CTE] AS 
(SELECT [CenteredDataForPCA].[KEY] AS join_key_1, [CenteredDataForPCA].[Feature_0] * -0.00740893944499 + [CenteredDataForPCA].[Feature_1] * -0.0475674782081 + [CenteredDataForPCA].[Feature_2] * 0.0143390879607 + [CenteredDataForPCA].[Feature_3] * -0.0274349995256 + [CenteredDataForPCA].[Feature_4] * 0.0438290710938 + [CenteredDataForPCA].[Feature_5] * -0.09239662663 + [CenteredDataForPCA].[Feature_6] * 0.0579652769703 + [CenteredDataForPCA].[Feature_7] * 0.00814623677814 + [CenteredDataForPCA].[Feature_8] * -0.511749754081 + [CenteredDataForPCA].[Feature_9] * -0.519118391876 + [CenteredDataForPCA].[Feature_10] * -0.0348048546125 + [CenteredDataForPCA].[Feature_11] * -0.0223156332797 + [CenteredDataForPCA].[Feature_12] * -0.559258882963 + [CenteredDataForPCA].[Feature_13] * -0.0581833236831 + [CenteredDataForPCA].[Feature_14] * -0.244390937141 + [CenteredDataForPCA].[Feature_15] * 0.00810712118189 + [CenteredDataForPCA].[Feature_16] * 0.25576893489 + [CenteredDataForPCA].[Feature_17] * -0.00523953648652 + [CenteredDataForPCA].[Feature_18] * 0.0431180436162 + [CenteredDataForPCA].[Feature_19] * -0.0806585087675 AS pca_output_1, [CenteredDataForPCA].[Feature_0] * -0.0735976312706 + [CenteredDataForPCA].[Feature_1] * -0.0707063631457 + [CenteredDataForPCA].[Feature_2] * -0.0564001112213 + [CenteredDataForPCA].[Feature_3] * -0.106552327534 + [CenteredDataForPCA].[Feature_4] * -0.0592789558609 + [CenteredDataForPCA].[Feature_5] * 0.180668678601 + [CenteredDataForPCA].[Feature_6] * 0.0138602088022 + [CenteredDataForPCA].[Feature_7] * -0.14623507479 + [CenteredDataForPCA].[Feature_8] * -0.271671065609 + [CenteredDataForPCA].[Feature_9] * 0.040245483389 + [CenteredDataForPCA].[Feature_10] * 0.0235439489656 + [CenteredDataForPCA].[Feature_11] * 0.0020826222309 + [CenteredDataForPCA].[Feature_12] * 0.311761706504 + [CenteredDataForPCA].[Feature_13] * 0.135631543078 + [CenteredDataForPCA].[Feature_14] * 0.232658054846 + [CenteredDataForPCA].[Feature_15] * -0.144538874784 + [CenteredDataForPCA].[Feature_16] * 0.418334104299 + [CenteredDataForPCA].[Feature_17] * -0.175685115375 + [CenteredDataForPCA].[Feature_18] * 0.66697293959 + [CenteredDataForPCA].[Feature_19] * 0.000137776357945 AS pca_output_2, [CenteredDataForPCA].[Feature_0] * -0.0339033800624 + [CenteredDataForPCA].[Feature_1] * 0.110859977516 + [CenteredDataForPCA].[Feature_2] * -0.109031993459 + [CenteredDataForPCA].[Feature_3] * -0.144699001294 + [CenteredDataForPCA].[Feature_4] * 0.00207585348563 + [CenteredDataForPCA].[Feature_5] * 0.0606760301237 + [CenteredDataForPCA].[Feature_6] * -0.0710823768463 + [CenteredDataForPCA].[Feature_7] * 0.0997624985048 + [CenteredDataForPCA].[Feature_8] * -0.0233502388281 + [CenteredDataForPCA].[Feature_9] * 0.583170469958 + [CenteredDataForPCA].[Feature_10] * -0.100387836823 + [CenteredDataForPCA].[Feature_11] * -0.0846469497456 + [CenteredDataForPCA].[Feature_12] * -0.228149263004 + [CenteredDataForPCA].[Feature_13] * 0.0972796551956 + [CenteredDataForPCA].[Feature_14] * -0.159847876151 + [CenteredDataForPCA].[Feature_15] * -0.140271471503 + [CenteredDataForPCA].[Feature_16] * 0.590673201354 + [CenteredDataForPCA].[Feature_17] * -0.0836870491903 + [CenteredDataForPCA].[Feature_18] * -0.338417151925 + [CenteredDataForPCA].[Feature_19] * -0.000690210547025 AS pca_output_3, [CenteredDataForPCA].[Feature_0] * 0.118939993067 + [CenteredDataForPCA].[Feature_1] * -0.196331629256 + [CenteredDataForPCA].[Feature_2] * -0.253341418917 + [CenteredDataForPCA].[Feature_3] * 0.154415989739 + [CenteredDataForPCA].[Feature_4] * -0.0519987847776 + [CenteredDataForPCA].[Feature_5] * 0.168212028389 + [CenteredDataForPCA].[Feature_6] * -0.0259008625082 + [CenteredDataForPCA].[Feature_7] * -0.377225454483 + [CenteredDataForPCA].[Feature_8] * -0.0457623045216 + [CenteredDataForPCA].[Feature_9] * -0.273049796241 + [CenteredDataForPCA].[Feature_10] * -0.274219641231 + [CenteredDataForPCA].[Feature_11] * 0.402829633983 + [CenteredDataForPCA].[Feature_12] * 0.303617441011 + [CenteredDataForPCA].[Feature_13] * 0.118565965356 + [CenteredDataForPCA].[Feature_14] * -0.0164719525074 + [CenteredDataForPCA].[Feature_15] * 0.0676568575508 + [CenteredDataForPCA].[Feature_16] * 0.189966930964 + [CenteredDataForPCA].[Feature_17] * -0.171098257404 + [CenteredDataForPCA].[Feature_18] * -0.440386885265 + [CenteredDataForPCA].[Feature_19] * 0.0282942008408 AS pca_output_4, [CenteredDataForPCA].[Feature_0] * 0.263957892056 + [CenteredDataForPCA].[Feature_1] * -0.364909377042 + [CenteredDataForPCA].[Feature_2] * -0.333336803957 + [CenteredDataForPCA].[Feature_3] * -0.124475090914 + [CenteredDataForPCA].[Feature_4] * 0.353144234104 + [CenteredDataForPCA].[Feature_5] * 0.0721607640396 + [CenteredDataForPCA].[Feature_6] * -0.180242041446 + [CenteredDataForPCA].[Feature_7] * 0.215336611236 + [CenteredDataForPCA].[Feature_8] * 0.0449212121752 + [CenteredDataForPCA].[Feature_9] * 0.137874178997 + [CenteredDataForPCA].[Feature_10] * 0.0690762941751 + [CenteredDataForPCA].[Feature_11] * 0.3391025982 + [CenteredDataForPCA].[Feature_12] * -0.286682389404 + [CenteredDataForPCA].[Feature_13] * 0.260291117332 + [CenteredDataForPCA].[Feature_14] * -0.0354252071706 + [CenteredDataForPCA].[Feature_15] * 0.0192051134303 + [CenteredDataForPCA].[Feature_16] * -0.19736135889 + [CenteredDataForPCA].[Feature_17] * -0.080074572195 + [CenteredDataForPCA].[Feature_18] * 0.211876953663 + [CenteredDataForPCA].[Feature_19] * 0.281386196456 AS pca_output_5 
FROM [CenteredDataForPCA]), 
[Feature_Join_CTE] AS 
(SELECT [imp1_CTE].join_key_0 AS join_key_0, [imp1_CTE].imp1_output_1 AS imp1_output_1, [imp1_CTE].imp1_output_2 AS imp1_output_2, [imp1_CTE].imp1_output_3 AS imp1_output_3, [imp1_CTE].imp1_output_4 AS imp1_output_4, [imp1_CTE].imp1_output_5 AS imp1_output_5, [imp1_CTE].imp1_output_6 AS imp1_output_6, [imp1_CTE].imp1_output_7 AS imp1_output_7, [imp1_CTE].imp1_output_8 AS imp1_output_8, [imp1_CTE].imp1_output_9 AS imp1_output_9, [imp1_CTE].imp1_output_10 AS imp1_output_10, [imp1_CTE].imp1_output_11 AS imp1_output_11, [imp1_CTE].imp1_output_12 AS imp1_output_12, [imp1_CTE].imp1_output_13 AS imp1_output_13, [imp1_CTE].imp1_output_14 AS imp1_output_14, [imp1_CTE].imp1_output_15 AS imp1_output_15, [imp1_CTE].imp1_output_16 AS imp1_output_16, [imp1_CTE].imp1_output_17 AS imp1_output_17, [imp1_CTE].imp1_output_18 AS imp1_output_18, [imp1_CTE].imp1_output_19 AS imp1_output_19, [imp1_CTE].imp1_output_20 AS imp1_output_20, [pca_CTE].join_key_1 AS join_key_1, [pca_CTE].pca_output_1 AS pca_output_1, [pca_CTE].pca_output_2 AS pca_output_2, [pca_CTE].pca_output_3 AS pca_output_3, [pca_CTE].pca_output_4 AS pca_output_4, [pca_CTE].pca_output_5 AS pca_output_5 
FROM [imp1_CTE] LEFT OUTER JOIN [pca_CTE] ON [imp1_CTE].join_key_0 = [pca_CTE].join_key_1)
 SELECT [Feature_Join_CTE].join_key_0 AS [KEY], [Feature_Join_CTE].imp1_output_1 AS imp1_output_1, [Feature_Join_CTE].imp1_output_2 AS imp1_output_2, [Feature_Join_CTE].imp1_output_3 AS imp1_output_3, [Feature_Join_CTE].imp1_output_4 AS imp1_output_4, [Feature_Join_CTE].imp1_output_5 AS imp1_output_5, [Feature_Join_CTE].imp1_output_6 AS imp1_output_6, [Feature_Join_CTE].imp1_output_7 AS imp1_output_7, [Feature_Join_CTE].imp1_output_8 AS imp1_output_8, [Feature_Join_CTE].imp1_output_9 AS imp1_output_9, [Feature_Join_CTE].imp1_output_10 AS imp1_output_10, [Feature_Join_CTE].imp1_output_11 AS imp1_output_11, [Feature_Join_CTE].imp1_output_12 AS imp1_output_12, [Feature_Join_CTE].imp1_output_13 AS imp1_output_13, [Feature_Join_CTE].imp1_output_14 AS imp1_output_14, [Feature_Join_CTE].imp1_output_15 AS imp1_output_15, [Feature_Join_CTE].imp1_output_16 AS imp1_output_16, [Feature_Join_CTE].imp1_output_17 AS imp1_output_17, [Feature_Join_CTE].imp1_output_18 AS imp1_output_18, [Feature_Join_CTE].imp1_output_19 AS imp1_output_19, [Feature_Join_CTE].imp1_output_20 AS imp1_output_20, [Feature_Join_CTE].pca_output_1 AS pca_output_1, [Feature_Join_CTE].pca_output_2 AS pca_output_2, [Feature_Join_CTE].pca_output_3 AS pca_output_3, [Feature_Join_CTE].pca_output_4 AS pca_output_4, [Feature_Join_CTE].pca_output_5 AS pca_output_5 
FROM [Feature_Join_CTE]