-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 5.84333333333 ELSE `ADS`.`Feature_0` END AS impute_output_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 3.054 ELSE `ADS`.`Feature_1` END AS impute_output_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 3.75866666667 ELSE `ADS`.`Feature_2` END AS impute_output_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 1.19866666667 ELSE `ADS`.`Feature_3` END AS impute_output_5 
FROM `INPUT_DATA` AS `ADS`), 
`CenteredDataForPCA` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, `ADS_imp_1_OUT`.impute_output_2 - 5.84333333333 AS impute_output_2, `ADS_imp_1_OUT`.impute_output_3 - 3.054 AS impute_output_3, `ADS_imp_1_OUT`.impute_output_4 - 3.75866666667 AS impute_output_4, `ADS_imp_1_OUT`.impute_output_5 - 1.19866666667 AS impute_output_5 
FROM `ADS_imp_1_OUT`), 
`ADS_ano_2_OUT` AS 
(SELECT `CenteredDataForPCA`.`KEY` AS `KEY`, `CenteredDataForPCA`.impute_output_2 * 0.361589677381 + `CenteredDataForPCA`.impute_output_3 * -0.0822688898922 + `CenteredDataForPCA`.impute_output_4 * 0.856572105291 + `CenteredDataForPCA`.impute_output_5 * 0.358843926248 AS anova_output_2, `CenteredDataForPCA`.impute_output_2 * 0.656539883286 + `CenteredDataForPCA`.impute_output_3 * 0.729712371326 + `CenteredDataForPCA`.impute_output_4 * -0.175767403429 + `CenteredDataForPCA`.impute_output_5 * -0.074706470135 AS anova_output_3, `CenteredDataForPCA`.impute_output_2 * -0.580997279828 + `CenteredDataForPCA`.impute_output_3 * 0.596418087938 + `CenteredDataForPCA`.impute_output_4 * 0.072524075487 + `CenteredDataForPCA`.impute_output_5 * 0.549060910727 AS anova_output_4, `CenteredDataForPCA`.impute_output_2 * 0.317254547169 + `CenteredDataForPCA`.impute_output_3 * -0.324094352418 + `CenteredDataForPCA`.impute_output_4 * -0.47971898733 + `CenteredDataForPCA`.impute_output_5 * 0.751120560381 AS anova_output_5 
FROM `CenteredDataForPCA`), 
`SV_data` AS 
(SELECT `Values`.sv_idx AS sv_idx, `Values`.dual_coeff AS dual_coeff, `Values`.sv_0 AS sv_0, `Values`.sv_1 AS sv_1, `Values`.sv_2 AS sv_2, `Values`.sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, 1.0 AS dual_coeff, -2.71539061563 AS sv_0, -0.169556847556 AS sv_1, -0.203521425005 AS sv_2, 0.0996024240168 AS sv_3 UNION ALL SELECT 1 AS sv_idx, 1.0 AS dual_coeff, -2.88981953962 AS sv_0, -0.137345609605 AS sv_1, 0.024709240999 AS sv_2, 0.0193045428325 AS sv_3 UNION ALL SELECT 2 AS sv_idx, 1.0 AS dual_coeff, -2.74643719731 AS sv_0, -0.311124315752 AS sv_1, 0.0376719752853 AS sv_2, -0.0759552741085 AS sv_3 UNION ALL SELECT 3 AS sv_idx, 1.0 AS dual_coeff, -2.27989736101 AS sv_0, 0.747782713225 AS sv_1, 0.174325619016 AS sv_2, -0.0271468036979 AS sv_3 UNION ALL SELECT 4 AS sv_idx, 1.0 AS dual_coeff, -2.82089068218 AS sv_0, -0.0821045110247 AS sv_1, 0.264251085191 AS sv_2, -0.0500996250628 AS sv_3 UNION ALL SELECT 5 AS sv_idx, 1.0 AS dual_coeff, -2.88795856534 AS sv_0, -0.570798026332 AS sv_1, 0.0273354061145 AS sv_2, -0.0266154143257 AS sv_3 UNION ALL SELECT 6 AS sv_idx, 0.38507940877 AS dual_coeff, -2.67384468672 AS sv_0, -0.106691703753 AS sv_1, -0.191533299736 AS sv_2, -0.0558909659961 AS sv_3 UNION ALL SELECT 7 AS sv_idx, 1.0 AS dual_coeff, -2.50652678934 AS sv_0, 0.651935013673 AS sv_1, -0.0692749958139 AS sv_2, -0.0166082478245 AS sv_3 UNION ALL SELECT 8 AS sv_idx, 1.0 AS dual_coeff, -2.787433976 AS sv_0, -0.227740188871 AS sv_1, -0.200327788095 AS sv_2, -0.00723508673812 AS sv_3 UNION ALL SELECT 9 AS sv_idx, 1.0 AS dual_coeff, -3.22520044627 AS sv_0, -0.503279909485 AS sv_1, 0.0684136291723 AS sv_2, -0.0219466641234 AS sv_3 UNION ALL SELECT 10 AS sv_idx, 1.0 AS dual_coeff, -2.64354321694 AS sv_0, 1.18619489941 AS sv_1, -0.14450570401 AS sv_2, 0.156980961517 AS sv_3 UNION ALL SELECT 11 AS sv_idx, 1.0 AS dual_coeff, -2.3838693238 AS sv_0, 1.34475434456 AS sv_1, 0.28373066394 AS sv_2, 0.00192618170967 AS sv_3 UNION ALL SELECT 12 AS sv_idx, 1.0 AS dual_coeff, -2.62252620313 AS sv_0, 0.818089674597 AS sv_1, 0.145315988822 AS sv_2, 0.164740791234 AS sv_3 UNION ALL SELECT 13 AS sv_idx, 1.0 AS dual_coeff, -2.19907796143 AS sv_0, 0.879244088092 AS sv_1, -0.114521464798 AS sv_2, 0.0253269396564 AS sv_3 UNION ALL SELECT 14 AS sv_idx, 1.0 AS dual_coeff, -2.58734618892 AS sv_0, 0.520473638806 AS sv_1, 0.219572088001 AS sv_2, -0.0690819911788 AS sv_3 UNION ALL SELECT 15 AS sv_idx, 1.0 AS dual_coeff, -3.2158576949 AS sv_0, 0.141615571626 AS sv_1, 0.299618981511 AS sv_2, 0.00185704334745 AS sv_3 UNION ALL SELECT 16 AS sv_idx, 1.0 AS dual_coeff, -2.6476366734 AS sv_0, 0.81998263256 AS sv_1, 0.230585604254 AS sv_2, -0.284808954263 AS sv_3 UNION ALL SELECT 17 AS sv_idx, 1.0 AS dual_coeff, -2.59715947708 AS sv_0, 1.10002192801 AS sv_1, 0.163581912624 AS sv_2, -0.0989580705836 AS sv_3 UNION ALL SELECT 18 AS sv_idx, 1.0 AS dual_coeff, -2.86699984693 AS sv_0, 0.0771930957236 AS sv_1, -0.156842350498 AS sv_2, 0.162452805716 AS sv_3 UNION ALL SELECT 19 AS sv_idx, 1.0 AS dual_coeff, -2.62522846468 AS sv_0, 0.606800008422 AS sv_1, -0.261163156482 AS sv_2, 0.175879874842 AS sv_3 UNION ALL SELECT 20 AS sv_idx, 0.00328944837817 AS dual_coeff, -2.67384468672 AS sv_0, -0.106691703753 AS sv_1, -0.191533299736 AS sv_2, -0.0558909659961 AS sv_3 UNION ALL SELECT 21 AS sv_idx, 1.0 AS dual_coeff, -2.98184266485 AS sv_0, -0.480250048856 AS sv_1, 0.0797248073596 AS sv_2, -0.0110529508345 AS sv_3 UNION ALL SELECT 22 AS sv_idx, 1.0 AS dual_coeff, -2.85221108157 AS sv_0, -0.93286536747 AS sv_1, -0.340961491107 AS sv_2, 0.322650606613 AS sv_3 UNION ALL SELECT 23 AS sv_idx, 1.0 AS dual_coeff, -2.99829644283 AS sv_0, -0.334307574591 AS sv_1, 0.199008424947 AS sv_2, -0.0758718213181 AS sv_3 UNION ALL SELECT 24 AS sv_idx, 1.0 AS dual_coeff, -2.20883295418 AS sv_0, 0.442696030421 AS sv_1, 0.303487809268 AS sv_2, -0.185857530073 AS sv_3 UNION ALL SELECT 25 AS sv_idx, 1.0 AS dual_coeff, -2.71566519075 AS sv_0, -0.242681482898 AS sv_1, -0.0905156059501 AS sv_2, 0.142989025338 AS sv_3 UNION ALL SELECT 26 AS sv_idx, 1.0 AS dual_coeff, -2.53757337101 AS sv_0, 0.510367545477 AS sv_1, 0.171918404477 AS sv_2, -0.19216594595 AS sv_3 UNION ALL SELECT 27 AS sv_idx, 1.0 AS dual_coeff, -2.84032129683 AS sv_0, -0.220576338276 AS sv_1, 0.0900613765304 AS sv_2, -0.0603928106173 AS sv_3 UNION ALL SELECT 28 AS sv_idx, 1.0 AS dual_coeff, -2.54268575708 AS sv_0, 0.586281025344 AS sv_1, -0.0111752678312 AS sv_2, -0.0483337025413 AS sv_3 UNION ALL SELECT 29 AS sv_idx, 1.0 AS dual_coeff, 1.28479458785 AS sv_0, 0.685439186133 AS sv_1, -0.406129553077 AS sv_2, 0.0192901168553 AS sv_3 UNION ALL SELECT 30 AS sv_idx, 1.0 AS dual_coeff, 1.46406132278 AS sv_0, 0.504189832972 AS sv_1, -0.338260727718 AS sv_2, -0.000857644047618 AS sv_3 UNION ALL SELECT 31 AS sv_idx, 1.0 AS dual_coeff, 0.180967206348 AS sv_0, -0.825603943576 AS sv_1, -0.177082856393 AS sv_2, 0.0957844483716 AS sv_3 UNION ALL SELECT 32 AS sv_idx, 1.0 AS dual_coeff, -0.751467140648 AS sv_0, -1.00110751297 AS sv_1, 0.0156721942382 AS sv_2, -0.0165105921546 AS sv_3 UNION ALL SELECT 33 AS sv_idx, 1.0 AS dual_coeff, -0.0101900707279 AS sv_0, -0.720574866702 AS sv_1, 0.283437246254 AS sv_2, -0.00594570197509 AS sv_3 UNION ALL SELECT 34 AS sv_idx, 1.0 AS dual_coeff, -0.511086195895 AS sv_0, -1.26249195386 AS sv_1, -0.266489953822 AS sv_2, 0.0489088060634 AS sv_3 UNION ALL SELECT 35 AS sv_idx, 1.0 AS dual_coeff, 0.262335756153 AS sv_0, -0.547893298025 AS sv_1, -0.691941578319 AS sv_2, 0.0614849890834 AS sv_3 UNION ALL SELECT 36 AS sv_idx, 1.0 AS dual_coeff, -0.174864001966 AS sv_0, -0.25181557108 AS sv_1, 0.093658638192 AS sv_2, 0.12494088657 AS sv_3 UNION ALL SELECT 37 AS sv_idx, 1.0 AS dual_coeff, 0.927572942033 AS sv_0, 0.468236205043 AS sv_1, -0.313229400569 AS sv_2, 0.100438884146 AS sv_3 UNION ALL SELECT 38 AS sv_idx, 1.0 AS dual_coeff, 0.942361707399 AS sv_0, -0.54182225815 AS sv_1, -0.497348541178 AS sv_2, 0.260636685043 AS sv_3 UNION ALL SELECT 39 AS sv_idx, 1.0 AS dual_coeff, 0.0432464003287 AS sv_0, -0.581489446612 AS sv_1, -0.232963556483 AS sv_2, -0.0395611807383 AS sv_3 UNION ALL SELECT 40 AS sv_idx, 0.438592274866 AS dual_coeff, 0.899640863284 AS sv_0, 0.329610979582 AS sv_1, -0.31477148138 AS sv_2, 0.101122864671 AS sv_3 UNION ALL SELECT 41 AS sv_idx, 1.0 AS dual_coeff, -0.307334755663 AS sv_0, -0.365086612766 AS sv_1, -0.315337196939 AS sv_2, 0.0765303776306 AS sv_3 UNION ALL SELECT 42 AS sv_idx, 1.0 AS dual_coeff, -0.0703428889493 AS sv_0, -0.702537931731 AS sv_1, -0.241758044842 AS sv_2, 0.00909469851961 AS sv_3 UNION ALL SELECT 43 AS sv_idx, 1.0 AS dual_coeff, -0.191884492103 AS sv_0, -0.677490544374 AS sv_1, -0.303916543464 AS sv_2, -0.0180454587855 AS sv_3 UNION ALL SELECT 44 AS sv_idx, 1.0 AS dual_coeff, 0.58727485358 AS sv_0, -0.483284267717 AS sv_1, 0.444583753035 AS sv_2, -0.252442434627 AS sv_3 UNION ALL SELECT 45 AS sv_idx, 1.0 AS dual_coeff, 0.807205496677 AS sv_0, 0.195053963771 AS sv_1, 0.389458711386 AS sv_2, -0.116615391255 AS sv_3 UNION ALL SELECT 46 AS sv_idx, 1.0 AS dual_coeff, 0.812867790369 AS sv_0, -0.370678998319 AS sv_1, -0.612871050061 AS sv_2, 0.157700491174 AS sv_3 UNION ALL SELECT 47 AS sv_idx, 0.543286110189 AS dual_coeff, 0.164513428369 AS sv_0, -0.679661469311 AS sv_1, -0.0577992388057 AS sv_2, 0.030965577888 AS sv_3 UNION ALL SELECT 48 AS sv_idx, 0.479025528134 AS dual_coeff, 0.463030988871 AS sv_0, -0.669526546536 AS sv_1, -0.0240538908898 AS sv_2, -0.268443508324 AS sv_3 UNION ALL SELECT 49 AS sv_idx, 1.0 AS dual_coeff, -0.707081283921 AS sv_0, -1.00842476178 AS sv_1, -0.102069342538 AS sv_2, 0.047624297804 AS sv_3 UNION ALL SELECT 50 AS sv_idx, 1.0 AS dual_coeff, -0.908463333123 AS sv_0, -0.751568725169 AS sv_1, -0.00773658450698 AS sv_2, 0.233558634274 AS sv_3 UNION ALL SELECT 51 AS sv_idx, 1.0 AS dual_coeff, 2.53172698044 AS sv_0, -0.0118422366403 AS sv_1, 0.758458651528 AS sv_2, -0.0325995685144 AS sv_3 UNION ALL SELECT 52 AS sv_idx, 1.0 AS dual_coeff, 2.61648460828 AS sv_0, 0.341935286987 AS sv_1, -0.112141370554 AS sv_2, 0.0659560495264 AS sv_3 UNION ALL SELECT 53 AS sv_idx, 0.150727229663 AS dual_coeff, 2.34975798395 AS sv_0, -0.0418825496548 AS sv_1, 0.284110680866 AS sv_2, -0.00131272400361 AS sv_3 UNION ALL SELECT 54 AS sv_idx, 1.0 AS dual_coeff, 3.39687992068 AS sv_0, 0.54716804623 AS sv_1, -0.351873157627 AS sv_2, -0.11121996802 AS sv_3 UNION ALL SELECT 55 AS sv_idx, 1.0 AS dual_coeff, 0.519383245085 AS sv_0, -1.19135168905 AS sv_1, 0.546685531125 AS sv_2, -0.0987984199258 AS sv_3 UNION ALL SELECT 56 AS sv_idx, 1.0 AS dual_coeff, 2.93200509699 AS sv_0, 0.352377006181 AS sv_1, -0.423691278337 AS sv_2, -0.255407368844 AS sv_3 UNION ALL SELECT 57 AS sv_idx, 1.0 AS dual_coeff, 2.31967279387 AS sv_0, -0.245548170607 AS sv_1, -0.349922183359 AS sv_2, -0.0762628625132 AS sv_3 UNION ALL SELECT 58 AS sv_idx, 1.0 AS dual_coeff, 2.91813423364 AS sv_0, 0.780380629372 AS sv_1, 0.421738933614 AS sv_2, 0.107729319479 AS sv_3 UNION ALL SELECT 59 AS sv_idx, 1.0 AS dual_coeff, 1.34459421751 AS sv_0, -0.776415425177 AS sv_1, 0.282868018224 AS sv_2, 0.140481892258 AS sv_3 UNION ALL SELECT 60 AS sv_idx, 1.0 AS dual_coeff, 1.58526729931 AS sv_0, -0.539307053847 AS sv_1, 0.630570488462 AS sv_2, 0.327455366669 AS sv_3 UNION ALL SELECT 61 AS sv_idx, 1.0 AS dual_coeff, 3.48876537966 AS sv_0, 1.17154454426 AS sv_1, 0.129320083362 AS sv_2, -0.311629837933 AS sv_3 UNION ALL SELECT 62 AS sv_idx, 1.0 AS dual_coeff, 3.79468686121 AS sv_0, 0.253265570973 AS sv_1, -0.516970715994 AS sv_2, 0.056451643541 AS sv_3 UNION ALL SELECT 63 AS sv_idx, 1.0 AS dual_coeff, 1.29832982457 AS sv_0, -0.761013936522 AS sv_1, -0.344887047469 AS sv_2, -0.0426737180561 AS sv_3 UNION ALL SELECT 64 AS sv_idx, 1.0 AS dual_coeff, 2.42816725902 AS sv_0, 0.376781971254 AS sv_1, 0.218649070047 AS sv_2, 0.183854179151 AS sv_3 UNION ALL SELECT 65 AS sv_idx, 1.0 AS dual_coeff, 1.19809737227 AS sv_0, -0.605578961765 AS sv_1, 0.51264076504 AS sv_2, 0.0595000305491 AS sv_3 UNION ALL SELECT 66 AS sv_idx, 1.0 AS dual_coeff, 3.4992654843 AS sv_0, 0.456773466964 AS sv_1, -0.576910186722 AS sv_2, -0.137759597591 AS sv_3 UNION ALL SELECT 67 AS sv_idx, 1.0 AS dual_coeff, 2.6141938307 AS sv_0, 0.558366950279 AS sv_1, -0.208423346619 AS sv_2, -0.240445433088 AS sv_3 UNION ALL SELECT 68 AS sv_idx, 1.0 AS dual_coeff, 2.38756440237 AS sv_0, 0.462519250726 AS sv_1, -0.452023961449 AS sv_2, -0.229906877214 AS sv_3 UNION ALL SELECT 69 AS sv_idx, 1.0 AS dual_coeff, 2.84096092529 AS sv_0, 0.372742591049 AS sv_1, -0.501031539138 AS sv_2, -0.0202166253816 AS sv_3 UNION ALL SELECT 70 AS sv_idx, 1.0 AS dual_coeff, 3.2323428983 AS sv_0, 1.37052403598 AS sv_1, -0.118448777395 AS sv_2, -0.254487344376 AS sv_3 UNION ALL SELECT 71 AS sv_idx, 1.0 AS dual_coeff, 1.7796401069 AS sv_0, -0.501464794706 AS sv_1, -0.175811186057 AS sv_2, -0.503529452743 AS sv_3 UNION ALL SELECT 72 AS sv_idx, 1.0 AS dual_coeff, 3.07652162102 AS sv_0, 0.685764442246 AS sv_1, -0.336422741208 AS sv_2, 0.310589092438 AS sv_3 UNION ALL SELECT 73 AS sv_idx, 1.0 AS dual_coeff, 2.14498685671 AS sv_0, 0.138906608877 AS sv_1, 0.734184739055 AS sv_2, 0.0517665351376 AS sv_3 UNION ALL SELECT 74 AS sv_idx, 1.0 AS dual_coeff, 2.31430339463 AS sv_0, 0.182608850794 AS sv_1, 0.322860400742 AS sv_2, 0.27589665973 AS sv_3 UNION ALL SELECT 75 AS sv_idx, 1.0 AS dual_coeff, 1.92245088484 AS sv_0, 0.409271176179 AS sv_1, 0.115492815961 AS sv_2, 0.504095006791 AS sv_3 UNION ALL SELECT 76 AS sv_idx, 1.0 AS dual_coeff, 2.56332271234 AS sv_0, 0.27597450224 AS sv_1, 0.291253613127 AS sv_2, 0.0561849269684 AS sv_3 UNION ALL SELECT 77 AS sv_idx, 1.0 AS dual_coeff, 2.4193912198 AS sv_0, 0.303503937703 AS sv_1, 0.504302516951 AS sv_2, 0.238217946552 AS sv_3 UNION ALL SELECT 78 AS sv_idx, 1.0 AS dual_coeff, 1.90162907529 AS sv_0, 0.115876748248 AS sv_1, 0.722873560868 AS sv_2, 0.0408728218487 AS sv_3) AS `Values`), 
kernel_cte AS 
(SELECT t.`KEY` AS `KEY`, t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv.`KEY` AS `KEY`, sum(full_join_data_sv.dot_prod1) + -26.6702568226 AS dot_product 
FROM (SELECT `ADS_ano_2_OUT`.`KEY` AS `KEY`, `SV_data`.dual_coeff * exp(-0.25 * (power(`ADS_ano_2_OUT`.anova_output_2 - `SV_data`.sv_0, 2) + power(`ADS_ano_2_OUT`.anova_output_3 - `SV_data`.sv_1, 2) + power(`ADS_ano_2_OUT`.anova_output_4 - `SV_data`.sv_2, 2) + power(`ADS_ano_2_OUT`.anova_output_5 - `SV_data`.sv_3, 2))) AS dot_prod1 
FROM `ADS_ano_2_OUT`, `SV_data`) AS full_join_data_sv GROUP BY full_join_data_sv.`KEY`) AS t)
 SELECT kernel_cte.`KEY` AS `KEY`, kernel_cte.dot_product AS `AnomalyScore`, CASE WHEN (kernel_cte.dot_product >= 0.0) THEN 1 ELSE -1 END AS `OutlierIndicator` 
FROM kernel_cte