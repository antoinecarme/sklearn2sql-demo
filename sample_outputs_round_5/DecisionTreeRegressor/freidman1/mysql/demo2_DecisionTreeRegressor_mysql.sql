-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `DT_node_lookup` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_3` <= 0.5000883936882019) THEN CASE WHEN (`ADS`.`Feature_0` <= 0.5454992651939392) THEN CASE WHEN (`ADS`.`Feature_3` <= 0.4371861219406128) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.7458509802818298) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.3773192763328552) THEN 5 ELSE 6 END ELSE CASE WHEN (`ADS`.`Feature_7` <= 0.7971079349517822) THEN 8 ELSE 9 END END ELSE CASE WHEN (`ADS`.`Feature_7` <= 0.31154119968414307) THEN 11 ELSE CASE WHEN (`ADS`.`Feature_6` <= 0.461849570274353) THEN 13 ELSE 14 END END END ELSE CASE WHEN (`ADS`.`Feature_8` <= 0.23083066940307617) THEN CASE WHEN (`ADS`.`Feature_8` <= 0.12493887543678284) THEN 17 ELSE CASE WHEN (`ADS`.`Feature_7` <= 0.4763132333755493) THEN 19 ELSE 20 END END ELSE CASE WHEN (`ADS`.`Feature_2` <= 0.7777972221374512) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.6484861373901367) THEN 23 ELSE 24 END ELSE CASE WHEN (`ADS`.`Feature_5` <= 0.7376700639724731) THEN 26 ELSE 27 END END END END ELSE CASE WHEN (`ADS`.`Feature_1` <= 0.26570838689804077) THEN CASE WHEN (`ADS`.`Feature_0` <= 0.9269177317619324) THEN CASE WHEN (`ADS`.`Feature_4` <= 0.74560546875) THEN CASE WHEN (`ADS`.`Feature_0` <= 0.42302992939949036) THEN 32 ELSE 33 END ELSE CASE WHEN (`ADS`.`Feature_0` <= 0.393179714679718) THEN 35 ELSE 36 END END ELSE 37 END ELSE CASE WHEN (`ADS`.`Feature_3` <= 0.7979542016983032) THEN CASE WHEN (`ADS`.`Feature_0` <= 0.668872594833374) THEN CASE WHEN (`ADS`.`Feature_0` <= 0.5936675071716309) THEN 41 ELSE 42 END ELSE CASE WHEN (`ADS`.`Feature_4` <= 0.6309294700622559) THEN 44 ELSE 45 END END ELSE CASE WHEN (`ADS`.`Feature_9` <= 0.4350191354751587) THEN CASE WHEN (`ADS`.`Feature_6` <= 0.3514280915260315) THEN 48 ELSE 49 END ELSE CASE WHEN (`ADS`.`Feature_5` <= 0.290615051984787) THEN 51 ELSE 52 END END END END END AS node_id_2 
FROM freidman1 AS `ADS`), 
`DT_node_data` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.count AS count, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Estimator` AS `Estimator` 
FROM (SELECT 0 AS node_id, 'Feature_3' AS feature, 0.5000883936882019 AS threshold, 67 AS count, 0 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 15.071227628023676 AS `Estimator` UNION ALL SELECT 1 AS node_id, 'Feature_0' AS feature, 0.5454992651939392 AS threshold, 33 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 11.406085436313866 AS `Estimator` UNION ALL SELECT 2 AS node_id, 'Feature_3' AS feature, 0.4371861219406128 AS threshold, 20 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 9.239556338072477 AS `Estimator` UNION ALL SELECT 3 AS node_id, 'Feature_2' AS feature, 0.7458509802818298 AS threshold, 16 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 8.201019297584278 AS `Estimator` UNION ALL SELECT 4 AS node_id, 'Feature_2' AS feature, 0.3773192763328552 AS threshold, 12 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 7.178252505560618 AS `Estimator` UNION ALL SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 6 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 8.596368414139004 AS `Estimator` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 6 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 5.760136596982232 AS `Estimator` UNION ALL SELECT 7 AS node_id, 'Feature_7' AS feature, 0.7971079349517822 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 11.269319673655263 AS `Estimator` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 12.423053741190962 AS `Estimator` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 7.808117471048163 AS `Estimator` UNION ALL SELECT 10 AS node_id, 'Feature_7' AS feature, 0.31154119968414307 AS threshold, 4 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.39370450002526 AS `Estimator` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 11.868471599082548 AS `Estimator` UNION ALL SELECT 12 AS node_id, 'Feature_6' AS feature, 0.461849570274353 AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.902115467006164 AS `Estimator` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 14.751554712335045 AS `Estimator` UNION ALL SELECT 14 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.477395844341725 AS `Estimator` UNION ALL SELECT 15 AS node_id, 'Feature_8' AS feature, 0.23083066940307617 AS threshold, 13 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 14.739207125915993 AS `Estimator` UNION ALL SELECT 16 AS node_id, 'Feature_8' AS feature, 0.12493887543678284 AS threshold, 3 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 17.44972141229201 AS `Estimator` UNION ALL SELECT 17 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 15.02132724153292 AS `Estimator` UNION ALL SELECT 18 AS node_id, 'Feature_7' AS feature, 0.4763132333755493 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 18.66391849767156 AS `Estimator` UNION ALL SELECT 19 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 18.04666164671924 AS `Estimator` UNION ALL SELECT 20 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 19.28117534862388 AS `Estimator` UNION ALL SELECT 21 AS node_id, 'Feature_2' AS feature, 0.7777972221374512 AS threshold, 10 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.926052840003186 AS `Estimator` UNION ALL SELECT 22 AS node_id, 'Feature_2' AS feature, 0.6484861373901367 AS threshold, 7 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.2591863350991 AS `Estimator` UNION ALL SELECT 23 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 6 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.555455541608707 AS `Estimator` UNION ALL SELECT 24 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 11.481571096041485 AS `Estimator` UNION ALL SELECT 25 AS node_id, 'Feature_5' AS feature, 0.7376700639724731 AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 15.482074684779382 AS `Estimator` UNION ALL SELECT 26 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 15.20961501016165 AS `Estimator` UNION ALL SELECT 27 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 16.026994034014848 AS `Estimator` UNION ALL SELECT 28 AS node_id, 'Feature_1' AS feature, 0.26570838689804077 AS threshold, 34 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 18.628571519977317 AS `Estimator` UNION ALL SELECT 29 AS node_id, 'Feature_0' AS feature, 0.9269177317619324 AS threshold, 9 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.720262482867746 AS `Estimator` UNION ALL SELECT 30 AS node_id, 'Feature_4' AS feature, 0.74560546875 AS threshold, 8 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 12.979896805866046 AS `Estimator` UNION ALL SELECT 31 AS node_id, 'Feature_0' AS feature, 0.42302992939949036 AS threshold, 6 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 12.038297702008222 AS `Estimator` UNION ALL SELECT 32 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 10.384786927498158 AS `Estimator` UNION ALL SELECT 33 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 12.865053089263254 AS `Estimator` UNION ALL SELECT 34 AS node_id, 'Feature_0' AS feature, 0.393179714679718 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 15.80469411743951 AS `Estimator` UNION ALL SELECT 35 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 15.039063957373125 AS `Estimator` UNION ALL SELECT 36 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 16.570324277505897 AS `Estimator` UNION ALL SELECT 37 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 19.64318789888137 AS `Estimator` UNION ALL SELECT 38 AS node_id, 'Feature_3' AS feature, 0.7979542016983032 AS threshold, 25 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 20.395562773336763 AS `Estimator` UNION ALL SELECT 39 AS node_id, 'Feature_0' AS feature, 0.668872594833374 AS threshold, 11 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 18.758225595163907 AS `Estimator` UNION ALL SELECT 40 AS node_id, 'Feature_0' AS feature, 0.5936675071716309 AS threshold, 5 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 17.389246126059415 AS `Estimator` UNION ALL SELECT 41 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 17.195404779698087 AS `Estimator` UNION ALL SELECT 42 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 18.164611511504727 AS `Estimator` UNION ALL SELECT 43 AS node_id, 'Feature_4' AS feature, 0.6309294700622559 AS threshold, 6 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 19.899041819417647 AS `Estimator` UNION ALL SELECT 44 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 19.066113291605852 AS `Estimator` UNION ALL SELECT 45 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 21.564898875041237 AS `Estimator` UNION ALL SELECT 46 AS node_id, 'Feature_9' AS feature, 0.4350191354751587 AS threshold, 14 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 21.682041984758293 AS `Estimator` UNION ALL SELECT 47 AS node_id, 'Feature_6' AS feature, 0.3514280915260315 AS threshold, 6 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 20.070468456508152 AS `Estimator` UNION ALL SELECT 48 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 17.682168019874926 AS `Estimator` UNION ALL SELECT 49 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 21.264618674824767 AS `Estimator` UNION ALL SELECT 50 AS node_id, 'Feature_5' AS feature, 0.290615051984787 AS threshold, 8 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 22.890722130945893 AS `Estimator` UNION ALL SELECT 51 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 20.80107429662674 AS `Estimator` UNION ALL SELECT 52 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 6 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 23.587271409052274 AS `Estimator`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.node_id_2 AS node_id_2, `DT_node_data`.node_id AS node_id, `DT_node_data`.feature AS feature, `DT_node_data`.threshold AS threshold, `DT_node_data`.count AS count, `DT_node_data`.depth AS depth, `DT_node_data`.parent_id AS parent_id, `DT_node_data`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.node_id_2 = `DT_node_data`.node_id)
 SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`Estimator` AS `Estimator` 
FROM `DT_Output`