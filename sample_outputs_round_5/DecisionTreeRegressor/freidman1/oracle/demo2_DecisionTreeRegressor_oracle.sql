-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "DT_node_lookup" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_3" <= 0.4195423722267151) THEN CASE WHEN ("ADS"."Feature_1" <= 0.38372886180877686) THEN CASE WHEN ("ADS"."Feature_0" <= 0.8653360605239868) THEN CASE WHEN ("ADS"."Feature_0" <= 0.09298963844776154) THEN CASE WHEN ("ADS"."Feature_3" <= 0.11081977188587189) THEN 5 ELSE 6 END ELSE CASE WHEN ("ADS"."Feature_4" <= 0.45698630809783936) THEN 8 ELSE 9 END END ELSE 10 END ELSE CASE WHEN ("ADS"."Feature_4" <= 0.3018435835838318) THEN CASE WHEN ("ADS"."Feature_4" <= 0.266150563955307) THEN CASE WHEN ("ADS"."Feature_5" <= 0.16755616664886475) THEN 14 ELSE 15 END ELSE CASE WHEN ("ADS"."Feature_4" <= 0.299336314201355) THEN 17 ELSE 18 END END ELSE CASE WHEN ("ADS"."Feature_7" <= 0.7012154459953308) THEN CASE WHEN ("ADS"."Feature_4" <= 0.883620023727417) THEN 21 ELSE 22 END ELSE 23 END END END ELSE CASE WHEN ("ADS"."Feature_1" <= 0.47464585304260254) THEN CASE WHEN ("ADS"."Feature_4" <= 0.3500348627567291) THEN CASE WHEN ("ADS"."Feature_3" <= 0.5490946769714355) THEN 27 ELSE CASE WHEN ("ADS"."Feature_8" <= 0.6056270599365234) THEN 29 ELSE 30 END END ELSE CASE WHEN ("ADS"."Feature_3" <= 0.9395860433578491) THEN CASE WHEN ("ADS"."Feature_1" <= 0.19673371315002441) THEN 33 ELSE 34 END ELSE CASE WHEN ("ADS"."Feature_4" <= 0.8666189312934875) THEN 36 ELSE 37 END END END ELSE CASE WHEN ("ADS"."Feature_0" <= 0.32928943634033203) THEN CASE WHEN ("ADS"."Feature_9" <= 0.4925316274166107) THEN CASE WHEN ("ADS"."Feature_4" <= 0.13487198948860168) THEN 41 ELSE 42 END ELSE CASE WHEN ("ADS"."Feature_5" <= 0.5709521770477295) THEN 44 ELSE 45 END END ELSE CASE WHEN ("ADS"."Feature_1" <= 0.8795907497406006) THEN CASE WHEN ("ADS"."Feature_6" <= 0.042980220168828964) THEN 48 ELSE 49 END ELSE CASE WHEN ("ADS"."Feature_2" <= 0.3297871947288513) THEN 51 ELSE 52 END END END END END AS node_id_2 
FROM freidman1 "ADS"), 
"DT_node_data" AS 
(SELECT "Values".node_id AS node_id, "Values".feature AS feature, "Values".threshold AS threshold, "Values".count AS count, "Values".depth AS depth, "Values".parent_id AS parent_id, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 0 AS node_id, 'Feature_3' AS feature, 0.4195423722267151 AS threshold, 67 AS count, 0 AS depth, CAST(NULL AS INTEGER) AS parent_id, 14.085568615968707 AS "Estimator" FROM DUAL UNION ALL SELECT 1 AS node_id, 'Feature_1' AS feature, 0.38372886180877686 AS threshold, 31 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 10.562072879451659 AS "Estimator" FROM DUAL UNION ALL SELECT 2 AS node_id, 'Feature_0' AS feature, 0.8653360605239868 AS threshold, 14 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 7.896435473192894 AS "Estimator" FROM DUAL UNION ALL SELECT 3 AS node_id, 'Feature_0' AS feature, 0.09298963844776154 AS threshold, 13 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 7.377072090780497 AS "Estimator" FROM DUAL UNION ALL SELECT 4 AS node_id, 'Feature_3' AS feature, 0.11081977188587189 AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 5.13250726637741 AS "Estimator" FROM DUAL UNION ALL SELECT 5 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 4.577271303946349 AS "Estimator" FROM DUAL UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 5.410125247592941 AS "Estimator" FROM DUAL UNION ALL SELECT 7 AS node_id, 'Feature_4' AS feature, 0.45698630809783936 AS threshold, 10 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 8.050441538101424 AS "Estimator" FROM DUAL UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 6.615455332209585 AS "Estimator" FROM DUAL UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 6 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 9.007099008695983 AS "Estimator" FROM DUAL UNION ALL SELECT 10 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 14.64815944455405 AS "Estimator" FROM DUAL UNION ALL SELECT 11 AS node_id, 'Feature_4' AS feature, 0.3018435835838318 AS threshold, 17 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 12.757303684605938 AS "Estimator" FROM DUAL UNION ALL SELECT 12 AS node_id, 'Feature_4' AS feature, 0.266150563955307 AS threshold, 7 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 9.974629925382981 AS "Estimator" FROM DUAL UNION ALL SELECT 13 AS node_id, 'Feature_5' AS feature, 0.16755616664886475 AS threshold, 5 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 11.552035587067824 AS "Estimator" FROM DUAL UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 12.207402606938356 AS "Estimator" FROM DUAL UNION ALL SELECT 15 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 11.11512424048747 AS "Estimator" FROM DUAL UNION ALL SELECT 16 AS node_id, 'Feature_4' AS feature, 0.299336314201355 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 6.031115771170869 AS "Estimator" FROM DUAL UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 6.423069585809304 AS "Estimator" FROM DUAL UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 5.639161956532434 AS "Estimator" FROM DUAL UNION ALL SELECT 19 AS node_id, 'Feature_7' AS feature, 0.7012154459953308 AS threshold, 10 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 14.705175316062011 AS "Estimator" FROM DUAL UNION ALL SELECT 20 AS node_id, 'Feature_4' AS feature, 0.883620023727417 AS threshold, 9 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 15.154149487374433 AS "Estimator" FROM DUAL UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 8 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 15.49793048461533 AS "Estimator" FROM DUAL UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 12.403901509447277 AS "Estimator" FROM DUAL UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 10.664407774250188 AS "Estimator" FROM DUAL UNION ALL SELECT 24 AS node_id, 'Feature_1' AS feature, 0.47464585304260254 AS threshold, 36 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 17.119689944636164 AS "Estimator" FROM DUAL UNION ALL SELECT 25 AS node_id, 'Feature_4' AS feature, 0.3500348627567291 AS threshold, 16 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 14.285194216552693 AS "Estimator" FROM DUAL UNION ALL SELECT 26 AS node_id, 'Feature_3' AS feature, 0.5490946769714355 AS threshold, 5 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 10.63199133770959 AS "Estimator" FROM DUAL UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 7.167413234828651 AS "Estimator" FROM DUAL UNION ALL SELECT 28 AS node_id, 'Feature_8' AS feature, 0.6056270599365234 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 11.498135863429825 AS "Estimator" FROM DUAL UNION ALL SELECT 29 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 10.846305137008784 AS "Estimator" FROM DUAL UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 13.453628042692944 AS "Estimator" FROM DUAL UNION ALL SELECT 31 AS node_id, 'Feature_3' AS feature, 0.9395860433578491 AS threshold, 11 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 15.945740979663197 AS "Estimator" FROM DUAL UNION ALL SELECT 32 AS node_id, 'Feature_1' AS feature, 0.19673371315002441 AS threshold, 9 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 15.350251095718518 AS "Estimator" FROM DUAL UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 14.453516485672441 AS "Estimator" FROM DUAL UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 5 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 16.06763878375538 AS "Estimator" FROM DUAL UNION ALL SELECT 35 AS node_id, 'Feature_4' AS feature, 0.8666189312934875 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 18.625445457414244 AS "Estimator" FROM DUAL UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 19.256081697707973 AS "Estimator" FROM DUAL UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 17.99480921712052 AS "Estimator" FROM DUAL UNION ALL SELECT 38 AS node_id, 'Feature_0' AS feature, 0.32928943634033203 AS threshold, 20 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 19.387286527102937 AS "Estimator" FROM DUAL UNION ALL SELECT 39 AS node_id, 'Feature_9' AS feature, 0.4925316274166107 AS threshold, 6 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 15.46584420607145 AS "Estimator" FROM DUAL UNION ALL SELECT 40 AS node_id, 'Feature_4' AS feature, 0.13487198948860168 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 14.056232730269885 AS "Estimator" FROM DUAL UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 17.18836744293908 AS "Estimator" FROM DUAL UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 13.012187826046821 AS "Estimator" FROM DUAL UNION ALL SELECT 43 AS node_id, 'Feature_5' AS feature, 0.5709521770477295 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 18.285067157674575 AS "Estimator" FROM DUAL UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 17.743283347712897 AS "Estimator" FROM DUAL UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 18.826850967636254 AS "Estimator" FROM DUAL UNION ALL SELECT 46 AS node_id, 'Feature_1' AS feature, 0.8795907497406006 AS threshold, 14 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 21.06790466468786 AS "Estimator" FROM DUAL UNION ALL SELECT 47 AS node_id, 'Feature_6' AS feature, 0.042980220168828964 AS threshold, 12 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 21.78592567211325 AS "Estimator" FROM DUAL UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 27.204762123097222 AS "Estimator" FROM DUAL UNION ALL SELECT 49 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 11 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 21.293304176569247 AS "Estimator" FROM DUAL UNION ALL SELECT 50 AS node_id, 'Feature_2' AS feature, 0.3297871947288513 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 16.759778620135528 AS "Estimator" FROM DUAL UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 17.335566062325135 AS "Estimator" FROM DUAL UNION ALL SELECT 52 AS node_id, CAST(NULL AS VARCHAR2(256 CHAR)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 16.18399117794592 AS "Estimator" FROM DUAL) "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".node_id AS node_id, "DT_node_data".feature AS feature, "DT_node_data".threshold AS threshold, "DT_node_data".count AS count, "DT_node_data".depth AS depth, "DT_node_data".parent_id AS parent_id, "DT_node_data"."Estimator" AS "Estimator" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".node_id)
 SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."Estimator" AS "Estimator" 
FROM "DT_Output"