-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `DT_node_lookup` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_2` <= 0.0469580739736557) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.012291036546230316) THEN 2 ELSE CASE WHEN (`ADS`.`Feature_1` <= 1567.720703125) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.03137211501598358) THEN 5 ELSE 6 END ELSE 7 END END ELSE CASE WHEN (`ADS`.`Feature_1` <= 250.40985107421875) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.2644168734550476) THEN CASE WHEN (`ADS`.`Feature_0` <= 76.06660461425781) THEN 11 ELSE CASE WHEN (`ADS`.`Feature_0` <= 88.81182098388672) THEN 13 ELSE 14 END END ELSE CASE WHEN (`ADS`.`Feature_1` <= 201.6163330078125) THEN CASE WHEN (`ADS`.`Feature_1` <= 172.08372497558594) THEN 17 ELSE 18 END ELSE CASE WHEN (`ADS`.`Feature_2` <= 0.5418275594711304) THEN 20 ELSE 21 END END END ELSE CASE WHEN (`ADS`.`Feature_0` <= 86.58879089355469) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.2973732352256775) THEN CASE WHEN (`ADS`.`Feature_0` <= 17.064163208007812) THEN 25 ELSE 26 END ELSE CASE WHEN (`ADS`.`Feature_1` <= 264.51080322265625) THEN 28 ELSE 29 END END ELSE CASE WHEN (`ADS`.`Feature_2` <= 0.3904501497745514) THEN CASE WHEN (`ADS`.`Feature_3` <= 2.0914342403411865) THEN 32 ELSE 33 END ELSE CASE WHEN (`ADS`.`Feature_1` <= 789.4149169921875) THEN 35 ELSE 36 END END END END END AS node_id_2 
FROM freidman3 AS `ADS`), 
`DT_node_data` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.count AS count, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Estimator` AS `Estimator` 
FROM (SELECT 0 AS node_id, 'Feature_2' AS feature, 0.0469580739736557 AS threshold, 67 AS count, 0 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3124120917241542 AS `Estimator` UNION ALL SELECT 1 AS node_id, 'Feature_2' AS feature, 0.012291036546230316 AS threshold, 4 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.5714386434458514 AS `Estimator` UNION ALL SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.02402661423179412 AS `Estimator` UNION ALL SELECT 3 AS node_id, 'Feature_1' AS feature, 1567.720703125 AS threshold, 3 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.7539093198505372 AS `Estimator` UNION ALL SELECT 4 AS node_id, 'Feature_2' AS feature, 0.03137211501598358 AS threshold, 2 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.5828149941646796 AS `Estimator` UNION ALL SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.5151596326921987 AS `Estimator` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.6504703556371605 AS `Estimator` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.0960979712222523 AS `Estimator` UNION ALL SELECT 8 AS node_id, 'Feature_1' AS feature, 250.40985107421875 AS threshold, 63 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3594580249481731 AS `Estimator` UNION ALL SELECT 9 AS node_id, 'Feature_2' AS feature, 0.2644168734550476 AS threshold, 7 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.8628278647373719 AS `Estimator` UNION ALL SELECT 10 AS node_id, 'Feature_0' AS feature, 76.06660461425781 AS threshold, 3 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.4684914503800895 AS `Estimator` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.3586519055346436 AS `Estimator` UNION ALL SELECT 12 AS node_id, 'Feature_0' AS feature, 88.81182098388672 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.5234112228028125 AS `Estimator` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.5674295494076432 AS `Estimator` UNION ALL SELECT 14 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.47939289619798187 AS `Estimator` UNION ALL SELECT 15 AS node_id, 'Feature_1' AS feature, 201.6163330078125 AS threshold, 4 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.158580175505334 AS `Estimator` UNION ALL SELECT 16 AS node_id, 'Feature_1' AS feature, 172.08372497558594 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.2688854516422658 AS `Estimator` UNION ALL SELECT 17 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.2462070480839005 AS `Estimator` UNION ALL SELECT 18 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.2915638552006312 AS `Estimator` UNION ALL SELECT 19 AS node_id, 'Feature_2' AS feature, 0.5418275594711304 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.048274899368402 AS `Estimator` UNION ALL SELECT 20 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.0859191321069046 AS `Estimator` UNION ALL SELECT 21 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.0106306666298992 AS `Estimator` UNION ALL SELECT 22 AS node_id, 'Feature_0' AS feature, 86.58879089355469 AS threshold, 56 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4215367949745235 AS `Estimator` UNION ALL SELECT 23 AS node_id, 'Feature_2' AS feature, 0.2973732352256775 AS threshold, 47 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4589330172763653 AS `Estimator` UNION ALL SELECT 24 AS node_id, 'Feature_0' AS feature, 17.064163208007812 AS threshold, 12 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.381663285767346 AS `Estimator` UNION ALL SELECT 25 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.5222766737207476 AS `Estimator` UNION ALL SELECT 26 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3535406081766654 AS `Estimator` UNION ALL SELECT 27 AS node_id, 'Feature_1' AS feature, 264.51080322265625 AS threshold, 35 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4854254966508866 AS `Estimator` UNION ALL SELECT 28 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.157944768426053 AS `Estimator` UNION ALL SELECT 29 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 34 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4950572827751463 AS `Estimator` UNION ALL SELECT 30 AS node_id, 'Feature_2' AS feature, 0.3904501497745514 AS threshold, 9 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.2262454118426815 AS `Estimator` UNION ALL SELECT 31 AS node_id, 'Feature_3' AS feature, 2.0914342403411865 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.8611860834271037 AS `Estimator` UNION ALL SELECT 32 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.9712315658187626 AS `Estimator` UNION ALL SELECT 33 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.7511406010354447 AS `Estimator` UNION ALL SELECT 34 AS node_id, 'Feature_1' AS feature, 789.4149169921875 AS threshold, 7 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3305480771042753 AS `Estimator` UNION ALL SELECT 35 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.2482766762100779 AS `Estimator` UNION ALL SELECT 36 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4402432782965384 AS `Estimator`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.node_id_2 AS node_id_2, `DT_node_data`.node_id AS node_id, `DT_node_data`.feature AS feature, `DT_node_data`.threshold AS threshold, `DT_node_data`.count AS count, `DT_node_data`.depth AS depth, `DT_node_data`.parent_id AS parent_id, `DT_node_data`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.node_id_2 = `DT_node_data`.node_id)
 SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`Estimator` AS `Estimator` 
FROM `DT_Output`