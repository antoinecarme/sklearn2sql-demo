-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "ADS_imp_1_OUT" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 0.000388320004096 ELSE "ADS"."Feature_0" END AS impter_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN -0.000523121409649 ELSE "ADS"."Feature_1" END AS impter_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN -0.00059113583201 ELSE "ADS"."Feature_2" END AS impter_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 0.000699475650077 ELSE "ADS"."Feature_3" END AS impter_5, CASE WHEN ("ADS"."Feature_4" IS NULL) THEN 0.000639072638051 ELSE "ADS"."Feature_4" END AS impter_6, CASE WHEN ("ADS"."Feature_5" IS NULL) THEN 0.00167055436671 ELSE "ADS"."Feature_5" END AS impter_7, CASE WHEN ("ADS"."Feature_6" IS NULL) THEN -0.000775937697276 ELSE "ADS"."Feature_6" END AS impter_8, CASE WHEN ("ADS"."Feature_7" IS NULL) THEN 0.000954484248167 ELSE "ADS"."Feature_7" END AS impter_9, CASE WHEN ("ADS"."Feature_8" IS NULL) THEN -0.000573767437608 ELSE "ADS"."Feature_8" END AS impter_10, CASE WHEN ("ADS"."Feature_9" IS NULL) THEN 0.000881407121415 ELSE "ADS"."Feature_9" END AS impter_11 
FROM diabetes AS "ADS"), 
"ADS_sca_2_OUT" AS 
(SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".impter_2 AS FLOAT) - 0.000388320004096) / 0.0479877658692 AS scaler_2, (CAST("ADS_imp_1_OUT".impter_3 AS FLOAT) - -0.000523121409649) / 0.047529053468 AS scaler_3, (CAST("ADS_imp_1_OUT".impter_4 AS FLOAT) - -0.00059113583201) / 0.0456995777439 AS scaler_4, (CAST("ADS_imp_1_OUT".impter_5 AS FLOAT) - 0.000699475650077) / 0.0478758790487 AS scaler_5, (CAST("ADS_imp_1_OUT".impter_6 AS FLOAT) - 0.000639072638051) / 0.0480272670816 AS scaler_6, (CAST("ADS_imp_1_OUT".impter_7 AS FLOAT) - 0.00167055436671) / 0.0485647246577 AS scaler_7, (CAST("ADS_imp_1_OUT".impter_8 AS FLOAT) - -0.000775937697276) / 0.0462775749119 AS scaler_8, (CAST("ADS_imp_1_OUT".impter_9 AS FLOAT) - 0.000954484248167) / 0.0482818984956 AS scaler_9, (CAST("ADS_imp_1_OUT".impter_10 AS FLOAT) - -0.000573767437608) / 0.045893243625 AS scaler_10, (CAST("ADS_imp_1_OUT".impter_11 AS FLOAT) - 0.000881407121415) / 0.047439004286 AS scaler_11 
FROM "ADS_imp_1_OUT"), 
"DT_node_lookup" AS 
(SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.027921516448259354) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.14836068451404572) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 2.285642623901367) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.19300708174705505) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= 2.4557933807373047) THEN 5 ELSE 6 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_8 <= 1.0678181648254395) THEN 8 ELSE 9 END END ELSE 10 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= 0.5141576528549194) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= -1.0057297945022583) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= -0.3591923117637634) THEN 14 ELSE 15 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_2 <= 1.163844108581543) THEN 17 ELSE 18 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.6554323434829712) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= -1.3510655164718628) THEN 21 ELSE 22 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 1.0064752101898193) THEN 24 ELSE 25 END END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 1.5162749290466309) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_11 <= 0.788189172744751) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_5 <= 0.7658511400222778) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.5002193450927734) THEN 30 ELSE 31 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 0.3488308787345886) THEN 33 ELSE 34 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= -0.18182548880577087) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_10 <= 0.3435918688774109) THEN 37 ELSE 38 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 3.3656935691833496) THEN 40 ELSE 41 END END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.4286001920700073) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= -0.43274158239364624) THEN CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= -0.6905863285064697) THEN 45 ELSE 46 END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_7 <= 0.2802947461605072) THEN 48 ELSE 49 END END ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_6 <= 0.3694418668746948) THEN 51 ELSE CASE WHEN ("ADS_sca_2_OUT".scaler_4 <= 1.8346686363220215) THEN 53 ELSE 54 END END END END END AS node_id_2 
FROM "ADS_sca_2_OUT"), 
"DT_node_data" AS 
(SELECT "Values".node_id AS node_id, "Values".feature AS feature, "Values".threshold AS threshold, "Values".count AS count, "Values".depth AS depth, "Values".parent_id AS parent_id, "Values"."Estimator" AS "Estimator" 
FROM (SELECT 0 AS node_id, 'scaler_10' AS feature, 0.027921516448259354 AS threshold, 296 AS count, 0 AS depth, CAST(NULL AS INTEGER) AS parent_id, 149.8108108108108 AS "Estimator" UNION ALL SELECT 1 AS node_id, 'scaler_4' AS feature, 0.14836068451404572 AS threshold, 156 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 111.78205128205128 AS "Estimator" UNION ALL SELECT 2 AS node_id, 'scaler_7' AS feature, 2.285642623901367 AS threshold, 125 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 100.6 AS "Estimator" UNION ALL SELECT 3 AS node_id, 'scaler_10' AS feature, -0.19300708174705505 AS threshold, 124 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 99.37096774193549 AS "Estimator" UNION ALL SELECT 4 AS node_id, 'scaler_5' AS feature, 2.4557933807373047 AS threshold, 112 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 94.84821428571429 AS "Estimator" UNION ALL SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 111 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 93.75675675675676 AS "Estimator" UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 216.0 AS "Estimator" UNION ALL SELECT 7 AS node_id, 'scaler_8' AS feature, 1.0678181648254395 AS threshold, 12 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 141.58333333333334 AS "Estimator" UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 10 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 153.8 AS "Estimator" UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 80.5 AS "Estimator" UNION ALL SELECT 10 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 253.0 AS "Estimator" UNION ALL SELECT 11 AS node_id, 'scaler_5' AS feature, 0.5141576528549194 AS threshold, 31 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 156.8709677419355 AS "Estimator" UNION ALL SELECT 12 AS node_id, 'scaler_6' AS feature, -1.0057297945022583 AS threshold, 19 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 135.78947368421052 AS "Estimator" UNION ALL SELECT 13 AS node_id, 'scaler_10' AS feature, -0.3591923117637634 AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 193.0 AS "Estimator" UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 184.5 AS "Estimator" UNION ALL SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 210.0 AS "Estimator" UNION ALL SELECT 16 AS node_id, 'scaler_2' AS feature, 1.163844108581543 AS threshold, 16 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 125.0625 AS "Estimator" UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 14 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 131.5 AS "Estimator" UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 80.0 AS "Estimator" UNION ALL SELECT 19 AS node_id, 'scaler_4' AS feature, 0.6554323434829712 AS threshold, 12 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 190.25 AS "Estimator" UNION ALL SELECT 20 AS node_id, 'scaler_7' AS feature, -1.3510655164718628 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 132.0 AS "Estimator" UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 170.0 AS "Estimator" UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 119.33333333333333 AS "Estimator" UNION ALL SELECT 23 AS node_id, 'scaler_11' AS feature, 1.0064752101898193 AS threshold, 8 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 219.375 AS "Estimator" UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 6 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 244.83333333333334 AS "Estimator" UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 143.0 AS "Estimator" UNION ALL SELECT 26 AS node_id, 'scaler_4' AS feature, 1.5162749290466309 AS threshold, 140 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 192.18571428571428 AS "Estimator" UNION ALL SELECT 27 AS node_id, 'scaler_11' AS feature, 0.788189172744751 AS threshold, 120 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 180.31666666666666 AS "Estimator" UNION ALL SELECT 28 AS node_id, 'scaler_5' AS feature, 0.7658511400222778 AS threshold, 85 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 166.6 AS "Estimator" UNION ALL SELECT 29 AS node_id, 'scaler_4' AS feature, -0.5002193450927734 AS threshold, 62 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 154.08064516129033 AS "Estimator" UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 15 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 118.86666666666666 AS "Estimator" UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 47 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 165.31914893617022 AS "Estimator" UNION ALL SELECT 32 AS node_id, 'scaler_4' AS feature, 0.3488308787345886 AS threshold, 23 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 200.34782608695653 AS "Estimator" UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 10 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 162.1 AS "Estimator" UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 13 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 229.76923076923077 AS "Estimator" UNION ALL SELECT 35 AS node_id, 'scaler_4' AS feature, -0.18182548880577087 AS threshold, 35 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 213.62857142857143 AS "Estimator" UNION ALL SELECT 36 AS node_id, 'scaler_10' AS feature, 0.3435918688774109 AS threshold, 10 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 166.9 AS "Estimator" UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 84.0 AS "Estimator" UNION ALL SELECT 38 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 8 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 187.625 AS "Estimator" UNION ALL SELECT 39 AS node_id, 'scaler_7' AS feature, 3.3656935691833496 AS threshold, 25 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 232.32 AS "Estimator" UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 24 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 238.5 AS "Estimator" UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 84.0 AS "Estimator" UNION ALL SELECT 42 AS node_id, 'scaler_7' AS feature, 0.4286001920700073 AS threshold, 20 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 263.4 AS "Estimator" UNION ALL SELECT 43 AS node_id, 'scaler_6' AS feature, -0.43274158239364624 AS threshold, 13 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 282.3076923076923 AS "Estimator" UNION ALL SELECT 44 AS node_id, 'scaler_6' AS feature, -0.6905863285064697 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 333.5 AS "Estimator" UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 321.0 AS "Estimator" UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 346.0 AS "Estimator" UNION ALL SELECT 47 AS node_id, 'scaler_7' AS feature, 0.2802947461605072 AS threshold, 11 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 273.0 AS "Estimator" UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 9 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 265.0 AS "Estimator" UNION ALL SELECT 49 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 309.0 AS "Estimator" UNION ALL SELECT 50 AS node_id, 'scaler_6' AS feature, 0.3694418668746948 AS threshold, 7 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 228.28571428571428 AS "Estimator" UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 128.0 AS "Estimator" UNION ALL SELECT 52 AS node_id, 'scaler_4' AS feature, 1.8346686363220215 AS threshold, 6 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 245.0 AS "Estimator" UNION ALL SELECT 53 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 221.25 AS "Estimator" UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 292.5 AS "Estimator") AS "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".node_id AS node_id, "DT_node_data".feature AS feature, "DT_node_data".threshold AS threshold, "DT_node_data".count AS count, "DT_node_data".depth AS depth, "DT_node_data".parent_id AS parent_id, "DT_node_data"."Estimator" AS "Estimator" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".node_id)
 SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."Estimator" AS "Estimator" 
FROM "DT_Output"