-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 0.527577297114 ELSE `ADS`.`Feature_0` END AS impter_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 0.474625073329 ELSE `ADS`.`Feature_1` END AS impter_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 0.514768018446 ELSE `ADS`.`Feature_2` END AS impter_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 0.515659224409 ELSE `ADS`.`Feature_3` END AS impter_5, CASE WHEN (`ADS`.`Feature_4` IS NULL) THEN 0.535922325994 ELSE `ADS`.`Feature_4` END AS impter_6, CASE WHEN (`ADS`.`Feature_5` IS NULL) THEN 0.478043406896 ELSE `ADS`.`Feature_5` END AS impter_7, CASE WHEN (`ADS`.`Feature_6` IS NULL) THEN 0.55810353969 ELSE `ADS`.`Feature_6` END AS impter_8, CASE WHEN (`ADS`.`Feature_7` IS NULL) THEN 0.483779546118 ELSE `ADS`.`Feature_7` END AS impter_9, CASE WHEN (`ADS`.`Feature_8` IS NULL) THEN 0.51970573502 ELSE `ADS`.`Feature_8` END AS impter_10, CASE WHEN (`ADS`.`Feature_9` IS NULL) THEN 0.504487250322 ELSE `ADS`.`Feature_9` END AS impter_11 
FROM freidman1 AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.impter_2 AS DOUBLE) - 0.527577297114) / 0.282591151563 AS scaler_2, (CAST(`ADS_imp_1_OUT`.impter_3 AS DOUBLE) - 0.474625073329) / 0.297511424725 AS scaler_3, (CAST(`ADS_imp_1_OUT`.impter_4 AS DOUBLE) - 0.514768018446) / 0.282667611354 AS scaler_4, (CAST(`ADS_imp_1_OUT`.impter_5 AS DOUBLE) - 0.515659224409) / 0.261378833865 AS scaler_5, (CAST(`ADS_imp_1_OUT`.impter_6 AS DOUBLE) - 0.535922325994) / 0.27908514873 AS scaler_6, (CAST(`ADS_imp_1_OUT`.impter_7 AS DOUBLE) - 0.478043406896) / 0.313316628725 AS scaler_7, (CAST(`ADS_imp_1_OUT`.impter_8 AS DOUBLE) - 0.55810353969) / 0.251656339794 AS scaler_8, (CAST(`ADS_imp_1_OUT`.impter_9 AS DOUBLE) - 0.483779546118) / 0.257038068967 AS scaler_9, (CAST(`ADS_imp_1_OUT`.impter_10 AS DOUBLE) - 0.51970573502) / 0.283267029986 AS scaler_10, (CAST(`ADS_imp_1_OUT`.impter_11 AS DOUBLE) - 0.504487250322) / 0.288884476274 AS scaler_11 
FROM `ADS_imp_1_OUT`), 
`DT_node_lookup` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_3 <= -0.46784707903862) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_5 <= 0.10652866959571838) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_7 <= 0.9850526452064514) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_7 <= 0.72639399766922) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_9 <= -0.9611436128616333) THEN 5 ELSE 6 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_9 <= 0.04718860983848572) THEN 8 ELSE 9 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_6 <= -0.08583101630210876) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_7 <= 1.3349802494049072) THEN 12 ELSE 13 END ELSE 14 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_6 <= -1.4178998470306396) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_8 <= -0.37926316261291504) THEN 17 ELSE 18 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_8 <= -0.9698737859725952) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_5 <= 0.8720360994338989) THEN 21 ELSE 22 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_9 <= -0.5012106895446777) THEN 24 ELSE 25 END END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_5 <= -0.12586888670921326) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_2 <= -0.4098150134086609) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_5 <= -1.1660842895507812) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_9 <= -0.7549778819084167) THEN 30 ELSE 31 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_2 <= -1.3163292407989502) THEN 33 ELSE 34 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_4 <= -1.3676106929779053) THEN 36 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_6 <= -0.6318511962890625) THEN 38 ELSE 39 END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_2 <= -0.7748841643333435) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_9 <= -0.9224902391433716) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_8 <= 0.42026764154434204) THEN 43 ELSE 44 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_4 <= -0.6814438104629517) THEN 46 ELSE 47 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_6 <= 0.649803638458252) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_4 <= 1.0055601596832275) THEN 50 ELSE 51 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_5 <= 0.33100754022598267) THEN 53 ELSE 54 END END END END END AS node_id_2 
FROM `ADS_sca_2_OUT`), 
`DT_node_data` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.count AS count, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Estimator` AS `Estimator` 
FROM (SELECT 0 AS node_id, 'scaler_3' AS feature, -0.46784707903862 AS threshold, 67 AS count, 0 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 14.78937563773721 AS `Estimator` UNION ALL SELECT 1 AS node_id, 'scaler_5' AS feature, 0.10652866959571838 AS threshold, 25 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 11.352836973223168 AS `Estimator` UNION ALL SELECT 2 AS node_id, 'scaler_7' AS feature, 0.9850526452064514 AS threshold, 13 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 8.827452972801197 AS `Estimator` UNION ALL SELECT 3 AS node_id, 'scaler_7' AS feature, 0.72639399766922 AS threshold, 9 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 10.53133600188328 AS `Estimator` UNION ALL SELECT 4 AS node_id, 'scaler_9' AS feature, -0.9611436128616333 AS threshold, 7 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 9.764294381134189 AS `Estimator` UNION ALL SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 11.675759184660173 AS `Estimator` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 6 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 9.445716913879856 AS `Estimator` UNION ALL SELECT 7 AS node_id, 'scaler_9' AS feature, 0.04718860983848572 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.215981674505105 AS `Estimator` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.715234312420097 AS `Estimator` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 12.716729036590113 AS `Estimator` UNION ALL SELECT 10 AS node_id, 'scaler_6' AS feature, -0.08583101630210876 AS threshold, 4 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 4.993716157366508 AS `Estimator` UNION ALL SELECT 11 AS node_id, 'scaler_7' AS feature, 1.3349802494049072 AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 3.9398574349499165 AS `Estimator` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 2.110061041062841 AS `Estimator` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 4.854755631893454 AS `Estimator` UNION ALL SELECT 14 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 8.155292324616282 AS `Estimator` UNION ALL SELECT 15 AS node_id, 'scaler_6' AS feature, -1.4178998470306396 AS threshold, 12 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 14.088669640346971 AS `Estimator` UNION ALL SELECT 16 AS node_id, 'scaler_8' AS feature, -0.37926316261291504 AS threshold, 2 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 7.942988262332597 AS `Estimator` UNION ALL SELECT 17 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 7.733072554287197 AS `Estimator` UNION ALL SELECT 18 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 8.152903970377997 AS `Estimator` UNION ALL SELECT 19 AS node_id, 'scaler_8' AS feature, -0.9698737859725952 AS threshold, 10 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 15.317805915949844 AS `Estimator` UNION ALL SELECT 20 AS node_id, 'scaler_5' AS feature, 0.8720360994338989 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 11.84909148535684 AS `Estimator` UNION ALL SELECT 21 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 10.802023075905597 AS `Estimator` UNION ALL SELECT 22 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 12.896159894808086 AS `Estimator` UNION ALL SELECT 23 AS node_id, 'scaler_9' AS feature, -0.5012106895446777 AS threshold, 8 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 16.184984523598096 AS `Estimator` UNION ALL SELECT 24 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 17.08608861458436 AS `Estimator` UNION ALL SELECT 25 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 15.283880432611834 AS `Estimator` UNION ALL SELECT 26 AS node_id, 'scaler_5' AS feature, -0.12586888670921326 AS threshold, 42 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 16.83493436661461 AS `Estimator` UNION ALL SELECT 27 AS node_id, 'scaler_2' AS feature, -0.4098150134086609 AS threshold, 19 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 14.310926856769846 AS `Estimator` UNION ALL SELECT 28 AS node_id, 'scaler_5' AS feature, -1.1660842895507812 AS threshold, 5 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 11.35302461501224 AS `Estimator` UNION ALL SELECT 29 AS node_id, 'scaler_9' AS feature, -0.7549778819084167 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.47873553313859 AS `Estimator` UNION ALL SELECT 30 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.44666357981366 AS `Estimator` UNION ALL SELECT 31 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.510807486463522 AS `Estimator` UNION ALL SELECT 32 AS node_id, 'scaler_2' AS feature, -1.3163292407989502 AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 9.935884002928006 AS `Estimator` UNION ALL SELECT 33 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 8.868457341726435 AS `Estimator` UNION ALL SELECT 34 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 10.469597333528792 AS `Estimator` UNION ALL SELECT 35 AS node_id, 'scaler_4' AS feature, -1.3676106929779053 AS threshold, 14 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 15.367320514540424 AS `Estimator` UNION ALL SELECT 36 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 20.279041807230836 AS `Estimator` UNION ALL SELECT 37 AS node_id, 'scaler_6' AS feature, -0.6318511962890625 AS threshold, 13 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 14.989495799718087 AS `Estimator` UNION ALL SELECT 38 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.063284537483057 AS `Estimator` UNION ALL SELECT 39 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 15.567359178388594 AS `Estimator` UNION ALL SELECT 40 AS node_id, 'scaler_2' AS feature, -0.7748841643333435 AS threshold, 23 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 18.91998404866029 AS `Estimator` UNION ALL SELECT 41 AS node_id, 'scaler_9' AS feature, -0.9224902391433716 AS threshold, 6 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 13.953415830864612 AS `Estimator` UNION ALL SELECT 42 AS node_id, 'scaler_8' AS feature, 0.42026764154434204 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 11.440666197402312 AS `Estimator` UNION ALL SELECT 43 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 12.332750509458121 AS `Estimator` UNION ALL SELECT 44 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 10.548581885346502 AS `Estimator` UNION ALL SELECT 45 AS node_id, 'scaler_4' AS feature, -0.6814438104629517 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 15.20979064759576 AS `Estimator` UNION ALL SELECT 46 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 16.708665766099795 AS `Estimator` UNION ALL SELECT 47 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 14.71016560809442 AS `Estimator` UNION ALL SELECT 48 AS node_id, 'scaler_6' AS feature, 0.649803638458252 AS threshold, 17 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 20.67289047847053 AS `Estimator` UNION ALL SELECT 49 AS node_id, 'scaler_4' AS feature, 1.0055601596832275 AS threshold, 10 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 19.475052318263156 AS `Estimator` UNION ALL SELECT 50 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 7 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 18.366657714847626 AS `Estimator` UNION ALL SELECT 51 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 22.061306392899386 AS `Estimator` UNION ALL SELECT 52 AS node_id, 'scaler_5' AS feature, 0.33100754022598267 AS threshold, 7 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 22.384087850195357 AS `Estimator` UNION ALL SELECT 53 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 20.63429416727621 AS `Estimator` UNION ALL SELECT 54 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 5 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 23.084005323363016 AS `Estimator`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.node_id_2 AS node_id_2, `DT_node_data`.node_id AS node_id, `DT_node_data`.feature AS feature, `DT_node_data`.threshold AS threshold, `DT_node_data`.count AS count, `DT_node_data`.depth AS depth, `DT_node_data`.parent_id AS parent_id, `DT_node_data`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.node_id_2 = `DT_node_data`.node_id)
 SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`Estimator` AS `Estimator` 
FROM `DT_Output`