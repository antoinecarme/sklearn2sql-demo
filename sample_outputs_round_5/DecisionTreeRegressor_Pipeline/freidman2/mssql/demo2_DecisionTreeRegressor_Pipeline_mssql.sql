-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH [ADS_imp_1_OUT] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_0] IS NULL) THEN 48.8085296078 ELSE [ADS].[Feature_0] END AS imputer_output_2, CASE WHEN ([ADS].[Feature_1] IS NULL) THEN 1021.42289433 ELSE [ADS].[Feature_1] END AS imputer_output_3, CASE WHEN ([ADS].[Feature_2] IS NULL) THEN 0.55872183203 ELSE [ADS].[Feature_2] END AS imputer_output_4, CASE WHEN ([ADS].[Feature_3] IS NULL) THEN 6.1193765776 ELSE [ADS].[Feature_3] END AS imputer_output_5 
FROM freidman2 AS [ADS]), 
[ADS_sca_2_OUT] AS 
(SELECT [ADS_imp_1_OUT].[KEY] AS [KEY], (CAST([ADS_imp_1_OUT].imputer_output_2 AS FLOAT) - 48.8085296078) / 32.8024737926 AS scaler_output_2, (CAST([ADS_imp_1_OUT].imputer_output_3 AS FLOAT) - 1021.42289433) / 488.192644869 AS scaler_output_3, (CAST([ADS_imp_1_OUT].imputer_output_4 AS FLOAT) - 0.55872183203) / 0.279047853338 AS scaler_output_4, (CAST([ADS_imp_1_OUT].imputer_output_5 AS FLOAT) - 6.1193765776) / 2.92691763854 AS scaler_output_5 
FROM [ADS_imp_1_OUT]), 
[DT_node_lookup] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= -0.25893211364746094) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= 0.22401338815689087) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= -0.8543955087661743) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_5 <= -1.4508023262023926) THEN 4 ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= -1.9831562042236328) THEN 6 ELSE 7 END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= -0.7375686764717102) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= -1.374098539352417) THEN 10 ELSE 11 END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_5 <= -0.6291279196739197) THEN 13 ELSE 14 END END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= -0.8151324391365051) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= -1.3614845275878906) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= -1.590651035308838) THEN 18 ELSE 19 END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= -0.9946063756942749) THEN 21 ELSE 22 END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= 1.3658552169799805) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_5 <= -0.5935468077659607) THEN 25 ELSE 26 END ELSE 27 END END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= -0.24756988883018494) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= -0.9788883924484253) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_2 <= -0.558994472026825) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_5 <= 0.8793575763702393) THEN 32 ELSE 33 END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= -1.6718995571136475) THEN 35 ELSE 36 END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= -0.8473824262619019) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_5 <= 0.6156671643257141) THEN 39 ELSE 40 END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= 1.212937831878662) THEN 42 ELSE 43 END END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= 0.8299159407615662) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= 1.3475418090820312) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_5 <= -1.3009363412857056) THEN 47 ELSE 48 END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= 1.4293370246887207) THEN 50 ELSE 51 END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= 0.8866322040557861) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_5 <= 1.3984155654907227) THEN 54 ELSE 55 END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_2 <= -0.27390915155410767) THEN 57 ELSE 58 END END END END END AS node_id_2 
FROM [ADS_sca_2_OUT]), 
[DT_node_data] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].parent_id AS parent_id, [Values].[Estimator] AS [Estimator] 
FROM (SELECT 0 AS node_id, 'scaler_output_4' AS feature, -0.25893211364746094 AS threshold, 67 AS count, 0 AS depth, CAST(NULL AS INTEGER) AS parent_id, 560.0041265357771 AS [Estimator] UNION ALL SELECT 1 AS node_id, 'scaler_output_3' AS feature, 0.22401338815689087 AS threshold, 27 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 279.8211536754348 AS [Estimator] UNION ALL SELECT 2 AS node_id, 'scaler_output_4' AS feature, -0.8543955087661743 AS threshold, 14 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 158.89753236341676 AS [Estimator] UNION ALL SELECT 3 AS node_id, 'scaler_output_5' AS feature, -1.4508023262023926 AS threshold, 7 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 49.06829283618884 AS [Estimator] UNION ALL SELECT 4 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 6.799721643765554 AS [Estimator] UNION ALL SELECT 5 AS node_id, 'scaler_output_4' AS feature, -1.9831562042236328 AS threshold, 6 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 56.113054701592716 AS [Estimator] UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 87.35589922690748 AS [Estimator] UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 5 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 49.86448579652976 AS [Estimator] UNION ALL SELECT 8 AS node_id, 'scaler_output_3' AS feature, -0.7375686764717102 AS threshold, 7 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 268.7267718906447 AS [Estimator] UNION ALL SELECT 9 AS node_id, 'scaler_output_3' AS feature, -1.374098539352417 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 204.65635686218008 AS [Estimator] UNION ALL SELECT 10 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 156.49768557117847 AS [Estimator] UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 220.70924729251396 AS [Estimator] UNION ALL SELECT 12 AS node_id, 'scaler_output_5' AS feature, -0.6291279196739197 AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 354.1539919285976 AS [Estimator] UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 364.0460722636322 AS [Estimator] UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 349.20795176108027 AS [Estimator] UNION ALL SELECT 15 AS node_id, 'scaler_output_4' AS feature, -0.8151324391365051 AS threshold, 13 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 410.0465920114542 AS [Estimator] UNION ALL SELECT 16 AS node_id, 'scaler_output_4' AS feature, -1.3614845275878906 AS threshold, 8 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 287.4569447908177 AS [Estimator] UNION ALL SELECT 17 AS node_id, 'scaler_output_4' AS feature, -1.590651035308838 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 208.23645744339007 AS [Estimator] UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 127.13426813360027 AS [Estimator] UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 235.2705205466533 AS [Estimator] UNION ALL SELECT 20 AS node_id, 'scaler_output_4' AS feature, -0.9946063756942749 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 366.6774321382453 AS [Estimator] UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 335.56651324736225 AS [Estimator] UNION ALL SELECT 22 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 397.7883510291284 AS [Estimator] UNION ALL SELECT 23 AS node_id, 'scaler_output_3' AS feature, 1.3658552169799805 AS threshold, 5 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 606.1900275644728 AS [Estimator] UNION ALL SELECT 24 AS node_id, 'scaler_output_5' AS feature, -0.5935468077659607 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 590.0292388893754 AS [Estimator] UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 610.2682912423736 AS [Estimator] UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 569.7901865363774 AS [Estimator] UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 670.8331822648623 AS [Estimator] UNION ALL SELECT 28 AS node_id, 'scaler_output_3' AS feature, -0.24756988883018494 AS threshold, 40 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 749.1276332165081 AS [Estimator] UNION ALL SELECT 29 AS node_id, 'scaler_output_3' AS feature, -0.9788883924484253 AS threshold, 16 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 388.4837046376577 AS [Estimator] UNION ALL SELECT 30 AS node_id, 'scaler_output_2' AS feature, -0.558994472026825 AS threshold, 9 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 261.59082046455296 AS [Estimator] UNION ALL SELECT 31 AS node_id, 'scaler_output_5' AS feature, 0.8793575763702393 AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 363.91118147653924 AS [Estimator] UNION ALL SELECT 32 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 340.45212673025674 AS [Estimator] UNION ALL SELECT 33 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 410.82929096910436 AS [Estimator] UNION ALL SELECT 34 AS node_id, 'scaler_output_3' AS feature, -1.6718995571136475 AS threshold, 6 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 210.43063995855985 AS [Estimator] UNION ALL SELECT 35 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 147.07011921469973 AS [Estimator] UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 242.11090033048987 AS [Estimator] UNION ALL SELECT 37 AS node_id, 'scaler_output_3' AS feature, -0.8473824262619019 AS threshold, 7 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 551.6316985745065 AS [Estimator] UNION ALL SELECT 38 AS node_id, 'scaler_output_5' AS feature, 0.6156671643257141 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 431.5802852977025 AS [Estimator] UNION ALL SELECT 39 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 409.9005319908786 AS [Estimator] UNION ALL SELECT 40 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 453.26003860452636 AS [Estimator] UNION ALL SELECT 41 AS node_id, 'scaler_output_4' AS feature, 1.212937831878662 AS threshold, 5 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 599.652263885228 AS [Estimator] UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 572.8375209745075 AS [Estimator] UNION ALL SELECT 43 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 706.9112355281101 AS [Estimator] UNION ALL SELECT 44 AS node_id, 'scaler_output_3' AS feature, 0.8299159407615662 AS threshold, 24 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 989.5569189357419 AS [Estimator] UNION ALL SELECT 45 AS node_id, 'scaler_output_4' AS feature, 1.3475418090820312 AS threshold, 13 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 863.2341349073648 AS [Estimator] UNION ALL SELECT 46 AS node_id, 'scaler_output_5' AS feature, -1.3009363412857056 AS threshold, 11 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 820.2316052980946 AS [Estimator] UNION ALL SELECT 47 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1029.7418029468502 AS [Estimator] UNION ALL SELECT 48 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 10 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 799.280585533219 AS [Estimator] UNION ALL SELECT 49 AS node_id, 'scaler_output_4' AS feature, 1.4293370246887207 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1099.7480477583513 AS [Estimator] UNION ALL SELECT 50 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1081.446886405145 AS [Estimator] UNION ALL SELECT 51 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1118.0492091115577 AS [Estimator] UNION ALL SELECT 52 AS node_id, 'scaler_output_4' AS feature, 0.8866322040557861 AS threshold, 11 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1138.8474818783686 AS [Estimator] UNION ALL SELECT 53 AS node_id, 'scaler_output_5' AS feature, 1.3984155654907227 AS threshold, 8 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1022.452775653692 AS [Estimator] UNION ALL SELECT 54 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 7 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1060.1096424627526 AS [Estimator] UNION ALL SELECT 55 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 758.8547079902686 AS [Estimator] UNION ALL SELECT 56 AS node_id, 'scaler_output_2' AS feature, -0.27390915155410767 AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1449.2333651441725 AS [Estimator] UNION ALL SELECT 57 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1479.511666840894 AS [Estimator] UNION ALL SELECT 58 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1434.094214295812 AS [Estimator]) AS [Values]), 
[DT_Output] AS 
(SELECT [DT_node_lookup].[KEY] AS [KEY], [DT_node_lookup].node_id_2 AS node_id_2, [DT_node_data].node_id AS node_id, [DT_node_data].feature AS feature, [DT_node_data].threshold AS threshold, [DT_node_data].count AS count, [DT_node_data].depth AS depth, [DT_node_data].parent_id AS parent_id, [DT_node_data].[Estimator] AS [Estimator] 
FROM [DT_node_lookup] LEFT OUTER JOIN [DT_node_data] ON [DT_node_lookup].node_id_2 = [DT_node_data].node_id)
 SELECT [DT_Output].[KEY] AS [KEY], [DT_Output].[Estimator] AS [Estimator] 
FROM [DT_Output]