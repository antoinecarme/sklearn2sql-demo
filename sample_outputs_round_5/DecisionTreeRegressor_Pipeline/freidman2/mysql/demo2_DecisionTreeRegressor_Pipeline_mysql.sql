-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 48.3989281016 ELSE `ADS`.`Feature_0` END AS imputer_output_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 863.797976583 ELSE `ADS`.`Feature_1` END AS imputer_output_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 0.594921142984 ELSE `ADS`.`Feature_2` END AS imputer_output_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 5.92230712255 ELSE `ADS`.`Feature_3` END AS imputer_output_5 
FROM freidman2 AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.imputer_output_2 AS DOUBLE) - 48.3989281016) / 30.6796512817 AS scaler_output_2, (CAST(`ADS_imp_1_OUT`.imputer_output_3 AS DOUBLE) - 863.797976583) / 469.05644985 AS scaler_output_3, (CAST(`ADS_imp_1_OUT`.imputer_output_4 AS DOUBLE) - 0.594921142984) / 0.260296023866 AS scaler_output_4, (CAST(`ADS_imp_1_OUT`.imputer_output_5 AS DOUBLE) - 5.92230712255) / 2.98956131823 AS scaler_output_5 
FROM `ADS_imp_1_OUT`), 
`DT_node_lookup` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= 0.4735470414161682) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.5700840353965759) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.8080586791038513) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.9230077266693115) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -0.17436370253562927) THEN 5 ELSE 6 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.3241734504699707) THEN 8 ELSE 9 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -0.9110814332962036) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -1.076015591621399) THEN 12 ELSE 13 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -0.23432092368602753) THEN 15 ELSE 16 END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -0.4918711185455322) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -1.1050575971603394) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.06869427859783173) THEN 20 ELSE 21 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.3439825773239136) THEN 23 ELSE 24 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= 0.18948611617088318) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -0.1804083287715912) THEN 27 ELSE 28 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= 0.3032761216163635) THEN 30 ELSE 31 END END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.6062671542167664) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -0.40985891222953796) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.873056411743164) THEN 35 ELSE 36 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.672531008720398) THEN 38 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.0878444910049438) THEN 40 ELSE 41 END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.5054697394371033) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= 0.757149338722229) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= 0.5080437660217285) THEN 45 ELSE 46 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= 1.7848771810531616) THEN 48 ELSE 49 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -0.30673813819885254) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= 1.5722054243087769) THEN 52 ELSE 53 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.9952107667922974) THEN 55 ELSE 56 END END END END END AS node_id_2 
FROM `ADS_sca_2_OUT`), 
`DT_node_data` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.count AS count, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Estimator` AS `Estimator` 
FROM (SELECT 0 AS node_id, 'scaler_output_3' AS feature, 0.4735470414161682 AS threshold, 67 AS count, 0 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 512.2366777201817 AS `Estimator` UNION ALL SELECT 1 AS node_id, 'scaler_output_4' AS feature, 0.5700840353965759 AS threshold, 47 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 348.5426322413728 AS `Estimator` UNION ALL SELECT 2 AS node_id, 'scaler_output_4' AS feature, -0.8080586791038513 AS threshold, 31 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 250.23708441080623 AS `Estimator` UNION ALL SELECT 3 AS node_id, 'scaler_output_4' AS feature, -1.9230077266693115 AS threshold, 11 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 141.8872444620857 AS `Estimator` UNION ALL SELECT 4 AS node_id, 'scaler_output_5' AS feature, -0.17436370253562927 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 46.75299419704314 AS `Estimator` UNION ALL SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 5.565369274445837 AS `Estimator` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 87.94061911964043 AS `Estimator` UNION ALL SELECT 7 AS node_id, 'scaler_output_2' AS feature, 0.3241734504699707 AS threshold, 9 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 163.0281889654285 AS `Estimator` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 198.5558746574796 AS `Estimator` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 5 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 134.60604041178757 AS `Estimator` UNION ALL SELECT 10 AS node_id, 'scaler_output_3' AS feature, -0.9110814332962036 AS threshold, 20 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 309.82949638260254 AS `Estimator` UNION ALL SELECT 11 AS node_id, 'scaler_output_3' AS feature, -1.076015591621399 AS threshold, 9 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 190.49385342432177 AS `Estimator` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 7 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 165.0001300431829 AS `Estimator` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 279.7218852583078 AS `Estimator` UNION ALL SELECT 14 AS node_id, 'scaler_output_3' AS feature, -0.23432092368602753 AS threshold, 11 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 407.46774971210505 AS `Estimator` UNION ALL SELECT 15 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 5 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 352.2550124845661 AS `Estimator` UNION ALL SELECT 16 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 6 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 453.47836406838746 AS `Estimator` UNION ALL SELECT 17 AS node_id, 'scaler_output_3' AS feature, -0.4918711185455322 AS threshold, 16 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 539.0096311630952 AS `Estimator` UNION ALL SELECT 18 AS node_id, 'scaler_output_3' AS feature, -1.1050575971603394 AS threshold, 8 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 317.94135965476335 AS `Estimator` UNION ALL SELECT 19 AS node_id, 'scaler_output_2' AS feature, -0.06869427859783173 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 215.0168192038076 AS `Estimator` UNION ALL SELECT 20 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 225.81759578417777 AS `Estimator` UNION ALL SELECT 21 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 182.61448946269715 AS `Estimator` UNION ALL SELECT 22 AS node_id, 'scaler_output_2' AS feature, 0.3439825773239136 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 420.86590010571905 AS `Estimator` UNION ALL SELECT 23 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 405.77124669639517 AS `Estimator` UNION ALL SELECT 24 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 466.1498603336908 AS `Estimator` UNION ALL SELECT 25 AS node_id, 'scaler_output_3' AS feature, 0.18948611617088318 AS threshold, 8 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 760.0779026714272 AS `Estimator` UNION ALL SELECT 26 AS node_id, 'scaler_output_3' AS feature, -0.1804083287715912 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 694.3777357575218 AS `Estimator` UNION ALL SELECT 27 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 598.8155759464863 AS `Estimator` UNION ALL SELECT 28 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 726.231789027867 AS `Estimator` UNION ALL SELECT 29 AS node_id, 'scaler_output_3' AS feature, 0.3032761216163635 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 825.7780695853324 AS `Estimator` UNION ALL SELECT 30 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 791.1013666101927 AS `Estimator` UNION ALL SELECT 31 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 929.8081785107515 AS `Estimator` UNION ALL SELECT 32 AS node_id, 'scaler_output_4' AS feature, -0.6062671542167664 AS threshold, 20 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 896.9176845953834 AS `Estimator` UNION ALL SELECT 33 AS node_id, 'scaler_output_5' AS feature, -0.40985891222953796 AS threshold, 5 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 342.11409960926005 AS `Estimator` UNION ALL SELECT 34 AS node_id, 'scaler_output_4' AS feature, -1.873056411743164 AS threshold, 2 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 178.45612647676478 AS `Estimator` UNION ALL SELECT 35 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 154.9469560197378 AS `Estimator` UNION ALL SELECT 36 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 201.96529693379176 AS `Estimator` UNION ALL SELECT 37 AS node_id, 'scaler_output_5' AS feature, 0.672531008720398 AS threshold, 3 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 451.2194150309236 AS `Estimator` UNION ALL SELECT 38 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 498.06139423617043 AS `Estimator` UNION ALL SELECT 39 AS node_id, 'scaler_output_4' AS feature, -1.0878444910049438 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 427.7984254283001 AS `Estimator` UNION ALL SELECT 40 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 418.514470856445 AS `Estimator` UNION ALL SELECT 41 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 437.0823800001553 AS `Estimator` UNION ALL SELECT 42 AS node_id, 'scaler_output_4' AS feature, 0.5054697394371033 AS threshold, 15 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1081.8522129240912 AS `Estimator` UNION ALL SELECT 43 AS node_id, 'scaler_output_3' AS feature, 0.757149338722229 AS threshold, 8 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 881.2478971267913 AS `Estimator` UNION ALL SELECT 44 AS node_id, 'scaler_output_3' AS feature, 0.5080437660217285 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 766.6661887679361 AS `Estimator` UNION ALL SELECT 45 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 748.7201221464411 AS `Estimator` UNION ALL SELECT 46 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 784.6122553894312 AS `Estimator` UNION ALL SELECT 47 AS node_id, 'scaler_output_3' AS feature, 1.7848771810531616 AS threshold, 6 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 919.4417999130764 AS `Estimator` UNION ALL SELECT 48 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 5 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 894.2514313578162 AS `Estimator` UNION ALL SELECT 49 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1045.3936426893774 AS `Estimator` UNION ALL SELECT 50 AS node_id, 'scaler_output_5' AS feature, -0.30673813819885254 AS threshold, 7 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1311.114288121005 AS `Estimator` UNION ALL SELECT 51 AS node_id, 'scaler_output_3' AS feature, 1.5722054243087769 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1489.6564120361354 AS `Estimator` UNION ALL SELECT 52 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1443.4843967636607 AS `Estimator` UNION ALL SELECT 53 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1535.8284273086103 AS `Estimator` UNION ALL SELECT 54 AS node_id, 'scaler_output_2' AS feature, -0.9952107667922974 AS threshold, 5 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1239.6974385549531 AS `Estimator` UNION ALL SELECT 55 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1361.5376269182707 AS `Estimator` UNION ALL SELECT 56 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1209.2373914641234 AS `Estimator`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.node_id_2 AS node_id_2, `DT_node_data`.node_id AS node_id, `DT_node_data`.feature AS feature, `DT_node_data`.threshold AS threshold, `DT_node_data`.count AS count, `DT_node_data`.depth AS depth, `DT_node_data`.parent_id AS parent_id, `DT_node_data`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.node_id_2 = `DT_node_data`.node_id)
 SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`Estimator` AS `Estimator` 
FROM `DT_Output`