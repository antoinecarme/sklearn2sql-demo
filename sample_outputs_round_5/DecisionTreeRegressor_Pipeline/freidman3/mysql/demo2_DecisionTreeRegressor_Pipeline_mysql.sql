-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 46.325686563 ELSE `ADS`.`Feature_0` END AS imputer_output_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 943.857201442 ELSE `ADS`.`Feature_1` END AS imputer_output_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 0.487390400135 ELSE `ADS`.`Feature_2` END AS imputer_output_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 6.10735544469 ELSE `ADS`.`Feature_3` END AS imputer_output_5 
FROM freidman3 AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.imputer_output_2 AS DOUBLE) - 46.325686563) / 27.438569085 AS scaler_output_2, (CAST(`ADS_imp_1_OUT`.imputer_output_3 AS DOUBLE) - 943.857201442) / 456.004100339 AS scaler_output_3, (CAST(`ADS_imp_1_OUT`.imputer_output_4 AS DOUBLE) - 0.487390400135) / 0.293034070423 AS scaler_output_4, (CAST(`ADS_imp_1_OUT`.imputer_output_5 AS DOUBLE) - 6.10735544469) / 2.72101556523 AS scaler_output_5 
FROM `ADS_imp_1_OUT`), 
`DT_node_lookup` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.1144170761108398) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.6285356879234314) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= 1.0462591648101807) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.2936277389526367) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.880744457244873) THEN 5 ELSE 6 END ELSE 7 END ELSE 8 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -0.7260152697563171) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 1.371077299118042) THEN 11 ELSE 12 END ELSE 13 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -1.0064337253570557) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.11793866753578186) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -1.0439088344573975) THEN 17 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -0.4378879964351654) THEN 19 ELSE 20 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -0.8022158145904541) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -0.8849261999130249) THEN 23 ELSE 24 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -1.6917864084243774) THEN 26 ELSE 27 END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.719523549079895) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -0.6550127267837524) THEN 30 ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.7951836585998535) THEN 32 ELSE 33 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.4623006284236908) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= 0.6251310110092163) THEN 36 ELSE 37 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -0.24891215562820435) THEN 39 ELSE 40 END END END END END AS node_id_2 
FROM `ADS_sca_2_OUT`), 
`DT_node_data` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.count AS count, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Estimator` AS `Estimator` 
FROM (SELECT 0 AS node_id, 'scaler_output_4' AS feature, -1.1144170761108398 AS threshold, 67 AS count, 0 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.306183274472568 AS `Estimator` UNION ALL SELECT 1 AS node_id, 'scaler_output_2' AS feature, 0.6285356879234314 AS threshold, 10 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.7419167963286424 AS `Estimator` UNION ALL SELECT 2 AS node_id, 'scaler_output_3' AS feature, 1.0462591648101807 AS threshold, 7 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.9352816705957808 AS `Estimator` UNION ALL SELECT 3 AS node_id, 'scaler_output_4' AS feature, -1.2936277389526367 AS threshold, 6 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.8303804114419192 AS `Estimator` UNION ALL SELECT 4 AS node_id, 'scaler_output_5' AS feature, 0.880744457244873 AS threshold, 5 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.7844420747542159 AS `Estimator` UNION ALL SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.8501733455747519 AS `Estimator` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.7406212275405252 AS `Estimator` UNION ALL SELECT 7 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.0600720948804367 AS `Estimator` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.5646892255189502 AS `Estimator` UNION ALL SELECT 9 AS node_id, 'scaler_output_3' AS feature, -0.7260152697563171 AS threshold, 3 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.290732089705319 AS `Estimator` UNION ALL SELECT 10 AS node_id, 'scaler_output_2' AS feature, 1.371077299118042 AS threshold, 2 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.35379973663950887 AS `Estimator` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.3407677882243531 AS `Estimator` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.3668316850546646 AS `Estimator` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.16459679583693929 AS `Estimator` UNION ALL SELECT 14 AS node_id, 'scaler_output_3' AS feature, -1.0064337253570557 AS threshold, 57 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4051773934451866 AS `Estimator` UNION ALL SELECT 15 AS node_id, 'scaler_output_2' AS feature, 0.11793866753578186 AS threshold, 10 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.1006557873013452 AS `Estimator` UNION ALL SELECT 16 AS node_id, 'scaler_output_2' AS feature, -1.0439088344573975 AS threshold, 3 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4251987585438917 AS `Estimator` UNION ALL SELECT 17 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4815973207065904 AS `Estimator` UNION ALL SELECT 18 AS node_id, 'scaler_output_5' AS feature, -0.4378879964351654 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3969994774625425 AS `Estimator` UNION ALL SELECT 19 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3863335712907472 AS `Estimator` UNION ALL SELECT 20 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4076653836343376 AS `Estimator` UNION ALL SELECT 21 AS node_id, 'scaler_output_5' AS feature, -0.8022158145904541 AS threshold, 7 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.9615659424831108 AS `Estimator` UNION ALL SELECT 22 AS node_id, 'scaler_output_5' AS feature, -0.8849261999130249 AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.8208946844090343 AS `Estimator` UNION ALL SELECT 23 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.8622319411234811 AS `Estimator` UNION ALL SELECT 24 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.7382201709801409 AS `Estimator` UNION ALL SELECT 25 AS node_id, 'scaler_output_3' AS feature, -1.6917864084243774 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.0670693860386684 AS `Estimator` UNION ALL SELECT 26 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.9449130447481865 AS `Estimator` UNION ALL SELECT 27 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.107788166468829 AS `Estimator` UNION ALL SELECT 28 AS node_id, 'scaler_output_2' AS feature, -0.719523549079895 AS threshold, 47 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4699692245396216 AS `Estimator` UNION ALL SELECT 29 AS node_id, 'scaler_output_3' AS feature, -0.6550127267837524 AS threshold, 18 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.5477119612456753 AS `Estimator` UNION ALL SELECT 30 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4977386346152004 AS `Estimator` UNION ALL SELECT 31 AS node_id, 'scaler_output_4' AS feature, -0.7951836585998535 AS threshold, 16 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.5539586270744843 AS `Estimator` UNION ALL SELECT 32 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.512166463839374 AS `Estimator` UNION ALL SELECT 33 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 15 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.5567447712901583 AS `Estimator` UNION ALL SELECT 34 AS node_id, 'scaler_output_4' AS feature, -0.4623006284236908 AS threshold, 29 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4217151121013814 AS `Estimator` UNION ALL SELECT 35 AS node_id, 'scaler_output_3' AS feature, 0.6251310110092163 AS threshold, 10 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3396083629899578 AS `Estimator` UNION ALL SELECT 36 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 5 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.301594467267535 AS `Estimator` UNION ALL SELECT 37 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 5 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3776222587123805 AS `Estimator` UNION ALL SELECT 38 AS node_id, 'scaler_output_3' AS feature, -0.24891215562820435 AS threshold, 19 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4649291905810784 AS `Estimator` UNION ALL SELECT 39 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 5 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4054509392461587 AS `Estimator` UNION ALL SELECT 40 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 14 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4861714232006922 AS `Estimator`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.node_id_2 AS node_id_2, `DT_node_data`.node_id AS node_id, `DT_node_data`.feature AS feature, `DT_node_data`.threshold AS threshold, `DT_node_data`.count AS count, `DT_node_data`.depth AS depth, `DT_node_data`.parent_id AS parent_id, `DT_node_data`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.node_id_2 = `DT_node_data`.node_id)
 SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`Estimator` AS `Estimator` 
FROM `DT_Output`