-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 50.0126402518 ELSE `ADS`.`Feature_0` END AS imputer_output_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 965.068028162 ELSE `ADS`.`Feature_1` END AS imputer_output_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 0.491898222625 ELSE `ADS`.`Feature_2` END AS imputer_output_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 5.74289663134 ELSE `ADS`.`Feature_3` END AS imputer_output_5 
FROM freidman3 AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.imputer_output_2 AS DOUBLE) - 50.0126402518) / 28.2018429014 AS scaler_output_2, (CAST(`ADS_imp_1_OUT`.imputer_output_3 AS DOUBLE) - 965.068028162) / 500.691032921 AS scaler_output_3, (CAST(`ADS_imp_1_OUT`.imputer_output_4 AS DOUBLE) - 0.491898222625) / 0.271963012555 AS scaler_output_4, (CAST(`ADS_imp_1_OUT`.imputer_output_5 AS DOUBLE) - 5.74289663134) / 2.74267410388 AS scaler_output_5 
FROM `ADS_imp_1_OUT`), 
`DT_node_lookup` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.590501070022583) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -0.5696614384651184) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.4328410625457764) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -0.628903865814209) THEN 4 ELSE 5 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.399456262588501) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.5913951396942139) THEN 8 ELSE 9 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.820837676525116) THEN 11 ELSE 12 END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.6291367411613464) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.770057201385498) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 0.6775112152099609) THEN 16 ELSE 17 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.3265461921691895) THEN 19 ELSE 20 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.1487030982971191) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 1.0275278091430664) THEN 23 ELSE 24 END ELSE 25 END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 1.3462119102478027) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -0.541822075843811) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.5521215796470642) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -1.2126818895339966) THEN 30 ELSE 31 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -0.7173536419868469) THEN 33 ELSE 34 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -0.11790110915899277) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -1.2366209030151367) THEN 37 ELSE 38 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= 0.12467654049396515) THEN 40 ELSE 41 END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.39544373750686646) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= 1.3089872598648071) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -0.016813091933727264) THEN 45 ELSE 46 END ELSE 47 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.764980137348175) THEN 49 ELSE 50 END END END END AS node_id_2 
FROM `ADS_sca_2_OUT`), 
`DT_node_data` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.count AS count, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Estimator` AS `Estimator` 
FROM (SELECT 0 AS node_id, 'scaler_output_4' AS feature, -0.590501070022583 AS threshold, 67 AS count, 0 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.347738084873334 AS `Estimator` UNION ALL SELECT 1 AS node_id, 'scaler_output_3' AS feature, -0.5696614384651184 AS threshold, 20 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.1114422607814542 AS `Estimator` UNION ALL SELECT 2 AS node_id, 'scaler_output_4' AS feature, -1.4328410625457764 AS threshold, 8 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.811954179097432 AS `Estimator` UNION ALL SELECT 3 AS node_id, 'scaler_output_5' AS feature, -0.628903865814209 AS threshold, 2 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.2852896622824691 AS `Estimator` UNION ALL SELECT 4 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.19117270959511518 AS `Estimator` UNION ALL SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.379406614969823 AS `Estimator` UNION ALL SELECT 6 AS node_id, 'scaler_output_2' AS feature, 0.399456262588501 AS threshold, 6 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.987509018035753 AS `Estimator` UNION ALL SELECT 7 AS node_id, 'scaler_output_4' AS feature, -0.5913951396942139 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.1057429495143065 AS `Estimator` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.076670317989857 AS `Estimator` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.1929608440876556 AS `Estimator` UNION ALL SELECT 10 AS node_id, 'scaler_output_5' AS feature, 0.820837676525116 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.7510411550786457 AS `Estimator` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.7045744564136093 AS `Estimator` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.797507853743682 AS `Estimator` UNION ALL SELECT 13 AS node_id, 'scaler_output_2' AS feature, 0.6291367411613464 AS threshold, 12 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3111009819041357 AS `Estimator` UNION ALL SELECT 14 AS node_id, 'scaler_output_2' AS feature, -0.770057201385498 AS threshold, 9 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3835396740298265 AS `Estimator` UNION ALL SELECT 15 AS node_id, 'scaler_output_5' AS feature, 0.6775112152099609 AS threshold, 4 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4493624284287958 AS `Estimator` UNION ALL SELECT 16 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4927563466971183 AS `Estimator` UNION ALL SELECT 17 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4059685101604735 AS `Estimator` UNION ALL SELECT 18 AS node_id, 'scaler_output_4' AS feature, -1.3265461921691895 AS threshold, 5 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.330881470510651 AS `Estimator` UNION ALL SELECT 19 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.2601221996539034 AS `Estimator` UNION ALL SELECT 20 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.378054317748483 AS `Estimator` UNION ALL SELECT 21 AS node_id, 'scaler_output_4' AS feature, -1.1487030982971191 AS threshold, 3 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.0937849055270628 AS `Estimator` UNION ALL SELECT 22 AS node_id, 'scaler_output_2' AS feature, 1.0275278091430664 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.0048427356771379 AS `Estimator` UNION ALL SELECT 23 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.0842381330145943 AS `Estimator` UNION ALL SELECT 24 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.9254473383396817 AS `Estimator` UNION ALL SELECT 25 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.2716692452269123 AS `Estimator` UNION ALL SELECT 26 AS node_id, 'scaler_output_2' AS feature, 1.3462119102478027 AS threshold, 47 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4482894993805169 AS `Estimator` UNION ALL SELECT 27 AS node_id, 'scaler_output_3' AS feature, -0.541822075843811 AS threshold, 42 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4793915320258297 AS `Estimator` UNION ALL SELECT 28 AS node_id, 'scaler_output_2' AS feature, 0.5521215796470642 AS threshold, 16 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.41891349183818 AS `Estimator` UNION ALL SELECT 29 AS node_id, 'scaler_output_2' AS feature, -1.2126818895339966 AS threshold, 11 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4709771513647738 AS `Estimator` UNION ALL SELECT 30 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 5 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.5275502776787138 AS `Estimator` UNION ALL SELECT 31 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 6 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4238328794364907 AS `Estimator` UNION ALL SELECT 32 AS node_id, 'scaler_output_3' AS feature, -0.7173536419868469 AS threshold, 5 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3043734408796732 AS `Estimator` UNION ALL SELECT 33 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.2196261872172192 AS `Estimator` UNION ALL SELECT 34 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.360871609987976 AS `Estimator` UNION ALL SELECT 35 AS node_id, 'scaler_output_2' AS feature, -0.11790110915899277 AS threshold, 26 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.5166087875259215 AS `Estimator` UNION ALL SELECT 36 AS node_id, 'scaler_output_2' AS feature, -1.2366209030151367 AS threshold, 11 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.539076237749348 AS `Estimator` UNION ALL SELECT 37 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.5625715138361465 AS `Estimator` UNION ALL SELECT 38 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 8 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.5302655092167987 AS `Estimator` UNION ALL SELECT 39 AS node_id, 'scaler_output_3' AS feature, 0.12467654049396515 AS threshold, 15 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.5001326573620757 AS `Estimator` UNION ALL SELECT 40 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4655729548643526 AS `Estimator` UNION ALL SELECT 41 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 12 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.508772582986506 AS `Estimator` UNION ALL SELECT 42 AS node_id, 'scaler_output_4' AS feature, 0.39544373750686646 AS threshold, 5 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.1870324251598898 AS `Estimator` UNION ALL SELECT 43 AS node_id, 'scaler_output_5' AS feature, 1.3089872598648071 AS threshold, 3 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3198674918876538 AS `Estimator` UNION ALL SELECT 44 AS node_id, 'scaler_output_4' AS feature, -0.016813091933727264 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.2671172460233808 AS `Estimator` UNION ALL SELECT 45 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.2482281238543456 AS `Estimator` UNION ALL SELECT 46 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.286006368192416 AS `Estimator` UNION ALL SELECT 47 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4253679836162 AS `Estimator` UNION ALL SELECT 48 AS node_id, 'scaler_output_4' AS feature, 0.764980137348175 AS threshold, 2 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.9877798250682441 AS `Estimator` UNION ALL SELECT 49 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.0672616205697276 AS `Estimator` UNION ALL SELECT 50 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.9082980295667606 AS `Estimator`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.node_id_2 AS node_id_2, `DT_node_data`.node_id AS node_id, `DT_node_data`.feature AS feature, `DT_node_data`.threshold AS threshold, `DT_node_data`.count AS count, `DT_node_data`.depth AS depth, `DT_node_data`.parent_id AS parent_id, `DT_node_data`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.node_id_2 = `DT_node_data`.node_id)
 SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`Estimator` AS `Estimator` 
FROM `DT_Output`