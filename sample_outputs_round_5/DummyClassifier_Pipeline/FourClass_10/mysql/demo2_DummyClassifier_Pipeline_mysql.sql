-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 0.159961706919 ELSE `ADS`.`Feature_0` END AS impter_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 0.325878953871 ELSE `ADS`.`Feature_1` END AS impter_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN -0.096352910546 ELSE `ADS`.`Feature_2` END AS impter_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN -0.110846298346 ELSE `ADS`.`Feature_3` END AS impter_5, CASE WHEN (`ADS`.`Feature_4` IS NULL) THEN -0.0406865724475 ELSE `ADS`.`Feature_4` END AS impter_6, CASE WHEN (`ADS`.`Feature_5` IS NULL) THEN -0.0328000509835 ELSE `ADS`.`Feature_5` END AS impter_7, CASE WHEN (`ADS`.`Feature_6` IS NULL) THEN -0.253395132208 ELSE `ADS`.`Feature_6` END AS impter_8, CASE WHEN (`ADS`.`Feature_7` IS NULL) THEN -0.0773279885223 ELSE `ADS`.`Feature_7` END AS impter_9, CASE WHEN (`ADS`.`Feature_8` IS NULL) THEN 0.0164178210996 ELSE `ADS`.`Feature_8` END AS impter_10, CASE WHEN (`ADS`.`Feature_9` IS NULL) THEN 0.000758271470705 ELSE `ADS`.`Feature_9` END AS impter_11 
FROM `FourClass_10` AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.impter_2 AS DOUBLE) - 0.159961706919) / 1.33461509002 AS scaler_2, (CAST(`ADS_imp_1_OUT`.impter_3 AS DOUBLE) - 0.325878953871) / 0.974251636243 AS scaler_3, (CAST(`ADS_imp_1_OUT`.impter_4 AS DOUBLE) - -0.096352910546) / 1.72025077992 AS scaler_4, (CAST(`ADS_imp_1_OUT`.impter_5 AS DOUBLE) - -0.110846298346) / 0.982768389768 AS scaler_5, (CAST(`ADS_imp_1_OUT`.impter_6 AS DOUBLE) - -0.0406865724475) / 1.47511199483 AS scaler_6, (CAST(`ADS_imp_1_OUT`.impter_7 AS DOUBLE) - -0.0328000509835) / 1.52262866833 AS scaler_7, (CAST(`ADS_imp_1_OUT`.impter_8 AS DOUBLE) - -0.253395132208) / 1.25379282324 AS scaler_8, (CAST(`ADS_imp_1_OUT`.impter_9 AS DOUBLE) - -0.0773279885223) / 0.925856036592 AS scaler_9, (CAST(`ADS_imp_1_OUT`.impter_10 AS DOUBLE) - 0.0164178210996) / 1.05311075365 AS scaler_10, (CAST(`ADS_imp_1_OUT`.impter_11 AS DOUBLE) - 0.000758271470705) / 0.947443476945 AS scaler_11 
FROM `ADS_imp_1_OUT`), 
random_number_cte AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, rand() AS uniform 
FROM `ADS_sca_2_OUT`), 
multinomial_cte AS 
(SELECT random_number_cte.`KEY` AS `KEY`, CASE WHEN (random_number_cte.uniform <= 0.194029850746) THEN 0 ELSE CASE WHEN (random_number_cte.uniform <= 0.462686567164) THEN 1 ELSE CASE WHEN (random_number_cte.uniform <= 0.731343283582) THEN 2 ELSE CASE WHEN (random_number_cte.uniform <= 1.0) THEN 3 END END END END AS multinomial_expr 
FROM random_number_cte), 
dummy_class_reg_cte AS 
(SELECT multinomial_cte.`KEY` AS `KEY`, 0.194029850746 AS `Proba_0`, CASE WHEN (0.194029850746 IS NULL OR 0.194029850746 > 0.0) THEN ln(0.194029850746) ELSE -1.79769313486231e+308 END AS `LogProba_0`, 0.268656716418 AS `Proba_1`, CASE WHEN (0.268656716418 IS NULL OR 0.268656716418 > 0.0) THEN ln(0.268656716418) ELSE -1.79769313486231e+308 END AS `LogProba_1`, 0.268656716418 AS `Proba_2`, CASE WHEN (0.268656716418 IS NULL OR 0.268656716418 > 0.0) THEN ln(0.268656716418) ELSE -1.79769313486231e+308 END AS `LogProba_2`, 0.268656716418 AS `Proba_3`, CASE WHEN (0.268656716418 IS NULL OR 0.268656716418 > 0.0) THEN ln(0.268656716418) ELSE -1.79769313486231e+308 END AS `LogProba_3`, multinomial_cte.multinomial_expr AS `Decision` 
FROM multinomial_cte)
 SELECT dummy_class_reg_cte.`KEY` AS `KEY`, NULL AS `Score_0`, NULL AS `Score_1`, NULL AS `Score_2`, NULL AS `Score_3`, dummy_class_reg_cte.`Proba_0` AS `Proba_0`, dummy_class_reg_cte.`Proba_1` AS `Proba_1`, dummy_class_reg_cte.`Proba_2` AS `Proba_2`, dummy_class_reg_cte.`Proba_3` AS `Proba_3`, dummy_class_reg_cte.`LogProba_0` AS `LogProba_0`, dummy_class_reg_cte.`LogProba_1` AS `LogProba_1`, dummy_class_reg_cte.`LogProba_2` AS `LogProba_2`, dummy_class_reg_cte.`LogProba_3` AS `LogProba_3`, dummy_class_reg_cte.`Decision` AS `Decision` 
FROM dummy_class_reg_cte