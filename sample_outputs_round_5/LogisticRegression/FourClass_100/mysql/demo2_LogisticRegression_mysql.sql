-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH linear_model_cte AS 
(SELECT `ADS`.`KEY` AS `KEY`, 0.40882434689763336 * `ADS`.`Feature_0` + 0.18300958102225517 * `ADS`.`Feature_1` + 0.0117245529623903 * `ADS`.`Feature_2` + 0.07683519393173062 * `ADS`.`Feature_3` + -0.14452813088780728 * `ADS`.`Feature_4` + 0.0068227809608305675 * `ADS`.`Feature_5` + -0.04846125921774621 * `ADS`.`Feature_6` + -0.1945417976493903 * `ADS`.`Feature_7` + -0.06656096144252334 * `ADS`.`Feature_8` + -0.09777180085535703 * `ADS`.`Feature_9` + 0.3752554972150883 * `ADS`.`Feature_10` + 0.1817387834008068 * `ADS`.`Feature_11` + -0.19587740791146407 * `ADS`.`Feature_12` + 0.041412035954786985 * `ADS`.`Feature_13` + 0.04350755638995178 * `ADS`.`Feature_14` + -0.33188314586750806 * `ADS`.`Feature_15` + -0.15598042310595298 * `ADS`.`Feature_16` + -0.029236386885124123 * `ADS`.`Feature_17` + -0.22183175068191507 * `ADS`.`Feature_18` + 0.19848920763929026 * `ADS`.`Feature_19` + -0.1686011239217934 * `ADS`.`Feature_20` + -0.24972404600262998 * `ADS`.`Feature_21` + -0.1633779485175148 * `ADS`.`Feature_22` + -0.05510776621963619 * `ADS`.`Feature_23` + -0.19629208790896283 * `ADS`.`Feature_24` + 0.10354628854143838 * `ADS`.`Feature_25` + -0.00753637557045776 * `ADS`.`Feature_26` + -0.16747681781510668 * `ADS`.`Feature_27` + -0.013910139695627015 * `ADS`.`Feature_28` + -0.09538320302861365 * `ADS`.`Feature_29` + -0.16792193618825257 * `ADS`.`Feature_30` + 0.0879352075733654 * `ADS`.`Feature_31` + 0.37465589522671155 * `ADS`.`Feature_32` + -0.19369805211439564 * `ADS`.`Feature_33` + -0.15009026261541605 * `ADS`.`Feature_34` + 0.09448903362112825 * `ADS`.`Feature_35` + 0.08339315492899069 * `ADS`.`Feature_36` + -0.269930325315306 * `ADS`.`Feature_37` + 0.40245029946018374 * `ADS`.`Feature_38` + -0.26176009437175984 * `ADS`.`Feature_39` + -0.3149738357157331 * `ADS`.`Feature_40` + -0.049916460007521854 * `ADS`.`Feature_41` + -0.14284046925897675 * `ADS`.`Feature_42` + -0.06199637999940112 * `ADS`.`Feature_43` + -0.007345457992126621 * `ADS`.`Feature_44` + -0.11866542356496698 * `ADS`.`Feature_45` + -0.08989255666675647 * `ADS`.`Feature_46` + -0.23586031113639097 * `ADS`.`Feature_47` + -0.1823003377455749 * `ADS`.`Feature_48` + 0.0884792767827592 * `ADS`.`Feature_49` + -0.008761478959748797 * `ADS`.`Feature_50` + -0.043915116318606257 * `ADS`.`Feature_51` + 0.2904941118306671 * `ADS`.`Feature_52` + 0.1798957480006685 * `ADS`.`Feature_53` + 0.2151535367316249 * `ADS`.`Feature_54` + -0.04284773896399704 * `ADS`.`Feature_55` + -0.3556054213113854 * `ADS`.`Feature_56` + -0.3251727169245537 * `ADS`.`Feature_57` + 0.04618607645012514 * `ADS`.`Feature_58` + 0.001975650841481449 * `ADS`.`Feature_59` + 0.09348739932023552 * `ADS`.`Feature_60` + 0.1367847489898466 * `ADS`.`Feature_61` + -0.1882496707974207 * `ADS`.`Feature_62` + 0.5408243919117159 * `ADS`.`Feature_63` + 0.14054674830321937 * `ADS`.`Feature_64` + -0.08395882389370528 * `ADS`.`Feature_65` + -0.14342396802416243 * `ADS`.`Feature_66` + -0.11067701639430846 * `ADS`.`Feature_67` + 0.1493642419374975 * `ADS`.`Feature_68` + -0.3103284001211015 * `ADS`.`Feature_69` + -0.22239650796885582 * `ADS`.`Feature_70` + 0.10346717385695457 * `ADS`.`Feature_71` + -0.31515715200481814 * `ADS`.`Feature_72` + -0.034303197072165253 * `ADS`.`Feature_73` + 0.15919423856471338 * `ADS`.`Feature_74` + -0.07500262981202466 * `ADS`.`Feature_75` + -0.013279131346533884 * `ADS`.`Feature_76` + -0.006269065019811211 * `ADS`.`Feature_77` + -0.17402918706574644 * `ADS`.`Feature_78` + 0.05629120564790028 * `ADS`.`Feature_79` + -0.2625435369506584 * `ADS`.`Feature_80` + -0.43160536107306985 * `ADS`.`Feature_81` + 0.2922426259496896 * `ADS`.`Feature_82` + 0.005574805916197755 * `ADS`.`Feature_83` + -0.19069393376939534 * `ADS`.`Feature_84` + 0.02235579415692807 * `ADS`.`Feature_85` + -0.3817542209532492 * `ADS`.`Feature_86` + -0.2008502142317559 * `ADS`.`Feature_87` + -0.28211695976085327 * `ADS`.`Feature_88` + -0.05568371588592903 * `ADS`.`Feature_89` + -0.09291569692068453 * `ADS`.`Feature_90` + -0.1277026335212363 * `ADS`.`Feature_91` + 0.181426859495732 * `ADS`.`Feature_92` + -0.03067265040741374 * `ADS`.`Feature_93` + -0.03520350613875458 * `ADS`.`Feature_94` + -0.20432473908565496 * `ADS`.`Feature_95` + 0.05511038772528289 * `ADS`.`Feature_96` + -0.2368357213860163 * `ADS`.`Feature_97` + 0.30723022304849273 * `ADS`.`Feature_98` + 0.15678094710652887 * `ADS`.`Feature_99` + -0.529884968835 AS `Score_0`, 0.12255130904575844 * `ADS`.`Feature_0` + 0.2320245132361681 * `ADS`.`Feature_1` + 0.17683279776299246 * `ADS`.`Feature_2` + -0.009436964688612194 * `ADS`.`Feature_3` + 0.1586975446477966 * `ADS`.`Feature_4` + -0.01203128090358588 * `ADS`.`Feature_5` + 0.4156125097738209 * `ADS`.`Feature_6` + 0.27595862701562673 * `ADS`.`Feature_7` + 0.10497749435737662 * `ADS`.`Feature_8` + -0.06359729783741115 * `ADS`.`Feature_9` + -0.310044645051919 * `ADS`.`Feature_10` + -0.1233058514931182 * `ADS`.`Feature_11` + -0.17779895416362929 * `ADS`.`Feature_12` + -0.039970702815968456 * `ADS`.`Feature_13` + 0.16261947249329392 * `ADS`.`Feature_14` + -0.23336974627854593 * `ADS`.`Feature_15` + 0.1914224041075878 * `ADS`.`Feature_16` + 0.32838421716421884 * `ADS`.`Feature_17` + -0.017847382546194963 * `ADS`.`Feature_18` + 0.08961928607036201 * `ADS`.`Feature_19` + 0.26458455315150886 * `ADS`.`Feature_20` + 0.6222251725765764 * `ADS`.`Feature_21` + 0.37581768901394996 * `ADS`.`Feature_22` + -0.37636497259829355 * `ADS`.`Feature_23` + -0.058712182362887194 * `ADS`.`Feature_24` + -0.0901213176432569 * `ADS`.`Feature_25` + 0.2669802427803129 * `ADS`.`Feature_26` + 0.14449965270429907 * `ADS`.`Feature_27` + 0.0932572149381486 * `ADS`.`Feature_28` + -0.09378458288704254 * `ADS`.`Feature_29` + 0.015514307540440319 * `ADS`.`Feature_30` + 0.12056623578580214 * `ADS`.`Feature_31` + -0.1341377455339806 * `ADS`.`Feature_32` + 0.22211204448970334 * `ADS`.`Feature_33` + 0.06993883228225022 * `ADS`.`Feature_34` + -0.09476756026622285 * `ADS`.`Feature_35` + 0.17360004272902718 * `ADS`.`Feature_36` + 0.3011904183429089 * `ADS`.`Feature_37` + 0.02995606206106769 * `ADS`.`Feature_38` + 0.17693356729844187 * `ADS`.`Feature_39` + 0.3928298864188373 * `ADS`.`Feature_40` + 0.18776410312487998 * `ADS`.`Feature_41` + -0.019705770724146438 * `ADS`.`Feature_42` + -0.14006478010171775 * `ADS`.`Feature_43` + -0.30413281549536963 * `ADS`.`Feature_44` + 0.2380839223622257 * `ADS`.`Feature_45` + -0.15246773555817475 * `ADS`.`Feature_46` + -0.08487482905498124 * `ADS`.`Feature_47` + 0.166732868415064 * `ADS`.`Feature_48` + 0.07014642126278835 * `ADS`.`Feature_49` + 0.07807880224147287 * `ADS`.`Feature_50` + -0.15447414965278805 * `ADS`.`Feature_51` + 0.19049608059893516 * `ADS`.`Feature_52` + -0.09511848330497565 * `ADS`.`Feature_53` + -0.09890780109223064 * `ADS`.`Feature_54` + 0.2409066823742096 * `ADS`.`Feature_55` + -0.04563175141378182 * `ADS`.`Feature_56` + 0.22370958409996827 * `ADS`.`Feature_57` + -0.15850743985628218 * `ADS`.`Feature_58` + 0.05453663990963352 * `ADS`.`Feature_59` + 0.06760461974326237 * `ADS`.`Feature_60` + -0.2881299053867701 * `ADS`.`Feature_61` + 0.0640104824568533 * `ADS`.`Feature_62` + 0.037616455439726665 * `ADS`.`Feature_63` + 0.03585150211774648 * `ADS`.`Feature_64` + 0.07853432678248116 * `ADS`.`Feature_65` + -0.07975196978836545 * `ADS`.`Feature_66` + -0.00849027270250693 * `ADS`.`Feature_67` + 0.0867929147919935 * `ADS`.`Feature_68` + -0.012059604104282546 * `ADS`.`Feature_69` + -0.14173063535539607 * `ADS`.`Feature_70` + -0.09523775977988506 * `ADS`.`Feature_71` + -0.3731457746795844 * `ADS`.`Feature_72` + -0.21268401084729616 * `ADS`.`Feature_73` + 0.017963945611228185 * `ADS`.`Feature_74` + 0.22810323518834316 * `ADS`.`Feature_75` + 0.08023870464544798 * `ADS`.`Feature_76` + 0.040703935845695115 * `ADS`.`Feature_77` + 0.2902200448524799 * `ADS`.`Feature_78` + 0.09531983041620543 * `ADS`.`Feature_79` + 0.031266411809244846 * `ADS`.`Feature_80` + 0.3576819343602253 * `ADS`.`Feature_81` + -0.055675550287303525 * `ADS`.`Feature_82` + -0.4668164986136851 * `ADS`.`Feature_83` + -0.13813741717434558 * `ADS`.`Feature_84` + 0.037727388904965735 * `ADS`.`Feature_85` + 0.48041549640766673 * `ADS`.`Feature_86` + -0.05331911606183621 * `ADS`.`Feature_87` + 0.37699171833641837 * `ADS`.`Feature_88` + 0.020939501119885847 * `ADS`.`Feature_89` + 0.02134057535702112 * `ADS`.`Feature_90` + 0.3722769182026452 * `ADS`.`Feature_91` + 0.05257280128573341 * `ADS`.`Feature_92` + -0.3638564027419869 * `ADS`.`Feature_93` + -0.046529875511741356 * `ADS`.`Feature_94` + -0.09597420556846767 * `ADS`.`Feature_95` + -0.06478559905232709 * `ADS`.`Feature_96` + -0.28059461854711537 * `ADS`.`Feature_97` + 0.31416303988123784 * `ADS`.`Feature_98` + 0.004072553412872684 * `ADS`.`Feature_99` + -0.437273153806 AS `Score_1`, -0.25590873949775605 * `ADS`.`Feature_0` + 0.001150674176286296 * `ADS`.`Feature_1` + 0.1323129558421919 * `ADS`.`Feature_2` + 0.3829317279866732 * `ADS`.`Feature_3` + -0.14259174827107243 * `ADS`.`Feature_4` + -0.05926736819388642 * `ADS`.`Feature_5` + -0.2684984002696471 * `ADS`.`Feature_6` + -0.09494142127970892 * `ADS`.`Feature_7` + -0.03791970450116068 * `ADS`.`Feature_8` + -0.35993818775612446 * `ADS`.`Feature_9` + -0.026612900650061066 * `ADS`.`Feature_10` + -0.2185423781442584 * `ADS`.`Feature_11` + 0.02614230582257618 * `ADS`.`Feature_12` + -0.18281552080387056 * `ADS`.`Feature_13` + -0.13147136012247132 * `ADS`.`Feature_14` + 0.3424894974673197 * `ADS`.`Feature_15` + -0.006818665903371999 * `ADS`.`Feature_16` + -0.019851912734865716 * `ADS`.`Feature_17` + 0.05254909540118799 * `ADS`.`Feature_18` + 0.15214567634359036 * `ADS`.`Feature_19` + 0.30917092232933197 * `ADS`.`Feature_20` + -0.41277938583704493 * `ADS`.`Feature_21` + 0.15580051634710793 * `ADS`.`Feature_22` + -0.3615069890571384 * `ADS`.`Feature_23` + -0.04539454818585064 * `ADS`.`Feature_24` + 0.18577408384085026 * `ADS`.`Feature_25` + 0.3955215669269924 * `ADS`.`Feature_26` + -0.32698580894741486 * `ADS`.`Feature_27` + 0.025340101433328655 * `ADS`.`Feature_28` + -0.19233486906879052 * `ADS`.`Feature_29` + -0.02185892974679062 * `ADS`.`Feature_30` + -0.46107486182111534 * `ADS`.`Feature_31` + 0.3103407726369949 * `ADS`.`Feature_32` + 0.12245412285696038 * `ADS`.`Feature_33` + -0.10356934392219809 * `ADS`.`Feature_34` + -0.13511917054527586 * `ADS`.`Feature_35` + 0.26896223813966547 * `ADS`.`Feature_36` + -0.08274910964127748 * `ADS`.`Feature_37` + -0.08012610090672354 * `ADS`.`Feature_38` + -0.21566086412964627 * `ADS`.`Feature_39` + -0.05577030592755279 * `ADS`.`Feature_40` + -0.05727755018595808 * `ADS`.`Feature_41` + -0.17919214150108578 * `ADS`.`Feature_42` + 0.1919401026365185 * `ADS`.`Feature_43` + 0.21168829563235897 * `ADS`.`Feature_44` + 0.08882308169287166 * `ADS`.`Feature_45` + 0.27865123137942766 * `ADS`.`Feature_46` + 0.025645069906964735 * `ADS`.`Feature_47` + -0.015242198538805842 * `ADS`.`Feature_48` + -0.12384615017364742 * `ADS`.`Feature_49` + 0.07333371554534887 * `ADS`.`Feature_50` + -0.00490978449943204 * `ADS`.`Feature_51` + -0.07642530838011649 * `ADS`.`Feature_52` + -0.12261312360162398 * `ADS`.`Feature_53` + 0.10730262172167684 * `ADS`.`Feature_54` + 0.3929571668801894 * `ADS`.`Feature_55` + 0.10207117014136136 * `ADS`.`Feature_56` + -0.021345859371968888 * `ADS`.`Feature_57` + 0.08792365797865959 * `ADS`.`Feature_58` + -0.06860097999342415 * `ADS`.`Feature_59` + 0.28336635525756015 * `ADS`.`Feature_60` + 0.14923181159789095 * `ADS`.`Feature_61` + 0.06605323664039392 * `ADS`.`Feature_62` + -0.3068198635538485 * `ADS`.`Feature_63` + 0.0754079889867805 * `ADS`.`Feature_64` + -0.33331374439574235 * `ADS`.`Feature_65` + -0.33415381110023573 * `ADS`.`Feature_66` + -0.3603060335911106 * `ADS`.`Feature_67` + 0.08727551142597385 * `ADS`.`Feature_68` + -0.27109464473356093 * `ADS`.`Feature_69` + 0.28417396097447223 * `ADS`.`Feature_70` + -0.22544519641971397 * `ADS`.`Feature_71` + 0.09819806160399053 * `ADS`.`Feature_72` + 0.0749357986666722 * `ADS`.`Feature_73` + -0.012211896338530401 * `ADS`.`Feature_74` + -0.15798699840827318 * `ADS`.`Feature_75` + -0.1364269781486203 * `ADS`.`Feature_76` + 0.0074035615737544965 * `ADS`.`Feature_77` + -0.08147262413833228 * `ADS`.`Feature_78` + 0.1125113274849578 * `ADS`.`Feature_79` + -0.033938706844587184 * `ADS`.`Feature_80` + -0.07761622738041701 * `ADS`.`Feature_81` + -0.1693282416592355 * `ADS`.`Feature_82` + -0.0857934483203582 * `ADS`.`Feature_83` + 0.2498865750214941 * `ADS`.`Feature_84` + 0.14348476499712093 * `ADS`.`Feature_85` + -0.09202789339144421 * `ADS`.`Feature_86` + 0.13074431619984692 * `ADS`.`Feature_87` + 0.1574772082603455 * `ADS`.`Feature_88` + 0.19737031798478402 * `ADS`.`Feature_89` + 0.07147538516842829 * `ADS`.`Feature_90` + 0.01101416973101576 * `ADS`.`Feature_91` + -0.07227830269454984 * `ADS`.`Feature_92` + -0.4796427886626124 * `ADS`.`Feature_93` + -0.5355164486833967 * `ADS`.`Feature_94` + -0.045270023016925134 * `ADS`.`Feature_95` + -0.23591094679742658 * `ADS`.`Feature_96` + -0.04531065535891789 * `ADS`.`Feature_97` + -0.16110467056566957 * `ADS`.`Feature_98` + -0.024427629770951264 * `ADS`.`Feature_99` + -0.970262574157 AS `Score_2`, -0.10954454412850458 * `ADS`.`Feature_0` + -0.15584629308979178 * `ADS`.`Feature_1` + 0.07387498424175283 * `ADS`.`Feature_2` + -0.0481156292318136 * `ADS`.`Feature_3` + 0.09369239008727116 * `ADS`.`Feature_4` + 0.1900227765124841 * `ADS`.`Feature_5` + 0.31669204471329004 * `ADS`.`Feature_6` + 0.12235512521513509 * `ADS`.`Feature_7` + -0.07325372592528383 * `ADS`.`Feature_8` + 0.019760759573082563 * `ADS`.`Feature_9` + 0.37513789544311615 * `ADS`.`Feature_10` + 0.22563595637277403 * `ADS`.`Feature_11` + -0.3513164445490938 * `ADS`.`Feature_12` + 0.35525256881672285 * `ADS`.`Feature_13` + 0.026697721413530367 * `ADS`.`Feature_14` + 0.19313260280355224 * `ADS`.`Feature_15` + 0.013093642572960794 * `ADS`.`Feature_16` + -0.09770422022745737 * `ADS`.`Feature_17` + 0.17963837339034136 * `ADS`.`Feature_18` + -0.15484695814533272 * `ADS`.`Feature_19` + 0.0484539401244701 * `ADS`.`Feature_20` + -0.2556375826296425 * `ADS`.`Feature_21` + -0.02964987449938748 * `ADS`.`Feature_22` + 0.0060187049915189144 * `ADS`.`Feature_23` + 0.21002590644092736 * `ADS`.`Feature_24` + 0.17565447951794597 * `ADS`.`Feature_25` + -0.1579285296433537 * `ADS`.`Feature_26` + -0.15262761132554498 * `ADS`.`Feature_27` + 0.004500339306338181 * `ADS`.`Feature_28` + -0.0865954306759526 * `ADS`.`Feature_29` + -0.05513514428550995 * `ADS`.`Feature_30` + -0.12856515449242958 * `ADS`.`Feature_31` + 0.3247016403183079 * `ADS`.`Feature_32` + -0.12149535293098257 * `ADS`.`Feature_33` + 0.03816950335546275 * `ADS`.`Feature_34` + 0.16609111973372484 * `ADS`.`Feature_35` + -0.1391074718229322 * `ADS`.`Feature_36` + 0.10930041039109226 * `ADS`.`Feature_37` + 0.018747771291010303 * `ADS`.`Feature_38` + -0.04580969831356798 * `ADS`.`Feature_39` + -0.32756112724769054 * `ADS`.`Feature_40` + 0.033508022664655746 * `ADS`.`Feature_41` + -0.17896170219318105 * `ADS`.`Feature_42` + -0.15032413756460591 * `ADS`.`Feature_43` + 0.07574128368263397 * `ADS`.`Feature_44` + 0.18783532472243494 * `ADS`.`Feature_45` + 0.013326563474300564 * `ADS`.`Feature_46` + 0.2178133768726378 * `ADS`.`Feature_47` + -0.25601272683904336 * `ADS`.`Feature_48` + 0.0670389404466355 * `ADS`.`Feature_49` + 0.043688595022956925 * `ADS`.`Feature_50` + -0.00085989603114271 * `ADS`.`Feature_51` + -0.11965624557910245 * `ADS`.`Feature_52` + -0.05712620822510086 * `ADS`.`Feature_53` + 0.006668794159772009 * `ADS`.`Feature_54` + 0.03296035681375414 * `ADS`.`Feature_55` + 0.1824119863096267 * `ADS`.`Feature_56` + -0.28484149840544876 * `ADS`.`Feature_57` + 0.2509396605355456 * `ADS`.`Feature_58` + 0.11486656786039995 * `ADS`.`Feature_59` + 0.04534973432331489 * `ADS`.`Feature_60` + 0.05723792926463213 * `ADS`.`Feature_61` + -0.03316859898532614 * `ADS`.`Feature_62` + -0.39068780070363945 * `ADS`.`Feature_63` + -0.11808263112750805 * `ADS`.`Feature_64` + -0.010940161631743458 * `ADS`.`Feature_65` + -0.06679281214524924 * `ADS`.`Feature_66` + 0.2786484689641461 * `ADS`.`Feature_67` + 0.02655982099876567 * `ADS`.`Feature_68` + -0.507895745956189 * `ADS`.`Feature_69` + 0.019780702599789375 * `ADS`.`Feature_70` + 0.002907667921537804 * `ADS`.`Feature_71` + 0.11104733886213593 * `ADS`.`Feature_72` + 0.09064847643261739 * `ADS`.`Feature_73` + -0.052719435383952476 * `ADS`.`Feature_74` + -0.009356178817684566 * `ADS`.`Feature_75` + 0.005572164838621382 * `ADS`.`Feature_76` + -0.10341445710138553 * `ADS`.`Feature_77` + 0.006560839448885863 * `ADS`.`Feature_78` + -0.08178295609202994 * `ADS`.`Feature_79` + -0.048153458103584394 * `ADS`.`Feature_80` + -0.04601704170244642 * `ADS`.`Feature_81` + -0.04012197093647242 * `ADS`.`Feature_82` + 0.1465295408489743 * `ADS`.`Feature_83` + 0.27459800403971957 * `ADS`.`Feature_84` + 0.05666383022258281 * `ADS`.`Feature_85` + -0.07832457849196045 * `ADS`.`Feature_86` + -0.048530826916365004 * `ADS`.`Feature_87` + 0.2560857158456991 * `ADS`.`Feature_88` + -0.060496533820520636 * `ADS`.`Feature_89` + 0.13666309441726388 * `ADS`.`Feature_90` + -0.07324959521089318 * `ADS`.`Feature_91` + -0.07963833693254366 * `ADS`.`Feature_92` + 0.28672231987972324 * `ADS`.`Feature_93` + 0.01648483025621938 * `ADS`.`Feature_94` + 0.21953783555765388 * `ADS`.`Feature_95` + 0.0634878977615591 * `ADS`.`Feature_96` + -0.2201732620543854 * `ADS`.`Feature_97` + 0.09301692563536614 * `ADS`.`Feature_98` + 0.2241530167579247 * `ADS`.`Feature_99` + -0.29054507258 AS `Score_3` 
FROM `FourClass_100` AS `ADS`), 
orig_cte AS 
(SELECT linear_model_cte.`KEY` AS `KEY`, linear_model_cte.`Score_0` AS `Score_0`, linear_model_cte.`Score_1` AS `Score_1`, linear_model_cte.`Score_2` AS `Score_2`, linear_model_cte.`Score_3` AS `Score_3`, (1.0 / (1.0 + exp(-linear_model_cte.`Score_0`))) / (1.0 / (1.0 + exp(-linear_model_cte.`Score_0`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_1`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_2`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_3`))) AS `Proba_0`, (1.0 / (1.0 + exp(-linear_model_cte.`Score_1`))) / (1.0 / (1.0 + exp(-linear_model_cte.`Score_0`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_1`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_2`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_3`))) AS `Proba_1`, (1.0 / (1.0 + exp(-linear_model_cte.`Score_2`))) / (1.0 / (1.0 + exp(-linear_model_cte.`Score_0`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_1`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_2`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_3`))) AS `Proba_2`, (1.0 / (1.0 + exp(-linear_model_cte.`Score_3`))) / (1.0 / (1.0 + exp(-linear_model_cte.`Score_0`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_1`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_2`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_3`))) AS `Proba_3`, NULL AS `LogProba_0`, NULL AS `LogProba_1`, NULL AS `LogProba_2`, NULL AS `LogProba_3`, NULL AS `Decision` 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu.`KEY` AS `KEY`, scu.class AS class, scu.`LogProba` AS `LogProba`, scu.`Proba` AS `Proba`, scu.`Score` AS `Score` 
FROM (SELECT orig_cte.`KEY` AS `KEY`, 0 AS class, orig_cte.`LogProba_0` AS `LogProba`, orig_cte.`Proba_0` AS `Proba`, orig_cte.`Score_0` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY`, 1 AS class, orig_cte.`LogProba_1` AS `LogProba`, orig_cte.`Proba_1` AS `Proba`, orig_cte.`Score_1` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY`, 2 AS class, orig_cte.`LogProba_2` AS `LogProba`, orig_cte.`Proba_2` AS `Proba`, orig_cte.`Score_2` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY`, 3 AS class, orig_cte.`LogProba_3` AS `LogProba`, orig_cte.`Proba_3` AS `Proba`, orig_cte.`Score_3` AS `Score` 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.`KEY` AS `KEY`, orig_cte.`Score_0` AS `Score_0`, orig_cte.`Score_1` AS `Score_1`, orig_cte.`Score_2` AS `Score_2`, orig_cte.`Score_3` AS `Score_3`, orig_cte.`Proba_0` AS `Proba_0`, orig_cte.`Proba_1` AS `Proba_1`, orig_cte.`Proba_2` AS `Proba_2`, orig_cte.`Proba_3` AS `Proba_3`, orig_cte.`LogProba_0` AS `LogProba_0`, orig_cte.`LogProba_1` AS `LogProba_1`, orig_cte.`LogProba_2` AS `LogProba_2`, orig_cte.`LogProba_3` AS `LogProba_3`, orig_cte.`Decision` AS `Decision`, (SELECT max(score_class_union.`LogProba`) AS max_1 
FROM score_class_union 
WHERE orig_cte.`KEY` = score_class_union.`KEY`) AS `max_LogProba`, (SELECT max(score_class_union.`Proba`) AS max_2 
FROM score_class_union 
WHERE orig_cte.`KEY` = score_class_union.`KEY`) AS `max_Proba`, (SELECT max(score_class_union.`Score`) AS max_3 
FROM score_class_union 
WHERE orig_cte.`KEY` = score_class_union.`KEY`) AS `max_Score` 
FROM orig_cte), 
arg_max_cte AS 
(SELECT score_max.`KEY` AS `KEY`, score_max.`Score_0` AS `Score_0`, score_max.`Score_1` AS `Score_1`, score_max.`Score_2` AS `Score_2`, score_max.`Score_3` AS `Score_3`, score_max.`Proba_0` AS `Proba_0`, score_max.`Proba_1` AS `Proba_1`, score_max.`Proba_2` AS `Proba_2`, score_max.`Proba_3` AS `Proba_3`, score_max.`LogProba_0` AS `LogProba_0`, score_max.`LogProba_1` AS `LogProba_1`, score_max.`LogProba_2` AS `LogProba_2`, score_max.`LogProba_3` AS `LogProba_3`, score_max.`Decision` AS `Decision`, score_max.`max_LogProba` AS `max_LogProba`, score_max.`max_Proba` AS `max_Proba`, score_max.`max_Score` AS `max_Score`, (SELECT min(score_class_union.class) AS min_1 
FROM score_class_union 
WHERE score_max.`max_LogProba` = score_class_union.`LogProba` AND score_max.`KEY` = score_class_union.`KEY`) AS `arg_max_LogProba`, (SELECT min(score_class_union.class) AS min_2 
FROM score_class_union 
WHERE score_max.`max_Proba` = score_class_union.`Proba` AND score_max.`KEY` = score_class_union.`KEY`) AS `arg_max_Proba`, (SELECT min(score_class_union.class) AS min_3 
FROM score_class_union 
WHERE score_max.`max_Score` = score_class_union.`Score` AND score_max.`KEY` = score_class_union.`KEY`) AS `arg_max_Score` 
FROM score_max)
 SELECT arg_max_cte.`KEY` AS `KEY`, arg_max_cte.`Score_0` AS `Score_0`, arg_max_cte.`Score_1` AS `Score_1`, arg_max_cte.`Score_2` AS `Score_2`, arg_max_cte.`Score_3` AS `Score_3`, arg_max_cte.`Proba_0` AS `Proba_0`, arg_max_cte.`Proba_1` AS `Proba_1`, arg_max_cte.`Proba_2` AS `Proba_2`, arg_max_cte.`Proba_3` AS `Proba_3`, CASE WHEN (arg_max_cte.`Proba_0` IS NULL OR arg_max_cte.`Proba_0` > 0.0) THEN ln(arg_max_cte.`Proba_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (arg_max_cte.`Proba_1` IS NULL OR arg_max_cte.`Proba_1` > 0.0) THEN ln(arg_max_cte.`Proba_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (arg_max_cte.`Proba_2` IS NULL OR arg_max_cte.`Proba_2` > 0.0) THEN ln(arg_max_cte.`Proba_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, CASE WHEN (arg_max_cte.`Proba_3` IS NULL OR arg_max_cte.`Proba_3` > 0.0) THEN ln(arg_max_cte.`Proba_3`) ELSE -1.79769313486231e+308 END AS `LogProba_3`, arg_max_cte.`arg_max_Score` AS `Decision` 
FROM arg_max_cte