-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH linear_model_cte AS 
(SELECT `ADS`.`KEY` AS `KEY`, 0.14705337131701973 * `ADS`.`Feature_0` + 0.05191059715046481 * `ADS`.`Feature_1` + 0.08407022627676189 * `ADS`.`Feature_2` + 0.016154818840257167 * `ADS`.`Feature_3` + -0.04975106346173618 * `ADS`.`Feature_4` + -0.01847865853479762 * `ADS`.`Feature_5` + 0.10589841605388127 * `ADS`.`Feature_6` + -0.0009167133456854876 * `ADS`.`Feature_7` + 0.08940511678722161 * `ADS`.`Feature_8` + -0.0365557258401742 * `ADS`.`Feature_9` + 0.1005425264207251 * `ADS`.`Feature_10` + 0.03339452905550012 * `ADS`.`Feature_11` + -0.06533116272008849 * `ADS`.`Feature_12` + 0.012316815862903834 * `ADS`.`Feature_13` + 0.014581751838753626 * `ADS`.`Feature_14` + 0.0179568574766165 * `ADS`.`Feature_15` + -0.0366521671933915 * `ADS`.`Feature_16` + -0.011959596799710048 * `ADS`.`Feature_17` + -0.03687154659619126 * `ADS`.`Feature_18` + -0.03969343244508479 * `ADS`.`Feature_19` + 0.003942999301194176 * `ADS`.`Feature_20` + 0.05435579287932909 * `ADS`.`Feature_21` + -0.009797398309806629 * `ADS`.`Feature_22` + 0.04824131998157726 * `ADS`.`Feature_23` + 0.0004544579976632525 * `ADS`.`Feature_24` + 0.043878767569865904 * `ADS`.`Feature_25` + 0.014841578251355184 * `ADS`.`Feature_26` + -0.11286702085533189 * `ADS`.`Feature_27` + 0.06135067847358042 * `ADS`.`Feature_28` + 0.03543091489404344 * `ADS`.`Feature_29` + -0.036665944767959154 * `ADS`.`Feature_30` + -0.03410654084406368 * `ADS`.`Feature_31` + 0.021238963682978947 * `ADS`.`Feature_32` + -0.004267556984885135 * `ADS`.`Feature_33` + -0.020907638791616855 * `ADS`.`Feature_34` + 0.022859358577539738 * `ADS`.`Feature_35` + -0.00374664176077271 * `ADS`.`Feature_36` + -0.06096929336447818 * `ADS`.`Feature_37` + -0.0359835578746395 * `ADS`.`Feature_38` + 0.06224481274801753 * `ADS`.`Feature_39` + 0.0658330995839937 * `ADS`.`Feature_40` + 0.04546900932015444 * `ADS`.`Feature_41` + 0.009684826664242353 * `ADS`.`Feature_42` + -0.045923188418566435 * `ADS`.`Feature_43` + 0.06128981151318666 * `ADS`.`Feature_44` + 0.018183693050046634 * `ADS`.`Feature_45` + -0.0009332832102269622 * `ADS`.`Feature_46` + -0.039012547440618696 * `ADS`.`Feature_47` + -0.0006710191712708466 * `ADS`.`Feature_48` + 0.029130856920112233 * `ADS`.`Feature_49` + -0.0116553859268076 * `ADS`.`Feature_50` + -0.029503634561525504 * `ADS`.`Feature_51` + 0.06024065802535829 * `ADS`.`Feature_52` + 0.062357409313214575 * `ADS`.`Feature_53` + 0.02043070693829748 * `ADS`.`Feature_54` + 0.10515784857481347 * `ADS`.`Feature_55` + -0.004766910086160754 * `ADS`.`Feature_56` + 0.011851382003119193 * `ADS`.`Feature_57` + -0.06179662234025611 * `ADS`.`Feature_58` + 0.01779236760900169 * `ADS`.`Feature_59` + -0.05779750239834464 * `ADS`.`Feature_60` + -0.009738412818159684 * `ADS`.`Feature_61` + -0.015443941112414122 * `ADS`.`Feature_62` + 0.04894284573597186 * `ADS`.`Feature_63` + -0.005199357126498841 * `ADS`.`Feature_64` + -0.02678887422909083 * `ADS`.`Feature_65` + -0.0060185975543599925 * `ADS`.`Feature_66` + -0.03902603028306443 * `ADS`.`Feature_67` + -0.022498619850388573 * `ADS`.`Feature_68` + -0.0089852541669914 * `ADS`.`Feature_69` + -0.054274073388056385 * `ADS`.`Feature_70` + 0.02400164778956794 * `ADS`.`Feature_71` + -0.10258077344465773 * `ADS`.`Feature_72` + -0.04808550007369854 * `ADS`.`Feature_73` + 0.03201714853155159 * `ADS`.`Feature_74` + 0.006293847538687345 * `ADS`.`Feature_75` + 0.040308554740210334 * `ADS`.`Feature_76` + -0.06274924134995614 * `ADS`.`Feature_77` + 0.03848361281965264 * `ADS`.`Feature_78` + -0.02457505367091302 * `ADS`.`Feature_79` + -0.05605698207466523 * `ADS`.`Feature_80` + -0.03520262430214949 * `ADS`.`Feature_81` + -0.029266501641134708 * `ADS`.`Feature_82` + 0.0012545923498773516 * `ADS`.`Feature_83` + 0.061071098540769114 * `ADS`.`Feature_84` + 0.015736361918198986 * `ADS`.`Feature_85` + 0.06859940718242914 * `ADS`.`Feature_86` + -0.013568685494242071 * `ADS`.`Feature_87` + -0.04244984971318948 * `ADS`.`Feature_88` + -0.0726495148822128 * `ADS`.`Feature_89` + 0.03784715801524836 * `ADS`.`Feature_90` + -0.04663895605228008 * `ADS`.`Feature_91` + 0.03490157297539384 * `ADS`.`Feature_92` + -0.050536482966987664 * `ADS`.`Feature_93` + -0.04832482592930133 * `ADS`.`Feature_94` + 0.013755316505683849 * `ADS`.`Feature_95` + 0.003831903458555299 * `ADS`.`Feature_96` + -0.033546251971326144 * `ADS`.`Feature_97` + 0.002543213653964944 * `ADS`.`Feature_98` + 0.035094180755426856 * `ADS`.`Feature_99` + -0.757172448876 AS `Score_0`, -0.08685395646460206 * `ADS`.`Feature_0` + -0.11548149609660749 * `ADS`.`Feature_1` + 0.009750553499353292 * `ADS`.`Feature_2` + -0.03161997619890737 * `ADS`.`Feature_3` + 0.03381007623310359 * `ADS`.`Feature_4` + 0.14326470834558702 * `ADS`.`Feature_5` + 0.04602222191979258 * `ADS`.`Feature_6` + -0.061490437834529614 * `ADS`.`Feature_7` + -0.07084341038296334 * `ADS`.`Feature_8` + 0.03696853790840897 * `ADS`.`Feature_9` + 0.017462007886077685 * `ADS`.`Feature_10` + -0.03303653017027347 * `ADS`.`Feature_11` + 0.04350663398479604 * `ADS`.`Feature_12` + -0.04314094952980003 * `ADS`.`Feature_13` + 0.007992840439118831 * `ADS`.`Feature_14` + 0.1345255868723319 * `ADS`.`Feature_15` + 0.04265488125448628 * `ADS`.`Feature_16` + 0.0660410269942595 * `ADS`.`Feature_17` + -0.10699638228105893 * `ADS`.`Feature_18` + 0.11615098793526271 * `ADS`.`Feature_19` + 0.01014045203385509 * `ADS`.`Feature_20` + -0.045528197375217905 * `ADS`.`Feature_21` + -0.08238190467830463 * `ADS`.`Feature_22` + -0.004071499154090684 * `ADS`.`Feature_23` + -0.027498759782023752 * `ADS`.`Feature_24` + 0.01881546665673746 * `ADS`.`Feature_25` + 0.03851533680306239 * `ADS`.`Feature_26` + 0.08898108129399585 * `ADS`.`Feature_27` + -0.0013381469825141283 * `ADS`.`Feature_28` + 0.07129503609630373 * `ADS`.`Feature_29` + 0.03458067903249406 * `ADS`.`Feature_30` + 0.09387023489884931 * `ADS`.`Feature_31` + -0.04429728182568985 * `ADS`.`Feature_32` + -0.009226230135308643 * `ADS`.`Feature_33` + -0.01778815295931889 * `ADS`.`Feature_34` + 0.08258800559092389 * `ADS`.`Feature_35` + 0.08236606753460643 * `ADS`.`Feature_36` + 0.09003798524639832 * `ADS`.`Feature_37` + -0.06862391161967714 * `ADS`.`Feature_38` + -0.09874068750476722 * `ADS`.`Feature_39` + 0.05970014632466408 * `ADS`.`Feature_40` + -0.03363981939939622 * `ADS`.`Feature_41` + -0.07514696375462022 * `ADS`.`Feature_42` + -0.005604404364667432 * `ADS`.`Feature_43` + -0.034139019570130706 * `ADS`.`Feature_44` + -0.04110239241658638 * `ADS`.`Feature_45` + -0.09102992082543357 * `ADS`.`Feature_46` + 0.03648637578031737 * `ADS`.`Feature_47` + 0.018971341607795098 * `ADS`.`Feature_48` + -0.02832674907020873 * `ADS`.`Feature_49` + -0.0014049960079589655 * `ADS`.`Feature_50` + -0.023172720875170725 * `ADS`.`Feature_51` + 0.021211302013667794 * `ADS`.`Feature_52` + 0.023299254830506877 * `ADS`.`Feature_53` + -0.06751498639114761 * `ADS`.`Feature_54` + -0.03619965621487682 * `ADS`.`Feature_55` + -0.04605638401615503 * `ADS`.`Feature_56` + 0.10964760766366617 * `ADS`.`Feature_57` + -0.01249933232514493 * `ADS`.`Feature_58` + -0.09593258553831331 * `ADS`.`Feature_59` + 0.1441320942353538 * `ADS`.`Feature_60` + -0.0033194251226694787 * `ADS`.`Feature_61` + -0.030989110897928274 * `ADS`.`Feature_62` + -0.065186941919209 * `ADS`.`Feature_63` + 0.004745423875491428 * `ADS`.`Feature_64` + 0.03599179693382779 * `ADS`.`Feature_65` + -0.06430300486245721 * `ADS`.`Feature_66` + 0.04330739664721834 * `ADS`.`Feature_67` + -0.03343133778141236 * `ADS`.`Feature_68` + -0.0375220459922059 * `ADS`.`Feature_69` + 0.04002433393775815 * `ADS`.`Feature_70` + 0.014504786879257287 * `ADS`.`Feature_71` + -0.031239263909144006 * `ADS`.`Feature_72` + -0.002099658703863338 * `ADS`.`Feature_73` + -0.015949912587256705 * `ADS`.`Feature_74` + -0.028908466121883976 * `ADS`.`Feature_75` + 0.005180309603452008 * `ADS`.`Feature_76` + -0.016452878812096047 * `ADS`.`Feature_77` + 0.026164780300402847 * `ADS`.`Feature_78` + 0.05501858492314819 * `ADS`.`Feature_79` + 0.04473574297407687 * `ADS`.`Feature_80` + 0.058537248716858746 * `ADS`.`Feature_81` + 0.0860054652920818 * `ADS`.`Feature_82` + 0.06106338638290419 * `ADS`.`Feature_83` + -0.049999627880342734 * `ADS`.`Feature_84` + 0.017022056030573905 * `ADS`.`Feature_85` + -0.08938318030686962 * `ADS`.`Feature_86` + -0.05928887764451777 * `ADS`.`Feature_87` + 0.018658107354294795 * `ADS`.`Feature_88` + -0.03406010160836148 * `ADS`.`Feature_89` + -0.049426254893574065 * `ADS`.`Feature_90` + -0.018513105600924423 * `ADS`.`Feature_91` + 0.044254035196103096 * `ADS`.`Feature_92` + 0.03926355288689305 * `ADS`.`Feature_93` + 0.12068142267429981 * `ADS`.`Feature_94` + 0.026546530995377418 * `ADS`.`Feature_95` + -0.05998344773455669 * `ADS`.`Feature_96` + 0.024800549952699896 * `ADS`.`Feature_97` + -0.053979354962040066 * `ADS`.`Feature_98` + 0.033571706971723035 * `ADS`.`Feature_99` + -0.189451392028 AS `Score_1`, -0.181664647184715 * `ADS`.`Feature_0` + -0.04016195225765919 * `ADS`.`Feature_1` + -0.09163798040725447 * `ADS`.`Feature_2` + -0.05205169892669331 * `ADS`.`Feature_3` + -0.028753538267292055 * `ADS`.`Feature_4` + -0.1466360337232918 * `ADS`.`Feature_5` + 0.005755883927354597 * `ADS`.`Feature_6` + 0.03651350474687553 * `ADS`.`Feature_7` + -0.027061731066683584 * `ADS`.`Feature_8` + -0.007130849545522483 * `ADS`.`Feature_9` + 0.1454691369046187 * `ADS`.`Feature_10` + 0.0005367214691083758 * `ADS`.`Feature_11` + 0.035209699432254236 * `ADS`.`Feature_12` + 0.054674028608325806 * `ADS`.`Feature_13` + 0.030910823573189816 * `ADS`.`Feature_14` + 0.1317439259510589 * `ADS`.`Feature_15` + -0.07798823531255482 * `ADS`.`Feature_16` + 0.04603498529119577 * `ADS`.`Feature_17` + 0.07529872317458748 * `ADS`.`Feature_18` + -0.10325596539935651 * `ADS`.`Feature_19` + -0.04532896715441855 * `ADS`.`Feature_20` + 0.009983203710463781 * `ADS`.`Feature_21` + -0.04180293199528694 * `ADS`.`Feature_22` + 0.10071368734985 * `ADS`.`Feature_23` + -0.003363074555255856 * `ADS`.`Feature_24` + 0.03481113110376345 * `ADS`.`Feature_25` + -0.04687597030012045 * `ADS`.`Feature_26` + 0.07808402683955923 * `ADS`.`Feature_27` + 0.0935508723154523 * `ADS`.`Feature_28` + 0.04181351432300427 * `ADS`.`Feature_29` + -0.03629313515394965 * `ADS`.`Feature_30` + -0.06856537962584855 * `ADS`.`Feature_31` + -0.062106706409362375 * `ADS`.`Feature_32` + 0.006620382338302422 * `ADS`.`Feature_33` + 0.0677109436595407 * `ADS`.`Feature_34` + -0.034454439782856214 * `ADS`.`Feature_35` + 0.08187762948044862 * `ADS`.`Feature_36` + 0.09796452090684492 * `ADS`.`Feature_37` + 0.06251621343265279 * `ADS`.`Feature_38` + 0.020363634136787302 * `ADS`.`Feature_39` + -0.008462145923132809 * `ADS`.`Feature_40` + -0.0011487865162378083 * `ADS`.`Feature_41` + 0.031370649977691345 * `ADS`.`Feature_42` + 0.0019102355772501476 * `ADS`.`Feature_43` + -0.09445745871610542 * `ADS`.`Feature_44` + 0.017412985872904976 * `ADS`.`Feature_45` + -0.034774551215664605 * `ADS`.`Feature_46` + -0.038139683258463154 * `ADS`.`Feature_47` + 0.027793243488798955 * `ADS`.`Feature_48` + 0.009556633001861076 * `ADS`.`Feature_49` + 0.010430511450051805 * `ADS`.`Feature_50` + 0.027037834476005107 * `ADS`.`Feature_51` + -0.03317390973766684 * `ADS`.`Feature_52` + -0.048348219459793694 * `ADS`.`Feature_53` + 0.015052265002528823 * `ADS`.`Feature_54` + -0.049709473890193374 * `ADS`.`Feature_55` + 0.06286711519685804 * `ADS`.`Feature_56` + 0.006651093836326463 * `ADS`.`Feature_57` + 0.050746640795339845 * `ADS`.`Feature_58` + -0.05779601647763813 * `ADS`.`Feature_59` + -0.04235770355631854 * `ADS`.`Feature_60` + 0.007609834230147966 * `ADS`.`Feature_61` + 0.034351258054872734 * `ADS`.`Feature_62` + -0.03439222928914736 * `ADS`.`Feature_63` + 0.016511252607559146 * `ADS`.`Feature_64` + -0.00839637362809178 * `ADS`.`Feature_65` + 0.10346458779874607 * `ADS`.`Feature_66` + 0.01107523215122299 * `ADS`.`Feature_67` + -0.03764374337887529 * `ADS`.`Feature_68` + -0.10641633946939238 * `ADS`.`Feature_69` + 0.05087112388512294 * `ADS`.`Feature_70` + 0.04261126852957591 * `ADS`.`Feature_71` + 0.04169264523980888 * `ADS`.`Feature_72` + 0.10625513252662175 * `ADS`.`Feature_73` + -0.028546692632778196 * `ADS`.`Feature_74` + -0.015844691437451038 * `ADS`.`Feature_75` + -0.0676983555923079 * `ADS`.`Feature_76` + 0.0018021128871360684 * `ADS`.`Feature_77` + -0.09941085200362795 * `ADS`.`Feature_78` + -0.005641571892152244 * `ADS`.`Feature_79` + -0.029255568147806492 * `ADS`.`Feature_80` + 0.09854445981387609 * `ADS`.`Feature_81` + 0.004260539871522949 * `ADS`.`Feature_82` + -0.00353995734155519 * `ADS`.`Feature_83` + -0.042353607390486256 * `ADS`.`Feature_84` + -0.020741265851927135 * `ADS`.`Feature_85` + 0.028833299791883496 * `ADS`.`Feature_86` + -0.02281503311831074 * `ADS`.`Feature_87` + -0.03792475854617665 * `ADS`.`Feature_88` + 0.029034389228859148 * `ADS`.`Feature_89` + -0.06988160066342906 * `ADS`.`Feature_90` + 0.043893556778211294 * `ADS`.`Feature_91` + -0.002736494368680799 * `ADS`.`Feature_92` + -0.06417099883117407 * `ADS`.`Feature_93` + -0.13460388624483868 * `ADS`.`Feature_94` + -0.11830133177265374 * `ADS`.`Feature_95` + 0.00761165299986407 * `ADS`.`Feature_96` + -0.02537789122877889 * `ADS`.`Feature_97` + 0.028263380255643143 * `ADS`.`Feature_98` + 0.03859476612148291 * `ADS`.`Feature_99` + -0.57191934617 AS `Score_2`, 0.12146523233229742 * `ADS`.`Feature_0` + 0.10373285120380188 * `ADS`.`Feature_1` + -0.002182799368860763 * `ADS`.`Feature_2` + 0.06751685628534351 * `ADS`.`Feature_3` + 0.04469452549592464 * `ADS`.`Feature_4` + 0.02184998391250243 * `ADS`.`Feature_5` + -0.15767652190102835 * `ADS`.`Feature_6` + 0.025893646433339648 * `ADS`.`Feature_7` + 0.00850002466242533 * `ADS`.`Feature_8` + 0.006718037477287497 * `ADS`.`Feature_9` + -0.2634736712114214 * `ADS`.`Feature_10` + -0.0008947203543348478 * `ADS`.`Feature_11` + -0.01338517069696224 * `ADS`.`Feature_12` + -0.02384989494142943 * `ADS`.`Feature_13` + -0.05348541585106211 * `ADS`.`Feature_14` + -0.2842263703000073 * `ADS`.`Feature_15` + 0.07198552125146039 * `ADS`.`Feature_16` + -0.10011641548574521 * `ADS`.`Feature_17` + 0.06856920570266284 * `ADS`.`Feature_18` + 0.026798409909178568 * `ADS`.`Feature_19` + 0.03124551581936947 * `ADS`.`Feature_20` + -0.018810799214574958 * `ADS`.`Feature_21` + 0.13398223498339829 * `ADS`.`Feature_22` + -0.14488350817733647 * `ADS`.`Feature_23` + 0.030407376339616377 * `ADS`.`Feature_24` + -0.09750536533036669 * `ADS`.`Feature_25` + -0.006480944754296683 * `ADS`.`Feature_26` + -0.05419808727822311 * `ADS`.`Feature_27` + -0.15356340380651848 * `ADS`.`Feature_28` + -0.1485394653133515 * `ADS`.`Feature_29` + 0.03837840088941485 * `ADS`.`Feature_30` + 0.008801685571062933 * `ADS`.`Feature_31` + 0.08516502455207325 * `ADS`.`Feature_32` + 0.00687340478189135 * `ADS`.`Feature_33` + -0.02901515190860474 * `ADS`.`Feature_34` + -0.07099292438560753 * `ADS`.`Feature_35` + -0.16049705525428248 * `ADS`.`Feature_36` + -0.12703321278876512 * `ADS`.`Feature_37` + 0.04209125606166375 * `ADS`.`Feature_38` + 0.016132240619962532 * `ADS`.`Feature_39` + -0.11707109998552483 * `ADS`.`Feature_40` + -0.01068040340452054 * `ADS`.`Feature_41` + 0.03409148711268689 * `ADS`.`Feature_42` + 0.049617357205983786 * `ADS`.`Feature_43` + 0.06730666677304928 * `ADS`.`Feature_44` + 0.00550571349363518 * `ADS`.`Feature_45` + 0.12673775525132508 * `ADS`.`Feature_46` + 0.040665854918764156 * `ADS`.`Feature_47` + -0.046093565925323224 * `ADS`.`Feature_48` + -0.010360740851764638 * `ADS`.`Feature_49` + 0.0026298704847165233 * `ADS`.`Feature_50` + 0.025638520960690858 * `ADS`.`Feature_51` + -0.04827805030135922 * `ADS`.`Feature_52` + -0.03730844468392777 * `ADS`.`Feature_53` + 0.03203201445032109 * `ADS`.`Feature_54` + -0.019248718469743104 * `ADS`.`Feature_55` + -0.012043821094541989 * `ADS`.`Feature_56` + -0.12815008350311208 * `ADS`.`Feature_57` + 0.02354931387006115 * `ADS`.`Feature_58` + 0.13593623440694974 * `ADS`.`Feature_59` + -0.043976888280690726 * `ADS`.`Feature_60` + 0.005448003710681035 * `ADS`.`Feature_61` + 0.012081793955469378 * `ADS`.`Feature_62` + 0.050636325472384426 * `ADS`.`Feature_63` + -0.016057319356553107 * `ADS`.`Feature_64` + -0.0008065490766453916 * `ADS`.`Feature_65` + -0.033142985381929224 * `ADS`.`Feature_66` + -0.015356598515377087 * `ADS`.`Feature_67` + 0.0935737010106762 * `ADS`.`Feature_68` + 0.1529236396285897 * `ADS`.`Feature_69` + -0.03662138443482471 * `ADS`.`Feature_70` + -0.08111770319840143 * `ADS`.`Feature_71` + 0.09212739211399289 * `ADS`.`Feature_72` + -0.05606997374905988 * `ADS`.`Feature_73` + 0.01247945668848331 * `ADS`.`Feature_74` + 0.0384593100206478 * `ADS`.`Feature_75` + 0.022209491248645297 * `ADS`.`Feature_76` + 0.07740000727491625 * `ADS`.`Feature_77` + 0.03476245888357248 * `ADS`.`Feature_78` + -0.024801959360082972 * `ADS`.`Feature_79` + 0.040576807248394776 * `ADS`.`Feature_80` + -0.12187908422858527 * `ADS`.`Feature_81` + -0.060999503522470085 * `ADS`.`Feature_82` + -0.05877802139122613 * `ADS`.`Feature_83` + 0.03128213673005981 * `ADS`.`Feature_84` + -0.01201715209684526 * `ADS`.`Feature_85` + -0.008049526667442939 * `ADS`.`Feature_86` + 0.09567259625707125 * `ADS`.`Feature_87` + 0.06171650090507125 * `ADS`.`Feature_88` + 0.07767522726171522 * `ADS`.`Feature_89` + 0.08146069754175508 * `ADS`.`Feature_90` + 0.021258504874993277 * `ADS`.`Feature_91` + -0.07641911380281588 * `ADS`.`Feature_92` + 0.07544392891126844 * `ADS`.`Feature_93` + 0.06224728949984017 * `ADS`.`Feature_94` + 0.07799948427159241 * `ADS`.`Feature_95` + 0.04853989127613721 * `ADS`.`Feature_96` + 0.034123593247405125 * `ADS`.`Feature_97` + 0.023172761052431625 * `ADS`.`Feature_98` + -0.10726065384863283 * `ADS`.`Feature_99` + -0.481456812925 AS `Score_3` 
FROM `FourClass_100` AS `ADS`), 
orig_cte AS 
(SELECT linear_model_cte.`KEY` AS `KEY`, linear_model_cte.`Score_0` AS `Score_0`, linear_model_cte.`Score_1` AS `Score_1`, linear_model_cte.`Score_2` AS `Score_2`, linear_model_cte.`Score_3` AS `Score_3`, NULL AS `Proba_0`, NULL AS `Proba_1`, NULL AS `Proba_2`, NULL AS `Proba_3`, NULL AS `LogProba_0`, NULL AS `LogProba_1`, NULL AS `LogProba_2`, NULL AS `LogProba_3`, NULL AS `Decision` 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu.`KEY` AS `KEY`, scu.class AS class, scu.`LogProba` AS `LogProba`, scu.`Proba` AS `Proba`, scu.`Score` AS `Score` 
FROM (SELECT orig_cte.`KEY` AS `KEY`, 0 AS class, orig_cte.`LogProba_0` AS `LogProba`, orig_cte.`Proba_0` AS `Proba`, orig_cte.`Score_0` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY`, 1 AS class, orig_cte.`LogProba_1` AS `LogProba`, orig_cte.`Proba_1` AS `Proba`, orig_cte.`Score_1` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY`, 2 AS class, orig_cte.`LogProba_2` AS `LogProba`, orig_cte.`Proba_2` AS `Proba`, orig_cte.`Score_2` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY`, 3 AS class, orig_cte.`LogProba_3` AS `LogProba`, orig_cte.`Proba_3` AS `Proba`, orig_cte.`Score_3` AS `Score` 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.`KEY` AS `KEY`, orig_cte.`Score_0` AS `Score_0`, orig_cte.`Score_1` AS `Score_1`, orig_cte.`Score_2` AS `Score_2`, orig_cte.`Score_3` AS `Score_3`, orig_cte.`Proba_0` AS `Proba_0`, orig_cte.`Proba_1` AS `Proba_1`, orig_cte.`Proba_2` AS `Proba_2`, orig_cte.`Proba_3` AS `Proba_3`, orig_cte.`LogProba_0` AS `LogProba_0`, orig_cte.`LogProba_1` AS `LogProba_1`, orig_cte.`LogProba_2` AS `LogProba_2`, orig_cte.`LogProba_3` AS `LogProba_3`, orig_cte.`Decision` AS `Decision`, (SELECT max(score_class_union.`LogProba`) AS max_1 
FROM score_class_union 
WHERE orig_cte.`KEY` = score_class_union.`KEY`) AS `max_LogProba`, (SELECT max(score_class_union.`Proba`) AS max_2 
FROM score_class_union 
WHERE orig_cte.`KEY` = score_class_union.`KEY`) AS `max_Proba`, (SELECT max(score_class_union.`Score`) AS max_3 
FROM score_class_union 
WHERE orig_cte.`KEY` = score_class_union.`KEY`) AS `max_Score` 
FROM orig_cte), 
arg_max_cte AS 
(SELECT score_max.`KEY` AS `KEY`, score_max.`Score_0` AS `Score_0`, score_max.`Score_1` AS `Score_1`, score_max.`Score_2` AS `Score_2`, score_max.`Score_3` AS `Score_3`, score_max.`Proba_0` AS `Proba_0`, score_max.`Proba_1` AS `Proba_1`, score_max.`Proba_2` AS `Proba_2`, score_max.`Proba_3` AS `Proba_3`, score_max.`LogProba_0` AS `LogProba_0`, score_max.`LogProba_1` AS `LogProba_1`, score_max.`LogProba_2` AS `LogProba_2`, score_max.`LogProba_3` AS `LogProba_3`, score_max.`Decision` AS `Decision`, score_max.`max_LogProba` AS `max_LogProba`, score_max.`max_Proba` AS `max_Proba`, score_max.`max_Score` AS `max_Score`, (SELECT min(score_class_union.class) AS min_1 
FROM score_class_union 
WHERE score_max.`max_LogProba` = score_class_union.`LogProba` AND score_max.`KEY` = score_class_union.`KEY`) AS `arg_max_LogProba`, (SELECT min(score_class_union.class) AS min_2 
FROM score_class_union 
WHERE score_max.`max_Proba` = score_class_union.`Proba` AND score_max.`KEY` = score_class_union.`KEY`) AS `arg_max_Proba`, (SELECT min(score_class_union.class) AS min_3 
FROM score_class_union 
WHERE score_max.`max_Score` = score_class_union.`Score` AND score_max.`KEY` = score_class_union.`KEY`) AS `arg_max_Score` 
FROM score_max)
 SELECT arg_max_cte.`KEY` AS `KEY`, arg_max_cte.`Score_0` AS `Score_0`, arg_max_cte.`Score_1` AS `Score_1`, arg_max_cte.`Score_2` AS `Score_2`, arg_max_cte.`Score_3` AS `Score_3`, arg_max_cte.`Proba_0` AS `Proba_0`, arg_max_cte.`Proba_1` AS `Proba_1`, arg_max_cte.`Proba_2` AS `Proba_2`, arg_max_cte.`Proba_3` AS `Proba_3`, CASE WHEN (arg_max_cte.`Proba_0` IS NULL OR arg_max_cte.`Proba_0` > 0.0) THEN ln(arg_max_cte.`Proba_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (arg_max_cte.`Proba_1` IS NULL OR arg_max_cte.`Proba_1` > 0.0) THEN ln(arg_max_cte.`Proba_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (arg_max_cte.`Proba_2` IS NULL OR arg_max_cte.`Proba_2` > 0.0) THEN ln(arg_max_cte.`Proba_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, CASE WHEN (arg_max_cte.`Proba_3` IS NULL OR arg_max_cte.`Proba_3` > 0.0) THEN ln(arg_max_cte.`Proba_3`) ELSE -1.79769313486231e+308 END AS `LogProba_3`, arg_max_cte.`arg_max_Score` AS `Decision` 
FROM arg_max_cte