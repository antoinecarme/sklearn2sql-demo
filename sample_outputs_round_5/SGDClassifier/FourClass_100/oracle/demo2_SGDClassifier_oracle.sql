-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH linear_model_cte AS 
(SELECT "ADS"."KEY" AS "KEY", 86.6342444380227 * "ADS"."Feature_0" + -138.53104266123222 * "ADS"."Feature_1" + -168.4306061469206 * "ADS"."Feature_2" + -102.07443758766843 * "ADS"."Feature_3" + 73.31835809196093 * "ADS"."Feature_4" + -287.49787427780666 * "ADS"."Feature_5" + 355.5245909969092 * "ADS"."Feature_6" + -16.863867169296274 * "ADS"."Feature_7" + -118.21476465202485 * "ADS"."Feature_8" + -193.70026921094276 * "ADS"."Feature_9" + 73.61365748070132 * "ADS"."Feature_10" + -54.693158081770065 * "ADS"."Feature_11" + -91.74121790206547 * "ADS"."Feature_12" + 74.8411512419269 * "ADS"."Feature_13" + 407.5611719296394 * "ADS"."Feature_14" + -0.5878818386053771 * "ADS"."Feature_15" + -39.34155300899674 * "ADS"."Feature_16" + -196.8511531608235 * "ADS"."Feature_17" + 274.4779807939836 * "ADS"."Feature_18" + -20.22997548557584 * "ADS"."Feature_19" + -54.146168061684605 * "ADS"."Feature_20" + -146.75775368116953 * "ADS"."Feature_21" + 97.98316287356455 * "ADS"."Feature_22" + 56.81941906154266 * "ADS"."Feature_23" + 173.20117503538762 * "ADS"."Feature_24" + 177.62381858439605 * "ADS"."Feature_25" + 77.19451347409294 * "ADS"."Feature_26" + -49.25340223953016 * "ADS"."Feature_27" + -81.59932664563767 * "ADS"."Feature_28" + 113.82492143873274 * "ADS"."Feature_29" + 38.455519994942655 * "ADS"."Feature_30" + -254.2702822182381 * "ADS"."Feature_31" + 399.4458950262491 * "ADS"."Feature_32" + 3.6164585837961525 * "ADS"."Feature_33" + -241.53242991069774 * "ADS"."Feature_34" + -98.02427864672238 * "ADS"."Feature_35" + 40.50506776249235 * "ADS"."Feature_36" + 318.2403003938946 * "ADS"."Feature_37" + 100.20386982066346 * "ADS"."Feature_38" + -238.44971520916167 * "ADS"."Feature_39" + -53.90266291347421 * "ADS"."Feature_40" + 603.3116972648701 * "ADS"."Feature_41" + -72.20334863887318 * "ADS"."Feature_42" + -235.074065285754 * "ADS"."Feature_43" + 94.74356784419258 * "ADS"."Feature_44" + -104.76657915721572 * "ADS"."Feature_45" + -152.49622517090356 * "ADS"."Feature_46" + 244.89564093292512 * "ADS"."Feature_47" + 91.61983354458117 * "ADS"."Feature_48" + -359.4679978132402 * "ADS"."Feature_49" + 16.93611325972261 * "ADS"."Feature_50" + 82.82896218765133 * "ADS"."Feature_51" + 40.47024794255036 * "ADS"."Feature_52" + 274.106676990045 * "ADS"."Feature_53" + -219.69462032422064 * "ADS"."Feature_54" + 174.4720389059761 * "ADS"."Feature_55" + 88.70385394076484 * "ADS"."Feature_56" + 16.260193604798225 * "ADS"."Feature_57" + -46.33620676693176 * "ADS"."Feature_58" + 13.769864370302827 * "ADS"."Feature_59" + -68.62220533286325 * "ADS"."Feature_60" + 43.69449454168725 * "ADS"."Feature_61" + 206.81396926870337 * "ADS"."Feature_62" + 112.18142082821942 * "ADS"."Feature_63" + 128.90355550065985 * "ADS"."Feature_64" + -456.9060126137233 * "ADS"."Feature_65" + -76.82546534674253 * "ADS"."Feature_66" + -20.298635039916608 * "ADS"."Feature_67" + 40.183991338849054 * "ADS"."Feature_68" + 116.04885153971345 * "ADS"."Feature_69" + 93.93429068733255 * "ADS"."Feature_70" + -234.33712246059972 * "ADS"."Feature_71" + 18.26250265986812 * "ADS"."Feature_72" + 378.6221084110245 * "ADS"."Feature_73" + -512.4811447006698 * "ADS"."Feature_74" + -26.927655477778163 * "ADS"."Feature_75" + 129.35577734486503 * "ADS"."Feature_76" + 59.61685127052805 * "ADS"."Feature_77" + 9.847735353924692 * "ADS"."Feature_78" + 141.79485367677458 * "ADS"."Feature_79" + -91.91996831585396 * "ADS"."Feature_80" + 226.42721359207982 * "ADS"."Feature_81" + -480.7986399735888 * "ADS"."Feature_82" + 289.673834711002 * "ADS"."Feature_83" + 116.32970106350575 * "ADS"."Feature_84" + 37.24193914935733 * "ADS"."Feature_85" + -330.5251573460685 * "ADS"."Feature_86" + 62.61205663255046 * "ADS"."Feature_87" + 60.06793831002264 * "ADS"."Feature_88" + 232.5083778488382 * "ADS"."Feature_89" + 249.53685522339202 * "ADS"."Feature_90" + 99.09845693092034 * "ADS"."Feature_91" + 11.80148484631703 * "ADS"."Feature_92" + -46.518711512434216 * "ADS"."Feature_93" + -8.307069914259994 * "ADS"."Feature_94" + -32.66398143414799 * "ADS"."Feature_95" + -60.90279621795075 * "ADS"."Feature_96" + -346.1763117164376 * "ADS"."Feature_97" + 54.82664585698373 * "ADS"."Feature_98" + -69.09991029906827 * "ADS"."Feature_99" + -279.323678466 AS "Score_0", -173.42269609963293 * "ADS"."Feature_0" + 61.362104229671104 * "ADS"."Feature_1" + 232.80348532551824 * "ADS"."Feature_2" + 20.04550143889469 * "ADS"."Feature_3" + 17.181249035411014 * "ADS"."Feature_4" + 579.665931757959 * "ADS"."Feature_5" + -243.33729626477378 * "ADS"."Feature_6" + 80.78209582012349 * "ADS"."Feature_7" + -287.2678604464684 * "ADS"."Feature_8" + 47.031097539493565 * "ADS"."Feature_9" + 38.722606719428484 * "ADS"."Feature_10" + -23.521308973841222 * "ADS"."Feature_11" + -38.77430581101214 * "ADS"."Feature_12" + -37.138352908162375 * "ADS"."Feature_13" + 239.5982960119287 * "ADS"."Feature_14" + -179.1449173142817 * "ADS"."Feature_15" + -130.61319933203586 * "ADS"."Feature_16" + -374.17703559326304 * "ADS"."Feature_17" + 183.44241535668053 * "ADS"."Feature_18" + -88.04101227028623 * "ADS"."Feature_19" + -39.7406605454985 * "ADS"."Feature_20" + 99.4122410081584 * "ADS"."Feature_21" + -109.33766605588606 * "ADS"."Feature_22" + -98.5210362434874 * "ADS"."Feature_23" + -427.8095464249838 * "ADS"."Feature_24" + 115.77732659301236 * "ADS"."Feature_25" + -125.71103261340139 * "ADS"."Feature_26" + -31.752993208433537 * "ADS"."Feature_27" + -92.98621220008086 * "ADS"."Feature_28" + -147.31466013510453 * "ADS"."Feature_29" + 313.07984050930946 * "ADS"."Feature_30" + 21.70500684182438 * "ADS"."Feature_31" + 184.89639814067112 * "ADS"."Feature_32" + 305.4724024200395 * "ADS"."Feature_33" + 312.92343071484703 * "ADS"."Feature_34" + -49.29768099990817 * "ADS"."Feature_35" + 148.58485378092817 * "ADS"."Feature_36" + -230.3114806188756 * "ADS"."Feature_37" + -19.968341155001852 * "ADS"."Feature_38" + 99.67853129035447 * "ADS"."Feature_39" + 3.4744086201600677 * "ADS"."Feature_40" + 316.1636903647715 * "ADS"."Feature_41" + -49.2772039009725 * "ADS"."Feature_42" + 187.78796106272503 * "ADS"."Feature_43" + -8.369228779092015 * "ADS"."Feature_44" + 0.7862216170526579 * "ADS"."Feature_45" + 210.63186080473685 * "ADS"."Feature_46" + 23.747131736272987 * "ADS"."Feature_47" + -656.91628432295 * "ADS"."Feature_48" + -338.76319233090095 * "ADS"."Feature_49" + -147.56222525013303 * "ADS"."Feature_50" + 108.68457132236459 * "ADS"."Feature_51" + 64.65979250558222 * "ADS"."Feature_52" + -183.7720334071448 * "ADS"."Feature_53" + 5.407232355840284 * "ADS"."Feature_54" + 13.98567195362605 * "ADS"."Feature_55" + 28.352072754259083 * "ADS"."Feature_56" + 78.9358915562994 * "ADS"."Feature_57" + 60.56225040968112 * "ADS"."Feature_58" + 22.59341304759882 * "ADS"."Feature_59" + 290.4188335305753 * "ADS"."Feature_60" + 68.73037456807695 * "ADS"."Feature_61" + 47.096457827851225 * "ADS"."Feature_62" + -109.47522864407509 * "ADS"."Feature_63" + -190.78594685737124 * "ADS"."Feature_64" + 128.61178229327592 * "ADS"."Feature_65" + -193.72022598795135 * "ADS"."Feature_66" + -213.93472022621057 * "ADS"."Feature_67" + -90.052650525731 * "ADS"."Feature_68" + -52.00625149120694 * "ADS"."Feature_69" + -325.5521411075319 * "ADS"."Feature_70" + -194.678086688103 * "ADS"."Feature_71" + 54.28713082878324 * "ADS"."Feature_72" + -347.7328293777256 * "ADS"."Feature_73" + 55.63451124300878 * "ADS"."Feature_74" + -437.76468700618125 * "ADS"."Feature_75" + -154.97239956451216 * "ADS"."Feature_76" + -181.53358003370366 * "ADS"."Feature_77" + -33.45080017850931 * "ADS"."Feature_78" + 12.08305147306488 * "ADS"."Feature_79" + 45.9653539564511 * "ADS"."Feature_80" + 203.51326026582805 * "ADS"."Feature_81" + -33.88810792838232 * "ADS"."Feature_82" + -20.84047369429966 * "ADS"."Feature_83" + 31.326892007533232 * "ADS"."Feature_84" + -23.973328834572296 * "ADS"."Feature_85" + 23.884552098026088 * "ADS"."Feature_86" + -235.1679277294151 * "ADS"."Feature_87" + -37.5905529355811 * "ADS"."Feature_88" + 27.61033305862228 * "ADS"."Feature_89" + -348.4965666565466 * "ADS"."Feature_90" + 13.282660098628684 * "ADS"."Feature_91" + -70.2582192998913 * "ADS"."Feature_92" + -175.58935992974574 * "ADS"."Feature_93" + 209.62087813920223 * "ADS"."Feature_94" + -45.24201708136846 * "ADS"."Feature_95" + 180.8921857817469 * "ADS"."Feature_96" + 197.63280448563097 * "ADS"."Feature_97" + 16.29160624760415 * "ADS"."Feature_98" + -18.86720828893983 * "ADS"."Feature_99" + -359.650776707 AS "Score_1", 52.60985843529868 * "ADS"."Feature_0" + -46.5876930296314 * "ADS"."Feature_1" + 98.6630047032163 * "ADS"."Feature_2" + 255.2173661587952 * "ADS"."Feature_3" + -186.22208877783294 * "ADS"."Feature_4" + -200.5363207997136 * "ADS"."Feature_5" + 16.28051922178339 * "ADS"."Feature_6" + -50.28430169056191 * "ADS"."Feature_7" + 83.5345200690539 * "ADS"."Feature_8" + 71.14787352152406 * "ADS"."Feature_9" + 55.28039067216681 * "ADS"."Feature_10" + 42.5719265911201 * "ADS"."Feature_11" + 453.3426662752812 * "ADS"."Feature_12" + -191.14935191402841 * "ADS"."Feature_13" + -83.0785432741091 * "ADS"."Feature_14" + 42.743260806685015 * "ADS"."Feature_15" + -69.44119221315788 * "ADS"."Feature_16" + -63.009093144369324 * "ADS"."Feature_17" + 175.86967460142063 * "ADS"."Feature_18" + 26.538109954352347 * "ADS"."Feature_19" + 107.8477603174306 * "ADS"."Feature_20" + 192.3900649550212 * "ADS"."Feature_21" + 82.6201165791311 * "ADS"."Feature_22" + 9.697858784568218 * "ADS"."Feature_23" + -193.71905365617067 * "ADS"."Feature_24" + -668.7075753245025 * "ADS"."Feature_25" + 164.5590216132772 * "ADS"."Feature_26" + 109.08952563786265 * "ADS"."Feature_27" + -33.359257946505785 * "ADS"."Feature_28" + -112.59799642601745 * "ADS"."Feature_29" + 596.3782056486476 * "ADS"."Feature_30" + -425.9997289623481 * "ADS"."Feature_31" + -279.66971531800107 * "ADS"."Feature_32" + -423.87243325936856 * "ADS"."Feature_33" + -217.6015374915625 * "ADS"."Feature_34" + -114.20921948232483 * "ADS"."Feature_35" + -58.584638434409264 * "ADS"."Feature_36" + 711.3628876077833 * "ADS"."Feature_37" + 340.61539802275126 * "ADS"."Feature_38" + -114.65292003292208 * "ADS"."Feature_39" + -174.01743141040512 * "ADS"."Feature_40" + -43.39114891233037 * "ADS"."Feature_41" + 117.38225693870719 * "ADS"."Feature_42" + -93.61477838378423 * "ADS"."Feature_43" + -60.74938119389808 * "ADS"."Feature_44" + -264.870425519138 * "ADS"."Feature_45" + -68.65913060520454 * "ADS"."Feature_46" + -20.0675357763123 * "ADS"."Feature_47" + -175.99541273926673 * "ADS"."Feature_48" + -61.40733760424196 * "ADS"."Feature_49" + -53.394516325418486 * "ADS"."Feature_50" + 323.08274862713364 * "ADS"."Feature_51" + 42.25800828922334 * "ADS"."Feature_52" + -12.977016570258014 * "ADS"."Feature_53" + 206.774668324468 * "ADS"."Feature_54" + 113.77102358731952 * "ADS"."Feature_55" + -34.13001980681186 * "ADS"."Feature_56" + -502.6802975032548 * "ADS"."Feature_57" + 127.8596408989215 * "ADS"."Feature_58" + -104.19111571439112 * "ADS"."Feature_59" + 113.5884173165805 * "ADS"."Feature_60" + -326.15925775934943 * "ADS"."Feature_61" + 195.49575235825617 * "ADS"."Feature_62" + 127.66383244676514 * "ADS"."Feature_63" + 15.98436407677772 * "ADS"."Feature_64" + -186.70761869176934 * "ADS"."Feature_65" + 13.57657439598163 * "ADS"."Feature_66" + -153.95786237947348 * "ADS"."Feature_67" + -94.694002898304 * "ADS"."Feature_68" + 148.60047636899426 * "ADS"."Feature_69" + -35.68906105799198 * "ADS"."Feature_70" + -37.71698547485836 * "ADS"."Feature_71" + -110.83479131845102 * "ADS"."Feature_72" + -74.18266991726559 * "ADS"."Feature_73" + -336.38918596266734 * "ADS"."Feature_74" + 147.3606883071835 * "ADS"."Feature_75" + 199.27144853849993 * "ADS"."Feature_76" + -761.7826646810639 * "ADS"."Feature_77" + 96.35834096933587 * "ADS"."Feature_78" + 128.56558433935703 * "ADS"."Feature_79" + 99.13298756528033 * "ADS"."Feature_80" + -284.0636876320266 * "ADS"."Feature_81" + 174.84715722957964 * "ADS"."Feature_82" + -272.72460265593287 * "ADS"."Feature_83" + 45.680482997211 * "ADS"."Feature_84" + -41.310032815811475 * "ADS"."Feature_85" + 83.03443734646382 * "ADS"."Feature_86" + -129.18583643972894 * "ADS"."Feature_87" + 109.2443211145845 * "ADS"."Feature_88" + 67.30673892967553 * "ADS"."Feature_89" + 166.38285327234175 * "ADS"."Feature_90" + 205.3127709369545 * "ADS"."Feature_91" + 170.392176991948 * "ADS"."Feature_92" + -39.29602803370536 * "ADS"."Feature_93" + 36.41613730637715 * "ADS"."Feature_94" + 42.58609429109035 * "ADS"."Feature_95" + 33.74888765619443 * "ADS"."Feature_96" + -148.7243839678588 * "ADS"."Feature_97" + 9.51638076996 * "ADS"."Feature_98" + 201.6764935521197 * "ADS"."Feature_99" + -470.125294176 AS "Score_2", -42.98815549991381 * "ADS"."Feature_0" + -37.81122501716379 * "ADS"."Feature_1" + -198.89751310838932 * "ADS"."Feature_2" + -48.76380946498357 * "ADS"."Feature_3" + -182.73835043096105 * "ADS"."Feature_4" + -275.4014092036719 * "ADS"."Feature_5" + -25.358002405768076 * "ADS"."Feature_6" + 11.623232144842486 * "ADS"."Feature_7" + -46.90181620255429 * "ADS"."Feature_8" + 264.79387934070456 * "ADS"."Feature_9" + -37.751737223971276 * "ADS"."Feature_10" + -267.6466676288616 * "ADS"."Feature_11" + -76.66788020773734 * "ADS"."Feature_12" + -77.93337575167153 * "ADS"."Feature_13" + -111.0124727368142 * "ADS"."Feature_14" + 25.47418087154598 * "ADS"."Feature_15" + 98.09567170009745 * "ADS"."Feature_16" + 252.7566511937934 * "ADS"."Feature_17" + 171.03437982504522 * "ADS"."Feature_18" + -54.83597163672085 * "ADS"."Feature_19" + -2.9210110580000084 * "ADS"."Feature_20" + -306.1795647640746 * "ADS"."Feature_21" + 122.78055938069191 * "ADS"."Feature_22" + -98.38904287117938 * "ADS"."Feature_23" + -201.00883401084397 * "ADS"."Feature_24" + 314.2178063526243 * "ADS"."Feature_25" + 14.181708609902307 * "ADS"."Feature_26" + -121.31893715259275 * "ADS"."Feature_27" + 30.970353048479353 * "ADS"."Feature_28" + -219.37583938412791 * "ADS"."Feature_29" + 69.07810816957847 * "ADS"."Feature_30" + -19.252557166138153 * "ADS"."Feature_31" + -217.00356176658815 * "ADS"."Feature_32" + -340.29121556861486 * "ADS"."Feature_33" + -472.06832104685594 * "ADS"."Feature_34" + 139.72132296048517 * "ADS"."Feature_35" + -169.84103173749153 * "ADS"."Feature_36" + 215.4262930398249 * "ADS"."Feature_37" + -106.12229648528134 * "ADS"."Feature_38" + -340.50788889866124 * "ADS"."Feature_39" + -85.13815948997096 * "ADS"."Feature_40" + -82.05159465715853 * "ADS"."Feature_41" + 87.84954593593046 * "ADS"."Feature_42" + 22.50027184165348 * "ADS"."Feature_43" + -88.94423213420033 * "ADS"."Feature_44" + 122.61884033107808 * "ADS"."Feature_45" + 136.84926522823497 * "ADS"."Feature_46" + -305.7911826924955 * "ADS"."Feature_47" + -516.6490742826064 * "ADS"."Feature_48" + 16.73147065196401 * "ADS"."Feature_49" + -9.265033133977186 * "ADS"."Feature_50" + 187.3345968923874 * "ADS"."Feature_51" + -115.01820833506369 * "ADS"."Feature_52" + 302.01010558456846 * "ADS"."Feature_53" + 96.32737643380007 * "ADS"."Feature_54" + -16.678557750411013 * "ADS"."Feature_55" + -108.73681271182205 * "ADS"."Feature_56" + 114.72776094726622 * "ADS"."Feature_57" + 112.49852061879099 * "ADS"."Feature_58" + -33.878863711180834 * "ADS"."Feature_59" + 101.68721424723684 * "ADS"."Feature_60" + 33.7820023432892 * "ADS"."Feature_61" + 3.0641908673753333 * "ADS"."Feature_62" + -48.72154226716862 * "ADS"."Feature_63" + -294.2173996201346 * "ADS"."Feature_64" + -404.45904664324274 * "ADS"."Feature_65" + 119.86984252600527 * "ADS"."Feature_66" + -177.12754998033776 * "ADS"."Feature_67" + -68.63536547552987 * "ADS"."Feature_68" + -4.068801095687931 * "ADS"."Feature_69" + 362.11374562776194 * "ADS"."Feature_70" + 130.63453153978327 * "ADS"."Feature_71" + -116.60177164703734 * "ADS"."Feature_72" + 321.7362064803247 * "ADS"."Feature_73" + -154.51370532646308 * "ADS"."Feature_74" + 105.67437880171097 * "ADS"."Feature_75" + -31.27095684040805 * "ADS"."Feature_76" + -239.60280929243373 * "ADS"."Feature_77" + -16.94655529758247 * "ADS"."Feature_78" + -243.30948481175759 * "ADS"."Feature_79" + 10.083411825755281 * "ADS"."Feature_80" + 510.5017289754146 * "ADS"."Feature_81" + -428.3464133684155 * "ADS"."Feature_82" + -382.35844158358975 * "ADS"."Feature_83" + 132.18741670384784 * "ADS"."Feature_84" + -91.18949563385655 * "ADS"."Feature_85" + -569.7485817587386 * "ADS"."Feature_86" + 433.1544092273879 * "ADS"."Feature_87" + -138.99123334745866 * "ADS"."Feature_88" + 35.66581987628686 * "ADS"."Feature_89" + -154.68639545729687 * "ADS"."Feature_90" + 132.18838496399604 * "ADS"."Feature_91" + -24.530837095390602 * "ADS"."Feature_92" + 16.928890886749148 * "ADS"."Feature_93" + -14.520890692043787 * "ADS"."Feature_94" + -13.133519905541762 * "ADS"."Feature_95" + 168.77395299141716 * "ADS"."Feature_96" + -99.10952545629685 * "ADS"."Feature_97" + -70.3589162813225 * "ADS"."Feature_98" + 42.752335154206776 * "ADS"."Feature_99" + -371.484337802 AS "Score_3" 
FROM "FourClass_100" "ADS"), 
orig_cte AS 
(SELECT linear_model_cte."KEY" AS "KEY", linear_model_cte."Score_0" AS "Score_0", linear_model_cte."Score_1" AS "Score_1", linear_model_cte."Score_2" AS "Score_2", linear_model_cte."Score_3" AS "Score_3", CAST(NULL AS FLOAT) AS "Proba_0", CAST(NULL AS FLOAT) AS "Proba_1", CAST(NULL AS FLOAT) AS "Proba_2", CAST(NULL AS FLOAT) AS "Proba_3", CAST(NULL AS FLOAT) AS "LogProba_0", CAST(NULL AS FLOAT) AS "LogProba_1", CAST(NULL AS FLOAT) AS "LogProba_2", CAST(NULL AS FLOAT) AS "LogProba_3", CAST(NULL AS FLOAT) AS "Decision" 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu."KEY" AS "KEY", scu.class AS class, scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY", 0 AS class, orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY", 1 AS class, orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY", 2 AS class, orig_cte."LogProba_2" AS "LogProba", orig_cte."Proba_2" AS "Proba", orig_cte."Score_2" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY", 3 AS class, orig_cte."LogProba_3" AS "LogProba", orig_cte."Proba_3" AS "Proba", orig_cte."Score_3" AS "Score" 
FROM orig_cte) scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Score_2" AS "Score_2", orig_cte."Score_3" AS "Score_3", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."Proba_2" AS "Proba_2", orig_cte."Proba_3" AS "Proba_3", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."LogProba_2" AS "LogProba_2", orig_cte."LogProba_3" AS "LogProba_3", orig_cte."Decision" AS "Decision", (SELECT max(score_class_union."LogProba") AS max_1 
FROM score_class_union 
WHERE orig_cte."KEY" = score_class_union."KEY") AS "max_LogProba", (SELECT max(score_class_union."Proba") AS max_2 
FROM score_class_union 
WHERE orig_cte."KEY" = score_class_union."KEY") AS "max_Proba", (SELECT max(score_class_union."Score") AS max_3 
FROM score_class_union 
WHERE orig_cte."KEY" = score_class_union."KEY") AS "max_Score" 
FROM orig_cte), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."max_LogProba" AS "max_LogProba", score_max."max_Proba" AS "max_Proba", score_max."max_Score" AS "max_Score", (SELECT min(score_class_union.class) AS min_1 
FROM score_class_union 
WHERE score_max."max_LogProba" = score_class_union."LogProba" AND score_max."KEY" = score_class_union."KEY") AS "arg_max_LogProba", (SELECT min(score_class_union.class) AS min_2 
FROM score_class_union 
WHERE score_max."max_Proba" = score_class_union."Proba" AND score_max."KEY" = score_class_union."KEY") AS "arg_max_Proba", (SELECT min(score_class_union.class) AS min_3 
FROM score_class_union 
WHERE score_max."max_Score" = score_class_union."Score" AND score_max."KEY" = score_class_union."KEY") AS "arg_max_Score" 
FROM score_max)
 SELECT arg_max_cte."KEY" AS "KEY", arg_max_cte."Score_0" AS "Score_0", arg_max_cte."Score_1" AS "Score_1", arg_max_cte."Score_2" AS "Score_2", arg_max_cte."Score_3" AS "Score_3", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", arg_max_cte."Proba_2" AS "Proba_2", arg_max_cte."Proba_3" AS "Proba_3", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN ln(arg_max_cte."Proba_0") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN ln(arg_max_cte."Proba_1") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_1", CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN ln(arg_max_cte."Proba_2") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_2", CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN ln(arg_max_cte."Proba_3") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_3", arg_max_cte."arg_max_Score" AS "Decision" 
FROM arg_max_cte