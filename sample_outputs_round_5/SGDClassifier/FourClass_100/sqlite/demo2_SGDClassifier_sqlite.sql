-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH linear_model_cte AS 
(SELECT "ADS"."KEY" AS "KEY", -61.96064068743762 * "ADS"."Feature_0" + 347.8075240703767 * "ADS"."Feature_1" + -87.42114638256896 * "ADS"."Feature_2" + -145.89230837926993 * "ADS"."Feature_3" + 15.026626278211815 * "ADS"."Feature_4" + -436.26474048515894 * "ADS"."Feature_5" + -124.21676529235931 * "ADS"."Feature_6" + -203.55952772804432 * "ADS"."Feature_7" + 286.9004681345491 * "ADS"."Feature_8" + 35.32291059215389 * "ADS"."Feature_9" + 73.59766567208945 * "ADS"."Feature_10" + -5.160339012032702 * "ADS"."Feature_11" + 321.43202558199744 * "ADS"."Feature_12" + -309.9835646774047 * "ADS"."Feature_13" + 596.7384331919741 * "ADS"."Feature_14" + 224.2133854439599 * "ADS"."Feature_15" + -237.44572583592853 * "ADS"."Feature_16" + 165.49527903804977 * "ADS"."Feature_17" + -188.2453548966797 * "ADS"."Feature_18" + 620.8570530985688 * "ADS"."Feature_19" + 4.839143792700681 * "ADS"."Feature_20" + -204.92916433073785 * "ADS"."Feature_21" + -122.2251584559613 * "ADS"."Feature_22" + 81.60942971373836 * "ADS"."Feature_23" + -245.2507925756748 * "ADS"."Feature_24" + -35.975189383764075 * "ADS"."Feature_25" + 94.09301594203305 * "ADS"."Feature_26" + -141.3310990399691 * "ADS"."Feature_27" + 42.3817295623067 * "ADS"."Feature_28" + -83.72589011461739 * "ADS"."Feature_29" + 461.42946564358226 * "ADS"."Feature_30" + 91.88554050566539 * "ADS"."Feature_31" + -28.3431771894126 * "ADS"."Feature_32" + -91.5026678353472 * "ADS"."Feature_33" + 149.7457976734621 * "ADS"."Feature_34" + 115.17709057253951 * "ADS"."Feature_35" + -68.21766663439446 * "ADS"."Feature_36" + -246.5712695097617 * "ADS"."Feature_37" + -66.45923350590313 * "ADS"."Feature_38" + -176.0285696919955 * "ADS"."Feature_39" + 87.29701007793945 * "ADS"."Feature_40" + 46.660603757369586 * "ADS"."Feature_41" + 11.056453400829163 * "ADS"."Feature_42" + 131.25497569231825 * "ADS"."Feature_43" + -11.619920474489849 * "ADS"."Feature_44" + 222.64635459230533 * "ADS"."Feature_45" + -106.4565955532733 * "ADS"."Feature_46" + -253.65416562939293 * "ADS"."Feature_47" + 156.11039311920968 * "ADS"."Feature_48" + 99.60465881235778 * "ADS"."Feature_49" + 27.67767403607884 * "ADS"."Feature_50" + -126.67760970675273 * "ADS"."Feature_51" + -109.20538955092648 * "ADS"."Feature_52" + 116.84542550535059 * "ADS"."Feature_53" + 220.21726542346292 * "ADS"."Feature_54" + -138.12032660586635 * "ADS"."Feature_55" + 162.25614507103248 * "ADS"."Feature_56" + 53.82939310781612 * "ADS"."Feature_57" + -69.42646749672733 * "ADS"."Feature_58" + -208.34789240063844 * "ADS"."Feature_59" + -272.96128107793 * "ADS"."Feature_60" + -207.24710522552024 * "ADS"."Feature_61" + 2.996842254568701 * "ADS"."Feature_62" + 190.73504139865682 * "ADS"."Feature_63" + 158.27792059458415 * "ADS"."Feature_64" + -199.7116660431402 * "ADS"."Feature_65" + 21.781746853099662 * "ADS"."Feature_66" + -158.6503807361775 * "ADS"."Feature_67" + -243.8442529245955 * "ADS"."Feature_68" + -114.80253209766371 * "ADS"."Feature_69" + 31.19110608158438 * "ADS"."Feature_70" + -61.324540014807845 * "ADS"."Feature_71" + -136.43400778227442 * "ADS"."Feature_72" + 37.49674150322752 * "ADS"."Feature_73" + 4.758426683967824 * "ADS"."Feature_74" + 40.756225011706746 * "ADS"."Feature_75" + 136.20454969535564 * "ADS"."Feature_76" + 479.0351339678313 * "ADS"."Feature_77" + 78.00146159859315 * "ADS"."Feature_78" + -38.6759315478075 * "ADS"."Feature_79" + -60.18717203238732 * "ADS"."Feature_80" + -151.63045462724494 * "ADS"."Feature_81" + 23.129285959318203 * "ADS"."Feature_82" + 214.29532301996196 * "ADS"."Feature_83" + -212.9460126468799 * "ADS"."Feature_84" + -247.03069510472025 * "ADS"."Feature_85" + 135.81214718132486 * "ADS"."Feature_86" + 31.74798319047657 * "ADS"."Feature_87" + -201.74318284708028 * "ADS"."Feature_88" + 224.49706483244213 * "ADS"."Feature_89" + 102.95318167159334 * "ADS"."Feature_90" + -68.05734351119206 * "ADS"."Feature_91" + -29.916523866497517 * "ADS"."Feature_92" + 186.01129458552603 * "ADS"."Feature_93" + -57.04716232240842 * "ADS"."Feature_94" + -340.5063129618094 * "ADS"."Feature_95" + -305.76063263803 * "ADS"."Feature_96" + -54.437309270908614 * "ADS"."Feature_97" + -128.3425009042398 * "ADS"."Feature_98" + -0.4054421653426983 * "ADS"."Feature_99" + -678.589978692 AS "Score_0", -1.3434536662477012 * "ADS"."Feature_0" + -24.92721011929603 * "ADS"."Feature_1" + -260.1620274345219 * "ADS"."Feature_2" + -29.696901875928074 * "ADS"."Feature_3" + 230.51670274343132 * "ADS"."Feature_4" + -156.95526079824575 * "ADS"."Feature_5" + 70.24405222230841 * "ADS"."Feature_6" + -391.053103633643 * "ADS"."Feature_7" + -99.0830630986539 * "ADS"."Feature_8" + -215.02488779963048 * "ADS"."Feature_9" + 23.1011568583257 * "ADS"."Feature_10" + 83.30061175523267 * "ADS"."Feature_11" + -141.90199038482064 * "ADS"."Feature_12" + 255.24654671102712 * "ADS"."Feature_13" + 601.5483115142134 * "ADS"."Feature_14" + -180.41298294765633 * "ADS"."Feature_15" + 55.12952255401402 * "ADS"."Feature_16" + -27.22353557547235 * "ADS"."Feature_17" + -352.2461026343961 * "ADS"."Feature_18" + -230.6552263316008 * "ADS"."Feature_19" + 7.492253165826956 * "ADS"."Feature_20" + 40.66004528398549 * "ADS"."Feature_21" + -208.16541563036733 * "ADS"."Feature_22" + 65.20365360279995 * "ADS"."Feature_23" + -385.26433823070033 * "ADS"."Feature_24" + 98.72220496075451 * "ADS"."Feature_25" + 134.65697485181863 * "ADS"."Feature_26" + -251.23822859135294 * "ADS"."Feature_27" + 193.00214767203775 * "ADS"."Feature_28" + -315.2280648621087 * "ADS"."Feature_29" + 142.9442297531579 * "ADS"."Feature_30" + 157.44893445044613 * "ADS"."Feature_31" + -99.52783539462527 * "ADS"."Feature_32" + -68.6751727056796 * "ADS"."Feature_33" + -29.71681652980778 * "ADS"."Feature_34" + 152.0978264202706 * "ADS"."Feature_35" + -84.88612744226663 * "ADS"."Feature_36" + -117.89396777790776 * "ADS"."Feature_37" + -117.96473782705951 * "ADS"."Feature_38" + -90.59257937893291 * "ADS"."Feature_39" + 56.559580154624726 * "ADS"."Feature_40" + 5.770592044664686 * "ADS"."Feature_41" + -54.63659981209865 * "ADS"."Feature_42" + -126.37515624672835 * "ADS"."Feature_43" + 247.24634499848906 * "ADS"."Feature_44" + -46.314197554534786 * "ADS"."Feature_45" + -137.7201355231793 * "ADS"."Feature_46" + 100.07542389517445 * "ADS"."Feature_47" + -129.82804655447393 * "ADS"."Feature_48" + 302.0145954939762 * "ADS"."Feature_49" + -121.75386835807208 * "ADS"."Feature_50" + 97.2053337756203 * "ADS"."Feature_51" + 56.15030725977466 * "ADS"."Feature_52" + -21.263109072179837 * "ADS"."Feature_53" + -15.905317023869108 * "ADS"."Feature_54" + -28.350212993974356 * "ADS"."Feature_55" + 24.738877552051775 * "ADS"."Feature_56" + 5.567278156234494 * "ADS"."Feature_57" + -59.09362402957319 * "ADS"."Feature_58" + 74.86282843613179 * "ADS"."Feature_59" + 64.59175568318973 * "ADS"."Feature_60" + 123.41237443785216 * "ADS"."Feature_61" + 31.331366481411905 * "ADS"."Feature_62" + 84.88020755881395 * "ADS"."Feature_63" + 12.922621040447794 * "ADS"."Feature_64" + 128.06607603111945 * "ADS"."Feature_65" + -143.08482671136676 * "ADS"."Feature_66" + -54.76676870657161 * "ADS"."Feature_67" + 21.003212351502352 * "ADS"."Feature_68" + 41.202348180335505 * "ADS"."Feature_69" + -131.4983760505071 * "ADS"."Feature_70" + 391.6569570243543 * "ADS"."Feature_71" + 40.79590618405625 * "ADS"."Feature_72" + -49.38428499574077 * "ADS"."Feature_73" + -89.42244472016718 * "ADS"."Feature_74" + -95.46268152183389 * "ADS"."Feature_75" + 93.10060719131275 * "ADS"."Feature_76" + -12.953873899123268 * "ADS"."Feature_77" + 30.941410494822712 * "ADS"."Feature_78" + -18.252512047980947 * "ADS"."Feature_79" + 105.34102350343508 * "ADS"."Feature_80" + -135.8722510702068 * "ADS"."Feature_81" + 17.065746600892417 * "ADS"."Feature_82" + -326.8710711146885 * "ADS"."Feature_83" + 28.958980874823173 * "ADS"."Feature_84" + 295.19501706303 * "ADS"."Feature_85" + -261.764571764906 * "ADS"."Feature_86" + -144.20104443563082 * "ADS"."Feature_87" + 117.396903215423 * "ADS"."Feature_88" + 164.47299380752258 * "ADS"."Feature_89" + 151.3356252771224 * "ADS"."Feature_90" + -92.74157578199979 * "ADS"."Feature_91" + -232.72417399742295 * "ADS"."Feature_92" + 237.93074384427513 * "ADS"."Feature_93" + 344.66771262401073 * "ADS"."Feature_94" + 41.62548500185989 * "ADS"."Feature_95" + -118.58584773795215 * "ADS"."Feature_96" + -314.48606744998443 * "ADS"."Feature_97" + 58.144580404681676 * "ADS"."Feature_98" + -9.56998200974906 * "ADS"."Feature_99" + -535.031904719 AS "Score_1", -23.50959102311528 * "ADS"."Feature_0" + 152.57323698583048 * "ADS"."Feature_1" + -119.5044682821546 * "ADS"."Feature_2" + 228.72899283741117 * "ADS"."Feature_3" + 2.252900387709339 * "ADS"."Feature_4" + 72.15564498796336 * "ADS"."Feature_5" + -51.829613425523185 * "ADS"."Feature_6" + 361.6561338567965 * "ADS"."Feature_7" + -63.54332435094365 * "ADS"."Feature_8" + -215.13642743710648 * "ADS"."Feature_9" + 288.98452857892494 * "ADS"."Feature_10" + -83.99688088446447 * "ADS"."Feature_11" + 77.27669138159037 * "ADS"."Feature_12" + 298.3432414947229 * "ADS"."Feature_13" + -151.66919960511558 * "ADS"."Feature_14" + 224.3231481627066 * "ADS"."Feature_15" + 341.348247099533 * "ADS"."Feature_16" + -7.3872825369489945 * "ADS"."Feature_17" + 181.86699729977005 * "ADS"."Feature_18" + 402.33567179140863 * "ADS"."Feature_19" + 65.38957404808143 * "ADS"."Feature_20" + 387.1335483705265 * "ADS"."Feature_21" + 1.636776559976075 * "ADS"."Feature_22" + 16.33485093811788 * "ADS"."Feature_23" + 277.60673185037007 * "ADS"."Feature_24" + -133.2786440438544 * "ADS"."Feature_25" + 60.68713646749955 * "ADS"."Feature_26" + -114.62286798186267 * "ADS"."Feature_27" + 10.573005870455841 * "ADS"."Feature_28" + 200.5153266781271 * "ADS"."Feature_29" + 242.33466852631219 * "ADS"."Feature_30" + -31.28152725993178 * "ADS"."Feature_31" + 721.9661627557498 * "ADS"."Feature_32" + 46.97344713293475 * "ADS"."Feature_33" + 222.1599720967639 * "ADS"."Feature_34" + -14.575900729422125 * "ADS"."Feature_35" + 46.98020327654062 * "ADS"."Feature_36" + -17.30767090580091 * "ADS"."Feature_37" + 287.16831674484666 * "ADS"."Feature_38" + 65.48524060801336 * "ADS"."Feature_39" + -88.1624101151511 * "ADS"."Feature_40" + 49.75681350794503 * "ADS"."Feature_41" + -31.34213444035846 * "ADS"."Feature_42" + 71.36059700500402 * "ADS"."Feature_43" + -482.821530611954 * "ADS"."Feature_44" + -58.29332760531262 * "ADS"."Feature_45" + 188.15964649398086 * "ADS"."Feature_46" + -427.5009994576286 * "ADS"."Feature_47" + -60.75452772455574 * "ADS"."Feature_48" + -308.69002114453946 * "ADS"."Feature_49" + 103.21527530920049 * "ADS"."Feature_50" + -53.67040787485134 * "ADS"."Feature_51" + -30.98247382176368 * "ADS"."Feature_52" + -153.61855003828825 * "ADS"."Feature_53" + 124.38468606103207 * "ADS"."Feature_54" + 102.1177214336334 * "ADS"."Feature_55" + 133.8079631837615 * "ADS"."Feature_56" + 92.77452197977735 * "ADS"."Feature_57" + -75.68564494811622 * "ADS"."Feature_58" + 30.757654827969382 * "ADS"."Feature_59" + 130.67094891425924 * "ADS"."Feature_60" + -363.6153766907741 * "ADS"."Feature_61" + 99.75807788308967 * "ADS"."Feature_62" + -127.88170438430988 * "ADS"."Feature_63" + 54.9887080813295 * "ADS"."Feature_64" + -122.799112067243 * "ADS"."Feature_65" + -147.02201689201937 * "ADS"."Feature_66" + 43.6281119935951 * "ADS"."Feature_67" + 148.15766095751783 * "ADS"."Feature_68" + 60.18892634006924 * "ADS"."Feature_69" + 18.914057859894797 * "ADS"."Feature_70" + -5.3081216553922275 * "ADS"."Feature_71" + -34.43340494599509 * "ADS"."Feature_72" + -179.25261740668324 * "ADS"."Feature_73" + 111.91738692672438 * "ADS"."Feature_74" + -105.67904043922367 * "ADS"."Feature_75" + -213.78637380017258 * "ADS"."Feature_76" + -346.5690797489071 * "ADS"."Feature_77" + 192.9512432093164 * "ADS"."Feature_78" + 314.4399582977406 * "ADS"."Feature_79" + 55.30800706948678 * "ADS"."Feature_80" + -71.29283548158965 * "ADS"."Feature_81" + 147.41010033047598 * "ADS"."Feature_82" + 337.5974532043143 * "ADS"."Feature_83" + -86.71258985966152 * "ADS"."Feature_84" + -39.455801365282696 * "ADS"."Feature_85" + 53.540111827976766 * "ADS"."Feature_86" + -5.983891216713899 * "ADS"."Feature_87" + -22.540684125037412 * "ADS"."Feature_88" + -106.04905783707063 * "ADS"."Feature_89" + 96.89801121564861 * "ADS"."Feature_90" + -381.91351091303153 * "ADS"."Feature_91" + 96.83647445502511 * "ADS"."Feature_92" + 136.03836250252803 * "ADS"."Feature_93" + -171.16991386972865 * "ADS"."Feature_94" + 15.058712141888659 * "ADS"."Feature_95" + 11.535574975584238 * "ADS"."Feature_96" + -147.9413616691953 * "ADS"."Feature_97" + 144.55286779964868 * "ADS"."Feature_98" + -38.32695584069875 * "ADS"."Feature_99" + -371.939997103 AS "Score_2", -104.41818836251267 * "ADS"."Feature_0" + -267.3674644500513 * "ADS"."Feature_1" + -94.85887026824878 * "ADS"."Feature_2" + -312.0108104309058 * "ADS"."Feature_3" + -69.42375071587364 * "ADS"."Feature_4" + 119.68082222894513 * "ADS"."Feature_5" + 15.555774419530442 * "ADS"."Feature_6" + 43.626500425019735 * "ADS"."Feature_7" + 185.01125718457777 * "ADS"."Feature_8" + 130.03524792090775 * "ADS"."Feature_9" + 532.337572289998 * "ADS"."Feature_10" + 121.74973509663906 * "ADS"."Feature_11" + 99.16501767056836 * "ADS"."Feature_12" + -11.715948205745315 * "ADS"."Feature_13" + -276.28712384367 * "ADS"."Feature_14" + 143.53845965348057 * "ADS"."Feature_15" + 182.70151941099803 * "ADS"."Feature_16" + -126.09116356631546 * "ADS"."Feature_17" + 457.3185773691668 * "ADS"."Feature_18" + -58.02079575197723 * "ADS"."Feature_19" + 41.569974437464005 * "ADS"."Feature_20" + 378.4962241073077 * "ADS"."Feature_21" + -141.67752496395227 * "ADS"."Feature_22" + 93.98641327618267 * "ADS"."Feature_23" + -102.95017251881585 * "ADS"."Feature_24" + 68.48904047414197 * "ADS"."Feature_25" + 22.731571965158288 * "ADS"."Feature_26" + -187.46527244242512 * "ADS"."Feature_27" + 68.94556443564018 * "ADS"."Feature_28" + -404.8839668653274 * "ADS"."Feature_29" + 69.09050661874791 * "ADS"."Feature_30" + 24.178271459158623 * "ADS"."Feature_31" + -303.01126341261516 * "ADS"."Feature_32" + -181.90215213523257 * "ADS"."Feature_33" + 129.10135416393646 * "ADS"."Feature_34" + 337.44815765432213 * "ADS"."Feature_35" + 46.640604876265016 * "ADS"."Feature_36" + 55.90500969822218 * "ADS"."Feature_37" + 33.99262144807154 * "ADS"."Feature_38" + 96.5363582862057 * "ADS"."Feature_39" + 179.47029069892469 * "ADS"."Feature_40" + 127.18893429156452 * "ADS"."Feature_41" + -27.489780013952597 * "ADS"."Feature_42" + -27.010726545849607 * "ADS"."Feature_43" + -157.5621694346649 * "ADS"."Feature_44" + -148.96717638823623 * "ADS"."Feature_45" + -182.77708657658746 * "ADS"."Feature_46" + 199.86223236099707 * "ADS"."Feature_47" + 133.26354792564447 * "ADS"."Feature_48" + 3.224098736314411 * "ADS"."Feature_49" + -43.32209691160061 * "ADS"."Feature_50" + 52.11953913469599 * "ADS"."Feature_51" + 215.5606696332607 * "ADS"."Feature_52" + 96.63029561344935 * "ADS"."Feature_53" + 45.53640285930047 * "ADS"."Feature_54" + -37.39757781798226 * "ADS"."Feature_55" + 10.663776624138483 * "ADS"."Feature_56" + -72.7586173477655 * "ADS"."Feature_57" + 68.00645126272947 * "ADS"."Feature_58" + -163.29188836601153 * "ADS"."Feature_59" + -297.2858206642992 * "ADS"."Feature_60" + -101.49021518840033 * "ADS"."Feature_61" + -221.75104454848903 * "ADS"."Feature_62" + 271.76879412659235 * "ADS"."Feature_63" + 52.29884445952491 * "ADS"."Feature_64" + 115.10767035612247 * "ADS"."Feature_65" + -170.30443590588823 * "ADS"."Feature_66" + -107.2791784660558 * "ADS"."Feature_67" + 138.81252354661282 * "ADS"."Feature_68" + 66.10401010146906 * "ADS"."Feature_69" + -286.16606363817033 * "ADS"."Feature_70" + 221.31900852699556 * "ADS"."Feature_71" + 140.71307274598172 * "ADS"."Feature_72" + 238.67180153926225 * "ADS"."Feature_73" + -83.00523015088642 * "ADS"."Feature_74" + -162.89221903320163 * "ADS"."Feature_75" + 136.50072103274107 * "ADS"."Feature_76" + 17.703948389936574 * "ADS"."Feature_77" + -241.42708981717212 * "ADS"."Feature_78" + -43.02888939288023 * "ADS"."Feature_79" + 7.649573607067823 * "ADS"."Feature_80" + 70.88262970499521 * "ADS"."Feature_81" + 268.33789807028563 * "ADS"."Feature_82" + 629.6527675574795 * "ADS"."Feature_83" + 43.72342998812014 * "ADS"."Feature_84" + -168.4468842555664 * "ADS"."Feature_85" + -137.36168917531296 * "ADS"."Feature_86" + 145.99010807717104 * "ADS"."Feature_87" + -67.42228228797744 * "ADS"."Feature_88" + -88.63284638323185 * "ADS"."Feature_89" + 119.47521419108995 * "ADS"."Feature_90" + 423.34354035424116 * "ADS"."Feature_91" + -516.6614481089849 * "ADS"."Feature_92" + -53.83351915867402 * "ADS"."Feature_93" + 391.4431574916128 * "ADS"."Feature_94" + 225.37312153462472 * "ADS"."Feature_95" + -84.3107589193278 * "ADS"."Feature_96" + 34.90040816904698 * "ADS"."Feature_97" + 54.88077962852636 * "ADS"."Feature_98" + 111.74922961370966 * "ADS"."Feature_99" + -580.597560942 AS "Score_3" 
FROM "FourClass_100" AS "ADS"), 
orig_cte AS 
(SELECT linear_model_cte."KEY" AS "KEY", linear_model_cte."Score_0" AS "Score_0", linear_model_cte."Score_1" AS "Score_1", linear_model_cte."Score_2" AS "Score_2", linear_model_cte."Score_3" AS "Score_3", CAST(NULL AS FLOAT) AS "Proba_0", CAST(NULL AS FLOAT) AS "Proba_1", CAST(NULL AS FLOAT) AS "Proba_2", CAST(NULL AS FLOAT) AS "Proba_3", CAST(NULL AS FLOAT) AS "LogProba_0", CAST(NULL AS FLOAT) AS "LogProba_1", CAST(NULL AS FLOAT) AS "LogProba_2", CAST(NULL AS FLOAT) AS "LogProba_3", CAST(NULL AS FLOAT) AS "Decision" 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu."KEY" AS "KEY", scu.class AS class, scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY", 0 AS class, orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY", 1 AS class, orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY", 2 AS class, orig_cte."LogProba_2" AS "LogProba", orig_cte."Proba_2" AS "Proba", orig_cte."Score_2" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY", 3 AS class, orig_cte."LogProba_3" AS "LogProba", orig_cte."Proba_3" AS "Proba", orig_cte."Score_3" AS "Score" 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Score_2" AS "Score_2", orig_cte."Score_3" AS "Score_3", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."Proba_2" AS "Proba_2", orig_cte."Proba_3" AS "Proba_3", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."LogProba_2" AS "LogProba_2", orig_cte."LogProba_3" AS "LogProba_3", orig_cte."Decision" AS "Decision", (SELECT max(score_class_union."LogProba") AS max_1 
FROM score_class_union 
WHERE orig_cte."KEY" = score_class_union."KEY") AS "max_LogProba", (SELECT max(score_class_union."Proba") AS max_2 
FROM score_class_union 
WHERE orig_cte."KEY" = score_class_union."KEY") AS "max_Proba", (SELECT max(score_class_union."Score") AS max_3 
FROM score_class_union 
WHERE orig_cte."KEY" = score_class_union."KEY") AS "max_Score" 
FROM orig_cte), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."max_LogProba" AS "max_LogProba", score_max."max_Proba" AS "max_Proba", score_max."max_Score" AS "max_Score", (SELECT min(score_class_union.class) AS min_1 
FROM score_class_union 
WHERE score_max."max_LogProba" = score_class_union."LogProba" AND score_max."KEY" = score_class_union."KEY") AS "arg_max_LogProba", (SELECT min(score_class_union.class) AS min_2 
FROM score_class_union 
WHERE score_max."max_Proba" = score_class_union."Proba" AND score_max."KEY" = score_class_union."KEY") AS "arg_max_Proba", (SELECT min(score_class_union.class) AS min_3 
FROM score_class_union 
WHERE score_max."max_Score" = score_class_union."Score" AND score_max."KEY" = score_class_union."KEY") AS "arg_max_Score" 
FROM score_max)
 SELECT arg_max_cte."KEY" AS "KEY", arg_max_cte."Score_0" AS "Score_0", arg_max_cte."Score_1" AS "Score_1", arg_max_cte."Score_2" AS "Score_2", arg_max_cte."Score_3" AS "Score_3", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", arg_max_cte."Proba_2" AS "Proba_2", arg_max_cte."Proba_3" AS "Proba_3", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN ln(arg_max_cte."Proba_0") ELSE -1.79769313486231e+308 END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN ln(arg_max_cte."Proba_1") ELSE -1.79769313486231e+308 END AS "LogProba_1", CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN ln(arg_max_cte."Proba_2") ELSE -1.79769313486231e+308 END AS "LogProba_2", CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN ln(arg_max_cte."Proba_3") ELSE -1.79769313486231e+308 END AS "LogProba_3", arg_max_cte."arg_max_Score" AS "Decision" 
FROM arg_max_cte