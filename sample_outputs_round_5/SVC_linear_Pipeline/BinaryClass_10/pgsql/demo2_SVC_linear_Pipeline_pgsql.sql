-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "ADS_imp_1_OUT" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN -0.144694685376 ELSE "ADS"."Feature_0" END AS impter_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 0.136539860575 ELSE "ADS"."Feature_1" END AS impter_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN -0.0890914859533 ELSE "ADS"."Feature_2" END AS impter_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 0.103435478247 ELSE "ADS"."Feature_3" END AS impter_5, CASE WHEN ("ADS"."Feature_4" IS NULL) THEN -0.00337521979077 ELSE "ADS"."Feature_4" END AS impter_6, CASE WHEN ("ADS"."Feature_5" IS NULL) THEN 0.0381613922892 ELSE "ADS"."Feature_5" END AS impter_7, CASE WHEN ("ADS"."Feature_6" IS NULL) THEN -0.158816169582 ELSE "ADS"."Feature_6" END AS impter_8, CASE WHEN ("ADS"."Feature_7" IS NULL) THEN 0.0557119905648 ELSE "ADS"."Feature_7" END AS impter_9, CASE WHEN ("ADS"."Feature_8" IS NULL) THEN -0.107223999496 ELSE "ADS"."Feature_8" END AS impter_10, CASE WHEN ("ADS"."Feature_9" IS NULL) THEN -0.0118767283572 ELSE "ADS"."Feature_9" END AS impter_11 
FROM "BinaryClass_10" AS "ADS"), 
"ADS_sca_2_OUT" AS 
(SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".impter_2 AS FLOAT) - -0.144694685376) / 1.11117665546 AS scaler_2, (CAST("ADS_imp_1_OUT".impter_3 AS FLOAT) - 0.136539860575) / 1.14717478251 AS scaler_3, (CAST("ADS_imp_1_OUT".impter_4 AS FLOAT) - -0.0890914859533) / 1.23762206214 AS scaler_4, (CAST("ADS_imp_1_OUT".impter_5 AS FLOAT) - 0.103435478247) / 0.906807595117 AS scaler_5, (CAST("ADS_imp_1_OUT".impter_6 AS FLOAT) - -0.00337521979077) / 1.0204488132 AS scaler_6, (CAST("ADS_imp_1_OUT".impter_7 AS FLOAT) - 0.0381613922892) / 0.983383858949 AS scaler_7, (CAST("ADS_imp_1_OUT".impter_8 AS FLOAT) - -0.158816169582) / 1.03574315405 AS scaler_8, (CAST("ADS_imp_1_OUT".impter_9 AS FLOAT) - 0.0557119905648) / 1.08235863901 AS scaler_9, (CAST("ADS_imp_1_OUT".impter_10 AS FLOAT) - -0.107223999496) / 0.944906696302 AS scaler_10, (CAST("ADS_imp_1_OUT".impter_11 AS FLOAT) - -0.0118767283572) / 1.01138333972 AS scaler_11 
FROM "ADS_imp_1_OUT"), 
"SV_data" AS 
(SELECT "Values".sv_idx AS sv_idx, "Values".dual_coeff AS dual_coeff, "Values".sv_0 AS sv_0, "Values".sv_1 AS sv_1, "Values".sv_2 AS sv_2, "Values".sv_3 AS sv_3, "Values".sv_4 AS sv_4, "Values".sv_5 AS sv_5, "Values".sv_6 AS sv_6, "Values".sv_7 AS sv_7, "Values".sv_8 AS sv_8, "Values".sv_9 AS sv_9 
FROM (SELECT 0 AS sv_idx, -1.0 AS dual_coeff, -0.911855214472 AS sv_0, 0.257667287001 AS sv_1, 0.0840126814007 AS sv_2, 0.0383324856807 AS sv_3, -1.59130731332 AS sv_4, -1.93837120968 AS sv_5, 2.1380205623 AS sv_6, 0.182280428471 AS sv_7, -0.0360847398005 AS sv_8, 0.381763632847 AS sv_9 UNION ALL SELECT 1 AS sv_idx, -1.0 AS dual_coeff, -0.179301825622 AS sv_0, -0.0294991102911 AS sv_1, 0.7094748879 AS sv_2, -0.629794912987 AS sv_3, -0.0027622422503 AS sv_4, 0.729628812262 AS sv_5, -1.66353769169 AS sv_6, -0.306309579312 AS sv_7, 0.632448670971 AS sv_8, -1.82982167183 AS sv_9 UNION ALL SELECT 2 AS sv_idx, -1.0 AS dual_coeff, -1.1499723413 AS sv_0, -0.253062340313 AS sv_1, 0.746442859218 AS sv_2, -0.758601632207 AS sv_3, 1.6901485442 AS sv_4, 2.29721952269 AS sv_5, 1.17757588485 AS sv_6, -0.547473207484 AS sv_7, 0.759749897394 AS sv_8, 0.674063296221 AS sv_9 UNION ALL SELECT 3 AS sv_idx, -0.810932056861 AS dual_coeff, -0.0794547955361 AS sv_0, -0.0984708105704 AS sv_1, 0.528555159254 AS sv_2, -0.502265378708 AS sv_3, -0.720576023643 AS sv_4, 0.52189356696 AS sv_5, -1.11033349848 AS sv_6, 0.569436801212 AS sv_7, 0.503676090843 AS sv_8, 0.336844467502 AS sv_9 UNION ALL SELECT 4 AS sv_idx, -1.0 AS dual_coeff, 1.00941966038 AS sv_0, 0.137552800298 AS sv_1, 1.59316993342 AS sv_2, -1.3261351244 AS sv_3, 0.59448345217 AS sv_4, -1.9305746069 AS sv_5, -1.11388458417 AS sv_6, -0.158839846103 AS sv_7, 1.33360309751 AS sv_8, 0.190016520677 AS sv_9 UNION ALL SELECT 5 AS sv_idx, -1.0 AS dual_coeff, 0.289437900886 AS sv_0, 0.401941121287 AS sv_1, 0.376865517827 AS sv_2, -0.153990956994 AS sv_3, -0.628676815347 AS sv_4, -1.2912634072 AS sv_5, 0.627171782075 AS sv_6, 0.576414400675 AS sv_7, 0.158492384608 AS sv_8, -0.619202915223 AS sv_9 UNION ALL SELECT 6 AS sv_idx, -1.0 AS dual_coeff, -2.088422156 AS sv_0, 0.169317696395 AS sv_1, -0.432948430772 AS sv_2, 0.449744597707 AS sv_3, -3.04041926911 AS sv_4, -0.00990301053248 AS sv_5, 0.497177447242 AS sv_6, -0.424430504683 AS sv_7, -0.450243752161 AS sv_8, -0.906616631564 AS sv_9 UNION ALL SELECT 7 AS sv_idx, 0.2654211762 AS dual_coeff, -0.458305881756 AS sv_0, 0.440977551004 AS sv_1, 0.992277600403 AS sv_2, -0.672347405035 AS sv_3, -0.717905470117 AS sv_4, 0.565656310512 AS sv_5, 0.38081587822 AS sv_6, -1.99341085606 AS sv_7, 0.679629200482 AS sv_8, -0.730917080998 AS sv_9 UNION ALL SELECT 8 AS sv_idx, 0.159856557574 AS dual_coeff, 1.03357124306 AS sv_0, 0.880754831462 AS sv_1, 0.787597198893 AS sv_2, -0.304200822847 AS sv_3, -0.676337020964 AS sv_4, -1.11571540445 AS sv_5, 1.1258836667 AS sv_6, 1.09764258171 AS sv_7, 0.313909903799 AS sv_8, -0.545648922678 AS sv_9 UNION ALL SELECT 9 AS sv_idx, 0.119624959545 AS dual_coeff, 1.26030339965 AS sv_0, 0.746890105614 AS sv_1, 0.895135463476 AS sv_2, -0.455603457912 AS sv_3, -0.110559937801 AS sv_4, -0.703637795499 AS sv_5, 0.428953805013 AS sv_6, -1.1696719305 AS sv_7, 0.464756817083 AS sv_8, 1.98965827515 AS sv_9 UNION ALL SELECT 10 AS sv_idx, 1.0 AS dual_coeff, 0.582762446303 AS sv_0, 0.0746049272236 AS sv_1, 0.800876334699 AS sv_2, -0.664279931864 AS sv_3, -0.152446745656 AS sv_4, 0.0600864735684 AS sv_5, -0.205700490118 AS sv_6, -0.830608486255 AS sv_7, 0.668074442565 AS sv_8, 0.64726596561 AS sv_9 UNION ALL SELECT 11 AS sv_idx, 1.0 AS dual_coeff, -0.14204249076 AS sv_0, 0.72448007404 AS sv_1, 0.875619562269 AS sv_2, -0.448318906914 AS sv_3, -0.247516045253 AS sv_4, 0.421400034011 AS sv_5, 0.779384612955 AS sv_6, 0.564875980232 AS sv_7, 0.457227347622 AS sv_8, 0.500724377633 AS sv_9 UNION ALL SELECT 12 AS sv_idx, 1.0 AS dual_coeff, -0.83063180574 AS sv_0, 0.282576776368 AS sv_1, 0.478795268975 AS sv_2, -0.294246700958 AS sv_3, -1.46774524715 AS sv_4, -0.177734844657 AS sv_5, -0.539926471032 AS sv_6, -1.10599276512 AS sv_7, 0.298277055466 AS sv_8, -0.675075020207 AS sv_9 UNION ALL SELECT 13 AS sv_idx, 1.0 AS dual_coeff, -0.515644246242 AS sv_0, 0.196550665699 AS sv_1, 0.285703979655 AS sv_2, -0.163504658505 AS sv_3, -0.0454546775378 AS sv_4, -0.0789844508609 AS sv_5, -1.03990207478 AS sv_6, -0.922413591649 AS sv_7, 0.166116430985 AS sv_8, -0.695475975104 AS sv_9 UNION ALL SELECT 14 AS sv_idx, 0.228910353714 AS dual_coeff, -0.340074688411 AS sv_0, 0.694344583175 AS sv_1, 0.807554559366 AS sv_2, -0.402150467616 AS sv_3, 0.93167901026 AS sv_4, 0.0556888146968 AS sv_5, -1.38632219775 AS sv_6, 1.09860526336 AS sv_7, 0.410560253987 AS sv_8, 1.32497295811 AS sv_9 UNION ALL SELECT 15 AS sv_idx, 1.0 AS dual_coeff, 0.381006601699 AS sv_0, 0.333606961491 AS sv_1, 0.244392381622 AS sv_2, -0.0683205408197 AS sv_3, -1.28106313547 AS sv_4, -0.989366156397 AS sv_5, 1.14986219686 AS sv_6, 1.32421871201 AS sv_7, 0.0717797680904 AS sv_8, -0.626151732883 AS sv_9 UNION ALL SELECT 16 AS sv_idx, 0.921944047268 AS dual_coeff, -3.05672486699 AS sv_0, 0.301805492716 AS sv_1, 0.383459316238 AS sv_2, -0.20301822255 AS sv_3, 0.291953388245 AS sv_4, -0.785586647312 AS sv_5, 0.74649875411 AS sv_6, 0.94931232793 AS sv_7, 0.206804989953 AS sv_8, -1.63467445529 AS sv_9 UNION ALL SELECT 17 AS sv_idx, 0.115174962561 AS dual_coeff, 0.159030757939 AS sv_0, 0.739303769082 AS sv_1, 0.994429354543 AS sv_2, -0.545240761798 AS sv_3, -1.25680202678 AS sv_4, -0.988351641031 AS sv_5, -0.767573212612 AS sv_6, -1.53270820099 AS sv_7, 0.554739925243 AS sv_8, 0.513434152118 AS sv_9) AS "Values"), 
kernel_cte AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(full_join_data_sv.dot_prod1) + 0.0307545482062 AS dot_product 
FROM (SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", "SV_data".dual_coeff * ("ADS_sca_2_OUT".scaler_2 * "SV_data".sv_0 + "ADS_sca_2_OUT".scaler_3 * "SV_data".sv_1 + "ADS_sca_2_OUT".scaler_4 * "SV_data".sv_2 + "ADS_sca_2_OUT".scaler_5 * "SV_data".sv_3 + "ADS_sca_2_OUT".scaler_6 * "SV_data".sv_4 + "ADS_sca_2_OUT".scaler_7 * "SV_data".sv_5 + "ADS_sca_2_OUT".scaler_8 * "SV_data".sv_6 + "ADS_sca_2_OUT".scaler_9 * "SV_data".sv_7 + "ADS_sca_2_OUT".scaler_10 * "SV_data".sv_8 + "ADS_sca_2_OUT".scaler_11 * "SV_data".sv_9) AS dot_prod1 
FROM "ADS_sca_2_OUT", "SV_data") AS full_join_data_sv GROUP BY full_join_data_sv."KEY") AS t)
 SELECT kernel_cte."KEY" AS "KEY", -kernel_cte.dot_product AS "Score_0", kernel_cte.dot_product AS "Score_1", CAST(NULL AS FLOAT(53)) AS "Proba_0", CAST(NULL AS FLOAT(53)) AS "Proba_1", CAST(NULL AS FLOAT(53)) AS "LogProba_0", CAST(NULL AS FLOAT(53)) AS "LogProba_1", CASE WHEN (kernel_cte.dot_product >= 0.0) THEN 1 ELSE 0 END AS "Decision" 
FROM kernel_cte