-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "SV_data" AS 
(SELECT "Values".sv_idx AS sv_idx, "Values".dual_coeff AS dual_coeff, "Values".sv_0 AS sv_0, "Values".sv_1 AS sv_1, "Values".sv_2 AS sv_2, "Values".sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, 0.853527379752 AS dual_coeff, 2.70393684191 AS sv_0, 151.501854773 AS sv_1, 0.632842225624 AS sv_2, 6.41824506196 AS sv_3 UNION ALL SELECT 1 AS sv_idx, 1.0 AS dual_coeff, 16.0141165266 AS sv_0, 1476.0418898 AS sv_1, 0.58294998758 AS sv_2, 10.6198750494 AS sv_3 UNION ALL SELECT 2 AS sv_idx, -0.0830915649457 AS dual_coeff, 42.144958985 AS sv_0, 500.872714546 AS sv_1, 0.0956571395056 AS sv_2, 10.3107836811 AS sv_3 UNION ALL SELECT 3 AS sv_idx, -0.133216002015 AS dual_coeff, 99.3551358456 AS sv_0, 1576.02806992 AS sv_1, 0.356195046939 AS sv_2, 6.41831528385 AS sv_3 UNION ALL SELECT 4 AS sv_idx, -0.140466968706 AS dual_coeff, 6.45715461195 AS sv_0, 1262.19654867 AS sv_1, 0.285801470433 AS sv_2, 2.36804126228 AS sv_3 UNION ALL SELECT 5 AS sv_idx, 0.0732383068641 AS dual_coeff, 53.3353693624 AS sv_0, 1358.53519585 AS sv_1, 0.591136820581 AS sv_2, 6.83992101132 AS sv_3 UNION ALL SELECT 6 AS sv_idx, 0.710956269107 AS dual_coeff, 92.0639812104 AS sv_0, 1641.92218758 AS sv_1, 0.412118921184 AS sv_2, 9.91334532667 AS sv_3 UNION ALL SELECT 7 AS sv_idx, -1.0 AS dual_coeff, 23.3088545032 AS sv_0, 1577.87771899 AS sv_1, 0.175501610271 AS sv_2, 6.9067810832 AS sv_3 UNION ALL SELECT 8 AS sv_idx, 1.0 AS dual_coeff, 15.520595628 AS sv_0, 1737.6186625 AS sv_1, 0.861724112004 AS sv_2, 3.21227626713 AS sv_3 UNION ALL SELECT 9 AS sv_idx, 1.0 AS dual_coeff, 64.4512709735 AS sv_0, 1381.14262684 AS sv_1, 0.994186957655 AS sv_2, 5.9433455349 AS sv_3 UNION ALL SELECT 10 AS sv_idx, -0.0642492493568 AS dual_coeff, 68.2826332682 AS sv_0, 235.193601017 AS sv_1, 0.515053325578 AS sv_2, 8.9251367795 AS sv_3 UNION ALL SELECT 11 AS sv_idx, -0.539207028737 AS dual_coeff, 36.2239659876 AS sv_0, 562.49173591 AS sv_1, 0.400156284065 AS sv_2, 7.39112364012 AS sv_3 UNION ALL SELECT 12 AS sv_idx, -1.0 AS dual_coeff, 92.706419664 AS sv_0, 958.400944198 AS sv_1, 0.115999300757 AS sv_2, 5.56547087018 AS sv_3 UNION ALL SELECT 13 AS sv_idx, -0.883796289031 AS dual_coeff, 92.0217021784 AS sv_0, 319.444358438 AS sv_1, 0.681966635639 AS sv_2, 2.51713533822 AS sv_3 UNION ALL SELECT 14 AS sv_idx, -1.0 AS dual_coeff, 38.0335255515 AS sv_0, 217.280326631 AS sv_1, 0.136342299639 AS sv_2, 10.5350383876 AS sv_3 UNION ALL SELECT 15 AS sv_idx, 1.0 AS dual_coeff, 33.009258968 AS sv_0, 585.199770333 AS sv_1, 0.994186807215 AS sv_2, 4.15592606429 AS sv_3 UNION ALL SELECT 16 AS sv_idx, 1.0 AS dual_coeff, 46.0752951717 AS sv_0, 1279.48544127 AS sv_1, 0.77852915016 AS sv_2, 4.36366746106 AS sv_3 UNION ALL SELECT 17 AS sv_idx, -1.0 AS dual_coeff, 30.6319775223 AS sv_0, 982.559539503 AS sv_1, 0.0804668753197 AS sv_2, 4.08024346949 AS sv_3 UNION ALL SELECT 18 AS sv_idx, 1.0 AS dual_coeff, 85.581707376 AS sv_0, 1496.97436489 AS sv_1, 0.878496704086 AS sv_2, 2.9924813165 AS sv_3 UNION ALL SELECT 19 AS sv_idx, 1.0 AS dual_coeff, 15.7329104564 AS sv_0, 1065.73445735 AS sv_1, 0.821771370837 AS sv_2, 7.07383172408 AS sv_3 UNION ALL SELECT 20 AS sv_idx, -0.203714122923 AS dual_coeff, 82.0316121576 AS sv_0, 1426.4599998 AS sv_1, 0.401838813257 AS sv_2, 10.8751929925 AS sv_3 UNION ALL SELECT 21 AS sv_idx, -0.116973964697 AS dual_coeff, 73.4678692229 AS sv_0, 1723.176954 AS sv_1, 0.24718687183 AS sv_2, 1.47544642707 AS sv_3 UNION ALL SELECT 22 AS sv_idx, -0.082580452679 AS dual_coeff, 48.0509098483 AS sv_0, 473.420170695 AS sv_1, 0.18406955535 AS sv_2, 5.5379624014 AS sv_3 UNION ALL SELECT 23 AS sv_idx, -1.0 AS dual_coeff, 89.8594344228 AS sv_0, 1298.90543678 AS sv_1, 0.0333044544576 AS sv_2, 6.74999174116 AS sv_3 UNION ALL SELECT 24 AS sv_idx, -1.0 AS dual_coeff, 38.5160266554 AS sv_0, 1340.86956915 AS sv_1, 0.375725832365 AS sv_2, 8.62006271029 AS sv_3 UNION ALL SELECT 25 AS sv_idx, 1.0 AS dual_coeff, 75.1818453496 AS sv_0, 165.236715517 AS sv_1, 0.989073224803 AS sv_2, 3.0878030057 AS sv_3 UNION ALL SELECT 26 AS sv_idx, -1.0 AS dual_coeff, 15.3903469771 AS sv_0, 623.423375156 AS sv_1, 0.0221314051698 AS sv_2, 5.64387370319 AS sv_3 UNION ALL SELECT 27 AS sv_idx, 1.0 AS dual_coeff, 82.6212074764 AS sv_0, 948.260297555 AS sv_1, 0.730326311805 AS sv_2, 10.6034666437 AS sv_3 UNION ALL SELECT 28 AS sv_idx, 1.0 AS dual_coeff, 3.67218560255 AS sv_0, 1303.5134104 AS sv_1, 0.614151400643 AS sv_2, 9.26349685561 AS sv_3 UNION ALL SELECT 29 AS sv_idx, -1.0 AS dual_coeff, 4.74267726186 AS sv_0, 1305.93486415 AS sv_1, 0.330208883164 AS sv_2, 9.29746423425 AS sv_3 UNION ALL SELECT 30 AS sv_idx, -1.0 AS dual_coeff, 87.9338454805 AS sv_0, 1349.87563496 AS sv_1, 0.104456658697 AS sv_2, 2.12592578482 AS sv_3 UNION ALL SELECT 31 AS sv_idx, -0.464817550941 AS dual_coeff, 21.5707236542 AS sv_0, 386.315719055 AS sv_1, 0.312127303235 AS sv_2, 2.84218134596 AS sv_3 UNION ALL SELECT 32 AS sv_idx, -1.0 AS dual_coeff, 71.912971052 AS sv_0, 1441.5151757 AS sv_1, 0.2964527582 AS sv_2, 6.40244700485 AS sv_3 UNION ALL SELECT 33 AS sv_idx, 0.810176482369 AS dual_coeff, 90.8910848483 AS sv_0, 1341.30873023 AS sv_1, 0.605099108233 AS sv_2, 8.06975550741 AS sv_3 UNION ALL SELECT 34 AS sv_idx, 1.0 AS dual_coeff, 63.613607947 AS sv_0, 1737.16846848 AS sv_1, 0.49300478205 AS sv_2, 8.57319482819 AS sv_3 UNION ALL SELECT 35 AS sv_idx, 1.0 AS dual_coeff, 39.5902157092 AS sv_0, 1391.96009365 AS sv_1, 0.635618636403 AS sv_2, 3.27109416174 AS sv_3 UNION ALL SELECT 36 AS sv_idx, -1.0 AS dual_coeff, 57.8779285782 AS sv_0, 1297.11109024 AS sv_1, 0.0483230709022 AS sv_2, 9.64733440235 AS sv_3 UNION ALL SELECT 37 AS sv_idx, -1.0 AS dual_coeff, 84.5605047443 AS sv_0, 980.547241717 AS sv_1, 0.0787863196696 AS sv_2, 10.1964737327 AS sv_3 UNION ALL SELECT 38 AS sv_idx, -1.0 AS dual_coeff, 89.3349603448 AS sv_0, 1609.88461625 AS sv_1, 0.172112452122 AS sv_2, 10.2108634048 AS sv_3 UNION ALL SELECT 39 AS sv_idx, 0.0097957237153 AS dual_coeff, 14.5703994236 AS sv_0, 242.26536764 AS sv_1, 0.768903984463 AS sv_2, 10.7686214704 AS sv_3 UNION ALL SELECT 40 AS sv_idx, 1.0 AS dual_coeff, 75.1570295503 AS sv_0, 1056.25347524 AS sv_1, 0.949430358244 AS sv_2, 3.27969072547 AS sv_3 UNION ALL SELECT 41 AS sv_idx, -1.0 AS dual_coeff, 2.54747083489 AS sv_0, 1600.56296794 AS sv_1, 0.1197468871 AS sv_2, 3.45563874394 AS sv_3 UNION ALL SELECT 42 AS sv_idx, 1.0 AS dual_coeff, 94.5812099717 AS sv_0, 1195.36953849 AS sv_1, 0.898947451381 AS sv_2, 9.76479700054 AS sv_3 UNION ALL SELECT 43 AS sv_idx, -1.0 AS dual_coeff, 70.653527502 AS sv_0, 1344.94472994 AS sv_1, 0.0388293625608 AS sv_2, 2.89147498655 AS sv_3 UNION ALL SELECT 44 AS sv_idx, 0.254419032223 AS dual_coeff, 58.3935231147 AS sv_0, 157.273560329 AS sv_1, 0.684328822996 AS sv_2, 4.66838732542 AS sv_3 UNION ALL SELECT 45 AS sv_idx, 1.0 AS dual_coeff, 92.7158685446 AS sv_0, 328.006434599 AS sv_1, 0.935348155856 AS sv_2, 2.50622245212 AS sv_3) AS "Values"), 
kernel_cte AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(full_join_data_sv.dot_prod1) + -2389.97608223 AS dot_product 
FROM (SELECT "ADS"."KEY" AS "KEY", "SV_data".dual_coeff * ("ADS"."Feature_0" * "SV_data".sv_0 + "ADS"."Feature_1" * "SV_data".sv_1 + "ADS"."Feature_2" * "SV_data".sv_2 + "ADS"."Feature_3" * "SV_data".sv_3) AS dot_prod1 
FROM freidman2 AS "ADS", "SV_data") AS full_join_data_sv GROUP BY full_join_data_sv."KEY") AS t)
 SELECT kernel_cte."KEY" AS "KEY", kernel_cte.dot_product AS "Estimator" 
FROM kernel_cte