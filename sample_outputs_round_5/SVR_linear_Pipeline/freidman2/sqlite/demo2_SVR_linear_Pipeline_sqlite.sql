-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "ADS_imp_1_OUT" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 50.349658977 ELSE "ADS"."Feature_0" END AS imputer_output_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 979.992537783 ELSE "ADS"."Feature_1" END AS imputer_output_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 0.47532395986 ELSE "ADS"."Feature_2" END AS imputer_output_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 5.53723060497 ELSE "ADS"."Feature_3" END AS imputer_output_5 
FROM freidman2 AS "ADS"), 
"ADS_sca_2_OUT" AS 
(SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".imputer_output_2 AS FLOAT) - 50.349658977) / 25.9280116019 AS scaler_output_2, (CAST("ADS_imp_1_OUT".imputer_output_3 AS FLOAT) - 979.992537783) / 468.819676364 AS scaler_output_3, (CAST("ADS_imp_1_OUT".imputer_output_4 AS FLOAT) - 0.47532395986) / 0.271791665654 AS scaler_output_4, (CAST("ADS_imp_1_OUT".imputer_output_5 AS FLOAT) - 5.53723060497) / 2.69957638331 AS scaler_output_5 
FROM "ADS_imp_1_OUT"), 
"SV_data" AS 
(SELECT "Values".sv_idx AS sv_idx, "Values".dual_coeff AS dual_coeff, "Values".sv_0 AS sv_0, "Values".sv_1 AS sv_1, "Values".sv_2 AS sv_2, "Values".sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, 0.34907607272 AS dual_coeff, -1.60853880565 AS sv_0, -0.140492950844 AS sv_1, -0.0638547842042 AS sv_2, -1.59834528979 AS sv_3 UNION ALL SELECT 1 AS sv_idx, 1.0 AS dual_coeff, 0.0876760481102 AS sv_0, 1.34533388141 AS sv_1, -0.389163579726 AS sv_2, -0.0220623145327 AS sv_3 UNION ALL SELECT 2 AS sv_idx, 1.0 AS dual_coeff, -0.876738143026 AS sv_0, 0.999580175895 AS sv_1, -0.616123456866 AS sv_2, 0.257977835171 AS sv_3 UNION ALL SELECT 3 AS sv_idx, 1.0 AS dual_coeff, -0.0368844637109 AS sv_0, 1.230104213 AS sv_1, 0.93981890965 AS sv_2, 0.209126668014 AS sv_3 UNION ALL SELECT 4 AS sv_idx, -1.0 AS dual_coeff, 0.059359572207 AS sv_0, -1.13848418242 AS sv_1, 1.52718655041 AS sv_2, -0.242120548144 AS sv_3 UNION ALL SELECT 5 AS sv_idx, 1.0 AS dual_coeff, -0.0657409396956 AS sv_0, 1.59494799859 AS sv_1, 1.22365750462 AS sv_2, 0.635280167863 AS sv_3 UNION ALL SELECT 6 AS sv_idx, 1.0 AS dual_coeff, 1.05457022933 AS sv_0, 1.63241712172 AS sv_1, 0.569967043594 AS sv_2, -1.5933879488 AS sv_3 UNION ALL SELECT 7 AS sv_idx, 1.0 AS dual_coeff, 1.04310930777 AS sv_0, -0.121477321357 AS sv_1, 1.7194626835 AS sv_2, 0.176124522093 AS sv_3 UNION ALL SELECT 8 AS sv_idx, -1.0 AS dual_coeff, -0.97102706545 AS sv_0, -0.258955924979 AS sv_1, -0.906545426389 AS sv_2, 0.727617725408 AS sv_3 UNION ALL SELECT 9 AS sv_idx, -1.0 AS dual_coeff, -0.366063840043 AS sv_0, -1.49423531469 AS sv_1, -1.66759971323 AS sv_2, 0.275384930057 AS sv_3 UNION ALL SELECT 10 AS sv_idx, 0.65092392728 AS dual_coeff, 0.292017318693 AS sv_0, 0.23003786915 AS sv_1, -0.370730878547 AS sv_2, -1.48076382269 AS sv_3 UNION ALL SELECT 11 AS sv_idx, -1.0 AS dual_coeff, -1.48421476844 AS sv_0, -0.920198677603 AS sv_1, -0.0494744871607 AS sv_2, -0.265832928886 AS sv_3 UNION ALL SELECT 12 AS sv_idx, 1.0 AS dual_coeff, -1.32307372927 AS sv_0, 0.248678024004 AS sv_1, 1.11702739589 AS sv_2, -1.47303706928 AS sv_3 UNION ALL SELECT 13 AS sv_idx, 1.0 AS dual_coeff, -0.813222472003 AS sv_0, -0.395331208208 AS sv_1, 0.406399416806 AS sv_2, 1.15684493204 AS sv_3 UNION ALL SELECT 14 AS sv_idx, -1.0 AS dual_coeff, 0.814094686219 AS sv_0, -0.61133652383 AS sv_1, -1.65125165288 AS sv_2, 0.0521561216252 AS sv_3 UNION ALL SELECT 15 AS sv_idx, -1.0 AS dual_coeff, 1.80620052464 AS sv_0, -1.29996981768 AS sv_1, -1.10118449324 AS sv_2, 0.563025863135 AS sv_3 UNION ALL SELECT 16 AS sv_idx, 1.0 AS dual_coeff, 0.513932842145 AS sv_0, -0.00184459994553 AS sv_1, 0.812755475026 AS sv_2, 0.177106733892 AS sv_3 UNION ALL SELECT 17 AS sv_idx, 1.0 AS dual_coeff, 0.823387854096 AS sv_0, 1.01706255263 AS sv_1, 1.31741996595 AS sv_2, -1.63127704821 AS sv_3 UNION ALL SELECT 18 AS sv_idx, 1.0 AS dual_coeff, -1.78841155506 AS sv_0, 0.938743509308 AS sv_1, -0.230625616138 AS sv_2, 1.0657853464 AS sv_3 UNION ALL SELECT 19 AS sv_idx, 1.0 AS dual_coeff, -1.09429971151 AS sv_0, 0.200030331714 AS sv_1, 0.810589940856 AS sv_2, -1.17856753824 AS sv_3 UNION ALL SELECT 20 AS sv_idx, -1.0 AS dual_coeff, -1.37447794557 AS sv_0, -1.61720695123 AS sv_1, -0.201064380544 AS sv_2, -0.0129156124083 AS sv_3 UNION ALL SELECT 21 AS sv_idx, -1.0 AS dual_coeff, -0.906224698696 AS sv_0, 0.177891582864 AS sv_1, -1.17636434583 AS sv_2, 1.86669492523 AS sv_3 UNION ALL SELECT 22 AS sv_idx, 1.0 AS dual_coeff, -0.848597296666 AS sv_0, 0.691697684328 AS sv_1, -0.192805555095 AS sv_2, -0.433971948402 AS sv_3 UNION ALL SELECT 23 AS sv_idx, -1.0 AS dual_coeff, -0.19055165841 AS sv_0, -1.59857555511 AS sv_1, -1.22830057037 AS sv_2, 0.272205169651 AS sv_3 UNION ALL SELECT 24 AS sv_idx, 1.0 AS dual_coeff, -0.325656294629 AS sv_0, 0.446178771059 AS sv_1, -0.00892517623583 AS sv_2, 0.306295723066 AS sv_3 UNION ALL SELECT 25 AS sv_idx, -1.0 AS dual_coeff, 1.63603556395 AS sv_0, 1.04220727568 AS sv_1, -0.754503609658 AS sv_2, 0.626302203532 AS sv_3 UNION ALL SELECT 26 AS sv_idx, 1.0 AS dual_coeff, 1.01397199854 AS sv_0, -0.684480591614 AS sv_1, 1.85292730272 AS sv_2, 1.33371808382 AS sv_3 UNION ALL SELECT 27 AS sv_idx, 1.0 AS dual_coeff, 1.16016755993 AS sv_0, 0.53074413931 AS sv_1, -0.322925714298 AS sv_2, 0.495266768298 AS sv_3 UNION ALL SELECT 28 AS sv_idx, 1.0 AS dual_coeff, 1.6532653541 AS sv_0, -0.731810550848 AS sv_1, 0.908689740553 AS sv_2, 1.55576448849 AS sv_3 UNION ALL SELECT 29 AS sv_idx, -1.0 AS dual_coeff, 0.288665122281 AS sv_0, 0.579269837179 AS sv_1, -0.542609457397 AS sv_2, -1.24536474061 AS sv_3 UNION ALL SELECT 30 AS sv_idx, -1.0 AS dual_coeff, 1.02705332094 AS sv_0, -1.60467428334 AS sv_1, -1.59880423287 AS sv_2, -1.57478739365 AS sv_3 UNION ALL SELECT 31 AS sv_idx, -1.0 AS dual_coeff, -0.552578643521 AS sv_0, -0.442735297598 AS sv_1, -1.07079906702 AS sv_2, -1.46340543266 AS sv_3 UNION ALL SELECT 32 AS sv_idx, -1.0 AS dual_coeff, 0.48419735082 AS sv_0, -1.56405537822 AS sv_1, -0.301708665612 AS sv_2, -1.07716799349 AS sv_3 UNION ALL SELECT 33 AS sv_idx, -1.0 AS dual_coeff, 1.72306417363 AS sv_0, 0.237717846498 AS sv_1, -0.957837893342 AS sv_2, 0.400802963924 AS sv_3 UNION ALL SELECT 34 AS sv_idx, -1.0 AS dual_coeff, -0.0263674156079 AS sv_0, -1.55553138772 AS sv_1, -1.60680802453 AS sv_2, -0.572184084756 AS sv_3 UNION ALL SELECT 35 AS sv_idx, -1.0 AS dual_coeff, -1.10335674082 AS sv_0, 0.200213647903 AS sv_1, -0.734447908985 AS sv_2, 0.685399179549 AS sv_3 UNION ALL SELECT 36 AS sv_idx, -1.0 AS dual_coeff, -1.22598531132 AS sv_0, -1.36419163138 AS sv_1, -0.927460245323 AS sv_2, 0.932366684736 AS sv_3 UNION ALL SELECT 37 AS sv_idx, 1.0 AS dual_coeff, 1.85293288414 AS sv_0, 0.92361835862 AS sv_1, 0.780732700485 AS sv_2, -1.11227604365 AS sv_3 UNION ALL SELECT 38 AS sv_idx, -1.0 AS dual_coeff, 1.75135861388 AS sv_0, -1.81067509604 AS sv_1, -1.39015664443 AS sv_2, -1.04227721583 AS sv_3 UNION ALL SELECT 39 AS sv_idx, 1.0 AS dual_coeff, -0.376915891136 AS sv_0, 0.939930808645 AS sv_1, 0.861012242977 AS sv_2, 0.668371790068 AS sv_3 UNION ALL SELECT 40 AS sv_idx, 1.0 AS dual_coeff, -0.667055863199 AS sv_0, -0.424483668883 AS sv_1, 1.14330847866 AS sv_2, 1.23414003578 AS sv_3 UNION ALL SELECT 41 AS sv_idx, -1.0 AS dual_coeff, 0.685079639118 AS sv_0, -0.253640519265 AS sv_1, -0.603445209489 AS sv_2, 0.0462799899591 AS sv_3 UNION ALL SELECT 42 AS sv_idx, 1.0 AS dual_coeff, -1.73419414008 AS sv_0, 0.38125795842 AS sv_1, 1.14586802456 AS sv_2, -0.327237427985 AS sv_3 UNION ALL SELECT 43 AS sv_idx, 1.0 AS dual_coeff, -1.43506137236 AS sv_0, 0.272761315523 AS sv_1, 1.55212392342 AS sv_2, -0.811174038896 AS sv_3 UNION ALL SELECT 44 AS sv_idx, 1.0 AS dual_coeff, -1.22118071493 AS sv_0, 0.916648686232 AS sv_1, 0.536743992618 AS sv_2, 1.22312234511 AS sv_3 UNION ALL SELECT 45 AS sv_idx, 1.0 AS dual_coeff, 1.75043762654 AS sv_0, 1.06867932971 AS sv_1, 0.297890870093 AS sv_2, -1.52399436678 AS sv_3 UNION ALL SELECT 46 AS sv_idx, 1.0 AS dual_coeff, -0.0582650213693 AS sv_0, -0.489366646842 AS sv_1, 1.58155583738 AS sv_2, -1.23566067314 AS sv_3 UNION ALL SELECT 47 AS sv_idx, -1.0 AS dual_coeff, -0.189953912358 AS sv_0, -1.66263067545 AS sv_1, -1.38010120625 AS sv_2, -0.519196878543 AS sv_3 UNION ALL SELECT 48 AS sv_idx, -1.0 AS dual_coeff, 0.614202027199 AS sv_0, -1.32883927865 AS sv_1, 0.431543778554 AS sv_2, -0.857487643864 AS sv_3 UNION ALL SELECT 49 AS sv_idx, 1.0 AS dual_coeff, 0.15525358664 AS sv_0, 1.21293230253 AS sv_1, 0.826274517687 AS sv_2, 1.6077560704 AS sv_3 UNION ALL SELECT 50 AS sv_idx, -1.0 AS dual_coeff, -0.652262724257 AS sv_0, -0.454215434773 AS sv_1, -0.937558957646 AS sv_2, 0.966431730831 AS sv_3 UNION ALL SELECT 51 AS sv_idx, -1.0 AS dual_coeff, -1.10240571853 AS sv_0, -0.671256955004 AS sv_1, 0.252134288089 AS sv_2, -0.586819903556 AS sv_3 UNION ALL SELECT 52 AS sv_idx, -1.0 AS dual_coeff, 0.884989763399 AS sv_0, 1.12917963266 AS sv_1, -1.40768064054 AS sv_2, -0.422949089064 AS sv_3 UNION ALL SELECT 53 AS sv_idx, -1.0 AS dual_coeff, -1.53228761687 AS sv_0, 0.81142224353 AS sv_1, -0.707234605995 AS sv_2, -0.800862277466 AS sv_3 UNION ALL SELECT 54 AS sv_idx, 1.0 AS dual_coeff, -0.133987585642 AS sv_0, 0.864166224965 AS sv_1, 1.66969755239 AS sv_2, 0.987302605698 AS sv_3 UNION ALL SELECT 55 AS sv_idx, -1.0 AS dual_coeff, -0.456646218066 AS sv_0, 1.09240597781 AS sv_1, -1.38381595369 AS sv_2, 1.45975517504 AS sv_3 UNION ALL SELECT 56 AS sv_idx, -1.0 AS dual_coeff, 0.85054827902 AS sv_0, -1.81778898529 AS sv_1, 0.201597332685 AS sv_2, 1.40183366921 AS sv_3 UNION ALL SELECT 57 AS sv_idx, -1.0 AS dual_coeff, 1.02292973759 AS sv_0, 1.10450740744 AS sv_1, -0.770435389314 AS sv_2, 0.237422300469 AS sv_3 UNION ALL SELECT 58 AS sv_idx, -1.0 AS dual_coeff, 0.291003438543 AS sv_0, -1.29197649431 AS sv_1, 0.458316158656 AS sv_2, 0.612196086556 AS sv_3 UNION ALL SELECT 59 AS sv_idx, -1.0 AS dual_coeff, -0.260946375341 AS sv_0, -0.00319522012009 AS sv_1, -0.562204687807 AS sv_2, -1.22112350368 AS sv_3 UNION ALL SELECT 60 AS sv_idx, -1.0 AS dual_coeff, 0.432119734558 AS sv_0, -0.0223287479945 AS sv_1, -1.10636851596 AS sv_2, -0.456321603916 AS sv_3 UNION ALL SELECT 61 AS sv_idx, -1.0 AS dual_coeff, 0.257051196715 AS sv_0, -0.937064851208 AS sv_1, -0.312383846675 AS sv_2, 1.75076745957 AS sv_3 UNION ALL SELECT 62 AS sv_idx, 1.0 AS dual_coeff, 0.955115625152 AS sv_0, 0.90839671184 AS sv_1, 1.05900842715 AS sv_2, -0.947770519019 AS sv_3 UNION ALL SELECT 63 AS sv_idx, 1.0 AS dual_coeff, -0.101208315099 AS sv_0, 0.158239990857 AS sv_1, 0.937621313842 AS sv_2, 1.90117235797 AS sv_3 UNION ALL SELECT 64 AS sv_idx, 1.0 AS dual_coeff, 0.75225229385 AS sv_0, 1.31467664881 AS sv_1, 1.30542012404 AS sv_2, -0.269416003327 AS sv_3 UNION ALL SELECT 65 AS sv_idx, 1.0 AS dual_coeff, 0.303180379399 AS sv_0, 0.967972777167 AS sv_1, 0.847016963879 AS sv_2, -0.480003646945 AS sv_3 UNION ALL SELECT 66 AS sv_idx, 1.0 AS dual_coeff, -1.13484068481 AS sv_0, 1.30339788543 AS sv_1, 0.139536136559 AS sv_2, 0.611963897569 AS sv_3) AS "Values"), 
kernel_cte AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(full_join_data_sv.dot_prod1) + 422.343403057 AS dot_product 
FROM (SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", "SV_data".dual_coeff * ("ADS_sca_2_OUT".scaler_output_2 * "SV_data".sv_0 + "ADS_sca_2_OUT".scaler_output_3 * "SV_data".sv_1 + "ADS_sca_2_OUT".scaler_output_4 * "SV_data".sv_2 + "ADS_sca_2_OUT".scaler_output_5 * "SV_data".sv_3) AS dot_prod1 
FROM "ADS_sca_2_OUT", "SV_data") AS full_join_data_sv GROUP BY full_join_data_sv."KEY") AS t)
 SELECT kernel_cte."KEY" AS "KEY", kernel_cte.dot_product AS "Estimator" 
FROM kernel_cte