-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 51.3998759335 ELSE `ADS`.`Feature_0` END AS imputer_output_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 939.151129631 ELSE `ADS`.`Feature_1` END AS imputer_output_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 0.461938726977 ELSE `ADS`.`Feature_2` END AS imputer_output_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 6.2089452982 ELSE `ADS`.`Feature_3` END AS imputer_output_5 
FROM freidman3 AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.imputer_output_2 AS DOUBLE) - 51.3998759335) / 27.531453207 AS scaler_output_2, (CAST(`ADS_imp_1_OUT`.imputer_output_3 AS DOUBLE) - 939.151129631) / 498.788264524 AS scaler_output_3, (CAST(`ADS_imp_1_OUT`.imputer_output_4 AS DOUBLE) - 0.461938726977) / 0.26875923647 AS scaler_output_4, (CAST(`ADS_imp_1_OUT`.imputer_output_5 AS DOUBLE) - 6.2089452982) / 2.93392244972 AS scaler_output_5 
FROM `ADS_imp_1_OUT`), 
`SV_data` AS 
(SELECT `Values`.sv_idx AS sv_idx, `Values`.dual_coeff AS dual_coeff, `Values`.sv_0 AS sv_0, `Values`.sv_1 AS sv_1, `Values`.sv_2 AS sv_2, `Values`.sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, 1.0 AS dual_coeff, -0.591735883615 AS sv_0, -0.787032481908 AS sv_1, -0.343649579426 AS sv_2, 0.965438413949 AS sv_3 UNION ALL SELECT 1 AS sv_idx, -1.0 AS dual_coeff, 1.3664396643 AS sv_0, 0.408431681639 AS sv_1, -1.67690364581 AS sv_2, -0.703193173873 AS sv_3 UNION ALL SELECT 2 AS sv_idx, -1.0 AS dual_coeff, -1.73218101173 AS sv_0, 0.148493699245 AS sv_1, 1.62030001392 AS sv_2, 0.928189855836 AS sv_3 UNION ALL SELECT 3 AS sv_idx, 1.0 AS dual_coeff, -0.568332775629 AS sv_0, -0.42531371394 AS sv_1, -0.81936821531 AS sv_2, -0.974075401217 AS sv_3 UNION ALL SELECT 4 AS sv_idx, -1.0 AS dual_coeff, 1.55835538207 AS sv_0, -1.49896452375 AS sv_1, -1.15710615379 AS sv_2, 1.51686767426 AS sv_3 UNION ALL SELECT 5 AS sv_idx, 0.971990618129 AS dual_coeff, 0.410088029157 AS sv_0, -0.435915557895 AS sv_1, -0.123710914809 AS sv_2, -0.692503114133 AS sv_3 UNION ALL SELECT 6 AS sv_idx, -1.0 AS dual_coeff, -0.655231827847 AS sv_0, -1.55433516509 AS sv_1, -1.57854068397 AS sv_2, -0.948510526909 AS sv_3 UNION ALL SELECT 7 AS sv_idx, 0.0886606040415 AS dual_coeff, 0.546291514777 AS sv_0, 0.169886022613 AS sv_1, -0.225204624994 AS sv_2, 1.41448857486 AS sv_3 UNION ALL SELECT 8 AS sv_idx, -0.897068535959 AS dual_coeff, -1.79401172825 AS sv_0, 1.34078832108 AS sv_1, 0.457920627213 AS sv_2, 0.562649663374 AS sv_3 UNION ALL SELECT 9 AS sv_idx, 1.0 AS dual_coeff, 1.05671482202 AS sv_0, -0.396666276395 AS sv_1, -0.440948589686 AS sv_2, 1.61189911885 AS sv_3 UNION ALL SELECT 10 AS sv_idx, -1.0 AS dual_coeff, -0.707582245013 AS sv_0, 0.910562181702 AS sv_1, 1.69065812832 AS sv_2, 1.48052739004 AS sv_3 UNION ALL SELECT 11 AS sv_idx, -1.0 AS dual_coeff, -1.00711201573 AS sv_0, -1.2444655718 AS sv_1, -1.58652147394 AS sv_2, -1.00595779329 AS sv_3 UNION ALL SELECT 12 AS sv_idx, -1.0 AS dual_coeff, -0.758895500464 AS sv_0, 1.52092710231 AS sv_1, 1.83973047639 AS sv_2, 1.25698596518 AS sv_3 UNION ALL SELECT 13 AS sv_idx, 0.312546818023 AS dual_coeff, 0.801237927635 AS sv_0, -0.562040419705 AS sv_1, 0.405769913952 AS sv_2, 1.32040096937 AS sv_3 UNION ALL SELECT 14 AS sv_idx, 1.0 AS dual_coeff, -1.07040035523 AS sv_0, -0.389081970136 AS sv_1, -0.777478911123 AS sv_2, 0.969951297307 AS sv_3 UNION ALL SELECT 15 AS sv_idx, 1.0 AS dual_coeff, 1.15276902514 AS sv_0, 0.284024789891 AS sv_1, -0.308041570143 AS sv_2, 1.23819813081 AS sv_3 UNION ALL SELECT 16 AS sv_idx, 0.25671083886 AS dual_coeff, -1.66413260645 AS sv_0, -0.82236164321 AS sv_1, 0.567810248143 AS sv_2, -1.21458754963 AS sv_3 UNION ALL SELECT 17 AS sv_idx, -0.160576049565 AS dual_coeff, -0.531748003535 AS sv_0, 1.50975946076 AS sv_1, 0.312716589607 AS sv_2, 0.0923369759111 AS sv_3 UNION ALL SELECT 18 AS sv_idx, -1.0 AS dual_coeff, 0.215470098469 AS sv_0, -0.818920989434 AS sv_1, -1.49638626425 AS sv_2, -0.807155511785 AS sv_3 UNION ALL SELECT 19 AS sv_idx, -1.0 AS dual_coeff, 0.992144431321 AS sv_0, -0.697305934343 AS sv_1, -1.21895694156 AS sv_2, 1.26656398715 AS sv_3 UNION ALL SELECT 20 AS sv_idx, 0.392718405534 AS dual_coeff, -0.00583184984957 AS sv_0, 0.42522531861 AS sv_1, -0.221518165479 AS sv_2, -1.58574374992 AS sv_3 UNION ALL SELECT 21 AS sv_idx, -0.134601198726 AS dual_coeff, -0.79943400089 AS sv_0, -0.406162476735 AS sv_1, 1.80865449952 AS sv_2, -0.671981414846 AS sv_3 UNION ALL SELECT 22 AS sv_idx, -0.292940735514 AS dual_coeff, 1.39260977486 AS sv_0, 0.821145352884 AS sv_1, -1.39037839605 AS sv_2, 0.799032368685 AS sv_3 UNION ALL SELECT 23 AS sv_idx, 1.0 AS dual_coeff, -1.05137505264 AS sv_0, -1.2422925868 AS sv_1, -0.0899573255628 AS sv_2, -0.975718239301 AS sv_3 UNION ALL SELECT 24 AS sv_idx, 1.0 AS dual_coeff, -1.45766709787 AS sv_0, -1.44631531002 AS sv_1, -0.198505140682 AS sv_2, 1.43679852834 AS sv_3 UNION ALL SELECT 25 AS sv_idx, 0.0569370011493 AS dual_coeff, -1.66695932278 AS sv_0, 0.436628512048 AS sv_1, -0.374209619141 AS sv_2, -0.909952492457 AS sv_3 UNION ALL SELECT 26 AS sv_idx, -1.0 AS dual_coeff, 1.02816994237 AS sv_0, -1.17799747615 AS sv_1, -1.6707703666 AS sv_2, -1.71471161569 AS sv_3 UNION ALL SELECT 27 AS sv_idx, 0.259918499166 AS dual_coeff, 1.07568179187 AS sv_0, -0.835041648033 AS sv_1, -0.22868103079 AS sv_2, 0.604637927165 AS sv_3 UNION ALL SELECT 28 AS sv_idx, -0.607102191682 AS dual_coeff, 1.26207456581 AS sv_0, -1.46274728759 AS sv_1, 0.394848571344 AS sv_2, 0.222385742566 AS sv_3 UNION ALL SELECT 29 AS sv_idx, 0.587058427043 AS dual_coeff, -0.666476790867 AS sv_0, 0.853802432485 AS sv_1, -1.13169800856 AS sv_2, -0.537708547256 AS sv_3 UNION ALL SELECT 30 AS sv_idx, 1.0 AS dual_coeff, 0.0648015109547 AS sv_0, -0.31464906991 AS sv_1, -0.310988213622 AS sv_2, 0.854103115079 AS sv_3 UNION ALL SELECT 31 AS sv_idx, 0.46711295205 AS dual_coeff, 1.15217037304 AS sv_0, 1.03621552298 AS sv_1, -0.692254405014 AS sv_2, -0.365208919815 AS sv_3 UNION ALL SELECT 32 AS sv_idx, -1.0 AS dual_coeff, -1.03925606998 AS sv_0, -1.42528610306 AS sv_1, -1.58675624354 AS sv_2, 0.663807548546 AS sv_3 UNION ALL SELECT 33 AS sv_idx, -0.30136545255 AS dual_coeff, 0.0793522055867 AS sv_0, 0.621505379001 AS sv_1, 1.67208430787 AS sv_2, -1.53702078509 AS sv_3 UNION ALL SELECT 34 AS sv_idx, 1.0 AS dual_coeff, -0.718239776053 AS sv_0, -1.09220051794 AS sv_1, -0.563368503379 AS sv_2, -0.740582182717 AS sv_3 UNION ALL SELECT 35 AS sv_idx, 1.0 AS dual_coeff, 1.13764755058 AS sv_0, 1.27470147517 AS sv_1, -0.721820742595 AS sv_2, -0.679704021354 AS sv_3) AS `Values`), 
kernel_cte AS 
(SELECT t.`KEY` AS `KEY`, t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv.`KEY` AS `KEY`, sum(full_join_data_sv.dot_prod1) + 1.31966651452 AS dot_product 
FROM (SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, `SV_data`.dual_coeff * (`ADS_sca_2_OUT`.scaler_output_2 * `SV_data`.sv_0 + `ADS_sca_2_OUT`.scaler_output_3 * `SV_data`.sv_1 + `ADS_sca_2_OUT`.scaler_output_4 * `SV_data`.sv_2 + `ADS_sca_2_OUT`.scaler_output_5 * `SV_data`.sv_3) AS dot_prod1 
FROM `ADS_sca_2_OUT`, `SV_data`) AS full_join_data_sv GROUP BY full_join_data_sv.`KEY`) AS t)
 SELECT kernel_cte.`KEY` AS `KEY`, kernel_cte.dot_product AS `Estimator` 
FROM kernel_cte