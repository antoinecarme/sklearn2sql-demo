-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 47.7562586609 ELSE `ADS`.`Feature_0` END AS imputer_output_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 869.989032656 ELSE `ADS`.`Feature_1` END AS imputer_output_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 0.531668423619 ELSE `ADS`.`Feature_2` END AS imputer_output_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 5.43377329014 ELSE `ADS`.`Feature_3` END AS imputer_output_5 
FROM freidman3 AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.imputer_output_2 AS DOUBLE) - 47.7562586609) / 25.4644344824 AS scaler_output_2, (CAST(`ADS_imp_1_OUT`.imputer_output_3 AS DOUBLE) - 869.989032656) / 454.312248061 AS scaler_output_3, (CAST(`ADS_imp_1_OUT`.imputer_output_4 AS DOUBLE) - 0.531668423619) / 0.281130266744 AS scaler_output_4, (CAST(`ADS_imp_1_OUT`.imputer_output_5 AS DOUBLE) - 5.43377329014) / 2.99023281264 AS scaler_output_5 
FROM `ADS_imp_1_OUT`), 
`SV_data` AS 
(SELECT `Values`.sv_idx AS sv_idx, `Values`.dual_coeff AS dual_coeff, `Values`.sv_0 AS sv_0, `Values`.sv_1 AS sv_1, `Values`.sv_2 AS sv_2, `Values`.sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, 1.0 AS dual_coeff, -1.06223010573 AS sv_0, 0.254441687596 AS sv_1, -0.183680291006 AS sv_2, 1.65394839817 AS sv_3 UNION ALL SELECT 1 AS sv_idx, -1.0 AS dual_coeff, 0.975372545792 AS sv_0, -1.36379763296 AS sv_1, -1.31603326711 AS sv_2, -0.208177475213 AS sv_3 UNION ALL SELECT 2 AS sv_idx, -0.732016444512 AS dual_coeff, -1.16663174412 AS sv_0, 0.616558698658 AS sv_1, 1.26927389095 AS sv_2, 0.958943506747 AS sv_3 UNION ALL SELECT 3 AS sv_idx, -1.0 AS dual_coeff, -0.101815095645 AS sv_0, -1.57434399756 AS sv_1, -0.785961878418 AS sv_2, 1.68533338015 AS sv_3 UNION ALL SELECT 4 AS sv_idx, -0.5461959096 AS dual_coeff, -1.2757536664 AS sv_0, 0.745749689286 AS sv_1, 0.862664335497 AS sv_2, -0.879296599973 AS sv_3 UNION ALL SELECT 5 AS sv_idx, 0.0144263540798 AS dual_coeff, -0.664818831474 AS sv_0, -1.1795718272 AS sv_1, -1.30243498819 AS sv_2, -0.992505540827 AS sv_3 UNION ALL SELECT 6 AS sv_idx, 1.0 AS dual_coeff, -0.0830665981202 AS sv_0, 0.71372339462 AS sv_1, -1.05413361704 AS sv_2, -1.42658803638 AS sv_3 UNION ALL SELECT 7 AS sv_idx, 0.62927355123 AS dual_coeff, -0.899191450806 AS sv_0, 1.79192158666 AS sv_1, -0.949505755658 AS sv_2, -1.45090404058 AS sv_3 UNION ALL SELECT 8 AS sv_idx, -0.860596237575 AS dual_coeff, -0.255650037159 AS sv_0, -0.470959441341 AS sv_1, 1.61474149261 AS sv_2, -0.617105734824 AS sv_3 UNION ALL SELECT 9 AS sv_idx, -0.329700692264 AS dual_coeff, -1.72976267601 AS sv_0, 1.91361448131 AS sv_1, 0.685628491751 AS sv_2, 1.29313425862 AS sv_3 UNION ALL SELECT 10 AS sv_idx, -0.223161188916 AS dual_coeff, -0.0698414959752 AS sv_0, 1.67655167261 AS sv_1, 1.03498441063 AS sv_2, 1.66418647376 AS sv_3 UNION ALL SELECT 11 AS sv_idx, -1.0 AS dual_coeff, 0.564513325326 AS sv_0, 0.935151921342 AS sv_1, -1.86350308011 AS sv_2, 1.55996203409 AS sv_3 UNION ALL SELECT 12 AS sv_idx, 0.0747015160976 AS dual_coeff, 0.645669362641 AS sv_0, -0.205557289057 AS sv_1, -0.61076801439 AS sv_2, -0.792018943719 AS sv_3 UNION ALL SELECT 13 AS sv_idx, 1.0 AS dual_coeff, -1.83510776617 AS sv_0, -1.29941970165 AS sv_1, -1.15137598095 AS sv_2, 0.49314676865 AS sv_3 UNION ALL SELECT 14 AS sv_idx, -1.0 AS dual_coeff, 1.36395055076 AS sv_0, 0.14731078308 AS sv_1, -1.74229432507 AS sv_2, 0.150159617644 AS sv_3 UNION ALL SELECT 15 AS sv_idx, -1.0 AS dual_coeff, -0.231388126217 AS sv_0, -0.55654680756 AS sv_1, -1.74973603843 AS sv_2, 0.00788807217237 AS sv_3 UNION ALL SELECT 16 AS sv_idx, 1.0 AS dual_coeff, -1.01378065359 AS sv_0, 0.410685558101 AS sv_1, -0.642075744564 AS sv_2, 0.347938225281 AS sv_3 UNION ALL SELECT 17 AS sv_idx, 1.0 AS dual_coeff, -0.883209098974 AS sv_0, -1.36746494057 AS sv_1, -0.849446873031 AS sv_2, -1.29242425865 AS sv_3 UNION ALL SELECT 18 AS sv_idx, 0.949702119968 AS dual_coeff, 1.30254705602 AS sv_0, -0.140471759342 AS sv_1, -0.85282479716 AS sv_2, -1.33795171114 AS sv_3 UNION ALL SELECT 19 AS sv_idx, -1.0 AS dual_coeff, 0.152810509329 AS sv_0, -0.684420171822 AS sv_1, -1.71046558867 AS sv_2, -0.756525460436 AS sv_3 UNION ALL SELECT 20 AS sv_idx, 1.0 AS dual_coeff, 1.46414712318 AS sv_0, -0.404480352534 AS sv_1, -0.241927197836 AS sv_2, 0.866861359015 AS sv_3 UNION ALL SELECT 21 AS sv_idx, -0.64190276706 AS dual_coeff, -0.362788978707 AS sv_0, 0.00250910562144 AS sv_1, 1.34872131317 AS sv_2, -1.37223617241 AS sv_3 UNION ALL SELECT 22 AS sv_idx, 1.0 AS dual_coeff, -0.338028791596 AS sv_0, -0.0826983529645 AS sv_1, -0.556851822372 AS sv_2, 0.494200423818 AS sv_3 UNION ALL SELECT 23 AS sv_idx, -0.596045523299 AS dual_coeff, -0.718052162712 AS sv_0, -1.55286448076 AS sv_1, 1.49357547966 AS sv_2, -0.0165979949442 AS sv_3 UNION ALL SELECT 24 AS sv_idx, -0.644708006729 AS dual_coeff, 0.431122845326 AS sv_0, 1.28530268715 AS sv_1, 1.09179298882 AS sv_2, -0.0969805199722 AS sv_3 UNION ALL SELECT 25 AS sv_idx, 1.0 AS dual_coeff, 1.86023701825 AS sv_0, 0.104088928534 AS sv_1, -0.461259734418 AS sv_2, -1.41847901617 AS sv_3 UNION ALL SELECT 26 AS sv_idx, 1.0 AS dual_coeff, 1.39820758868 AS sv_0, 0.0133823791101 AS sv_1, -0.591346943393 AS sv_2, -0.465439448824 AS sv_3 UNION ALL SELECT 27 AS sv_idx, 1.0 AS dual_coeff, 0.167110869128 AS sv_0, -0.887158318245 AS sv_1, 0.0205784644697 AS sv_2, 1.86063952019 AS sv_3 UNION ALL SELECT 28 AS sv_idx, 0.933162735772 AS dual_coeff, 0.50473091844 AS sv_0, 0.328513006764 AS sv_1, -0.595314709334 AS sv_2, 0.570469485802 AS sv_3 UNION ALL SELECT 29 AS sv_idx, 0.0771810126113 AS dual_coeff, 0.123172502021 AS sv_0, -0.957314846923 AS sv_1, -0.318156474127 AS sv_2, -0.88450955068 AS sv_3 UNION ALL SELECT 30 AS sv_idx, -1.0 AS dual_coeff, 0.188154894418 AS sv_0, 1.23621495355 AS sv_1, -1.80201543765 AS sv_2, -0.886202076593 AS sv_3 UNION ALL SELECT 31 AS sv_idx, -1.0 AS dual_coeff, -0.826744915138 AS sv_0, -1.16104464964 AS sv_1, -1.60539775351 AS sv_2, -0.321061897839 AS sv_3 UNION ALL SELECT 32 AS sv_idx, -0.798452715005 AS dual_coeff, 1.35940632044 AS sv_0, -0.311725578916 AS sv_1, -1.48493360729 AS sv_2, -1.16110650526 AS sv_3 UNION ALL SELECT 33 AS sv_idx, 0.0298198626401 AS dual_coeff, -0.32048604429 AS sv_0, -1.01956390588 AS sv_1, 0.0901828145072 AS sv_2, -1.19652775163 AS sv_3 UNION ALL SELECT 34 AS sv_idx, -0.0498848821644 AS dual_coeff, 0.0450940964331 AS sv_0, 1.93243805163 AS sv_1, 0.559246476566 AS sv_2, -0.93741092386 AS sv_3 UNION ALL SELECT 35 AS sv_idx, 0.157123335476 AS dual_coeff, -1.81051433899 AS sv_0, 0.885664744094 AS sv_1, -0.602854223636 AS sv_2, -1.3842645098 AS sv_3 UNION ALL SELECT 36 AS sv_idx, 0.557273879251 AS dual_coeff, -0.344301724179 AS sv_0, -0.765749341746 AS sv_1, 0.033842186677 AS sv_2, 1.2283009949 AS sv_3) AS `Values`), 
kernel_cte AS 
(SELECT t.`KEY` AS `KEY`, t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv.`KEY` AS `KEY`, sum(full_join_data_sv.dot_prod1) + 1.31462260699 AS dot_product 
FROM (SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, `SV_data`.dual_coeff * (`ADS_sca_2_OUT`.scaler_output_2 * `SV_data`.sv_0 + `ADS_sca_2_OUT`.scaler_output_3 * `SV_data`.sv_1 + `ADS_sca_2_OUT`.scaler_output_4 * `SV_data`.sv_2 + `ADS_sca_2_OUT`.scaler_output_5 * `SV_data`.sv_3) AS dot_prod1 
FROM `ADS_sca_2_OUT`, `SV_data`) AS full_join_data_sv GROUP BY full_join_data_sv.`KEY`) AS t)
 SELECT kernel_cte.`KEY` AS `KEY`, kernel_cte.dot_product AS `Estimator` 
FROM kernel_cte