-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 45.2888673107 ELSE `ADS`.`Feature_0` END AS imputer_output_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 953.855962947 ELSE `ADS`.`Feature_1` END AS imputer_output_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 0.520519009945 ELSE `ADS`.`Feature_2` END AS imputer_output_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 6.60280008459 ELSE `ADS`.`Feature_3` END AS imputer_output_5 
FROM freidman2 AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.imputer_output_2 AS DOUBLE) - 45.2888673107) / 24.7285616108 AS scaler_output_2, (CAST(`ADS_imp_1_OUT`.imputer_output_3 AS DOUBLE) - 953.855962947) / 480.854609686 AS scaler_output_3, (CAST(`ADS_imp_1_OUT`.imputer_output_4 AS DOUBLE) - 0.520519009945) / 0.298172682258 AS scaler_output_4, (CAST(`ADS_imp_1_OUT`.imputer_output_5 AS DOUBLE) - 6.60280008459) / 2.76797218823 AS scaler_output_5 
FROM `ADS_imp_1_OUT`), 
`SV_data` AS 
(SELECT `Values`.sv_idx AS sv_idx, `Values`.dual_coeff AS dual_coeff, `Values`.sv_0 AS sv_0, `Values`.sv_1 AS sv_1, `Values`.sv_2 AS sv_2, `Values`.sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, 1.0 AS dual_coeff, -1.19131380241 AS sv_0, 0.0565680762663 AS sv_1, -0.0975069247666 AS sv_2, -0.370593158855 AS sv_3 UNION ALL SELECT 1 AS sv_idx, -1.0 AS dual_coeff, 0.0399563373657 AS sv_0, -0.517398665725 AS sv_1, -0.642731706477 AS sv_2, -0.914535614465 AS sv_3 UNION ALL SELECT 2 AS sv_idx, -1.0 AS dual_coeff, 0.0185765732206 AS sv_0, -1.55031908569 AS sv_1, 0.173467277428 AS sv_2, 0.160844908339 AS sv_3 UNION ALL SELECT 3 AS sv_idx, -1.0 AS dual_coeff, 0.0316319840032 AS sv_0, 0.40613378402 AS sv_1, -0.813211119659 AS sv_2, -0.466527082007 AS sv_3 UNION ALL SELECT 4 AS sv_idx, 1.0 AS dual_coeff, 1.37945485304 AS sv_0, -0.196603877261 AS sv_1, 0.954284636113 AS sv_2, 0.853649346532 AS sv_3 UNION ALL SELECT 5 AS sv_idx, 1.0 AS dual_coeff, -0.841772227763 AS sv_0, -0.730899547544 AS sv_1, 1.00632049301 AS sv_2, 1.46201501628 AS sv_3 UNION ALL SELECT 6 AS sv_idx, -1.0 AS dual_coeff, -0.0518629796297 AS sv_0, -0.277622311854 AS sv_1, -1.32182812366 AS sv_2, -0.342439279121 AS sv_3 UNION ALL SELECT 7 AS sv_idx, 1.0 AS dual_coeff, -1.27025230258 AS sv_0, -0.265675493499 AS sv_1, 0.0102559133781 AS sv_2, 1.22162124993 AS sv_3 UNION ALL SELECT 8 AS sv_idx, -1.0 AS dual_coeff, -0.643242867026 AS sv_0, -1.19117832415 AS sv_1, 0.249536694695 AS sv_2, 0.663996135841 AS sv_3 UNION ALL SELECT 9 AS sv_idx, 1.0 AS dual_coeff, -0.893720486343 AS sv_0, -0.0393194504759 AS sv_1, 0.997606032391 AS sv_2, 0.494208222741 AS sv_3 UNION ALL SELECT 10 AS sv_idx, -1.0 AS dual_coeff, -0.895457393767 AS sv_0, -1.03202391081 AS sv_1, 0.611047055949 AS sv_2, -1.55236046321 AS sv_3 UNION ALL SELECT 11 AS sv_idx, 1.0 AS dual_coeff, 1.79789124112 AS sv_0, 1.60850779039 AS sv_1, 0.0440402455882 AS sv_2, 1.36582259088 AS sv_3 UNION ALL SELECT 12 AS sv_idx, -1.0 AS dual_coeff, -1.5812468954 AS sv_0, -0.283539875533 AS sv_1, -1.73908117793 AS sv_2, 0.293909885802 AS sv_3 UNION ALL SELECT 13 AS sv_idx, 1.0 AS dual_coeff, -1.69235478224 AS sv_0, 1.41594369125 AS sv_1, 1.18542118094 AS sv_2, 1.23848436836 AS sv_3 UNION ALL SELECT 14 AS sv_idx, 1.0 AS dual_coeff, 0.929503901625 AS sv_0, 0.551425916521 AS sv_1, 0.240463978787 AS sv_2, -1.0402369345 AS sv_3 UNION ALL SELECT 15 AS sv_idx, -1.0 AS dual_coeff, 0.0870691643222 AS sv_0, 0.328011291895 AS sv_1, -1.05450778258 AS sv_2, -0.326238421678 AS sv_3 UNION ALL SELECT 16 AS sv_idx, 1.0 AS dual_coeff, 0.844103222503 AS sv_0, 0.5510079279 AS sv_1, 1.04821261892 AS sv_2, -0.207174116684 AS sv_3 UNION ALL SELECT 17 AS sv_idx, -1.0 AS dual_coeff, -0.916732064662 AS sv_0, -0.155035377253 AS sv_1, -0.594137320317 AS sv_2, 0.927430781612 AS sv_3 UNION ALL SELECT 18 AS sv_idx, 1.0 AS dual_coeff, 0.900586436967 AS sv_0, 0.253469459734 AS sv_1, 1.44599604229 AS sv_2, 1.54792164044 AS sv_3 UNION ALL SELECT 19 AS sv_idx, -1.0 AS dual_coeff, 1.61247197708 AS sv_0, -1.6316703597 AS sv_1, 0.158276517055 AS sv_2, 0.617152707917 AS sv_3 UNION ALL SELECT 20 AS sv_idx, -1.0 AS dual_coeff, -0.360233273903 AS sv_0, -0.744265526503 AS sv_1, -0.970966351355 AS sv_2, -0.258603847436 AS sv_3 UNION ALL SELECT 21 AS sv_idx, -1.0 AS dual_coeff, 0.246465700839 AS sv_0, -1.60991411428 AS sv_1, 1.29583631312 AS sv_2, 0.0941123463979 AS sv_3 UNION ALL SELECT 22 AS sv_idx, 1.0 AS dual_coeff, -1.53894120273 AS sv_0, 1.45740273867 AS sv_1, 1.34515438784 AS sv_2, -1.18654735888 AS sv_3 UNION ALL SELECT 23 AS sv_idx, 1.0 AS dual_coeff, -0.10008882743 AS sv_0, -0.802380312182 AS sv_1, 1.10399496066 AS sv_2, 1.3714732182 AS sv_3 UNION ALL SELECT 24 AS sv_idx, -1.0 AS dual_coeff, -1.28523533627 AS sv_0, -1.6074007824 AS sv_1, 1.17441434066 AS sv_2, -0.96489549098 AS sv_3 UNION ALL SELECT 25 AS sv_idx, 1.0 AS dual_coeff, -0.361022980373 AS sv_0, 0.560436541281 AS sv_1, 0.520583029429 AS sv_2, -1.31265723677 AS sv_3 UNION ALL SELECT 26 AS sv_idx, -1.0 AS dual_coeff, 1.89484483528 AS sv_0, 0.0550299886477 AS sv_1, -0.904962969176 AS sv_2, -0.327098494356 AS sv_3 UNION ALL SELECT 27 AS sv_idx, 1.0 AS dual_coeff, 0.727633035903 AS sv_0, 0.0180306785655 AS sv_1, -0.0144399013866 AS sv_2, -2.02067126073 AS sv_3 UNION ALL SELECT 28 AS sv_idx, -1.0 AS dual_coeff, -0.498898611832 AS sv_0, -1.49654463788 AS sv_1, -0.0798304951959 AS sv_2, 0.258037649879 AS sv_3 UNION ALL SELECT 29 AS sv_idx, 1.0 AS dual_coeff, -0.0778129445331 AS sv_0, 0.963978477038 AS sv_1, 1.4862531791 AS sv_2, 1.36313380779 AS sv_3 UNION ALL SELECT 30 AS sv_idx, 1.0 AS dual_coeff, 0.57615744451 AS sv_0, 0.0781160941515 AS sv_1, 1.20368947443 AS sv_2, -0.880631636406 AS sv_3 UNION ALL SELECT 31 AS sv_idx, 1.0 AS dual_coeff, 1.15999597132 AS sv_0, 0.760561424968 AS sv_1, 1.06369248566 AS sv_2, 1.30513165277 AS sv_3 UNION ALL SELECT 32 AS sv_idx, -1.0 AS dual_coeff, -0.719163333973 AS sv_0, -1.46687946136 AS sv_1, -1.48504112741 AS sv_2, 0.316863046944 AS sv_3 UNION ALL SELECT 33 AS sv_idx, 1.0 AS dual_coeff, 0.929628724224 AS sv_0, 1.50393993655 AS sv_1, -0.15522706411 AS sv_2, -1.25100141723 AS sv_3 UNION ALL SELECT 34 AS sv_idx, -1.0 AS dual_coeff, 0.363442529792 AS sv_0, 1.5628409127 AS sv_1, -1.59889720939 AS sv_2, 1.28570120973 AS sv_3 UNION ALL SELECT 35 AS sv_idx, -1.0 AS dual_coeff, 1.86213219053 AS sv_0, 1.5732327213 AS sv_1, -1.58886866862 AS sv_2, 1.47141062851 AS sv_3 UNION ALL SELECT 36 AS sv_idx, -1.0 AS dual_coeff, 0.919976771484 AS sv_0, -1.51255299031 AS sv_1, -1.43237908664 AS sv_2, -0.500557264633 AS sv_3 UNION ALL SELECT 37 AS sv_idx, -1.0 AS dual_coeff, -0.294954306453 AS sv_0, 0.953300194243 AS sv_1, -1.06406823083 AS sv_2, -0.669407902862 AS sv_3 UNION ALL SELECT 38 AS sv_idx, 1.0 AS dual_coeff, -0.753534895713 AS sv_0, -0.91647242376 AS sv_1, 1.46067027131 AS sv_2, -0.797928064536 AS sv_3 UNION ALL SELECT 39 AS sv_idx, -1.0 AS dual_coeff, 0.823570120333 AS sv_0, -1.67568370455 AS sv_1, 1.24598230939 AS sv_2, -0.0218630288065 AS sv_3 UNION ALL SELECT 40 AS sv_idx, -1.0 AS dual_coeff, -1.13281834441 AS sv_0, -1.43709553652 AS sv_1, -1.34665319286 AS sv_2, -0.292939551101 AS sv_3 UNION ALL SELECT 41 AS sv_idx, 1.0 AS dual_coeff, -1.05937995166 AS sv_0, 1.53709409604 AS sv_1, 0.91969693481 AS sv_2, 0.0702912906993 AS sv_3 UNION ALL SELECT 42 AS sv_idx, -1.0 AS dual_coeff, 0.665433615482 AS sv_0, -0.375379101603 AS sv_1, -1.63430081814 AS sv_2, 0.773623714156 AS sv_3 UNION ALL SELECT 43 AS sv_idx, 1.0 AS dual_coeff, 0.163526846372 AS sv_0, -0.308260778265 AS sv_1, 0.859502692133 AS sv_2, -1.66444723423 AS sv_3 UNION ALL SELECT 44 AS sv_idx, -1.0 AS dual_coeff, -0.24210871432 AS sv_0, -0.625971594536 AS sv_1, -1.29505539018 AS sv_2, -1.87001381349 AS sv_3 UNION ALL SELECT 45 AS sv_idx, -1.0 AS dual_coeff, -0.289735176026 AS sv_0, -0.0219939843288 AS sv_1, -0.760945646471 AS sv_2, -1.36288826847 AS sv_3 UNION ALL SELECT 46 AS sv_idx, 1.0 AS dual_coeff, 0.205872839112 AS sv_0, 1.24545178883 AS sv_1, -0.477554080916 AS sv_2, 0.598160047304 AS sv_3 UNION ALL SELECT 47 AS sv_idx, -1.0 AS dual_coeff, 1.13965295083 AS sv_0, -0.95871746136 AS sv_1, 0.510949901801 AS sv_2, 0.132599615573 AS sv_3 UNION ALL SELECT 48 AS sv_idx, -1.0 AS dual_coeff, 0.779834102453 AS sv_0, 0.754694583462 AS sv_1, -1.49819387695 AS sv_2, -1.3389068153 AS sv_3 UNION ALL SELECT 49 AS sv_idx, 0.693893588425 AS dual_coeff, -0.934729982152 AS sv_0, 1.25736776715 AS sv_1, -0.977242956395 AS sv_2, 0.318902255043 AS sv_3 UNION ALL SELECT 50 AS sv_idx, 1.0 AS dual_coeff, -0.343753784123 AS sv_0, 1.393924921 AS sv_1, 0.202729834888 AS sv_2, 0.276396028182 AS sv_3 UNION ALL SELECT 51 AS sv_idx, 1.0 AS dual_coeff, -0.621347747651 AS sv_0, 1.56028420632 AS sv_1, 1.16220180168 AS sv_2, 0.168447030833 AS sv_3 UNION ALL SELECT 52 AS sv_idx, -1.0 AS dual_coeff, -1.38578421891 AS sv_0, 1.0064786573 AS sv_1, -1.24742990947 AS sv_2, -1.08820891203 AS sv_3 UNION ALL SELECT 53 AS sv_idx, -1.0 AS dual_coeff, 1.23073946772 AS sv_0, -1.60962540911 AS sv_1, -1.32877684691 AS sv_2, -1.67980892101 AS sv_3 UNION ALL SELECT 54 AS sv_idx, 1.0 AS dual_coeff, -0.451231385476 AS sv_0, 0.964000129054 AS sv_1, 0.92910154683 AS sv_2, -1.38042119785 AS sv_3 UNION ALL SELECT 55 AS sv_idx, -1.0 AS dual_coeff, -0.928774942195 AS sv_0, -1.2237512203 AS sv_1, 0.281135153728 AS sv_2, 0.475550120045 AS sv_3 UNION ALL SELECT 56 AS sv_idx, 1.0 AS dual_coeff, 1.18703304975 AS sv_0, 0.192843912057 AS sv_1, 0.122384680513 AS sv_2, 1.39917772241 AS sv_3 UNION ALL SELECT 57 AS sv_idx, 1.0 AS dual_coeff, 0.827874256181 AS sv_0, 0.503793015791 AS sv_1, 1.30857480349 AS sv_2, 1.03757529207 AS sv_3 UNION ALL SELECT 58 AS sv_idx, -1.0 AS dual_coeff, -0.814834713814 AS sv_0, 0.202121166455 AS sv_1, -0.629640955425 AS sv_2, 1.34092331224 AS sv_3 UNION ALL SELECT 59 AS sv_idx, -1.0 AS dual_coeff, 0.985321826211 AS sv_0, -0.524452833863 AS sv_1, -0.914438425591 AS sv_2, 1.4670426842 AS sv_3 UNION ALL SELECT 60 AS sv_idx, 1.0 AS dual_coeff, 0.706865374629 AS sv_0, 0.202508548314 AS sv_1, -0.256602941468 AS sv_2, 0.55524052047 AS sv_3 UNION ALL SELECT 61 AS sv_idx, 1.0 AS dual_coeff, -1.53297104683 AS sv_0, 0.832588322028 AS sv_1, 0.785509840062 AS sv_2, -1.58861501451 AS sv_3 UNION ALL SELECT 62 AS sv_idx, 0.306106411575 AS dual_coeff, 1.69003019248 AS sv_0, -1.06324814885 AS sv_1, 0.845950146927 AS sv_2, 0.198883572502 AS sv_3 UNION ALL SELECT 63 AS sv_idx, 1.0 AS dual_coeff, 0.0614487729208 AS sv_0, 0.475987531065 AS sv_1, 0.798422927196 AS sv_2, -0.648691059311 AS sv_3 UNION ALL SELECT 64 AS sv_idx, 1.0 AS dual_coeff, -1.74738198634 AS sv_0, 0.946271362394 AS sv_1, -0.0585867137672 AS sv_2, 0.705763145568 AS sv_3 UNION ALL SELECT 65 AS sv_idx, 1.0 AS dual_coeff, -1.04288311053 AS sv_0, 0.498850534673 AS sv_1, 0.49776224097 AS sv_2, -0.0702156991939 AS sv_3 UNION ALL SELECT 66 AS sv_idx, -1.0 AS dual_coeff, 1.70685030989 AS sv_0, -0.380321886559 AS sv_1, -1.26601492913 AS sv_2, 0.565627794436 AS sv_3) AS `Values`), 
kernel_cte AS 
(SELECT t.`KEY` AS `KEY`, t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv.`KEY` AS `KEY`, sum(full_join_data_sv.dot_prod1) + 355.790354904 AS dot_product 
FROM (SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, `SV_data`.dual_coeff * power(0.25 * (`ADS_sca_2_OUT`.scaler_output_2 * `SV_data`.sv_0 + `ADS_sca_2_OUT`.scaler_output_3 * `SV_data`.sv_1 + `ADS_sca_2_OUT`.scaler_output_4 * `SV_data`.sv_2 + `ADS_sca_2_OUT`.scaler_output_5 * `SV_data`.sv_3) + 0.0, 3) AS dot_prod1 
FROM `ADS_sca_2_OUT`, `SV_data`) AS full_join_data_sv GROUP BY full_join_data_sv.`KEY`) AS t)
 SELECT kernel_cte.`KEY` AS `KEY`, kernel_cte.dot_product AS `Estimator` 
FROM kernel_cte