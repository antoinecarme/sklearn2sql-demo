-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 49.3397461976 ELSE `ADS`.`Feature_0` END AS imputer_output_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 907.066436141 ELSE `ADS`.`Feature_1` END AS imputer_output_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 0.45219825786 ELSE `ADS`.`Feature_2` END AS imputer_output_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 6.09114071905 ELSE `ADS`.`Feature_3` END AS imputer_output_5 
FROM freidman2 AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.imputer_output_2 AS DOUBLE) - 49.3397461976) / 28.5419505242 AS scaler_output_2, (CAST(`ADS_imp_1_OUT`.imputer_output_3 AS DOUBLE) - 907.066436141) / 489.361332314 AS scaler_output_3, (CAST(`ADS_imp_1_OUT`.imputer_output_4 AS DOUBLE) - 0.45219825786) / 0.283291221582 AS scaler_output_4, (CAST(`ADS_imp_1_OUT`.imputer_output_5 AS DOUBLE) - 6.09114071905) / 2.81174017269 AS scaler_output_5 
FROM `ADS_imp_1_OUT`), 
`SV_data` AS 
(SELECT `Values`.sv_idx AS sv_idx, `Values`.dual_coeff AS dual_coeff, `Values`.sv_0 AS sv_0, `Values`.sv_1 AS sv_1, `Values`.sv_2 AS sv_2, `Values`.sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, 1.0 AS dual_coeff, 1.02417350164 AS sv_0, 1.09767761623 AS sv_1, 0.526708838945 AS sv_2, -0.240376255492 AS sv_3 UNION ALL SELECT 1 AS sv_idx, -1.0 AS dual_coeff, 0.187130350651 AS sv_0, -0.662289502137 AS sv_1, -1.07673227562 AS sv_2, -0.91765235952 AS sv_3 UNION ALL SELECT 2 AS sv_idx, 1.0 AS dual_coeff, 0.422585370104 AS sv_0, -0.075909983942 AS sv_1, -0.384348884328 AS sv_2, 0.125045108346 AS sv_3 UNION ALL SELECT 3 AS sv_idx, -1.0 AS dual_coeff, 1.48760573177 AS sv_0, -0.802837866007 AS sv_1, -0.0116898929844 AS sv_2, 0.0963472233256 AS sv_3 UNION ALL SELECT 4 AS sv_idx, -1.0 AS dual_coeff, 0.361120364694 AS sv_0, -1.3736286981 AS sv_1, 0.0776777077921 AS sv_2, -1.68487262411 AS sv_3 UNION ALL SELECT 5 AS sv_idx, -1.0 AS dual_coeff, 0.280180525458 AS sv_0, -1.49805621714 AS sv_1, -0.372260193494 AS sv_2, 1.16433202478 AS sv_3 UNION ALL SELECT 6 AS sv_idx, -1.0 AS dual_coeff, -0.107414313179 AS sv_0, -0.149838882398 AS sv_1, -1.29257133545 AS sv_2, -1.74618349323 AS sv_3 UNION ALL SELECT 7 AS sv_idx, -1.0 AS dual_coeff, -0.61766292867 AS sv_0, 0.0353609012569 AS sv_1, -0.622130851389 AS sv_2, -0.55436313092 AS sv_3 UNION ALL SELECT 8 AS sv_idx, 1.0 AS dual_coeff, -0.442371133249 AS sv_0, 0.359799152697 AS sv_1, 1.30411726543 AS sv_2, -0.858658615115 AS sv_3 UNION ALL SELECT 9 AS sv_idx, 1.0 AS dual_coeff, -0.888952388514 AS sv_0, 1.64638780215 AS sv_1, 0.266665950388 AS sv_2, 1.49831349367 AS sv_3 UNION ALL SELECT 10 AS sv_idx, 1.0 AS dual_coeff, -0.154670030745 AS sv_0, -0.535179078203 AS sv_1, 0.850423248187 AS sv_2, 0.27297700045 AS sv_3 UNION ALL SELECT 11 AS sv_idx, 1.0 AS dual_coeff, -0.806340041441 AS sv_0, -0.763769261179 AS sv_1, 0.846371956393 AS sv_2, -0.0457346677221 AS sv_3 UNION ALL SELECT 12 AS sv_idx, 1.0 AS dual_coeff, 0.952847123914 AS sv_0, 0.205009638798 AS sv_1, -0.0774744755872 AS sv_2, 0.674015783634 AS sv_3 UNION ALL SELECT 13 AS sv_idx, -1.0 AS dual_coeff, -1.7257946192 AS sv_0, -0.957217473062 AS sv_1, 0.138812032932 AS sv_2, 0.46633288626 AS sv_3 UNION ALL SELECT 14 AS sv_idx, -1.0 AS dual_coeff, 0.137555164111 AS sv_0, 0.435397728467 AS sv_1, -1.55235121803 AS sv_2, -1.33934288284 AS sv_3 UNION ALL SELECT 15 AS sv_idx, -1.0 AS dual_coeff, -0.884986923659 AS sv_0, -0.668791633068 AS sv_1, -0.861338090871 AS sv_2, -0.0625526818908 AS sv_3 UNION ALL SELECT 16 AS sv_idx, 1.0 AS dual_coeff, -0.991240322803 AS sv_0, -0.7798332852 AS sv_1, 1.31614940292 AS sv_2, 1.66393488662 AS sv_3 UNION ALL SELECT 17 AS sv_idx, 1.0 AS dual_coeff, 1.44161058389 AS sv_0, 1.33688743793 AS sv_1, 1.01998464148 AS sv_2, -1.58944705484 AS sv_3 UNION ALL SELECT 18 AS sv_idx, -1.0 AS dual_coeff, 0.14575564748 AS sv_0, -1.52912446809 AS sv_1, -0.284940975097 AS sv_2, -1.47037813861 AS sv_3 UNION ALL SELECT 19 AS sv_idx, -1.0 AS dual_coeff, 0.359240886809 AS sv_0, -1.10384590382 AS sv_1, 1.17105905074 AS sv_2, 0.105606459191 AS sv_3 UNION ALL SELECT 20 AS sv_idx, -1.0 AS dual_coeff, 0.0910500368015 AS sv_0, 0.235095105092 AS sv_1, -0.684906569674 AS sv_2, -1.58852468445 AS sv_3 UNION ALL SELECT 21 AS sv_idx, 1.0 AS dual_coeff, -1.03415244978 AS sv_0, -1.02459116936 AS sv_1, 1.79756132676 AS sv_2, 0.434214780115 AS sv_3 UNION ALL SELECT 22 AS sv_idx, 1.0 AS dual_coeff, -0.149543304349 AS sv_0, 1.68068278132 AS sv_1, -0.893444737037 AS sv_2, 1.30840573175 AS sv_3 UNION ALL SELECT 23 AS sv_idx, 1.0 AS dual_coeff, -0.886862658852 AS sv_0, -0.193602984776 AS sv_1, 0.725304583643 AS sv_2, -1.53137617948 AS sv_3 UNION ALL SELECT 24 AS sv_idx, -1.0 AS dual_coeff, -1.01646574214 AS sv_0, -0.841903720284 AS sv_1, -0.265861912108 AS sv_2, 1.25893938611 AS sv_3 UNION ALL SELECT 25 AS sv_idx, 1.0 AS dual_coeff, 1.69305746587 AS sv_0, 1.14129557508 AS sv_1, -0.0165433439403 AS sv_2, 1.5444813907 AS sv_3 UNION ALL SELECT 26 AS sv_idx, 1.0 AS dual_coeff, 0.982516357419 AS sv_0, -0.784191985518 AS sv_1, 1.33233271465 AS sv_2, 1.01027406514 AS sv_3 UNION ALL SELECT 27 AS sv_idx, -1.0 AS dual_coeff, -1.26843674025 AS sv_0, 1.58326095827 AS sv_1, -1.49439483201 AS sv_2, -1.49106642913 AS sv_3 UNION ALL SELECT 28 AS sv_idx, -1.0 AS dual_coeff, 0.541274207933 AS sv_0, 1.34461706978 AS sv_1, -1.35824997778 AS sv_2, 0.92986517319 AS sv_3 UNION ALL SELECT 29 AS sv_idx, 1.0 AS dual_coeff, -0.194401467843 AS sv_0, 1.47342866751 AS sv_1, 0.498750599438 AS sv_2, -0.691480794333 AS sv_3 UNION ALL SELECT 30 AS sv_idx, 1.0 AS dual_coeff, 1.48853272025 AS sv_0, 0.454985153898 AS sv_1, 0.49033912003 AS sv_2, 0.766794890297 AS sv_3 UNION ALL SELECT 31 AS sv_idx, -1.0 AS dual_coeff, 0.0152121699021 AS sv_0, 1.31649916199 AS sv_1, -1.47800981253 AS sv_2, -1.20587190644 AS sv_3 UNION ALL SELECT 32 AS sv_idx, 1.0 AS dual_coeff, 1.32551652906 AS sv_0, 1.60740510456 AS sv_1, -0.545925929279 AS sv_2, -0.4688279803 AS sv_3 UNION ALL SELECT 33 AS sv_idx, -1.0 AS dual_coeff, -1.04643455417 AS sv_0, -0.440748251149 AS sv_1, -0.600379462892 AS sv_2, 0.554951485173 AS sv_3 UNION ALL SELECT 34 AS sv_idx, 1.0 AS dual_coeff, 1.48536019586 AS sv_0, 1.41876088343 AS sv_1, 0.430482746809 AS sv_2, 0.0894654380143 AS sv_3 UNION ALL SELECT 35 AS sv_idx, 1.0 AS dual_coeff, 0.434552418967 AS sv_0, 0.916248551995 AS sv_1, 1.37045970722 AS sv_2, -1.54606448625 AS sv_3 UNION ALL SELECT 36 AS sv_idx, 1.0 AS dual_coeff, -1.69171470048 AS sv_0, -0.0943299799173 AS sv_1, 1.19528390737 AS sv_2, 1.55705879729 AS sv_3 UNION ALL SELECT 37 AS sv_idx, -1.0 AS dual_coeff, -1.58519301039 AS sv_0, -0.217316036686 AS sv_1, -0.950797289436 AS sv_2, -0.282705475625 AS sv_3 UNION ALL SELECT 38 AS sv_idx, 1.0 AS dual_coeff, -1.03508682186 AS sv_0, -0.351355860256 AS sv_1, 0.431018181871 AS sv_2, -1.08861244552 AS sv_3 UNION ALL SELECT 39 AS sv_idx, 1.0 AS dual_coeff, 1.29958223133 AS sv_0, -0.149794888062 AS sv_1, -0.356543503918 AS sv_2, 1.10779626681 AS sv_3 UNION ALL SELECT 40 AS sv_idx, -1.0 AS dual_coeff, 0.864825787322 AS sv_0, -1.52576500699 AS sv_1, -1.2919050012 AS sv_2, 0.475705344115 AS sv_3 UNION ALL SELECT 41 AS sv_idx, 1.0 AS dual_coeff, 1.10899724118 AS sv_0, -0.103647046629 AS sv_1, 0.701525521251 AS sv_2, -1.09839885064 AS sv_3 UNION ALL SELECT 42 AS sv_idx, -1.0 AS dual_coeff, 0.530282273864 AS sv_0, 0.262205451416 AS sv_1, -1.38955979686 AS sv_2, -0.594441527296 AS sv_3 UNION ALL SELECT 43 AS sv_idx, -1.0 AS dual_coeff, -0.832774766969 AS sv_0, -0.597668268422 AS sv_1, -0.242284736067 AS sv_2, -0.77435730289 AS sv_3 UNION ALL SELECT 44 AS sv_idx, 1.0 AS dual_coeff, 0.896371560754 AS sv_0, 1.25382640626 AS sv_1, 0.998368384288 AS sv_2, 1.35384827821 AS sv_3 UNION ALL SELECT 45 AS sv_idx, -1.0 AS dual_coeff, -1.07622195924 AS sv_0, -0.757529573651 AS sv_1, 0.309462765297 AS sv_2, -0.304121909637 AS sv_3 UNION ALL SELECT 46 AS sv_idx, 1.0 AS dual_coeff, 0.0703287813127 AS sv_0, 0.861224837149 AS sv_1, 1.19860581608 AS sv_2, -0.904801201485 AS sv_3 UNION ALL SELECT 47 AS sv_idx, -1.0 AS dual_coeff, 0.0534718699919 AS sv_0, -0.394401043882 AS sv_1, -0.638407193294 AS sv_2, -1.34805766779 AS sv_3 UNION ALL SELECT 48 AS sv_idx, 1.0 AS dual_coeff, -1.67250863448 AS sv_0, -0.586109282459 AS sv_1, 1.68899242563 AS sv_2, -0.441332860207 AS sv_3 UNION ALL SELECT 49 AS sv_idx, -1.0 AS dual_coeff, -1.66908968397 AS sv_0, -1.5633428393 AS sv_1, -1.08941578274 AS sv_2, 0.516078254226 AS sv_3 UNION ALL SELECT 50 AS sv_idx, 1.0 AS dual_coeff, 1.27452704657 AS sv_0, -0.719093494675 AS sv_1, 0.755473482311 AS sv_2, 1.27782703057 AS sv_3 UNION ALL SELECT 51 AS sv_idx, -1.0 AS dual_coeff, 0.899315834802 AS sv_0, -1.29805918316 AS sv_1, 1.74603023488 AS sv_2, -0.105691757353 AS sv_3 UNION ALL SELECT 52 AS sv_idx, 1.0 AS dual_coeff, -1.32026927072 AS sv_0, 0.463620358655 AS sv_1, 0.0661993554596 AS sv_2, 1.04589713083 AS sv_3 UNION ALL SELECT 53 AS sv_idx, 1.0 AS dual_coeff, -1.07138974374 AS sv_0, 1.65813435257 AS sv_1, -0.335135760289 AS sv_2, 1.12111907842 AS sv_3 UNION ALL SELECT 54 AS sv_idx, -1.0 AS dual_coeff, 0.691484973184 AS sv_0, -1.1166476894 AS sv_1, -1.54459051496 AS sv_2, 1.32469995962 AS sv_3 UNION ALL SELECT 55 AS sv_idx, 1.0 AS dual_coeff, -1.13660697533 AS sv_0, 1.34364330421 AS sv_1, 1.44724525154 AS sv_2, 1.31824888658 AS sv_3 UNION ALL SELECT 56 AS sv_idx, 1.0 AS dual_coeff, 0.663411185676 AS sv_0, 1.03163441259 AS sv_1, 0.60720157426 AS sv_2, -0.392409438417 AS sv_3 UNION ALL SELECT 57 AS sv_idx, 1.0 AS dual_coeff, -0.309877638596 AS sv_0, 1.38219193474 AS sv_1, -0.352024654093 AS sv_2, 1.23014931119 AS sv_3 UNION ALL SELECT 58 AS sv_idx, -1.0 AS dual_coeff, 1.54165777287 AS sv_0, -0.397421432862 AS sv_1, -1.52912673283 AS sv_2, 0.694548976892 AS sv_3 UNION ALL SELECT 59 AS sv_idx, -1.0 AS dual_coeff, 0.990683306641 AS sv_0, 0.982843276284 AS sv_1, -1.01584310928 AS sv_2, -0.451506217136 AS sv_3 UNION ALL SELECT 60 AS sv_idx, -1.0 AS dual_coeff, -0.36706474644 AS sv_0, 1.48334502395 AS sv_1, -1.28895428555 AS sv_2, 0.815229294212 AS sv_3 UNION ALL SELECT 61 AS sv_idx, 1.0 AS dual_coeff, 1.17711585123 AS sv_0, -1.02817032971 AS sv_1, 1.44404874207 AS sv_2, 0.05086979861 AS sv_3 UNION ALL SELECT 62 AS sv_idx, -1.0 AS dual_coeff, -0.357255147763 AS sv_0, -0.950542038303 AS sv_1, -0.908186735391 AS sv_2, 0.198248643028 AS sv_3 UNION ALL SELECT 63 AS sv_idx, -1.0 AS dual_coeff, 0.0455051626074 AS sv_0, 0.124665294386 AS sv_1, -1.08742778596 AS sv_2, 0.116848383849 AS sv_3 UNION ALL SELECT 64 AS sv_idx, -1.0 AS dual_coeff, -0.528653386748 AS sv_0, -1.0681870988 AS sv_1, -1.00143729231 AS sv_2, 0.210043131417 AS sv_3 UNION ALL SELECT 65 AS sv_idx, -1.0 AS dual_coeff, -1.72764643949 AS sv_0, -1.28859908708 AS sv_1, 1.89320938045 AS sv_2, -1.5171164964 AS sv_3) AS `Values`), 
kernel_cte AS 
(SELECT t.`KEY` AS `KEY`, t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv.`KEY` AS `KEY`, sum(full_join_data_sv.dot_prod1) + 299.937088442 AS dot_product 
FROM (SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, `SV_data`.dual_coeff * power(0.25 * (`ADS_sca_2_OUT`.scaler_output_2 * `SV_data`.sv_0 + `ADS_sca_2_OUT`.scaler_output_3 * `SV_data`.sv_1 + `ADS_sca_2_OUT`.scaler_output_4 * `SV_data`.sv_2 + `ADS_sca_2_OUT`.scaler_output_5 * `SV_data`.sv_3) + 0.0, 3) AS dot_prod1 
FROM `ADS_sca_2_OUT`, `SV_data`) AS full_join_data_sv GROUP BY full_join_data_sv.`KEY`) AS t)
 SELECT kernel_cte.`KEY` AS `KEY`, kernel_cte.dot_product AS `Estimator` 
FROM kernel_cte