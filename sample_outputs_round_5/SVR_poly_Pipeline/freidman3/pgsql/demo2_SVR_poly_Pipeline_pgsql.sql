-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "ADS_imp_1_OUT" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 51.5072787067 ELSE "ADS"."Feature_0" END AS imputer_output_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 990.331665621 ELSE "ADS"."Feature_1" END AS imputer_output_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 0.447729387417 ELSE "ADS"."Feature_2" END AS imputer_output_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 6.57481602505 ELSE "ADS"."Feature_3" END AS imputer_output_5 
FROM freidman3 AS "ADS"), 
"ADS_sca_2_OUT" AS 
(SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".imputer_output_2 AS FLOAT) - 51.5072787067) / 27.4905128815 AS scaler_output_2, (CAST("ADS_imp_1_OUT".imputer_output_3 AS FLOAT) - 990.331665621) / 490.290327081 AS scaler_output_3, (CAST("ADS_imp_1_OUT".imputer_output_4 AS FLOAT) - 0.447729387417) / 0.278295200615 AS scaler_output_4, (CAST("ADS_imp_1_OUT".imputer_output_5 AS FLOAT) - 6.57481602505) / 2.89947191642 AS scaler_output_5 
FROM "ADS_imp_1_OUT"), 
"SV_data" AS 
(SELECT "Values".sv_idx AS sv_idx, "Values".dual_coeff AS dual_coeff, "Values".sv_0 AS sv_0, "Values".sv_1 AS sv_1, "Values".sv_2 AS sv_2, "Values".sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, -1.0 AS dual_coeff, -1.12299125479 AS sv_0, 0.973954015186 AS sv_1, 1.15222167209 AS sv_2, 0.997721269809 AS sv_3 UNION ALL SELECT 1 AS sv_idx, 0.0118035346028 AS dual_coeff, -0.272973942176 AS sv_0, -0.455398694365 AS sv_1, 0.856073731711 AS sv_2, 0.970388893469 AS sv_3 UNION ALL SELECT 2 AS sv_idx, -0.348120559423 AS dual_coeff, -1.25925277788 AS sv_0, -0.989749028438 AS sv_1, 1.54439737568 AS sv_2, 1.00062895717 AS sv_3 UNION ALL SELECT 3 AS sv_idx, -0.516576478458 AS dual_coeff, 0.293610944723 AS sv_0, -1.42232229993 AS sv_1, -1.60279465815 AS sv_2, -1.53708137205 AS sv_3 UNION ALL SELECT 4 AS sv_idx, -1.0 AS dual_coeff, -1.03730992054 AS sv_0, -0.472661312331 AS sv_1, -1.38945028619 AS sv_2, 0.757820058406 AS sv_3 UNION ALL SELECT 5 AS sv_idx, 0.792324681752 AS dual_coeff, 1.29665152894 AS sv_0, 1.56738692189 AS sv_1, -0.28131050296 AS sv_2, -0.318819496081 AS sv_3 UNION ALL SELECT 6 AS sv_idx, -1.0 AS dual_coeff, 0.147625367361 AS sv_0, 1.2321698258 AS sv_1, 1.63826453414 AS sv_2, -0.247874374977 AS sv_3 UNION ALL SELECT 7 AS sv_idx, 1.0 AS dual_coeff, -0.0661116103809 AS sv_0, 0.404972544347 AS sv_1, -0.250466096506 AS sv_2, 0.165424152415 AS sv_3 UNION ALL SELECT 8 AS sv_idx, 1.0 AS dual_coeff, -0.657125706476 AS sv_0, 0.157660193583 AS sv_1, -0.0863369574681 AS sv_2, -0.10710512413 AS sv_3 UNION ALL SELECT 9 AS sv_idx, 0.227300077781 AS dual_coeff, 1.5786475452 AS sv_0, 1.27735129026 AS sv_1, 1.63220427051 AS sv_2, -1.2799215276 AS sv_3 UNION ALL SELECT 10 AS sv_idx, -0.0491603626578 AS dual_coeff, 0.00125113838026 AS sv_0, 0.291045800351 AS sv_1, 1.50384472283 AS sv_2, 0.753270671466 AS sv_3 UNION ALL SELECT 11 AS sv_idx, -0.431801265511 AS dual_coeff, -0.341977647932 AS sv_0, -1.5110355416 AS sv_1, -1.0592591957 AS sv_2, -0.109444614597 AS sv_3 UNION ALL SELECT 12 AS sv_idx, 0.44895160096 AS dual_coeff, -1.42270603791 AS sv_0, 0.540808365044 AS sv_1, -1.18191617075 AS sv_2, -1.52810413625 AS sv_3 UNION ALL SELECT 13 AS sv_idx, 1.0 AS dual_coeff, 1.34064349758 AS sv_0, 1.36828417434 AS sv_1, 1.50008202572 AS sv_2, -1.68692043851 AS sv_3 UNION ALL SELECT 14 AS sv_idx, -1.0 AS dual_coeff, 0.32360015701 AS sv_0, 0.334721055721 AS sv_1, 1.95344875236 AS sv_2, -0.973664554129 AS sv_3 UNION ALL SELECT 15 AS sv_idx, 1.0 AS dual_coeff, 1.20673151928 AS sv_0, -1.05623689187 AS sv_1, -0.186019337511 AS sv_2, 1.23126554209 AS sv_3 UNION ALL SELECT 16 AS sv_idx, 0.974727965952 AS dual_coeff, -1.78428587201 AS sv_0, -1.6377594948 AS sv_1, -1.31192982064 AS sv_2, 1.47261177691 AS sv_3 UNION ALL SELECT 17 AS sv_idx, -1.0 AS dual_coeff, 0.691226955133 AS sv_0, 0.58232567804 AS sv_1, -1.31573299562 AS sv_2, -1.26580606194 AS sv_3 UNION ALL SELECT 18 AS sv_idx, 0.719181822519 AS dual_coeff, 0.177004698717 AS sv_0, 0.690946303966 AS sv_1, -0.341192075118 AS sv_2, 0.76545939286 AS sv_3 UNION ALL SELECT 19 AS sv_idx, 0.042542500184 AS dual_coeff, -1.83692417502 AS sv_0, -1.21659478113 AS sv_1, -0.0252991061196 AS sv_2, 0.928466071838 AS sv_3 UNION ALL SELECT 20 AS sv_idx, -1.0 AS dual_coeff, -0.539217020471 AS sv_0, 0.384844848676 AS sv_1, -1.49015228786 AS sv_2, -0.500059474746 AS sv_3 UNION ALL SELECT 21 AS sv_idx, -0.563573566219 AS dual_coeff, 1.51273923262 AS sv_0, -1.39951788716 AS sv_1, -0.358626895954 AS sv_2, 0.163387277178 AS sv_3 UNION ALL SELECT 22 AS sv_idx, 0.514355807591 AS dual_coeff, -1.7156475169 AS sv_0, -1.27820200918 AS sv_1, -0.00131282596759 AS sv_2, -0.200786993497 AS sv_3 UNION ALL SELECT 23 AS sv_idx, 0.814315864516 AS dual_coeff, -0.437800954324 AS sv_0, 0.725178803581 AS sv_1, -0.697566424176 AS sv_2, -1.63927996757 AS sv_3 UNION ALL SELECT 24 AS sv_idx, 0.117593260088 AS dual_coeff, -1.12437151467 AS sv_0, 0.953667695095 AS sv_1, -1.40753416193 AS sv_2, 0.755355035172 AS sv_3 UNION ALL SELECT 25 AS sv_idx, 0.0121664060675 AS dual_coeff, 0.705253910717 AS sv_0, 1.55272130581 AS sv_1, -0.789863235571 AS sv_2, 0.668372060374 AS sv_3 UNION ALL SELECT 26 AS sv_idx, 1.0 AS dual_coeff, -0.274549432396 AS sv_0, -0.0773480461297 AS sv_1, 0.642863905684 AS sv_2, 0.243215923196 AS sv_3 UNION ALL SELECT 27 AS sv_idx, 0.476864819451 AS dual_coeff, -0.340889329283 AS sv_0, 0.254617175259 AS sv_1, 0.617553312407 AS sv_2, -1.48821559112 AS sv_3 UNION ALL SELECT 28 AS sv_idx, -1.0 AS dual_coeff, 0.231265457427 AS sv_0, -1.53558436113 AS sv_1, -1.57540830219 AS sv_2, 1.02609976596 AS sv_3 UNION ALL SELECT 29 AS sv_idx, 1.0 AS dual_coeff, 1.46956901369 AS sv_0, 0.215223771248 AS sv_1, 0.182569263794 AS sv_2, 0.89744840595 AS sv_3 UNION ALL SELECT 30 AS sv_idx, -0.314225907222 AS dual_coeff, 0.492236033727 AS sv_0, 1.2636396215 AS sv_1, -1.45230440701 AS sv_2, 1.28657671964 AS sv_3 UNION ALL SELECT 31 AS sv_idx, -0.928670201975 AS dual_coeff, -0.0704181751307 AS sv_0, 1.0041009442 AS sv_1, 1.32501026291 AS sv_2, -1.89629342062 AS sv_3 UNION ALL SELECT 32 AS sv_idx, -1.0 AS dual_coeff, 1.13518986252 AS sv_0, -0.32369163432 AS sv_1, -1.47272872496 AS sv_2, 1.00338872039 AS sv_3) AS "Values"), 
kernel_cte AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(full_join_data_sv.dot_prod1) + 1.3455204908 AS dot_product 
FROM (SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", "SV_data".dual_coeff * power(0.25 * ("ADS_sca_2_OUT".scaler_output_2 * "SV_data".sv_0 + "ADS_sca_2_OUT".scaler_output_3 * "SV_data".sv_1 + "ADS_sca_2_OUT".scaler_output_4 * "SV_data".sv_2 + "ADS_sca_2_OUT".scaler_output_5 * "SV_data".sv_3) + 0.0, 3) AS dot_prod1 
FROM "ADS_sca_2_OUT", "SV_data") AS full_join_data_sv GROUP BY full_join_data_sv."KEY") AS t)
 SELECT kernel_cte."KEY" AS "KEY", kernel_cte.dot_product AS "Estimator" 
FROM kernel_cte