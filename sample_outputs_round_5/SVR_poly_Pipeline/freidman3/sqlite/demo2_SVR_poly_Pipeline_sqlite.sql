-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "ADS_imp_1_OUT" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 45.845990053 ELSE "ADS"."Feature_0" END AS imputer_output_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 942.46423369 ELSE "ADS"."Feature_1" END AS imputer_output_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 0.446195967248 ELSE "ADS"."Feature_2" END AS imputer_output_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 5.97807521382 ELSE "ADS"."Feature_3" END AS imputer_output_5 
FROM freidman3 AS "ADS"), 
"ADS_sca_2_OUT" AS 
(SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".imputer_output_2 AS FLOAT) - 45.845990053) / 29.4669866314 AS scaler_output_2, (CAST("ADS_imp_1_OUT".imputer_output_3 AS FLOAT) - 942.46423369) / 471.192083734 AS scaler_output_3, (CAST("ADS_imp_1_OUT".imputer_output_4 AS FLOAT) - 0.446195967248) / 0.262875737727 AS scaler_output_4, (CAST("ADS_imp_1_OUT".imputer_output_5 AS FLOAT) - 5.97807521382) / 2.47973203412 AS scaler_output_5 
FROM "ADS_imp_1_OUT"), 
"SV_data" AS 
(SELECT "Values".sv_idx AS sv_idx, "Values".dual_coeff AS dual_coeff, "Values".sv_0 AS sv_0, "Values".sv_1 AS sv_1, "Values".sv_2 AS sv_2, "Values".sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, -0.213800779194 AS dual_coeff, -0.372770059777 AS sv_0, -1.14885384549 AS sv_1, -0.627966845913 AS sv_2, -1.17685347132 AS sv_3 UNION ALL SELECT 1 AS sv_idx, 1.0 AS dual_coeff, -0.400789735258 AS sv_0, -0.42431031356 AS sv_1, -0.131541764145 AS sv_2, -0.74990696485 AS sv_3 UNION ALL SELECT 2 AS sv_idx, 1.0 AS dual_coeff, -0.988340526685 AS sv_0, 0.868517512954 AS sv_1, -1.2465605031 AS sv_2, -1.03272243913 AS sv_3 UNION ALL SELECT 3 AS sv_idx, -0.788728560314 AS dual_coeff, -1.24701332308 AS sv_0, -0.562808186274 AS sv_1, -1.60722485112 AS sv_2, 0.724795427034 AS sv_3 UNION ALL SELECT 4 AS sv_idx, -1.0 AS dual_coeff, 0.258578650288 AS sv_0, 1.36495193226 AS sv_1, -1.59919892649 AS sv_2, 1.43240568685 AS sv_3 UNION ALL SELECT 5 AS sv_idx, 0.279052427243 AS dual_coeff, -0.708959288743 AS sv_0, 0.591542197128 AS sv_1, -0.396652031051 AS sv_2, -1.72551544892 AS sv_3 UNION ALL SELECT 6 AS sv_idx, -0.617158535637 AS dual_coeff, -0.879612669838 AS sv_0, -0.195784311851 AS sv_1, -1.54222681367 AS sv_2, -0.358163740357 AS sv_3 UNION ALL SELECT 7 AS sv_idx, -1.0 AS dual_coeff, 1.32878602806 AS sv_0, -0.658586213037 AS sv_1, -0.971703675338 AS sv_2, 0.812018638972 AS sv_3 UNION ALL SELECT 8 AS sv_idx, 0.661426258785 AS dual_coeff, -0.759523499461 AS sv_0, -0.436921728354 AS sv_1, -0.683274200849 AS sv_2, -1.60300978345 AS sv_3 UNION ALL SELECT 9 AS sv_idx, -0.421788756227 AS dual_coeff, -1.00264933465 AS sv_0, 1.2858129627 AS sv_1, 0.90611642322 AS sv_2, -0.885175649841 AS sv_3 UNION ALL SELECT 10 AS sv_idx, 1.0 AS dual_coeff, -1.2357900785 AS sv_0, 0.205688762365 AS sv_1, -1.24802501697 AS sv_2, 0.720933388734 AS sv_3 UNION ALL SELECT 11 AS sv_idx, -0.679715565765 AS dual_coeff, -0.990351853657 AS sv_0, 0.828291922306 AS sv_1, -1.59739921886 AS sv_2, -1.73356389008 AS sv_3 UNION ALL SELECT 12 AS sv_idx, -1.0 AS dual_coeff, 0.149080148787 AS sv_0, -1.24209599893 AS sv_1, 1.21123007565 AS sv_2, -0.985677399903 AS sv_3 UNION ALL SELECT 13 AS sv_idx, -1.0 AS dual_coeff, -0.426142026729 AS sv_0, 0.0397290578494 AS sv_1, -1.5153419132 AS sv_2, -0.362675815839 AS sv_3 UNION ALL SELECT 14 AS sv_idx, -0.152656759611 AS dual_coeff, -0.0578759959108 AS sv_0, -1.56555969599 AS sv_1, 1.30575134079 AS sv_2, 0.786335735728 AS sv_3 UNION ALL SELECT 15 AS sv_idx, 0.255444947103 AS dual_coeff, -0.774010582789 AS sv_0, 0.0621912633328 AS sv_1, 0.691747648012 AS sv_2, 0.752873489733 AS sv_3 UNION ALL SELECT 16 AS sv_idx, -0.358543616109 AS dual_coeff, -1.53812889214 AS sv_0, 1.69484865222 AS sv_1, -0.227018719863 AS sv_2, -0.293036821781 AS sv_3 UNION ALL SELECT 17 AS sv_idx, 0.123168916608 AS dual_coeff, -0.958430620244 AS sv_0, -0.781712785811 AS sv_1, 1.19386181612 AS sv_2, 0.249689097794 AS sv_3 UNION ALL SELECT 18 AS sv_idx, 0.24720385096 AS dual_coeff, -0.792754536108 AS sv_0, -0.146263446594 AS sv_1, 0.382004073474 AS sv_2, 1.15893988395 AS sv_3 UNION ALL SELECT 19 AS sv_idx, 1.0 AS dual_coeff, -1.40672795133 AS sv_0, -0.010368473206 AS sv_1, 0.188699774556 AS sv_2, -0.685678077247 AS sv_3 UNION ALL SELECT 20 AS sv_idx, 1.0 AS dual_coeff, -0.116454520341 AS sv_0, 1.42483596531 AS sv_1, -0.386713161582 AS sv_2, -0.923143230776 AS sv_3 UNION ALL SELECT 21 AS sv_idx, -1.0 AS dual_coeff, 0.770459717229 AS sv_0, 0.890656365476 AS sv_1, 1.74987508066 AS sv_2, 0.770942115049 AS sv_3 UNION ALL SELECT 22 AS sv_idx, 1.0 AS dual_coeff, -0.76184912573 AS sv_0, -1.30486574398 AS sv_1, 0.791028391401 AS sv_2, 1.35008049629 AS sv_3 UNION ALL SELECT 23 AS sv_idx, -0.589761433116 AS dual_coeff, 0.0639761065717 AS sv_0, 0.0983582297375 AS sv_1, 1.81821076276 AS sv_2, -1.04081249639 AS sv_3 UNION ALL SELECT 24 AS sv_idx, -0.346895229302 AS dual_coeff, -1.39135786901 AS sv_0, -1.37635711719 AS sv_1, 1.58244332519 AS sv_2, 1.66774660665 AS sv_3 UNION ALL SELECT 25 AS sv_idx, 0.562338499712 AS dual_coeff, -0.93669050728 AS sv_0, -1.25397023094 AS sv_1, 0.476883148779 AS sv_2, -0.678206405779 AS sv_3 UNION ALL SELECT 26 AS sv_idx, 1.0 AS dual_coeff, -0.676197537035 AS sv_0, -0.48036658442 AS sv_1, 0.152491632253 AS sv_2, -0.0350597833391 AS sv_3 UNION ALL SELECT 27 AS sv_idx, 0.00931984905654 AS dual_coeff, 1.00693763709 AS sv_0, 1.38551306987 AS sv_1, 0.425080326211 AS sv_2, -1.12619322668 AS sv_3 UNION ALL SELECT 28 AS sv_idx, 0.777320004737 AS dual_coeff, 1.68589981646 AS sv_0, 1.10623020494 AS sv_1, -0.738113106696 AS sv_2, 1.64638453994 AS sv_3 UNION ALL SELECT 29 AS sv_idx, 0.179458324678 AS dual_coeff, 1.76100138502 AS sv_0, 0.285431251099 AS sv_1, 0.09231656183 AS sv_2, -0.208316475889 AS sv_3 UNION ALL SELECT 30 AS sv_idx, -0.337661535197 AS dual_coeff, 1.46323542272 AS sv_0, 1.44391763949 AS sv_1, 1.32358014466 AS sv_2, 0.330499550784 AS sv_3 UNION ALL SELECT 31 AS sv_idx, -1.0 AS dual_coeff, -1.23522371729 AS sv_0, -1.70835039161 AS sv_1, -1.55027745415 AS sv_2, -0.916251644816 AS sv_3 UNION ALL SELECT 32 AS sv_idx, 0.199968233295 AS dual_coeff, 1.7982833563 AS sv_0, -0.540106694497 AS sv_1, -0.334484412183 AS sv_2, 0.275736405656 AS sv_3 UNION ALL SELECT 33 AS sv_idx, 0.972032672288 AS dual_coeff, -1.22098005728 AS sv_0, -1.52741170432 AS sv_1, -1.01469306439 AS sv_2, -0.894294024556 AS sv_3 UNION ALL SELECT 34 AS sv_idx, -0.760023213994 AS dual_coeff, 1.08559473451 AS sv_0, -0.724669195492 AS sv_1, -1.0387134534 AS sv_2, -0.548609399529 AS sv_3) AS "Values"), 
kernel_cte AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(full_join_data_sv.dot_prod1) + 1.33976382926 AS dot_product 
FROM (SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", "SV_data".dual_coeff * power(0.25 * ("ADS_sca_2_OUT".scaler_output_2 * "SV_data".sv_0 + "ADS_sca_2_OUT".scaler_output_3 * "SV_data".sv_1 + "ADS_sca_2_OUT".scaler_output_4 * "SV_data".sv_2 + "ADS_sca_2_OUT".scaler_output_5 * "SV_data".sv_3) + 0.0, 3) AS dot_prod1 
FROM "ADS_sca_2_OUT", "SV_data") AS full_join_data_sv GROUP BY full_join_data_sv."KEY") AS t)
 SELECT kernel_cte."KEY" AS "KEY", kernel_cte.dot_product AS "Estimator" 
FROM kernel_cte