-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "ADS_imp_1_OUT" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 50.3363543625 ELSE "ADS"."Feature_0" END AS imputer_output_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 1012.31508358 ELSE "ADS"."Feature_1" END AS imputer_output_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 0.465262778373 ELSE "ADS"."Feature_2" END AS imputer_output_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 6.91639120202 ELSE "ADS"."Feature_3" END AS imputer_output_5 
FROM freidman2 AS "ADS"), 
"ADS_sca_2_OUT" AS 
(SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".imputer_output_2 AS FLOAT) - 50.3363543625) / 26.9733430314 AS scaler_output_2, (CAST("ADS_imp_1_OUT".imputer_output_3 AS FLOAT) - 1012.31508358) / 370.103689265 AS scaler_output_3, (CAST("ADS_imp_1_OUT".imputer_output_4 AS FLOAT) - 0.465262778373) / 0.307292501509 AS scaler_output_4, (CAST("ADS_imp_1_OUT".imputer_output_5 AS FLOAT) - 6.91639120202) / 2.84358275215 AS scaler_output_5 
FROM "ADS_imp_1_OUT"), 
"SV_data" AS 
(SELECT "Values".sv_idx AS sv_idx, "Values".dual_coeff AS dual_coeff, "Values".sv_0 AS sv_0, "Values".sv_1 AS sv_1, "Values".sv_2 AS sv_2, "Values".sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, -1.0 AS dual_coeff, -1.64009761079 AS sv_0, 1.12325287321 AS sv_1, -1.13492273821 AS sv_2, -0.273158173971 AS sv_3 UNION ALL SELECT 1 AS sv_idx, -1.0 AS dual_coeff, -0.366733695699 AS sv_0, -1.08216146259 AS sv_1, -1.44367984335 AS sv_2, -0.451527882885 AS sv_3 UNION ALL SELECT 2 AS sv_idx, -1.0 AS dual_coeff, 1.04807472486 AS sv_0, -1.04692409264 AS sv_1, -0.938969570113 AS sv_2, -0.0580857638823 AS sv_3 UNION ALL SELECT 3 AS sv_idx, -1.0 AS dual_coeff, 0.124237779271 AS sv_0, 0.574699003588 AS sv_1, -0.885945435222 AS sv_2, -1.72297062743 AS sv_3 UNION ALL SELECT 4 AS sv_idx, 1.0 AS dual_coeff, 0.105370394007 AS sv_0, -0.390041128568 AS sv_1, 0.642525255071 AS sv_2, 0.802789866355 AS sv_3 UNION ALL SELECT 5 AS sv_idx, 1.0 AS dual_coeff, 0.410337939091 AS sv_0, -0.363337498226 AS sv_1, 1.52351068335 AS sv_2, -1.51056191301 AS sv_3 UNION ALL SELECT 6 AS sv_idx, 1.0 AS dual_coeff, -1.26104716307 AS sv_0, 0.418186108259 AS sv_1, 1.30225118641 AS sv_2, -1.00795497905 AS sv_3 UNION ALL SELECT 7 AS sv_idx, 1.0 AS dual_coeff, 0.255211361785 AS sv_0, -0.283071268686 AS sv_1, 1.29934710087 AS sv_2, 0.928915735215 AS sv_3 UNION ALL SELECT 8 AS sv_idx, 1.0 AS dual_coeff, 0.202532691442 AS sv_0, 0.754688018098 AS sv_1, 1.29942491195 AS sv_2, 1.32770314008 AS sv_3 UNION ALL SELECT 9 AS sv_idx, 1.0 AS dual_coeff, -1.59526766421 AS sv_0, 1.10211747008 AS sv_1, -0.336911512927 AS sv_2, -1.28932448356 AS sv_3 UNION ALL SELECT 10 AS sv_idx, -1.0 AS dual_coeff, 0.286503989861 AS sv_0, 0.0560380996042 AS sv_1, -0.419991438652 AS sv_2, 0.553657816177 AS sv_3 UNION ALL SELECT 11 AS sv_idx, -1.0 AS dual_coeff, 0.201610302286 AS sv_0, 1.45093084132 AS sv_1, -0.992038251238 AS sv_2, 0.920842114031 AS sv_3 UNION ALL SELECT 12 AS sv_idx, 1.0 AS dual_coeff, -1.73884725472 AS sv_0, -0.194239293254 AS sv_1, 1.34504608158 AS sv_2, 0.771098085945 AS sv_3 UNION ALL SELECT 13 AS sv_idx, 1.0 AS dual_coeff, -0.976604331203 AS sv_0, 1.58064448883 AS sv_1, 0.9671115004 AS sv_2, 0.805049988676 AS sv_3 UNION ALL SELECT 14 AS sv_idx, -1.0 AS dual_coeff, 0.636835035973 AS sv_0, -1.5836233302 AS sv_1, 0.719012529632 AS sv_2, -1.23924268674 AS sv_3 UNION ALL SELECT 15 AS sv_idx, 1.0 AS dual_coeff, -0.366831544914 AS sv_0, 0.821255329496 AS sv_1, 0.914967465274 AS sv_2, 1.12225253951 AS sv_3 UNION ALL SELECT 16 AS sv_idx, 1.0 AS dual_coeff, 0.999235290225 AS sv_0, 0.741730537486 AS sv_1, -0.403217827445 AS sv_2, 0.0238048384904 AS sv_3 UNION ALL SELECT 17 AS sv_idx, 1.0 AS dual_coeff, -0.0109577390708 AS sv_0, 0.170563485428 AS sv_1, 1.56659995349 AS sv_2, 0.381048076901 AS sv_3 UNION ALL SELECT 18 AS sv_idx, 1.0 AS dual_coeff, -0.800976235516 AS sv_0, 0.679874026168 AS sv_1, 1.43774505131 AS sv_2, 1.37138540395 AS sv_3 UNION ALL SELECT 19 AS sv_idx, 1.0 AS dual_coeff, 1.82992898865 AS sv_0, 1.91598033565 AS sv_1, -0.319868845506 AS sv_2, -1.08563173137 AS sv_3 UNION ALL SELECT 20 AS sv_idx, 1.0 AS dual_coeff, 0.541610753524 AS sv_0, 1.26763570893 AS sv_1, -0.108856258893 AS sv_2, 0.739935875677 AS sv_3 UNION ALL SELECT 21 AS sv_idx, 1.0 AS dual_coeff, -0.634833547317 AS sv_0, 0.415215534345 AS sv_1, 0.154848903321 AS sv_2, -0.0277091540335 AS sv_3 UNION ALL SELECT 22 AS sv_idx, 1.0 AS dual_coeff, 0.890404378963 AS sv_0, -0.432663886598 AS sv_1, 0.258570998715 AS sv_2, -0.445039797286 AS sv_3 UNION ALL SELECT 23 AS sv_idx, 1.0 AS dual_coeff, 1.01897140666 AS sv_0, -0.207261760642 AS sv_1, 0.605037564919 AS sv_2, 1.06414025767 AS sv_3 UNION ALL SELECT 24 AS sv_idx, -1.0 AS dual_coeff, -1.54286274311 AS sv_0, -0.960896935168 AS sv_1, -1.45869687116 AS sv_2, -2.03241167646 AS sv_3 UNION ALL SELECT 25 AS sv_idx, 1.0 AS dual_coeff, -0.712596580742 AS sv_0, 0.0613457905528 AS sv_1, 0.329442879497 AS sv_2, -0.47931867475 AS sv_3 UNION ALL SELECT 26 AS sv_idx, -1.0 AS dual_coeff, -1.25155327036 AS sv_0, -0.252353591169 AS sv_1, -1.45423181156 AS sv_2, -1.35400787945 AS sv_3 UNION ALL SELECT 27 AS sv_idx, -1.0 AS dual_coeff, -0.151018693811 AS sv_0, 0.450931332339 AS sv_1, -1.15777704076 AS sv_2, 0.572633117872 AS sv_3 UNION ALL SELECT 28 AS sv_idx, -1.0 AS dual_coeff, 1.20673728138 AS sv_0, -0.635777560488 AS sv_1, -1.44080311826 AS sv_2, -0.56973181907 AS sv_3 UNION ALL SELECT 29 AS sv_idx, -1.0 AS dual_coeff, -0.140089353295 AS sv_0, -1.91744524066 AS sv_1, -0.575526494153 AS sv_2, 0.408733094469 AS sv_3 UNION ALL SELECT 30 AS sv_idx, 1.0 AS dual_coeff, -1.73648968648 AS sv_0, -0.0362218874598 AS sv_1, 1.64955442169 AS sv_2, 0.289879658933 AS sv_3 UNION ALL SELECT 31 AS sv_idx, -1.0 AS dual_coeff, 1.09971226154 AS sv_0, -0.921181242216 AS sv_1, 0.078582793255 AS sv_2, 0.82589424741 AS sv_3 UNION ALL SELECT 32 AS sv_idx, 1.0 AS dual_coeff, 0.688276257184 AS sv_0, 1.81166705089 AS sv_1, 0.306002911029 AS sv_2, 1.205070211 AS sv_3 UNION ALL SELECT 33 AS sv_idx, 1.0 AS dual_coeff, -0.478639422867 AS sv_0, 1.79421809452 AS sv_1, -0.736722812442 AS sv_2, -1.89625896993 AS sv_3 UNION ALL SELECT 34 AS sv_idx, -1.0 AS dual_coeff, -0.790158140052 AS sv_0, 0.698466121685 AS sv_1, -0.666764872247 AS sv_2, 0.680097369548 AS sv_3 UNION ALL SELECT 35 AS sv_idx, -1.0 AS dual_coeff, 1.18649057787 AS sv_0, -1.68833430037 AS sv_1, 0.821038688045 AS sv_2, 0.248871584963 AS sv_3 UNION ALL SELECT 36 AS sv_idx, -1.0 AS dual_coeff, -0.670073309162 AS sv_0, -1.41994481616 AS sv_1, 0.474194931754 AS sv_2, 0.347411957016 AS sv_3 UNION ALL SELECT 37 AS sv_idx, -1.0 AS dual_coeff, -1.73402422366 AS sv_0, -1.12232980565 AS sv_1, -0.0330846569453 AS sv_2, 1.31955161146 AS sv_3 UNION ALL SELECT 38 AS sv_idx, -1.0 AS dual_coeff, 0.38866795256 AS sv_0, -0.36411066716 AS sv_1, -1.44879242718 AS sv_2, 1.42275293157 AS sv_3 UNION ALL SELECT 39 AS sv_idx, -1.0 AS dual_coeff, -0.0662396092167 AS sv_0, -0.908584901174 AS sv_1, -0.101750876417 AS sv_2, -0.540717497094 AS sv_3 UNION ALL SELECT 40 AS sv_idx, 1.0 AS dual_coeff, 0.432596863379 AS sv_0, 0.748782926997 AS sv_1, -0.00428642206632 AS sv_2, 0.603334372648 AS sv_3 UNION ALL SELECT 41 AS sv_idx, 1.0 AS dual_coeff, 1.47842174523 AS sv_0, -1.14009578715 AS sv_1, 1.29876475158 AS sv_2, -1.61620068514 AS sv_3 UNION ALL SELECT 42 AS sv_idx, -1.0 AS dual_coeff, -0.153357515955 AS sv_0, -0.571403730739 AS sv_1, -1.387409292 AS sv_2, -1.80126051003 AS sv_3 UNION ALL SELECT 43 AS sv_idx, -1.0 AS dual_coeff, 0.582202623859 AS sv_0, 1.08318686375 AS sv_1, -0.710293671921 AS sv_2, 0.567958223153 AS sv_3 UNION ALL SELECT 44 AS sv_idx, 1.0 AS dual_coeff, 0.775008987395 AS sv_0, -1.44025175794 AS sv_1, 1.42901887971 AS sv_2, 0.180692496495 AS sv_3 UNION ALL SELECT 45 AS sv_idx, -1.0 AS dual_coeff, -0.0680335025699 AS sv_0, -1.01585046659 AS sv_1, -0.501460277573 AS sv_2, -1.31706850586 AS sv_3 UNION ALL SELECT 46 AS sv_idx, 1.0 AS dual_coeff, 0.914143207494 AS sv_0, 0.540614190563 AS sv_1, 0.542836478863 AS sv_2, 1.32635455496 AS sv_3 UNION ALL SELECT 47 AS sv_idx, -1.0 AS dual_coeff, -0.226283332445 AS sv_0, -2.20972582949 AS sv_1, -0.28226201033 AS sv_2, -0.93743545516 AS sv_3 UNION ALL SELECT 48 AS sv_idx, 1.0 AS dual_coeff, -0.294442592249 AS sv_0, 1.03695634421 AS sv_1, 1.02474826229 AS sv_2, -1.14751207809 AS sv_3 UNION ALL SELECT 49 AS sv_idx, -1.0 AS dual_coeff, 1.55642628503 AS sv_0, 0.265564388295 AS sv_1, -1.06283082597 AS sv_2, 0.153944879304 AS sv_3 UNION ALL SELECT 50 AS sv_idx, -1.0 AS dual_coeff, 1.30365615554 AS sv_0, -0.0993599650108 AS sv_1, -0.43689348215 AS sv_2, -1.63521876846 AS sv_3 UNION ALL SELECT 51 AS sv_idx, 1.0 AS dual_coeff, -1.17007131718 AS sv_0, 0.996415800037 AS sv_1, 1.31726264285 AS sv_2, 0.676889785533 AS sv_3 UNION ALL SELECT 52 AS sv_idx, 1.0 AS dual_coeff, 0.524131192749 AS sv_0, -0.805636081158 AS sv_1, 0.920206452412 AS sv_2, -1.61381851435 AS sv_3 UNION ALL SELECT 53 AS sv_idx, -1.0 AS dual_coeff, -0.627664120935 AS sv_0, 0.172204730599 AS sv_1, -1.36104814218 AS sv_2, 0.772627897887 AS sv_3 UNION ALL SELECT 54 AS sv_idx, 1.0 AS dual_coeff, 0.0122508771064 AS sv_0, 0.764642658657 AS sv_1, 0.427491837639 AS sv_2, 0.237534006797 AS sv_3 UNION ALL SELECT 55 AS sv_idx, -1.0 AS dual_coeff, -1.55077760749 AS sv_0, 1.74748644457 AS sv_1, -1.49287279823 AS sv_2, -1.38213179416 AS sv_3 UNION ALL SELECT 56 AS sv_idx, 1.0 AS dual_coeff, 0.54830029857 AS sv_0, 0.239992963609 AS sv_1, 0.99322817828 AS sv_2, -0.429313634789 AS sv_3 UNION ALL SELECT 57 AS sv_idx, -1.0 AS dual_coeff, -0.959556474273 AS sv_0, 0.103490994384 AS sv_1, -1.38130816512 AS sv_2, 1.12772005862 AS sv_3 UNION ALL SELECT 58 AS sv_idx, -1.0 AS dual_coeff, -1.71513078311 AS sv_0, -1.12939054139 AS sv_1, -0.960786328836 AS sv_2, -0.418653455911 AS sv_3 UNION ALL SELECT 59 AS sv_idx, 1.0 AS dual_coeff, 0.845284217108 AS sv_0, 0.803976893359 AS sv_1, -0.131840378795 AS sv_2, 0.819007055206 AS sv_3 UNION ALL SELECT 60 AS sv_idx, -1.0 AS dual_coeff, 0.430641008654 AS sv_0, -0.646565421078 AS sv_1, -1.17276961516 AS sv_2, -0.439797748465 AS sv_3 UNION ALL SELECT 61 AS sv_idx, -1.0 AS dual_coeff, 0.731432571708 AS sv_0, -1.9373820523 AS sv_1, 1.57689337172 AS sv_2, 0.0898390636661 AS sv_3 UNION ALL SELECT 62 AS sv_idx, -1.0 AS dual_coeff, 1.481465108 AS sv_0, 0.736858814425 AS sv_1, -0.775329637898 AS sv_2, -0.162675611614 AS sv_3 UNION ALL SELECT 63 AS sv_idx, 1.0 AS dual_coeff, -1.54245620067 AS sv_0, 0.114977203776 AS sv_1, 1.49806676857 AS sv_2, 0.898015993938 AS sv_3 UNION ALL SELECT 64 AS sv_idx, 1.0 AS dual_coeff, -1.11706045097 AS sv_0, 0.0946698423473 AS sv_1, -0.0377819364303 AS sv_2, 1.37480322351 AS sv_3 UNION ALL SELECT 65 AS sv_idx, -1.0 AS dual_coeff, 1.81240916546 AS sv_0, 0.473061134992 AS sv_1, -1.37726685225 AS sv_2, 0.805019743804 AS sv_3) AS "Values"), 
kernel_cte AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(full_join_data_sv.dot_prod1) + 389.398592122 AS dot_product 
FROM (SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", "SV_data".dual_coeff * exp(CASE WHEN (-0.25 * (power("ADS_sca_2_OUT".scaler_output_2 - "SV_data".sv_0, 2) + power("ADS_sca_2_OUT".scaler_output_3 - "SV_data".sv_1, 2) + power("ADS_sca_2_OUT".scaler_output_4 - "SV_data".sv_2, 2) + power("ADS_sca_2_OUT".scaler_output_5 - "SV_data".sv_3, 2)) >= -709.782712893) THEN -0.25 * (power("ADS_sca_2_OUT".scaler_output_2 - "SV_data".sv_0, 2) + power("ADS_sca_2_OUT".scaler_output_3 - "SV_data".sv_1, 2) + power("ADS_sca_2_OUT".scaler_output_4 - "SV_data".sv_2, 2) + power("ADS_sca_2_OUT".scaler_output_5 - "SV_data".sv_3, 2)) ELSE -709.782712893 END) AS dot_prod1 
FROM "ADS_sca_2_OUT", "SV_data") AS full_join_data_sv GROUP BY full_join_data_sv."KEY") AS t)
 SELECT kernel_cte."KEY" AS "KEY", kernel_cte.dot_product AS "Estimator" 
FROM kernel_cte