-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 48.3099623094 ELSE `ADS`.`Feature_0` END AS imputer_output_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 947.086261854 ELSE `ADS`.`Feature_1` END AS imputer_output_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 0.516741223527 ELSE `ADS`.`Feature_2` END AS imputer_output_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 6.03050021464 ELSE `ADS`.`Feature_3` END AS imputer_output_5 
FROM freidman3 AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.imputer_output_2 AS DOUBLE) - 48.3099623094) / 29.4293007313 AS scaler_output_2, (CAST(`ADS_imp_1_OUT`.imputer_output_3 AS DOUBLE) - 947.086261854) / 462.613966812 AS scaler_output_3, (CAST(`ADS_imp_1_OUT`.imputer_output_4 AS DOUBLE) - 0.516741223527) / 0.306136701549 AS scaler_output_4, (CAST(`ADS_imp_1_OUT`.imputer_output_5 AS DOUBLE) - 6.03050021464) / 2.62064333813 AS scaler_output_5 
FROM `ADS_imp_1_OUT`), 
`SV_data` AS 
(SELECT `Values`.sv_idx AS sv_idx, `Values`.dual_coeff AS dual_coeff, `Values`.sv_0 AS sv_0, `Values`.sv_1 AS sv_1, `Values`.sv_2 AS sv_2, `Values`.sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, -0.18330208249 AS dual_coeff, 1.73238289212 AS sv_0, -1.32061426552 AS sv_1, -0.296832127944 AS sv_2, 0.521404987552 AS sv_3 UNION ALL SELECT 1 AS sv_idx, 0.10875373046 AS dual_coeff, -0.827644427263 AS sv_0, 1.60714740122 AS sv_1, 0.788043836262 AS sv_2, 1.80601485223 AS sv_3 UNION ALL SELECT 2 AS sv_idx, 0.980004749928 AS dual_coeff, -0.762250561736 AS sv_0, -0.217182009578 AS sv_1, -1.09104510101 AS sv_2, -1.01813543244 AS sv_3 UNION ALL SELECT 3 AS sv_idx, 0.0211664915346 AS dual_coeff, -0.901010347357 AS sv_0, 0.430030214062 AS sv_1, -0.906064973187 AS sv_2, 1.85862734394 AS sv_3 UNION ALL SELECT 4 AS sv_idx, -0.165156184905 AS dual_coeff, 0.205390651309 AS sv_0, -1.64946674052 AS sv_1, -0.106826912319 AS sv_2, -1.14271687062 AS sv_3 UNION ALL SELECT 5 AS sv_idx, -0.269745058828 AS dual_coeff, 0.319838781656 AS sv_0, -0.745973397301 AS sv_1, -1.2532564153 AS sv_2, 1.63732536514 AS sv_3 UNION ALL SELECT 6 AS sv_idx, 0.0320962261429 AS dual_coeff, 1.5491301797 AS sv_0, 1.71240059101 AS sv_1, 1.1536538594 AS sv_2, 0.404280044845 AS sv_3 UNION ALL SELECT 7 AS sv_idx, -1.0 AS dual_coeff, 0.815483253414 AS sv_0, -0.037205446768 AS sv_1, -1.67608650065 AS sv_2, -1.04545669253 AS sv_3 UNION ALL SELECT 8 AS sv_idx, 0.0459760063986 AS dual_coeff, 0.802097329735 AS sv_0, 0.0718340109466 AS sv_1, -0.829843062856 AS sv_2, 1.29040762178 AS sv_3 UNION ALL SELECT 9 AS sv_idx, 0.180716976109 AS dual_coeff, 1.67772333112 AS sv_0, 0.808621034955 AS sv_1, -0.0457397037892 AS sv_2, -1.58573170663 AS sv_3 UNION ALL SELECT 10 AS sv_idx, 0.436568690112 AS dual_coeff, 0.307538923663 AS sv_0, -0.868546723281 AS sv_1, -0.183444152946 AS sv_2, -1.22957119857 AS sv_3 UNION ALL SELECT 11 AS sv_idx, -1.0 AS dual_coeff, -0.569366350517 AS sv_0, -1.13787659782 AS sv_1, -1.59519160634 AS sv_2, -1.13651859885 AS sv_3 UNION ALL SELECT 12 AS sv_idx, 0.415783624756 AS dual_coeff, 0.454107979856 AS sv_0, -0.647968325433 AS sv_1, -0.456341656237 AS sv_2, 0.349628412516 AS sv_3 UNION ALL SELECT 13 AS sv_idx, 0.10525294643 AS dual_coeff, -0.90900361418 AS sv_0, 1.57159332917 AS sv_1, 1.52268548377 AS sv_2, -0.795514084203 AS sv_3 UNION ALL SELECT 14 AS sv_idx, -1.0 AS dual_coeff, -0.693463617256 AS sv_0, -1.17267448826 AS sv_1, -1.48966670323 AS sv_2, -0.0614551933163 AS sv_3 UNION ALL SELECT 15 AS sv_idx, 0.522575518429 AS dual_coeff, -1.51645109656 AS sv_0, -1.2579186752 AS sv_1, -1.55190582545 AS sv_2, -0.0259369890588 AS sv_3 UNION ALL SELECT 16 AS sv_idx, -0.0870856739391 AS dual_coeff, -0.23054813781 AS sv_0, -0.807304519635 AS sv_1, 0.568938179474 AS sv_2, -0.348530816755 AS sv_3 UNION ALL SELECT 17 AS sv_idx, 0.226724810864 AS dual_coeff, -1.44510401014 AS sv_0, -1.74185721801 AS sv_1, -1.07540216047 AS sv_2, 0.0477191960003 AS sv_3 UNION ALL SELECT 18 AS sv_idx, -0.0267041671437 AS dual_coeff, 1.66525078735 AS sv_0, -0.978111837849 AS sv_1, -1.23305290436 AS sv_2, -1.46586568025 AS sv_3 UNION ALL SELECT 19 AS sv_idx, 0.113175392192 AS dual_coeff, -1.56208559781 AS sv_0, -0.639326816011 AS sv_1, 0.270202237113 AS sv_2, 1.8556896162 AS sv_3 UNION ALL SELECT 20 AS sv_idx, 0.0533912184164 AS dual_coeff, 0.784388696974 AS sv_0, 1.24149018813 AS sv_1, 1.23697760345 AS sv_2, 1.67337655448 AS sv_3 UNION ALL SELECT 21 AS sv_idx, 0.0547828189135 AS dual_coeff, 1.50182204781 AS sv_0, 1.60361515456 AS sv_1, -0.246061540743 AS sv_2, -0.226201972359 AS sv_3 UNION ALL SELECT 22 AS sv_idx, 0.478611391802 AS dual_coeff, -0.480470765811 AS sv_0, -0.381220850362 AS sv_1, -1.27469850141 AS sv_2, -0.151696360648 AS sv_3 UNION ALL SELECT 23 AS sv_idx, -0.193619923146 AS dual_coeff, -0.777905480409 AS sv_0, 0.604151713373 AS sv_1, -0.635575742291 AS sv_2, 0.132273101264 AS sv_3 UNION ALL SELECT 24 AS sv_idx, 0.0776677603526 AS dual_coeff, -1.62186971111 AS sv_0, -1.21841174658 AS sv_1, 1.2978038946 AS sv_2, -0.401967734518 AS sv_3 UNION ALL SELECT 25 AS sv_idx, 0.0723647376116 AS dual_coeff, -1.33499456931 AS sv_0, 1.2966248287 AS sv_1, -1.17158940989 AS sv_2, 1.15049158589 AS sv_3) AS `Values`), 
kernel_cte AS 
(SELECT t.`KEY` AS `KEY`, t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv.`KEY` AS `KEY`, sum(full_join_data_sv.dot_prod1) + 1.23271918662 AS dot_product 
FROM (SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, `SV_data`.dual_coeff * exp(-0.25 * (power(`ADS_sca_2_OUT`.scaler_output_2 - `SV_data`.sv_0, 2) + power(`ADS_sca_2_OUT`.scaler_output_3 - `SV_data`.sv_1, 2) + power(`ADS_sca_2_OUT`.scaler_output_4 - `SV_data`.sv_2, 2) + power(`ADS_sca_2_OUT`.scaler_output_5 - `SV_data`.sv_3, 2))) AS dot_prod1 
FROM `ADS_sca_2_OUT`, `SV_data`) AS full_join_data_sv GROUP BY full_join_data_sv.`KEY`) AS t)
 SELECT kernel_cte.`KEY` AS `KEY`, kernel_cte.dot_product AS `Estimator` 
FROM kernel_cte