-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH [ADS_imp_1_OUT] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_0] IS NULL) THEN 50.0252289698 ELSE [ADS].[Feature_0] END AS imputer_output_2, CASE WHEN ([ADS].[Feature_1] IS NULL) THEN 1014.9838197 ELSE [ADS].[Feature_1] END AS imputer_output_3, CASE WHEN ([ADS].[Feature_2] IS NULL) THEN 0.560354566422 ELSE [ADS].[Feature_2] END AS imputer_output_4, CASE WHEN ([ADS].[Feature_3] IS NULL) THEN 6.3290947138 ELSE [ADS].[Feature_3] END AS imputer_output_5 
FROM freidman2 AS [ADS]), 
[ADS_sca_2_OUT] AS 
(SELECT [ADS_imp_1_OUT].[KEY] AS [KEY], (CAST([ADS_imp_1_OUT].imputer_output_2 AS FLOAT) - 50.0252289698) / 30.1439997801 AS scaler_output_2, (CAST([ADS_imp_1_OUT].imputer_output_3 AS FLOAT) - 1014.9838197) / 440.702091914 AS scaler_output_3, (CAST([ADS_imp_1_OUT].imputer_output_4 AS FLOAT) - 0.560354566422) / 0.28468564121 AS scaler_output_4, (CAST([ADS_imp_1_OUT].imputer_output_5 AS FLOAT) - 6.3290947138) / 2.76621982842 AS scaler_output_5 
FROM [ADS_imp_1_OUT]), 
[DT_node_lookup] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= 1.3266034126281738) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= 0.09676793217658997) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= -0.6026390790939331) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= -0.18270093202590942) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= -1.4846001863479614) THEN 5 ELSE 6 END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= -1.218177080154419) THEN 8 ELSE 9 END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= -0.0068050771951675415) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= -1.0978584289550781) THEN 12 ELSE 13 END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_5 <= -1.0067311525344849) THEN 15 ELSE 16 END END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= -0.5609764456748962) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= 0.4680362045764923) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_5 <= -0.17359745502471924) THEN 20 ELSE 21 END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_2 <= -1.0960925817489624) THEN 23 ELSE 24 END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= 0.3331712782382965) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= 0.8762000799179077) THEN 27 ELSE 28 END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= 0.14708168804645538) THEN 30 ELSE 31 END END END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= 0.9769956469535828) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= 0.018412284553050995) THEN 34 ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= 0.4458034336566925) THEN 36 ELSE 37 END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= 1.6372675895690918) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_3 <= 1.4130268096923828) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_output_5 <= -0.25089940428733826) THEN 41 ELSE 42 END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_output_4 <= 1.4014606475830078) THEN 44 ELSE 45 END END ELSE 46 END END END AS node_id_2 
FROM [ADS_sca_2_OUT]), 
[DT_node_data] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].parent_id AS parent_id, [Values].[Estimator] AS [Estimator] 
FROM (SELECT 0 AS node_id, 'scaler_output_4' AS feature, 1.3266034126281738 AS threshold, 67 AS count, 0 AS depth, CAST(NULL AS INTEGER) AS parent_id, 595.4555951379896 AS [Estimator] UNION ALL SELECT 1 AS node_id, 'scaler_output_4' AS feature, 0.09676793217658997 AS threshold, 59 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 482.1244112006952 AS [Estimator] UNION ALL SELECT 2 AS node_id, 'scaler_output_4' AS feature, -0.6026390790939331 AS threshold, 35 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 307.5350938508734 AS [Estimator] UNION ALL SELECT 3 AS node_id, 'scaler_output_3' AS feature, -0.18270093202590942 AS threshold, 22 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 222.41237101337964 AS [Estimator] UNION ALL SELECT 4 AS node_id, 'scaler_output_3' AS feature, -1.4846001863479614 AS threshold, 9 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 123.44355471702991 AS [Estimator] UNION ALL SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 51.90006097929054 AS [Estimator] UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 6 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 159.21530158589962 AS [Estimator] UNION ALL SELECT 7 AS node_id, 'scaler_output_4' AS feature, -1.218177080154419 AS threshold, 13 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 290.92924383392943 AS [Estimator] UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 5 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 174.82502651869288 AS [Estimator] UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 8 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 363.49437965595234 AS [Estimator] UNION ALL SELECT 10 AS node_id, 'scaler_output_3' AS feature, -0.0068050771951675415 AS threshold, 13 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 451.5889324989396 AS [Estimator] UNION ALL SELECT 11 AS node_id, 'scaler_output_3' AS feature, -1.0978584289550781 AS threshold, 7 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 300.9956922284049 AS [Estimator] UNION ALL SELECT 12 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 198.66009543540804 AS [Estimator] UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 377.7473898231525 AS [Estimator] UNION ALL SELECT 14 AS node_id, 'scaler_output_5' AS feature, -1.0067311525344849 AS threshold, 6 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 627.2810461478969 AS [Estimator] UNION ALL SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 859.9086518940435 AS [Estimator] UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 5 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 580.7555249986675 AS [Estimator] UNION ALL SELECT 17 AS node_id, 'scaler_output_3' AS feature, -0.5609764456748962 AS threshold, 24 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 736.7338323358522 AS [Estimator] UNION ALL SELECT 18 AS node_id, 'scaler_output_4' AS feature, 0.4680362045764923 AS threshold, 8 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 402.9272995703535 AS [Estimator] UNION ALL SELECT 19 AS node_id, 'scaler_output_5' AS feature, -0.17359745502471924 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 158.3013775333678 AS [Estimator] UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 146.50475932517276 AS [Estimator] UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 170.09799574156284 AS [Estimator] UNION ALL SELECT 22 AS node_id, 'scaler_output_2' AS feature, -1.0960925817489624 AS threshold, 6 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 484.4692735826821 AS [Estimator] UNION ALL SELECT 23 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 580.1123983709442 AS [Estimator] UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 436.64771118855106 AS [Estimator] UNION ALL SELECT 25 AS node_id, 'scaler_output_3' AS feature, 0.3331712782382965 AS threshold, 16 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 903.6370987186019 AS [Estimator] UNION ALL SELECT 26 AS node_id, 'scaler_output_4' AS feature, 0.8762000799179077 AS threshold, 7 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 823.0909378667766 AS [Estimator] UNION ALL SELECT 27 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 754.762762305745 AS [Estimator] UNION ALL SELECT 28 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 874.3370695375502 AS [Estimator] UNION ALL SELECT 29 AS node_id, 'scaler_output_4' AS feature, 0.14708168804645538 AS threshold, 9 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 966.2841127144654 AS [Estimator] UNION ALL SELECT 30 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 843.1941770615479 AS [Estimator] UNION ALL SELECT 31 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 7 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1001.4526657581563 AS [Estimator] UNION ALL SELECT 32 AS node_id, 'scaler_output_3' AS feature, 0.9769956469535828 AS threshold, 8 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1431.273076675537 AS [Estimator] UNION ALL SELECT 33 AS node_id, 'scaler_output_3' AS feature, 0.018412284553050995 AS threshold, 3 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1103.7627222122235 AS [Estimator] UNION ALL SELECT 34 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 918.5596705671626 AS [Estimator] UNION ALL SELECT 35 AS node_id, 'scaler_output_3' AS feature, 0.4458034336566925 AS threshold, 2 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1196.364248034754 AS [Estimator] UNION ALL SELECT 36 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1125.0092901332064 AS [Estimator] UNION ALL SELECT 37 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1267.7192059363013 AS [Estimator] UNION ALL SELECT 38 AS node_id, 'scaler_output_3' AS feature, 1.6372675895690918 AS threshold, 5 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1627.7792893535252 AS [Estimator] UNION ALL SELECT 39 AS node_id, 'scaler_output_3' AS feature, 1.4130268096923828 AS threshold, 4 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1603.4985970689668 AS [Estimator] UNION ALL SELECT 40 AS node_id, 'scaler_output_5' AS feature, -0.25089940428733826 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1577.196714168259 AS [Estimator] UNION ALL SELECT 41 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1588.0197819149892 AS [Estimator] UNION ALL SELECT 42 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1566.3736464215285 AS [Estimator] UNION ALL SELECT 43 AS node_id, 'scaler_output_4' AS feature, 1.4014606475830078 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1629.800479969675 AS [Estimator] UNION ALL SELECT 44 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1613.447294666848 AS [Estimator] UNION ALL SELECT 45 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1646.153665272502 AS [Estimator] UNION ALL SELECT 46 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1724.9020584917582 AS [Estimator]) AS [Values]), 
[DT_Output] AS 
(SELECT [DT_node_lookup].[KEY] AS [KEY], [DT_node_lookup].node_id_2 AS node_id_2, [DT_node_data].node_id AS node_id, [DT_node_data].feature AS feature, [DT_node_data].threshold AS threshold, [DT_node_data].count AS count, [DT_node_data].depth AS depth, [DT_node_data].parent_id AS parent_id, [DT_node_data].[Estimator] AS [Estimator] 
FROM [DT_node_lookup] LEFT OUTER JOIN [DT_node_data] ON [DT_node_lookup].node_id_2 = [DT_node_data].node_id)
 SELECT [DT_Output].[KEY] AS [KEY], [DT_Output].[Estimator] AS [Estimator] 
FROM [DT_Output]