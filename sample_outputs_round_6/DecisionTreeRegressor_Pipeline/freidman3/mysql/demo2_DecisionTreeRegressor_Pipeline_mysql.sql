-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 51.211640849 ELSE `ADS`.`Feature_0` END AS imputer_output_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 960.336477128 ELSE `ADS`.`Feature_1` END AS imputer_output_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 0.528570060735 ELSE `ADS`.`Feature_2` END AS imputer_output_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 6.16019430479 ELSE `ADS`.`Feature_3` END AS imputer_output_5 
FROM freidman3 AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.imputer_output_2 AS DOUBLE) - 51.211640849) / 27.3335104638 AS scaler_output_2, (CAST(`ADS_imp_1_OUT`.imputer_output_3 AS DOUBLE) - 960.336477128) / 499.110762925 AS scaler_output_3, (CAST(`ADS_imp_1_OUT`.imputer_output_4 AS DOUBLE) - 0.528570060735) / 0.306453048738 AS scaler_output_4, (CAST(`ADS_imp_1_OUT`.imputer_output_5 AS DOUBLE) - 6.16019430479) / 2.72275256036 AS scaler_output_5 
FROM `ADS_imp_1_OUT`), 
`DT_node_lookup` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.6173794269561768) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.701345443725586) THEN 2 ELSE 3 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -0.5772825479507446) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= 0.0674847960472107) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.1313226222991943) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.3526042401790619) THEN 8 ELSE 9 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -1.4665806293487549) THEN 11 ELSE 12 END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.012871503829956055) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -1.281782865524292) THEN 15 ELSE 16 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_3 <= -1.1886179447174072) THEN 18 ELSE 19 END END END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.450117588043213) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_5 <= -1.0449503660202026) THEN 22 ELSE 23 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_4 <= -1.0297552347183228) THEN CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= -1.025317668914795) THEN 26 ELSE 27 END ELSE CASE WHEN (`ADS_sca_2_OUT`.scaler_output_2 <= 0.2213175892829895) THEN 29 ELSE 30 END END END END END AS node_id_2 
FROM `ADS_sca_2_OUT`), 
`DT_node_data` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.count AS count, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Estimator` AS `Estimator` 
FROM (SELECT 0 AS node_id, 'scaler_output_4' AS feature, -1.6173794269561768 AS threshold, 67 AS count, 0 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3252748645221375 AS `Estimator` UNION ALL SELECT 1 AS node_id, 'scaler_output_4' AS feature, -1.701345443725586 AS threshold, 2 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.06394937097954433 AS `Estimator` UNION ALL SELECT 2 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.02568954808077963 AS `Estimator` UNION ALL SELECT 3 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.10220919387830901 AS `Estimator` UNION ALL SELECT 4 AS node_id, 'scaler_output_3' AS feature, -0.5772825479507446 AS threshold, 65 AS count, 1 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3640848797080634 AS `Estimator` UNION ALL SELECT 5 AS node_id, 'scaler_output_4' AS feature, 0.0674847960472107 AS threshold, 21 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.2096276931778283 AS `Estimator` UNION ALL SELECT 6 AS node_id, 'scaler_output_4' AS feature, -1.1313226222991943 AS threshold, 7 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.9951070718383919 AS `Estimator` UNION ALL SELECT 7 AS node_id, 'scaler_output_2' AS feature, 0.3526042401790619 AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.8649932115480223 AS `Estimator` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.9159246653687573 AS `Estimator` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.8140617577272873 AS `Estimator` UNION ALL SELECT 10 AS node_id, 'scaler_output_3' AS feature, -1.4665806293487549 AS threshold, 5 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.0471526159545395 AS `Estimator` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.8975435062114188 AS `Estimator` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.146892022449953 AS `Estimator` UNION ALL SELECT 13 AS node_id, 'scaler_output_2' AS feature, 0.012871503829956055 AS threshold, 14 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3168880038475463 AS `Estimator` UNION ALL SELECT 14 AS node_id, 'scaler_output_3' AS feature, -1.281782865524292 AS threshold, 6 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.438268942876009 AS `Estimator` UNION ALL SELECT 15 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.366791796758239 AS `Estimator` UNION ALL SELECT 16 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.509746088993779 AS `Estimator` UNION ALL SELECT 17 AS node_id, 'scaler_output_3' AS feature, -1.1886179447174072 AS threshold, 8 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.2258522995761996 AS `Estimator` UNION ALL SELECT 18 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 6 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.1819463637308532 AS `Estimator` UNION ALL SELECT 19 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3575701071122395 AS `Estimator` UNION ALL SELECT 20 AS node_id, 'scaler_output_4' AS feature, -1.450117588043213 AS threshold, 44 AS count, 2 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.437803082370221 AS `Estimator` UNION ALL SELECT 21 AS node_id, 'scaler_output_5' AS feature, -1.0449503660202026 AS threshold, 2 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.8485266323250393 AS `Estimator` UNION ALL SELECT 22 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.8140715225415566 AS `Estimator` UNION ALL SELECT 23 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 0.8829817421085222 AS `Estimator` UNION ALL SELECT 24 AS node_id, 'scaler_output_4' AS feature, -1.0297552347183228 AS threshold, 42 AS count, 3 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4658638657057057 AS `Estimator` UNION ALL SELECT 25 AS node_id, 'scaler_output_2' AS feature, -1.025317668914795 AS threshold, 9 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.3380042769394598 AS `Estimator` UNION ALL SELECT 26 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4712495692971561 AS `Estimator` UNION ALL SELECT 27 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 5 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.231408043053303 AS `Estimator` UNION ALL SELECT 28 AS node_id, 'scaler_output_2' AS feature, 0.2213175892829895 AS threshold, 33 AS count, 4 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.5007346626419547 AS `Estimator` UNION ALL SELECT 29 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 18 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.5370396072013408 AS `Estimator` UNION ALL SELECT 30 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 15 AS count, 5 AS depth, CAST(NULL AS SIGNED INTEGER) AS parent_id, 1.4571687291706918 AS `Estimator`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.node_id_2 AS node_id_2, `DT_node_data`.node_id AS node_id, `DT_node_data`.feature AS feature, `DT_node_data`.threshold AS threshold, `DT_node_data`.count AS count, `DT_node_data`.depth AS depth, `DT_node_data`.parent_id AS parent_id, `DT_node_data`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.node_id_2 = `DT_node_data`.node_id)
 SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`Estimator` AS `Estimator` 
FROM `DT_Output`