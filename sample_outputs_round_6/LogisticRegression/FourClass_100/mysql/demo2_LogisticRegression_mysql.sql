-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH linear_model_cte AS 
(SELECT `ADS`.`KEY` AS `KEY`, 0.0057126762877834575 * `ADS`.`Feature_0` + -0.1000528097303337 * `ADS`.`Feature_1` + -0.2490170026611109 * `ADS`.`Feature_2` + 0.37519157136781134 * `ADS`.`Feature_3` + -0.3377423681451088 * `ADS`.`Feature_4` + 0.027707526505961155 * `ADS`.`Feature_5` + 0.17258972431684877 * `ADS`.`Feature_6` + -0.09849908969904551 * `ADS`.`Feature_7` + 0.08392667701336604 * `ADS`.`Feature_8` + 0.05798452278373996 * `ADS`.`Feature_9` + 0.1391787601513979 * `ADS`.`Feature_10` + 0.18632808567979875 * `ADS`.`Feature_11` + 0.44860467874016663 * `ADS`.`Feature_12` + -0.04541569462324936 * `ADS`.`Feature_13` + -0.04561243978537483 * `ADS`.`Feature_14` + 0.21646700879688574 * `ADS`.`Feature_15` + 0.1503141755027433 * `ADS`.`Feature_16` + 0.22067363576793964 * `ADS`.`Feature_17` + 0.2930006982345385 * `ADS`.`Feature_18` + -0.12574817469843863 * `ADS`.`Feature_19` + 0.2298272357492181 * `ADS`.`Feature_20` + 0.16215381789286423 * `ADS`.`Feature_21` + 0.18511897169189168 * `ADS`.`Feature_22` + 0.02967895111957514 * `ADS`.`Feature_23` + -0.07873689652994373 * `ADS`.`Feature_24` + -0.3438514847717303 * `ADS`.`Feature_25` + -0.4578812391048069 * `ADS`.`Feature_26` + 0.4998488753643867 * `ADS`.`Feature_27` + -0.23798966157458373 * `ADS`.`Feature_28` + -0.16941858273109758 * `ADS`.`Feature_29` + 0.4505340205577563 * `ADS`.`Feature_30` + -0.00654285394261578 * `ADS`.`Feature_31` + -0.05089057145934598 * `ADS`.`Feature_32` + -0.40185772210509096 * `ADS`.`Feature_33` + -0.011623742370742315 * `ADS`.`Feature_34` + -0.05208502934174871 * `ADS`.`Feature_35` + -0.041179797359132825 * `ADS`.`Feature_36` + -0.12844152758792754 * `ADS`.`Feature_37` + 0.3161179165994286 * `ADS`.`Feature_38` + 0.15497453978461687 * `ADS`.`Feature_39` + -0.25757474879433334 * `ADS`.`Feature_40` + -0.30794489013217247 * `ADS`.`Feature_41` + 0.07128335127631634 * `ADS`.`Feature_42` + -0.029438179482966474 * `ADS`.`Feature_43` + 0.07505844047676431 * `ADS`.`Feature_44` + 0.24420353096933356 * `ADS`.`Feature_45` + -0.07739046050277366 * `ADS`.`Feature_46` + 0.25035250188217645 * `ADS`.`Feature_47` + -0.05003177689963151 * `ADS`.`Feature_48` + 0.24137661383485018 * `ADS`.`Feature_49` + -0.08592352634268308 * `ADS`.`Feature_50` + -0.10166048239904102 * `ADS`.`Feature_51` + -0.023612652502644015 * `ADS`.`Feature_52` + -0.19819736238896846 * `ADS`.`Feature_53` + 0.04010637195334326 * `ADS`.`Feature_54` + -0.04328591770412932 * `ADS`.`Feature_55` + -0.11591957201126697 * `ADS`.`Feature_56` + -0.11663587409783478 * `ADS`.`Feature_57` + -0.37030987254376546 * `ADS`.`Feature_58` + -0.1588026328269827 * `ADS`.`Feature_59` + -0.050644571436090496 * `ADS`.`Feature_60` + 0.0073459886219114446 * `ADS`.`Feature_61` + -0.08725707326591617 * `ADS`.`Feature_62` + -0.6158792172112934 * `ADS`.`Feature_63` + -0.372892036993413 * `ADS`.`Feature_64` + -0.006691511792913788 * `ADS`.`Feature_65` + -0.21409020636318715 * `ADS`.`Feature_66` + -0.2677154226314424 * `ADS`.`Feature_67` + -0.23854869387263014 * `ADS`.`Feature_68` + 0.005997000406552797 * `ADS`.`Feature_69` + 0.14246446184059466 * `ADS`.`Feature_70` + -0.19055049012002045 * `ADS`.`Feature_71` + 0.23160311450172227 * `ADS`.`Feature_72` + 0.13146573307541973 * `ADS`.`Feature_73` + 0.17826629115476872 * `ADS`.`Feature_74` + 0.2970260605699588 * `ADS`.`Feature_75` + -0.06818674588745752 * `ADS`.`Feature_76` + 0.09025301799386674 * `ADS`.`Feature_77` + -0.06791301482170414 * `ADS`.`Feature_78` + -0.0862116293016048 * `ADS`.`Feature_79` + -0.2787787422342586 * `ADS`.`Feature_80` + -0.3668620403588955 * `ADS`.`Feature_81` + -0.22683852295850432 * `ADS`.`Feature_82` + 0.053915188022661056 * `ADS`.`Feature_83` + 0.17483968759046303 * `ADS`.`Feature_84` + -0.017643586873495307 * `ADS`.`Feature_85` + -0.0006042334705857885 * `ADS`.`Feature_86` + 0.10650884482939361 * `ADS`.`Feature_87` + 0.049213308636986065 * `ADS`.`Feature_88` + 0.136794961712324 * `ADS`.`Feature_89` + -0.2514335603992379 * `ADS`.`Feature_90` + -0.13537175042038452 * `ADS`.`Feature_91` + -0.1789479406400169 * `ADS`.`Feature_92` + -0.08637048984192318 * `ADS`.`Feature_93` + -0.10013203250681584 * `ADS`.`Feature_94` + 0.013581487318661845 * `ADS`.`Feature_95` + 0.24591369169224997 * `ADS`.`Feature_96` + 0.18395274563409192 * `ADS`.`Feature_97` + -0.24001744857473414 * `ADS`.`Feature_98` + -0.2381357433208557 * `ADS`.`Feature_99` + -0.57983734422 AS `Score_0`, 0.1332122670237356 * `ADS`.`Feature_0` + 0.10789346535483382 * `ADS`.`Feature_1` + -0.14149149749320575 * `ADS`.`Feature_2` + -0.38517405378114267 * `ADS`.`Feature_3` + -0.016733668836802534 * `ADS`.`Feature_4` + 0.25257703457773595 * `ADS`.`Feature_5` + 0.3022345263447524 * `ADS`.`Feature_6` + -0.07323935885903231 * `ADS`.`Feature_7` + -0.10113651598906118 * `ADS`.`Feature_8` + 0.18578251436211118 * `ADS`.`Feature_9` + -0.1421088962975426 * `ADS`.`Feature_10` + -0.052275621553449524 * `ADS`.`Feature_11` + 0.21497310003724956 * `ADS`.`Feature_12` + -0.211056006596606 * `ADS`.`Feature_13` + 0.09370631114209226 * `ADS`.`Feature_14` + -0.07030103521056767 * `ADS`.`Feature_15` + 0.028416462125075558 * `ADS`.`Feature_16` + -0.05556930072526546 * `ADS`.`Feature_17` + -0.2708710611144338 * `ADS`.`Feature_18` + 0.06296432931823451 * `ADS`.`Feature_19` + -0.0018239943786916256 * `ADS`.`Feature_20` + 0.08177914603787773 * `ADS`.`Feature_21` + -0.0600033463000685 * `ADS`.`Feature_22` + -0.2588002577759287 * `ADS`.`Feature_23` + -0.09937709702177766 * `ADS`.`Feature_24` + -0.05558249909088294 * `ADS`.`Feature_25` + -0.025901072126510095 * `ADS`.`Feature_26` + -0.40128414282366776 * `ADS`.`Feature_27` + 0.1166933287254537 * `ADS`.`Feature_28` + 0.35374356936021567 * `ADS`.`Feature_29` + 0.15478259042520945 * `ADS`.`Feature_30` + 0.057415463833981294 * `ADS`.`Feature_31` + 0.0056023093585818185 * `ADS`.`Feature_32` + 0.36227148241644 * `ADS`.`Feature_33` + 0.12288197339455624 * `ADS`.`Feature_34` + 0.06333735152188036 * `ADS`.`Feature_35` + -0.34396374020978 * `ADS`.`Feature_36` + 0.1245980942044047 * `ADS`.`Feature_37` + -0.04814728781815872 * `ADS`.`Feature_38` + -0.048601181321591955 * `ADS`.`Feature_39` + 0.21055250497075548 * `ADS`.`Feature_40` + 0.24600159066584967 * `ADS`.`Feature_41` + 0.0698975528510931 * `ADS`.`Feature_42` + 0.2842002043365634 * `ADS`.`Feature_43` + -0.049861699222203244 * `ADS`.`Feature_44` + -0.25144818083753306 * `ADS`.`Feature_45` + 0.02247007452530638 * `ADS`.`Feature_46` + -0.1673122132061706 * `ADS`.`Feature_47` + 0.4322067388502486 * `ADS`.`Feature_48` + -0.18319193970452322 * `ADS`.`Feature_49` + -0.12182106417466412 * `ADS`.`Feature_50` + -0.030077112995388896 * `ADS`.`Feature_51` + -0.0982743133550752 * `ADS`.`Feature_52` + 0.1850558137612492 * `ADS`.`Feature_53` + 0.0230834889501074 * `ADS`.`Feature_54` + -0.20071518917394926 * `ADS`.`Feature_55` + 0.015944388869732637 * `ADS`.`Feature_56` + 0.5114630288951425 * `ADS`.`Feature_57` + 0.21980238476783223 * `ADS`.`Feature_58` + -0.08557531949086378 * `ADS`.`Feature_59` + 0.07603545101631984 * `ADS`.`Feature_60` + -0.0035914321217040057 * `ADS`.`Feature_61` + -0.04469859178974618 * `ADS`.`Feature_62` + -0.13340919979679605 * `ADS`.`Feature_63` + -0.030299199442510454 * `ADS`.`Feature_64` + -0.0324238531699671 * `ADS`.`Feature_65` + 0.016901133281757255 * `ADS`.`Feature_66` + -0.09517503088657597 * `ADS`.`Feature_67` + -0.5463243029593796 * `ADS`.`Feature_68` + -0.2827320256958992 * `ADS`.`Feature_69` + -0.18294693882823473 * `ADS`.`Feature_70` + -0.20292583008426301 * `ADS`.`Feature_71` + 0.01249770974443156 * `ADS`.`Feature_72` + 0.342908562443743 * `ADS`.`Feature_73` + 0.4409240253714936 * `ADS`.`Feature_74` + 0.06463558783243707 * `ADS`.`Feature_75` + 0.15944150800518092 * `ADS`.`Feature_76` + -0.061444102312361484 * `ADS`.`Feature_77` + 0.3361167858157069 * `ADS`.`Feature_78` + -0.10008206443132858 * `ADS`.`Feature_79` + -0.10520476699440495 * `ADS`.`Feature_80` + 0.2595808639277472 * `ADS`.`Feature_81` + -0.09082408950247046 * `ADS`.`Feature_82` + -0.08360308555626132 * `ADS`.`Feature_83` + 0.21996045251625965 * `ADS`.`Feature_84` + 0.1527219779033885 * `ADS`.`Feature_85` + 0.28380566465514967 * `ADS`.`Feature_86` + 0.13631300079539052 * `ADS`.`Feature_87` + 0.020172820457055395 * `ADS`.`Feature_88` + -0.49031719884796937 * `ADS`.`Feature_89` + 0.09735409643272826 * `ADS`.`Feature_90` + -0.0021522854216957047 * `ADS`.`Feature_91` + -0.1566771425268784 * `ADS`.`Feature_92` + -0.19119473897226555 * `ADS`.`Feature_93` + -0.22182658222179075 * `ADS`.`Feature_94` + -0.11463148588425415 * `ADS`.`Feature_95` + 0.033238362459921095 * `ADS`.`Feature_96` + 0.17490993033791233 * `ADS`.`Feature_97` + -0.14323423690780596 * `ADS`.`Feature_98` + 0.0549621466370198 * `ADS`.`Feature_99` + -0.560964330395 AS `Score_1`, 0.06151143586684723 * `ADS`.`Feature_0` + 0.05359671966459114 * `ADS`.`Feature_1` + -0.12987313907409967 * `ADS`.`Feature_2` + -0.25957252802960895 * `ADS`.`Feature_3` + 0.4421801814327886 * `ADS`.`Feature_4` + -0.4805834526659414 * `ADS`.`Feature_5` + 0.14814441298915837 * `ADS`.`Feature_6` + 0.017401776838843645 * `ADS`.`Feature_7` + -0.026527854701583524 * `ADS`.`Feature_8` + 0.06439480692013914 * `ADS`.`Feature_9` + -0.1227540929065734 * `ADS`.`Feature_10` + 0.07155588746053372 * `ADS`.`Feature_11` + -0.07454366987242092 * `ADS`.`Feature_12` + 0.03721634605485051 * `ADS`.`Feature_13` + -0.019972987846572123 * `ADS`.`Feature_14` + 0.08439300524226451 * `ADS`.`Feature_15` + 0.09552346063616299 * `ADS`.`Feature_16` + -0.200934723160116 * `ADS`.`Feature_17` + 0.278845940966118 * `ADS`.`Feature_18` + -0.01852356297718864 * `ADS`.`Feature_19` + -0.01598747729901782 * `ADS`.`Feature_20` + -0.1936164374612872 * `ADS`.`Feature_21` + 0.0992718158301382 * `ADS`.`Feature_22` + 0.2689773171716367 * `ADS`.`Feature_23` + -0.07731187042043577 * `ADS`.`Feature_24` + 0.18462751504622768 * `ADS`.`Feature_25` + 0.07042663455965986 * `ADS`.`Feature_26` + 0.06370588260058302 * `ADS`.`Feature_27` + -0.022961170591836555 * `ADS`.`Feature_28` + 0.2595104731304988 * `ADS`.`Feature_29` + -0.05317482065696838 * `ADS`.`Feature_30` + 0.27593817099061957 * `ADS`.`Feature_31` + 0.32291382953722586 * `ADS`.`Feature_32` + -0.28887858447329745 * `ADS`.`Feature_33` + 0.21985648617861872 * `ADS`.`Feature_34` + -0.08922650806311504 * `ADS`.`Feature_35` + 0.04053178244076721 * `ADS`.`Feature_36` + 0.009980983521391667 * `ADS`.`Feature_37` + -0.05719701217620125 * `ADS`.`Feature_38` + 0.22572450797984628 * `ADS`.`Feature_39` + 0.1736081410366848 * `ADS`.`Feature_40` + 0.036328976587866775 * `ADS`.`Feature_41` + 0.18989515269541962 * `ADS`.`Feature_42` + 0.2904170901132724 * `ADS`.`Feature_43` + -0.02005959192958482 * `ADS`.`Feature_44` + 0.1759096223253171 * `ADS`.`Feature_45` + -0.2749044966126168 * `ADS`.`Feature_46` + 0.19134143936255596 * `ADS`.`Feature_47` + 0.08091447798925062 * `ADS`.`Feature_48` + 0.0025837358455089643 * `ADS`.`Feature_49` + 0.10655070843452742 * `ADS`.`Feature_50` + 0.04535713183887847 * `ADS`.`Feature_51` + 0.19287349867548814 * `ADS`.`Feature_52` + -0.47345396639951265 * `ADS`.`Feature_53` + -0.02459248493207815 * `ADS`.`Feature_54` + -0.10650330870741784 * `ADS`.`Feature_55` + -0.06414920572576523 * `ADS`.`Feature_56` + 0.04990269092431397 * `ADS`.`Feature_57` + -0.02742616361559498 * `ADS`.`Feature_58` + -0.15471030242722567 * `ADS`.`Feature_59` + 0.08568152206532223 * `ADS`.`Feature_60` + 0.26509628846969047 * `ADS`.`Feature_61` + 0.17925397102092444 * `ADS`.`Feature_62` + 0.24929163618666553 * `ADS`.`Feature_63` + 0.09728672828947381 * `ADS`.`Feature_64` + 0.346998459518147 * `ADS`.`Feature_65` + -0.015072437869667873 * `ADS`.`Feature_66` + 0.026895272955893387 * `ADS`.`Feature_67` + 0.09174191068144183 * `ADS`.`Feature_68` + -0.23077710154998152 * `ADS`.`Feature_69` + -0.07091190557875929 * `ADS`.`Feature_70` + -0.003342005306558045 * `ADS`.`Feature_71` + -0.1043656183197436 * `ADS`.`Feature_72` + -0.047365480375569625 * `ADS`.`Feature_73` + 0.32339923482424227 * `ADS`.`Feature_74` + 0.005571123175853433 * `ADS`.`Feature_75` + 0.01338040235766706 * `ADS`.`Feature_76` + 0.0213747355484806 * `ADS`.`Feature_77` + -0.02268182625015923 * `ADS`.`Feature_78` + -0.023463623689891803 * `ADS`.`Feature_79` + -0.15776784647593833 * `ADS`.`Feature_80` + 0.04025430401673062 * `ADS`.`Feature_81` + 0.15308465383335373 * `ADS`.`Feature_82` + -0.015018309565836873 * `ADS`.`Feature_83` + 0.0221015413372061 * `ADS`.`Feature_84` + -0.1195687230908311 * `ADS`.`Feature_85` + 0.16517397688752183 * `ADS`.`Feature_86` + 0.018491504084311435 * `ADS`.`Feature_87` + -0.034465930883416596 * `ADS`.`Feature_88` + 0.2894763051789923 * `ADS`.`Feature_89` + 0.08844981548623401 * `ADS`.`Feature_90` + -0.050847758232365106 * `ADS`.`Feature_91` + 0.09130622033797345 * `ADS`.`Feature_92` + 0.02538528698696559 * `ADS`.`Feature_93` + -0.21382422091372336 * `ADS`.`Feature_94` + -0.19113782778247645 * `ADS`.`Feature_95` + -0.10992178858447138 * `ADS`.`Feature_96` + 0.13650428728012082 * `ADS`.`Feature_97` + 0.10567030123910719 * `ADS`.`Feature_98` + -0.19390044257468847 * `ADS`.`Feature_99` + -0.294168875941 AS `Score_2`, 0.05034609545104338 * `ADS`.`Feature_0` + -0.06494879341369966 * `ADS`.`Feature_1` + 0.021592876335861988 * `ADS`.`Feature_2` + 0.14303726132560676 * `ADS`.`Feature_3` + -0.0019179275495164619 * `ADS`.`Feature_4` + -0.09630667952798962 * `ADS`.`Feature_5` + -0.04980148966535105 * `ADS`.`Feature_6` + 0.02596750561814603 * `ADS`.`Feature_7` + -0.1606925661632343 * `ADS`.`Feature_8` + 0.04973841943535794 * `ADS`.`Feature_9` + -0.025887543913172797 * `ADS`.`Feature_10` + -0.07966269865230208 * `ADS`.`Feature_11` + 0.10088909865968801 * `ADS`.`Feature_12` + 0.16515093668892883 * `ADS`.`Feature_13` + -0.005704546142562635 * `ADS`.`Feature_14` + -0.43920897347024673 * `ADS`.`Feature_15` + 0.1007556892341673 * `ADS`.`Feature_16` + -0.22506671886305504 * `ADS`.`Feature_17` + 0.15671575822524275 * `ADS`.`Feature_18` + 0.051965375713365326 * `ADS`.`Feature_19` + -0.12311811063404357 * `ADS`.`Feature_20` + -0.1658705172056777 * `ADS`.`Feature_21` + -0.23303445074652182 * `ADS`.`Feature_22` + 0.1924330878535024 * `ADS`.`Feature_23` + -0.01322125653348448 * `ADS`.`Feature_24` + 0.015010174790807266 * `ADS`.`Feature_25` + -0.0947712106626355 * `ADS`.`Feature_26` + 0.020621891757029196 * `ADS`.`Feature_27` + 0.1673084285497771 * `ADS`.`Feature_28` + -0.23183129014304804 * `ADS`.`Feature_29` + 0.062020659998040725 * `ADS`.`Feature_30` + 0.15079911483008346 * `ADS`.`Feature_31` + -0.4399089397653091 * `ADS`.`Feature_32` + 0.14841405684214135 * `ADS`.`Feature_33` + 0.1698998959272 * `ADS`.`Feature_34` + 0.13457153213253026 * `ADS`.`Feature_35` + 0.28859358331146734 * `ADS`.`Feature_36` + -0.018522952342420674 * `ADS`.`Feature_37` + 0.075367622842073 * `ADS`.`Feature_38` + -0.14432286881700732 * `ADS`.`Feature_39` + -0.11957463692292158 * `ADS`.`Feature_40` + -0.060308793086033374 * `ADS`.`Feature_41` + 0.26836218683872465 * `ADS`.`Feature_42` + -0.11016328745264507 * `ADS`.`Feature_43` + 0.007813152394196738 * `ADS`.`Feature_44` + 0.08896224744249932 * `ADS`.`Feature_45` + 0.25059139842395173 * `ADS`.`Feature_46` + 0.04354449496858176 * `ADS`.`Feature_47` + -0.06746713666639234 * `ADS`.`Feature_48` + 0.21919019469193757 * `ADS`.`Feature_49` + 0.5945460932350441 * `ADS`.`Feature_50` + -0.1819129983936863 * `ADS`.`Feature_51` + -0.10364544789900496 * `ADS`.`Feature_52` + 0.15166718322163425 * `ADS`.`Feature_53` + 0.07671906062595277 * `ADS`.`Feature_54` + 0.23855789711417158 * `ADS`.`Feature_55` + -0.17349069160112918 * `ADS`.`Feature_56` + 0.34428321573488363 * `ADS`.`Feature_57` + 0.04142313371696996 * `ADS`.`Feature_58` + 0.030532735435743794 * `ADS`.`Feature_59` + 0.01837672702962993 * `ADS`.`Feature_60` + 0.04176445399143127 * `ADS`.`Feature_61` + -0.3297997300312729 * `ADS`.`Feature_62` + 0.14250050561574823 * `ADS`.`Feature_63` + -0.39352828853669275 * `ADS`.`Feature_64` + 0.015642209378131443 * `ADS`.`Feature_65` + -0.30474566033058675 * `ADS`.`Feature_66` + 0.0005223756242575003 * `ADS`.`Feature_67` + -0.030530236999170953 * `ADS`.`Feature_68` + -0.057638016376724485 * `ADS`.`Feature_69` + -0.15913144249497696 * `ADS`.`Feature_70` + -0.10011109617005913 * `ADS`.`Feature_71` + -0.003881279002107543 * `ADS`.`Feature_72` + -0.026531890363447715 * `ADS`.`Feature_73` + 0.020031470285314035 * `ADS`.`Feature_74` + 0.18492298837593113 * `ADS`.`Feature_75` + -0.026294593247602725 * `ADS`.`Feature_76` + -0.0854426837823208 * `ADS`.`Feature_77` + 0.14501281961791415 * `ADS`.`Feature_78` + -0.2666498155181222 * `ADS`.`Feature_79` + -0.20327763620929445 * `ADS`.`Feature_80` + -0.1734957533357042 * `ADS`.`Feature_81` + -0.3051359969582275 * `ADS`.`Feature_82` + -0.07764119479359505 * `ADS`.`Feature_83` + 0.09018457380632594 * `ADS`.`Feature_84` + -0.027649622116111928 * `ADS`.`Feature_85` + -0.08730873617929422 * `ADS`.`Feature_86` + 0.15319074138052907 * `ADS`.`Feature_87` + -0.058960383479706086 * `ADS`.`Feature_88` + 0.1740101947446781 * `ADS`.`Feature_89` + 0.12948497515201193 * `ADS`.`Feature_90` + -0.1111021728148272 * `ADS`.`Feature_91` + 0.11925954513309509 * `ADS`.`Feature_92` + -0.09944088128602177 * `ADS`.`Feature_93` + 0.0767859009847286 * `ADS`.`Feature_94` + -0.05022953188069106 * `ADS`.`Feature_95` + -0.060316949312544166 * `ADS`.`Feature_96` + 0.03150705835903403 * `ADS`.`Feature_97` + 0.018683688566813534 * `ADS`.`Feature_98` + 0.13144753027363798 * `ADS`.`Feature_99` + -0.344915331597 AS `Score_3` 
FROM `FourClass_100` AS `ADS`), 
orig_cte AS 
(SELECT linear_model_cte.`KEY` AS `KEY`, linear_model_cte.`Score_0` AS `Score_0`, linear_model_cte.`Score_1` AS `Score_1`, linear_model_cte.`Score_2` AS `Score_2`, linear_model_cte.`Score_3` AS `Score_3`, (1.0 / (1.0 + exp(-linear_model_cte.`Score_0`))) / (1.0 / (1.0 + exp(-linear_model_cte.`Score_0`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_1`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_2`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_3`))) AS `Proba_0`, (1.0 / (1.0 + exp(-linear_model_cte.`Score_1`))) / (1.0 / (1.0 + exp(-linear_model_cte.`Score_0`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_1`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_2`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_3`))) AS `Proba_1`, (1.0 / (1.0 + exp(-linear_model_cte.`Score_2`))) / (1.0 / (1.0 + exp(-linear_model_cte.`Score_0`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_1`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_2`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_3`))) AS `Proba_2`, (1.0 / (1.0 + exp(-linear_model_cte.`Score_3`))) / (1.0 / (1.0 + exp(-linear_model_cte.`Score_0`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_1`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_2`)) + 1.0 / (1.0 + exp(-linear_model_cte.`Score_3`))) AS `Proba_3`, NULL AS `LogProba_0`, NULL AS `LogProba_1`, NULL AS `LogProba_2`, NULL AS `LogProba_3`, NULL AS `Decision` 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu.`KEY` AS `KEY`, scu.class AS class, scu.`LogProba` AS `LogProba`, scu.`Proba` AS `Proba`, scu.`Score` AS `Score` 
FROM (SELECT orig_cte.`KEY` AS `KEY`, 0 AS class, orig_cte.`LogProba_0` AS `LogProba`, orig_cte.`Proba_0` AS `Proba`, orig_cte.`Score_0` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY`, 1 AS class, orig_cte.`LogProba_1` AS `LogProba`, orig_cte.`Proba_1` AS `Proba`, orig_cte.`Score_1` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY`, 2 AS class, orig_cte.`LogProba_2` AS `LogProba`, orig_cte.`Proba_2` AS `Proba`, orig_cte.`Score_2` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY`, 3 AS class, orig_cte.`LogProba_3` AS `LogProba`, orig_cte.`Proba_3` AS `Proba`, orig_cte.`Score_3` AS `Score` 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.`KEY` AS `KEY`, orig_cte.`Score_0` AS `Score_0`, orig_cte.`Score_1` AS `Score_1`, orig_cte.`Score_2` AS `Score_2`, orig_cte.`Score_3` AS `Score_3`, orig_cte.`Proba_0` AS `Proba_0`, orig_cte.`Proba_1` AS `Proba_1`, orig_cte.`Proba_2` AS `Proba_2`, orig_cte.`Proba_3` AS `Proba_3`, orig_cte.`LogProba_0` AS `LogProba_0`, orig_cte.`LogProba_1` AS `LogProba_1`, orig_cte.`LogProba_2` AS `LogProba_2`, orig_cte.`LogProba_3` AS `LogProba_3`, orig_cte.`Decision` AS `Decision`, (SELECT max(score_class_union.`LogProba`) AS max_1 
FROM score_class_union 
WHERE orig_cte.`KEY` = score_class_union.`KEY`) AS `max_LogProba`, (SELECT max(score_class_union.`Proba`) AS max_2 
FROM score_class_union 
WHERE orig_cte.`KEY` = score_class_union.`KEY`) AS `max_Proba`, (SELECT max(score_class_union.`Score`) AS max_3 
FROM score_class_union 
WHERE orig_cte.`KEY` = score_class_union.`KEY`) AS `max_Score` 
FROM orig_cte), 
arg_max_cte AS 
(SELECT score_max.`KEY` AS `KEY`, score_max.`Score_0` AS `Score_0`, score_max.`Score_1` AS `Score_1`, score_max.`Score_2` AS `Score_2`, score_max.`Score_3` AS `Score_3`, score_max.`Proba_0` AS `Proba_0`, score_max.`Proba_1` AS `Proba_1`, score_max.`Proba_2` AS `Proba_2`, score_max.`Proba_3` AS `Proba_3`, score_max.`LogProba_0` AS `LogProba_0`, score_max.`LogProba_1` AS `LogProba_1`, score_max.`LogProba_2` AS `LogProba_2`, score_max.`LogProba_3` AS `LogProba_3`, score_max.`Decision` AS `Decision`, score_max.`max_LogProba` AS `max_LogProba`, score_max.`max_Proba` AS `max_Proba`, score_max.`max_Score` AS `max_Score`, (SELECT min(score_class_union.class) AS min_1 
FROM score_class_union 
WHERE score_max.`max_LogProba` = score_class_union.`LogProba` AND score_max.`KEY` = score_class_union.`KEY`) AS `arg_max_LogProba`, (SELECT min(score_class_union.class) AS min_2 
FROM score_class_union 
WHERE score_max.`max_Proba` = score_class_union.`Proba` AND score_max.`KEY` = score_class_union.`KEY`) AS `arg_max_Proba`, (SELECT min(score_class_union.class) AS min_3 
FROM score_class_union 
WHERE score_max.`max_Score` = score_class_union.`Score` AND score_max.`KEY` = score_class_union.`KEY`) AS `arg_max_Score` 
FROM score_max)
 SELECT arg_max_cte.`KEY` AS `KEY`, arg_max_cte.`Score_0` AS `Score_0`, arg_max_cte.`Score_1` AS `Score_1`, arg_max_cte.`Score_2` AS `Score_2`, arg_max_cte.`Score_3` AS `Score_3`, arg_max_cte.`Proba_0` AS `Proba_0`, arg_max_cte.`Proba_1` AS `Proba_1`, arg_max_cte.`Proba_2` AS `Proba_2`, arg_max_cte.`Proba_3` AS `Proba_3`, CASE WHEN (arg_max_cte.`Proba_0` IS NULL OR arg_max_cte.`Proba_0` > 0.0) THEN ln(arg_max_cte.`Proba_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (arg_max_cte.`Proba_1` IS NULL OR arg_max_cte.`Proba_1` > 0.0) THEN ln(arg_max_cte.`Proba_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (arg_max_cte.`Proba_2` IS NULL OR arg_max_cte.`Proba_2` > 0.0) THEN ln(arg_max_cte.`Proba_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, CASE WHEN (arg_max_cte.`Proba_3` IS NULL OR arg_max_cte.`Proba_3` > 0.0) THEN ln(arg_max_cte.`Proba_3`) ELSE -1.79769313486231e+308 END AS `LogProba_3`, arg_max_cte.`arg_max_Score` AS `Decision` 
FROM arg_max_cte