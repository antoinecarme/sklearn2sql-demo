-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH [ADS_imp_1_OUT] AS 
(SELECT [ADS].[KEY] AS [KEY], CASE WHEN ([ADS].[Feature_0] IS NULL) THEN 14.0831968504 ELSE [ADS].[Feature_0] END AS impter_2, CASE WHEN ([ADS].[Feature_1] IS NULL) THEN 19.0191076115 ELSE [ADS].[Feature_1] END AS impter_3, CASE WHEN ([ADS].[Feature_2] IS NULL) THEN 91.7118897638 ELSE [ADS].[Feature_2] END AS impter_4, CASE WHEN ([ADS].[Feature_3] IS NULL) THEN 652.424671916 ELSE [ADS].[Feature_3] END AS impter_5, CASE WHEN ([ADS].[Feature_4] IS NULL) THEN 0.0968055380577 ELSE [ADS].[Feature_4] END AS impter_6, CASE WHEN ([ADS].[Feature_5] IS NULL) THEN 0.104805485564 ELSE [ADS].[Feature_5] END AS impter_7, CASE WHEN ([ADS].[Feature_6] IS NULL) THEN 0.0876977427822 ELSE [ADS].[Feature_6] END AS impter_8, CASE WHEN ([ADS].[Feature_7] IS NULL) THEN 0.0489006430446 ELSE [ADS].[Feature_7] END AS impter_9, CASE WHEN ([ADS].[Feature_8] IS NULL) THEN 0.18112335958 ELSE [ADS].[Feature_8] END AS impter_10, CASE WHEN ([ADS].[Feature_9] IS NULL) THEN 0.0630376115486 ELSE [ADS].[Feature_9] END AS impter_11, CASE WHEN ([ADS].[Feature_10] IS NULL) THEN 0.410748293963 ELSE [ADS].[Feature_10] END AS impter_12, CASE WHEN ([ADS].[Feature_11] IS NULL) THEN 1.21939501312 ELSE [ADS].[Feature_11] END AS impter_13, CASE WHEN ([ADS].[Feature_12] IS NULL) THEN 2.90654488189 ELSE [ADS].[Feature_12] END AS impter_14, CASE WHEN ([ADS].[Feature_13] IS NULL) THEN 41.1231023622 ELSE [ADS].[Feature_13] END AS impter_15, CASE WHEN ([ADS].[Feature_14] IS NULL) THEN 0.00706835170604 ELSE [ADS].[Feature_14] END AS impter_16, CASE WHEN ([ADS].[Feature_15] IS NULL) THEN 0.025598015748 ELSE [ADS].[Feature_15] END AS impter_17, CASE WHEN ([ADS].[Feature_16] IS NULL) THEN 0.0315339183727 ELSE [ADS].[Feature_16] END AS impter_18, CASE WHEN ([ADS].[Feature_17] IS NULL) THEN 0.0119848766404 ELSE [ADS].[Feature_17] END AS impter_19, CASE WHEN ([ADS].[Feature_18] IS NULL) THEN 0.0207874829396 ELSE [ADS].[Feature_18] END AS impter_20, CASE WHEN ([ADS].[Feature_19] IS NULL) THEN 0.00389341286089 ELSE [ADS].[Feature_19] END AS impter_21, CASE WHEN ([ADS].[Feature_20] IS NULL) THEN 16.1808923885 ELSE [ADS].[Feature_20] END AS impter_22, CASE WHEN ([ADS].[Feature_21] IS NULL) THEN 25.2414435696 ELSE [ADS].[Feature_21] END AS impter_23, CASE WHEN ([ADS].[Feature_22] IS NULL) THEN 106.690393701 ELSE [ADS].[Feature_22] END AS impter_24, CASE WHEN ([ADS].[Feature_23] IS NULL) THEN 872.238582677 ELSE [ADS].[Feature_23] END AS impter_25, CASE WHEN ([ADS].[Feature_24] IS NULL) THEN 0.132393937008 ELSE [ADS].[Feature_24] END AS impter_26, CASE WHEN ([ADS].[Feature_25] IS NULL) THEN 0.251353989501 ELSE [ADS].[Feature_25] END AS impter_27, CASE WHEN ([ADS].[Feature_26] IS NULL) THEN 0.263815637795 ELSE [ADS].[Feature_26] END AS impter_28, CASE WHEN ([ADS].[Feature_27] IS NULL) THEN 0.114107792651 ELSE [ADS].[Feature_27] END AS impter_29, CASE WHEN ([ADS].[Feature_28] IS NULL) THEN 0.288911286089 ELSE [ADS].[Feature_28] END AS impter_30, CASE WHEN ([ADS].[Feature_29] IS NULL) THEN 0.0838917060367 ELSE [ADS].[Feature_29] END AS impter_31 
FROM [BreastCancer] AS [ADS]), 
[ADS_sca_2_OUT] AS 
(SELECT [ADS_imp_1_OUT].[KEY] AS [KEY], (CAST([ADS_imp_1_OUT].impter_2 AS FLOAT) - 14.0831968504) / 3.58372360357 AS scaler_2, (CAST([ADS_imp_1_OUT].impter_3 AS FLOAT) - 19.0191076115) / 4.16872919973 AS scaler_3, (CAST([ADS_imp_1_OUT].impter_4 AS FLOAT) - 91.7118897638) / 24.7405030131 AS scaler_4, (CAST([ADS_imp_1_OUT].impter_5 AS FLOAT) - 652.424671916) / 361.406340946 AS scaler_5, (CAST([ADS_imp_1_OUT].impter_6 AS FLOAT) - 0.0968055380577) / 0.0142750282315 AS scaler_6, (CAST([ADS_imp_1_OUT].impter_7 AS FLOAT) - 0.104805485564) / 0.052564640227 AS scaler_7, (CAST([ADS_imp_1_OUT].impter_8 AS FLOAT) - 0.0876977427822) / 0.0789716395799 AS scaler_8, (CAST([ADS_imp_1_OUT].impter_9 AS FLOAT) - 0.0489006430446) / 0.0390994514233 AS scaler_9, (CAST([ADS_imp_1_OUT].impter_10 AS FLOAT) - 0.18112335958) / 0.0277256176537 AS scaler_10, (CAST([ADS_imp_1_OUT].impter_11 AS FLOAT) - 0.0630376115486) / 0.00705628740437 AS scaler_11, (CAST([ADS_imp_1_OUT].impter_12 AS FLOAT) - 0.410748293963) / 0.299028974585 AS scaler_12, (CAST([ADS_imp_1_OUT].impter_13 AS FLOAT) - 1.21939501312) / 0.554118745057 AS scaler_13, (CAST([ADS_imp_1_OUT].impter_14 AS FLOAT) - 2.90654488189) / 2.19671897682 AS scaler_14, (CAST([ADS_imp_1_OUT].impter_15 AS FLOAT) - 41.1231023622) / 50.0238619245 AS scaler_15, (CAST([ADS_imp_1_OUT].impter_16 AS FLOAT) - 0.00706835170604) / 0.00286192611154 AS scaler_16, (CAST([ADS_imp_1_OUT].impter_17 AS FLOAT) - 0.025598015748) / 0.0177969043718 AS scaler_17, (CAST([ADS_imp_1_OUT].impter_18 AS FLOAT) - 0.0315339183727) / 0.0294145736829 AS scaler_18, (CAST([ADS_imp_1_OUT].impter_19 AS FLOAT) - 0.0119848766404) / 0.00634557179163 AS scaler_19, (CAST([ADS_imp_1_OUT].impter_20 AS FLOAT) - 0.0207874829396) / 0.00846130427006 AS scaler_20, (CAST([ADS_imp_1_OUT].impter_21 AS FLOAT) - 0.00389341286089) / 0.00282534669377 AS scaler_21, (CAST([ADS_imp_1_OUT].impter_22 AS FLOAT) - 16.1808923885) / 4.8559275363 AS scaler_22, (CAST([ADS_imp_1_OUT].impter_23 AS FLOAT) - 25.2414435696) / 6.00010024108 AS scaler_23, (CAST([ADS_imp_1_OUT].impter_24 AS FLOAT) - 106.690393701) / 33.9442803133 AS scaler_24, (CAST([ADS_imp_1_OUT].impter_25 AS FLOAT) - 872.238582677) / 572.065477877 AS scaler_25, (CAST([ADS_imp_1_OUT].impter_26 AS FLOAT) - 0.132393937008) / 0.0230922755997 AS scaler_26, (CAST([ADS_imp_1_OUT].impter_27 AS FLOAT) - 0.251353989501) / 0.15283768085 AS scaler_27, (CAST([ADS_imp_1_OUT].impter_28 AS FLOAT) - 0.263815637795) / 0.197727633616 AS scaler_28, (CAST([ADS_imp_1_OUT].impter_29 AS FLOAT) - 0.114107792651) / 0.0658849454932 AS scaler_29, (CAST([ADS_imp_1_OUT].impter_30 AS FLOAT) - 0.288911286089) / 0.060405414696 AS scaler_30, (CAST([ADS_imp_1_OUT].impter_31 AS FLOAT) - 0.0838917060367) / 0.0170341598582 AS scaler_31 
FROM [ADS_imp_1_OUT]), 
[DT_node_lookup] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_24 <= 0.29782944917678833) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_28 <= 0.5344946384429932) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_8 <= 0.06897738575935364) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_12 <= 0.7183307409286499) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_29 <= 0.31558358669281006) THEN 5 ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_15 <= -0.243545800447464) THEN 7 ELSE 8 END END ELSE 9 END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_22 <= -0.004302450455725193) THEN 11 ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_23 <= -0.8393932580947876) THEN 13 ELSE 14 END END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_6 <= -0.046622537076473236) THEN 16 ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_27 <= 0.6254740953445435) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_10 <= 0.2227773815393448) THEN 19 ELSE 20 END ELSE 21 END END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_28 <= -0.3697795867919922) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_5 <= 0.5162481069564819) THEN 24 ELSE 25 END ELSE 26 END END AS node_id_2 
FROM [ADS_sca_2_OUT]), 
[DT_node_data] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].parent_id AS parent_id, [Values].[Proba_0.0] AS [Proba_0.0], [Values].[LogProba_0.0] AS [LogProba_0.0], [Values].[Proba_1.0] AS [Proba_1.0], [Values].[LogProba_1.0] AS [LogProba_1.0], [Values].[Decision] AS [Decision] 
FROM (SELECT 0 AS node_id, 'scaler_24' AS feature, 0.29782944917678833 AS threshold, 254 AS count, 0 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.3359580052493438 AS [Proba_0.0], -1.09076911121 AS [LogProba_0.0], 0.6640419947506562 AS [Proba_1.0], -0.409409886399 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 1 AS node_id, 'scaler_28' AS feature, 0.5344946384429932 AS threshold, 180 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.08058608058608059 AS [Proba_0.0], -2.51842934183 AS [LogProba_0.0], 0.9194139194139194 AS [Proba_1.0], -0.0840188560532 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 2 AS node_id, 'scaler_8' AS feature, 0.06897738575935364 AS threshold, 166 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.031746031746031744 AS [Proba_0.0], -3.44998754583 AS [LogProba_0.0], 0.9682539682539683 AS [Proba_1.0], -0.0322608622182 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 3 AS node_id, 'scaler_12' AS feature, 0.7183307409286499 AS threshold, 151 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.012987012987012988 AS [Proba_0.0], -4.34380542185 AS [LogProba_0.0], 0.987012987012987 AS [Proba_1.0], -0.0130720815674 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 4 AS node_id, 'scaler_29' AS feature, 0.31558358669281006 AS threshold, 150 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.004366812227074236 AS [Proba_0.0], -5.43372200355 AS [LogProba_0.0], 0.9956331877729258 AS [Proba_1.0], -0.0043763745998 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 147 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 6 AS node_id, 'scaler_15' AS feature, -0.243545800447464 AS threshold, 3 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.3333333333333333 AS [Proba_0.0], -1.09861228867 AS [LogProba_0.0], 0.6666666666666666 AS [Proba_1.0], -0.405465108108 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 6 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 6 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 10 AS node_id, 'scaler_22' AS feature, -0.004302450455725193 AS threshold, 15 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.23809523809523808 AS [Proba_0.0], -1.43508452529 AS [LogProba_0.0], 0.7619047619047619 AS [Proba_1.0], -0.271933715484 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 10 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 12 AS node_id, 'scaler_23' AS feature, -0.8393932580947876 AS threshold, 5 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.8333333333333334 AS [Proba_0.0], -0.182321556794 AS [LogProba_0.0], 0.16666666666666666 AS [Proba_1.0], -1.79175946923 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 4 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 15 AS node_id, 'scaler_6' AS feature, -0.046622537076473236 AS threshold, 14 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.6666666666666666 AS [Proba_0.0], -0.405465108108 AS [LogProba_0.0], 0.3333333333333333 AS [Proba_1.0], -1.09861228867 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 17 AS node_id, 'scaler_27' AS feature, 0.6254740953445435 AS threshold, 11 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.875 AS [Proba_0.0], -0.133531392625 AS [LogProba_0.0], 0.125 AS [Proba_1.0], -2.07944154168 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 18 AS node_id, 'scaler_10' AS feature, 0.2227773815393448 AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.3333333333333333 AS [Proba_0.0], -1.09861228867 AS [LogProba_0.0], 0.6666666666666666 AS [Proba_1.0], -0.405465108108 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 8 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 22 AS node_id, 'scaler_28' AS feature, -0.3697795867919922 AS threshold, 74 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.9814814814814815 AS [Proba_0.0], -0.0186921330122 AS [LogProba_0.0], 0.018518518518518517 AS [Proba_1.0], -3.98898404656 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 23 AS node_id, 'scaler_5' AS feature, 0.5162481069564819 AS threshold, 2 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.3333333333333333 AS [Proba_0.0], -1.09861228867 AS [LogProba_0.0], 0.6666666666666666 AS [Proba_1.0], -0.405465108108 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 72 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision]) AS [Values]), 
[DT_Output] AS 
(SELECT [DT_node_lookup].[KEY] AS [KEY], [DT_node_lookup].node_id_2 AS node_id_2, [DT_node_data].node_id AS node_id, [DT_node_data].feature AS feature, [DT_node_data].threshold AS threshold, [DT_node_data].count AS count, [DT_node_data].depth AS depth, [DT_node_data].parent_id AS parent_id, [DT_node_data].[Proba_0.0] AS [Proba_0.0], [DT_node_data].[LogProba_0.0] AS [LogProba_0.0], [DT_node_data].[Proba_1.0] AS [Proba_1.0], [DT_node_data].[LogProba_1.0] AS [LogProba_1.0], [DT_node_data].[Decision] AS [Decision] 
FROM [DT_node_lookup] LEFT OUTER JOIN [DT_node_data] ON [DT_node_lookup].node_id_2 = [DT_node_data].node_id), 
[RF_Tree_0] AS 
(SELECT [DT_Output].[KEY] AS join_key_0, CAST(NULL AS FLOAT) AS [Score_0_0], [DT_Output].[Proba_0.0] AS [Proba_0_0], [DT_Output].[LogProba_0.0] AS [LogProba_0_0], CAST(NULL AS FLOAT) AS [Score_0_1], [DT_Output].[Proba_1.0] AS [Proba_0_1], [DT_Output].[LogProba_1.0] AS [LogProba_0_1] 
FROM [DT_Output]), 
[DT_node_lookup_1] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_24 <= 0.272788405418396) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_27 <= 0.7491347193717957) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_31 <= -0.8554402589797974) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_19 <= 0.22458548843860626) THEN 4 ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_23 <= -0.6752293109893799) THEN 6 ELSE 7 END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_15 <= -0.11820563673973083) THEN 9 ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_26 <= 0.5415691137313843) THEN 11 ELSE 12 END END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_22 <= -0.2987878918647766) THEN 14 ELSE 15 END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_27 <= -0.4730769991874695) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_18 <= -0.10297339409589767) THEN 18 ELSE 19 END ELSE 20 END END AS node_id_2 
FROM [ADS_sca_2_OUT]), 
[DT_node_data_1] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].parent_id AS parent_id, [Values].[Proba_0.0] AS [Proba_0.0], [Values].[LogProba_0.0] AS [LogProba_0.0], [Values].[Proba_1.0] AS [Proba_1.0], [Values].[LogProba_1.0] AS [LogProba_1.0], [Values].[Decision] AS [Decision] 
FROM (SELECT 0 AS node_id, 'scaler_24' AS feature, 0.272788405418396 AS threshold, 235 AS count, 0 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.36220472440944884 AS [Proba_0.0], -1.01554568997 AS [LogProba_0.0], 0.6377952755905512 AS [Proba_1.0], -0.449737931786 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 1 AS node_id, 'scaler_27' AS feature, 0.7491347193717957 AS threshold, 169 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.08015267175572519 AS [Proba_0.0], -2.52382206604 AS [LogProba_0.0], 0.9198473282442748 AS [Proba_1.0], -0.0835475702704 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 2 AS node_id, 'scaler_31' AS feature, -0.8554402589797974 AS threshold, 158 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.032520325203252036 AS [Proba_0.0], -3.42588999425 AS [LogProba_0.0], 0.967479674796748 AS [Proba_1.0], -0.0330608622609 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 3 AS node_id, 'scaler_19' AS feature, 0.22458548843860626 AS threshold, 33 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.11538461538461539 AS [Proba_0.0], -2.15948424935 AS [LogProba_0.0], 0.8846153846153846 AS [Proba_1.0], -0.122602322092 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 4 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 30 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 5 AS node_id, 'scaler_23' AS feature, -0.6752293109893799 AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.75 AS [Proba_0.0], -0.287682072452 AS [LogProba_0.0], 0.25 AS [Proba_1.0], -1.38629436112 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 8 AS node_id, 'scaler_15' AS feature, -0.11820563673973083 AS threshold, 125 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.010309278350515464 AS [Proba_0.0], -4.5747109785 AS [LogProba_0.0], 0.9896907216494846 AS [Proba_1.0], -0.0103627870355 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 117 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 10 AS node_id, 'scaler_26' AS feature, 0.5415691137313843 AS threshold, 8 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.2 AS [Proba_0.0], -1.60943791243 AS [LogProba_0.0], 0.8 AS [Proba_1.0], -0.223143551314 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 6 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 12 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 13 AS node_id, 'scaler_22' AS feature, -0.2987878918647766 AS threshold, 11 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.8125 AS [Proba_0.0], -0.207639364778 AS [LogProba_0.0], 0.1875 AS [Proba_1.0], -1.67397643357 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 8 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 16 AS node_id, 'scaler_27' AS feature, -0.4730769991874695 AS threshold, 66 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.9831932773109243 AS [Proba_0.0], -0.0169495583138 AS [LogProba_0.0], 0.01680672268907563 AS [Proba_1.0], -4.08597631255 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 17 AS node_id, 'scaler_18' AS feature, -0.10297339409589767 AS threshold, 3 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.6 AS [Proba_0.0], -0.510825623766 AS [LogProba_0.0], 0.4 AS [Proba_1.0], -0.916290731874 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 18 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 63 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision]) AS [Values]), 
[DT_Output_1] AS 
(SELECT [DT_node_lookup_1].[KEY] AS [KEY], [DT_node_lookup_1].node_id_2 AS node_id_2, [DT_node_data_1].node_id AS node_id, [DT_node_data_1].feature AS feature, [DT_node_data_1].threshold AS threshold, [DT_node_data_1].count AS count, [DT_node_data_1].depth AS depth, [DT_node_data_1].parent_id AS parent_id, [DT_node_data_1].[Proba_0.0] AS [Proba_0.0], [DT_node_data_1].[LogProba_0.0] AS [LogProba_0.0], [DT_node_data_1].[Proba_1.0] AS [Proba_1.0], [DT_node_data_1].[LogProba_1.0] AS [LogProba_1.0], [DT_node_data_1].[Decision] AS [Decision] 
FROM [DT_node_lookup_1] LEFT OUTER JOIN [DT_node_data_1] ON [DT_node_lookup_1].node_id_2 = [DT_node_data_1].node_id), 
[RF_Tree_1] AS 
(SELECT [DT_Output_1].[KEY] AS join_key_1, CAST(NULL AS FLOAT) AS [Score_1_0], [DT_Output_1].[Proba_0.0] AS [Proba_1_0], [DT_Output_1].[LogProba_0.0] AS [LogProba_1_0], CAST(NULL AS FLOAT) AS [Score_1_1], [DT_Output_1].[Proba_1.0] AS [Proba_1_1], [DT_Output_1].[LogProba_1.0] AS [LogProba_1_1] 
FROM [DT_Output_1]), 
[DT_node_lookup_2] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_24 <= 0.272788405418396) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_28 <= 0.2768169641494751) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_25 <= -0.07252418249845505) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_15 <= -0.16228459775447845) THEN 4 ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_29 <= 0.07425379008054733) THEN 6 ELSE 7 END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_7 <= -0.16009783744812012) THEN 9 ELSE 10 END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_11 <= -0.23420411348342896) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_24 <= -0.06452909857034683) THEN 13 ELSE 14 END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_30 <= 1.2505288124084473) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_4 <= -0.23632866144180298) THEN 17 ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_26 <= 0.25575923919677734) THEN 19 ELSE 20 END END ELSE 21 END END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_16 <= -1.187085747718811) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_11 <= -1.4274661540985107) THEN 24 ELSE 25 END ELSE 26 END END AS node_id_2 
FROM [ADS_sca_2_OUT]), 
[DT_node_data_2] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].parent_id AS parent_id, [Values].[Proba_0.0] AS [Proba_0.0], [Values].[LogProba_0.0] AS [LogProba_0.0], [Values].[Proba_1.0] AS [Proba_1.0], [Values].[LogProba_1.0] AS [LogProba_1.0], [Values].[Decision] AS [Decision] 
FROM (SELECT 0 AS node_id, 'scaler_24' AS feature, 0.272788405418396 AS threshold, 235 AS count, 0 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.3228346456692913 AS [Proba_0.0], -1.13061501975 AS [LogProba_0.0], 0.6771653543307087 AS [Proba_1.0], -0.389839790205 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 1 AS node_id, 'scaler_28' AS feature, 0.2768169641494751 AS threshold, 173 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.07220216606498195 AS [Proba_0.0], -2.62828523263 AS [LogProba_0.0], 0.927797833935018 AS [Proba_1.0], -0.0749414212921 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 2 AS node_id, 'scaler_25' AS feature, -0.07252418249845505 AS threshold, 149 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.012658227848101266 AS [Proba_0.0], -4.36944785247 AS [LogProba_0.0], 0.9873417721518988 AS [Proba_1.0], -0.0127390257774 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 3 AS node_id, 'scaler_15' AS feature, -0.16228459775447845 AS threshold, 140 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0044444444444444444 AS [Proba_0.0], -5.4161004022 AS [LogProba_0.0], 0.9955555555555555 AS [Proba_1.0], -0.00445435034938 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 4 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 127 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 5 AS node_id, 'scaler_29' AS feature, 0.07425379008054733 AS threshold, 13 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0625 AS [Proba_0.0], -2.77258872224 AS [LogProba_0.0], 0.9375 AS [Proba_1.0], -0.0645385211376 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 12 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 7 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 8 AS node_id, 'scaler_7' AS feature, -0.16009783744812012 AS threshold, 9 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.16666666666666666 AS [Proba_0.0], -1.79175946923 AS [LogProba_0.0], 0.8333333333333334 AS [Proba_1.0], -0.182321556794 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 7 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 10 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 11 AS node_id, 'scaler_11' AS feature, -0.23420411348342896 AS threshold, 24 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.425 AS [Proba_0.0], -0.855666110058 AS [LogProba_0.0], 0.575 AS [Proba_1.0], -0.553385238185 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 12 AS node_id, 'scaler_24' AS feature, -0.06452909857034683 AS threshold, 4 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.8888888888888888 AS [Proba_0.0], -0.117783035656 AS [LogProba_0.0], 0.1111111111111111 AS [Proba_1.0], -2.19722457734 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 14 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 15 AS node_id, 'scaler_30' AS feature, 1.2505288124084473 AS threshold, 20 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.2903225806451613 AS [Proba_0.0], -1.23676262715 AS [LogProba_0.0], 0.7096774193548387 AS [Proba_1.0], -0.342944751127 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 16 AS node_id, 'scaler_4' AS feature, -0.23632866144180298 AS threshold, 17 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.15384615384615385 AS [Proba_0.0], -1.8718021769 AS [LogProba_0.0], 0.8461538461538461 AS [Proba_1.0], -0.167054084663 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 17 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 9 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 18 AS node_id, 'scaler_26' AS feature, 0.25575923919677734 AS threshold, 8 AS count, 5 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.36363636363636365 AS [Proba_0.0], -1.01160091168 AS [LogProba_0.0], 0.6363636363636364 AS [Proba_1.0], -0.451985123743 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 19 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 5 AS count, 6 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 20 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 6 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 21 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 3 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 22 AS node_id, 'scaler_16' AS feature, -1.187085747718811 AS threshold, 62 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.9903846153846154 AS [Proba_0.0], -0.00966191091174 AS [LogProba_0.0], 0.009615384615384616 AS [Proba_1.0], -4.64439089914 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 23 AS node_id, 'scaler_11' AS feature, -1.4274661540985107 AS threshold, 3 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.6666666666666666 AS [Proba_0.0], -0.405465108108 AS [LogProba_0.0], 0.3333333333333333 AS [Proba_1.0], -1.09861228867 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 24 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 25 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 26 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 59 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision]) AS [Values]), 
[DT_Output_2] AS 
(SELECT [DT_node_lookup_2].[KEY] AS [KEY], [DT_node_lookup_2].node_id_2 AS node_id_2, [DT_node_data_2].node_id AS node_id, [DT_node_data_2].feature AS feature, [DT_node_data_2].threshold AS threshold, [DT_node_data_2].count AS count, [DT_node_data_2].depth AS depth, [DT_node_data_2].parent_id AS parent_id, [DT_node_data_2].[Proba_0.0] AS [Proba_0.0], [DT_node_data_2].[LogProba_0.0] AS [LogProba_0.0], [DT_node_data_2].[Proba_1.0] AS [Proba_1.0], [DT_node_data_2].[LogProba_1.0] AS [LogProba_1.0], [DT_node_data_2].[Decision] AS [Decision] 
FROM [DT_node_lookup_2] LEFT OUTER JOIN [DT_node_data_2] ON [DT_node_lookup_2].node_id_2 = [DT_node_data_2].node_id), 
[RF_Tree_2] AS 
(SELECT [DT_Output_2].[KEY] AS join_key_2, CAST(NULL AS FLOAT) AS [Score_2_0], [DT_Output_2].[Proba_0.0] AS [Proba_2_0], [DT_Output_2].[LogProba_0.0] AS [LogProba_2_0], CAST(NULL AS FLOAT) AS [Score_2_1], [DT_Output_2].[Proba_1.0] AS [Proba_2_1], [DT_Output_2].[LogProba_1.0] AS [LogProba_2_1] 
FROM [DT_Output_2]), 
[DT_node_lookup_3] AS 
(SELECT [ADS_sca_2_OUT].[KEY] AS [KEY], CASE WHEN ([ADS_sca_2_OUT].scaler_5 <= 0.1656731516122818) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_29 <= 0.5303518772125244) THEN CASE WHEN ([ADS_sca_2_OUT].scaler_29 <= 0.12434111535549164) THEN 3 ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_13 <= 0.4694029688835144) THEN 5 ELSE 6 END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_8 <= 3.2208049297332764) THEN 8 ELSE 9 END END ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_13 <= -1.346724033355713) THEN 11 ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_29 <= -0.4414937496185303) THEN 13 ELSE CASE WHEN ([ADS_sca_2_OUT].scaler_15 <= -0.3821796774864197) THEN 15 ELSE 16 END END END END AS node_id_2 
FROM [ADS_sca_2_OUT]), 
[DT_node_data_3] AS 
(SELECT [Values].node_id AS node_id, [Values].feature AS feature, [Values].threshold AS threshold, [Values].count AS count, [Values].depth AS depth, [Values].parent_id AS parent_id, [Values].[Proba_0.0] AS [Proba_0.0], [Values].[LogProba_0.0] AS [LogProba_0.0], [Values].[Proba_1.0] AS [Proba_1.0], [Values].[LogProba_1.0] AS [LogProba_1.0], [Values].[Decision] AS [Decision] 
FROM (SELECT 0 AS node_id, 'scaler_5' AS feature, 0.1656731516122818 AS threshold, 239 AS count, 0 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.3779527559055118 AS [Proba_0.0], -0.972986075551 AS [LogProba_0.0], 0.6220472440944882 AS [Proba_1.0], -0.474739233992 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 1 AS node_id, 'scaler_29' AS feature, 0.5303518772125244 AS threshold, 167 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.11406844106463879 AS [Proba_0.0], -2.17095665052 AS [LogProba_0.0], 0.8859315589353612 AS [Proba_1.0], -0.121115578612 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 2 AS node_id, 'scaler_29' AS feature, 0.12434111535549164 AS threshold, 147 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.01276595744680851 AS [Proba_0.0], -4.36097322548 AS [LogProba_0.0], 0.9872340425531915 AS [Proba_1.0], -0.0128481424778 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 3 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 136 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 4 AS node_id, 'scaler_13' AS feature, 0.4694029688835144 AS threshold, 11 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.17647058823529413 AS [Proba_0.0], -1.73460105539 AS [LogProba_0.0], 0.8235294117647058 AS [Proba_1.0], -0.194156014441 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 5 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 9 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 6 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 7 AS node_id, 'scaler_8' AS feature, 3.2208049297332764 AS threshold, 20 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.9642857142857143 AS [Proba_0.0], -0.0363676441709 AS [LogProba_0.0], 0.03571428571428571 AS [Proba_1.0], -3.33220451018 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 8 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 19 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 9 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 10 AS node_id, 'scaler_13' AS feature, -1.346724033355713 AS threshold, 72 AS count, 1 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.9661016949152542 AS [Proba_0.0], -0.0344861760712 AS [LogProba_0.0], 0.03389830508474576 AS [Proba_1.0], -3.38439026335 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 11 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 2 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 12 AS node_id, 'scaler_29' AS feature, -0.4414937496185303 AS threshold, 70 AS count, 2 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.9827586206896551 AS [Proba_0.0], -0.0173917427119 AS [LogProba_0.0], 0.017241379310344827 AS [Proba_1.0], -4.06044301055 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 13 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 14 AS node_id, 'scaler_15' AS feature, -0.3821796774864197 AS threshold, 69 AS count, 3 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.991304347826087 AS [Proba_0.0], -0.00873367996875 AS [LogProba_0.0], 0.008695652173913044 AS [Proba_1.0], -4.74493212836 AS [LogProba_1.0], 0 AS [Decision] UNION ALL SELECT 15 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 1 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 0.0 AS [Proba_0.0], -1.79769313486231e+308 AS [LogProba_0.0], 1.0 AS [Proba_1.0], 0.0 AS [LogProba_1.0], 1 AS [Decision] UNION ALL SELECT 16 AS node_id, CAST(NULL AS VARCHAR(256)) AS feature, CAST(NULL AS FLOAT) AS threshold, 68 AS count, 4 AS depth, CAST(NULL AS INTEGER) AS parent_id, 1.0 AS [Proba_0.0], 0.0 AS [LogProba_0.0], 0.0 AS [Proba_1.0], -1.79769313486231e+308 AS [LogProba_1.0], 0 AS [Decision]) AS [Values]), 
[DT_Output_3] AS 
(SELECT [DT_node_lookup_3].[KEY] AS [KEY], [DT_node_lookup_3].node_id_2 AS node_id_2, [DT_node_data_3].node_id AS node_id, [DT_node_data_3].feature AS feature, [DT_node_data_3].threshold AS threshold, [DT_node_data_3].count AS count, [DT_node_data_3].depth AS depth, [DT_node_data_3].parent_id AS parent_id, [DT_node_data_3].[Proba_0.0] AS [Proba_0.0], [DT_node_data_3].[LogProba_0.0] AS [LogProba_0.0], [DT_node_data_3].[Proba_1.0] AS [Proba_1.0], [DT_node_data_3].[LogProba_1.0] AS [LogProba_1.0], [DT_node_data_3].[Decision] AS [Decision] 
FROM [DT_node_lookup_3] LEFT OUTER JOIN [DT_node_data_3] ON [DT_node_lookup_3].node_id_2 = [DT_node_data_3].node_id), 
[RF_Tree_3] AS 
(SELECT [DT_Output_3].[KEY] AS join_key_3, CAST(NULL AS FLOAT) AS [Score_3_0], [DT_Output_3].[Proba_0.0] AS [Proba_3_0], [DT_Output_3].[LogProba_0.0] AS [LogProba_3_0], CAST(NULL AS FLOAT) AS [Score_3_1], [DT_Output_3].[Proba_1.0] AS [Proba_3_1], [DT_Output_3].[LogProba_1.0] AS [LogProba_3_1] 
FROM [DT_Output_3]), 
[RF_Join_CTE] AS 
(SELECT [RF_Tree_0].join_key_0 AS join_key_0, [RF_Tree_0].[Score_0_0] AS [Score_0_0], [RF_Tree_0].[Proba_0_0] AS [Proba_0_0], [RF_Tree_0].[LogProba_0_0] AS [LogProba_0_0], [RF_Tree_0].[Score_0_1] AS [Score_0_1], [RF_Tree_0].[Proba_0_1] AS [Proba_0_1], [RF_Tree_0].[LogProba_0_1] AS [LogProba_0_1], [RF_Tree_1].join_key_1 AS join_key_1, [RF_Tree_1].[Score_1_0] AS [Score_1_0], [RF_Tree_1].[Proba_1_0] AS [Proba_1_0], [RF_Tree_1].[LogProba_1_0] AS [LogProba_1_0], [RF_Tree_1].[Score_1_1] AS [Score_1_1], [RF_Tree_1].[Proba_1_1] AS [Proba_1_1], [RF_Tree_1].[LogProba_1_1] AS [LogProba_1_1], [RF_Tree_2].join_key_2 AS join_key_2, [RF_Tree_2].[Score_2_0] AS [Score_2_0], [RF_Tree_2].[Proba_2_0] AS [Proba_2_0], [RF_Tree_2].[LogProba_2_0] AS [LogProba_2_0], [RF_Tree_2].[Score_2_1] AS [Score_2_1], [RF_Tree_2].[Proba_2_1] AS [Proba_2_1], [RF_Tree_2].[LogProba_2_1] AS [LogProba_2_1], [RF_Tree_3].join_key_3 AS join_key_3, [RF_Tree_3].[Score_3_0] AS [Score_3_0], [RF_Tree_3].[Proba_3_0] AS [Proba_3_0], [RF_Tree_3].[LogProba_3_0] AS [LogProba_3_0], [RF_Tree_3].[Score_3_1] AS [Score_3_1], [RF_Tree_3].[Proba_3_1] AS [Proba_3_1], [RF_Tree_3].[LogProba_3_1] AS [LogProba_3_1] 
FROM [RF_Tree_0] LEFT OUTER JOIN [RF_Tree_1] ON [RF_Tree_0].join_key_0 = [RF_Tree_1].join_key_1 LEFT OUTER JOIN [RF_Tree_2] ON [RF_Tree_2].join_key_2 = [RF_Tree_1].join_key_1 LEFT OUTER JOIN [RF_Tree_3] ON [RF_Tree_3].join_key_3 = [RF_Tree_2].join_key_2), 
[RF_AVG_Scores] AS 
(SELECT [RF_Join_CTE].join_key_0 AS [KEY], [RF_Join_CTE].[Score_0_0] / 4 + [RF_Join_CTE].[Score_1_0] / 4 + [RF_Join_CTE].[Score_2_0] / 4 + [RF_Join_CTE].[Score_3_0] / 4 AS [Score_0], [RF_Join_CTE].[Proba_0_0] / 4 + [RF_Join_CTE].[Proba_1_0] / 4 + [RF_Join_CTE].[Proba_2_0] / 4 + [RF_Join_CTE].[Proba_3_0] / 4 AS [Proba_0], [RF_Join_CTE].[LogProba_0_0] / 4 + [RF_Join_CTE].[LogProba_1_0] / 4 + [RF_Join_CTE].[LogProba_2_0] / 4 + [RF_Join_CTE].[LogProba_3_0] / 4 AS [LogProba_0], [RF_Join_CTE].[Score_0_1] / 4 + [RF_Join_CTE].[Score_1_1] / 4 + [RF_Join_CTE].[Score_2_1] / 4 + [RF_Join_CTE].[Score_3_1] / 4 AS [Score_1], [RF_Join_CTE].[Proba_0_1] / 4 + [RF_Join_CTE].[Proba_1_1] / 4 + [RF_Join_CTE].[Proba_2_1] / 4 + [RF_Join_CTE].[Proba_3_1] / 4 AS [Proba_1], [RF_Join_CTE].[LogProba_0_1] / 4 + [RF_Join_CTE].[LogProba_1_1] / 4 + [RF_Join_CTE].[LogProba_2_1] / 4 + [RF_Join_CTE].[LogProba_3_1] / 4 AS [LogProba_1] 
FROM [RF_Join_CTE]), 
orig_cte AS 
(SELECT [RF_AVG_Scores].[KEY] AS [KEY], [RF_AVG_Scores].[Score_0] AS [Score_0], [RF_AVG_Scores].[Score_1] AS [Score_1], [RF_AVG_Scores].[Proba_0] AS [Proba_0], [RF_AVG_Scores].[Proba_1] AS [Proba_1], [RF_AVG_Scores].[LogProba_0] AS [LogProba_0], [RF_AVG_Scores].[LogProba_1] AS [LogProba_1], CAST(NULL AS FLOAT(53)) AS [Decision] 
FROM [RF_AVG_Scores]), 
score_class_union AS 
(SELECT scu.[KEY] AS [KEY], scu.class AS class, scu.[LogProba] AS [LogProba], scu.[Proba] AS [Proba], scu.[Score] AS [Score] 
FROM (SELECT orig_cte.[KEY] AS [KEY], 0 AS class, orig_cte.[LogProba_0] AS [LogProba], orig_cte.[Proba_0] AS [Proba], orig_cte.[Score_0] AS [Score] 
FROM orig_cte UNION ALL SELECT orig_cte.[KEY] AS [KEY], 1 AS class, orig_cte.[LogProba_1] AS [LogProba], orig_cte.[Proba_1] AS [Proba], orig_cte.[Score_1] AS [Score] 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.[KEY] AS [KEY], orig_cte.[Score_0] AS [Score_0], orig_cte.[Score_1] AS [Score_1], orig_cte.[Proba_0] AS [Proba_0], orig_cte.[Proba_1] AS [Proba_1], orig_cte.[LogProba_0] AS [LogProba_0], orig_cte.[LogProba_1] AS [LogProba_1], orig_cte.[Decision] AS [Decision], (SELECT max(score_class_union.[LogProba]) AS max_1 
FROM score_class_union 
WHERE orig_cte.[KEY] = score_class_union.[KEY]) AS [max_LogProba], (SELECT max(score_class_union.[Proba]) AS max_2 
FROM score_class_union 
WHERE orig_cte.[KEY] = score_class_union.[KEY]) AS [max_Proba], (SELECT max(score_class_union.[Score]) AS max_3 
FROM score_class_union 
WHERE orig_cte.[KEY] = score_class_union.[KEY]) AS [max_Score] 
FROM orig_cte), 
arg_max_cte AS 
(SELECT score_max.[KEY] AS [KEY], score_max.[Score_0] AS [Score_0], score_max.[Score_1] AS [Score_1], score_max.[Proba_0] AS [Proba_0], score_max.[Proba_1] AS [Proba_1], score_max.[LogProba_0] AS [LogProba_0], score_max.[LogProba_1] AS [LogProba_1], score_max.[Decision] AS [Decision], score_max.[max_LogProba] AS [max_LogProba], score_max.[max_Proba] AS [max_Proba], score_max.[max_Score] AS [max_Score], (SELECT min(score_class_union.class) AS min_1 
FROM score_class_union 
WHERE score_max.[max_LogProba] = score_class_union.[LogProba] AND score_max.[KEY] = score_class_union.[KEY]) AS [arg_max_LogProba], (SELECT min(score_class_union.class) AS min_2 
FROM score_class_union 
WHERE score_max.[max_Proba] = score_class_union.[Proba] AND score_max.[KEY] = score_class_union.[KEY]) AS [arg_max_Proba], (SELECT min(score_class_union.class) AS min_3 
FROM score_class_union 
WHERE score_max.[max_Score] = score_class_union.[Score] AND score_max.[KEY] = score_class_union.[KEY]) AS [arg_max_Score] 
FROM score_max)
 SELECT arg_max_cte.[KEY] AS [KEY], arg_max_cte.[Score_0] AS [Score_0], arg_max_cte.[Score_1] AS [Score_1], arg_max_cte.[Proba_0] AS [Proba_0], arg_max_cte.[Proba_1] AS [Proba_1], CASE WHEN (arg_max_cte.[Proba_0] IS NULL OR arg_max_cte.[Proba_0] > 0.0) THEN log(arg_max_cte.[Proba_0]) ELSE -1.79769313486231e+308 END AS [LogProba_0], CASE WHEN (arg_max_cte.[Proba_1] IS NULL OR arg_max_cte.[Proba_1] > 0.0) THEN log(arg_max_cte.[Proba_1]) ELSE -1.79769313486231e+308 END AS [LogProba_1], arg_max_cte.[arg_max_Proba] AS [Decision] 
FROM arg_max_cte