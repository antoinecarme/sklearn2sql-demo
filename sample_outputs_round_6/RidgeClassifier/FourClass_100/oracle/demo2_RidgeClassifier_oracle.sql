-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH linear_model_cte AS 
(SELECT "ADS"."KEY" AS "KEY", 0.038484031897636606 * "ADS"."Feature_0" + -0.012890265213801651 * "ADS"."Feature_1" + 0.008065911969513085 * "ADS"."Feature_2" + 0.022043186753839733 * "ADS"."Feature_3" + 0.010934193712375587 * "ADS"."Feature_4" + -0.03584250217835272 * "ADS"."Feature_5" + -0.013207771311091552 * "ADS"."Feature_6" + 0.03962058686864413 * "ADS"."Feature_7" + -0.009502480747200224 * "ADS"."Feature_8" + -0.06512646613095212 * "ADS"."Feature_9" + -0.04212434758634004 * "ADS"."Feature_10" + -0.040846833530606336 * "ADS"."Feature_11" + -0.06118303063026453 * "ADS"."Feature_12" + 0.02657069658394842 * "ADS"."Feature_13" + -0.05845734372101345 * "ADS"."Feature_14" + 0.06978605831156694 * "ADS"."Feature_15" + -0.05712641524316234 * "ADS"."Feature_16" + 0.057013786672894466 * "ADS"."Feature_17" + -0.005702466232345121 * "ADS"."Feature_18" + -0.038926170646918036 * "ADS"."Feature_19" + 0.05655866348790847 * "ADS"."Feature_20" + -0.0021299108711278023 * "ADS"."Feature_21" + -0.09053472174507997 * "ADS"."Feature_22" + -0.023906278682608025 * "ADS"."Feature_23" + 0.00671913626571741 * "ADS"."Feature_24" + 0.054197140557943516 * "ADS"."Feature_25" + -0.014407304489390805 * "ADS"."Feature_26" + 0.01146018415512216 * "ADS"."Feature_27" + 0.0003569794389938997 * "ADS"."Feature_28" + 0.0007599527506007443 * "ADS"."Feature_29" + 0.05315428175120975 * "ADS"."Feature_30" + -0.010220709563519888 * "ADS"."Feature_31" + -0.04018451028068946 * "ADS"."Feature_32" + -0.031817804445970134 * "ADS"."Feature_33" + -0.01779519166411933 * "ADS"."Feature_34" + 0.057998085617938414 * "ADS"."Feature_35" + 0.012165101587149937 * "ADS"."Feature_36" + 0.0487784159220381 * "ADS"."Feature_37" + -0.025842252730642064 * "ADS"."Feature_38" + -0.04056422502381071 * "ADS"."Feature_39" + 0.013833635509071228 * "ADS"."Feature_40" + 0.040290529264010326 * "ADS"."Feature_41" + -0.027521588486865964 * "ADS"."Feature_42" + 0.04648983494410243 * "ADS"."Feature_43" + -0.08256267743446914 * "ADS"."Feature_44" + 0.1308419828661299 * "ADS"."Feature_45" + -0.03143278176495873 * "ADS"."Feature_46" + -0.006112537683009358 * "ADS"."Feature_47" + -0.039828360855199814 * "ADS"."Feature_48" + -0.02269658328390764 * "ADS"."Feature_49" + -0.028810090090813454 * "ADS"."Feature_50" + 0.0042032398762647865 * "ADS"."Feature_51" + 0.029616425769632332 * "ADS"."Feature_52" + -0.032470329525356556 * "ADS"."Feature_53" + 0.02318124960467347 * "ADS"."Feature_54" + -0.009831195700677257 * "ADS"."Feature_55" + 0.014360480799439712 * "ADS"."Feature_56" + -0.09267402505040093 * "ADS"."Feature_57" + 0.032322640319444915 * "ADS"."Feature_58" + 0.07693854813924567 * "ADS"."Feature_59" + -0.11071761052964225 * "ADS"."Feature_60" + 0.00585705004932888 * "ADS"."Feature_61" + 0.013945394102928773 * "ADS"."Feature_62" + -0.01642235965640864 * "ADS"."Feature_63" + 0.02498241415776841 * "ADS"."Feature_64" + 0.016748643396093405 * "ADS"."Feature_65" + -0.050141689076026445 * "ADS"."Feature_66" + -0.017702723269910774 * "ADS"."Feature_67" + 0.005980831999104062 * "ADS"."Feature_68" + -0.05440518638808202 * "ADS"."Feature_69" + 0.04436764162580137 * "ADS"."Feature_70" + 0.03815057298449053 * "ADS"."Feature_71" + 0.022254034425883144 * "ADS"."Feature_72" + 0.014376850247617042 * "ADS"."Feature_73" + -0.02146162594657062 * "ADS"."Feature_74" + 0.064377777252893 * "ADS"."Feature_75" + 0.07130308516873025 * "ADS"."Feature_76" + -0.031042898032684403 * "ADS"."Feature_77" + -0.015302789327775543 * "ADS"."Feature_78" + -0.016712753394885125 * "ADS"."Feature_79" + 0.045158113924773174 * "ADS"."Feature_80" + 0.0399188356001391 * "ADS"."Feature_81" + 0.054939233360033486 * "ADS"."Feature_82" + -0.05661223153781314 * "ADS"."Feature_83" + 0.031050524579954213 * "ADS"."Feature_84" + 0.051833334703610005 * "ADS"."Feature_85" + 0.038582206322835 * "ADS"."Feature_86" + 0.01065315329633125 * "ADS"."Feature_87" + -0.011904741419377543 * "ADS"."Feature_88" + -0.01011533877298592 * "ADS"."Feature_89" + -0.028980907116639816 * "ADS"."Feature_90" + 0.014937908862564506 * "ADS"."Feature_91" + -0.051153835761803865 * "ADS"."Feature_92" + -0.0009391548025563879 * "ADS"."Feature_93" + -0.034241999047561616 * "ADS"."Feature_94" + 0.03515597837262425 * "ADS"."Feature_95" + 0.011007750075824174 * "ADS"."Feature_96" + -0.011455892789691814 * "ADS"."Feature_97" + -0.005222506043640591 * "ADS"."Feature_98" + -0.035248546785968726 * "ADS"."Feature_99" + -0.435216743703 AS "Score_0", -0.04668878082369957 * "ADS"."Feature_0" + -0.05941114906704102 * "ADS"."Feature_1" + 0.09001677302186033 * "ADS"."Feature_2" + 0.04905905702494087 * "ADS"."Feature_3" + 0.05640379488305079 * "ADS"."Feature_4" + -0.1254345093756856 * "ADS"."Feature_5" + 0.019551634867859283 * "ADS"."Feature_6" + 0.020786984802661067 * "ADS"."Feature_7" + 0.0027471639296973516 * "ADS"."Feature_8" + -0.08593778750030949 * "ADS"."Feature_9" + -0.08841274586739666 * "ADS"."Feature_10" + 0.061260563629558326 * "ADS"."Feature_11" + 0.06032899814356301 * "ADS"."Feature_12" + -0.059418760319054194 * "ADS"."Feature_13" + -0.04040838623481352 * "ADS"."Feature_14" + -0.11231705337107237 * "ADS"."Feature_15" + 0.16564013573952066 * "ADS"."Feature_16" + -0.06932974144539872 * "ADS"."Feature_17" + -0.06380814432739104 * "ADS"."Feature_18" + -0.005271882360261542 * "ADS"."Feature_19" + -0.0819517446522067 * "ADS"."Feature_20" + -0.012804490841374867 * "ADS"."Feature_21" + 0.09199205096104117 * "ADS"."Feature_22" + -0.001450194926071069 * "ADS"."Feature_23" + -0.023398224012813426 * "ADS"."Feature_24" + -0.02193541901275956 * "ADS"."Feature_25" + 0.014193260886021283 * "ADS"."Feature_26" + -0.0453133963918155 * "ADS"."Feature_27" + 0.0133966900028262 * "ADS"."Feature_28" + 0.010414296832345637 * "ADS"."Feature_29" + -0.16263547739513842 * "ADS"."Feature_30" + 0.007802338576849793 * "ADS"."Feature_31" + -0.05135836907708085 * "ADS"."Feature_32" + -0.06355740019952028 * "ADS"."Feature_33" + 0.10125843058608823 * "ADS"."Feature_34" + 0.01234160809644746 * "ADS"."Feature_35" + 0.009756596545773082 * "ADS"."Feature_36" + -0.019475519049444043 * "ADS"."Feature_37" + 0.010530364607176494 * "ADS"."Feature_38" + -0.11108260464202771 * "ADS"."Feature_39" + 0.013348164629411945 * "ADS"."Feature_40" + 0.06952075062137672 * "ADS"."Feature_41" + 0.04545147196769307 * "ADS"."Feature_42" + -0.03454928610957185 * "ADS"."Feature_43" + 0.02703014566200507 * "ADS"."Feature_44" + -0.054687026820390186 * "ADS"."Feature_45" + -0.014944597681254598 * "ADS"."Feature_46" + -0.008203377163487648 * "ADS"."Feature_47" + 0.19237496338161386 * "ADS"."Feature_48" + 0.01811135573650348 * "ADS"."Feature_49" + 0.04066143665014584 * "ADS"."Feature_50" + 0.023188891700786283 * "ADS"."Feature_51" + 0.02481283783492699 * "ADS"."Feature_52" + 0.05383110756680397 * "ADS"."Feature_53" + 0.04232696306216708 * "ADS"."Feature_54" + 0.06386061591329813 * "ADS"."Feature_55" + 0.004582778232434387 * "ADS"."Feature_56" + 0.03645006569738372 * "ADS"."Feature_57" + 0.029861445522026946 * "ADS"."Feature_58" + -0.07741953599685798 * "ADS"."Feature_59" + 0.0433678134411294 * "ADS"."Feature_60" + 0.1263727701439414 * "ADS"."Feature_61" + 0.03809203289008206 * "ADS"."Feature_62" + -0.04421538019223653 * "ADS"."Feature_63" + 0.057192662274924276 * "ADS"."Feature_64" + -0.018583347625940466 * "ADS"."Feature_65" + 0.06463012806992219 * "ADS"."Feature_66" + 0.02750172665877108 * "ADS"."Feature_67" + -0.002691787460238307 * "ADS"."Feature_68" + 0.07211327835148516 * "ADS"."Feature_69" + -0.07250720502494733 * "ADS"."Feature_70" + -0.04719862553249881 * "ADS"."Feature_71" + -0.12117955718296872 * "ADS"."Feature_72" + -0.05394600937416517 * "ADS"."Feature_73" + 0.1245203437290677 * "ADS"."Feature_74" + -0.005007443808281167 * "ADS"."Feature_75" + -0.09403755185287715 * "ADS"."Feature_76" + 0.11677570764314496 * "ADS"."Feature_77" + 0.035307061396794986 * "ADS"."Feature_78" + 0.007502973254277647 * "ADS"."Feature_79" + -0.03947550413347234 * "ADS"."Feature_80" + -0.05960181569312576 * "ADS"."Feature_81" + 0.011588904449047917 * "ADS"."Feature_82" + -0.018213090043210162 * "ADS"."Feature_83" + -0.051294918198169004 * "ADS"."Feature_84" + 0.016643492439572364 * "ADS"."Feature_85" + 0.029999447229515554 * "ADS"."Feature_86" + -0.029141105477348432 * "ADS"."Feature_87" + 0.009259756219322068 * "ADS"."Feature_88" + -0.15393474410852337 * "ADS"."Feature_89" + 0.007988946861625993 * "ADS"."Feature_90" + -0.11034131884932252 * "ADS"."Feature_91" + 0.12262827534561484 * "ADS"."Feature_92" + 0.02039474135313342 * "ADS"."Feature_93" + 0.008071541860485618 * "ADS"."Feature_94" + -0.09075026883875509 * "ADS"."Feature_95" + -0.006212361691218561 * "ADS"."Feature_96" + -0.032737336446414765 * "ADS"."Feature_97" + 0.059641863127924126 * "ADS"."Feature_98" + 0.02255403663756555 * "ADS"."Feature_99" + -0.448303298485 AS "Score_1", -0.006020810204360294 * "ADS"."Feature_0" + 0.08741523305642263 * "ADS"."Feature_1" + -0.011879326248943459 * "ADS"."Feature_2" + -0.05742130585589988 * "ADS"."Feature_3" + -0.08634108523741182 * "ADS"."Feature_4" + 0.11382619875310444 * "ADS"."Feature_5" + -0.015816673868195706 * "ADS"."Feature_6" + -0.024976313868887955 * "ADS"."Feature_7" + -0.0032552210452341575 * "ADS"."Feature_8" + 0.07038171393437735 * "ADS"."Feature_9" + -0.020225215028046275 * "ADS"."Feature_10" + 0.02599212070061286 * "ADS"."Feature_11" + -0.01831559685191484 * "ADS"."Feature_12" + -0.019795016963965073 * "ADS"."Feature_13" + 0.03986391995219194 * "ADS"."Feature_14" + 0.050956677822470424 * "ADS"."Feature_15" + -0.06745396755087808 * "ADS"."Feature_16" + 0.030144661102076243 * "ADS"."Feature_17" + -0.0177787096433234 * "ADS"."Feature_18" + 0.026562840766724664 * "ADS"."Feature_19" + 0.06200549895792942 * "ADS"."Feature_20" + 0.005766790670276335 * "ADS"."Feature_21" + -0.001445386868965887 * "ADS"."Feature_22" + -0.004504031395678468 * "ADS"."Feature_23" + -0.008260913759108736 * "ADS"."Feature_24" + -0.028994220250719096 * "ADS"."Feature_25" + -0.008120115913270396 * "ADS"."Feature_26" + 0.09465370851517992 * "ADS"."Feature_27" + -0.025487165446269836 * "ADS"."Feature_28" + 0.013248247145513647 * "ADS"."Feature_29" + 0.15655462949912366 * "ADS"."Feature_30" + 0.00785462272889055 * "ADS"."Feature_31" + 0.06349437346005724 * "ADS"."Feature_32" + 0.09589517382598807 * "ADS"."Feature_33" + -0.04862892856261554 * "ADS"."Feature_34" + -0.16516729551437634 * "ADS"."Feature_35" + -0.03227954936867176 * "ADS"."Feature_36" + -0.07516210627456076 * "ADS"."Feature_37" + -0.035509753686970486 * "ADS"."Feature_38" + 0.13156252798979357 * "ADS"."Feature_39" + -0.13477903399926572 * "ADS"."Feature_40" + -0.005875264451589798 * "ADS"."Feature_41" + 0.09956909810069939 * "ADS"."Feature_42" + -0.019034372089036123 * "ADS"."Feature_43" + 0.08523101693289489 * "ADS"."Feature_44" + 0.024821445367745297 * "ADS"."Feature_45" + 0.02471631050402453 * "ADS"."Feature_46" + 0.0659751698106745 * "ADS"."Feature_47" + -0.11101142975749603 * "ADS"."Feature_48" + 0.017980406496500165 * "ADS"."Feature_49" + -0.0321194629899952 * "ADS"."Feature_50" + -0.010540191018273163 * "ADS"."Feature_51" + -0.06421403269497188 * "ADS"."Feature_52" + -0.013823559037851707 * "ADS"."Feature_53" + -0.05340222134933051 * "ADS"."Feature_54" + -0.1878456918383668 * "ADS"."Feature_55" + -0.0287687921847778 * "ADS"."Feature_56" + 0.026807715986832827 * "ADS"."Feature_57" + -0.05334645554744491 * "ADS"."Feature_58" + -0.04855837367777172 * "ADS"."Feature_59" + 0.0026921160523671658 * "ADS"."Feature_60" + -0.14979963595043325 * "ADS"."Feature_61" + -0.06310920622752511 * "ADS"."Feature_62" + -0.023848519346680662 * "ADS"."Feature_63" + -0.048969229914107196 * "ADS"."Feature_64" + -0.047213814165932934 * "ADS"."Feature_65" + -0.06426104431990726 * "ADS"."Feature_66" + -0.008490494729633362 * "ADS"."Feature_67" + 0.025823017794897055 * "ADS"."Feature_68" + 0.004674236184720189 * "ADS"."Feature_69" + -0.0010343671121803705 * "ADS"."Feature_70" + 0.027916885028855063 * "ADS"."Feature_71" + 0.21634913508363524 * "ADS"."Feature_72" + 0.014822227980888836 * "ADS"."Feature_73" + -0.011064761289963492 * "ADS"."Feature_74" + -0.01658147548914861 * "ADS"."Feature_75" + 0.027926529410860646 * "ADS"."Feature_76" + -0.06082558128780574 * "ADS"."Feature_77" + -0.12355558744583567 * "ADS"."Feature_78" + 0.02254072193815327 * "ADS"."Feature_79" + 0.04707093147871271 * "ADS"."Feature_80" + 0.08902662700615702 * "ADS"."Feature_81" + -0.0847683849602979 * "ADS"."Feature_82" + 0.06261111064625223 * "ADS"."Feature_83" + 0.06130330288184936 * "ADS"."Feature_84" + -0.031820757837216086 * "ADS"."Feature_85" + -0.22575776563673972 * "ADS"."Feature_86" + 0.02659726386688021 * "ADS"."Feature_87" + 0.005112032150854817 * "ADS"."Feature_88" + 0.06564185595665656 * "ADS"."Feature_89" + -0.02736490322355857 * "ADS"."Feature_90" + 0.1579637930574693 * "ADS"."Feature_91" + -0.20723634719049452 * "ADS"."Feature_92" + -0.06632747485451686 * "ADS"."Feature_93" + 0.04004487383535008 * "ADS"."Feature_94" + 0.11805289657538032 * "ADS"."Feature_95" + 0.06668303604442419 * "ADS"."Feature_96" + -0.040338409929697595 * "ADS"."Feature_97" + -0.05507313329103493 * "ADS"."Feature_98" + -0.024507113214336664 * "ADS"."Feature_99" + -0.520269217415 AS "Score_2", 0.014225559130423865 * "ADS"."Feature_0" + -0.015113818775579838 * "ADS"."Feature_1" + -0.08620335874242996 * "ADS"."Feature_2" + -0.013680937922880877 * "ADS"."Feature_3" + 0.01900309664198549 * "ADS"."Feature_4" + 0.04745081280093402 * "ADS"."Feature_5" + 0.009472810311427722 * "ADS"."Feature_6" + -0.03543125780241739 * "ADS"."Feature_7" + 0.010010537862737052 * "ADS"."Feature_8" + 0.08068253969688438 * "ADS"."Feature_9" + 0.15076230848178301 * "ADS"."Feature_10" + -0.046405850799564594 * "ADS"."Feature_11" + 0.0191696293386166 * "ADS"."Feature_12" + 0.052643080699070574 * "ADS"."Feature_13" + 0.05900181000363533 * "ADS"."Feature_14" + -0.008425682762965033 * "ADS"."Feature_15" + -0.041059752945480144 * "ADS"."Feature_16" + -0.01782870632957195 * "ADS"."Feature_17" + 0.08728932020305957 * "ADS"."Feature_18" + 0.017635212240454903 * "ADS"."Feature_19" + -0.036612417793631655 * "ADS"."Feature_20" + 0.009167611042227103 * "ADS"."Feature_21" + -1.1942346995389048e-05 * "ADS"."Feature_22" + 0.029860505004357343 * "ADS"."Feature_23" + 0.024940001506204547 * "ADS"."Feature_24" + -0.003267501294464698 * "ADS"."Feature_25" + 0.008334159516639983 * "ADS"."Feature_26" + -0.06080049627848664 * "ADS"."Feature_27" + 0.011733496004449544 * "ADS"."Feature_28" + -0.024422496728459607 * "ADS"."Feature_29" + -0.04707343385519501 * "ADS"."Feature_30" + -0.0054362517422200905 * "ADS"."Feature_31" + 0.028048505897712954 * "ADS"."Feature_32" + -0.0005199691804974394 * "ADS"."Feature_33" + -0.034834310359353464 * "ADS"."Feature_34" + 0.09482760179999047 * "ADS"."Feature_35" + 0.010357851235749043 * "ADS"."Feature_36" + 0.045859209401966715 * "ADS"."Feature_37" + 0.050821641810436066 * "ADS"."Feature_38" + 0.020084301676044893 * "ADS"."Feature_39" + 0.10759723386078272 * "ADS"."Feature_40" + -0.10393601543379731 * "ADS"."Feature_41" + -0.1174989815815266 * "ADS"."Feature_42" + 0.007093823254505491 * "ADS"."Feature_43" + -0.02969848516043072 * "ADS"."Feature_44" + -0.10097640141348514 * "ADS"."Feature_45" + 0.02166106894218872 * "ADS"."Feature_46" + -0.05165925496417774 * "ADS"."Feature_47" + -0.041535172768918056 * "ADS"."Feature_48" + -0.013395178949096094 * "ADS"."Feature_49" + 0.0202681164306626 * "ADS"."Feature_50" + -0.016851940558777763 * "ADS"."Feature_51" + 0.009784769090412227 * "ADS"."Feature_52" + -0.0075372190035956875 * "ADS"."Feature_53" + -0.012105991317509876 * "ADS"."Feature_54" + 0.13381627162574602 * "ADS"."Feature_55" + 0.00982553315290357 * "ADS"."Feature_56" + 0.0294162433661842 * "ADS"."Feature_57" + -0.008837630294026861 * "ADS"."Feature_58" + 0.049039361535384095 * "ADS"."Feature_59" + 0.06465768103614572 * "ADS"."Feature_60" + 0.017569815757163088 * "ADS"."Feature_61" + 0.011071779234514308 * "ADS"."Feature_62" + 0.08448625919532604 * "ADS"."Feature_63" + -0.03320584651858538 * "ADS"."Feature_64" + 0.04904851839578003 * "ADS"."Feature_65" + 0.049772605326011216 * "ADS"."Feature_66" + -0.0013085086592272976 * "ADS"."Feature_67" + -0.029112062333762782 * "ADS"."Feature_68" + -0.02238232814812305 * "ADS"."Feature_69" + 0.029173930511325958 * "ADS"."Feature_70" + -0.018868832480846767 * "ADS"."Feature_71" + -0.11742361232655005 * "ADS"."Feature_72" + 0.024746931145659706 * "ADS"."Feature_73" + -0.09199395649253365 * "ADS"."Feature_74" + -0.042788857955463486 * "ADS"."Feature_75" + -0.0051920627267137386 * "ADS"."Feature_76" + -0.024907228322654885 * "ADS"."Feature_77" + 0.1035513153768162 * "ADS"."Feature_78" + -0.013330941797545806 * "ADS"."Feature_79" + -0.05275354127001354 * "ADS"."Feature_80" + -0.06934364691316999 * "ADS"."Feature_81" + 0.0182402471512164 * "ADS"."Feature_82" + 0.012214210934771073 * "ADS"."Feature_83" + -0.041058909263634584 * "ADS"."Feature_84" + -0.03665606930596608 * "ADS"."Feature_85" + 0.15717611208438922 * "ADS"."Feature_86" + -0.008109311685862894 * "ADS"."Feature_87" + -0.002467046950801355 * "ADS"."Feature_88" + 0.0984082269248526 * "ADS"."Feature_89" + 0.048356863478572244 * "ADS"."Feature_90" + -0.0625603830707113 * "ADS"."Feature_91" + 0.13576190760668358 * "ADS"."Feature_92" + 0.04687188830394007 * "ADS"."Feature_93" + -0.013874416648274213 * "ADS"."Feature_94" + -0.06245860610924957 * "ADS"."Feature_95" + -0.07147842442902996 * "ADS"."Feature_96" + 0.08453163916580438 * "ADS"."Feature_97" + 0.0006537762067515005 * "ADS"."Feature_98" + 0.03720162336273983 * "ADS"."Feature_99" + -0.596210740397 AS "Score_3" 
FROM "FourClass_100" "ADS"), 
orig_cte AS 
(SELECT linear_model_cte."KEY" AS "KEY", linear_model_cte."Score_0" AS "Score_0", linear_model_cte."Score_1" AS "Score_1", linear_model_cte."Score_2" AS "Score_2", linear_model_cte."Score_3" AS "Score_3", CAST(NULL AS FLOAT) AS "Proba_0", CAST(NULL AS FLOAT) AS "Proba_1", CAST(NULL AS FLOAT) AS "Proba_2", CAST(NULL AS FLOAT) AS "Proba_3", CAST(NULL AS FLOAT) AS "LogProba_0", CAST(NULL AS FLOAT) AS "LogProba_1", CAST(NULL AS FLOAT) AS "LogProba_2", CAST(NULL AS FLOAT) AS "LogProba_3", CAST(NULL AS FLOAT) AS "Decision" 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu."KEY" AS "KEY", scu.class AS class, scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY", 0 AS class, orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY", 1 AS class, orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY", 2 AS class, orig_cte."LogProba_2" AS "LogProba", orig_cte."Proba_2" AS "Proba", orig_cte."Score_2" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY", 3 AS class, orig_cte."LogProba_3" AS "LogProba", orig_cte."Proba_3" AS "Proba", orig_cte."Score_3" AS "Score" 
FROM orig_cte) scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Score_2" AS "Score_2", orig_cte."Score_3" AS "Score_3", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."Proba_2" AS "Proba_2", orig_cte."Proba_3" AS "Proba_3", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."LogProba_2" AS "LogProba_2", orig_cte."LogProba_3" AS "LogProba_3", orig_cte."Decision" AS "Decision", (SELECT max(score_class_union."LogProba") AS max_1 
FROM score_class_union 
WHERE orig_cte."KEY" = score_class_union."KEY") AS "max_LogProba", (SELECT max(score_class_union."Proba") AS max_2 
FROM score_class_union 
WHERE orig_cte."KEY" = score_class_union."KEY") AS "max_Proba", (SELECT max(score_class_union."Score") AS max_3 
FROM score_class_union 
WHERE orig_cte."KEY" = score_class_union."KEY") AS "max_Score" 
FROM orig_cte), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."max_LogProba" AS "max_LogProba", score_max."max_Proba" AS "max_Proba", score_max."max_Score" AS "max_Score", (SELECT min(score_class_union.class) AS min_1 
FROM score_class_union 
WHERE score_max."max_LogProba" = score_class_union."LogProba" AND score_max."KEY" = score_class_union."KEY") AS "arg_max_LogProba", (SELECT min(score_class_union.class) AS min_2 
FROM score_class_union 
WHERE score_max."max_Proba" = score_class_union."Proba" AND score_max."KEY" = score_class_union."KEY") AS "arg_max_Proba", (SELECT min(score_class_union.class) AS min_3 
FROM score_class_union 
WHERE score_max."max_Score" = score_class_union."Score" AND score_max."KEY" = score_class_union."KEY") AS "arg_max_Score" 
FROM score_max)
 SELECT arg_max_cte."KEY" AS "KEY", arg_max_cte."Score_0" AS "Score_0", arg_max_cte."Score_1" AS "Score_1", arg_max_cte."Score_2" AS "Score_2", arg_max_cte."Score_3" AS "Score_3", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", arg_max_cte."Proba_2" AS "Proba_2", arg_max_cte."Proba_3" AS "Proba_3", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN ln(arg_max_cte."Proba_0") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN ln(arg_max_cte."Proba_1") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_1", CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN ln(arg_max_cte."Proba_2") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_2", CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN ln(arg_max_cte."Proba_3") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_3", arg_max_cte."arg_max_Score" AS "Decision" 
FROM arg_max_cte