-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH linear_model_cte AS 
(SELECT "ADS"."KEY" AS "KEY", -140.48369515540767 * "ADS"."Feature_0" + -529.3722353574443 * "ADS"."Feature_1" + -74.31178428209749 * "ADS"."Feature_2" + 13.41315022337347 * "ADS"."Feature_3" + -81.11128048044682 * "ADS"."Feature_4" + -157.64051276726607 * "ADS"."Feature_5" + -139.33004073727736 * "ADS"."Feature_6" + -68.33539785916048 * "ADS"."Feature_7" + 4.639115776291597 * "ADS"."Feature_8" + 101.62701914456855 * "ADS"."Feature_9" + 165.86175131340647 * "ADS"."Feature_10" + 647.877525602291 * "ADS"."Feature_11" + 148.51604527765406 * "ADS"."Feature_12" + 77.9742562939427 * "ADS"."Feature_13" + -262.6185159436747 * "ADS"."Feature_14" + 176.28444625727505 * "ADS"."Feature_15" + 133.63057328753555 * "ADS"."Feature_16" + 26.841292348445013 * "ADS"."Feature_17" + -99.13757291775299 * "ADS"."Feature_18" + -21.520021961600534 * "ADS"."Feature_19" + 55.94931562900594 * "ADS"."Feature_20" + 72.05205986086162 * "ADS"."Feature_21" + -156.058943620755 * "ADS"."Feature_22" + 321.4627950510625 * "ADS"."Feature_23" + -101.6191847153169 * "ADS"."Feature_24" + 28.927156578222327 * "ADS"."Feature_25" + -47.78819887423895 * "ADS"."Feature_26" + 84.99506950626669 * "ADS"."Feature_27" + 174.97615254574515 * "ADS"."Feature_28" + -172.13681411774553 * "ADS"."Feature_29" + 195.7469331735883 * "ADS"."Feature_30" + 159.5283243669406 * "ADS"."Feature_31" + -46.868006486138746 * "ADS"."Feature_32" + -82.73388712108944 * "ADS"."Feature_33" + 137.78967895638246 * "ADS"."Feature_34" + -183.59387255849924 * "ADS"."Feature_35" + 73.96827596000098 * "ADS"."Feature_36" + -53.33700950811493 * "ADS"."Feature_37" + -12.413316565055117 * "ADS"."Feature_38" + 103.6418705258363 * "ADS"."Feature_39" + 160.752508353233 * "ADS"."Feature_40" + -105.87762317886111 * "ADS"."Feature_41" + 126.15346570531493 * "ADS"."Feature_42" + -115.4958503583595 * "ADS"."Feature_43" + -25.898796626304982 * "ADS"."Feature_44" + -218.672426429174 * "ADS"."Feature_45" + 342.0314929889639 * "ADS"."Feature_46" + 41.666892040876206 * "ADS"."Feature_47" + 357.1379656674103 * "ADS"."Feature_48" + 84.07425369048704 * "ADS"."Feature_49" + 23.686102625163297 * "ADS"."Feature_50" + -612.7430315132001 * "ADS"."Feature_51" + -504.79590654549844 * "ADS"."Feature_52" + 0.5432122937056025 * "ADS"."Feature_53" + -147.42712463476315 * "ADS"."Feature_54" + -189.89410545650966 * "ADS"."Feature_55" + 102.78487529912292 * "ADS"."Feature_56" + 151.17917642356298 * "ADS"."Feature_57" + -93.61891284200517 * "ADS"."Feature_58" + 236.69320350318532 * "ADS"."Feature_59" + 27.69723423703534 * "ADS"."Feature_60" + -36.95295114582767 * "ADS"."Feature_61" + 319.7097273853136 * "ADS"."Feature_62" + 388.02335545616353 * "ADS"."Feature_63" + -159.32122972018976 * "ADS"."Feature_64" + 146.8916613271849 * "ADS"."Feature_65" + -39.71242267209782 * "ADS"."Feature_66" + 55.100167760699016 * "ADS"."Feature_67" + 50.67732930773508 * "ADS"."Feature_68" + 36.25546236868517 * "ADS"."Feature_69" + -134.77017246245137 * "ADS"."Feature_70" + 133.96596920049905 * "ADS"."Feature_71" + 156.71710160348954 * "ADS"."Feature_72" + 185.84945756158197 * "ADS"."Feature_73" + 159.81136262577203 * "ADS"."Feature_74" + 394.94248680211064 * "ADS"."Feature_75" + 171.09995539934522 * "ADS"."Feature_76" + 59.816691196409394 * "ADS"."Feature_77" + 155.07012507594226 * "ADS"."Feature_78" + -105.4231433205278 * "ADS"."Feature_79" + 24.336171356845213 * "ADS"."Feature_80" + -199.3700857343422 * "ADS"."Feature_81" + -88.37430302567805 * "ADS"."Feature_82" + -86.7249071090236 * "ADS"."Feature_83" + -45.384113862474706 * "ADS"."Feature_84" + 27.071410958972812 * "ADS"."Feature_85" + 259.0252076068274 * "ADS"."Feature_86" + 29.52039678808836 * "ADS"."Feature_87" + -287.1913823304919 * "ADS"."Feature_88" + 10.61911765407995 * "ADS"."Feature_89" + -342.8657986038787 * "ADS"."Feature_90" + -113.62692486271409 * "ADS"."Feature_91" + 64.6623487309643 * "ADS"."Feature_92" + 201.64104242957046 * "ADS"."Feature_93" + -37.27788547738973 * "ADS"."Feature_94" + -98.44026604009703 * "ADS"."Feature_95" + 8.97836948039265 * "ADS"."Feature_96" + -443.87934090927985 * "ADS"."Feature_97" + 61.82049553139945 * "ADS"."Feature_98" + -93.29056282528421 * "ADS"."Feature_99" + -369.351282817 AS "Score_0", -33.16048930009321 * "ADS"."Feature_0" + -61.95294312713519 * "ADS"."Feature_1" + -83.59069158560466 * "ADS"."Feature_2" + 114.41894816330831 * "ADS"."Feature_3" + 32.11063390387745 * "ADS"."Feature_4" + -96.88706116945414 * "ADS"."Feature_5" + -83.46794080891341 * "ADS"."Feature_6" + -80.20423119701066 * "ADS"."Feature_7" + -307.6894756788394 * "ADS"."Feature_8" + 143.775443729114 * "ADS"."Feature_9" + 196.66938190995253 * "ADS"."Feature_10" + -205.9056143706814 * "ADS"."Feature_11" + -61.16065137675773 * "ADS"."Feature_12" + -1.7432600040546307 * "ADS"."Feature_13" + 78.59964645233039 * "ADS"."Feature_14" + 11.028127996558677 * "ADS"."Feature_15" + 53.827587981324655 * "ADS"."Feature_16" + -78.96756117701874 * "ADS"."Feature_17" + -36.07902435219987 * "ADS"."Feature_18" + -181.72959002696388 * "ADS"."Feature_19" + 238.4632514904419 * "ADS"."Feature_20" + 36.690780910364246 * "ADS"."Feature_21" + -236.95221471533196 * "ADS"."Feature_22" + 103.48035463261904 * "ADS"."Feature_23" + -26.948219447459596 * "ADS"."Feature_24" + -90.78851329547417 * "ADS"."Feature_25" + 162.00959913387405 * "ADS"."Feature_26" + -306.0728531937818 * "ADS"."Feature_27" + -162.8790974456097 * "ADS"."Feature_28" + 47.69081521948307 * "ADS"."Feature_29" + 73.4319933518703 * "ADS"."Feature_30" + -79.32607093112289 * "ADS"."Feature_31" + 61.53326999496869 * "ADS"."Feature_32" + -10.189552377715303 * "ADS"."Feature_33" + 51.708422135564945 * "ADS"."Feature_34" + 106.10880870468529 * "ADS"."Feature_35" + 34.547997692422456 * "ADS"."Feature_36" + 0.07791027881322782 * "ADS"."Feature_37" + 103.43820700105879 * "ADS"."Feature_38" + -119.73480841467978 * "ADS"."Feature_39" + 615.3374524589017 * "ADS"."Feature_40" + -190.59601291133788 * "ADS"."Feature_41" + -167.54827907805668 * "ADS"."Feature_42" + 463.16023348676447 * "ADS"."Feature_43" + -0.7282491384658171 * "ADS"."Feature_44" + -79.8985422456306 * "ADS"."Feature_45" + 200.30050412993887 * "ADS"."Feature_46" + 80.3514087799823 * "ADS"."Feature_47" + 272.7103080549284 * "ADS"."Feature_48" + -11.42898800447762 * "ADS"."Feature_49" + -35.501532623035544 * "ADS"."Feature_50" + 284.368035470901 * "ADS"."Feature_51" + -95.66592672380214 * "ADS"."Feature_52" + -137.30694001294367 * "ADS"."Feature_53" + -320.62732300246734 * "ADS"."Feature_54" + 407.7696419711528 * "ADS"."Feature_55" + -51.001895216474644 * "ADS"."Feature_56" + 332.4472257998081 * "ADS"."Feature_57" + -28.93653795820968 * "ADS"."Feature_58" + 170.1522345063322 * "ADS"."Feature_59" + 3.788831005181784 * "ADS"."Feature_60" + -34.84969027333518 * "ADS"."Feature_61" + 216.7389720462683 * "ADS"."Feature_62" + 407.92614752672847 * "ADS"."Feature_63" + 32.00172236282097 * "ADS"."Feature_64" + -179.51881362940276 * "ADS"."Feature_65" + 42.48110280421641 * "ADS"."Feature_66" + -47.4850484764119 * "ADS"."Feature_67" + -5.858418933701729 * "ADS"."Feature_68" + -400.83252996009554 * "ADS"."Feature_69" + -8.33077384937021 * "ADS"."Feature_70" + -201.46162650142045 * "ADS"."Feature_71" + 253.29892293784303 * "ADS"."Feature_72" + 200.11972077562348 * "ADS"."Feature_73" + -2.655868357507038 * "ADS"."Feature_74" + 370.52284906013233 * "ADS"."Feature_75" + -131.7997626682513 * "ADS"."Feature_76" + -9.534559955529762 * "ADS"."Feature_77" + -9.414026801388097 * "ADS"."Feature_78" + 247.63335433448685 * "ADS"."Feature_79" + -202.79889294263637 * "ADS"."Feature_80" + -200.87348361354958 * "ADS"."Feature_81" + 5.119372862640941 * "ADS"."Feature_82" + -42.23940668810746 * "ADS"."Feature_83" + -0.5030932954208158 * "ADS"."Feature_84" + -653.05283436346 * "ADS"."Feature_85" + 4.632863565961106 * "ADS"."Feature_86" + 77.60437862652972 * "ADS"."Feature_87" + 166.2340160618136 * "ADS"."Feature_88" + 155.36579660723274 * "ADS"."Feature_89" + 86.21526037391703 * "ADS"."Feature_90" + -83.2963697467793 * "ADS"."Feature_91" + -53.555530510715165 * "ADS"."Feature_92" + -141.81404471563775 * "ADS"."Feature_93" + -225.31373226050556 * "ADS"."Feature_94" + 0.07873850470951682 * "ADS"."Feature_95" + 53.83538479261241 * "ADS"."Feature_96" + 417.12506847174694 * "ADS"."Feature_97" + 45.546072441203066 * "ADS"."Feature_98" + -48.63900313493852 * "ADS"."Feature_99" + -367.482465246 AS "Score_1", 338.6014588893804 * "ADS"."Feature_0" + 149.5016206972703 * "ADS"."Feature_1" + 19.415751046862155 * "ADS"."Feature_2" + 39.21997044229819 * "ADS"."Feature_3" + -96.61546920248351 * "ADS"."Feature_4" + -64.0242272924459 * "ADS"."Feature_5" + 60.73638714064909 * "ADS"."Feature_6" + -9.697991402535388 * "ADS"."Feature_7" + 506.4360149328413 * "ADS"."Feature_8" + 199.55371438525506 * "ADS"."Feature_9" + 227.3132603433148 * "ADS"."Feature_10" + -33.83120891780777 * "ADS"."Feature_11" + 19.919985902666532 * "ADS"."Feature_12" + 143.6543210214114 * "ADS"."Feature_13" + 106.16921970591356 * "ADS"."Feature_14" + 161.93107948481045 * "ADS"."Feature_15" + -87.5927300627823 * "ADS"."Feature_16" + 35.42723188062393 * "ADS"."Feature_17" + 0.2694263816659491 * "ADS"."Feature_18" + 197.46855632749205 * "ADS"."Feature_19" + 70.54790789048928 * "ADS"."Feature_20" + 151.98979484997048 * "ADS"."Feature_21" + -253.94716489606165 * "ADS"."Feature_22" + -40.85712666668739 * "ADS"."Feature_23" + -98.27028880736692 * "ADS"."Feature_24" + 60.043662402025696 * "ADS"."Feature_25" + 218.82778594184617 * "ADS"."Feature_26" + 461.572697260812 * "ADS"."Feature_27" + 70.21890649423243 * "ADS"."Feature_28" + 164.18706737286584 * "ADS"."Feature_29" + -24.651912649581714 * "ADS"."Feature_30" + 166.0205738982164 * "ADS"."Feature_31" + 70.29108967547225 * "ADS"."Feature_32" + 40.854321908220506 * "ADS"."Feature_33" + 79.10828565293201 * "ADS"."Feature_34" + 65.6319067331071 * "ADS"."Feature_35" + 170.94364614855579 * "ADS"."Feature_36" + 33.970663430824295 * "ADS"."Feature_37" + -10.29398129160945 * "ADS"."Feature_38" + 95.29407535724582 * "ADS"."Feature_39" + 671.4840740936687 * "ADS"."Feature_40" + 122.16994751919793 * "ADS"."Feature_41" + -21.951189902227664 * "ADS"."Feature_42" + -317.4408995533172 * "ADS"."Feature_43" + -65.67904496550105 * "ADS"."Feature_44" + 61.58023839339012 * "ADS"."Feature_45" + 100.25731609954322 * "ADS"."Feature_46" + -34.73523091034565 * "ADS"."Feature_47" + 70.65567927521644 * "ADS"."Feature_48" + 12.121134360156056 * "ADS"."Feature_49" + -43.42017387447734 * "ADS"."Feature_50" + -108.07543609790424 * "ADS"."Feature_51" + 247.60984182008028 * "ADS"."Feature_52" + -24.384804796659946 * "ADS"."Feature_53" + 187.26075887647966 * "ADS"."Feature_54" + 161.1148485511364 * "ADS"."Feature_55" + 82.4924105605307 * "ADS"."Feature_56" + 25.227502239500286 * "ADS"."Feature_57" + -380.74676073279903 * "ADS"."Feature_58" + -478.4015408309897 * "ADS"."Feature_59" + -12.123884261217533 * "ADS"."Feature_60" + 377.5700990109462 * "ADS"."Feature_61" + 64.07204531030409 * "ADS"."Feature_62" + -311.9743342650354 * "ADS"."Feature_63" + 98.12922643700114 * "ADS"."Feature_64" + 77.13510646331213 * "ADS"."Feature_65" + -196.712368111059 * "ADS"."Feature_66" + -147.09777795567194 * "ADS"."Feature_67" + -10.062324164298778 * "ADS"."Feature_68" + 261.94471939664857 * "ADS"."Feature_69" + 51.77820907444287 * "ADS"."Feature_70" + 155.1323557401825 * "ADS"."Feature_71" + -5.903783522889554 * "ADS"."Feature_72" + -244.13255018146268 * "ADS"."Feature_73" + 40.46522679144602 * "ADS"."Feature_74" + 48.21994657526012 * "ADS"."Feature_75" + -16.337864655291618 * "ADS"."Feature_76" + 47.83876321069324 * "ADS"."Feature_77" + 136.85907130046593 * "ADS"."Feature_78" + -168.54291510102664 * "ADS"."Feature_79" + -254.98265467016634 * "ADS"."Feature_80" + 569.1225227284016 * "ADS"."Feature_81" + -127.50855769715875 * "ADS"."Feature_82" + 29.361878930901565 * "ADS"."Feature_83" + 66.49028062235892 * "ADS"."Feature_84" + -382.5447318939839 * "ADS"."Feature_85" + -74.49290093264791 * "ADS"."Feature_86" + -118.5301464917904 * "ADS"."Feature_87" + 319.7040700817575 * "ADS"."Feature_88" + 34.11244165308139 * "ADS"."Feature_89" + -27.227133797723972 * "ADS"."Feature_90" + -244.70037398125234 * "ADS"."Feature_91" + -4.1099521187830135 * "ADS"."Feature_92" + 287.41056944124205 * "ADS"."Feature_93" + 12.508572945869895 * "ADS"."Feature_94" + 127.52771441849049 * "ADS"."Feature_95" + 158.11432761721645 * "ADS"."Feature_96" + -165.27896252555058 * "ADS"."Feature_97" + 37.531864953188865 * "ADS"."Feature_98" + -34.292309122068374 * "ADS"."Feature_99" + -445.196011107 AS "Score_2", 310.86925556221405 * "ADS"."Feature_0" + -424.4607460633068 * "ADS"."Feature_1" + 205.7996038277852 * "ADS"."Feature_2" + 119.61563111461473 * "ADS"."Feature_3" + -185.5538269776885 * "ADS"."Feature_4" + -64.11057015998907 * "ADS"."Feature_5" + -90.99868610828624 * "ADS"."Feature_6" + 39.02446141261211 * "ADS"."Feature_7" + -109.41843200589534 * "ADS"."Feature_8" + 198.7684109827152 * "ADS"."Feature_9" + -205.60069131239732 * "ADS"."Feature_10" + 495.083299402822 * "ADS"."Feature_11" + -72.98385094394807 * "ADS"."Feature_12" + 65.63393914699176 * "ADS"."Feature_13" + 146.55733802632562 * "ADS"."Feature_14" + 107.47074769782854 * "ADS"."Feature_15" + 30.566300495113204 * "ADS"."Feature_16" + -16.026980903973033 * "ADS"."Feature_17" + -273.5262358194501 * "ADS"."Feature_18" + 37.82692659133369 * "ADS"."Feature_19" + -94.63373983752425 * "ADS"."Feature_20" + -136.43366899556526 * "ADS"."Feature_21" + -198.26480117013227 * "ADS"."Feature_22" + -114.96693952111819 * "ADS"."Feature_23" + -54.97005658367752 * "ADS"."Feature_24" + -41.19327706882219 * "ADS"."Feature_25" + -3.400826098270595 * "ADS"."Feature_26" + 171.95037795905523 * "ADS"."Feature_27" + 294.4974024743512 * "ADS"."Feature_28" + -88.44326766547363 * "ADS"."Feature_29" + -74.25709540768081 * "ADS"."Feature_30" + 53.917357926519394 * "ADS"."Feature_31" + -214.89963194531765 * "ADS"."Feature_32" + 69.64673172990528 * "ADS"."Feature_33" + -154.77487060960433 * "ADS"."Feature_34" + 27.60912710655989 * "ADS"."Feature_35" + -109.58426899749327 * "ADS"."Feature_36" + -43.65599505560018 * "ADS"."Feature_37" + -90.4052010244165 * "ADS"."Feature_38" + 52.88544140391826 * "ADS"."Feature_39" + -191.92336777898183 * "ADS"."Feature_40" + 239.57566297155563 * "ADS"."Feature_41" + 136.5774713040257 * "ADS"."Feature_42" + 194.22255103266144 * "ADS"."Feature_43" + -15.33370677066617 * "ADS"."Feature_44" + 47.31324467101279 * "ADS"."Feature_45" + 61.40870440727729 * "ADS"."Feature_46" + -77.65268376237985 * "ADS"."Feature_47" + -183.85519176713146 * "ADS"."Feature_48" + 5.437963682195701 * "ADS"."Feature_49" + 64.84429389293311 * "ADS"."Feature_50" + -67.48773104852822 * "ADS"."Feature_51" + 132.81273130317692 * "ADS"."Feature_52" + -68.17480221621511 * "ADS"."Feature_53" + -220.78324321585717 * "ADS"."Feature_54" + -222.42422678866822 * "ADS"."Feature_55" + 29.811248461042393 * "ADS"."Feature_56" + -80.42532601425506 * "ADS"."Feature_57" + 361.82728938385674 * "ADS"."Feature_58" + 76.79700052568516 * "ADS"."Feature_59" + 83.68815770525794 * "ADS"."Feature_60" + -22.753766917342908 * "ADS"."Feature_61" + 83.77812999460414 * "ADS"."Feature_62" + 39.61897710852626 * "ADS"."Feature_63" + -13.659722031362755 * "ADS"."Feature_64" + -27.734368529293878 * "ADS"."Feature_65" + 39.80143602494779 * "ADS"."Feature_66" + -86.47470763341568 * "ADS"."Feature_67" + -86.37815175606146 * "ADS"."Feature_68" + -203.49419435929693 * "ADS"."Feature_69" + 119.71853669809568 * "ADS"."Feature_70" + -216.06479928453805 * "ADS"."Feature_71" + -9.809751716977996 * "ADS"."Feature_72" + -401.3427585077978 * "ADS"."Feature_73" + -128.35010501150347 * "ADS"."Feature_74" + -439.4305959922966 * "ADS"."Feature_75" + -74.42280801770445 * "ADS"."Feature_76" + 101.98876759001236 * "ADS"."Feature_77" + -48.22167392973417 * "ADS"."Feature_78" + 45.69400766297635 * "ADS"."Feature_79" + -244.7142102524051 * "ADS"."Feature_80" + 522.996103391657 * "ADS"."Feature_81" + -147.51944639556424 * "ADS"."Feature_82" + 130.12615450205664 * "ADS"."Feature_83" + -117.8650328072535 * "ADS"."Feature_84" + -26.38891456587272 * "ADS"."Feature_85" + 38.55361450959657 * "ADS"."Feature_86" + 247.6753130161682 * "ADS"."Feature_87" + 260.60981677484915 * "ADS"."Feature_88" + 73.34831352459265 * "ADS"."Feature_89" + 209.92559748679807 * "ADS"."Feature_90" + 1.1503962843725162 * "ADS"."Feature_91" + 68.5606121956605 * "ADS"."Feature_92" + -352.13573899597964 * "ADS"."Feature_93" + 95.20264157380122 * "ADS"."Feature_94" + -69.74826057589587 * "ADS"."Feature_95" + 104.04498083482143 * "ADS"."Feature_96" + 314.5414666313416 * "ADS"."Feature_97" + 11.977890354770738 * "ADS"."Feature_98" + -8.33093978729946 * "ADS"."Feature_99" + -286.919741449 AS "Score_3" 
FROM "FourClass_100" "ADS"), 
orig_cte AS 
(SELECT linear_model_cte."KEY" AS "KEY", linear_model_cte."Score_0" AS "Score_0", linear_model_cte."Score_1" AS "Score_1", linear_model_cte."Score_2" AS "Score_2", linear_model_cte."Score_3" AS "Score_3", CAST(NULL AS FLOAT) AS "Proba_0", CAST(NULL AS FLOAT) AS "Proba_1", CAST(NULL AS FLOAT) AS "Proba_2", CAST(NULL AS FLOAT) AS "Proba_3", CAST(NULL AS FLOAT) AS "LogProba_0", CAST(NULL AS FLOAT) AS "LogProba_1", CAST(NULL AS FLOAT) AS "LogProba_2", CAST(NULL AS FLOAT) AS "LogProba_3", CAST(NULL AS FLOAT) AS "Decision" 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu."KEY" AS "KEY", scu.class AS class, scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY", 0 AS class, orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY", 1 AS class, orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY", 2 AS class, orig_cte."LogProba_2" AS "LogProba", orig_cte."Proba_2" AS "Proba", orig_cte."Score_2" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY", 3 AS class, orig_cte."LogProba_3" AS "LogProba", orig_cte."Proba_3" AS "Proba", orig_cte."Score_3" AS "Score" 
FROM orig_cte) scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Score_2" AS "Score_2", orig_cte."Score_3" AS "Score_3", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."Proba_2" AS "Proba_2", orig_cte."Proba_3" AS "Proba_3", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."LogProba_2" AS "LogProba_2", orig_cte."LogProba_3" AS "LogProba_3", orig_cte."Decision" AS "Decision", (SELECT max(score_class_union."LogProba") AS max_1 
FROM score_class_union 
WHERE orig_cte."KEY" = score_class_union."KEY") AS "max_LogProba", (SELECT max(score_class_union."Proba") AS max_2 
FROM score_class_union 
WHERE orig_cte."KEY" = score_class_union."KEY") AS "max_Proba", (SELECT max(score_class_union."Score") AS max_3 
FROM score_class_union 
WHERE orig_cte."KEY" = score_class_union."KEY") AS "max_Score" 
FROM orig_cte), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."max_LogProba" AS "max_LogProba", score_max."max_Proba" AS "max_Proba", score_max."max_Score" AS "max_Score", (SELECT min(score_class_union.class) AS min_1 
FROM score_class_union 
WHERE score_max."max_LogProba" = score_class_union."LogProba" AND score_max."KEY" = score_class_union."KEY") AS "arg_max_LogProba", (SELECT min(score_class_union.class) AS min_2 
FROM score_class_union 
WHERE score_max."max_Proba" = score_class_union."Proba" AND score_max."KEY" = score_class_union."KEY") AS "arg_max_Proba", (SELECT min(score_class_union.class) AS min_3 
FROM score_class_union 
WHERE score_max."max_Score" = score_class_union."Score" AND score_max."KEY" = score_class_union."KEY") AS "arg_max_Score" 
FROM score_max)
 SELECT arg_max_cte."KEY" AS "KEY", arg_max_cte."Score_0" AS "Score_0", arg_max_cte."Score_1" AS "Score_1", arg_max_cte."Score_2" AS "Score_2", arg_max_cte."Score_3" AS "Score_3", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", arg_max_cte."Proba_2" AS "Proba_2", arg_max_cte."Proba_3" AS "Proba_3", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN ln(arg_max_cte."Proba_0") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN ln(arg_max_cte."Proba_1") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_1", CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN ln(arg_max_cte."Proba_2") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_2", CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN ln(arg_max_cte."Proba_3") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_3", arg_max_cte."arg_max_Score" AS "Decision" 
FROM arg_max_cte