-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "SV_data" AS 
(SELECT "Values".sv_idx AS sv_idx, "Values".dual_coeff AS dual_coeff, "Values".sv_0 AS sv_0, "Values".sv_1 AS sv_1, "Values".sv_2 AS sv_2, "Values".sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, 0.499619724598 AS dual_coeff, 73.6877830401 AS sv_0, 321.312899426 AS sv_1, 0.732219561479 AS sv_2, 5.67583639781 AS sv_3 UNION ALL SELECT 1 AS sv_idx, -1.0 AS dual_coeff, 17.0060517661 AS sv_0, 431.184347726 AS sv_1, 0.354649671922 AS sv_2, 3.71906382589 AS sv_3 UNION ALL SELECT 2 AS sv_idx, -0.0844611685349 AS dual_coeff, 1.92901776316 AS sv_0, 342.713504944 AS sv_1, 0.342232233791 AS sv_2, 7.24714556995 AS sv_3 UNION ALL SELECT 3 AS sv_idx, 1.0 AS dual_coeff, 25.8881748996 AS sv_0, 448.873686856 AS sv_1, 0.992928303259 AS sv_2, 4.51432004277 AS sv_3 UNION ALL SELECT 4 AS sv_idx, -0.69628370772 AS dual_coeff, 41.8956889429 AS sv_0, 182.624864824 AS sv_1, 0.109152254288 AS sv_2, 5.58982889929 AS sv_3 UNION ALL SELECT 5 AS sv_idx, 1.0 AS dual_coeff, 27.3041174476 AS sv_0, 288.107521922 AS sv_1, 0.910874928845 AS sv_2, 4.19490342371 AS sv_3 UNION ALL SELECT 6 AS sv_idx, 1.0 AS dual_coeff, 82.1904652695 AS sv_0, 1614.19355858 AS sv_1, 0.977498016641 AS sv_2, 5.74598643906 AS sv_3 UNION ALL SELECT 7 AS sv_idx, -1.0 AS dual_coeff, 18.012072813 AS sv_0, 1126.20721243 AS sv_1, 0.387265258343 AS sv_2, 3.11310222213 AS sv_3 UNION ALL SELECT 8 AS sv_idx, -1.0 AS dual_coeff, 54.6582367061 AS sv_0, 250.494519252 AS sv_1, 0.26692157305 AS sv_2, 3.60518492689 AS sv_3 UNION ALL SELECT 9 AS sv_idx, 1.0 AS dual_coeff, 23.8653997029 AS sv_0, 209.929709605 AS sv_1, 0.904928413508 AS sv_2, 3.47465988853 AS sv_3 UNION ALL SELECT 10 AS sv_idx, -0.729774552669 AS dual_coeff, 45.9295024726 AS sv_0, 700.688886626 AS sv_1, 0.0271338732141 AS sv_2, 1.70676450154 AS sv_3 UNION ALL SELECT 11 AS sv_idx, 1.0 AS dual_coeff, 0.885046360759 AS sv_0, 1074.86680053 AS sv_1, 0.728003183349 AS sv_2, 3.6493895376 AS sv_3 UNION ALL SELECT 12 AS sv_idx, 1.0 AS dual_coeff, 55.8768141444 AS sv_0, 1079.58290524 AS sv_1, 0.824459540035 AS sv_2, 7.08807010239 AS sv_3 UNION ALL SELECT 13 AS sv_idx, -0.100634556245 AS dual_coeff, 36.013269487 AS sv_0, 746.60069074 AS sv_1, 0.023191847143 AS sv_2, 9.24426613452 AS sv_3 UNION ALL SELECT 14 AS sv_idx, 1.0 AS dual_coeff, 74.9872674059 AS sv_0, 1362.52621142 AS sv_1, 0.988705105924 AS sv_2, 1.51142766642 AS sv_3 UNION ALL SELECT 15 AS sv_idx, -1.0 AS dual_coeff, 16.0477973522 AS sv_0, 1325.17164881 AS sv_1, 0.0975533552009 AS sv_2, 9.47530251531 AS sv_3 UNION ALL SELECT 16 AS sv_idx, -0.0577415960861 AS dual_coeff, 97.4868552797 AS sv_0, 753.859764972 AS sv_1, 0.0405459368878 AS sv_2, 8.53652611828 AS sv_3 UNION ALL SELECT 17 AS sv_idx, 1.0 AS dual_coeff, 18.0251797828 AS sv_0, 1680.79770198 AS sv_1, 0.410705159295 AS sv_2, 9.61552451909 AS sv_3 UNION ALL SELECT 18 AS sv_idx, 1.0 AS dual_coeff, 5.10834587455 AS sv_0, 469.501908532 AS sv_1, 0.971462170445 AS sv_2, 8.17963623862 AS sv_3 UNION ALL SELECT 19 AS sv_idx, 0.226626751217 AS dual_coeff, 85.0108889929 AS sv_0, 313.609794007 AS sv_1, 0.552355663428 AS sv_2, 6.11606384358 AS sv_3 UNION ALL SELECT 20 AS sv_idx, 0.108045573516 AS dual_coeff, 47.8831249 AS sv_0, 428.174473012 AS sv_1, 0.868217167327 AS sv_2, 8.39629866468 AS sv_3 UNION ALL SELECT 21 AS sv_idx, -1.0 AS dual_coeff, 41.2120698151 AS sv_0, 1706.82481663 AS sv_1, 0.0277269211761 AS sv_2, 8.609455417 AS sv_3 UNION ALL SELECT 22 AS sv_idx, 1.0 AS dual_coeff, 2.66099591787 AS sv_0, 667.648811785 AS sv_1, 0.865888292666 AS sv_2, 3.81279411525 AS sv_3 UNION ALL SELECT 23 AS sv_idx, -1.0 AS dual_coeff, 14.9445558649 AS sv_0, 1078.02803397 AS sv_1, 0.0275775030695 AS sv_2, 3.4988022137 AS sv_3 UNION ALL SELECT 24 AS sv_idx, 1.0 AS dual_coeff, 6.53462831571 AS sv_0, 1395.67855747 AS sv_1, 0.895653544781 AS sv_2, 6.54923134366 AS sv_3 UNION ALL SELECT 25 AS sv_idx, -0.0279224733761 AS dual_coeff, 34.9457276446 AS sv_0, 1176.75783118 AS sv_1, 0.332830955034 AS sv_2, 2.51827996939 AS sv_3 UNION ALL SELECT 26 AS sv_idx, -1.0 AS dual_coeff, 40.1662794158 AS sv_0, 1225.70417771 AS sv_1, 0.116318860993 AS sv_2, 3.59063766396 AS sv_3 UNION ALL SELECT 27 AS sv_idx, -0.904896617604 AS dual_coeff, 18.0225485681 AS sv_0, 326.743060709 AS sv_1, 0.283696419352 AS sv_2, 9.63778701139 AS sv_3 UNION ALL SELECT 28 AS sv_idx, 1.0 AS dual_coeff, 49.1175614592 AS sv_0, 613.681128689 AS sv_1, 0.980348049814 AS sv_2, 2.49468823203 AS sv_3 UNION ALL SELECT 29 AS sv_idx, -1.0 AS dual_coeff, 45.5536730631 AS sv_0, 1415.33120686 AS sv_1, 0.228169318348 AS sv_2, 10.4984126628 AS sv_3 UNION ALL SELECT 30 AS sv_idx, -0.853255251625 AS dual_coeff, 25.938279646 AS sv_0, 462.58181531 AS sv_1, 0.833143478455 AS sv_2, 10.1702656506 AS sv_3 UNION ALL SELECT 31 AS sv_idx, 1.0 AS dual_coeff, 38.8265942741 AS sv_0, 1444.83303331 AS sv_1, 0.648222906474 AS sv_2, 10.3688729523 AS sv_3 UNION ALL SELECT 32 AS sv_idx, 1.0 AS dual_coeff, 22.2286394593 AS sv_0, 1700.00372351 AS sv_1, 0.732956036643 AS sv_2, 1.96240003602 AS sv_3 UNION ALL SELECT 33 AS sv_idx, -1.0 AS dual_coeff, 68.8823180335 AS sv_0, 1162.80206978 AS sv_1, 0.0774542022676 AS sv_2, 8.49372658448 AS sv_3 UNION ALL SELECT 34 AS sv_idx, -1.0 AS dual_coeff, 86.1703029182 AS sv_0, 1551.67052487 AS sv_1, 0.0889076881734 AS sv_2, 3.78372569778 AS sv_3 UNION ALL SELECT 35 AS sv_idx, -1.0 AS dual_coeff, 62.1961279537 AS sv_0, 329.719432383 AS sv_1, 0.201705343666 AS sv_2, 7.87791762571 AS sv_3 UNION ALL SELECT 36 AS sv_idx, -1.0 AS dual_coeff, 39.1709652998 AS sv_0, 399.684922235 AS sv_1, 0.193186948024 AS sv_2, 2.20276615196 AS sv_3 UNION ALL SELECT 37 AS sv_idx, 1.0 AS dual_coeff, 20.1808839734 AS sv_0, 184.192660697 AS sv_1, 0.864533404514 AS sv_2, 3.00096058593 AS sv_3 UNION ALL SELECT 38 AS sv_idx, 1.0 AS dual_coeff, 69.2265328981 AS sv_0, 138.280247185 AS sv_1, 0.929664126293 AS sv_2, 7.9731497377 AS sv_3 UNION ALL SELECT 39 AS sv_idx, -0.0507564399255 AS dual_coeff, 36.2960589759 AS sv_0, 1655.03562224 AS sv_1, 0.396968432604 AS sv_2, 7.23663308953 AS sv_3 UNION ALL SELECT 40 AS sv_idx, 1.0 AS dual_coeff, 65.9158505388 AS sv_0, 1593.85965018 AS sv_1, 0.974149146063 AS sv_2, 7.18081818298 AS sv_3 UNION ALL SELECT 41 AS sv_idx, -1.0 AS dual_coeff, 28.2454625178 AS sv_0, 1559.93593476 AS sv_1, 0.141193283957 AS sv_2, 2.1613995623 AS sv_3 UNION ALL SELECT 42 AS sv_idx, 1.0 AS dual_coeff, 12.5938148006 AS sv_0, 394.576761645 AS sv_1, 0.972797495862 AS sv_2, 5.3911032798 AS sv_3 UNION ALL SELECT 43 AS sv_idx, 1.0 AS dual_coeff, 94.3424007467 AS sv_0, 1156.71869518 AS sv_1, 0.568731402945 AS sv_2, 2.39745596641 AS sv_3 UNION ALL SELECT 44 AS sv_idx, -0.298140032825 AS dual_coeff, 33.8316156685 AS sv_0, 688.448835445 AS sv_1, 0.322003555762 AS sv_2, 9.62657096372 AS sv_3 UNION ALL SELECT 45 AS sv_idx, -0.41202146413 AS dual_coeff, 73.8870593153 AS sv_0, 1503.35651997 AS sv_1, 0.384785823689 AS sv_2, 5.28181554822 AS sv_3 UNION ALL SELECT 46 AS sv_idx, 1.0 AS dual_coeff, 77.9157229274 AS sv_0, 339.564847725 AS sv_1, 0.880037463952 AS sv_2, 4.14743491426 AS sv_3 UNION ALL SELECT 47 AS sv_idx, 1.0 AS dual_coeff, 95.8980947186 AS sv_0, 1307.8902612 AS sv_1, 0.929154431436 AS sv_2, 10.7976245385 AS sv_3 UNION ALL SELECT 48 AS sv_idx, -0.480555103137 AS dual_coeff, 55.1367875243 AS sv_0, 1413.06595226 AS sv_1, 0.501385160128 AS sv_2, 1.51184582228 AS sv_3 UNION ALL SELECT 49 AS sv_idx, -0.225420060322 AS dual_coeff, 10.3045093082 AS sv_0, 185.973329261 AS sv_1, 0.0150999484131 AS sv_2, 8.47919542892 AS sv_3 UNION ALL SELECT 50 AS sv_idx, -1.0 AS dual_coeff, 21.2947175928 AS sv_0, 614.155575182 AS sv_1, 0.522644053199 AS sv_2, 3.61858645698 AS sv_3 UNION ALL SELECT 51 AS sv_idx, -0.742099871775 AS dual_coeff, 55.0968002343 AS sv_0, 292.072548305 AS sv_1, 0.598234685686 AS sv_2, 9.05935250691 AS sv_3 UNION ALL SELECT 52 AS sv_idx, -1.0 AS dual_coeff, 66.8283830509 AS sv_0, 350.177020374 AS sv_1, 0.243622959405 AS sv_2, 6.6003785152 AS sv_3 UNION ALL SELECT 53 AS sv_idx, -1.0 AS dual_coeff, 71.2010648795 AS sv_0, 1468.88588546 AS sv_1, 0.298475243263 AS sv_2, 1.85869977026 AS sv_3 UNION ALL SELECT 54 AS sv_idx, -0.170329153356 AS dual_coeff, 92.1432972788 AS sv_0, 529.217806631 AS sv_1, 0.354008800477 AS sv_2, 7.58348379657 AS sv_3) AS "Values"), 
kernel_cte AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(full_join_data_sv.dot_prod1) + -598.578288413 AS dot_product 
FROM (SELECT "ADS"."KEY" AS "KEY", "SV_data".dual_coeff * ("ADS"."Feature_0" * "SV_data".sv_0 + "ADS"."Feature_1" * "SV_data".sv_1 + "ADS"."Feature_2" * "SV_data".sv_2 + "ADS"."Feature_3" * "SV_data".sv_3) AS dot_prod1 
FROM freidman2 AS "ADS", "SV_data") AS full_join_data_sv GROUP BY full_join_data_sv."KEY") AS t)
 SELECT kernel_cte."KEY" AS "KEY", kernel_cte.dot_product AS "Estimator" 
FROM kernel_cte