-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "ADS_imp_1_OUT" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 52.0714332243 ELSE "ADS"."Feature_0" END AS imputer_output_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 971.198642871 ELSE "ADS"."Feature_1" END AS imputer_output_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 0.517042404748 ELSE "ADS"."Feature_2" END AS imputer_output_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 5.46988604786 ELSE "ADS"."Feature_3" END AS imputer_output_5 
FROM freidman3 AS "ADS"), 
"ADS_sca_2_OUT" AS 
(SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".imputer_output_2 AS FLOAT) - 52.0714332243) / 26.7411007031 AS scaler_output_2, (CAST("ADS_imp_1_OUT".imputer_output_3 AS FLOAT) - 971.198642871) / 455.131846079 AS scaler_output_3, (CAST("ADS_imp_1_OUT".imputer_output_4 AS FLOAT) - 0.517042404748) / 0.293695670254 AS scaler_output_4, (CAST("ADS_imp_1_OUT".imputer_output_5 AS FLOAT) - 5.46988604786) / 2.98233938414 AS scaler_output_5 
FROM "ADS_imp_1_OUT"), 
"SV_data" AS 
(SELECT "Values".sv_idx AS sv_idx, "Values".dual_coeff AS dual_coeff, "Values".sv_0 AS sv_0, "Values".sv_1 AS sv_1, "Values".sv_2 AS sv_2, "Values".sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, 1.0 AS dual_coeff, 1.15577024629 AS sv_0, 1.33195864307 AS sv_1, -0.922228950404 AS sv_2, -1.10066599835 AS sv_3 UNION ALL SELECT 1 AS sv_idx, -1.0 AS dual_coeff, 0.307472040477 AS sv_0, -1.31586993411 AS sv_1, -1.6313143946 AS sv_2, 0.64470693933 AS sv_3 UNION ALL SELECT 2 AS sv_idx, 1.0 AS dual_coeff, -1.77926593189 AS sv_0, -1.02845603131 AS sv_1, -0.235442145205 AS sv_2, 0.699910913174 AS sv_3 UNION ALL SELECT 3 AS sv_idx, 1.0 AS dual_coeff, -1.81590069861 AS sv_0, -0.475788983962 AS sv_1, -0.235303117769 AS sv_2, 1.81523693899 AS sv_3 UNION ALL SELECT 4 AS sv_idx, 0.246472946614 AS dual_coeff, 0.723632668448 AS sv_0, 1.11866613219 AS sv_1, -0.597924100644 AS sv_2, -0.999325324464 AS sv_3 UNION ALL SELECT 5 AS sv_idx, 0.0376010445126 AS dual_coeff, 0.415309910528 AS sv_0, 0.123751401801 AS sv_1, 0.117202072914 AS sv_2, 0.600909799267 AS sv_3 UNION ALL SELECT 6 AS sv_idx, -1.0 AS dual_coeff, -1.51965586452 AS sv_0, -1.20736879822 AS sv_1, -1.65352436718 AS sv_2, -0.921695545564 AS sv_3 UNION ALL SELECT 7 AS sv_idx, 1.0 AS dual_coeff, -1.82927168103 AS sv_0, -0.877254838985 AS sv_1, -1.57432404857 AS sv_2, -0.870747770828 AS sv_3 UNION ALL SELECT 8 AS sv_idx, 1.0 AS dual_coeff, -1.16801528107 AS sv_0, 0.319190510775 AS sv_1, -1.02955792614 AS sv_2, -0.996033532824 AS sv_3 UNION ALL SELECT 9 AS sv_idx, -1.0 AS dual_coeff, -0.19525604275 AS sv_0, 1.42830619485 AS sv_1, 1.5866880397 AS sv_2, -1.41241298948 AS sv_3 UNION ALL SELECT 10 AS sv_idx, -0.0603171580119 AS dual_coeff, -0.392880856513 AS sv_0, -1.75904816228 AS sv_1, 0.122616764678 AS sv_2, -0.76238497095 AS sv_3 UNION ALL SELECT 11 AS sv_idx, 0.072868702061 AS dual_coeff, 0.626201190566 AS sv_0, -0.54041744441 AS sv_1, -0.195315879021 AS sv_2, -0.198745248786 AS sv_3 UNION ALL SELECT 12 AS sv_idx, -0.267344854341 AS dual_coeff, 1.78232423444 AS sv_0, -0.373358843896 AS sv_1, -1.26922963395 AS sv_2, -1.48924515508 AS sv_3 UNION ALL SELECT 13 AS sv_idx, -1.0 AS dual_coeff, -0.52615296223 AS sv_0, 1.10210033782 AS sv_1, 1.20136698629 AS sv_2, -0.807305226754 AS sv_3 UNION ALL SELECT 14 AS sv_idx, 0.124409044282 AS dual_coeff, -0.0156688461017 AS sv_0, 1.12347545082 AS sv_1, -0.0952978500914 AS sv_2, 1.38529312639 AS sv_3 UNION ALL SELECT 15 AS sv_idx, -0.58745309263 AS dual_coeff, 0.210535483358 AS sv_0, -1.67235913715 AS sv_1, -0.496746287988 AS sv_2, 1.30751974191 AS sv_3 UNION ALL SELECT 16 AS sv_idx, 0.176110922262 AS dual_coeff, -0.410209791838 AS sv_0, 0.578182048284 AS sv_1, -1.00670292415 AS sv_2, -0.559345444441 AS sv_3 UNION ALL SELECT 17 AS sv_idx, -1.0 AS dual_coeff, -0.281243877342 AS sv_0, -0.133213130448 AS sv_1, -1.70728836853 AS sv_2, -1.06769804824 AS sv_3 UNION ALL SELECT 18 AS sv_idx, 1.0 AS dual_coeff, 1.74255766236 AS sv_0, 1.21302196307 AS sv_1, -0.583742142014 AS sv_2, 0.913820007702 AS sv_3 UNION ALL SELECT 19 AS sv_idx, 0.252012135997 AS dual_coeff, -0.319142268563 AS sv_0, 0.547244556361 AS sv_1, -0.0322672201004 AS sv_2, 1.49896332114 AS sv_3 UNION ALL SELECT 20 AS sv_idx, -1.0 AS dual_coeff, 0.0844844226964 AS sv_0, 0.838677461395 AS sv_1, -1.56229950355 AS sv_2, 1.22436939801 AS sv_3 UNION ALL SELECT 21 AS sv_idx, -1.0 AS dual_coeff, 0.563019112826 AS sv_0, -0.678101773502 AS sv_1, -1.43939724385 AS sv_2, 1.27735587037 AS sv_3 UNION ALL SELECT 22 AS sv_idx, 0.842970737313 AS dual_coeff, 0.927726034274 AS sv_0, -0.79106447737 AS sv_1, 0.326340570346 AS sv_2, 0.87260344311 AS sv_3 UNION ALL SELECT 23 AS sv_idx, -1.0 AS dual_coeff, -0.155846573999 AS sv_0, -1.11925630734 AS sv_1, -1.64774245557 AS sv_2, 1.79001442819 AS sv_3 UNION ALL SELECT 24 AS sv_idx, 0.030136989858 AS dual_coeff, 1.67774615928 AS sv_0, -0.448797695668 AS sv_1, 1.10055753889 AS sv_2, -0.570272575969 AS sv_3 UNION ALL SELECT 25 AS sv_idx, 0.0125218024488 AS dual_coeff, -1.54864607257 AS sv_0, 1.26113811644 AS sv_1, -0.746525735075 AS sv_2, 0.501291576438 AS sv_3 UNION ALL SELECT 26 AS sv_idx, -1.0 AS dual_coeff, -0.526560284586 AS sv_0, 1.59650619712 AS sv_1, 1.35935903296 AS sv_2, 1.07606664956 AS sv_3 UNION ALL SELECT 27 AS sv_idx, 0.234493910461 AS dual_coeff, 1.40019211972 AS sv_0, -0.854340483005 AS sv_1, -0.433953505129 AS sv_2, -1.12078557598 AS sv_3 UNION ALL SELECT 28 AS sv_idx, 0.284741203988 AS dual_coeff, -0.0319426328262 AS sv_0, -0.411215452892 AS sv_1, -0.0170640658753 AS sv_2, 0.830607022835 AS sv_3 UNION ALL SELECT 29 AS sv_idx, 0.600775665187 AS dual_coeff, 1.04000808001 AS sv_0, -0.19854929879 AS sv_1, -0.178563613044 AS sv_2, -1.44951882389 AS sv_3 UNION ALL SELECT 30 AS sv_idx, 1.0 AS dual_coeff, 0.0391719531831 AS sv_0, -0.575787220856 AS sv_1, -1.08633679873 AS sv_2, 1.61600835934 AS sv_3) AS "Values"), 
kernel_cte AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(full_join_data_sv.dot_prod1) + 1.38550885901 AS dot_product 
FROM (SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", "SV_data".dual_coeff * ("ADS_sca_2_OUT".scaler_output_2 * "SV_data".sv_0 + "ADS_sca_2_OUT".scaler_output_3 * "SV_data".sv_1 + "ADS_sca_2_OUT".scaler_output_4 * "SV_data".sv_2 + "ADS_sca_2_OUT".scaler_output_5 * "SV_data".sv_3) AS dot_prod1 
FROM "ADS_sca_2_OUT", "SV_data") AS full_join_data_sv GROUP BY full_join_data_sv."KEY") AS t)
 SELECT kernel_cte."KEY" AS "KEY", kernel_cte.dot_product AS "Estimator" 
FROM kernel_cte