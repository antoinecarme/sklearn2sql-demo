-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 51.6899578023 ELSE `ADS`.`Feature_0` END AS imputer_output_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 934.458217081 ELSE `ADS`.`Feature_1` END AS imputer_output_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 0.507565475553 ELSE `ADS`.`Feature_2` END AS imputer_output_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 6.08937985718 ELSE `ADS`.`Feature_3` END AS imputer_output_5 
FROM freidman2 AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.imputer_output_2 AS DOUBLE) - 51.6899578023) / 26.9907384983 AS scaler_output_2, (CAST(`ADS_imp_1_OUT`.imputer_output_3 AS DOUBLE) - 934.458217081) / 424.693043116 AS scaler_output_3, (CAST(`ADS_imp_1_OUT`.imputer_output_4 AS DOUBLE) - 0.507565475553) / 0.302492988295 AS scaler_output_4, (CAST(`ADS_imp_1_OUT`.imputer_output_5 AS DOUBLE) - 6.08937985718) / 3.02383323525 AS scaler_output_5 
FROM `ADS_imp_1_OUT`), 
`SV_data` AS 
(SELECT `Values`.sv_idx AS sv_idx, `Values`.dual_coeff AS dual_coeff, `Values`.sv_0 AS sv_0, `Values`.sv_1 AS sv_1, `Values`.sv_2 AS sv_2, `Values`.sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, 1.0 AS dual_coeff, 0.432753341246 AS sv_0, 0.10717392693 AS sv_1, 0.331500033883 AS sv_2, -1.20495670338 AS sv_3 UNION ALL SELECT 1 AS sv_idx, 1.0 AS dual_coeff, 1.59296041495 AS sv_0, -0.483715264357 AS sv_1, 0.188452000775 AS sv_2, 0.20119205936 AS sv_3 UNION ALL SELECT 2 AS sv_idx, 1.0 AS dual_coeff, -1.13129282104 AS sv_0, 0.258948814641 AS sv_1, 1.4594055075 AS sv_2, 0.336988331101 AS sv_3 UNION ALL SELECT 3 AS sv_idx, -1.0 AS dual_coeff, 0.159503486645 AS sv_0, -0.453884953992 AS sv_1, -1.67718373096 AS sv_2, -0.228811903024 AS sv_3 UNION ALL SELECT 4 AS sv_idx, -1.0 AS dual_coeff, -0.319224786172 AS sv_0, -0.683607530787 AS sv_1, -1.4365368925 AS sv_2, -1.01586035023 AS sv_3 UNION ALL SELECT 5 AS sv_idx, 1.0 AS dual_coeff, 0.941137704088 AS sv_0, 0.82953874169 AS sv_1, 1.50510301526 AS sv_2, -1.55209769414 AS sv_3 UNION ALL SELECT 6 AS sv_idx, -1.0 AS dual_coeff, 1.19257109343 AS sv_0, -1.67625888513 AS sv_1, -1.18145799974 AS sv_2, -1.08813515861 AS sv_3 UNION ALL SELECT 7 AS sv_idx, 1.0 AS dual_coeff, -1.31621565817 AS sv_0, -0.0590968677254 AS sv_1, 0.923453740167 AS sv_2, -0.390250426064 AS sv_3 UNION ALL SELECT 8 AS sv_idx, 1.0 AS dual_coeff, 0.0556654742274 AS sv_0, 1.65025851273 AS sv_1, -0.126892429973 AS sv_2, -1.66478339603 AS sv_3 UNION ALL SELECT 9 AS sv_idx, 1.0 AS dual_coeff, -1.25388349227 AS sv_0, 0.84815934985 AS sv_1, 0.719812613732 AS sv_2, 1.2237741578 AS sv_3 UNION ALL SELECT 10 AS sv_idx, 1.0 AS dual_coeff, -1.45474947219 AS sv_0, 1.91973710931 AS sv_1, 1.31944586484 AS sv_2, 0.890027803592 AS sv_3 UNION ALL SELECT 11 AS sv_idx, 1.0 AS dual_coeff, 0.263446454557 AS sv_0, 0.49697385061 AS sv_1, -0.235910410588 AS sv_2, 0.823685624006 AS sv_3 UNION ALL SELECT 12 AS sv_idx, -1.0 AS dual_coeff, -0.765893896786 AS sv_0, 1.37746030037 AS sv_1, -0.8348982013 AS sv_2, 0.47565120678 AS sv_3 UNION ALL SELECT 13 AS sv_idx, -1.0 AS dual_coeff, -0.139851877381 AS sv_0, 1.755084883 AS sv_1, -1.0595358127 AS sv_2, 1.53839843224 AS sv_3 UNION ALL SELECT 14 AS sv_idx, 1.0 AS dual_coeff, 1.40582369309 AS sv_0, 0.291765928168 AS sv_1, 0.149377036825 AS sv_2, 0.927915426287 AS sv_3 UNION ALL SELECT 15 AS sv_idx, 1.0 AS dual_coeff, -1.42110783858 AS sv_0, 0.198703079918 AS sv_1, 0.830868808573 AS sv_2, 0.488722557844 AS sv_3 UNION ALL SELECT 16 AS sv_idx, -1.0 AS dual_coeff, -0.231293562195 AS sv_0, -0.408143794029 AS sv_1, -1.12297552887 AS sv_2, 0.451835511946 AS sv_3 UNION ALL SELECT 17 AS sv_idx, -1.0 AS dual_coeff, -0.176831561645 AS sv_0, 1.85305117061 AS sv_1, -1.08184978541 AS sv_2, -1.65352871539 AS sv_3 UNION ALL SELECT 18 AS sv_idx, 1.0 AS dual_coeff, 0.0515037959637 AS sv_0, -0.767813131857 AS sv_1, 1.54596258105 AS sv_2, 1.51618564099 AS sv_3 UNION ALL SELECT 19 AS sv_idx, 1.0 AS dual_coeff, 0.525289348628 AS sv_0, 0.422673613675 AS sv_1, -0.106899176748 AS sv_2, 1.43987518048 AS sv_3 UNION ALL SELECT 20 AS sv_idx, -1.0 AS dual_coeff, 0.706525069888 AS sv_0, 0.394259872937 AS sv_1, -0.589855012809 AS sv_2, -1.58030509974 AS sv_3 UNION ALL SELECT 21 AS sv_idx, -1.0 AS dual_coeff, -0.566436102529 AS sv_0, -0.0625528038561 AS sv_1, -1.36507237597 AS sv_2, -0.82528602793 AS sv_3 UNION ALL SELECT 22 AS sv_idx, -1.0 AS dual_coeff, -1.28210033281 AS sv_0, -1.43080140204 AS sv_1, -0.0550211900965 AS sv_2, 1.19180661303 AS sv_3 UNION ALL SELECT 23 AS sv_idx, -1.0 AS dual_coeff, -1.56499081157 AS sv_0, -0.685084299453 AS sv_1, -0.384605319337 AS sv_2, 1.20971775892 AS sv_3 UNION ALL SELECT 24 AS sv_idx, 1.0 AS dual_coeff, 0.502068580975 AS sv_0, 1.72194715235 AS sv_1, 1.56075824589 AS sv_2, -0.339737297889 AS sv_3 UNION ALL SELECT 25 AS sv_idx, 1.0 AS dual_coeff, 1.76154965062 AS sv_0, 1.18189370098 AS sv_1, 1.58944201589 AS sv_2, 1.58668187911 AS sv_3 UNION ALL SELECT 26 AS sv_idx, -1.0 AS dual_coeff, 1.27472348325 AS sv_0, -0.176555798371 AS sv_1, -1.57983925752 AS sv_2, 1.51942486105 AS sv_3 UNION ALL SELECT 27 AS sv_idx, -1.0 AS dual_coeff, -0.868262416691 AS sv_0, -0.230819311388 AS sv_1, -0.370420648087 AS sv_2, 0.992320430078 AS sv_3 UNION ALL SELECT 28 AS sv_idx, -1.0 AS dual_coeff, 1.27407143203 AS sv_0, 1.49753922511 AS sv_1, -1.49484913975 AS sv_2, -0.88997825788 AS sv_3 UNION ALL SELECT 29 AS sv_idx, 1.0 AS dual_coeff, 0.453549428765 AS sv_0, 0.835083804213 AS sv_1, 1.20337661651 AS sv_2, -1.03881158619 AS sv_3 UNION ALL SELECT 30 AS sv_idx, -1.0 AS dual_coeff, -0.424490862932 AS sv_0, -1.41904675657 AS sv_1, -1.27243799195 AS sv_2, -1.31520896893 AS sv_3 UNION ALL SELECT 31 AS sv_idx, -1.0 AS dual_coeff, 1.57388787493 AS sv_0, -1.20817036902 AS sv_1, -1.00464140452 AS sv_2, -1.17208589688 AS sv_3 UNION ALL SELECT 32 AS sv_idx, -1.0 AS dual_coeff, -1.90737816512 AS sv_0, -0.472196405529 AS sv_1, -1.02561327108 AS sv_2, 1.03448120447 AS sv_3 UNION ALL SELECT 33 AS sv_idx, 1.0 AS dual_coeff, 0.168168824373 AS sv_0, 0.673375432652 AS sv_1, -0.387313309841 AS sv_2, -0.435839966775 AS sv_3 UNION ALL SELECT 34 AS sv_idx, 1.0 AS dual_coeff, -1.69238995001 AS sv_0, 0.620852522936 AS sv_1, 0.266969828213 AS sv_2, -0.836847591667 AS sv_3 UNION ALL SELECT 35 AS sv_idx, -1.0 AS dual_coeff, -0.37089116937 AS sv_0, -1.10543720891 AS sv_1, 0.506847460716 AS sv_2, 0.258182321385 AS sv_3 UNION ALL SELECT 36 AS sv_idx, 1.0 AS dual_coeff, 1.50602657747 AS sv_0, -0.670336846258 AS sv_1, 0.438986899889 AS sv_2, 0.407149229156 AS sv_3 UNION ALL SELECT 37 AS sv_idx, 1.0 AS dual_coeff, 0.642266316953 AS sv_0, 0.240298588529 AS sv_1, 0.571429874289 AS sv_2, -0.526257957484 AS sv_3 UNION ALL SELECT 38 AS sv_idx, -1.0 AS dual_coeff, 0.567734200708 AS sv_0, 0.131019717881 AS sv_1, -1.48169799354 AS sv_2, -0.547010524017 AS sv_3 UNION ALL SELECT 39 AS sv_idx, 1.0 AS dual_coeff, 1.51492566036 AS sv_0, 0.506698741844 AS sv_1, -0.267937709791 AS sv_2, -1.58560008672 AS sv_3 UNION ALL SELECT 40 AS sv_idx, 1.0 AS dual_coeff, 0.474141440008 AS sv_0, 1.60813258344 AS sv_1, 1.60569879318 AS sv_2, -1.00554246486 AS sv_3 UNION ALL SELECT 41 AS sv_idx, 1.0 AS dual_coeff, -0.121726316963 AS sv_0, -0.973586226236 AS sv_1, 1.59578668344 AS sv_2, -0.408796676678 AS sv_3 UNION ALL SELECT 42 AS sv_idx, 1.0 AS dual_coeff, -1.16883845192 AS sv_0, -0.321100303584 AS sv_1, 0.924439551412 AS sv_2, 0.258186083331 AS sv_3 UNION ALL SELECT 43 AS sv_idx, -1.0 AS dual_coeff, 0.121331564913 AS sv_0, -1.49804955754 AS sv_1, 0.871506640633 AS sv_2, 1.11101752294 AS sv_3 UNION ALL SELECT 44 AS sv_idx, -1.0 AS dual_coeff, -1.37224534253 AS sv_0, -0.674828167826 AS sv_1, -0.907593159759 AS sv_2, 1.4779458445 AS sv_3 UNION ALL SELECT 45 AS sv_idx, -1.0 AS dual_coeff, 1.43533781784 AS sv_0, -1.49768290833 AS sv_1, 0.13069214565 AS sv_2, -0.922359814829 AS sv_3 UNION ALL SELECT 46 AS sv_idx, -1.0 AS dual_coeff, 1.77365453044 AS sv_0, -1.60579733491 AS sv_1, -1.19568197423 AS sv_2, -0.269665994712 AS sv_3 UNION ALL SELECT 47 AS sv_idx, 1.0 AS dual_coeff, -0.168046710471 AS sv_0, -0.263913960407 AS sv_1, 1.04857736442 AS sv_2, -1.33757660135 AS sv_3 UNION ALL SELECT 48 AS sv_idx, -1.0 AS dual_coeff, -1.2024919393 AS sv_0, -1.87376671472 AS sv_1, 0.460717866657 AS sv_2, 0.970120305972 AS sv_3 UNION ALL SELECT 49 AS sv_idx, -1.0 AS dual_coeff, 1.1306631084 AS sv_0, -1.20494426586 AS sv_1, 1.28055116986 AS sv_2, -0.984511240767 AS sv_3 UNION ALL SELECT 50 AS sv_idx, 1.0 AS dual_coeff, -0.702751578854 AS sv_0, 1.14671177253 AS sv_1, -0.206862040697 AS sv_2, 0.136023010698 AS sv_3 UNION ALL SELECT 51 AS sv_idx, -1.0 AS dual_coeff, -0.295076685409 AS sv_0, 1.29326128815 AS sv_1, -1.1198747581 AS sv_2, 0.221202568312 AS sv_3 UNION ALL SELECT 52 AS sv_idx, 1.0 AS dual_coeff, -1.10525392703 AS sv_0, 0.226633288126 AS sv_1, 1.47893778821 AS sv_2, 0.952457493321 AS sv_3 UNION ALL SELECT 53 AS sv_idx, 1.0 AS dual_coeff, -1.49020322906 AS sv_0, 0.411006272492 AS sv_1, 0.0847173454859 AS sv_2, -0.757151902627 AS sv_3 UNION ALL SELECT 54 AS sv_idx, 1.0 AS dual_coeff, 0.805928589781 AS sv_0, 0.469343513012 AS sv_1, 1.20481898676 AS sv_2, -0.117186618019 AS sv_3 UNION ALL SELECT 55 AS sv_idx, -1.0 AS dual_coeff, -0.468781806602 AS sv_0, -0.416576035518 AS sv_1, 0.0579304479567 AS sv_2, -0.0403692704986 AS sv_3 UNION ALL SELECT 56 AS sv_idx, -1.0 AS dual_coeff, 0.724950557518 AS sv_0, -0.217328730116 AS sv_1, -0.684877286559 AS sv_2, -0.330853614947 AS sv_3 UNION ALL SELECT 57 AS sv_idx, -1.0 AS dual_coeff, -0.150596708409 AS sv_0, -0.440014165276 AS sv_1, -0.553774137591 AS sv_2, -0.659937146966 AS sv_3 UNION ALL SELECT 58 AS sv_idx, 1.0 AS dual_coeff, -0.247387292353 AS sv_0, 0.868828848725 AS sv_1, 0.0178447563327 AS sv_2, 0.850781666387 AS sv_3 UNION ALL SELECT 59 AS sv_idx, 1.0 AS dual_coeff, -1.60563984287 AS sv_0, 0.869375912375 AS sv_1, -0.0866014299291 AS sv_2, -1.6821576398 AS sv_3 UNION ALL SELECT 60 AS sv_idx, 1.0 AS dual_coeff, 0.689723261163 AS sv_0, 1.56945143409 AS sv_1, -0.225758129353 AS sv_2, -1.01039554701 AS sv_3 UNION ALL SELECT 61 AS sv_idx, -1.0 AS dual_coeff, -1.01010267433 AS sv_0, -0.844290924575 AS sv_1, -1.67152455306 AS sv_2, 1.3864624457 AS sv_3 UNION ALL SELECT 62 AS sv_idx, -1.0 AS dual_coeff, 0.537098982341 AS sv_0, -1.19558763277 AS sv_1, -0.357496341457 AS sv_2, 0.46893087233 AS sv_3 UNION ALL SELECT 63 AS sv_idx, -1.0 AS dual_coeff, 1.17239199806 AS sv_0, -0.619869604547 AS sv_1, -1.32569608492 AS sv_2, 1.58215144333 AS sv_3 UNION ALL SELECT 64 AS sv_idx, 1.0 AS dual_coeff, 0.427570681029 AS sv_0, -0.713422387987 AS sv_1, 1.29398908257 AS sv_2, 0.818817054445 AS sv_3 UNION ALL SELECT 65 AS sv_idx, -1.0 AS dual_coeff, -0.16408286784 AS sv_0, -1.25927874984 AS sv_1, 0.876133833692 AS sv_2, 0.15370632842 AS sv_3) AS `Values`), 
kernel_cte AS 
(SELECT t.`KEY` AS `KEY`, t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv.`KEY` AS `KEY`, sum(full_join_data_sv.dot_prod1) + 421.972517094 AS dot_product 
FROM (SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, `SV_data`.dual_coeff * power(0.25 * (`ADS_sca_2_OUT`.scaler_output_2 * `SV_data`.sv_0 + `ADS_sca_2_OUT`.scaler_output_3 * `SV_data`.sv_1 + `ADS_sca_2_OUT`.scaler_output_4 * `SV_data`.sv_2 + `ADS_sca_2_OUT`.scaler_output_5 * `SV_data`.sv_3) + 0.0, 3) AS dot_prod1 
FROM `ADS_sca_2_OUT`, `SV_data`) AS full_join_data_sv GROUP BY full_join_data_sv.`KEY`) AS t)
 SELECT kernel_cte.`KEY` AS `KEY`, kernel_cte.dot_product AS `Estimator` 
FROM kernel_cte