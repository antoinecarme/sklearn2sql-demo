-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "ADS_imp_1_OUT" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 50.6766371302 ELSE "ADS"."Feature_0" END AS imputer_output_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 942.584143591 ELSE "ADS"."Feature_1" END AS imputer_output_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 0.479275837148 ELSE "ADS"."Feature_2" END AS imputer_output_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 6.11922110035 ELSE "ADS"."Feature_3" END AS imputer_output_5 
FROM freidman3 "ADS"), 
"ADS_sca_2_OUT" AS 
(SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".imputer_output_2 AS FLOAT) - 50.6766371302) / 28.7949738703 AS scaler_output_2, (CAST("ADS_imp_1_OUT".imputer_output_3 AS FLOAT) - 942.584143591) / 436.479375051 AS scaler_output_3, (CAST("ADS_imp_1_OUT".imputer_output_4 AS FLOAT) - 0.479275837148) / 0.308334425399 AS scaler_output_4, (CAST("ADS_imp_1_OUT".imputer_output_5 AS FLOAT) - 6.11922110035) / 2.85602319592 AS scaler_output_5 
FROM "ADS_imp_1_OUT"), 
"SV_data" AS 
(SELECT "Values".sv_idx AS sv_idx, "Values".dual_coeff AS dual_coeff, "Values".sv_0 AS sv_0, "Values".sv_1 AS sv_1, "Values".sv_2 AS sv_2, "Values".sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, -0.541499432417 AS dual_coeff, 1.38563329507 AS sv_0, 1.70223913486 AS sv_1, 0.959051304441 AS sv_2, 1.26574103331 AS sv_3 FROM DUAL UNION ALL SELECT 1 AS sv_idx, 1.0 AS dual_coeff, 1.46913168537 AS sv_0, -0.471676246756 AS sv_1, -0.219851838573 AS sv_2, 1.06961833919 AS sv_3 FROM DUAL UNION ALL SELECT 2 AS sv_idx, -1.0 AS dual_coeff, 1.0641109531 AS sv_0, -1.44546655726 AS sv_1, -1.32217922994 AS sv_2, 1.31530227823 AS sv_3 FROM DUAL UNION ALL SELECT 3 AS sv_idx, -1.0 AS dual_coeff, -0.760138398057 AS sv_0, 1.71319231135 AS sv_1, 1.14972874949 AS sv_2, -0.262974192122 AS sv_3 FROM DUAL UNION ALL SELECT 4 AS sv_idx, -0.105666388139 AS dual_coeff, 0.811580003702 AS sv_0, 1.00944510638 AS sv_1, 1.6514529417 AS sv_2, -0.251081584406 AS sv_3 FROM DUAL UNION ALL SELECT 5 AS sv_idx, 0.124681722743 AS dual_coeff, -1.06326944437 AS sv_0, -0.0765600467369 AS sv_1, 1.51141681467 AS sv_2, 1.37858204065 AS sv_3 FROM DUAL UNION ALL SELECT 6 AS sv_idx, 1.0 AS dual_coeff, -1.44585555275 AS sv_0, 0.765633491629 AS sv_1, -1.20346541169 AS sv_2, -0.897506765232 AS sv_3 FROM DUAL UNION ALL SELECT 7 AS sv_idx, 1.0 AS dual_coeff, -0.775779764331 AS sv_0, -0.0298163549211 AS sv_1, -0.141006063677 AS sv_2, 0.704299122426 AS sv_3 FROM DUAL UNION ALL SELECT 8 AS sv_idx, -1.0 AS dual_coeff, 1.27163734184 AS sv_0, 0.449360111319 AS sv_1, -1.46591815272 AS sv_2, 1.01231460269 AS sv_3 FROM DUAL UNION ALL SELECT 9 AS sv_idx, -0.00278321966705 AS dual_coeff, -1.46445660628 AS sv_0, -0.848885403807 AS sv_1, -1.43683974967 AS sv_2, 1.44813290147 AS sv_3 FROM DUAL UNION ALL SELECT 10 AS sv_idx, 0.15401309434 AS dual_coeff, 1.66686878643 AS sv_0, -1.46477150194 AS sv_1, 1.5155518354 AS sv_2, 0.701560698185 AS sv_3 FROM DUAL UNION ALL SELECT 11 AS sv_idx, -0.797779485621 AS dual_coeff, -0.452350473389 AS sv_0, 1.16689939393 AS sv_1, 1.10112748181 AS sv_2, -0.390635698184 AS sv_3 FROM DUAL UNION ALL SELECT 12 AS sv_idx, -1.0 AS dual_coeff, 0.776080246018 AS sv_0, -1.63025234421 AS sv_1, -0.793044472202 AS sv_2, -0.537149250232 AS sv_3 FROM DUAL UNION ALL SELECT 13 AS sv_idx, -0.0481421825441 AS dual_coeff, -1.0334396838 AS sv_0, 1.28730440379 AS sv_1, -0.163111264221 AS sv_2, -1.22266073044 AS sv_3 FROM DUAL UNION ALL SELECT 14 AS sv_idx, 0.50720064105 AS dual_coeff, 0.5321157832 AS sv_0, 1.1188495539 AS sv_1, -0.517051867482 AS sv_2, -0.877261454444 AS sv_3 FROM DUAL UNION ALL SELECT 15 AS sv_idx, 0.0832440755733 AS dual_coeff, 1.32831892332 AS sv_0, -0.659342332942 AS sv_1, 0.174163149912 AS sv_2, -0.245421576491 AS sv_3 FROM DUAL UNION ALL SELECT 16 AS sv_idx, 1.0 AS dual_coeff, 1.06515431243 AS sv_0, -0.184286179368 AS sv_1, 0.823495691611 AS sv_2, -0.779067941424 AS sv_3 FROM DUAL UNION ALL SELECT 17 AS sv_idx, -1.0 AS dual_coeff, -1.57481559105 AS sv_0, 0.9046981087 AS sv_1, 1.68283889802 AS sv_2, -0.184221011805 AS sv_3 FROM DUAL UNION ALL SELECT 18 AS sv_idx, 1.0 AS dual_coeff, 1.55913426542 AS sv_0, 1.22452961352 AS sv_1, -0.870425870064 AS sv_2, -0.251635827586 AS sv_3 FROM DUAL UNION ALL SELECT 19 AS sv_idx, 1.0 AS dual_coeff, 0.72536301137 AS sv_0, 0.324787394134 AS sv_1, -0.265134650854 AS sv_2, 1.36014994354 AS sv_3 FROM DUAL UNION ALL SELECT 20 AS sv_idx, 0.0417280326844 AS dual_coeff, 0.355505214874 AS sv_0, -1.6319722044 AS sv_1, -0.0828424640514 AS sv_2, 1.68885925463 AS sv_3 FROM DUAL UNION ALL SELECT 21 AS sv_idx, 0.595402493367 AS dual_coeff, 0.085620264447 AS sv_0, 1.43801330054 AS sv_1, -0.511409142484 AS sv_2, 0.834129842187 AS sv_3 FROM DUAL UNION ALL SELECT 22 AS sv_idx, 0.912059630151 AS dual_coeff, 1.21799933774 AS sv_0, -0.781709331777 AS sv_1, 0.430070406711 AS sv_2, 1.09957964134 AS sv_3 FROM DUAL UNION ALL SELECT 23 AS sv_idx, 1.0 AS dual_coeff, -0.411904735944 AS sv_0, 0.111778086816 AS sv_1, 0.0645875733614 AS sv_2, 0.301763542769 AS sv_3 FROM DUAL UNION ALL SELECT 24 AS sv_idx, -0.426841984132 AS dual_coeff, 0.846845935196 AS sv_0, 1.47439633142 AS sv_1, -1.29795395441 AS sv_2, -1.27776917829 AS sv_3 FROM DUAL UNION ALL SELECT 25 AS sv_idx, -0.446513812049 AS dual_coeff, -1.5497463394 AS sv_0, 0.612943333572 AS sv_1, 1.34555674254 AS sv_2, 0.00675512920027 AS sv_3 FROM DUAL UNION ALL SELECT 26 AS sv_idx, 1.0 AS dual_coeff, -0.808671689809 AS sv_0, -0.817943275083 AS sv_1, -0.351641252705 AS sv_2, -1.21243155636 AS sv_3 FROM DUAL UNION ALL SELECT 27 AS sv_idx, 0.138527173126 AS dual_coeff, 1.32267779322 AS sv_0, 0.38041541331 AS sv_1, -1.100675207 AS sv_2, 1.38500089139 AS sv_3 FROM DUAL UNION ALL SELECT 28 AS sv_idx, -1.0 AS dual_coeff, 0.681830024085 AS sv_0, -0.971015815293 AS sv_1, -0.864650915735 AS sv_2, 0.0479377037402 AS sv_3 FROM DUAL UNION ALL SELECT 29 AS sv_idx, 1.0 AS dual_coeff, -1.30635511126 AS sv_0, -0.267270649929 AS sv_1, -0.500146350514 AS sv_2, 0.227289480128 AS sv_3 FROM DUAL UNION ALL SELECT 30 AS sv_idx, 1.0 AS dual_coeff, -0.731955573208 AS sv_0, 0.245935501778 AS sv_1, -0.13318600803 AS sv_2, -1.57220184765 AS sv_3 FROM DUAL UNION ALL SELECT 31 AS sv_idx, -1.0 AS dual_coeff, 1.08503991319 AS sv_0, -1.4377638191 AS sv_1, -1.055034249 AS sv_2, 0.414751052023 AS sv_3 FROM DUAL UNION ALL SELECT 32 AS sv_idx, -1.0 AS dual_coeff, 1.14802043205 AS sv_0, -0.101696106908 AS sv_1, -0.985179247371 AS sv_2, 0.278289433677 AS sv_3 FROM DUAL UNION ALL SELECT 33 AS sv_idx, -1.0 AS dual_coeff, 1.53854329531 AS sv_0, -0.519411091663 AS sv_1, -1.11638805111 AS sv_2, 0.532216539801 AS sv_3 FROM DUAL UNION ALL SELECT 34 AS sv_idx, -0.397979993512 AS dual_coeff, -0.93905516632 AS sv_0, -0.199095605393 AS sv_1, -1.42579002899 AS sv_2, -0.958068426693 AS sv_3 FROM DUAL UNION ALL SELECT 35 AS sv_idx, -0.192052624564 AS dual_coeff, -0.529536750917 AS sv_0, 1.86806357969 AS sv_1, 0.360737413366 AS sv_2, 1.59494942045 AS sv_3 FROM DUAL UNION ALL SELECT 36 AS sv_idx, 0.497806893683 AS dual_coeff, -0.230408044557 AS sv_0, -0.198257565905 AS sv_1, -0.518473505546 AS sv_2, -1.76909902544 AS sv_3 FROM DUAL UNION ALL SELECT 37 AS sv_idx, 0.492634693057 AS dual_coeff, -1.72853397117 AS sv_0, -0.737017880172 AS sv_1, 0.605086438384 AS sv_2, 0.223978389045 AS sv_3 FROM DUAL UNION ALL SELECT 38 AS sv_idx, -0.891135395368 AS dual_coeff, -1.20745720676 AS sv_0, -1.34043095082 AS sv_1, -1.4267165789 AS sv_2, -1.28254088341 AS sv_3 FROM DUAL UNION ALL SELECT 39 AS sv_idx, 0.303096068239 AS dual_coeff, -0.70089027754 AS sv_0, 0.855866628471 AS sv_1, -0.471441191496 AS sv_2, 0.0105709075646 AS sv_3 FROM DUAL UNION ALL SELECT 40 AS sv_idx, -1.0 AS dual_coeff, -0.966111940164 AS sv_0, 0.478844400741 AS sv_1, 1.19292924627 AS sv_2, -1.68192032911 AS sv_3 FROM DUAL) "Values"), 
kernel_cte AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(full_join_data_sv.dot_prod1) + 1.32589136423 AS dot_product 
FROM (SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", "SV_data".dual_coeff * power(0.25 * ("ADS_sca_2_OUT".scaler_output_2 * "SV_data".sv_0 + "ADS_sca_2_OUT".scaler_output_3 * "SV_data".sv_1 + "ADS_sca_2_OUT".scaler_output_4 * "SV_data".sv_2 + "ADS_sca_2_OUT".scaler_output_5 * "SV_data".sv_3) + 0.0, 3) AS dot_prod1 
FROM "ADS_sca_2_OUT", "SV_data") full_join_data_sv GROUP BY full_join_data_sv."KEY") t)
 SELECT kernel_cte."KEY" AS "KEY", kernel_cte.dot_product AS "Estimator" 
FROM kernel_cte