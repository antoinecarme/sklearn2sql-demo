-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 53.6474913818 ELSE `ADS`.`Feature_0` END AS imputer_output_2, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 882.487038059 ELSE `ADS`.`Feature_1` END AS imputer_output_3, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 0.45519940392 ELSE `ADS`.`Feature_2` END AS imputer_output_4, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 5.91463600172 ELSE `ADS`.`Feature_3` END AS imputer_output_5 
FROM freidman3 AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.imputer_output_2 AS DOUBLE) - 53.6474913818) / 26.3906922541 AS scaler_output_2, (CAST(`ADS_imp_1_OUT`.imputer_output_3 AS DOUBLE) - 882.487038059) / 460.086094779 AS scaler_output_3, (CAST(`ADS_imp_1_OUT`.imputer_output_4 AS DOUBLE) - 0.45519940392) / 0.290525421606 AS scaler_output_4, (CAST(`ADS_imp_1_OUT`.imputer_output_5 AS DOUBLE) - 5.91463600172) / 2.77703793945 AS scaler_output_5 
FROM `ADS_imp_1_OUT`), 
`SV_data` AS 
(SELECT `Values`.sv_idx AS sv_idx, `Values`.dual_coeff AS dual_coeff, `Values`.sv_0 AS sv_0, `Values`.sv_1 AS sv_1, `Values`.sv_2 AS sv_2, `Values`.sv_3 AS sv_3 
FROM (SELECT 0 AS sv_idx, 0.271667831205 AS dual_coeff, -1.90640747463 AS sv_0, -1.184800693 AS sv_1, 1.75074550298 AS sv_2, 0.833882122075 AS sv_3 UNION ALL SELECT 1 AS sv_idx, -0.0671681151179 AS dual_coeff, 0.172154756022 AS sv_0, 0.416030797867 AS sv_1, -1.34212665116 AS sv_2, -0.700817658463 AS sv_3 UNION ALL SELECT 2 AS sv_idx, -1.0 AS dual_coeff, 0.534683636276 AS sv_0, 1.44336692693 AS sv_1, -1.51998380387 AS sv_2, -0.102931097978 AS sv_3 UNION ALL SELECT 3 AS sv_idx, -0.791126426873 AS dual_coeff, -0.183095132386 AS sv_0, 1.0331843521 AS sv_1, -1.42347299352 AS sv_2, 0.0876162358721 AS sv_3 UNION ALL SELECT 4 AS sv_idx, 0.275137854739 AS dual_coeff, 0.882949892647 AS sv_0, -0.876200613537 AS sv_1, 0.950081956257 AS sv_2, 1.78423243243 AS sv_3 UNION ALL SELECT 5 AS sv_idx, 0.00969820326517 AS dual_coeff, -1.10294459128 AS sv_0, 0.941158669397 AS sv_1, 1.58170620157 AS sv_2, -0.245610337897 AS sv_3 UNION ALL SELECT 6 AS sv_idx, 0.14676486998 AS dual_coeff, -1.09762595193 AS sv_0, -0.275178804229 AS sv_1, 1.70029980812 AS sv_2, -1.39103753184 AS sv_3 UNION ALL SELECT 7 AS sv_idx, 0.208412562395 AS dual_coeff, -0.418755201302 AS sv_0, -1.22542361328 AS sv_1, -0.811840818819 AS sv_2, -1.19344106601 AS sv_3 UNION ALL SELECT 8 AS sv_idx, 0.341978763654 AS dual_coeff, 0.504409439019 AS sv_0, 1.89715452103 AS sv_1, -1.42326029152 AS sv_2, -0.43999301381 AS sv_3 UNION ALL SELECT 9 AS sv_idx, 0.0438866350144 AS dual_coeff, 1.69698092775 AS sv_0, 1.0780981583 AS sv_1, 0.447556800829 AS sv_2, 1.43155379099 AS sv_3 UNION ALL SELECT 10 AS sv_idx, 0.935321112231 AS dual_coeff, -0.00578037666228 AS sv_0, -1.24005181563 AS sv_1, -0.642134349309 AS sv_2, 1.23639938958 AS sv_3 UNION ALL SELECT 11 AS sv_idx, -0.107457393828 AS dual_coeff, 0.495643444087 AS sv_0, 0.823461447171 AS sv_1, 0.612935858692 AS sv_2, 0.0177571558763 AS sv_3 UNION ALL SELECT 12 AS sv_idx, 0.173345004906 AS dual_coeff, -0.625859732305 AS sv_0, 1.21049850443 AS sv_1, 1.66760399553 AS sv_2, 0.533852826446 AS sv_3 UNION ALL SELECT 13 AS sv_idx, 1.0 AS dual_coeff, 0.843850592565 AS sv_0, 0.91137427527 AS sv_1, -1.01978753941 AS sv_2, -1.03061038926 AS sv_3 UNION ALL SELECT 14 AS sv_idx, 1.0 AS dual_coeff, 0.0260152959694 AS sv_0, 0.952283984257 AS sv_1, -0.967348496814 AS sv_2, -0.0301694946565 AS sv_3 UNION ALL SELECT 15 AS sv_idx, 0.0699008814267 AS dual_coeff, -1.80857655137 AS sv_0, 0.675998859398 AS sv_1, 0.289554239218 AS sv_2, -1.57024665606 AS sv_3 UNION ALL SELECT 16 AS sv_idx, 0.127053029188 AS dual_coeff, 1.73074247848 AS sv_0, 0.481577750281 AS sv_1, 0.958859384516 AS sv_2, -1.57421261671 AS sv_3 UNION ALL SELECT 17 AS sv_idx, 0.299870807998 AS dual_coeff, -1.98575662398 AS sv_0, 1.74063958906 AS sv_1, -0.619006741701 AS sv_2, -0.378316988437 AS sv_3 UNION ALL SELECT 18 AS sv_idx, -1.0 AS dual_coeff, 0.291834019855 AS sv_0, -0.696519992868 AS sv_1, -1.4336723426 AS sv_2, 1.05300398073 AS sv_3 UNION ALL SELECT 19 AS sv_idx, 0.114897544744 AS dual_coeff, 1.41641895815 AS sv_0, 0.881819468974 AS sv_1, 1.86339038736 AS sv_2, 1.66034766284 AS sv_3 UNION ALL SELECT 20 AS sv_idx, -1.0 AS dual_coeff, 0.508715352805 AS sv_0, -1.03124914889 AS sv_1, -1.54087641525 AS sv_2, -1.42967917734 AS sv_3 UNION ALL SELECT 21 AS sv_idx, 0.070152030312 AS dual_coeff, -1.20626596562 AS sv_0, -1.04845626841 AS sv_1, -0.918562922519 AS sv_2, 1.6222496125 AS sv_3 UNION ALL SELECT 22 AS sv_idx, -0.0729338984095 AS dual_coeff, -1.22109055303 AS sv_0, -1.6407111525 AS sv_1, 0.382878254612 AS sv_2, -0.809820462033 AS sv_3 UNION ALL SELECT 23 AS sv_idx, 0.295177368714 AS dual_coeff, -1.88089834164 AS sv_0, 0.941507577551 AS sv_1, -0.85257393254 AS sv_2, 1.54362196433 AS sv_3 UNION ALL SELECT 24 AS sv_idx, 0.116814412076 AS dual_coeff, 0.352400627797 AS sv_0, 1.73965685571 AS sv_1, 0.838884495463 AS sv_2, 1.54303280158 AS sv_3 UNION ALL SELECT 25 AS sv_idx, 0.117730189821 AS dual_coeff, -0.212752752453 AS sv_0, -1.16192684841 AS sv_1, 0.313983996539 AS sv_2, -1.38800121627 AS sv_3 UNION ALL SELECT 26 AS sv_idx, -1.0 AS dual_coeff, 1.56586525956 AS sv_0, 1.72417673163 AS sv_1, -1.53292270717 AS sv_2, -0.620117332271 AS sv_3 UNION ALL SELECT 27 AS sv_idx, 0.228051939776 AS dual_coeff, -1.59096125934 AS sv_0, -0.763444174443 AS sv_1, -0.700185879819 AS sv_2, -0.84995349329 AS sv_3 UNION ALL SELECT 28 AS sv_idx, -0.17465602791 AS dual_coeff, 1.40233715818 AS sv_0, -1.55923722591 AS sv_1, -0.298728917774 AS sv_2, -1.59252789972 AS sv_3 UNION ALL SELECT 29 AS sv_idx, 0.316056861499 AS dual_coeff, -0.290924280038 AS sv_0, -0.779154293402 AS sv_1, -0.977137954765 AS sv_2, 1.0595474779 AS sv_3 UNION ALL SELECT 30 AS sv_idx, -0.496216911292 AS dual_coeff, -0.474794542441 AS sv_0, 0.463855092448 AS sv_1, 0.123193654333 AS sv_2, 0.115544170316 AS sv_3 UNION ALL SELECT 31 AS sv_idx, 0.0405669274539 AS dual_coeff, -1.80835470534 AS sv_0, -0.652489548483 AS sv_1, 1.20475576224 AS sv_2, -1.2973993248 AS sv_3 UNION ALL SELECT 32 AS sv_idx, 0.869901699502 AS dual_coeff, 0.645891274415 AS sv_0, 0.475087183354 AS sv_1, -0.951096467252 AS sv_2, 0.0953308720806 AS sv_3 UNION ALL SELECT 33 AS sv_idx, -0.218325096638 AS dual_coeff, -0.320176706456 AS sv_0, 0.596293990906 AS sv_1, -1.37870007994 AS sv_2, -1.23816529419 AS sv_3 UNION ALL SELECT 34 AS sv_idx, -0.14450265983 AS dual_coeff, 1.67649469912 AS sv_0, -1.13135019149 AS sv_1, -0.932960207417 AS sv_2, 0.516385425814 AS sv_3 UNION ALL SELECT 35 AS sv_idx, -1.0 AS dual_coeff, 0.216212262512 AS sv_0, -1.61432548386 AS sv_1, -0.438291756282 AS sv_2, 1.75694630492 AS sv_3) AS `Values`), 
kernel_cte AS 
(SELECT t.`KEY` AS `KEY`, t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv.`KEY` AS `KEY`, sum(full_join_data_sv.dot_prod1) + 1.07851741127 AS dot_product 
FROM (SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, `SV_data`.dual_coeff * exp(-0.25 * (power(`ADS_sca_2_OUT`.scaler_output_2 - `SV_data`.sv_0, 2) + power(`ADS_sca_2_OUT`.scaler_output_3 - `SV_data`.sv_1, 2) + power(`ADS_sca_2_OUT`.scaler_output_4 - `SV_data`.sv_2, 2) + power(`ADS_sca_2_OUT`.scaler_output_5 - `SV_data`.sv_3, 2))) AS dot_prod1 
FROM `ADS_sca_2_OUT`, `SV_data`) AS full_join_data_sv GROUP BY full_join_data_sv.`KEY`) AS t)
 SELECT kernel_cte.`KEY` AS `KEY`, kernel_cte.dot_product AS `Estimator` 
FROM kernel_cte