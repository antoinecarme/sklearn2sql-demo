-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 13.8597887324 ELSE `ADS`.`Feature_0` END AS `impter_2`, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 19.5079577465 ELSE `ADS`.`Feature_1` END AS `impter_3`, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 90.2345774648 ELSE `ADS`.`Feature_2` END AS `impter_4`, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 631.54084507 ELSE `ADS`.`Feature_3` END AS `impter_5`, CASE WHEN (`ADS`.`Feature_4` IS NULL) THEN 0.0950171830986 ELSE `ADS`.`Feature_4` END AS `impter_6`, CASE WHEN (`ADS`.`Feature_5` IS NULL) THEN 0.103067887324 ELSE `ADS`.`Feature_5` END AS `impter_7`, CASE WHEN (`ADS`.`Feature_6` IS NULL) THEN 0.0864928380282 ELSE `ADS`.`Feature_6` END AS `impter_8`, CASE WHEN (`ADS`.`Feature_7` IS NULL) THEN 0.0468693521127 ELSE `ADS`.`Feature_7` END AS `impter_9`, CASE WHEN (`ADS`.`Feature_8` IS NULL) THEN 0.180978169014 ELSE `ADS`.`Feature_8` END AS `impter_10`, CASE WHEN (`ADS`.`Feature_9` IS NULL) THEN 0.0631552112676 ELSE `ADS`.`Feature_9` END AS `impter_11`, CASE WHEN (`ADS`.`Feature_10` IS NULL) THEN 0.412326056338 ELSE `ADS`.`Feature_10` END AS `impter_12`, CASE WHEN (`ADS`.`Feature_11` IS NULL) THEN 1.27143450704 ELSE `ADS`.`Feature_11` END AS `impter_13`, CASE WHEN (`ADS`.`Feature_12` IS NULL) THEN 2.98328169014 ELSE `ADS`.`Feature_12` END AS `impter_14`, CASE WHEN (`ADS`.`Feature_13` IS NULL) THEN 41.2231690141 ELSE `ADS`.`Feature_13` END AS `impter_15`, CASE WHEN (`ADS`.`Feature_14` IS NULL) THEN 0.00734775352113 ELSE `ADS`.`Feature_14` END AS `impter_16`, CASE WHEN (`ADS`.`Feature_15` IS NULL) THEN 0.0264921690141 ELSE `ADS`.`Feature_15` END AS `impter_17`, CASE WHEN (`ADS`.`Feature_16` IS NULL) THEN 0.032405528169 ELSE `ADS`.`Feature_16` END AS `impter_18`, CASE WHEN (`ADS`.`Feature_17` IS NULL) THEN 0.0118757676056 ELSE `ADS`.`Feature_17` END AS `impter_19`, CASE WHEN (`ADS`.`Feature_18` IS NULL) THEN 0.0213508450704 ELSE `ADS`.`Feature_18` END AS `impter_20`, CASE WHEN (`ADS`.`Feature_19` IS NULL) THEN 0.00392323450704 ELSE `ADS`.`Feature_19` END AS `impter_21`, CASE WHEN (`ADS`.`Feature_20` IS NULL) THEN 15.8818169014 ELSE `ADS`.`Feature_20` END AS `impter_22`, CASE WHEN (`ADS`.`Feature_21` IS NULL) THEN 25.8104225352 ELSE `ADS`.`Feature_21` END AS `impter_23`, CASE WHEN (`ADS`.`Feature_22` IS NULL) THEN 105.106619718 ELSE `ADS`.`Feature_22` END AS `impter_24`, CASE WHEN (`ADS`.`Feature_23` IS NULL) THEN 837.940140845 ELSE `ADS`.`Feature_23` END AS `impter_25`, CASE WHEN (`ADS`.`Feature_24` IS NULL) THEN 0.130144507042 ELSE `ADS`.`Feature_24` END AS `impter_26`, CASE WHEN (`ADS`.`Feature_25` IS NULL) THEN 0.248377464789 ELSE `ADS`.`Feature_25` END AS `impter_27`, CASE WHEN (`ADS`.`Feature_26` IS NULL) THEN 0.259110753521 ELSE `ADS`.`Feature_26` END AS `impter_28`, CASE WHEN (`ADS`.`Feature_27` IS NULL) THEN 0.109523584507 ELSE `ADS`.`Feature_27` END AS `impter_29`, CASE WHEN (`ADS`.`Feature_28` IS NULL) THEN 0.286747183099 ELSE `ADS`.`Feature_28` END AS `impter_30`, CASE WHEN (`ADS`.`Feature_29` IS NULL) THEN 0.0836747887324 ELSE `ADS`.`Feature_29` END AS `impter_31` 
FROM `BreastCancer` AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.`impter_2` AS FLOAT) - 13.8597887324) / 3.48110212803 AS `scaler_2`, (CAST(`ADS_imp_1_OUT`.`impter_3` AS FLOAT) - 19.5079577465) / 4.43362115357 AS `scaler_3`, (CAST(`ADS_imp_1_OUT`.`impter_4` AS FLOAT) - 90.2345774648) / 24.1038025643 AS `scaler_4`, (CAST(`ADS_imp_1_OUT`.`impter_5` AS FLOAT) - 631.54084507) / 344.884606371 AS `scaler_5`, (CAST(`ADS_imp_1_OUT`.`impter_6` AS FLOAT) - 0.0950171830986) / 0.013946197592 AS `scaler_6`, (CAST(`ADS_imp_1_OUT`.`impter_7` AS FLOAT) - 0.103067887324) / 0.051633665263 AS `scaler_7`, (CAST(`ADS_imp_1_OUT`.`impter_8` AS FLOAT) - 0.0864928380282) / 0.0758957535964 AS `scaler_8`, (CAST(`ADS_imp_1_OUT`.`impter_9` AS FLOAT) - 0.0468693521127) / 0.0384321726563 AS `scaler_9`, (CAST(`ADS_imp_1_OUT`.`impter_10` AS FLOAT) - 0.180978169014) / 0.0276998070777 AS `scaler_10`, (CAST(`ADS_imp_1_OUT`.`impter_11` AS FLOAT) - 0.0631552112676) / 0.00648056962788 AS `scaler_11`, (CAST(`ADS_imp_1_OUT`.`impter_12` AS FLOAT) - 0.412326056338) / 0.320867363603 AS `scaler_12`, (CAST(`ADS_imp_1_OUT`.`impter_13` AS FLOAT) - 1.27143450704) / 0.550314789435 AS `scaler_13`, (CAST(`ADS_imp_1_OUT`.`impter_14` AS FLOAT) - 2.98328169014) / 2.45069631007 AS `scaler_14`, (CAST(`ADS_imp_1_OUT`.`impter_15` AS FLOAT) - 41.2231690141) / 52.9190319751 AS `scaler_15`, (CAST(`ADS_imp_1_OUT`.`impter_16` AS FLOAT) - 0.00734775352113) / 0.00276275575882 AS `scaler_16`, (CAST(`ADS_imp_1_OUT`.`impter_17` AS FLOAT) - 0.0264921690141) / 0.0174086380412 AS `scaler_17`, (CAST(`ADS_imp_1_OUT`.`impter_18` AS FLOAT) - 0.032405528169) / 0.0245629776833 AS `scaler_18`, (CAST(`ADS_imp_1_OUT`.`impter_19` AS FLOAT) - 0.0118757676056) / 0.00653221319467 AS `scaler_19`, (CAST(`ADS_imp_1_OUT`.`impter_20` AS FLOAT) - 0.0213508450704) / 0.00782019780134 AS `scaler_20`, (CAST(`ADS_imp_1_OUT`.`impter_21` AS FLOAT) - 0.00392323450704) / 0.00195872778537 AS `scaler_21`, (CAST(`ADS_imp_1_OUT`.`impter_22` AS FLOAT) - 15.8818169014) / 4.65228595124 AS `scaler_22`, (CAST(`ADS_imp_1_OUT`.`impter_23` AS FLOAT) - 25.8104225352) / 6.24340698716 AS `scaler_23`, (CAST(`ADS_imp_1_OUT`.`impter_24` AS FLOAT) - 105.106619718) / 33.2876907395 AS `scaler_24`, (CAST(`ADS_imp_1_OUT`.`impter_25` AS FLOAT) - 837.940140845) / 516.877799198 AS `scaler_25`, (CAST(`ADS_imp_1_OUT`.`impter_26` AS FLOAT) - 0.130144507042) / 0.0225481406303 AS `scaler_26`, (CAST(`ADS_imp_1_OUT`.`impter_27` AS FLOAT) - 0.248377464789) / 0.152062558695 AS `scaler_27`, (CAST(`ADS_imp_1_OUT`.`impter_28` AS FLOAT) - 0.259110753521) / 0.192531701725 AS `scaler_28`, (CAST(`ADS_imp_1_OUT`.`impter_29` AS FLOAT) - 0.109523584507) / 0.0679243013098 AS `scaler_29`, (CAST(`ADS_imp_1_OUT`.`impter_30` AS FLOAT) - 0.286747183099) / 0.0597538503605 AS `scaler_30`, (CAST(`ADS_imp_1_OUT`.`impter_31` AS FLOAT) - 0.0836747887324) / 0.0156791725456 AS `scaler_31` 
FROM `ADS_imp_1_OUT`), 
`DT_node_lookup` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_24` <= 0.02533610165119171) THEN 1 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_8` <= 0.01518084853887558) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_3` <= -0.060437675565481186) THEN 4 ELSE 5 END ELSE 6 END END AS `node_id_2` 
FROM `ADS_sca_2_OUT`), 
`DT_node_data` AS 
(SELECT `Values`.`node_id` AS `node_id`, `Values`.`feature` AS `feature`, `Values`.`threshold` AS `threshold`, `Values`.`count` AS `count`, `Values`.`depth` AS `depth`, `Values`.`parent_id` AS `parent_id`, `Values`.`Proba_0` AS `Proba_0`, `Values`.`LogProba_0` AS `LogProba_0`, `Values`.`Proba_1` AS `Proba_1`, `Values`.`LogProba_1` AS `LogProba_1`, `Values`.`Decision` AS `Decision` 
FROM (SELECT 0 AS `node_id`, 'scaler_24' AS `feature`, 0.02533610165119171 AS `threshold`, 142 AS `count`, 0 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 0.352112676056338 AS `Proba_0`, -1.04380405217 AS `LogProba_0`, 0.647887323943662 AS `Proba_1`, -0.434038480552 AS `LogProba_1`, 1 AS `Decision` UNION ALL SELECT 1 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 89 AS `count`, 1 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 1 AS `Decision` UNION ALL SELECT 2 AS `node_id`, 'scaler_8' AS `feature`, 0.01518084853887558 AS `threshold`, 53 AS `count`, 1 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 0.9433962264150944 AS `Proba_0`, -0.058268908124 AS `LogProba_0`, 0.05660377358490566 AS `Proba_1`, -2.87167962488 AS `LogProba_1`, 0 AS `Decision` UNION ALL SELECT 3 AS `node_id`, 'scaler_3' AS `feature`, -0.060437675565481186 AS `threshold`, 5 AS `count`, 2 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 0.4 AS `Proba_0`, -0.916290731874 AS `LogProba_0`, 0.6 AS `Proba_1`, -0.510825623766 AS `LogProba_1`, 1 AS `Decision` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 3 AS `count`, 3 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 1 AS `Decision` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 3 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 1.0 AS `Proba_0`, 0.0 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0 AS `Decision` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 48 AS `count`, 2 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 1.0 AS `Proba_0`, 0.0 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0 AS `Decision`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.`node_id_2` AS `node_id_2`, `DT_node_data`.`node_id` AS `node_id`, `DT_node_data`.`feature` AS `feature`, `DT_node_data`.`threshold` AS `threshold`, `DT_node_data`.`count` AS `count`, `DT_node_data`.`depth` AS `depth`, `DT_node_data`.`parent_id` AS `parent_id`, `DT_node_data`.`Proba_0` AS `Proba_0`, `DT_node_data`.`LogProba_0` AS `LogProba_0`, `DT_node_data`.`Proba_1` AS `Proba_1`, `DT_node_data`.`LogProba_1` AS `LogProba_1`, `DT_node_data`.`Decision` AS `Decision` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.`node_id_2` = `DT_node_data`.`node_id`)
 SELECT `DT_Output`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_0`, CAST(NULL AS FLOAT) AS `Score_1`, `DT_Output`.`Proba_0` AS `Proba_0`, `DT_Output`.`Proba_1` AS `Proba_1`, `DT_Output`.`LogProba_0` AS `LogProba_0`, `DT_Output`.`LogProba_1` AS `LogProba_1`, `DT_Output`.`Decision` AS `Decision` 
FROM `DT_Output`