-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH linear_model_cte AS 
(SELECT `ADS`.`KEY` AS `KEY`, 0.005630280945250033 * `ADS`.`Feature_0` + 0.0033727236880995437 * `ADS`.`Feature_1` + -0.0002139314719796537 * `ADS`.`Feature_2` + 0.03092164995208749 * `ADS`.`Feature_3` + -0.01099020001758011 * `ADS`.`Feature_4` + -0.0019066449262032676 * `ADS`.`Feature_5` + -0.03460103002138169 * `ADS`.`Feature_6` + -0.006282501230155119 * `ADS`.`Feature_7` + 0.005725629426577693 * `ADS`.`Feature_8` + -0.018278843941273718 * `ADS`.`Feature_9` + 0.010906305485658834 * `ADS`.`Feature_10` + 0.025593700035772476 * `ADS`.`Feature_11` + 0.006180246106730593 * `ADS`.`Feature_12` + 0.005637219051857598 * `ADS`.`Feature_13` + -0.005782415236759932 * `ADS`.`Feature_14` + 0.04782154321349546 * `ADS`.`Feature_15` + -0.007421260654849624 * `ADS`.`Feature_16` + 0.03496418384495526 * `ADS`.`Feature_17` + -0.02603171392506044 * `ADS`.`Feature_18` + -0.004577058748842929 * `ADS`.`Feature_19` + 0.010668665726463238 * `ADS`.`Feature_20` + -0.006275171426424517 * `ADS`.`Feature_21` + 0.002890200754302738 * `ADS`.`Feature_22` + -0.0003919745391793606 * `ADS`.`Feature_23` + 0.02292760778051962 * `ADS`.`Feature_24` + -0.0034103832191837518 * `ADS`.`Feature_25` + 0.02014079519889352 * `ADS`.`Feature_26` + -0.002274639553200733 * `ADS`.`Feature_27` + 0.007619934486108861 * `ADS`.`Feature_28` + 0.027422819578498264 * `ADS`.`Feature_29` + 0.0282187955705311 * `ADS`.`Feature_30` + 0.016300048730502767 * `ADS`.`Feature_31` + -0.024069476137919973 * `ADS`.`Feature_32` + -0.005320535001287043 * `ADS`.`Feature_33` + 0.015898062041104312 * `ADS`.`Feature_34` + 0.009530610374349791 * `ADS`.`Feature_35` + 0.010935979560616722 * `ADS`.`Feature_36` + 0.008618907298511473 * `ADS`.`Feature_37` + -0.0032520686373618485 * `ADS`.`Feature_38` + -0.0026604710260810416 * `ADS`.`Feature_39` + -0.006703975658365948 * `ADS`.`Feature_40` + 0.018012053794480128 * `ADS`.`Feature_41` + 0.012727702287573276 * `ADS`.`Feature_42` + 0.0037872875295549115 * `ADS`.`Feature_43` + 0.004254389728632591 * `ADS`.`Feature_44` + -0.0029195755094755076 * `ADS`.`Feature_45` + -0.012062510675165977 * `ADS`.`Feature_46` + -0.002732755529032538 * `ADS`.`Feature_47` + 0.011645630452030776 * `ADS`.`Feature_48` + -0.00845699462537338 * `ADS`.`Feature_49` + 0.006443957886788995 * `ADS`.`Feature_50` + 0.008661426261890506 * `ADS`.`Feature_51` + 0.002932277562504343 * `ADS`.`Feature_52` + -0.00790294008412847 * `ADS`.`Feature_53` + -0.006290886254439606 * `ADS`.`Feature_54` + 0.003927183224662612 * `ADS`.`Feature_55` + -0.028946303107399953 * `ADS`.`Feature_56` + -0.009475314775531781 * `ADS`.`Feature_57` + 0.001438663930456787 * `ADS`.`Feature_58` + -0.027114781014923116 * `ADS`.`Feature_59` + 0.0018284600884055625 * `ADS`.`Feature_60` + 0.003203084535375966 * `ADS`.`Feature_61` + 0.007753640058070398 * `ADS`.`Feature_62` + 0.006802086632449053 * `ADS`.`Feature_63` + 0.002199253271429868 * `ADS`.`Feature_64` + 0.007936378899781374 * `ADS`.`Feature_65` + -0.011285676837564911 * `ADS`.`Feature_66` + 0.01227679524322933 * `ADS`.`Feature_67` + -0.021345138862979642 * `ADS`.`Feature_68` + -0.012383507563705421 * `ADS`.`Feature_69` + -0.011970569080326048 * `ADS`.`Feature_70` + -0.010943012332094182 * `ADS`.`Feature_71` + -0.02844745655126957 * `ADS`.`Feature_72` + -0.00037508022895164396 * `ADS`.`Feature_73` + -0.010737215243966536 * `ADS`.`Feature_74` + 0.0021463328316237112 * `ADS`.`Feature_75` + 0.028211675667824294 * `ADS`.`Feature_76` + 0.0021515006910917804 * `ADS`.`Feature_77` + 0.007949272446580505 * `ADS`.`Feature_78` + 0.01455859925693135 * `ADS`.`Feature_79` + -0.005343487553395679 * `ADS`.`Feature_80` + -0.0021921547606302523 * `ADS`.`Feature_81` + -0.0023802252679433447 * `ADS`.`Feature_82` + 0.000740898868374392 * `ADS`.`Feature_83` + -0.025997390072325773 * `ADS`.`Feature_84` + -0.025424243392313937 * `ADS`.`Feature_85` + 0.010007988176834712 * `ADS`.`Feature_86` + -0.014543889485302074 * `ADS`.`Feature_87` + -0.0023186156168488957 * `ADS`.`Feature_88` + 0.01980271857161887 * `ADS`.`Feature_89` + -0.0197143737577877 * `ADS`.`Feature_90` + -0.007297811772480816 * `ADS`.`Feature_91` + -0.033158353239995525 * `ADS`.`Feature_92` + -0.003662483507742271 * `ADS`.`Feature_93` + 0.0007687752027117759 * `ADS`.`Feature_94` + 0.00506336008886642 * `ADS`.`Feature_95` + 0.0046089055376171886 * `ADS`.`Feature_96` + 0.009648700160028324 * `ADS`.`Feature_97` + -0.03339045202016575 * `ADS`.`Feature_98` + 0.0029062449677153715 * `ADS`.`Feature_99` + -0.628596215397 AS `Score_0`, -0.009222356280888497 * `ADS`.`Feature_0` + -0.010914607101575784 * `ADS`.`Feature_1` + -0.01374737183681762 * `ADS`.`Feature_2` + 0.001822481174551898 * `ADS`.`Feature_3` + -0.002248375723625547 * `ADS`.`Feature_4` + -0.004117415801729979 * `ADS`.`Feature_5` + 0.03360104346513094 * `ADS`.`Feature_6` + -0.00858220887648105 * `ADS`.`Feature_7` + -0.003449033424531826 * `ADS`.`Feature_8` + 0.008904677702412975 * `ADS`.`Feature_9` + -0.06229569114603978 * `ADS`.`Feature_10` + -0.010326809958105494 * `ADS`.`Feature_11` + -0.0013412524112572828 * `ADS`.`Feature_12` + -0.010271427983897827 * `ADS`.`Feature_13` + -0.0005277856393360431 * `ADS`.`Feature_14` + -0.020671111491070617 * `ADS`.`Feature_15` + 0.003585790484023416 * `ADS`.`Feature_16` + -0.012152543382290326 * `ADS`.`Feature_17` + 0.0025507387625610684 * `ADS`.`Feature_18` + -0.0037330540523890674 * `ADS`.`Feature_19` + -0.03457997539207883 * `ADS`.`Feature_20` + 0.029267440650585064 * `ADS`.`Feature_21` + 0.0032798146850771498 * `ADS`.`Feature_22` + -0.020993197835776082 * `ADS`.`Feature_23` + -0.00749741765206424 * `ADS`.`Feature_24` + 0.007167767052046848 * `ADS`.`Feature_25` + -0.005559090075422914 * `ADS`.`Feature_26` + 0.00874257944474112 * `ADS`.`Feature_27` + 0.008366918256227245 * `ADS`.`Feature_28` + -0.04571748441336344 * `ADS`.`Feature_29` + -0.0137152853319345 * `ADS`.`Feature_30` + -0.016992345161710852 * `ADS`.`Feature_31` + 0.016948399182439754 * `ADS`.`Feature_32` + 0.03571038293730738 * `ADS`.`Feature_33` + -0.011965035295508563 * `ADS`.`Feature_34` + -0.007991961999441834 * `ADS`.`Feature_35` + -0.00888120729691604 * `ADS`.`Feature_36` + -0.020262300697045415 * `ADS`.`Feature_37` + -0.001298671384959575 * `ADS`.`Feature_38` + -0.0015830599905727473 * `ADS`.`Feature_39` + 0.0042275645855890725 * `ADS`.`Feature_40` + -0.0031694285809043504 * `ADS`.`Feature_41` + -0.015236401650785977 * `ADS`.`Feature_42` + 0.02771735460523042 * `ADS`.`Feature_43` + -0.003791006088300735 * `ADS`.`Feature_44` + 0.03406730092735658 * `ADS`.`Feature_45` + 0.001751688791895233 * `ADS`.`Feature_46` + 0.008017913235661069 * `ADS`.`Feature_47` + 0.016476840112431668 * `ADS`.`Feature_48` + 0.0049134772812795355 * `ADS`.`Feature_49` + -0.01804019231402711 * `ADS`.`Feature_50` + -0.0012988599082473505 * `ADS`.`Feature_51` + 0.017196412553892426 * `ADS`.`Feature_52` + 0.00444803861946123 * `ADS`.`Feature_53` + 0.008854830609909936 * `ADS`.`Feature_54` + -0.006262987391356986 * `ADS`.`Feature_55` + 0.044639808868307596 * `ADS`.`Feature_56` + 0.01633539792828503 * `ADS`.`Feature_57` + 0.004857462982643692 * `ADS`.`Feature_58` + 0.015856081152471828 * `ADS`.`Feature_59` + -0.006457478426466841 * `ADS`.`Feature_60` + -0.007371563535201053 * `ADS`.`Feature_61` + -0.00122408023623128 * `ADS`.`Feature_62` + -0.002742990562748251 * `ADS`.`Feature_63` + -0.011361278602205864 * `ADS`.`Feature_64` + -0.009021412086816592 * `ADS`.`Feature_65` + 0.005998166576162594 * `ADS`.`Feature_66` + 0.006899608068255724 * `ADS`.`Feature_67` + 0.045575878420196066 * `ADS`.`Feature_68` + -0.028957544616258046 * `ADS`.`Feature_69` + -0.007539353985347061 * `ADS`.`Feature_70` + 0.02936024292155346 * `ADS`.`Feature_71` + 0.020140808283715415 * `ADS`.`Feature_72` + -0.021256280843179508 * `ADS`.`Feature_73` + 0.008460791244871375 * `ADS`.`Feature_74` + 0.003677740526971618 * `ADS`.`Feature_75` + -0.05251515510654496 * `ADS`.`Feature_76` + -0.008129168070159117 * `ADS`.`Feature_77` + 0.024073160587983047 * `ADS`.`Feature_78` + -0.006364795719976009 * `ADS`.`Feature_79` + -0.00654807741942123 * `ADS`.`Feature_80` + -0.00816812576802637 * `ADS`.`Feature_81` + 0.014346832702083263 * `ADS`.`Feature_82` + 0.0010969674895255424 * `ADS`.`Feature_83` + 0.03210501181192094 * `ADS`.`Feature_84` + 0.05769706633073894 * `ADS`.`Feature_85` + 0.016469901120031875 * `ADS`.`Feature_86` + -0.0005126844265984666 * `ADS`.`Feature_87` + -0.011250093780948144 * `ADS`.`Feature_88` + -0.002073639741273449 * `ADS`.`Feature_89` + 0.026378690197386777 * `ADS`.`Feature_90` + -0.01576601211172714 * `ADS`.`Feature_91` + 0.035774186784525853 * `ADS`.`Feature_92` + 0.013345891650720813 * `ADS`.`Feature_93` + 0.035756952306624505 * `ADS`.`Feature_94` + 0.010339877786543238 * `ADS`.`Feature_95` + 0.01612270401092307 * `ADS`.`Feature_96` + -0.0036563138529405385 * `ADS`.`Feature_97` + -0.02375525160028787 * `ADS`.`Feature_98` + -0.05063940759848063 * `ADS`.`Feature_99` + -0.459517046113 AS `Score_1`, 0.006457547994360829 * `ADS`.`Feature_0` + 0.007434148524936231 * `ADS`.`Feature_1` + 0.014609550077023381 * `ADS`.`Feature_2` + -0.023420652318971037 * `ADS`.`Feature_3` + -0.010301329896759899 * `ADS`.`Feature_4` + 0.0012025895271026812 * `ADS`.`Feature_5` + 0.00723335188734215 * `ADS`.`Feature_6` + 0.015981047229309944 * `ADS`.`Feature_7` + 0.0011901944673961703 * `ADS`.`Feature_8` + 0.004418772825366864 * `ADS`.`Feature_9` + 0.036543438746238624 * `ADS`.`Feature_10` + 0.0024891577996115815 * `ADS`.`Feature_11` + -0.013827047863815176 * `ADS`.`Feature_12` + 0.003592911692352672 * `ADS`.`Feature_13` + 0.008344994572257961 * `ADS`.`Feature_14` + 0.01531806253860158 * `ADS`.`Feature_15` + 0.0020673988671780913 * `ADS`.`Feature_16` + -0.021167157250438936 * `ADS`.`Feature_17` + 0.023696636002444087 * `ADS`.`Feature_18` + 0.006958195289484029 * `ADS`.`Feature_19` + -0.011790925073407385 * `ADS`.`Feature_20` + -0.014984946546375794 * `ADS`.`Feature_21` + 0.005345288403592937 * `ADS`.`Feature_22` + 0.01837450933517408 * `ADS`.`Feature_23` + 6.300174235291528e-05 * `ADS`.`Feature_24` + -0.003598808317177949 * `ADS`.`Feature_25` + 0.0013816817326096353 * `ADS`.`Feature_26` + 0.009027869291749611 * `ADS`.`Feature_27` + 0.004372876654611499 * `ADS`.`Feature_28` + 0.05174570433759926 * `ADS`.`Feature_29` + 0.00034454162847525824 * `ADS`.`Feature_30` + 0.0014315117791164397 * `ADS`.`Feature_31` + 0.04024349667476837 * `ADS`.`Feature_32` + 0.005967201692486667 * `ADS`.`Feature_33` + -0.006362394479592502 * `ADS`.`Feature_34` + 0.00108437281795817 * `ADS`.`Feature_35` + -0.002387086936704445 * `ADS`.`Feature_36` + 0.01862525935806775 * `ADS`.`Feature_37` + 0.0071764442430844195 * `ADS`.`Feature_38` + 0.016978395007013477 * `ADS`.`Feature_39` + 0.006271670329805173 * `ADS`.`Feature_40` + -0.0018231990197366509 * `ADS`.`Feature_41` + -0.0001017915061949288 * `ADS`.`Feature_42` + -0.024026596097061863 * `ADS`.`Feature_43` + 0.0017979106452064295 * `ADS`.`Feature_44` + -0.009439826710595843 * `ADS`.`Feature_45` + -0.012067240304558878 * `ADS`.`Feature_46` + 0.00851506390708643 * `ADS`.`Feature_47` + 0.02203090988429469 * `ADS`.`Feature_48` + 0.034327718173301436 * `ADS`.`Feature_49` + 0.018308101154715855 * `ADS`.`Feature_50` + -0.008473283029447054 * `ADS`.`Feature_51` + -0.04985658492102528 * `ADS`.`Feature_52` + 0.0035041096826581956 * `ADS`.`Feature_53` + -0.016063846757149003 * `ADS`.`Feature_54` + -0.009391418117974008 * `ADS`.`Feature_55` + -0.032416325768406036 * `ADS`.`Feature_56` + -0.014068599694396604 * `ADS`.`Feature_57` + -0.008633167818478373 * `ADS`.`Feature_58` + -0.00361951196099416 * `ADS`.`Feature_59` + 0.0029319432185317884 * `ADS`.`Feature_60` + -0.0028525667629967625 * `ADS`.`Feature_61` + -0.014810742420505993 * `ADS`.`Feature_62` + -0.005665144698409188 * `ADS`.`Feature_63` + 0.012707385748556187 * `ADS`.`Feature_64` + 0.011142088260426062 * `ADS`.`Feature_65` + -0.003659470859974783 * `ADS`.`Feature_66` + -0.00360151858449834 * `ADS`.`Feature_67` + -0.04453132779036108 * `ADS`.`Feature_68` + 0.029774880954156396 * `ADS`.`Feature_69` + -0.0037311878083478656 * `ADS`.`Feature_70` + -0.027632370445665383 * `ADS`.`Feature_71` + 0.004256855985513932 * `ADS`.`Feature_72` + 0.00224307322766786 * `ADS`.`Feature_73` + 0.0022407450658147665 * `ADS`.`Feature_74` + -0.009996746441138252 * `ADS`.`Feature_75` + 0.017415833973865764 * `ADS`.`Feature_76` + 0.002344956816753062 * `ADS`.`Feature_77` + -0.02701553945247111 * `ADS`.`Feature_78` + -0.012923449261111448 * `ADS`.`Feature_79` + -0.01085403821628326 * `ADS`.`Feature_80` + 0.006997491157318145 * `ADS`.`Feature_81` + -0.014965826001200878 * `ADS`.`Feature_82` + 0.015621317047228809 * `ADS`.`Feature_83` + -0.05418078056643568 * `ADS`.`Feature_84` + -0.04157750118608066 * `ADS`.`Feature_85` + -0.03544586268379112 * `ADS`.`Feature_86` + -0.0033138048534786177 * `ADS`.`Feature_87` + 0.012958737242828863 * `ADS`.`Feature_88` + 0.0001736089521919091 * `ADS`.`Feature_89` + -0.0030207002351622355 * `ADS`.`Feature_90` + 0.028393161047347456 * `ADS`.`Feature_91` + -0.02500846982916975 * `ADS`.`Feature_92` + -0.013949072445189356 * `ADS`.`Feature_93` + -0.010812546802679237 * `ADS`.`Feature_94` + -0.019250132105362985 * `ADS`.`Feature_95` + -0.009740614925016834 * `ADS`.`Feature_96` + 0.0035380260305121628 * `ADS`.`Feature_97` + 0.0512588879783109 * `ADS`.`Feature_98` + 0.03864482035303294 * `ADS`.`Feature_99` + -0.53329004081 AS `Score_2`, -0.0028654726587223527 * `ADS`.`Feature_0` + 0.00010773488854000428 * `ADS`.`Feature_1` + -0.0006482467682261006 * `ADS`.`Feature_2` + -0.009323478807668375 * `ADS`.`Feature_3` + 0.02353990563796549 * `ADS`.`Feature_4` + 0.004821471200830555 * `ADS`.`Feature_5` + -0.0062333653310914314 * `ADS`.`Feature_6` + -0.001116337122673772 * `ADS`.`Feature_7` + -0.0034667904694420334 * `ADS`.`Feature_8` + 0.004955393413493867 * `ADS`.`Feature_9` + 0.014845946914142334 * `ADS`.`Feature_10` + -0.017756047877278535 * `ADS`.`Feature_11` + 0.008988054168341862 * `ADS`.`Feature_12` + 0.0010412972396875724 * `ADS`.`Feature_13` + -0.002034793696161984 * `ADS`.`Feature_14` + -0.04246849426102642 * `ADS`.`Feature_15` + 0.0017680713036481172 * `ADS`.`Feature_16` + -0.0016444832122259998 * `ADS`.`Feature_17` + -0.00021566083994472695 * `ADS`.`Feature_18` + 0.001351917511747962 * `ADS`.`Feature_19` + 0.03570223473902294 * `ADS`.`Feature_20` + -0.008007322677784801 * `ADS`.`Feature_21` + -0.011515303842972828 * `ADS`.`Feature_22` + 0.0030106630397813802 * `ADS`.`Feature_23` + -0.015493191870808257 * `ADS`.`Feature_24` + -0.0001585755156851485 * `ADS`.`Feature_25` + -0.01596338685608028 * `ADS`.`Feature_26` + -0.015495809183289997 * `ADS`.`Feature_27` + -0.020359729396947582 * `ADS`.`Feature_28` + -0.03345103950273403 * `ADS`.`Feature_29` + -0.014848051867071825 * `ADS`.`Feature_30` + -0.0007392153479083027 * `ADS`.`Feature_31` + -0.03312241971928818 * `ADS`.`Feature_32` + -0.036357049628507034 * `ADS`.`Feature_33` + 0.002429367733996791 * `ADS`.`Feature_34` + -0.002623021192866123 * `ADS`.`Feature_35` + 0.00033231467300376156 * `ADS`.`Feature_36` + -0.0069818659595337835 * `ADS`.`Feature_37` + -0.0026257042207629986 * `ADS`.`Feature_38` + -0.012734863990359679 * `ADS`.`Feature_39` + -0.003795259257028303 * `ADS`.`Feature_40` + -0.013019426193839119 * `ADS`.`Feature_41` + 0.002610490869407642 * `ADS`.`Feature_42` + -0.007478046037723495 * `ADS`.`Feature_43` + -0.0022612942855382815 * `ADS`.`Feature_44` + -0.021707898707285293 * `ADS`.`Feature_45` + 0.022378062187829593 * `ADS`.`Feature_46` + -0.013800221613714973 * `ADS`.`Feature_47` + -0.05015338044875711 * `ADS`.`Feature_48` + -0.030784200829207593 * `ADS`.`Feature_49` + -0.006711866727477719 * `ADS`.`Feature_50` + 0.0011107166758038997 * `ADS`.`Feature_51` + 0.02972789480462847 * `ADS`.`Feature_52` + -4.920821799096184e-05 * `ADS`.`Feature_53` + 0.013499902401678646 * `ADS`.`Feature_54` + 0.01172722228466839 * `ADS`.`Feature_55` + 0.01672282000749836 * `ADS`.`Feature_56` + 0.0072085165416433256 * `ADS`.`Feature_57` + 0.0023370409053778875 * `ADS`.`Feature_58` + 0.014878211823445429 * `ADS`.`Feature_59` + 0.0016970751195295132 * `ADS`.`Feature_60` + 0.007021045762821856 * `ADS`.`Feature_61` + 0.008281182598666895 * `ADS`.`Feature_62` + 0.0016060486287083932 * `ADS`.`Feature_63` + -0.0035453604177801863 * `ADS`.`Feature_64` + -0.010057055073390829 * `ADS`.`Feature_65` + 0.008946981121377097 * `ADS`.`Feature_66` + -0.015574884726986704 * `ADS`.`Feature_67` + 0.020300588233144606 * `ADS`.`Feature_68` + 0.011566171225807052 * `ADS`.`Feature_69` + 0.023241110874020962 * `ADS`.`Feature_70` + 0.00921513985620606 * `ADS`.`Feature_71` + 0.004049792282040174 * `ADS`.`Feature_72` + 0.019388287844463285 * `ADS`.`Feature_73` + 3.567893328037947e-05 * `ADS`.`Feature_74` + 0.00417267308254292 * `ADS`.`Feature_75` + 0.0068876454648549145 * `ADS`.`Feature_76` + 0.003632710562314276 * `ADS`.`Feature_77` + -0.005006893582092452 * `ADS`.`Feature_78` + 0.004729645724156098 * `ADS`.`Feature_79` + 0.022745603189100176 * `ADS`.`Feature_80` + 0.0033627893713384627 * `ADS`.`Feature_81` + 0.002999218567060953 * `ADS`.`Feature_82` + -0.017459183405128715 * `ADS`.`Feature_83` + 0.048073158826840455 * `ADS`.`Feature_84` + 0.009304678247655622 * `ADS`.`Feature_85` + 0.008967973386924533 * `ADS`.`Feature_86` + 0.018370378765379138 * `ADS`.`Feature_87` + 0.000609972154968172 * `ADS`.`Feature_88` + -0.01790268778253732 * `ADS`.`Feature_89` + -0.0036436162044368456 * `ADS`.`Feature_90` + -0.005329337163139457 * `ADS`.`Feature_91` + 0.02239263628463939 * `ADS`.`Feature_92` + 0.004265664302210805 * `ADS`.`Feature_93` + -0.025713180706657023 * `ADS`.`Feature_94` + 0.0038468942299533133 * `ADS`.`Feature_95` + -0.010990994623523428 * `ADS`.`Feature_96` + -0.009530412337599934 * `ADS`.`Feature_97` + 0.005886815642142681 * `ADS`.`Feature_98` + 0.00908834227773231 * `ADS`.`Feature_99` + -0.37859669768 AS `Score_3` 
FROM `FourClass_100` AS `ADS`), 
orig_cte AS 
(SELECT linear_model_cte.`KEY` AS `KEY`, linear_model_cte.`Score_0` AS `Score_0`, linear_model_cte.`Score_1` AS `Score_1`, linear_model_cte.`Score_2` AS `Score_2`, linear_model_cte.`Score_3` AS `Score_3`, NULL AS `Proba_0`, NULL AS `Proba_1`, NULL AS `Proba_2`, NULL AS `Proba_3`, NULL AS `LogProba_0`, NULL AS `LogProba_1`, NULL AS `LogProba_2`, NULL AS `LogProba_3`, NULL AS `Decision` 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu.`KEY_u` AS `KEY_u`, scu.class AS class, scu.`LogProba` AS `LogProba`, scu.`Proba` AS `Proba`, scu.`Score` AS `Score` 
FROM (SELECT orig_cte.`KEY` AS `KEY_u`, 0 AS class, orig_cte.`LogProba_0` AS `LogProba`, orig_cte.`Proba_0` AS `Proba`, orig_cte.`Score_0` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 1 AS class, orig_cte.`LogProba_1` AS `LogProba`, orig_cte.`Proba_1` AS `Proba`, orig_cte.`Score_1` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 2 AS class, orig_cte.`LogProba_2` AS `LogProba`, orig_cte.`Proba_2` AS `Proba`, orig_cte.`Score_2` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 3 AS class, orig_cte.`LogProba_3` AS `LogProba`, orig_cte.`Proba_3` AS `Proba`, orig_cte.`Score_3` AS `Score` 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.`KEY` AS `KEY`, orig_cte.`Score_0` AS `Score_0`, orig_cte.`Score_1` AS `Score_1`, orig_cte.`Score_2` AS `Score_2`, orig_cte.`Score_3` AS `Score_3`, orig_cte.`Proba_0` AS `Proba_0`, orig_cte.`Proba_1` AS `Proba_1`, orig_cte.`Proba_2` AS `Proba_2`, orig_cte.`Proba_3` AS `Proba_3`, orig_cte.`LogProba_0` AS `LogProba_0`, orig_cte.`LogProba_1` AS `LogProba_1`, orig_cte.`LogProba_2` AS `LogProba_2`, orig_cte.`LogProba_3` AS `LogProba_3`, orig_cte.`Decision` AS `Decision`, max_select.`KEY_m` AS `KEY_m`, max_select.`max_LogProba` AS `max_LogProba`, max_select.`max_Proba` AS `max_Proba`, max_select.`max_Score` AS `max_Score` 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union.`KEY_u` AS `KEY_m`, max(score_class_union.`LogProba`) AS `max_LogProba`, max(score_class_union.`Proba`) AS `max_Proba`, max(score_class_union.`Score`) AS `max_Score` 
FROM score_class_union GROUP BY score_class_union.`KEY_u`) AS max_select ON orig_cte.`KEY` = max_select.`KEY_m`), 
union_with_max AS 
(SELECT score_class_union.`KEY_u` AS `KEY_u`, score_class_union.class AS class, score_class_union.`LogProba` AS `LogProba`, score_class_union.`Proba` AS `Proba`, score_class_union.`Score` AS `Score`, score_max.`KEY` AS `KEY`, score_max.`Score_0` AS `Score_0`, score_max.`Score_1` AS `Score_1`, score_max.`Score_2` AS `Score_2`, score_max.`Score_3` AS `Score_3`, score_max.`Proba_0` AS `Proba_0`, score_max.`Proba_1` AS `Proba_1`, score_max.`Proba_2` AS `Proba_2`, score_max.`Proba_3` AS `Proba_3`, score_max.`LogProba_0` AS `LogProba_0`, score_max.`LogProba_1` AS `LogProba_1`, score_max.`LogProba_2` AS `LogProba_2`, score_max.`LogProba_3` AS `LogProba_3`, score_max.`Decision` AS `Decision`, score_max.`KEY_m` AS `KEY_m`, score_max.`max_LogProba` AS `max_LogProba`, score_max.`max_Proba` AS `max_Proba`, score_max.`max_Score` AS `max_Score` 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union.`KEY_u` = score_max.`KEY`), 
arg_max_cte AS 
(SELECT score_max.`KEY` AS `KEY`, score_max.`Score_0` AS `Score_0`, score_max.`Score_1` AS `Score_1`, score_max.`Score_2` AS `Score_2`, score_max.`Score_3` AS `Score_3`, score_max.`Proba_0` AS `Proba_0`, score_max.`Proba_1` AS `Proba_1`, score_max.`Proba_2` AS `Proba_2`, score_max.`Proba_3` AS `Proba_3`, score_max.`LogProba_0` AS `LogProba_0`, score_max.`LogProba_1` AS `LogProba_1`, score_max.`LogProba_2` AS `LogProba_2`, score_max.`LogProba_3` AS `LogProba_3`, score_max.`Decision` AS `Decision`, score_max.`KEY_m` AS `KEY_m`, score_max.`max_LogProba` AS `max_LogProba`, score_max.`max_Proba` AS `max_Proba`, score_max.`max_Score` AS `max_Score`, `arg_max_t_Score`.`KEY_Score` AS `KEY_Score`, `arg_max_t_Score`.`arg_max_Score` AS `arg_max_Score` 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max.`KEY` AS `KEY_Score`, min(union_with_max.class) AS `arg_max_Score` 
FROM union_with_max 
WHERE union_with_max.`max_Score` = union_with_max.`Score` GROUP BY union_with_max.`KEY`) AS `arg_max_t_Score` ON score_max.`KEY` = `arg_max_t_Score`.`KEY_Score`)
 SELECT arg_max_cte.`KEY` AS `KEY`, arg_max_cte.`Score_0` AS `Score_0`, arg_max_cte.`Score_1` AS `Score_1`, arg_max_cte.`Score_2` AS `Score_2`, arg_max_cte.`Score_3` AS `Score_3`, arg_max_cte.`Proba_0` AS `Proba_0`, arg_max_cte.`Proba_1` AS `Proba_1`, arg_max_cte.`Proba_2` AS `Proba_2`, arg_max_cte.`Proba_3` AS `Proba_3`, CASE WHEN (arg_max_cte.`Proba_0` IS NULL OR arg_max_cte.`Proba_0` > 0.0) THEN ln(arg_max_cte.`Proba_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (arg_max_cte.`Proba_1` IS NULL OR arg_max_cte.`Proba_1` > 0.0) THEN ln(arg_max_cte.`Proba_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (arg_max_cte.`Proba_2` IS NULL OR arg_max_cte.`Proba_2` > 0.0) THEN ln(arg_max_cte.`Proba_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, CASE WHEN (arg_max_cte.`Proba_3` IS NULL OR arg_max_cte.`Proba_3` > 0.0) THEN ln(arg_max_cte.`Proba_3`) ELSE -1.79769313486231e+308 END AS `LogProba_3`, arg_max_cte.`arg_max_Score` AS `Decision` 
FROM arg_max_cte