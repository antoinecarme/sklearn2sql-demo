-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH linear_model_cte AS 
(SELECT `ADS`.`KEY` AS `KEY`, 0.00563028094525002 * `ADS`.`Feature_0` + 0.003372723688099542 * `ADS`.`Feature_1` + -0.00021393147197965132 * `ADS`.`Feature_2` + 0.030921649952087498 * `ADS`.`Feature_3` + -0.010990200017580064 * `ADS`.`Feature_4` + -0.001906644926203263 * `ADS`.`Feature_5` + -0.0346010300213817 * `ADS`.`Feature_6` + -0.006282501230155117 * `ADS`.`Feature_7` + 0.005725629426577692 * `ADS`.`Feature_8` + -0.01827884394127371 * `ADS`.`Feature_9` + 0.01090630548565887 * `ADS`.`Feature_10` + 0.025593700035772472 * `ADS`.`Feature_11` + 0.006180246106730601 * `ADS`.`Feature_12` + 0.0056372190518575865 * `ADS`.`Feature_13` + -0.005782415236759936 * `ADS`.`Feature_14` + 0.04782154321349546 * `ADS`.`Feature_15` + -0.007421260654849623 * `ADS`.`Feature_16` + 0.03496418384495525 * `ADS`.`Feature_17` + -0.026031713925060443 * `ADS`.`Feature_18` + -0.004577058748842927 * `ADS`.`Feature_19` + 0.010668665726463262 * `ADS`.`Feature_20` + -0.006275171426424496 * `ADS`.`Feature_21` + 0.00289020075430273 * `ADS`.`Feature_22` + -0.00039197453917935704 * `ADS`.`Feature_23` + 0.022927607780519586 * `ADS`.`Feature_24` + -0.00341038321918376 * `ADS`.`Feature_25` + 0.02014079519889352 * `ADS`.`Feature_26` + -0.00227463955320074 * `ADS`.`Feature_27` + 0.0076199344861088494 * `ADS`.`Feature_28` + 0.027422819578498264 * `ADS`.`Feature_29` + 0.028218795570531092 * `ADS`.`Feature_30` + 0.016300048730502757 * `ADS`.`Feature_31` + -0.024069476137919963 * `ADS`.`Feature_32` + -0.0053205350012870255 * `ADS`.`Feature_33` + 0.01589806204110429 * `ADS`.`Feature_34` + 0.009530610374349777 * `ADS`.`Feature_35` + 0.010935979560616718 * `ADS`.`Feature_36` + 0.008618907298511457 * `ADS`.`Feature_37` + -0.003252068637361844 * `ADS`.`Feature_38` + -0.0026604710260810455 * `ADS`.`Feature_39` + -0.006703975658365947 * `ADS`.`Feature_40` + 0.01801205379448012 * `ADS`.`Feature_41` + 0.012727702287573271 * `ADS`.`Feature_42` + 0.0037872875295549193 * `ADS`.`Feature_43` + 0.004254389728632589 * `ADS`.`Feature_44` + -0.002919575509475474 * `ADS`.`Feature_45` + -0.012062510675165951 * `ADS`.`Feature_46` + -0.002732755529032526 * `ADS`.`Feature_47` + 0.011645630452030724 * `ADS`.`Feature_48` + -0.008456994625373396 * `ADS`.`Feature_49` + 0.00644395788678898 * `ADS`.`Feature_50` + 0.008661426261890504 * `ADS`.`Feature_51` + 0.002932277562504361 * `ADS`.`Feature_52` + -0.007902940084128455 * `ADS`.`Feature_53` + -0.006290886254439589 * `ADS`.`Feature_54` + 0.003927183224662606 * `ADS`.`Feature_55` + -0.028946303107399943 * `ADS`.`Feature_56` + -0.009475314775531771 * `ADS`.`Feature_57` + 0.0014386639304567906 * `ADS`.`Feature_58` + -0.02711478101492309 * `ADS`.`Feature_59` + 0.0018284600884055403 * `ADS`.`Feature_60` + 0.00320308453537597 * `ADS`.`Feature_61` + 0.007753640058070355 * `ADS`.`Feature_62` + 0.006802086632449047 * `ADS`.`Feature_63` + 0.0021992532714298616 * `ADS`.`Feature_64` + 0.007936378899781367 * `ADS`.`Feature_65` + -0.011285676837564908 * `ADS`.`Feature_66` + 0.012276795243229326 * `ADS`.`Feature_67` + -0.0213451388629796 * `ADS`.`Feature_68` + -0.012383507563705425 * `ADS`.`Feature_69` + -0.011970569080326026 * `ADS`.`Feature_70` + -0.010943012332094182 * `ADS`.`Feature_71` + -0.028447456551269547 * `ADS`.`Feature_72` + -0.00037508022895163843 * `ADS`.`Feature_73` + -0.010737215243966551 * `ADS`.`Feature_74` + 0.0021463328316237164 * `ADS`.`Feature_75` + 0.028211675667824256 * `ADS`.`Feature_76` + 0.0021515006910917877 * `ADS`.`Feature_77` + 0.007949272446580499 * `ADS`.`Feature_78` + 0.014558599256931369 * `ADS`.`Feature_79` + -0.005343487553395685 * `ADS`.`Feature_80` + -0.0021921547606302363 * `ADS`.`Feature_81` + -0.002380225267943348 * `ADS`.`Feature_82` + 0.0007408988683743698 * `ADS`.`Feature_83` + -0.025997390072325755 * `ADS`.`Feature_84` + -0.025424243392313944 * `ADS`.`Feature_85` + 0.010007988176834725 * `ADS`.`Feature_86` + -0.01454388948530206 * `ADS`.`Feature_87` + -0.0023186156168488988 * `ADS`.`Feature_88` + 0.019802718571618867 * `ADS`.`Feature_89` + -0.019714373757787708 * `ADS`.`Feature_90` + -0.007297811772480806 * `ADS`.`Feature_91` + -0.033158353239995504 * `ADS`.`Feature_92` + -0.003662483507742259 * `ADS`.`Feature_93` + 0.0007687752027117704 * `ADS`.`Feature_94` + 0.005063360088866435 * `ADS`.`Feature_95` + 0.004608905537617182 * `ADS`.`Feature_96` + 0.00964870016002831 * `ADS`.`Feature_97` + -0.03339045202016575 * `ADS`.`Feature_98` + 0.002906244967715378 * `ADS`.`Feature_99` + -0.628596215397 AS `Score_0`, -0.009222356280888489 * `ADS`.`Feature_0` + -0.01091460710157578 * `ADS`.`Feature_1` + -0.01374737183681762 * `ADS`.`Feature_2` + 0.0018224811745519084 * `ADS`.`Feature_3` + -0.002248375723625506 * `ADS`.`Feature_4` + -0.004117415801729972 * `ADS`.`Feature_5` + 0.033601043465130945 * `ADS`.`Feature_6` + -0.008582208876481043 * `ADS`.`Feature_7` + -0.003449033424531827 * `ADS`.`Feature_8` + 0.008904677702412983 * `ADS`.`Feature_9` + -0.06229569114603978 * `ADS`.`Feature_10` + -0.01032680995810551 * `ADS`.`Feature_11` + -0.0013412524112572915 * `ADS`.`Feature_12` + -0.010271427983897831 * `ADS`.`Feature_13` + -0.0005277856393360457 * `ADS`.`Feature_14` + -0.020671111491070614 * `ADS`.`Feature_15` + 0.00358579048402342 * `ADS`.`Feature_16` + -0.012152543382290317 * `ADS`.`Feature_17` + 0.0025507387625610875 * `ADS`.`Feature_18` + -0.0037330540523890635 * `ADS`.`Feature_19` + -0.03457997539207881 * `ADS`.`Feature_20` + 0.029267440650585067 * `ADS`.`Feature_21` + 0.0032798146850771532 * `ADS`.`Feature_22` + -0.020993197835776085 * `ADS`.`Feature_23` + -0.007497417652064251 * `ADS`.`Feature_24` + 0.0071677670520468575 * `ADS`.`Feature_25` + -0.0055590900754229015 * `ADS`.`Feature_26` + 0.00874257944474112 * `ADS`.`Feature_27` + 0.008366918256227226 * `ADS`.`Feature_28` + -0.045717484413363485 * `ADS`.`Feature_29` + -0.013715285331934508 * `ADS`.`Feature_30` + -0.016992345161710908 * `ADS`.`Feature_31` + 0.016948399182439778 * `ADS`.`Feature_32` + 0.03571038293730738 * `ADS`.`Feature_33` + -0.011965035295508549 * `ADS`.`Feature_34` + -0.007991961999441832 * `ADS`.`Feature_35` + -0.00888120729691603 * `ADS`.`Feature_36` + -0.02026230069704541 * `ADS`.`Feature_37` + -0.0012986713849595774 * `ADS`.`Feature_38` + -0.0015830599905727438 * `ADS`.`Feature_39` + 0.004227564585589084 * `ADS`.`Feature_40` + -0.0031694285809043586 * `ADS`.`Feature_41` + -0.015236401650785979 * `ADS`.`Feature_42` + 0.027717354605230442 * `ADS`.`Feature_43` + -0.0037910060883007343 * `ADS`.`Feature_44` + 0.0340673009273566 * `ADS`.`Feature_45` + 0.0017516887918952347 * `ADS`.`Feature_46` + 0.008017913235661062 * `ADS`.`Feature_47` + 0.01647684011243168 * `ADS`.`Feature_48` + 0.004913477281279579 * `ADS`.`Feature_49` + -0.018040192314027096 * `ADS`.`Feature_50` + -0.0012988599082473513 * `ADS`.`Feature_51` + 0.017196412553892433 * `ADS`.`Feature_52` + 0.004448038619461225 * `ADS`.`Feature_53` + 0.00885483060990995 * `ADS`.`Feature_54` + -0.00626298739135701 * `ADS`.`Feature_55` + 0.044639808868307596 * `ADS`.`Feature_56` + 0.01633539792828504 * `ADS`.`Feature_57` + 0.004857462982643694 * `ADS`.`Feature_58` + 0.015856081152471807 * `ADS`.`Feature_59` + -0.00645747842646684 * `ADS`.`Feature_60` + -0.007371563535201062 * `ADS`.`Feature_61` + -0.00122408023623128 * `ADS`.`Feature_62` + -0.002742990562748251 * `ADS`.`Feature_63` + -0.01136127860220585 * `ADS`.`Feature_64` + -0.009021412086816595 * `ADS`.`Feature_65` + 0.005998166576162597 * `ADS`.`Feature_66` + 0.006899608068255712 * `ADS`.`Feature_67` + 0.04557587842019604 * `ADS`.`Feature_68` + -0.02895754461625801 * `ADS`.`Feature_69` + -0.007539353985347065 * `ADS`.`Feature_70` + 0.029360242921553464 * `ADS`.`Feature_71` + 0.020140808283715443 * `ADS`.`Feature_72` + -0.021256280843179515 * `ADS`.`Feature_73` + 0.008460791244871403 * `ADS`.`Feature_74` + 0.003677740526971614 * `ADS`.`Feature_75` + -0.05251515510654496 * `ADS`.`Feature_76` + -0.00812916807015912 * `ADS`.`Feature_77` + 0.024073160587983054 * `ADS`.`Feature_78` + -0.006364795719976 * `ADS`.`Feature_79` + -0.0065480774194212315 * `ADS`.`Feature_80` + -0.008168125768026363 * `ADS`.`Feature_81` + 0.014346832702083267 * `ADS`.`Feature_82` + 0.0010969674895255459 * `ADS`.`Feature_83` + 0.032105011811920964 * `ADS`.`Feature_84` + 0.05769706633073894 * `ADS`.`Feature_85` + 0.016469901120031858 * `ADS`.`Feature_86` + -0.0005126844265984647 * `ADS`.`Feature_87` + -0.011250093780948139 * `ADS`.`Feature_88` + -0.0020736397412734597 * `ADS`.`Feature_89` + 0.026378690197386773 * `ADS`.`Feature_90` + -0.01576601211172716 * `ADS`.`Feature_91` + 0.03577418678452585 * `ADS`.`Feature_92` + 0.013345891650720807 * `ADS`.`Feature_93` + 0.035756952306624484 * `ADS`.`Feature_94` + 0.01033987778654323 * `ADS`.`Feature_95` + 0.016122704010923077 * `ADS`.`Feature_96` + -0.00365631385294054 * `ADS`.`Feature_97` + -0.023755251600287824 * `ADS`.`Feature_98` + -0.050639407598480596 * `ADS`.`Feature_99` + -0.459517046113 AS `Score_1`, 0.006457547994360815 * `ADS`.`Feature_0` + 0.007434148524936234 * `ADS`.`Feature_1` + 0.014609550077023373 * `ADS`.`Feature_2` + -0.023420652318971023 * `ADS`.`Feature_3` + -0.010301329896759921 * `ADS`.`Feature_4` + 0.0012025895271026827 * `ADS`.`Feature_5` + 0.007233351887342133 * `ADS`.`Feature_6` + 0.01598104722930995 * `ADS`.`Feature_7` + 0.0011901944673961627 * `ADS`.`Feature_8` + 0.004418772825366869 * `ADS`.`Feature_9` + 0.03654343874623863 * `ADS`.`Feature_10` + 0.0024891577996115884 * `ADS`.`Feature_11` + -0.01382704786381517 * `ADS`.`Feature_12` + 0.0035929116923526724 * `ADS`.`Feature_13` + 0.008344994572257975 * `ADS`.`Feature_14` + 0.015318062538601566 * `ADS`.`Feature_15` + 0.002067398867178076 * `ADS`.`Feature_16` + -0.021167157250438964 * `ADS`.`Feature_17` + 0.023696636002444052 * `ADS`.`Feature_18` + 0.0069581952894840335 * `ADS`.`Feature_19` + -0.011790925073407395 * `ADS`.`Feature_20` + -0.014984946546375763 * `ADS`.`Feature_21` + 0.00534528840359293 * `ADS`.`Feature_22` + 0.01837450933517409 * `ADS`.`Feature_23` + 6.30017423529439e-05 * `ADS`.`Feature_24` + -0.003598808317177955 * `ADS`.`Feature_25` + 0.0013816817326096388 * `ADS`.`Feature_26` + 0.009027869291749611 * `ADS`.`Feature_27` + 0.004372876654611477 * `ADS`.`Feature_28` + 0.051745704337599306 * `ADS`.`Feature_29` + 0.0003445416284752374 * `ADS`.`Feature_30` + 0.0014315117791164674 * `ADS`.`Feature_31` + 0.04024349667476836 * `ADS`.`Feature_32` + 0.005967201692486643 * `ADS`.`Feature_33` + -0.006362394479592517 * `ADS`.`Feature_34` + 0.0010843728179581657 * `ADS`.`Feature_35` + -0.0023870869367044532 * `ADS`.`Feature_36` + 0.01862525935806774 * `ADS`.`Feature_37` + 0.007176444243084436 * `ADS`.`Feature_38` + 0.01697839500701347 * `ADS`.`Feature_39` + 0.006271670329805173 * `ADS`.`Feature_40` + -0.001823199019736643 * `ADS`.`Feature_41` + -0.0001017915061949249 * `ADS`.`Feature_42` + -0.02402659609706183 * `ADS`.`Feature_43` + 0.0017979106452064354 * `ADS`.`Feature_44` + -0.00943982671059585 * `ADS`.`Feature_45` + -0.012067240304558859 * `ADS`.`Feature_46` + 0.00851506390708643 * `ADS`.`Feature_47` + 0.02203090988429467 * `ADS`.`Feature_48` + 0.03432771817330138 * `ADS`.`Feature_49` + 0.018308101154715862 * `ADS`.`Feature_50` + -0.008473283029447054 * `ADS`.`Feature_51` + -0.049856584921025265 * `ADS`.`Feature_52` + 0.0035041096826582017 * `ADS`.`Feature_53` + -0.016063846757149006 * `ADS`.`Feature_54` + -0.00939141811797401 * `ADS`.`Feature_55` + -0.032416325768406 * `ADS`.`Feature_56` + -0.014068599694396604 * `ADS`.`Feature_57` + -0.008633167818478364 * `ADS`.`Feature_58` + -0.0036195119609941477 * `ADS`.`Feature_59` + 0.0029319432185317936 * `ADS`.`Feature_60` + -0.0028525667629967608 * `ADS`.`Feature_61` + -0.01481074242050602 * `ADS`.`Feature_62` + -0.005665144698409193 * `ADS`.`Feature_63` + 0.012707385748556177 * `ADS`.`Feature_64` + 0.011142088260426066 * `ADS`.`Feature_65` + -0.0036594708599747773 * `ADS`.`Feature_66` + -0.003601518584498295 * `ADS`.`Feature_67` + -0.04453132779036109 * `ADS`.`Feature_68` + 0.029774880954156393 * `ADS`.`Feature_69` + -0.0037311878083478604 * `ADS`.`Feature_70` + -0.02763237044566533 * `ADS`.`Feature_71` + 0.0042568559855139165 * `ADS`.`Feature_72` + 0.002243073227667867 * `ADS`.`Feature_73` + 0.002240745065814746 * `ADS`.`Feature_74` + -0.009996746441138248 * `ADS`.`Feature_75` + 0.017415833973865757 * `ADS`.`Feature_76` + 0.0023449568167530745 * `ADS`.`Feature_77` + -0.027015539452471145 * `ADS`.`Feature_78` + -0.01292344926111149 * `ADS`.`Feature_79` + -0.010854038216283272 * `ADS`.`Feature_80` + 0.00699749115731815 * `ADS`.`Feature_81` + -0.014965826001200864 * `ADS`.`Feature_82` + 0.015621317047228788 * `ADS`.`Feature_83` + -0.05418078056643568 * `ADS`.`Feature_84` + -0.04157750118608068 * `ADS`.`Feature_85` + -0.03544586268379114 * `ADS`.`Feature_86` + -0.003313804853478596 * `ADS`.`Feature_87` + 0.01295873724282887 * `ADS`.`Feature_88` + 0.00017360895219190996 * `ADS`.`Feature_89` + -0.0030207002351622563 * `ADS`.`Feature_90` + 0.028393161047347463 * `ADS`.`Feature_91` + -0.025008469829169745 * `ADS`.`Feature_92` + -0.013949072445189354 * `ADS`.`Feature_93` + -0.010812546802679235 * `ADS`.`Feature_94` + -0.019250132105362982 * `ADS`.`Feature_95` + -0.009740614925016856 * `ADS`.`Feature_96` + 0.0035380260305121676 * `ADS`.`Feature_97` + 0.05125888797831093 * `ADS`.`Feature_98` + 0.038644820353032926 * `ADS`.`Feature_99` + -0.53329004081 AS `Score_2`, -0.002865472658722345 * `ADS`.`Feature_0` + 0.00010773488854000674 * `ADS`.`Feature_1` + -0.0006482467682260994 * `ADS`.`Feature_2` + -0.009323478807668394 * `ADS`.`Feature_3` + 0.023539905637965503 * `ADS`.`Feature_4` + 0.004821471200830556 * `ADS`.`Feature_5` + -0.006233365331091412 * `ADS`.`Feature_6` + -0.0011163371226737815 * `ADS`.`Feature_7` + -0.003466790469442027 * `ADS`.`Feature_8` + 0.004955393413493858 * `ADS`.`Feature_9` + 0.014845946914142323 * `ADS`.`Feature_10` + -0.017756047877278542 * `ADS`.`Feature_11` + 0.008988054168341857 * `ADS`.`Feature_12` + 0.0010412972396875739 * `ADS`.`Feature_13` + -0.002034793696161988 * `ADS`.`Feature_14` + -0.0424684942610264 * `ADS`.`Feature_15` + 0.001768071303648123 * `ADS`.`Feature_16` + -0.0016444832122259742 * `ADS`.`Feature_17` + -0.00021566083994470028 * `ADS`.`Feature_18` + 0.0013519175117479624 * `ADS`.`Feature_19` + 0.035702234739022946 * `ADS`.`Feature_20` + -0.008007322677784815 * `ADS`.`Feature_21` + -0.011515303842972812 * `ADS`.`Feature_22` + 0.0030106630397813638 * `ADS`.`Feature_23` + -0.015493191870808266 * `ADS`.`Feature_24` + -0.00015857551568513955 * `ADS`.`Feature_25` + -0.01596338685608027 * `ADS`.`Feature_26` + -0.015495809183289994 * `ADS`.`Feature_27` + -0.020359729396947555 * `ADS`.`Feature_28` + -0.03345103950273405 * `ADS`.`Feature_29` + -0.014848051867071816 * `ADS`.`Feature_30` + -0.0007392153479083231 * `ADS`.`Feature_31` + -0.03312241971928817 * `ADS`.`Feature_32` + -0.036357049628507006 * `ADS`.`Feature_33` + 0.0024293677339967935 * `ADS`.`Feature_34` + -0.002623021192866112 * `ADS`.`Feature_35` + 0.0003323146730037693 * `ADS`.`Feature_36` + -0.006981865959533777 * `ADS`.`Feature_37` + -0.0026257042207630077 * `ADS`.`Feature_38` + -0.012734863990359675 * `ADS`.`Feature_39` + -0.0037952592570283062 * `ADS`.`Feature_40` + -0.013019426193839119 * `ADS`.`Feature_41` + 0.002610490869407639 * `ADS`.`Feature_42` + -0.007478046037723515 * `ADS`.`Feature_43` + -0.002261294285538289 * `ADS`.`Feature_44` + -0.02170789870728528 * `ADS`.`Feature_45` + 0.02237806218782958 * `ADS`.`Feature_46` + -0.01380022161371496 * `ADS`.`Feature_47` + -0.050153380448757084 * `ADS`.`Feature_48` + -0.03078420082920756 * `ADS`.`Feature_49` + -0.006711866727477741 * `ADS`.`Feature_50` + 0.0011107166758039019 * `ADS`.`Feature_51` + 0.02972789480462847 * `ADS`.`Feature_52` + -4.920821799097523e-05 * `ADS`.`Feature_53` + 0.013499902401678648 * `ADS`.`Feature_54` + 0.011727222284668404 * `ADS`.`Feature_55` + 0.016722820007498352 * `ADS`.`Feature_56` + 0.0072085165416433325 * `ADS`.`Feature_57` + 0.002337040905377882 * `ADS`.`Feature_58` + 0.014878211823445417 * `ADS`.`Feature_59` + 0.0016970751195295288 * `ADS`.`Feature_60` + 0.007021045762821852 * `ADS`.`Feature_61` + 0.008281182598666907 * `ADS`.`Feature_62` + 0.0016060486287083982 * `ADS`.`Feature_63` + -0.003545360417780181 * `ADS`.`Feature_64` + -0.010057055073390827 * `ADS`.`Feature_65` + 0.00894698112137709 * `ADS`.`Feature_66` + -0.015574884726986723 * `ADS`.`Feature_67` + 0.020300588233144606 * `ADS`.`Feature_68` + 0.011566171225807038 * `ADS`.`Feature_69` + 0.023241110874020945 * `ADS`.`Feature_70` + 0.009215139856206067 * `ADS`.`Feature_71` + 0.004049792282040193 * `ADS`.`Feature_72` + 0.019388287844463285 * `ADS`.`Feature_73` + 3.567893328040414e-05 * `ADS`.`Feature_74` + 0.004172673082542917 * `ADS`.`Feature_75` + 0.006887645464854925 * `ADS`.`Feature_76` + 0.0036327105623142667 * `ADS`.`Feature_77` + -0.005006893582092432 * `ADS`.`Feature_78` + 0.004729645724156098 * `ADS`.`Feature_79` + 0.02274560318910018 * `ADS`.`Feature_80` + 0.0033627893713384584 * `ADS`.`Feature_81` + 0.002999218567060942 * `ADS`.`Feature_82` + -0.017459183405128705 * `ADS`.`Feature_83` + 0.04807315882684044 * `ADS`.`Feature_84` + 0.00930467824765565 * `ADS`.`Feature_85` + 0.008967973386924538 * `ADS`.`Feature_86` + 0.018370378765379124 * `ADS`.`Feature_87` + 0.0006099721549681763 * `ADS`.`Feature_88` + -0.017902687782537313 * `ADS`.`Feature_89` + -0.003643616204436827 * `ADS`.`Feature_90` + -0.005329337163139483 * `ADS`.`Feature_91` + 0.022392636284639365 * `ADS`.`Feature_92` + 0.004265664302210795 * `ADS`.`Feature_93` + -0.02571318070665705 * `ADS`.`Feature_94` + 0.003846894229953313 * `ADS`.`Feature_95` + -0.010990994623523412 * `ADS`.`Feature_96` + -0.009530412337599934 * `ADS`.`Feature_97` + 0.0058868156421426725 * `ADS`.`Feature_98` + 0.009088342277732319 * `ADS`.`Feature_99` + -0.37859669768 AS `Score_3` 
FROM `FourClass_100` AS `ADS`), 
orig_cte AS 
(SELECT linear_model_cte.`KEY` AS `KEY`, linear_model_cte.`Score_0` AS `Score_0`, linear_model_cte.`Score_1` AS `Score_1`, linear_model_cte.`Score_2` AS `Score_2`, linear_model_cte.`Score_3` AS `Score_3`, NULL AS `Proba_0`, NULL AS `Proba_1`, NULL AS `Proba_2`, NULL AS `Proba_3`, NULL AS `LogProba_0`, NULL AS `LogProba_1`, NULL AS `LogProba_2`, NULL AS `LogProba_3`, CAST(NULL AS SIGNED INTEGER) AS `Decision` 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu.`KEY_u` AS `KEY_u`, scu.class AS class, scu.`LogProba` AS `LogProba`, scu.`Proba` AS `Proba`, scu.`Score` AS `Score` 
FROM (SELECT orig_cte.`KEY` AS `KEY_u`, 0 AS class, orig_cte.`LogProba_0` AS `LogProba`, orig_cte.`Proba_0` AS `Proba`, orig_cte.`Score_0` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 1 AS class, orig_cte.`LogProba_1` AS `LogProba`, orig_cte.`Proba_1` AS `Proba`, orig_cte.`Score_1` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 2 AS class, orig_cte.`LogProba_2` AS `LogProba`, orig_cte.`Proba_2` AS `Proba`, orig_cte.`Score_2` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 3 AS class, orig_cte.`LogProba_3` AS `LogProba`, orig_cte.`Proba_3` AS `Proba`, orig_cte.`Score_3` AS `Score` 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.`KEY` AS `KEY`, orig_cte.`Score_0` AS `Score_0`, orig_cte.`Score_1` AS `Score_1`, orig_cte.`Score_2` AS `Score_2`, orig_cte.`Score_3` AS `Score_3`, orig_cte.`Proba_0` AS `Proba_0`, orig_cte.`Proba_1` AS `Proba_1`, orig_cte.`Proba_2` AS `Proba_2`, orig_cte.`Proba_3` AS `Proba_3`, orig_cte.`LogProba_0` AS `LogProba_0`, orig_cte.`LogProba_1` AS `LogProba_1`, orig_cte.`LogProba_2` AS `LogProba_2`, orig_cte.`LogProba_3` AS `LogProba_3`, orig_cte.`Decision` AS `Decision`, max_select.`KEY_m` AS `KEY_m`, max_select.`max_Score` AS `max_Score` 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union.`KEY_u` AS `KEY_m`, max(score_class_union.`Score`) AS `max_Score` 
FROM score_class_union GROUP BY score_class_union.`KEY_u`) AS max_select ON orig_cte.`KEY` = max_select.`KEY_m`), 
union_with_max AS 
(SELECT score_class_union.`KEY_u` AS `KEY_u`, score_class_union.class AS class, score_class_union.`LogProba` AS `LogProba`, score_class_union.`Proba` AS `Proba`, score_class_union.`Score` AS `Score`, score_max.`KEY` AS `KEY`, score_max.`Score_0` AS `Score_0`, score_max.`Score_1` AS `Score_1`, score_max.`Score_2` AS `Score_2`, score_max.`Score_3` AS `Score_3`, score_max.`Proba_0` AS `Proba_0`, score_max.`Proba_1` AS `Proba_1`, score_max.`Proba_2` AS `Proba_2`, score_max.`Proba_3` AS `Proba_3`, score_max.`LogProba_0` AS `LogProba_0`, score_max.`LogProba_1` AS `LogProba_1`, score_max.`LogProba_2` AS `LogProba_2`, score_max.`LogProba_3` AS `LogProba_3`, score_max.`Decision` AS `Decision`, score_max.`KEY_m` AS `KEY_m`, score_max.`max_Score` AS `max_Score` 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union.`KEY_u` = score_max.`KEY`), 
arg_max_cte AS 
(SELECT score_max.`KEY` AS `KEY`, score_max.`Score_0` AS `Score_0`, score_max.`Score_1` AS `Score_1`, score_max.`Score_2` AS `Score_2`, score_max.`Score_3` AS `Score_3`, score_max.`Proba_0` AS `Proba_0`, score_max.`Proba_1` AS `Proba_1`, score_max.`Proba_2` AS `Proba_2`, score_max.`Proba_3` AS `Proba_3`, score_max.`LogProba_0` AS `LogProba_0`, score_max.`LogProba_1` AS `LogProba_1`, score_max.`LogProba_2` AS `LogProba_2`, score_max.`LogProba_3` AS `LogProba_3`, score_max.`Decision` AS `Decision`, score_max.`KEY_m` AS `KEY_m`, score_max.`max_Score` AS `max_Score`, `arg_max_t_Score`.`KEY_Score` AS `KEY_Score`, `arg_max_t_Score`.`arg_max_Score` AS `arg_max_Score` 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max.`KEY` AS `KEY_Score`, min(union_with_max.class) AS `arg_max_Score` 
FROM union_with_max 
WHERE union_with_max.`max_Score` <= union_with_max.`Score` GROUP BY union_with_max.`KEY`) AS `arg_max_t_Score` ON score_max.`KEY` = `arg_max_t_Score`.`KEY_Score`)
 SELECT arg_max_cte.`KEY` AS `KEY`, arg_max_cte.`Score_0` AS `Score_0`, arg_max_cte.`Score_1` AS `Score_1`, arg_max_cte.`Score_2` AS `Score_2`, arg_max_cte.`Score_3` AS `Score_3`, arg_max_cte.`Proba_0` AS `Proba_0`, arg_max_cte.`Proba_1` AS `Proba_1`, arg_max_cte.`Proba_2` AS `Proba_2`, arg_max_cte.`Proba_3` AS `Proba_3`, CASE WHEN (arg_max_cte.`Proba_0` IS NULL OR arg_max_cte.`Proba_0` > 0.0) THEN ln(arg_max_cte.`Proba_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (arg_max_cte.`Proba_1` IS NULL OR arg_max_cte.`Proba_1` > 0.0) THEN ln(arg_max_cte.`Proba_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (arg_max_cte.`Proba_2` IS NULL OR arg_max_cte.`Proba_2` > 0.0) THEN ln(arg_max_cte.`Proba_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, CASE WHEN (arg_max_cte.`Proba_3` IS NULL OR arg_max_cte.`Proba_3` > 0.0) THEN ln(arg_max_cte.`Proba_3`) ELSE -1.79769313486231e+308 END AS `LogProba_3`, CAST(arg_max_cte.`arg_max_Score` AS SIGNED INTEGER) AS `Decision` 
FROM arg_max_cte