-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH linear_model_cte AS 
(SELECT "ADS"."KEY" AS "KEY", 0.005630280945250026 * "ADS"."Feature_0" + 0.0033727236880995376 * "ADS"."Feature_1" + -0.00021393147197965964 * "ADS"."Feature_2" + 0.030921649952087495 * "ADS"."Feature_3" + -0.010990200017580075 * "ADS"."Feature_4" + -0.0019066449262032646 * "ADS"."Feature_5" + -0.03460103002138168 * "ADS"."Feature_6" + -0.006282501230155128 * "ADS"."Feature_7" + 0.0057256294265776945 * "ADS"."Feature_8" + -0.0182788439412737 * "ADS"."Feature_9" + 0.010906305485658832 * "ADS"."Feature_10" + 0.025593700035772462 * "ADS"."Feature_11" + 0.0061802461067305935 * "ADS"."Feature_12" + 0.005637219051857589 * "ADS"."Feature_13" + -0.005782415236759926 * "ADS"."Feature_14" + 0.04782154321349547 * "ADS"."Feature_15" + -0.007421260654849627 * "ADS"."Feature_16" + 0.034964183844955275 * "ADS"."Feature_17" + -0.026031713925060446 * "ADS"."Feature_18" + -0.004577058748842915 * "ADS"."Feature_19" + 0.010668665726463286 * "ADS"."Feature_20" + -0.0062751714264244534 * "ADS"."Feature_21" + 0.00289020075430274 * "ADS"."Feature_22" + -0.00039197453917937136 * "ADS"."Feature_23" + 0.022927607780519572 * "ADS"."Feature_24" + -0.0034103832191837518 * "ADS"."Feature_25" + 0.02014079519889348 * "ADS"."Feature_26" + -0.0022746395532007376 * "ADS"."Feature_27" + 0.007619934486108842 * "ADS"."Feature_28" + 0.02742281957849823 * "ADS"."Feature_29" + 0.028218795570531068 * "ADS"."Feature_30" + 0.016300048730502715 * "ADS"."Feature_31" + -0.024069476137919953 * "ADS"."Feature_32" + -0.005320535001287052 * "ADS"."Feature_33" + 0.015898062041104277 * "ADS"."Feature_34" + 0.009530610374349786 * "ADS"."Feature_35" + 0.010935979560616718 * "ADS"."Feature_36" + 0.008618907298511443 * "ADS"."Feature_37" + -0.0032520686373618546 * "ADS"."Feature_38" + -0.0026604710260810507 * "ADS"."Feature_39" + -0.006703975658365942 * "ADS"."Feature_40" + 0.01801205379448011 * "ADS"."Feature_41" + 0.012727702287573254 * "ADS"."Feature_42" + 0.0037872875295549605 * "ADS"."Feature_43" + 0.004254389728632587 * "ADS"."Feature_44" + -0.002919575509475483 * "ADS"."Feature_45" + -0.012062510675165953 * "ADS"."Feature_46" + -0.0027327555290325364 * "ADS"."Feature_47" + 0.011645630452030787 * "ADS"."Feature_48" + -0.008456994625373382 * "ADS"."Feature_49" + 0.006443957886789003 * "ADS"."Feature_50" + 0.008661426261890494 * "ADS"."Feature_51" + 0.002932277562504391 * "ADS"."Feature_52" + -0.00790294008412847 * "ADS"."Feature_53" + -0.006290886254439577 * "ADS"."Feature_54" + 0.0039271832246626 * "ADS"."Feature_55" + -0.02894630310739996 * "ADS"."Feature_56" + -0.00947531477553176 * "ADS"."Feature_57" + 0.0014386639304567832 * "ADS"."Feature_58" + -0.027114781014923057 * "ADS"."Feature_59" + 0.0018284600884055477 * "ADS"."Feature_60" + 0.0032030845353759638 * "ADS"."Feature_61" + 0.007753640058070357 * "ADS"."Feature_62" + 0.00680208663244904 * "ADS"."Feature_63" + 0.0021992532714298512 * "ADS"."Feature_64" + 0.00793637889978136 * "ADS"."Feature_65" + -0.011285676837564906 * "ADS"."Feature_66" + 0.012276795243229322 * "ADS"."Feature_67" + -0.02134513886297958 * "ADS"."Feature_68" + -0.012383507563705428 * "ADS"."Feature_69" + -0.011970569080326031 * "ADS"."Feature_70" + -0.010943012332094187 * "ADS"."Feature_71" + -0.028447456551269547 * "ADS"."Feature_72" + -0.0003750802289516572 * "ADS"."Feature_73" + -0.01073721524396654 * "ADS"."Feature_74" + 0.0021463328316237125 * "ADS"."Feature_75" + 0.028211675667824246 * "ADS"."Feature_76" + 0.00215150069109177 * "ADS"."Feature_77" + 0.007949272446580495 * "ADS"."Feature_78" + 0.014558599256931386 * "ADS"."Feature_79" + -0.0053434875533957095 * "ADS"."Feature_80" + -0.0021921547606302454 * "ADS"."Feature_81" + -0.0023802252679433512 * "ADS"."Feature_82" + 0.0007408988683743655 * "ADS"."Feature_83" + -0.02599739007232573 * "ADS"."Feature_84" + -0.025424243392313903 * "ADS"."Feature_85" + 0.01000798817683472 * "ADS"."Feature_86" + -0.014543889485302058 * "ADS"."Feature_87" + -0.0023186156168488875 * "ADS"."Feature_88" + 0.019802718571618846 * "ADS"."Feature_89" + -0.01971437375778769 * "ADS"."Feature_90" + -0.007297811772480861 * "ADS"."Feature_91" + -0.03315835323999549 * "ADS"."Feature_92" + -0.003662483507742262 * "ADS"."Feature_93" + 0.0007687752027117724 * "ADS"."Feature_94" + 0.005063360088866439 * "ADS"."Feature_95" + 0.00460890553761719 * "ADS"."Feature_96" + 0.009648700160028308 * "ADS"."Feature_97" + -0.033390452020165724 * "ADS"."Feature_98" + 0.0029062449677153953 * "ADS"."Feature_99" + -0.628596215397 AS "Score_0", -0.009222356280888503 * "ADS"."Feature_0" + -0.010914607101575775 * "ADS"."Feature_1" + -0.013747371836817627 * "ADS"."Feature_2" + 0.0018224811745519154 * "ADS"."Feature_3" + -0.0022483757236255284 * "ADS"."Feature_4" + -0.0041174158017299725 * "ADS"."Feature_5" + 0.033601043465130945 * "ADS"."Feature_6" + -0.00858220887648105 * "ADS"."Feature_7" + -0.0034490334245318335 * "ADS"."Feature_8" + 0.00890467770241297 * "ADS"."Feature_9" + -0.06229569114603979 * "ADS"."Feature_10" + -0.010326809958105492 * "ADS"."Feature_11" + -0.0013412524112572783 * "ADS"."Feature_12" + -0.01027142798389784 * "ADS"."Feature_13" + -0.0005277856393360548 * "ADS"."Feature_14" + -0.020671111491070614 * "ADS"."Feature_15" + 0.0035857904840234235 * "ADS"."Feature_16" + -0.01215254338229034 * "ADS"."Feature_17" + 0.002550738762561072 * "ADS"."Feature_18" + -0.0037330540523890796 * "ADS"."Feature_19" + -0.03457997539207882 * "ADS"."Feature_20" + 0.029267440650585053 * "ADS"."Feature_21" + 0.0032798146850771467 * "ADS"."Feature_22" + -0.020993197835776092 * "ADS"."Feature_23" + -0.007497417652064251 * "ADS"."Feature_24" + 0.007167767052046847 * "ADS"."Feature_25" + -0.0055590900754228425 * "ADS"."Feature_26" + 0.008742579444741121 * "ADS"."Feature_27" + 0.008366918256227252 * "ADS"."Feature_28" + -0.04571748441336347 * "ADS"."Feature_29" + -0.013715285331934505 * "ADS"."Feature_30" + -0.01699234516171086 * "ADS"."Feature_31" + 0.01694839918243975 * "ADS"."Feature_32" + 0.0357103829373074 * "ADS"."Feature_33" + -0.011965035295508544 * "ADS"."Feature_34" + -0.007991961999441837 * "ADS"."Feature_35" + -0.008881207296916034 * "ADS"."Feature_36" + -0.020262300697045404 * "ADS"."Feature_37" + -0.0012986713849595705 * "ADS"."Feature_38" + -0.0015830599905727522 * "ADS"."Feature_39" + 0.00422756458558908 * "ADS"."Feature_40" + -0.003169428580904332 * "ADS"."Feature_41" + -0.015236401650785977 * "ADS"."Feature_42" + 0.027717354605230417 * "ADS"."Feature_43" + -0.0037910060883007304 * "ADS"."Feature_44" + 0.03406730092735661 * "ADS"."Feature_45" + 0.0017516887918952364 * "ADS"."Feature_46" + 0.008017913235661103 * "ADS"."Feature_47" + 0.016476840112431633 * "ADS"."Feature_48" + 0.0049134772812795425 * "ADS"."Feature_49" + -0.018040192314027148 * "ADS"."Feature_50" + -0.0012988599082473461 * "ADS"."Feature_51" + 0.01719641255389245 * "ADS"."Feature_52" + 0.004448038619461238 * "ADS"."Feature_53" + 0.008854830609909945 * "ADS"."Feature_54" + -0.006262987391356989 * "ADS"."Feature_55" + 0.04463980886830762 * "ADS"."Feature_56" + 0.016335397928285044 * "ADS"."Feature_57" + 0.0048574629826437 * "ADS"."Feature_58" + 0.01585608115247178 * "ADS"."Feature_59" + -0.00645747842646685 * "ADS"."Feature_60" + -0.007371563535201054 * "ADS"."Feature_61" + -0.0012240802362312939 * "ADS"."Feature_62" + -0.0027429905627482415 * "ADS"."Feature_63" + -0.01136127860220585 * "ADS"."Feature_64" + -0.009021412086816595 * "ADS"."Feature_65" + 0.00599816657616259 * "ADS"."Feature_66" + 0.006899608068255696 * "ADS"."Feature_67" + 0.045575878420196066 * "ADS"."Feature_68" + -0.028957544616258053 * "ADS"."Feature_69" + -0.007539353985347075 * "ADS"."Feature_70" + 0.02936024292155348 * "ADS"."Feature_71" + 0.02014080828371542 * "ADS"."Feature_72" + -0.021256280843179525 * "ADS"."Feature_73" + 0.008460791244871363 * "ADS"."Feature_74" + 0.0036777405269716296 * "ADS"."Feature_75" + -0.05251515510654495 * "ADS"."Feature_76" + -0.008129168070159107 * "ADS"."Feature_77" + 0.024073160587983082 * "ADS"."Feature_78" + -0.006364795719976026 * "ADS"."Feature_79" + -0.006548077419421183 * "ADS"."Feature_80" + -0.008168125768026365 * "ADS"."Feature_81" + 0.014346832702083276 * "ADS"."Feature_82" + 0.0010969674895255493 * "ADS"."Feature_83" + 0.03210501181192099 * "ADS"."Feature_84" + 0.05769706633073894 * "ADS"."Feature_85" + 0.016469901120031882 * "ADS"."Feature_86" + -0.0005126844265984753 * "ADS"."Feature_87" + -0.011250093780948156 * "ADS"."Feature_88" + -0.0020736397412734362 * "ADS"."Feature_89" + 0.026378690197386777 * "ADS"."Feature_90" + -0.01576601211172713 * "ADS"."Feature_91" + 0.035774186784525874 * "ADS"."Feature_92" + 0.013345891650720823 * "ADS"."Feature_93" + 0.035756952306624526 * "ADS"."Feature_94" + 0.010339877786543241 * "ADS"."Feature_95" + 0.016122704010923073 * "ADS"."Feature_96" + -0.00365631385294054 * "ADS"."Feature_97" + -0.02375525160028788 * "ADS"."Feature_98" + -0.050639407598480644 * "ADS"."Feature_99" + -0.459517046113 AS "Score_1", 0.00645754799436083 * "ADS"."Feature_0" + 0.007434148524936237 * "ADS"."Feature_1" + 0.014609550077023394 * "ADS"."Feature_2" + -0.023420652318971065 * "ADS"."Feature_3" + -0.010301329896759888 * "ADS"."Feature_4" + 0.0012025895271026883 * "ADS"."Feature_5" + 0.0072333518873421215 * "ADS"."Feature_6" + 0.01598104722930996 * "ADS"."Feature_7" + 0.0011901944673961674 * "ADS"."Feature_8" + 0.004418772825366865 * "ADS"."Feature_9" + 0.03654343874623864 * "ADS"."Feature_10" + 0.0024891577996115685 * "ADS"."Feature_11" + -0.013827047863815174 * "ADS"."Feature_12" + 0.003592911692352669 * "ADS"."Feature_13" + 0.008344994572257965 * "ADS"."Feature_14" + 0.015318062538601584 * "ADS"."Feature_15" + 0.0020673988671780865 * "ADS"."Feature_16" + -0.02116715725043897 * "ADS"."Feature_17" + 0.023696636002444055 * "ADS"."Feature_18" + 0.0069581952894840395 * "ADS"."Feature_19" + -0.011790925073407399 * "ADS"."Feature_20" + -0.014984946546375784 * "ADS"."Feature_21" + 0.00534528840359293 * "ADS"."Feature_22" + 0.018374509335174097 * "ADS"."Feature_23" + 6.30017423528962e-05 * "ADS"."Feature_24" + -0.0035988083171779625 * "ADS"."Feature_25" + 0.0013816817326096336 * "ADS"."Feature_26" + 0.009027869291749615 * "ADS"."Feature_27" + 0.004372876654611501 * "ADS"."Feature_28" + 0.05174570433759932 * "ADS"."Feature_29" + 0.00034454162847526865 * "ADS"."Feature_30" + 0.0014315117791164882 * "ADS"."Feature_31" + 0.0402434966747684 * "ADS"."Feature_32" + 0.005967201692486679 * "ADS"."Feature_33" + -0.006362394479592522 * "ADS"."Feature_34" + 0.0010843728179581597 * "ADS"."Feature_35" + -0.002387086936704442 * "ADS"."Feature_36" + 0.01862525935806775 * "ADS"."Feature_37" + 0.007176444243084428 * "ADS"."Feature_38" + 0.01697839500701348 * "ADS"."Feature_39" + 0.006271670329805175 * "ADS"."Feature_40" + -0.0018231990197366786 * "ADS"."Feature_41" + -0.00010179150619493097 * "ADS"."Feature_42" + -0.024026596097061884 * "ADS"."Feature_43" + 0.001797910645206438 * "ADS"."Feature_44" + -0.009439826710595813 * "ADS"."Feature_45" + -0.012067240304558854 * "ADS"."Feature_46" + 0.008515063907086375 * "ADS"."Feature_47" + 0.022030909884294663 * "ADS"."Feature_48" + 0.03432771817330141 * "ADS"."Feature_49" + 0.0183081011547159 * "ADS"."Feature_50" + -0.008473283029447044 * "ADS"."Feature_51" + -0.04985658492102525 * "ADS"."Feature_52" + 0.0035041096826582047 * "ADS"."Feature_53" + -0.016063846757149013 * "ADS"."Feature_54" + -0.009391418117973997 * "ADS"."Feature_55" + -0.032416325768406015 * "ADS"."Feature_56" + -0.014068599694396609 * "ADS"."Feature_57" + -0.008633167818478373 * "ADS"."Feature_58" + -0.003619511960994153 * "ADS"."Feature_59" + 0.0029319432185317736 * "ADS"."Feature_60" + -0.002852566762996763 * "ADS"."Feature_61" + -0.014810742420505979 * "ADS"."Feature_62" + -0.005665144698409192 * "ADS"."Feature_63" + 0.0127073857485562 * "ADS"."Feature_64" + 0.011142088260426062 * "ADS"."Feature_65" + -0.0036594708599747834 * "ADS"."Feature_66" + -0.003601518584498309 * "ADS"."Feature_67" + -0.04453132779036109 * "ADS"."Feature_68" + 0.0297748809541564 * "ADS"."Feature_69" + -0.003731187808347842 * "ADS"."Feature_70" + -0.027632370445665366 * "ADS"."Feature_71" + 0.004256855985513943 * "ADS"."Feature_72" + 0.002243073227667892 * "ADS"."Feature_73" + 0.0022407450658147826 * "ADS"."Feature_74" + -0.009996746441138259 * "ADS"."Feature_75" + 0.01741583397386577 * "ADS"."Feature_76" + 0.002344956816753069 * "ADS"."Feature_77" + -0.027015539452471135 * "ADS"."Feature_78" + -0.012923449261111448 * "ADS"."Feature_79" + -0.010854038216283281 * "ADS"."Feature_80" + 0.006997491157318175 * "ADS"."Feature_81" + -0.014965826001200888 * "ADS"."Feature_82" + 0.015621317047228793 * "ADS"."Feature_83" + -0.054180780566435716 * "ADS"."Feature_84" + -0.041577501186080675 * "ADS"."Feature_85" + -0.03544586268379116 * "ADS"."Feature_86" + -0.0033138048534785986 * "ADS"."Feature_87" + 0.012958737242828866 * "ADS"."Feature_88" + 0.00017360895219191083 * "ADS"."Feature_89" + -0.0030207002351622632 * "ADS"."Feature_90" + 0.028393161047347466 * "ADS"."Feature_91" + -0.025008469829169766 * "ADS"."Feature_92" + -0.013949072445189364 * "ADS"."Feature_93" + -0.010812546802679257 * "ADS"."Feature_94" + -0.019250132105362982 * "ADS"."Feature_95" + -0.009740614925016855 * "ADS"."Feature_96" + 0.003538026030512161 * "ADS"."Feature_97" + 0.051258887978310935 * "ADS"."Feature_98" + 0.03864482035303294 * "ADS"."Feature_99" + -0.53329004081 AS "Score_2", -0.002865472658722351 * "ADS"."Feature_0" + 0.00010773488854000544 * "ADS"."Feature_1" + -0.0006482467682260946 * "ADS"."Feature_2" + -0.009323478807668364 * "ADS"."Feature_3" + 0.023539905637965486 * "ADS"."Feature_4" + 0.004821471200830564 * "ADS"."Feature_5" + -0.0062333653310914375 * "ADS"."Feature_6" + -0.0011163371226737676 * "ADS"."Feature_7" + -0.003466790469442035 * "ADS"."Feature_8" + 0.004955393413493859 * "ADS"."Feature_9" + 0.014845946914142339 * "ADS"."Feature_10" + -0.01775604787727856 * "ADS"."Feature_11" + 0.008988054168341862 * "ADS"."Feature_12" + 0.0010412972396875652 * "ADS"."Feature_13" + -0.0020347936961619927 * "ADS"."Feature_14" + -0.042468494261026404 * "ADS"."Feature_15" + 0.0017680713036481227 * "ADS"."Feature_16" + -0.0016444832122259846 * "ADS"."Feature_17" + -0.000215660839944711 * "ADS"."Feature_18" + 0.0013519175117479656 * "ADS"."Feature_19" + 0.035702234739022946 * "ADS"."Feature_20" + -0.00800732267778483 * "ADS"."Feature_21" + -0.01151530384297282 * "ADS"."Feature_22" + 0.003010663039781379 * "ADS"."Feature_23" + -0.015493191870808271 * "ADS"."Feature_24" + -0.00015857551568514665 * "ADS"."Feature_25" + -0.015963386856080255 * "ADS"."Feature_26" + -0.015495809183289992 * "ADS"."Feature_27" + -0.020359729396947565 * "ADS"."Feature_28" + -0.033451039502734016 * "ADS"."Feature_29" + -0.014848051867071816 * "ADS"."Feature_30" + -0.0007392153479082931 * "ADS"."Feature_31" + -0.03312241971928815 * "ADS"."Feature_32" + -0.03635704962850702 * "ADS"."Feature_33" + 0.002429367733996806 * "ADS"."Feature_34" + -0.0026230211928661208 * "ADS"."Feature_35" + 0.00033231467300377023 * "ADS"."Feature_36" + -0.006981865959533782 * "ADS"."Feature_37" + -0.002625704220762996 * "ADS"."Feature_38" + -0.012734863990359675 * "ADS"."Feature_39" + -0.003795259257028309 * "ADS"."Feature_40" + -0.013019426193839116 * "ADS"."Feature_41" + 0.002610490869407645 * "ADS"."Feature_42" + -0.0074780460377235234 * "ADS"."Feature_43" + -0.0022612942855382762 * "ADS"."Feature_44" + -0.021707898707285265 * "ADS"."Feature_45" + 0.02237806218782959 * "ADS"."Feature_46" + -0.013800221613714971 * "ADS"."Feature_47" + -0.05015338044875712 * "ADS"."Feature_48" + -0.03078420082920759 * "ADS"."Feature_49" + -0.006711866727477731 * "ADS"."Feature_50" + 0.0011107166758039075 * "ADS"."Feature_51" + 0.029727894804628487 * "ADS"."Feature_52" + -4.920821799096764e-05 * "ADS"."Feature_53" + 0.013499902401678643 * "ADS"."Feature_54" + 0.0117272222846684 * "ADS"."Feature_55" + 0.016722820007498352 * "ADS"."Feature_56" + 0.00720851654164333 * "ADS"."Feature_57" + 0.002337040905377885 * "ADS"."Feature_58" + 0.01487821182344541 * "ADS"."Feature_59" + 0.0016970751195295132 * "ADS"."Feature_60" + 0.007021045762821853 * "ADS"."Feature_61" + 0.008281182598666927 * "ADS"."Feature_62" + 0.0016060486287083977 * "ADS"."Feature_63" + -0.0035453604177801716 * "ADS"."Feature_64" + -0.010057055073390827 * "ADS"."Feature_65" + 0.008946981121377094 * "ADS"."Feature_66" + -0.015574884726986715 * "ADS"."Feature_67" + 0.02030058823314459 * "ADS"."Feature_68" + 0.01156617122580705 * "ADS"."Feature_69" + 0.023241110874020955 * "ADS"."Feature_70" + 0.009215139856206084 * "ADS"."Feature_71" + 0.004049792282040193 * "ADS"."Feature_72" + 0.019388287844463295 * "ADS"."Feature_73" + 3.567893328040666e-05 * "ADS"."Feature_74" + 0.004172673082542916 * "ADS"."Feature_75" + 0.006887645464854931 * "ADS"."Feature_76" + 0.003632710562314278 * "ADS"."Feature_77" + -0.005006893582092451 * "ADS"."Feature_78" + 0.004729645724156107 * "ADS"."Feature_79" + 0.02274560318910019 * "ADS"."Feature_80" + 0.0033627893713384753 * "ADS"."Feature_81" + 0.0029992185670609474 * "ADS"."Feature_82" + -0.017459183405128732 * "ADS"."Feature_83" + 0.04807315882684045 * "ADS"."Feature_84" + 0.009304678247655622 * "ADS"."Feature_85" + 0.00896797338692453 * "ADS"."Feature_86" + 0.018370378765379138 * "ADS"."Feature_87" + 0.0006099721549681764 * "ADS"."Feature_88" + -0.017902687782537313 * "ADS"."Feature_89" + -0.003643616204436839 * "ADS"."Feature_90" + -0.005329337163139475 * "ADS"."Feature_91" + 0.022392636284639382 * "ADS"."Feature_92" + 0.0042656643022108 * "ADS"."Feature_93" + -0.025713180706657054 * "ADS"."Feature_94" + 0.0038468942299533107 * "ADS"."Feature_95" + -0.01099099462352343 * "ADS"."Feature_96" + -0.009530412337599938 * "ADS"."Feature_97" + 0.00588681564214267 * "ADS"."Feature_98" + 0.009088342277732323 * "ADS"."Feature_99" + -0.37859669768 AS "Score_3" 
FROM "FourClass_100" AS "ADS"), 
orig_cte AS 
(SELECT linear_model_cte."KEY" AS "KEY", linear_model_cte."Score_0" AS "Score_0", linear_model_cte."Score_1" AS "Score_1", linear_model_cte."Score_2" AS "Score_2", linear_model_cte."Score_3" AS "Score_3", CAST(NULL AS DOUBLE) AS "Proba_0", CAST(NULL AS DOUBLE) AS "Proba_1", CAST(NULL AS DOUBLE) AS "Proba_2", CAST(NULL AS DOUBLE) AS "Proba_3", CAST(NULL AS DOUBLE) AS "LogProba_0", CAST(NULL AS DOUBLE) AS "LogProba_1", CAST(NULL AS DOUBLE) AS "LogProba_2", CAST(NULL AS DOUBLE) AS "LogProba_3", NULL AS "Decision", CAST(NULL AS DOUBLE) AS "DecisionProba" 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu."KEY_u" AS "KEY_u", scu.class AS class, scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY_u", 0 AS class, orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 1 AS class, orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 2 AS class, orig_cte."LogProba_2" AS "LogProba", orig_cte."Proba_2" AS "Proba", orig_cte."Score_2" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 3 AS class, orig_cte."LogProba_3" AS "LogProba", orig_cte."Proba_3" AS "Proba", orig_cte."Score_3" AS "Score" 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Score_2" AS "Score_2", orig_cte."Score_3" AS "Score_3", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."Proba_2" AS "Proba_2", orig_cte."Proba_3" AS "Proba_3", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."LogProba_2" AS "LogProba_2", orig_cte."LogProba_3" AS "LogProba_3", orig_cte."Decision" AS "Decision", orig_cte."DecisionProba" AS "DecisionProba", max_select."KEY_m" AS "KEY_m", max_select."max_Score" AS "max_Score" 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union."KEY_u" AS "KEY_m", max(score_class_union."Score") AS "max_Score" 
FROM score_class_union GROUP BY score_class_union."KEY_u") AS max_select ON orig_cte."KEY" = max_select."KEY_m"), 
union_with_max AS 
(SELECT score_class_union."KEY_u" AS "KEY_u", score_class_union.class AS class, score_class_union."LogProba" AS "LogProba", score_class_union."Proba" AS "Proba", score_class_union."Score" AS "Score", score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Score" AS "max_Score" 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union."KEY_u" = score_max."KEY"), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Score" AS "max_Score", "arg_max_t_Score"."KEY_Score" AS "KEY_Score", "arg_max_t_Score"."arg_max_Score" AS "arg_max_Score" 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max."KEY" AS "KEY_Score", min(union_with_max.class) AS "arg_max_Score" 
FROM union_with_max 
WHERE union_with_max."max_Score" <= union_with_max."Score" GROUP BY union_with_max."KEY") AS "arg_max_t_Score" ON score_max."KEY" = "arg_max_t_Score"."KEY_Score")
 SELECT arg_max_cte."KEY" AS "KEY", arg_max_cte."Score_0" AS "Score_0", arg_max_cte."Score_1" AS "Score_1", arg_max_cte."Score_2" AS "Score_2", arg_max_cte."Score_3" AS "Score_3", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", arg_max_cte."Proba_2" AS "Proba_2", arg_max_cte."Proba_3" AS "Proba_3", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN ln(arg_max_cte."Proba_0") ELSE -1.79769313486231e+308 END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN ln(arg_max_cte."Proba_1") ELSE -1.79769313486231e+308 END AS "LogProba_1", CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN ln(arg_max_cte."Proba_2") ELSE -1.79769313486231e+308 END AS "LogProba_2", CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN ln(arg_max_cte."Proba_3") ELSE -1.79769313486231e+308 END AS "LogProba_3", arg_max_cte."arg_max_Score" AS "Decision", CASE WHEN (arg_max_cte."arg_max_Score" = 0) THEN arg_max_cte."Proba_0" WHEN (arg_max_cte."arg_max_Score" = 1) THEN arg_max_cte."Proba_1" WHEN (arg_max_cte."arg_max_Score" = 2) THEN arg_max_cte."Proba_2" WHEN (arg_max_cte."arg_max_Score" = 3) THEN arg_max_cte."Proba_3" END AS "DecisionProba" 
FROM arg_max_cte