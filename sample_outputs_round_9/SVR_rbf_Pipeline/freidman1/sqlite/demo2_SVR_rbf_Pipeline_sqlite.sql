-- This SQL code was generated by scikit2sql (development version).
-- Copyright 2017

WITH "ADS_imp_1_OUT" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_0" IS NULL) THEN 0.571437811354 ELSE "ADS"."Feature_0" END AS impter_2, CASE WHEN ("ADS"."Feature_1" IS NULL) THEN 0.382666238013 ELSE "ADS"."Feature_1" END AS impter_3, CASE WHEN ("ADS"."Feature_2" IS NULL) THEN 0.572691272422 ELSE "ADS"."Feature_2" END AS impter_4, CASE WHEN ("ADS"."Feature_3" IS NULL) THEN 0.49696190088 ELSE "ADS"."Feature_3" END AS impter_5, CASE WHEN ("ADS"."Feature_4" IS NULL) THEN 0.451024542384 ELSE "ADS"."Feature_4" END AS impter_6, CASE WHEN ("ADS"."Feature_5" IS NULL) THEN 0.481756971335 ELSE "ADS"."Feature_5" END AS impter_7, CASE WHEN ("ADS"."Feature_6" IS NULL) THEN 0.500052942379 ELSE "ADS"."Feature_6" END AS impter_8, CASE WHEN ("ADS"."Feature_7" IS NULL) THEN 0.479198857297 ELSE "ADS"."Feature_7" END AS impter_9, CASE WHEN ("ADS"."Feature_8" IS NULL) THEN 0.507387853051 ELSE "ADS"."Feature_8" END AS impter_10, CASE WHEN ("ADS"."Feature_9" IS NULL) THEN 0.628661567941 ELSE "ADS"."Feature_9" END AS impter_11 
FROM freidman1 AS "ADS"), 
"ADS_sca_2_OUT" AS 
(SELECT "ADS_imp_1_OUT"."KEY" AS "KEY", (CAST("ADS_imp_1_OUT".impter_2 AS FLOAT) - 0.571437811354) / 0.271926055138 AS scaler_2, (CAST("ADS_imp_1_OUT".impter_3 AS FLOAT) - 0.382666238013) / 0.24530412971 AS scaler_3, (CAST("ADS_imp_1_OUT".impter_4 AS FLOAT) - 0.572691272422) / 0.305022968027 AS scaler_4, (CAST("ADS_imp_1_OUT".impter_5 AS FLOAT) - 0.49696190088) / 0.312889400468 AS scaler_5, (CAST("ADS_imp_1_OUT".impter_6 AS FLOAT) - 0.451024542384) / 0.24602253009 AS scaler_6, (CAST("ADS_imp_1_OUT".impter_7 AS FLOAT) - 0.481756971335) / 0.286861434558 AS scaler_7, (CAST("ADS_imp_1_OUT".impter_8 AS FLOAT) - 0.500052942379) / 0.284593201265 AS scaler_8, (CAST("ADS_imp_1_OUT".impter_9 AS FLOAT) - 0.479198857297) / 0.318231552426 AS scaler_9, (CAST("ADS_imp_1_OUT".impter_10 AS FLOAT) - 0.507387853051) / 0.213964399112 AS scaler_10, (CAST("ADS_imp_1_OUT".impter_11 AS FLOAT) - 0.628661567941) / 0.260134905409 AS scaler_11 
FROM "ADS_imp_1_OUT"), 
"SV_data" AS 
(SELECT "Values".sv_idx AS sv_idx, "Values".dual_coeff AS dual_coeff, "Values".sv_0 AS sv_0, "Values".sv_1 AS sv_1, "Values".sv_2 AS sv_2, "Values".sv_3 AS sv_3, "Values".sv_4 AS sv_4, "Values".sv_5 AS sv_5, "Values".sv_6 AS sv_6, "Values".sv_7 AS sv_7, "Values".sv_8 AS sv_8, "Values".sv_9 AS sv_9 
FROM (SELECT 0 AS sv_idx, -1.0 AS dual_coeff, -1.15530352762 AS sv_0, -1.48627303822 AS sv_1, 0.1996768736 AS sv_2, 0.752795735048 AS sv_3, 0.0966252434932 AS sv_4, -0.553189533293 AS sv_5, 0.0293748783661 AS sv_6, 0.344143285243 AS sv_7, -0.316753659518 AS sv_8, 1.29364481463 AS sv_9 UNION ALL SELECT 1 AS sv_idx, -0.339769673118 AS dual_coeff, 1.20155948571 AS sv_0, -0.725018315845 AS sv_1, 0.282996614899 AS sv_2, 0.184806673194 AS sv_3, 2.07557394542 AS sv_4, -1.65793515923 AS sv_5, 1.34441981141 AS sv_6, 1.10337950674 AS sv_7, 0.744350404836 AS sv_8, -0.662849689913 AS sv_9 UNION ALL SELECT 2 AS sv_idx, 1.0 AS dual_coeff, -0.908164692646 AS sv_0, 1.79571805728 AS sv_1, -1.5523170214 AS sv_2, 0.0135364579978 AS sv_3, 1.65707886864 AS sv_4, -1.56896710433 AS sv_5, 1.51809355763 AS sv_6, -1.27059943499 AS sv_7, 0.107370583887 AS sv_8, 1.37017312901 AS sv_9 UNION ALL SELECT 3 AS sv_idx, -1.0 AS dual_coeff, -0.951766973782 AS sv_0, 0.625405838128 AS sv_1, 0.695875829527 AS sv_2, -1.46923777793 AS sv_3, 0.695070189512 AS sv_4, -0.926915078872 AS sv_5, -1.23161561452 AS sv_6, 1.01645855838 AS sv_7, 1.48269322768 AS sv_8, 0.119682765933 AS sv_9 UNION ALL SELECT 4 AS sv_idx, 1.0 AS dual_coeff, 0.913038826202 AS sv_0, 0.314990069798 AS sv_1, -1.80432945138 AS sv_2, -0.947780532003 AS sv_3, 0.134316888837 AS sv_4, 1.53287341626 AS sv_5, -1.31058536089 AS sv_6, -0.480810147316 AS sv_7, -0.364618377346 AS sv_8, 1.11511242367 AS sv_9 UNION ALL SELECT 5 AS sv_idx, -1.0 AS dual_coeff, -1.05950039802 AS sv_0, -0.103070244414 AS sv_1, 0.579548629086 AS sv_2, -1.33874601234 AS sv_3, -1.31205447252 AS sv_4, -0.762805462974 AS sv_5, 1.46549626526 AS sv_6, -0.89546090946 AS sv_7, 0.800780925446 AS sv_8, -1.519931407 AS sv_9 UNION ALL SELECT 6 AS sv_idx, -1.0 AS dual_coeff, 0.0449306869384 AS sv_0, -0.938061727291 AS sv_1, 0.14451939517 AS sv_2, -0.230723458348 AS sv_3, -1.05381482699 AS sv_4, 0.926583593307 AS sv_5, -0.678668418042 AS sv_6, 0.674863814652 AS sv_7, -1.14811213214 AS sv_8, -0.545769666479 AS sv_9 UNION ALL SELECT 7 AS sv_idx, 1.0 AS dual_coeff, 0.805185362999 AS sv_0, 1.12482610881 AS sv_1, 0.605017858636 AS sv_2, 0.0822162182603 AS sv_3, -0.434370833639 AS sv_4, 0.304115033464 AS sv_5, -0.341776509654 AS sv_6, -1.04310319732 AS sv_7, 2.28681721416 AS sv_8, -2.16411893625 AS sv_9 UNION ALL SELECT 8 AS sv_idx, -1.0 AS dual_coeff, -2.0970929069 AS sv_0, -0.476382048089 AS sv_1, 1.38644162136 AS sv_2, 0.770215897604 AS sv_3, -0.410946211629 AS sv_4, -0.493272284549 AS sv_5, 0.397552389564 AS sv_6, 1.63222717702 AS sv_7, -0.788959139112 AS sv_8, -0.254111176628 AS sv_9 UNION ALL SELECT 9 AS sv_idx, 1.0 AS dual_coeff, 0.325267509294 AS sv_0, -1.44523019177 AS sv_1, 1.13550675465 AS sv_2, 1.54044579102 AS sv_3, 1.91359222496 AS sv_4, 0.762722829124 AS sv_5, 1.40912230642 AS sv_6, -0.600116205415 AS sv_7, 0.911976077643 AS sv_8, -0.218974202467 AS sv_9 UNION ALL SELECT 10 AS sv_idx, -0.362141191579 AS dual_coeff, 0.108754977839 AS sv_0, -0.294048897282 AS sv_1, -1.18165790358 AS sv_2, 0.686144759408 AS sv_3, -0.518688638824 AS sv_4, 0.63800554513 AS sv_5, -1.06453156474 AS sv_6, 0.730285701258 AS sv_7, -0.997883766725 AS sv_8, 0.0562359352951 AS sv_9 UNION ALL SELECT 11 AS sv_idx, 1.0 AS dual_coeff, -0.658987143124 AS sv_0, 1.81974828541 AS sv_1, 1.33419537129 AS sv_2, 1.58799223705 AS sv_3, -0.0619421839078 AS sv_4, 1.60319124534 AS sv_5, -0.298478059975 AS sv_6, -0.850567765213 AS sv_7, -1.13108237761 AS sv_8, 0.0309877248852 AS sv_9 UNION ALL SELECT 12 AS sv_idx, -1.0 AS dual_coeff, 1.57479732785 AS sv_0, -1.35082957434 AS sv_1, 0.713113341124 AS sv_2, -1.33188372901 AS sv_3, -0.081552386577 AS sv_4, 0.0429360911281 AS sv_5, -0.650118658296 AS sv_6, 0.265626733527 AS sv_7, 0.460348623518 AS sv_8, 0.746369790335 AS sv_9 UNION ALL SELECT 13 AS sv_idx, -1.0 AS dual_coeff, -1.48398626585 AS sv_0, -0.0633393274678 AS sv_1, -0.711006957223 AS sv_2, -0.977040917505 AS sv_3, 0.287401330527 AS sv_4, 0.0195371343412 AS sv_5, 0.791609615365 AS sv_6, -0.967463753884 AS sv_7, 0.297146818979 AS sv_8, -0.120225511134 AS sv_9 UNION ALL SELECT 14 AS sv_idx, -1.0 AS dual_coeff, 0.640640301142 AS sv_0, -0.970070681984 AS sv_1, -0.834096223122 AS sv_2, -1.5098934202 AS sv_3, -0.969684327861 AS sv_4, -0.099471488569 AS sv_5, -0.376066443671 AS sv_6, 0.304070524439 AS sv_7, -1.25133211515 AS sv_8, 0.783951367745 AS sv_9 UNION ALL SELECT 15 AS sv_idx, -0.779683711837 AS dual_coeff, 0.857617439659 AS sv_0, 1.26013827441 AS sv_1, -1.41728767406 AS sv_2, -1.27826218688 AS sv_3, 0.0429092031877 AS sv_4, 0.42770976891 AS sv_5, -0.832880047956 AS sv_6, 1.40351130042 AS sv_7, 1.09987917159 AS sv_8, -0.896195434717 AS sv_9 UNION ALL SELECT 16 AS sv_idx, 1.0 AS dual_coeff, 1.36398367324 AS sv_0, 0.710235278038 AS sv_1, 0.0454606932241 AS sv_2, 0.746476938845 AS sv_3, -1.27668292342 AS sv_4, -1.45013215242 AS sv_5, -1.58350839255 AS sv_6, 1.12900606201 AS sv_7, -0.502806618524 AS sv_8, 1.17375689671 AS sv_9 UNION ALL SELECT 17 AS sv_idx, -1.0 AS dual_coeff, -1.42809624026 AS sv_0, -1.50530108002 AS sv_1, -1.56368276245 AS sv_2, 0.222419283677 AS sv_3, 0.685654649523 AS sv_4, 0.873148665192 AS sv_5, -1.41117514221 AS sv_6, 1.41082889423 AS sv_7, 0.935420833573 AS sv_8, -0.49960930113 AS sv_9 UNION ALL SELECT 18 AS sv_idx, 0.934459714151 AS dual_coeff, -0.363110024764 AS sv_0, 1.69363473194 AS sv_1, 0.908846912821 AS sv_2, -0.069570098137 AS sv_3, -0.978058001551 AS sv_4, 0.527455975727 AS sv_5, 0.904524409469 AS sv_6, 0.251219263571 AS sv_7, -0.858243057615 AS sv_8, 0.89590042084 AS sv_9 UNION ALL SELECT 19 AS sv_idx, -1.0 AS dual_coeff, -0.503460703825 AS sv_0, 0.0260628771447 AS sv_1, 0.864944547459 AS sv_2, -1.38926240861 AS sv_3, -0.384281480961 AS sv_4, -1.66024723618 AS sv_5, 1.48524097193 AS sv_6, -0.413014868169 AS sv_7, -0.134345292762 AS sv_8, 1.36312395029 AS sv_9 UNION ALL SELECT 20 AS sv_idx, 1.0 AS dual_coeff, 0.433756338034 AS sv_0, -0.435566332272 AS sv_1, -1.09086882646 AS sv_2, 0.5807993863 AS sv_3, 1.88023438798 AS sv_4, -1.30069591386 AS sv_5, 0.208190341106 AS sv_6, -0.668306318294 AS sv_7, -1.04721568828 AS sv_8, -0.484170447769 AS sv_9 UNION ALL SELECT 21 AS sv_idx, 1.0 AS dual_coeff, 0.662915119059 AS sv_0, 0.399244238769 AS sv_1, 0.35127432935 AS sv_2, 1.31940454719 AS sv_3, -0.295208801555 AS sv_4, 1.58526859658 AS sv_5, -0.0171908473114 AS sv_6, 1.12385802438 AS sv_7, 0.151746099922 AS sv_8, -0.326781053098 AS sv_9 UNION ALL SELECT 22 AS sv_idx, 0.716576628748 AS dual_coeff, 0.338624887219 AS sv_0, -0.396652897781 AS sv_1, 1.31388105728 AS sv_2, 0.616976426294 AS sv_3, -1.56331940016 AS sv_4, 0.110203485278 AS sv_5, 0.484304657851 AS sv_6, -1.3963077869 AS sv_7, -1.62044876517 AS sv_8, 1.00933325848 AS sv_9 UNION ALL SELECT 23 AS sv_idx, 0.830558233635 AS dual_coeff, 1.43842213514 AS sv_0, 0.42114127389 AS sv_1, -0.818580005853 AS sv_2, 0.0655431726 AS sv_3, -0.0410762926518 AS sv_4, 0.545884772898 AS sv_5, 0.8402534884 AS sv_6, -1.37501043487 AS sv_7, -0.556029072565 AS sv_8, -2.16722758548 AS sv_9 UNION ALL SELECT 24 AS sv_idx, 1.0 AS dual_coeff, -0.100025193538 AS sv_0, -0.00130067684022 AS sv_1, 0.412526996062 AS sv_2, 1.37262701649 AS sv_3, -0.0867761498318 AS sv_4, 0.573995261596 AS sv_5, -1.08158763296 AS sv_6, -1.42871802404 AS sv_7, 1.43930008128 AS sv_8, -0.0983080657682 AS sv_9) AS "Values"), 
kernel_dp AS 
(SELECT t."KEY" AS "KEY", t.dot_product AS dot_product 
FROM (SELECT full_join_data_sv."KEY" AS "KEY", sum(full_join_data_sv.dot_prod1) + 16.7419867512 AS dot_product 
FROM (SELECT "ADS_sca_2_OUT"."KEY" AS "KEY", "SV_data".dual_coeff * exp(-0.1 * (power("ADS_sca_2_OUT".scaler_2 - "SV_data".sv_0, 2) + power("ADS_sca_2_OUT".scaler_3 - "SV_data".sv_1, 2) + power("ADS_sca_2_OUT".scaler_4 - "SV_data".sv_2, 2) + power("ADS_sca_2_OUT".scaler_5 - "SV_data".sv_3, 2) + power("ADS_sca_2_OUT".scaler_6 - "SV_data".sv_4, 2) + power("ADS_sca_2_OUT".scaler_7 - "SV_data".sv_5, 2) + power("ADS_sca_2_OUT".scaler_8 - "SV_data".sv_6, 2) + power("ADS_sca_2_OUT".scaler_9 - "SV_data".sv_7, 2) + power("ADS_sca_2_OUT".scaler_10 - "SV_data".sv_8, 2) + power("ADS_sca_2_OUT".scaler_11 - "SV_data".sv_9, 2))) AS dot_prod1 
FROM "ADS_sca_2_OUT", "SV_data") AS full_join_data_sv GROUP BY full_join_data_sv."KEY") AS t)
 SELECT kernel_dp."KEY" AS "KEY", kernel_dp.dot_product AS "Estimator" 
FROM kernel_dp