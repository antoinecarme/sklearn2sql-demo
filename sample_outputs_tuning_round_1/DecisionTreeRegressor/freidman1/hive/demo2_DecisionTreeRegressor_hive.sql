-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2017

WITH `DT_node_lookup` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_3` <= 0.19583378732204437) THEN CASE WHEN (`ADS`.`Feature_7` <= 0.8642542362213135) THEN CASE WHEN (`ADS`.`Feature_1` <= 0.3780941963195801) THEN CASE WHEN (`ADS`.`Feature_4` <= 0.32171058654785156) THEN CASE WHEN (`ADS`.`Feature_0` <= 0.5144883394241333) THEN 5 ELSE 6 END ELSE CASE WHEN (`ADS`.`Feature_4` <= 0.4763462543487549) THEN 8 ELSE 9 END END ELSE CASE WHEN (`ADS`.`Feature_3` <= 0.04976469650864601) THEN 11 ELSE 12 END END ELSE 13 END ELSE CASE WHEN (`ADS`.`Feature_1` <= 0.27081388235092163) THEN CASE WHEN (`ADS`.`Feature_6` <= 0.560803234577179) THEN CASE WHEN (`ADS`.`Feature_5` <= 0.7398938536643982) THEN CASE WHEN (`ADS`.`Feature_6` <= 0.30342745780944824) THEN 18 ELSE 19 END ELSE 20 END ELSE CASE WHEN (`ADS`.`Feature_1` <= 0.23531199991703033) THEN CASE WHEN (`ADS`.`Feature_8` <= 0.6845853328704834) THEN 23 ELSE 24 END ELSE 25 END END ELSE CASE WHEN (`ADS`.`Feature_2` <= 0.9765533208847046) THEN CASE WHEN (`ADS`.`Feature_8` <= 0.4798669219017029) THEN CASE WHEN (`ADS`.`Feature_0` <= 0.6764531135559082) THEN 29 ELSE 30 END ELSE CASE WHEN (`ADS`.`Feature_8` <= 0.6776014566421509) THEN 32 ELSE 33 END END ELSE 34 END END END AS `node_id_2` 
FROM `freidman1` AS `ADS`), 
`DT_node_data` AS 
(SELECT `Values`.`node_id` AS `node_id`, `Values`.`feature` AS `feature`, `Values`.`threshold` AS `threshold`, `Values`.`count` AS `count`, `Values`.`depth` AS `depth`, `Values`.`parent_id` AS `parent_id`, `Values`.`Estimator` AS `Estimator` 
FROM (SELECT 0 AS `node_id`, 'Feature_3' AS `feature`, 0.19583378732204437 AS `threshold`, 25 AS `count`, 0 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 14.601553901356935 AS `Estimator` UNION ALL SELECT 1 AS `node_id`, 'Feature_7' AS `feature`, 0.8642542362213135 AS `threshold`, 7 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 8.538311403252441 AS `Estimator` UNION ALL SELECT 2 AS `node_id`, 'Feature_1' AS `feature`, 0.3780941963195801 AS `threshold`, 6 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 7.343609640129497 AS `Estimator` UNION ALL SELECT 3 AS `node_id`, 'Feature_4' AS `feature`, 0.32171058654785156 AS `threshold`, 4 AS `count`, 3 AS `depth`, 2 AS `parent_id`, 6.048706751432121 AS `Estimator` UNION ALL SELECT 4 AS `node_id`, 'Feature_0' AS `feature`, 0.5144883394241333 AS `threshold`, 2 AS `count`, 4 AS `depth`, 3 AS `parent_id`, 5.543831518879064 AS `Estimator` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 4 AS `parent_id`, 5.794379036456321 AS `Estimator` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 4 AS `parent_id`, 5.293284001301807 AS `Estimator` UNION ALL SELECT 7 AS `node_id`, 'Feature_4' AS `feature`, 0.4763462543487549 AS `threshold`, 2 AS `count`, 4 AS `depth`, 3 AS `parent_id`, 6.553581983985179 AS `Estimator` UNION ALL SELECT 8 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 7 AS `parent_id`, 6.2457102486321485 AS `Estimator` UNION ALL SELECT 9 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 7 AS `parent_id`, 6.861453719338209 AS `Estimator` UNION ALL SELECT 10 AS `node_id`, 'Feature_3' AS `feature`, 0.04976469650864601 AS `threshold`, 2 AS `count`, 3 AS `depth`, 2 AS `parent_id`, 9.933415417524246 AS `Estimator` UNION ALL SELECT 11 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 10 AS `parent_id`, 10.131789617052231 AS `Estimator` UNION ALL SELECT 12 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 10 AS `parent_id`, 9.735041217996262 AS `Estimator` UNION ALL SELECT 13 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 15.706521981990113 AS `Estimator` UNION ALL SELECT 14 AS `node_id`, 'Feature_1' AS `feature`, 0.27081388235092163 AS `threshold`, 18 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 16.95948153950868 AS `Estimator` UNION ALL SELECT 15 AS `node_id`, 'Feature_6' AS `feature`, 0.560803234577179 AS `threshold`, 6 AS `count`, 2 AS `depth`, 14 AS `parent_id`, 13.236972405410782 AS `Estimator` UNION ALL SELECT 16 AS `node_id`, 'Feature_5' AS `feature`, 0.7398938536643982 AS `threshold`, 3 AS `count`, 3 AS `depth`, 15 AS `parent_id`, 10.184052845897567 AS `Estimator` UNION ALL SELECT 17 AS `node_id`, 'Feature_6' AS `feature`, 0.30342745780944824 AS `threshold`, 2 AS `count`, 4 AS `depth`, 16 AS `parent_id`, 11.15598984450725 AS `Estimator` UNION ALL SELECT 18 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 17 AS `parent_id`, 12.109886588685942 AS `Estimator` UNION ALL SELECT 19 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 17 AS `parent_id`, 10.20209310032856 AS `Estimator` UNION ALL SELECT 20 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 16 AS `parent_id`, 8.240178848678195 AS `Estimator` UNION ALL SELECT 21 AS `node_id`, 'Feature_1' AS `feature`, 0.23531199991703033 AS `threshold`, 3 AS `count`, 3 AS `depth`, 15 AS `parent_id`, 16.289891964924 AS `Estimator` UNION ALL SELECT 22 AS `node_id`, 'Feature_8' AS `feature`, 0.6845853328704834 AS `threshold`, 2 AS `count`, 4 AS `depth`, 21 AS `parent_id`, 17.409245496013313 AS `Estimator` UNION ALL SELECT 23 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 22 AS `parent_id`, 16.324769596540094 AS `Estimator` UNION ALL SELECT 24 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 22 AS `parent_id`, 18.493721395486528 AS `Estimator` UNION ALL SELECT 25 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 21 AS `parent_id`, 14.051184902745373 AS `Estimator` UNION ALL SELECT 26 AS `node_id`, 'Feature_2' AS `feature`, 0.9765533208847046 AS `threshold`, 12 AS `count`, 2 AS `depth`, 14 AS `parent_id`, 18.820736106557636 AS `Estimator` UNION ALL SELECT 27 AS `node_id`, 'Feature_8' AS `feature`, 0.4798669219017029 AS `threshold`, 11 AS `count`, 3 AS `depth`, 26 AS `parent_id`, 18.23643407252446 AS `Estimator` UNION ALL SELECT 28 AS `node_id`, 'Feature_0' AS `feature`, 0.6764531135559082 AS `threshold`, 7 AS `count`, 4 AS `depth`, 27 AS `parent_id`, 17.629596226911758 AS `Estimator` UNION ALL SELECT 29 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 3 AS `count`, 5 AS `depth`, 28 AS `parent_id`, 16.92008643558917 AS `Estimator` UNION ALL SELECT 30 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 4 AS `count`, 5 AS `depth`, 28 AS `parent_id`, 18.161728570403696 AS `Estimator` UNION ALL SELECT 31 AS `node_id`, 'Feature_8' AS `feature`, 0.6776014566421509 AS `threshold`, 4 AS `count`, 4 AS `depth`, 27 AS `parent_id`, 19.29840030234668 AS `Estimator` UNION ALL SELECT 32 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 5 AS `depth`, 31 AS `parent_id`, 20.330419049387785 AS `Estimator` UNION ALL SELECT 33 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 2 AS `count`, 5 AS `depth`, 31 AS `parent_id`, 18.26638155530557 AS `Estimator` UNION ALL SELECT 34 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 26 AS `parent_id`, 25.24805848092261 AS `Estimator`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.`node_id_2` AS `node_id_2`, `DT_node_data`.`node_id` AS `node_id`, `DT_node_data`.`feature` AS `feature`, `DT_node_data`.`threshold` AS `threshold`, `DT_node_data`.`count` AS `count`, `DT_node_data`.`depth` AS `depth`, `DT_node_data`.`parent_id` AS `parent_id`, `DT_node_data`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.`node_id_2` = `DT_node_data`.`node_id`)
 SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`Estimator` AS `Estimator` 
FROM `DT_Output`