-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2017

WITH `ADS_imp_1_OUT` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` IS NULL) THEN 13.8597887324 ELSE `ADS`.`Feature_0` END AS `impter_2`, CASE WHEN (`ADS`.`Feature_1` IS NULL) THEN 19.5079577465 ELSE `ADS`.`Feature_1` END AS `impter_3`, CASE WHEN (`ADS`.`Feature_2` IS NULL) THEN 90.2345774648 ELSE `ADS`.`Feature_2` END AS `impter_4`, CASE WHEN (`ADS`.`Feature_3` IS NULL) THEN 631.54084507 ELSE `ADS`.`Feature_3` END AS `impter_5`, CASE WHEN (`ADS`.`Feature_4` IS NULL) THEN 0.0950171830986 ELSE `ADS`.`Feature_4` END AS `impter_6`, CASE WHEN (`ADS`.`Feature_5` IS NULL) THEN 0.103067887324 ELSE `ADS`.`Feature_5` END AS `impter_7`, CASE WHEN (`ADS`.`Feature_6` IS NULL) THEN 0.0864928380282 ELSE `ADS`.`Feature_6` END AS `impter_8`, CASE WHEN (`ADS`.`Feature_7` IS NULL) THEN 0.0468693521127 ELSE `ADS`.`Feature_7` END AS `impter_9`, CASE WHEN (`ADS`.`Feature_8` IS NULL) THEN 0.180978169014 ELSE `ADS`.`Feature_8` END AS `impter_10`, CASE WHEN (`ADS`.`Feature_9` IS NULL) THEN 0.0631552112676 ELSE `ADS`.`Feature_9` END AS `impter_11`, CASE WHEN (`ADS`.`Feature_10` IS NULL) THEN 0.412326056338 ELSE `ADS`.`Feature_10` END AS `impter_12`, CASE WHEN (`ADS`.`Feature_11` IS NULL) THEN 1.27143450704 ELSE `ADS`.`Feature_11` END AS `impter_13`, CASE WHEN (`ADS`.`Feature_12` IS NULL) THEN 2.98328169014 ELSE `ADS`.`Feature_12` END AS `impter_14`, CASE WHEN (`ADS`.`Feature_13` IS NULL) THEN 41.2231690141 ELSE `ADS`.`Feature_13` END AS `impter_15`, CASE WHEN (`ADS`.`Feature_14` IS NULL) THEN 0.00734775352113 ELSE `ADS`.`Feature_14` END AS `impter_16`, CASE WHEN (`ADS`.`Feature_15` IS NULL) THEN 0.0264921690141 ELSE `ADS`.`Feature_15` END AS `impter_17`, CASE WHEN (`ADS`.`Feature_16` IS NULL) THEN 0.032405528169 ELSE `ADS`.`Feature_16` END AS `impter_18`, CASE WHEN (`ADS`.`Feature_17` IS NULL) THEN 0.0118757676056 ELSE `ADS`.`Feature_17` END AS `impter_19`, CASE WHEN (`ADS`.`Feature_18` IS NULL) THEN 0.0213508450704 ELSE `ADS`.`Feature_18` END AS `impter_20`, CASE WHEN (`ADS`.`Feature_19` IS NULL) THEN 0.00392323450704 ELSE `ADS`.`Feature_19` END AS `impter_21`, CASE WHEN (`ADS`.`Feature_20` IS NULL) THEN 15.8818169014 ELSE `ADS`.`Feature_20` END AS `impter_22`, CASE WHEN (`ADS`.`Feature_21` IS NULL) THEN 25.8104225352 ELSE `ADS`.`Feature_21` END AS `impter_23`, CASE WHEN (`ADS`.`Feature_22` IS NULL) THEN 105.106619718 ELSE `ADS`.`Feature_22` END AS `impter_24`, CASE WHEN (`ADS`.`Feature_23` IS NULL) THEN 837.940140845 ELSE `ADS`.`Feature_23` END AS `impter_25`, CASE WHEN (`ADS`.`Feature_24` IS NULL) THEN 0.130144507042 ELSE `ADS`.`Feature_24` END AS `impter_26`, CASE WHEN (`ADS`.`Feature_25` IS NULL) THEN 0.248377464789 ELSE `ADS`.`Feature_25` END AS `impter_27`, CASE WHEN (`ADS`.`Feature_26` IS NULL) THEN 0.259110753521 ELSE `ADS`.`Feature_26` END AS `impter_28`, CASE WHEN (`ADS`.`Feature_27` IS NULL) THEN 0.109523584507 ELSE `ADS`.`Feature_27` END AS `impter_29`, CASE WHEN (`ADS`.`Feature_28` IS NULL) THEN 0.286747183099 ELSE `ADS`.`Feature_28` END AS `impter_30`, CASE WHEN (`ADS`.`Feature_29` IS NULL) THEN 0.0836747887324 ELSE `ADS`.`Feature_29` END AS `impter_31` 
FROM `BreastCancer` AS `ADS`), 
`ADS_sca_2_OUT` AS 
(SELECT `ADS_imp_1_OUT`.`KEY` AS `KEY`, (CAST(`ADS_imp_1_OUT`.`impter_2` AS FLOAT) - 13.8597887324) / 3.48110212803 AS `scaler_2`, (CAST(`ADS_imp_1_OUT`.`impter_3` AS FLOAT) - 19.5079577465) / 4.43362115357 AS `scaler_3`, (CAST(`ADS_imp_1_OUT`.`impter_4` AS FLOAT) - 90.2345774648) / 24.1038025643 AS `scaler_4`, (CAST(`ADS_imp_1_OUT`.`impter_5` AS FLOAT) - 631.54084507) / 344.884606371 AS `scaler_5`, (CAST(`ADS_imp_1_OUT`.`impter_6` AS FLOAT) - 0.0950171830986) / 0.013946197592 AS `scaler_6`, (CAST(`ADS_imp_1_OUT`.`impter_7` AS FLOAT) - 0.103067887324) / 0.051633665263 AS `scaler_7`, (CAST(`ADS_imp_1_OUT`.`impter_8` AS FLOAT) - 0.0864928380282) / 0.0758957535964 AS `scaler_8`, (CAST(`ADS_imp_1_OUT`.`impter_9` AS FLOAT) - 0.0468693521127) / 0.0384321726563 AS `scaler_9`, (CAST(`ADS_imp_1_OUT`.`impter_10` AS FLOAT) - 0.180978169014) / 0.0276998070777 AS `scaler_10`, (CAST(`ADS_imp_1_OUT`.`impter_11` AS FLOAT) - 0.0631552112676) / 0.00648056962788 AS `scaler_11`, (CAST(`ADS_imp_1_OUT`.`impter_12` AS FLOAT) - 0.412326056338) / 0.320867363603 AS `scaler_12`, (CAST(`ADS_imp_1_OUT`.`impter_13` AS FLOAT) - 1.27143450704) / 0.550314789435 AS `scaler_13`, (CAST(`ADS_imp_1_OUT`.`impter_14` AS FLOAT) - 2.98328169014) / 2.45069631007 AS `scaler_14`, (CAST(`ADS_imp_1_OUT`.`impter_15` AS FLOAT) - 41.2231690141) / 52.9190319751 AS `scaler_15`, (CAST(`ADS_imp_1_OUT`.`impter_16` AS FLOAT) - 0.00734775352113) / 0.00276275575882 AS `scaler_16`, (CAST(`ADS_imp_1_OUT`.`impter_17` AS FLOAT) - 0.0264921690141) / 0.0174086380412 AS `scaler_17`, (CAST(`ADS_imp_1_OUT`.`impter_18` AS FLOAT) - 0.032405528169) / 0.0245629776833 AS `scaler_18`, (CAST(`ADS_imp_1_OUT`.`impter_19` AS FLOAT) - 0.0118757676056) / 0.00653221319467 AS `scaler_19`, (CAST(`ADS_imp_1_OUT`.`impter_20` AS FLOAT) - 0.0213508450704) / 0.00782019780134 AS `scaler_20`, (CAST(`ADS_imp_1_OUT`.`impter_21` AS FLOAT) - 0.00392323450704) / 0.00195872778537 AS `scaler_21`, (CAST(`ADS_imp_1_OUT`.`impter_22` AS FLOAT) - 15.8818169014) / 4.65228595124 AS `scaler_22`, (CAST(`ADS_imp_1_OUT`.`impter_23` AS FLOAT) - 25.8104225352) / 6.24340698716 AS `scaler_23`, (CAST(`ADS_imp_1_OUT`.`impter_24` AS FLOAT) - 105.106619718) / 33.2876907395 AS `scaler_24`, (CAST(`ADS_imp_1_OUT`.`impter_25` AS FLOAT) - 837.940140845) / 516.877799198 AS `scaler_25`, (CAST(`ADS_imp_1_OUT`.`impter_26` AS FLOAT) - 0.130144507042) / 0.0225481406303 AS `scaler_26`, (CAST(`ADS_imp_1_OUT`.`impter_27` AS FLOAT) - 0.248377464789) / 0.152062558695 AS `scaler_27`, (CAST(`ADS_imp_1_OUT`.`impter_28` AS FLOAT) - 0.259110753521) / 0.192531701725 AS `scaler_28`, (CAST(`ADS_imp_1_OUT`.`impter_29` AS FLOAT) - 0.109523584507) / 0.0679243013098 AS `scaler_29`, (CAST(`ADS_imp_1_OUT`.`impter_30` AS FLOAT) - 0.286747183099) / 0.0597538503605 AS `scaler_30`, (CAST(`ADS_imp_1_OUT`.`impter_31` AS FLOAT) - 0.0836747887324) / 0.0156791725456 AS `scaler_31` 
FROM `ADS_imp_1_OUT`), 
`DT_node_lookup` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_22` <= 0.010356864891946316) THEN 1 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_28` <= -0.31740617752075195) THEN 3 ELSE 4 END END AS `node_id_2` 
FROM `ADS_sca_2_OUT`), 
`DT_node_data` AS 
(SELECT `Values`.`node_id` AS `node_id`, `Values`.`feature` AS `feature`, `Values`.`threshold` AS `threshold`, `Values`.`count` AS `count`, `Values`.`depth` AS `depth`, `Values`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Values`.`Decision` AS `Decision`, `Values`.`DecisionProba` AS `DecisionProba` 
FROM (SELECT 0 AS `node_id`, 'scaler_22' AS `feature`, 0.010356864891946316 AS `threshold`, 92 AS `count`, 0 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 0.34507042253521125 AS `Proba_0.0`, -1.06400675949 AS `LogProba_0.0`, 0.6549295774647887 AS `Proba_1.0`, -0.423227564448 AS `LogProba_1.0`, 1 AS `Decision`, 0.654929577465 AS `DecisionProba` UNION ALL SELECT 1 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 60 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 2 AS `node_id`, 'scaler_28' AS `feature`, -0.31740617752075195 AS `threshold`, 32 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 0.98 AS `Proba_0.0`, -0.0202027073175 AS `LogProba_0.0`, 0.02 AS `Proba_1.0`, -3.91202300543 AS `LogProba_1.0`, 0 AS `Decision`, 0.98 AS `DecisionProba` UNION ALL SELECT 3 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 2 AS `depth`, 2 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 31 AS `count`, 2 AS `depth`, 2 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.`node_id_2` AS `node_id_2`, `DT_node_data`.`node_id` AS `node_id`, `DT_node_data`.`feature` AS `feature`, `DT_node_data`.`threshold` AS `threshold`, `DT_node_data`.`count` AS `count`, `DT_node_data`.`depth` AS `depth`, `DT_node_data`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `DT_node_data`.`Decision` AS `Decision`, `DT_node_data`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.`node_id_2` = `DT_node_data`.`node_id`), 
`RF_Tree_0` AS 
(SELECT `DT_Output`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_0`, `Proba_0.0` AS `Proba_0`, `LogProba_0.0` AS `LogProba_0`, CAST(NULL AS FLOAT) AS `Score_1`, `Proba_1.0` AS `Proba_1`, `LogProba_1.0` AS `LogProba_1` 
FROM `DT_Output`), 
`DT_node_lookup_1` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_24` <= -0.0017009209841489792) THEN 1 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_18` <= -0.5995008945465088) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_3` <= -0.060437675565481186) THEN 4 ELSE 5 END ELSE 6 END END AS `node_id_2` 
FROM `ADS_sca_2_OUT`), 
`DT_node_data_1` AS 
(SELECT `Values`.`node_id` AS `node_id`, `Values`.`feature` AS `feature`, `Values`.`threshold` AS `threshold`, `Values`.`count` AS `count`, `Values`.`depth` AS `depth`, `Values`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Values`.`Decision` AS `Decision`, `Values`.`DecisionProba` AS `DecisionProba` 
FROM (SELECT 0 AS `node_id`, 'scaler_24' AS `feature`, -0.0017009209841489792 AS `threshold`, 92 AS `count`, 0 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 0.31690140845070425 AS `Proba_0.0`, -1.14916456783 AS `LogProba_0.0`, 0.6830985915492958 AS `Proba_1.0`, -0.381116079098 AS `LogProba_1.0`, 1 AS `Decision`, 0.683098591549 AS `DecisionProba` UNION ALL SELECT 1 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 59 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 2 AS `node_id`, 'scaler_18' AS `feature`, -0.5995008945465088 AS `threshold`, 33 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 0.9574468085106383 AS `Proba_0.0`, -0.0434851119397 AS `LogProba_0.0`, 0.0425531914893617 AS `Proba_1.0`, -3.15700042115 AS `LogProba_1.0`, 0 AS `Decision`, 0.957446808511 AS `DecisionProba` UNION ALL SELECT 3 AS `node_id`, 'scaler_3' AS `feature`, -0.060437675565481186 AS `threshold`, 2 AS `count`, 2 AS `depth`, 2 AS `parent_id`, 0.5 AS `Proba_0.0`, -0.69314718056 AS `LogProba_0.0`, 0.5 AS `Proba_1.0`, -0.69314718056 AS `LogProba_1.0`, 0 AS `Decision`, 0.5 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 31 AS `count`, 2 AS `depth`, 2 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_1` AS 
(SELECT `DT_node_lookup_1`.`KEY` AS `KEY`, `DT_node_lookup_1`.`node_id_2` AS `node_id_2`, `DT_node_data_1`.`node_id` AS `node_id`, `DT_node_data_1`.`feature` AS `feature`, `DT_node_data_1`.`threshold` AS `threshold`, `DT_node_data_1`.`count` AS `count`, `DT_node_data_1`.`depth` AS `depth`, `DT_node_data_1`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `DT_node_data_1`.`Decision` AS `Decision`, `DT_node_data_1`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_1` LEFT OUTER JOIN `DT_node_data_1` ON `DT_node_lookup_1`.`node_id_2` = `DT_node_data_1`.`node_id`), 
`RF_Tree_1` AS 
(SELECT `DT_Output_1`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_0`, `Proba_0.0` AS `Proba_0`, `LogProba_0.0` AS `LogProba_0`, CAST(NULL AS FLOAT) AS `Score_1`, `Proba_1.0` AS `Proba_1`, `LogProba_1.0` AS `LogProba_1` 
FROM `DT_Output_1`), 
`DT_node_lookup_2` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_24` <= 0.18154999613761902) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_25` <= -0.03403152525424957) THEN 2 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_24` <= 0.08692042529582977) THEN 4 ELSE 5 END END ELSE 6 END AS `node_id_2` 
FROM `ADS_sca_2_OUT`), 
`DT_node_data_2` AS 
(SELECT `Values`.`node_id` AS `node_id`, `Values`.`feature` AS `feature`, `Values`.`threshold` AS `threshold`, `Values`.`count` AS `count`, `Values`.`depth` AS `depth`, `Values`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Values`.`Decision` AS `Decision`, `Values`.`DecisionProba` AS `DecisionProba` 
FROM (SELECT 0 AS `node_id`, 'scaler_24' AS `feature`, 0.18154999613761902 AS `threshold`, 89 AS `count`, 0 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 0.38028169014084506 AS `Proba_0.0`, -0.966843011037 AS `LogProba_0.0`, 0.6197183098591549 AS `Proba_1.0`, -0.478490243123 AS `LogProba_1.0`, 1 AS `Decision`, 0.619718309859 AS `DecisionProba` UNION ALL SELECT 1 AS `node_id`, 'scaler_25' AS `feature`, -0.03403152525424957 AS `threshold`, 62 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 0.011235955056179775 AS `Proba_0.0`, -4.48863636973 AS `LogProba_0.0`, 0.9887640449438202 AS `Proba_1.0`, -0.0112995552539 AS `LogProba_1.0`, 1 AS `Decision`, 0.988764044944 AS `DecisionProba` UNION ALL SELECT 2 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 60 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 3 AS `node_id`, 'scaler_24' AS `feature`, 0.08692042529582977 AS `threshold`, 2 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 0.3333333333333333 AS `Proba_0.0`, -1.09861228867 AS `LogProba_0.0`, 0.6666666666666666 AS `Proba_1.0`, -0.405465108108 AS `LogProba_1.0`, 1 AS `Decision`, 0.666666666667 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 27 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_2` AS 
(SELECT `DT_node_lookup_2`.`KEY` AS `KEY`, `DT_node_lookup_2`.`node_id_2` AS `node_id_2`, `DT_node_data_2`.`node_id` AS `node_id`, `DT_node_data_2`.`feature` AS `feature`, `DT_node_data_2`.`threshold` AS `threshold`, `DT_node_data_2`.`count` AS `count`, `DT_node_data_2`.`depth` AS `depth`, `DT_node_data_2`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `DT_node_data_2`.`Decision` AS `Decision`, `DT_node_data_2`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_2` LEFT OUTER JOIN `DT_node_data_2` ON `DT_node_lookup_2`.`node_id_2` = `DT_node_data_2`.`node_id`), 
`RF_Tree_2` AS 
(SELECT `DT_Output_2`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_0`, `Proba_0.0` AS `Proba_0`, `LogProba_0.0` AS `LogProba_0`, CAST(NULL AS FLOAT) AS `Score_1`, `Proba_1.0` AS `Proba_1`, `LogProba_1.0` AS `LogProba_1` 
FROM `DT_Output_2`), 
`DT_node_lookup_3` AS 
(SELECT `ADS_sca_2_OUT`.`KEY` AS `KEY`, CASE WHEN (`ADS_sca_2_OUT`.`scaler_4` <= 0.2898058295249939) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_29` <= 0.9094891548156738) THEN CASE WHEN (`ADS_sca_2_OUT`.`scaler_30` <= 0.9573076367378235) THEN 3 ELSE CASE WHEN (`ADS_sca_2_OUT`.`scaler_28` <= 0.4611668884754181) THEN 5 ELSE 6 END END ELSE 7 END ELSE 8 END AS `node_id_2` 
FROM `ADS_sca_2_OUT`), 
`DT_node_data_3` AS 
(SELECT `Values`.`node_id` AS `node_id`, `Values`.`feature` AS `feature`, `Values`.`threshold` AS `threshold`, `Values`.`count` AS `count`, `Values`.`depth` AS `depth`, `Values`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `Values`.`Decision` AS `Decision`, `Values`.`DecisionProba` AS `DecisionProba` 
FROM (SELECT 0 AS `node_id`, 'scaler_4' AS `feature`, 0.2898058295249939 AS `threshold`, 89 AS `count`, 0 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 0.3380281690140845 AS `Proba_0.0`, -1.08462604669 AS `LogProba_0.0`, 0.6619718309859155 AS `Proba_1.0`, -0.412532275331 AS `LogProba_1.0`, 1 AS `Decision`, 0.661971830986 AS `DecisionProba` UNION ALL SELECT 1 AS `node_id`, 'scaler_29' AS `feature`, 0.9094891548156738 AS `threshold`, 64 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 0.06 AS `Proba_0.0`, -2.81341071676 AS `LogProba_0.0`, 0.94 AS `Proba_1.0`, -0.0618754037181 AS `LogProba_1.0`, 1 AS `Decision`, 0.94 AS `DecisionProba` UNION ALL SELECT 2 AS `node_id`, 'scaler_30' AS `feature`, 0.9573076367378235 AS `threshold`, 61 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 0.010526315789473684 AS `Proba_0.0`, -4.5538768916 AS `LogProba_0.0`, 0.9894736842105263 AS `Proba_1.0`, -0.0105821093305 AS `LogProba_1.0`, 1 AS `Decision`, 0.989473684211 AS `DecisionProba` UNION ALL SELECT 3 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 57 AS `count`, 3 AS `depth`, 2 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 4 AS `node_id`, 'scaler_28' AS `feature`, 0.4611668884754181 AS `threshold`, 4 AS `count`, 3 AS `depth`, 2 AS `parent_id`, 0.16666666666666666 AS `Proba_0.0`, -1.79175946923 AS `LogProba_0.0`, 0.8333333333333334 AS `Proba_1.0`, -0.182321556794 AS `LogProba_1.0`, 1 AS `Decision`, 0.833333333333 AS `DecisionProba` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 3 AS `count`, 4 AS `depth`, 4 AS `parent_id`, 0.0 AS `Proba_0.0`, -1.79769313486231e+308 AS `LogProba_0.0`, 1.0 AS `Proba_1.0`, 0.0 AS `LogProba_1.0`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 4 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 7 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 3 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 8 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 25 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.0 AS `Proba_0.0`, 0.0 AS `LogProba_0.0`, 0.0 AS `Proba_1.0`, -1.79769313486231e+308 AS `LogProba_1.0`, 0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_3` AS 
(SELECT `DT_node_lookup_3`.`KEY` AS `KEY`, `DT_node_lookup_3`.`node_id_2` AS `node_id_2`, `DT_node_data_3`.`node_id` AS `node_id`, `DT_node_data_3`.`feature` AS `feature`, `DT_node_data_3`.`threshold` AS `threshold`, `DT_node_data_3`.`count` AS `count`, `DT_node_data_3`.`depth` AS `depth`, `DT_node_data_3`.`parent_id` AS `parent_id`, `Proba_0.0` AS `Proba_0.0`, `LogProba_0.0` AS `LogProba_0.0`, `Proba_1.0` AS `Proba_1.0`, `LogProba_1.0` AS `LogProba_1.0`, `DT_node_data_3`.`Decision` AS `Decision`, `DT_node_data_3`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_3` LEFT OUTER JOIN `DT_node_data_3` ON `DT_node_lookup_3`.`node_id_2` = `DT_node_data_3`.`node_id`), 
`RF_Tree_3` AS 
(SELECT `DT_Output_3`.`KEY` AS `KEY`, CAST(NULL AS FLOAT) AS `Score_0`, `Proba_0.0` AS `Proba_0`, `LogProba_0.0` AS `LogProba_0`, CAST(NULL AS FLOAT) AS `Score_1`, `Proba_1.0` AS `Proba_1`, `LogProba_1.0` AS `LogProba_1` 
FROM `DT_Output_3`), 
`Score_Union_CTE` AS 
(SELECT `ensemble_score_union`.`KEY` AS `KEY`, `ensemble_score_union`.`Score_0` AS `Score_0`, `ensemble_score_union`.`Proba_0` AS `Proba_0`, `ensemble_score_union`.`LogProba_0` AS `LogProba_0`, `ensemble_score_union`.`Score_1` AS `Score_1`, `ensemble_score_union`.`Proba_1` AS `Proba_1`, `ensemble_score_union`.`LogProba_1` AS `LogProba_1` 
FROM (SELECT `RF_Tree_0`.`KEY` AS `KEY`, `RF_Tree_0`.`Score_0` AS `Score_0`, `RF_Tree_0`.`Proba_0` AS `Proba_0`, `RF_Tree_0`.`LogProba_0` AS `LogProba_0`, `RF_Tree_0`.`Score_1` AS `Score_1`, `RF_Tree_0`.`Proba_1` AS `Proba_1`, `RF_Tree_0`.`LogProba_1` AS `LogProba_1` 
FROM `RF_Tree_0` UNION ALL SELECT `RF_Tree_1`.`KEY` AS `KEY`, `RF_Tree_1`.`Score_0` AS `Score_0`, `RF_Tree_1`.`Proba_0` AS `Proba_0`, `RF_Tree_1`.`LogProba_0` AS `LogProba_0`, `RF_Tree_1`.`Score_1` AS `Score_1`, `RF_Tree_1`.`Proba_1` AS `Proba_1`, `RF_Tree_1`.`LogProba_1` AS `LogProba_1` 
FROM `RF_Tree_1` UNION ALL SELECT `RF_Tree_2`.`KEY` AS `KEY`, `RF_Tree_2`.`Score_0` AS `Score_0`, `RF_Tree_2`.`Proba_0` AS `Proba_0`, `RF_Tree_2`.`LogProba_0` AS `LogProba_0`, `RF_Tree_2`.`Score_1` AS `Score_1`, `RF_Tree_2`.`Proba_1` AS `Proba_1`, `RF_Tree_2`.`LogProba_1` AS `LogProba_1` 
FROM `RF_Tree_2` UNION ALL SELECT `RF_Tree_3`.`KEY` AS `KEY`, `RF_Tree_3`.`Score_0` AS `Score_0`, `RF_Tree_3`.`Proba_0` AS `Proba_0`, `RF_Tree_3`.`LogProba_0` AS `LogProba_0`, `RF_Tree_3`.`Score_1` AS `Score_1`, `RF_Tree_3`.`Proba_1` AS `Proba_1`, `RF_Tree_3`.`LogProba_1` AS `LogProba_1` 
FROM `RF_Tree_3`) AS `ensemble_score_union`), 
`RF_AVG_Scores` AS 
(SELECT `T`.`KEY` AS `KEY`, `T`.`Score_0` AS `Score_0`, `T`.`Proba_0` AS `Proba_0`, `T`.`LogProba_0` AS `LogProba_0`, `T`.`Score_1` AS `Score_1`, `T`.`Proba_1` AS `Proba_1`, `T`.`LogProba_1` AS `LogProba_1` 
FROM (SELECT `Score_Union_CTE`.`KEY` AS `KEY`, avg(`Score_Union_CTE`.`Score_0`) AS `Score_0`, avg(`Score_Union_CTE`.`Proba_0`) AS `Proba_0`, avg(`Score_Union_CTE`.`LogProba_0`) AS `LogProba_0`, avg(`Score_Union_CTE`.`Score_1`) AS `Score_1`, avg(`Score_Union_CTE`.`Proba_1`) AS `Proba_1`, avg(`Score_Union_CTE`.`LogProba_1`) AS `LogProba_1` 
FROM `Score_Union_CTE` GROUP BY `Score_Union_CTE`.`KEY`) AS `T`), 
`orig_cte` AS 
(SELECT `RF_AVG_Scores`.`KEY` AS `KEY`, `RF_AVG_Scores`.`Score_0` AS `Score_0`, `RF_AVG_Scores`.`Score_1` AS `Score_1`, `RF_AVG_Scores`.`Proba_0` AS `Proba_0`, `RF_AVG_Scores`.`Proba_1` AS `Proba_1`, `RF_AVG_Scores`.`LogProba_0` AS `LogProba_0`, `RF_AVG_Scores`.`LogProba_1` AS `LogProba_1`, CAST(NULL AS INT) AS `Decision`, CAST(NULL AS FLOAT) AS `DecisionProba` 
FROM `RF_AVG_Scores`), 
`score_class_union` AS 
(SELECT `scu`.`KEY_u` AS `KEY_u`, `scu`.`class` AS `class`, `scu`.`LogProba` AS `LogProba`, `scu`.`Proba` AS `Proba`, `scu`.`Score` AS `Score` 
FROM (SELECT `orig_cte`.`KEY` AS `KEY_u`, 0 AS `class`, `orig_cte`.`LogProba_0` AS `LogProba`, `orig_cte`.`Proba_0` AS `Proba`, `orig_cte`.`Score_0` AS `Score` 
FROM `orig_cte` UNION ALL SELECT `orig_cte`.`KEY` AS `KEY_u`, 1 AS `class`, `orig_cte`.`LogProba_1` AS `LogProba`, `orig_cte`.`Proba_1` AS `Proba`, `orig_cte`.`Score_1` AS `Score` 
FROM `orig_cte`) AS `scu`), 
`score_max` AS 
(SELECT `orig_cte`.`KEY` AS `KEY`, `orig_cte`.`Score_0` AS `Score_0`, `orig_cte`.`Score_1` AS `Score_1`, `orig_cte`.`Proba_0` AS `Proba_0`, `orig_cte`.`Proba_1` AS `Proba_1`, `orig_cte`.`LogProba_0` AS `LogProba_0`, `orig_cte`.`LogProba_1` AS `LogProba_1`, `orig_cte`.`Decision` AS `Decision`, `orig_cte`.`DecisionProba` AS `DecisionProba`, `max_select`.`KEY_m` AS `KEY_m`, `max_select`.`max_Proba` AS `max_Proba` 
FROM `orig_cte` LEFT OUTER JOIN (SELECT `score_class_union`.`KEY_u` AS `KEY_m`, max(`score_class_union`.`Proba`) AS `max_Proba` 
FROM `score_class_union` GROUP BY `score_class_union`.`KEY_u`) AS `max_select` ON `orig_cte`.`KEY` = `max_select`.`KEY_m`), 
`union_with_max` AS 
(SELECT `score_class_union`.`KEY_u` AS `KEY_u`, `score_class_union`.`class` AS `class`, `score_class_union`.`LogProba` AS `LogProba`, `score_class_union`.`Proba` AS `Proba`, `score_class_union`.`Score` AS `Score`, `score_max`.`KEY` AS `KEY`, `score_max`.`Score_0` AS `Score_0`, `score_max`.`Score_1` AS `Score_1`, `score_max`.`Proba_0` AS `Proba_0`, `score_max`.`Proba_1` AS `Proba_1`, `score_max`.`LogProba_0` AS `LogProba_0`, `score_max`.`LogProba_1` AS `LogProba_1`, `score_max`.`Decision` AS `Decision`, `score_max`.`DecisionProba` AS `DecisionProba`, `score_max`.`KEY_m` AS `KEY_m`, `score_max`.`max_Proba` AS `max_Proba` 
FROM `score_class_union` LEFT OUTER JOIN `score_max` ON `score_class_union`.`KEY_u` = `score_max`.`KEY`), 
`arg_max_cte` AS 
(SELECT `score_max`.`KEY` AS `KEY`, `score_max`.`Score_0` AS `Score_0`, `score_max`.`Score_1` AS `Score_1`, `score_max`.`Proba_0` AS `Proba_0`, `score_max`.`Proba_1` AS `Proba_1`, `score_max`.`LogProba_0` AS `LogProba_0`, `score_max`.`LogProba_1` AS `LogProba_1`, `score_max`.`Decision` AS `Decision`, `score_max`.`DecisionProba` AS `DecisionProba`, `score_max`.`KEY_m` AS `KEY_m`, `score_max`.`max_Proba` AS `max_Proba`, `arg_max_t_Proba`.`KEY_Proba` AS `KEY_Proba`, `arg_max_t_Proba`.`arg_max_Proba` AS `arg_max_Proba` 
FROM `score_max` LEFT OUTER JOIN (SELECT `union_with_max`.`KEY` AS `KEY_Proba`, min(`union_with_max`.`class`) AS `arg_max_Proba` 
FROM `union_with_max` 
WHERE `union_with_max`.`max_Proba` <= `union_with_max`.`Proba` GROUP BY `union_with_max`.`KEY`) AS `arg_max_t_Proba` ON `score_max`.`KEY` = `arg_max_t_Proba`.`KEY_Proba`)
 SELECT `arg_max_cte`.`KEY` AS `KEY`, `arg_max_cte`.`Score_0` AS `Score_0`, `arg_max_cte`.`Score_1` AS `Score_1`, `arg_max_cte`.`Proba_0` AS `Proba_0`, `arg_max_cte`.`Proba_1` AS `Proba_1`, CASE WHEN (`arg_max_cte`.`Proba_0` IS NULL OR `arg_max_cte`.`Proba_0` > 0.0) THEN log(`arg_max_cte`.`Proba_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (`arg_max_cte`.`Proba_1` IS NULL OR `arg_max_cte`.`Proba_1` > 0.0) THEN log(`arg_max_cte`.`Proba_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, `arg_max_cte`.`arg_max_Proba` AS `Decision`, `arg_max_cte`.`max_Proba` AS `DecisionProba` 
FROM `arg_max_cte`