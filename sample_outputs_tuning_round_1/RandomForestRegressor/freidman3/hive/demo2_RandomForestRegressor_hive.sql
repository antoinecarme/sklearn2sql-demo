-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2017

WITH `DT_node_lookup` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_2` <= 0.10105706006288528) THEN 1 ELSE CASE WHEN (`ADS`.`Feature_0` <= 13.800018310546875) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.385817289352417) THEN CASE WHEN (`ADS`.`Feature_1` <= 646.9130249023438) THEN 5 ELSE 6 END ELSE CASE WHEN (`ADS`.`Feature_0` <= 6.23792839050293) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.464474081993103) THEN 9 ELSE CASE WHEN (`ADS`.`Feature_0` <= 0.9537165760993958) THEN 11 ELSE 12 END END ELSE 13 END END ELSE CASE WHEN (`ADS`.`Feature_2` <= 0.5081185102462769) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.3785582482814789) THEN CASE WHEN (`ADS`.`Feature_3` <= 3.9747726917266846) THEN 17 ELSE 18 END ELSE 19 END ELSE CASE WHEN (`ADS`.`Feature_2` <= 0.5898985862731934) THEN 21 ELSE CASE WHEN (`ADS`.`Feature_1` <= 1173.8807373046875) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.7017911672592163) THEN 24 ELSE CASE WHEN (`ADS`.`Feature_1` <= 804.4940185546875) THEN 26 ELSE 27 END END ELSE 28 END END END END END AS `node_id_2` 
FROM `freidman3` AS `ADS`), 
`DT_node_data` AS 
(SELECT `Values`.`node_id` AS `node_id`, `Values`.`feature` AS `feature`, `Values`.`threshold` AS `threshold`, `Values`.`count` AS `count`, `Values`.`depth` AS `depth`, `Values`.`parent_id` AS `parent_id`, `Values`.`Estimator` AS `Estimator` 
FROM (SELECT 0 AS `node_id`, 'Feature_2' AS `feature`, 0.10105706006288528 AS `threshold`, 15 AS `count`, 0 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 1.4731838320163444 AS `Estimator` UNION ALL SELECT 1 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 0.8079109230317987 AS `Estimator` UNION ALL SELECT 2 AS `node_id`, 'Feature_0' AS `feature`, 13.800018310546875 AS `threshold`, 14 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.5009035365573675 AS `Estimator` UNION ALL SELECT 3 AS `node_id`, 'Feature_2' AS `feature`, 0.385817289352417 AS `threshold`, 6 AS `count`, 2 AS `depth`, 2 AS `parent_id`, 1.5528797542122084 AS `Estimator` UNION ALL SELECT 4 AS `node_id`, 'Feature_1' AS `feature`, 646.9130249023438 AS `threshold`, 2 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 1.5364135743848693 AS `Estimator` UNION ALL SELECT 5 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 4 AS `parent_id`, 1.5359670902044162 AS `Estimator` UNION ALL SELECT 6 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 4 AS `parent_id`, 1.536711230505171 AS `Estimator` UNION ALL SELECT 7 AS `node_id`, 'Feature_0' AS `feature`, 6.23792839050293 AS `threshold`, 4 AS `count`, 3 AS `depth`, 3 AS `parent_id`, 1.5631711166042952 AS `Estimator` UNION ALL SELECT 8 AS `node_id`, 'Feature_2' AS `feature`, 0.464474081993103 AS `threshold`, 3 AS `count`, 4 AS `depth`, 7 AS `parent_id`, 1.5674126046105237 AS `Estimator` UNION ALL SELECT 9 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 8 AS `parent_id`, 1.5646091245855271 AS `Estimator` UNION ALL SELECT 10 AS `node_id`, 'Feature_0' AS `feature`, 0.9537165760993958 AS `threshold`, 2 AS `count`, 5 AS `depth`, 8 AS `parent_id`, 1.5692815912938547 AS `Estimator` UNION ALL SELECT 11 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 10 AS `parent_id`, 1.5696790399866454 AS `Estimator` UNION ALL SELECT 12 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 10 AS `parent_id`, 1.5684866939082733 AS `Estimator` UNION ALL SELECT 13 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 7 AS `parent_id`, 1.556101969927248 AS `Estimator` UNION ALL SELECT 14 AS `node_id`, 'Feature_2' AS `feature`, 0.5081185102462769 AS `threshold`, 8 AS `count`, 2 AS `depth`, 2 AS `parent_id`, 1.439477097510737 AS `Estimator` UNION ALL SELECT 15 AS `node_id`, 'Feature_2' AS `feature`, 0.3785582482814789 AS `threshold`, 3 AS `count`, 3 AS `depth`, 14 AS `parent_id`, 1.3767934743188395 AS `Estimator` UNION ALL SELECT 16 AS `node_id`, 'Feature_3' AS `feature`, 3.9747726917266846 AS `threshold`, 2 AS `count`, 4 AS `depth`, 15 AS `parent_id`, 1.368305858765039 AS `Estimator` UNION ALL SELECT 17 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 16 AS `parent_id`, 1.3678941404936502 AS `Estimator` UNION ALL SELECT 18 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 16 AS `parent_id`, 1.3687175770364277 AS `Estimator` UNION ALL SELECT 19 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 15 AS `parent_id`, 1.410743936534041 AS `Estimator` UNION ALL SELECT 20 AS `node_id`, 'Feature_2' AS `feature`, 0.5898985862731934 AS `threshold`, 5 AS `count`, 3 AS `depth`, 14 AS `parent_id`, 1.4917134501706517 AS `Estimator` UNION ALL SELECT 21 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 20 AS `parent_id`, 1.467648677980467 AS `Estimator` UNION ALL SELECT 22 AS `node_id`, 'Feature_1' AS `feature`, 1173.8807373046875 AS `threshold`, 4 AS `count`, 4 AS `depth`, 20 AS `parent_id`, 1.4965264046086886 AS `Estimator` UNION ALL SELECT 23 AS `node_id`, 'Feature_2' AS `feature`, 0.7017911672592163 AS `threshold`, 3 AS `count`, 5 AS `depth`, 22 AS `parent_id`, 1.49318296852536 AS `Estimator` UNION ALL SELECT 24 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 23 AS `parent_id`, 1.4872578515104244 AS `Estimator` UNION ALL SELECT 25 AS `node_id`, 'Feature_1' AS `feature`, 804.4940185546875 AS `threshold`, 2 AS `count`, 6 AS `depth`, 23 AS `parent_id`, 1.4951580075303383 AS `Estimator` UNION ALL SELECT 26 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 7 AS `depth`, 25 AS `parent_id`, 1.499027385598966 AS `Estimator` UNION ALL SELECT 27 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 7 AS `depth`, 25 AS `parent_id`, 1.4932233184960249 AS `Estimator` UNION ALL SELECT 28 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 22 AS `parent_id`, 1.5099001489420028 AS `Estimator`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.`node_id_2` AS `node_id_2`, `DT_node_data`.`node_id` AS `node_id`, `DT_node_data`.`feature` AS `feature`, `DT_node_data`.`threshold` AS `threshold`, `DT_node_data`.`count` AS `count`, `DT_node_data`.`depth` AS `depth`, `DT_node_data`.`parent_id` AS `parent_id`, `DT_node_data`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.`node_id_2` = `DT_node_data`.`node_id`), 
`RF_Tree_0` AS 
(SELECT `DT_Output`.`KEY` AS `KEY`, `DT_Output`.`Estimator` AS `Estimator` 
FROM `DT_Output`), 
`DT_node_lookup_1` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_2` <= 0.13676801323890686) THEN CASE WHEN (`ADS`.`Feature_0` <= 16.939800262451172) THEN 2 ELSE 3 END ELSE CASE WHEN (`ADS`.`Feature_1` <= 966.9429931640625) THEN CASE WHEN (`ADS`.`Feature_3` <= 7.111601829528809) THEN CASE WHEN (`ADS`.`Feature_0` <= 56.244239807128906) THEN CASE WHEN (`ADS`.`Feature_3` <= 4.250613212585449) THEN 8 ELSE 9 END ELSE 10 END ELSE CASE WHEN (`ADS`.`Feature_2` <= 0.4767981767654419) THEN 12 ELSE CASE WHEN (`ADS`.`Feature_0` <= 52.28789520263672) THEN CASE WHEN (`ADS`.`Feature_0` <= 33.87558364868164) THEN 15 ELSE 16 END ELSE 17 END END END ELSE CASE WHEN (`ADS`.`Feature_0` <= 55.967384338378906) THEN CASE WHEN (`ADS`.`Feature_3` <= 5.5667524337768555) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.8574210405349731) THEN 21 ELSE 22 END ELSE CASE WHEN (`ADS`.`Feature_1` <= 1127.53125) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.5254714488983154) THEN 25 ELSE 26 END ELSE 27 END END ELSE CASE WHEN (`ADS`.`Feature_2` <= 0.9793506264686584) THEN 29 ELSE 30 END END END END AS `node_id_2` 
FROM `freidman3` AS `ADS`), 
`DT_node_data_1` AS 
(SELECT `Values`.`node_id` AS `node_id`, `Values`.`feature` AS `feature`, `Values`.`threshold` AS `threshold`, `Values`.`count` AS `count`, `Values`.`depth` AS `depth`, `Values`.`parent_id` AS `parent_id`, `Values`.`Estimator` AS `Estimator` 
FROM (SELECT 0 AS `node_id`, 'Feature_2' AS `feature`, 0.13676801323890686 AS `threshold`, 16 AS `count`, 0 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 1.47126635805493 AS `Estimator` UNION ALL SELECT 1 AS `node_id`, 'Feature_0' AS `feature`, 16.939800262451172 AS `threshold`, 2 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.2455031803026952 AS `Estimator` UNION ALL SELECT 2 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 1.1409162524546155 AS `Estimator` UNION ALL SELECT 3 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 1.350090108150775 AS `Estimator` UNION ALL SELECT 4 AS `node_id`, 'Feature_1' AS `feature`, 966.9429931640625 AS `threshold`, 14 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.4908979387290375 AS `Estimator` UNION ALL SELECT 5 AS `node_id`, 'Feature_3' AS `feature`, 7.111601829528809 AS `threshold`, 7 AS `count`, 2 AS `depth`, 4 AS `parent_id`, 1.460333496675459 AS `Estimator` UNION ALL SELECT 6 AS `node_id`, 'Feature_0' AS `feature`, 56.244239807128906 AS `threshold`, 3 AS `count`, 3 AS `depth`, 5 AS `parent_id`, 1.3813864199582429 AS `Estimator` UNION ALL SELECT 7 AS `node_id`, 'Feature_3' AS `feature`, 4.250613212585449 AS `threshold`, 2 AS `count`, 4 AS `depth`, 6 AS `parent_id`, 1.4155560301845382 AS `Estimator` UNION ALL SELECT 8 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 7 AS `parent_id`, 1.410743936534041 AS `Estimator` UNION ALL SELECT 9 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 7 AS `parent_id`, 1.4251802174855326 AS `Estimator` UNION ALL SELECT 10 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 6 AS `parent_id`, 1.278877589279357 AS `Estimator` UNION ALL SELECT 11 AS `node_id`, 'Feature_2' AS `feature`, 0.4767981767654419 AS `threshold`, 4 AS `count`, 3 AS `depth`, 5 AS `parent_id`, 1.4954210863275552 AS `Estimator` UNION ALL SELECT 12 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 11 AS `parent_id`, 1.5359670902044162 AS `Estimator` UNION ALL SELECT 13 AS `node_id`, 'Feature_0' AS `feature`, 52.28789520263672 AS `threshold`, 3 AS `count`, 4 AS `depth`, 11 AS `parent_id`, 1.4838365137913094 AS `Estimator` UNION ALL SELECT 14 AS `node_id`, 'Feature_0' AS `feature`, 33.87558364868164 AS `threshold`, 2 AS `count`, 5 AS `depth`, 13 AS `parent_id`, 1.4911810295399384 AS `Estimator` UNION ALL SELECT 15 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 14 AS `parent_id`, 1.499027385598966 AS `Estimator` UNION ALL SELECT 16 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 14 AS `parent_id`, 1.4872578515104244 AS `Estimator` UNION ALL SELECT 17 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 13 AS `parent_id`, 1.4783281269798374 AS `Estimator` UNION ALL SELECT 18 AS `node_id`, 'Feature_0' AS `feature`, 55.967384338378906 AS `threshold`, 7 AS `count`, 2 AS `depth`, 4 AS `parent_id`, 1.5306317133986889 AS `Estimator` UNION ALL SELECT 19 AS `node_id`, 'Feature_3' AS `feature`, 5.5667524337768555 AS `threshold`, 5 AS `count`, 3 AS `depth`, 18 AS `parent_id`, 1.5378992083186076 AS `Estimator` UNION ALL SELECT 20 AS `node_id`, 'Feature_2' AS `feature`, 0.8574210405349731 AS `threshold`, 2 AS `count`, 4 AS `depth`, 19 AS `parent_id`, 1.5291542683061832 AS `Estimator` UNION ALL SELECT 21 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 20 AS `parent_id`, 1.527629409709021 AS `Estimator` UNION ALL SELECT 22 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 20 AS `parent_id`, 1.5352537026948319 AS `Estimator` UNION ALL SELECT 23 AS `node_id`, 'Feature_1' AS `feature`, 1127.53125 AS `threshold`, 3 AS `count`, 4 AS `depth`, 19 AS `parent_id`, 1.5524741083393154 AS `Estimator` UNION ALL SELECT 24 AS `node_id`, 'Feature_2' AS `feature`, 0.5254714488983154 AS `threshold`, 2 AS `count`, 5 AS `depth`, 23 AS `parent_id`, 1.5603555472563877 AS `Estimator` UNION ALL SELECT 25 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 24 AS `parent_id`, 1.5646091245855271 AS `Estimator` UNION ALL SELECT 26 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 24 AS `parent_id`, 1.556101969927248 AS `Estimator` UNION ALL SELECT 27 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 23 AS `parent_id`, 1.536711230505171 AS `Estimator` UNION ALL SELECT 28 AS `node_id`, 'Feature_2' AS `feature`, 0.9793506264686584 AS `threshold`, 2 AS `count`, 3 AS `depth`, 18 AS `parent_id`, 1.5015617337190137 AS `Estimator` UNION ALL SELECT 29 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 28 AS `parent_id`, 1.4932233184960249 AS `Estimator` UNION ALL SELECT 30 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 28 AS `parent_id`, 1.5099001489420028 AS `Estimator`) AS `Values`), 
`DT_Output_1` AS 
(SELECT `DT_node_lookup_1`.`KEY` AS `KEY`, `DT_node_lookup_1`.`node_id_2` AS `node_id_2`, `DT_node_data_1`.`node_id` AS `node_id`, `DT_node_data_1`.`feature` AS `feature`, `DT_node_data_1`.`threshold` AS `threshold`, `DT_node_data_1`.`count` AS `count`, `DT_node_data_1`.`depth` AS `depth`, `DT_node_data_1`.`parent_id` AS `parent_id`, `DT_node_data_1`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_1` LEFT OUTER JOIN `DT_node_data_1` ON `DT_node_lookup_1`.`node_id_2` = `DT_node_data_1`.`node_id`), 
`RF_Tree_1` AS 
(SELECT `DT_Output_1`.`KEY` AS `KEY`, `DT_Output_1`.`Estimator` AS `Estimator` 
FROM `DT_Output_1`), 
`DT_node_lookup_2` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_0` <= 38.28752899169922) THEN CASE WHEN (`ADS`.`Feature_0` <= 13.720671653747559) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.3232201933860779) THEN 3 ELSE CASE WHEN (`ADS`.`Feature_0` <= 6.23792839050293) THEN CASE WHEN (`ADS`.`Feature_0` <= 2.331439256668091) THEN CASE WHEN (`ADS`.`Feature_1` <= 543.8361206054688) THEN 7 ELSE 8 END ELSE 9 END ELSE 10 END END ELSE CASE WHEN (`ADS`.`Feature_0` <= 26.258804321289062) THEN CASE WHEN (`ADS`.`Feature_1` <= 879.0789794921875) THEN 13 ELSE 14 END ELSE CASE WHEN (`ADS`.`Feature_3` <= 5.198558330535889) THEN 16 ELSE CASE WHEN (`ADS`.`Feature_3` <= 9.286079406738281) THEN 18 ELSE 19 END END END END ELSE CASE WHEN (`ADS`.`Feature_1` <= 598.1278076171875) THEN CASE WHEN (`ADS`.`Feature_0` <= 55.48760223388672) THEN 22 ELSE CASE WHEN (`ADS`.`Feature_1` <= 233.356201171875) THEN 24 ELSE 25 END END ELSE CASE WHEN (`ADS`.`Feature_3` <= 1.7327909469604492) THEN 27 ELSE CASE WHEN (`ADS`.`Feature_1` <= 1316.639404296875) THEN 29 ELSE 30 END END END END AS `node_id_2` 
FROM `freidman3` AS `ADS`), 
`DT_node_data_2` AS 
(SELECT `Values`.`node_id` AS `node_id`, `Values`.`feature` AS `feature`, `Values`.`threshold` AS `threshold`, `Values`.`count` AS `count`, `Values`.`depth` AS `depth`, `Values`.`parent_id` AS `parent_id`, `Values`.`Estimator` AS `Estimator` 
FROM (SELECT 0 AS `node_id`, 'Feature_0' AS `feature`, 38.28752899169922 AS `threshold`, 16 AS `count`, 0 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 1.4133936077119507 AS `Estimator` UNION ALL SELECT 1 AS `node_id`, 'Feature_0' AS `feature`, 13.720671653747559 AS `threshold`, 10 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.5114074553580923 AS `Estimator` UNION ALL SELECT 2 AS `node_id`, 'Feature_2' AS `feature`, 0.3232201933860779 AS `threshold`, 5 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 1.558323431748776 AS `Estimator` UNION ALL SELECT 3 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 2 AS `parent_id`, 1.536711230505171 AS `Estimator` UNION ALL SELECT 4 AS `node_id`, 'Feature_0' AS `feature`, 6.23792839050293 AS `threshold`, 4 AS `count`, 3 AS `depth`, 2 AS `parent_id`, 1.5655274988299777 AS `Estimator` UNION ALL SELECT 5 AS `node_id`, 'Feature_0' AS `feature`, 2.331439256668091 AS `threshold`, 3 AS `count`, 4 AS `depth`, 4 AS `parent_id`, 1.5674126046105237 AS `Estimator` UNION ALL SELECT 6 AS `node_id`, 'Feature_1' AS `feature`, 543.8361206054688 AS `threshold`, 2 AS `count`, 5 AS `depth`, 5 AS `parent_id`, 1.5692815912938547 AS `Estimator` UNION ALL SELECT 7 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 6 AS `parent_id`, 1.5696790399866454 AS `Estimator` UNION ALL SELECT 8 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 6 AS `parent_id`, 1.5684866939082733 AS `Estimator` UNION ALL SELECT 9 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 5 AS `parent_id`, 1.5646091245855271 AS `Estimator` UNION ALL SELECT 10 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 4 AS `parent_id`, 1.556101969927248 AS `Estimator` UNION ALL SELECT 11 AS `node_id`, 'Feature_0' AS `feature`, 26.258804321289062 AS `threshold`, 5 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 1.4488528201705133 AS `Estimator` UNION ALL SELECT 12 AS `node_id`, 'Feature_1' AS `feature`, 879.0789794921875 AS `threshold`, 2 AS `count`, 3 AS `depth`, 11 AS `parent_id`, 1.390525993739619 AS `Estimator` UNION ALL SELECT 13 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 12 AS `parent_id`, 1.410743936534041 AS `Estimator` UNION ALL SELECT 14 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 12 AS `parent_id`, 1.350090108150775 AS `Estimator` UNION ALL SELECT 15 AS `node_id`, 'Feature_3' AS `feature`, 5.198558330535889 AS `threshold`, 3 AS `count`, 3 AS `depth`, 11 AS `parent_id`, 1.5071796466014076 AS `Estimator` UNION ALL SELECT 16 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 15 AS `parent_id`, 1.5352537026948319 AS `Estimator` UNION ALL SELECT 17 AS `node_id`, 'Feature_3' AS `feature`, 9.286079406738281 AS `threshold`, 2 AS `count`, 4 AS `depth`, 15 AS `parent_id`, 1.4931426185546952 AS `Estimator` UNION ALL SELECT 18 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 17 AS `parent_id`, 1.499027385598966 AS `Estimator` UNION ALL SELECT 19 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 17 AS `parent_id`, 1.4872578515104244 AS `Estimator` UNION ALL SELECT 20 AS `node_id`, 'Feature_1' AS `feature`, 598.1278076171875 AS `threshold`, 6 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.2886487107077713 AS `Estimator` UNION ALL SELECT 21 AS `node_id`, 'Feature_0' AS `feature`, 55.48760223388672 AS `threshold`, 3 AS `count`, 2 AS `depth`, 20 AS `parent_id`, 1.1037915634109876 AS `Estimator` UNION ALL SELECT 22 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 21 AS `parent_id`, 0.8079109230317987 AS `Estimator` UNION ALL SELECT 23 AS `node_id`, 'Feature_1' AS `feature`, 233.356201171875 AS `threshold`, 2 AS `count`, 3 AS `depth`, 21 AS `parent_id`, 1.1777617235057845 AS `Estimator` UNION ALL SELECT 24 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 23 AS `parent_id`, 1.1440564349145939 AS `Estimator` UNION ALL SELECT 25 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 23 AS `parent_id`, 1.278877589279357 AS `Estimator` UNION ALL SELECT 26 AS `node_id`, 'Feature_3' AS `feature`, 1.7327909469604492 AS `threshold`, 3 AS `count`, 2 AS `depth`, 20 AS `parent_id`, 1.442696333455091 AS `Estimator` UNION ALL SELECT 27 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 3 AS `depth`, 26 AS `parent_id`, 1.3678941404936502 AS `Estimator` UNION ALL SELECT 28 AS `node_id`, 'Feature_1' AS `feature`, 1316.639404296875 AS `threshold`, 2 AS `count`, 3 AS `depth`, 26 AS `parent_id`, 1.5174985264165322 AS `Estimator` UNION ALL SELECT 29 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 28 AS `parent_id`, 1.5099001489420028 AS `Estimator` UNION ALL SELECT 30 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 28 AS `parent_id`, 1.521297715153797 AS `Estimator`) AS `Values`), 
`DT_Output_2` AS 
(SELECT `DT_node_lookup_2`.`KEY` AS `KEY`, `DT_node_lookup_2`.`node_id_2` AS `node_id_2`, `DT_node_data_2`.`node_id` AS `node_id`, `DT_node_data_2`.`feature` AS `feature`, `DT_node_data_2`.`threshold` AS `threshold`, `DT_node_data_2`.`count` AS `count`, `DT_node_data_2`.`depth` AS `depth`, `DT_node_data_2`.`parent_id` AS `parent_id`, `DT_node_data_2`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_2` LEFT OUTER JOIN `DT_node_data_2` ON `DT_node_lookup_2`.`node_id_2` = `DT_node_data_2`.`node_id`), 
`RF_Tree_2` AS 
(SELECT `DT_Output_2`.`KEY` AS `KEY`, `DT_Output_2`.`Estimator` AS `Estimator` 
FROM `DT_Output_2`), 
`DT_node_lookup_3` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_2` <= 0.10105706006288528) THEN CASE WHEN (`ADS`.`Feature_3` <= 6.2739129066467285) THEN 2 ELSE 3 END ELSE CASE WHEN (`ADS`.`Feature_3` <= 7.192191123962402) THEN CASE WHEN (`ADS`.`Feature_1` <= 924.8966064453125) THEN CASE WHEN (`ADS`.`Feature_0` <= 72.9434814453125) THEN CASE WHEN (`ADS`.`Feature_0` <= 58.768211364746094) THEN CASE WHEN (`ADS`.`Feature_3` <= 3.9747726917266846) THEN 9 ELSE 10 END ELSE 11 END ELSE 12 END ELSE CASE WHEN (`ADS`.`Feature_2` <= 0.9684208631515503) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.8579881191253662) THEN 15 ELSE 16 END ELSE CASE WHEN (`ADS`.`Feature_0` <= 78.56736755371094) THEN 18 ELSE 19 END END END ELSE CASE WHEN (`ADS`.`Feature_0` <= 20.661970138549805) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.385817289352417) THEN CASE WHEN (`ADS`.`Feature_2` <= 0.2778056263923645) THEN 23 ELSE 24 END ELSE CASE WHEN (`ADS`.`Feature_3` <= 9.9036865234375) THEN CASE WHEN (`ADS`.`Feature_3` <= 9.250843048095703) THEN 27 ELSE 28 END ELSE 29 END END ELSE CASE WHEN (`ADS`.`Feature_2` <= 0.5898985862731934) THEN 31 ELSE CASE WHEN (`ADS`.`Feature_2` <= 0.7017911672592163) THEN 33 ELSE CASE WHEN (`ADS`.`Feature_1` <= 984.7573852539062) THEN 35 ELSE 36 END END END END END END AS `node_id_2` 
FROM `freidman3` AS `ADS`), 
`DT_node_data_3` AS 
(SELECT `Values`.`node_id` AS `node_id`, `Values`.`feature` AS `feature`, `Values`.`threshold` AS `threshold`, `Values`.`count` AS `count`, `Values`.`depth` AS `depth`, `Values`.`parent_id` AS `parent_id`, `Values`.`Estimator` AS `Estimator` 
FROM (SELECT 0 AS `node_id`, 'Feature_2' AS `feature`, 0.10105706006288528 AS `threshold`, 19 AS `count`, 0 AS `depth`, CAST(NULL AS INT) AS `parent_id`, 1.4318511894647625 AS `Estimator` UNION ALL SELECT 1 AS `node_id`, 'Feature_3' AS `feature`, 6.2739129066467285 AS `threshold`, 2 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 0.9744135877432071 AS `Estimator` UNION ALL SELECT 2 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 0.8079109230317987 AS `Estimator` UNION ALL SELECT 3 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 2 AS `depth`, 1 AS `parent_id`, 1.1409162524546155 AS `Estimator` UNION ALL SELECT 4 AS `node_id`, 'Feature_3' AS `feature`, 7.192191123962402 AS `threshold`, 17 AS `count`, 1 AS `depth`, 0 AS `parent_id`, 1.4716283722231587 AS `Estimator` UNION ALL SELECT 5 AS `node_id`, 'Feature_1' AS `feature`, 924.8966064453125 AS `threshold`, 8 AS `count`, 2 AS `depth`, 4 AS `parent_id`, 1.3955008907997986 AS `Estimator` UNION ALL SELECT 6 AS `node_id`, 'Feature_0' AS `feature`, 72.9434814453125 AS `threshold`, 4 AS `count`, 3 AS `depth`, 5 AS `parent_id`, 1.3158890037852216 AS `Estimator` UNION ALL SELECT 7 AS `node_id`, 'Feature_0' AS `feature`, 58.768211364746094 AS `threshold`, 3 AS `count`, 4 AS `depth`, 6 AS `parent_id`, 1.3502555175593471 AS `Estimator` UNION ALL SELECT 8 AS `node_id`, 'Feature_3' AS `feature`, 3.9747726917266846 AS `threshold`, 2 AS `count`, 5 AS `depth`, 7 AS `parent_id`, 1.3680999996293446 AS `Estimator` UNION ALL SELECT 9 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 8 AS `parent_id`, 1.3678941404936502 AS `Estimator` UNION ALL SELECT 10 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 8 AS `parent_id`, 1.3687175770364277 AS `Estimator` UNION ALL SELECT 11 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 7 AS `parent_id`, 1.278877589279357 AS `Estimator` UNION ALL SELECT 12 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 6 AS `parent_id`, 1.1440564349145939 AS `Estimator` UNION ALL SELECT 13 AS `node_id`, 'Feature_2' AS `feature`, 0.9684208631515503 AS `threshold`, 4 AS `count`, 3 AS `depth`, 5 AS `parent_id`, 1.5149187213216642 AS `Estimator` UNION ALL SELECT 14 AS `node_id`, 'Feature_2' AS `feature`, 0.8579881191253662 AS `threshold`, 2 AS `count`, 4 AS `depth`, 13 AS `parent_id`, 1.5282757089243144 AS `Estimator` UNION ALL SELECT 15 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 14 AS `parent_id`, 1.521297715153797 AS `Estimator` UNION ALL SELECT 16 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 14 AS `parent_id`, 1.5352537026948319 AS `Estimator` UNION ALL SELECT 17 AS `node_id`, 'Feature_0' AS `feature`, 78.56736755371094 AS `threshold`, 2 AS `count`, 4 AS `depth`, 13 AS `parent_id`, 1.5015617337190137 AS `Estimator` UNION ALL SELECT 18 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 17 AS `parent_id`, 1.4932233184960249 AS `Estimator` UNION ALL SELECT 19 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 17 AS `parent_id`, 1.5099001489420028 AS `Estimator` UNION ALL SELECT 20 AS `node_id`, 'Feature_0' AS `feature`, 20.661970138549805 AS `threshold`, 9 AS `count`, 2 AS `depth`, 4 AS `parent_id`, 1.5301879733180512 AS `Estimator` UNION ALL SELECT 21 AS `node_id`, 'Feature_2' AS `feature`, 0.385817289352417 AS `threshold`, 5 AS `count`, 3 AS `depth`, 20 AS `parent_id`, 1.5555645109860312 AS `Estimator` UNION ALL SELECT 22 AS `node_id`, 'Feature_2' AS `feature`, 0.2778056263923645 AS `threshold`, 2 AS `count`, 4 AS `depth`, 21 AS `parent_id`, 1.5362151369713344 AS `Estimator` UNION ALL SELECT 23 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 22 AS `parent_id`, 1.536711230505171 AS `Estimator` UNION ALL SELECT 24 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 22 AS `parent_id`, 1.5359670902044162 AS `Estimator` UNION ALL SELECT 25 AS `node_id`, 'Feature_3' AS `feature`, 9.9036865234375 AS `threshold`, 3 AS `count`, 4 AS `depth`, 21 AS `parent_id`, 1.5671741353948494 AS `Estimator` UNION ALL SELECT 26 AS `node_id`, 'Feature_3' AS `feature`, 9.250843048095703 AS `threshold`, 2 AS `count`, 5 AS `depth`, 25 AS `parent_id`, 1.568884142601064 AS `Estimator` UNION ALL SELECT 27 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 26 AS `parent_id`, 1.5696790399866454 AS `Estimator` UNION ALL SELECT 28 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 26 AS `parent_id`, 1.5684866939082733 AS `Estimator` UNION ALL SELECT 29 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 25 AS `parent_id`, 1.5646091245855271 AS `Estimator` UNION ALL SELECT 30 AS `node_id`, 'Feature_2' AS `feature`, 0.5898985862731934 AS `threshold`, 4 AS `count`, 3 AS `depth`, 20 AS `parent_id`, 1.4895855130492834 AS `Estimator` UNION ALL SELECT 31 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 4 AS `depth`, 30 AS `parent_id`, 1.467648677980467 AS `Estimator` UNION ALL SELECT 32 AS `node_id`, 'Feature_2' AS `feature`, 0.7017911672592163 AS `threshold`, 3 AS `count`, 4 AS `depth`, 30 AS `parent_id`, 1.4950697218164875 AS `Estimator` UNION ALL SELECT 33 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 5 AS `depth`, 32 AS `parent_id`, 1.4872578515104244 AS `Estimator` UNION ALL SELECT 34 AS `node_id`, 'Feature_1' AS `feature`, 984.7573852539062 AS `threshold`, 2 AS `count`, 5 AS `depth`, 32 AS `parent_id`, 1.4976736785851752 AS `Estimator` UNION ALL SELECT 35 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 34 AS `parent_id`, 1.499027385598966 AS `Estimator` UNION ALL SELECT 36 AS `node_id`, CAST(NULL AS STRING) AS `feature`, CAST(NULL AS FLOAT) AS `threshold`, 1 AS `count`, 6 AS `depth`, 34 AS `parent_id`, 1.4949662645575934 AS `Estimator`) AS `Values`), 
`DT_Output_3` AS 
(SELECT `DT_node_lookup_3`.`KEY` AS `KEY`, `DT_node_lookup_3`.`node_id_2` AS `node_id_2`, `DT_node_data_3`.`node_id` AS `node_id`, `DT_node_data_3`.`feature` AS `feature`, `DT_node_data_3`.`threshold` AS `threshold`, `DT_node_data_3`.`count` AS `count`, `DT_node_data_3`.`depth` AS `depth`, `DT_node_data_3`.`parent_id` AS `parent_id`, `DT_node_data_3`.`Estimator` AS `Estimator` 
FROM `DT_node_lookup_3` LEFT OUTER JOIN `DT_node_data_3` ON `DT_node_lookup_3`.`node_id_2` = `DT_node_data_3`.`node_id`), 
`RF_Tree_3` AS 
(SELECT `DT_Output_3`.`KEY` AS `KEY`, `DT_Output_3`.`Estimator` AS `Estimator` 
FROM `DT_Output_3`), 
`Score_Union_CTE` AS 
(SELECT `ensemble_score_union`.`KEY` AS `KEY`, `ensemble_score_union`.`Estimator` AS `Estimator` 
FROM (SELECT `RF_Tree_0`.`KEY` AS `KEY`, `RF_Tree_0`.`Estimator` AS `Estimator` 
FROM `RF_Tree_0` UNION ALL SELECT `RF_Tree_1`.`KEY` AS `KEY`, `RF_Tree_1`.`Estimator` AS `Estimator` 
FROM `RF_Tree_1` UNION ALL SELECT `RF_Tree_2`.`KEY` AS `KEY`, `RF_Tree_2`.`Estimator` AS `Estimator` 
FROM `RF_Tree_2` UNION ALL SELECT `RF_Tree_3`.`KEY` AS `KEY`, `RF_Tree_3`.`Estimator` AS `Estimator` 
FROM `RF_Tree_3`) AS `ensemble_score_union`), 
`RF_AVG_Scores` AS 
(SELECT `T`.`KEY` AS `KEY`, `T`.`Estimator` AS `Estimator` 
FROM (SELECT `Score_Union_CTE`.`KEY` AS `KEY`, avg(`Score_Union_CTE`.`Estimator`) AS `Estimator` 
FROM `Score_Union_CTE` GROUP BY `Score_Union_CTE`.`KEY`) AS `T`)
 SELECT `RF_AVG_Scores`.`KEY` AS `KEY`, `RF_AVG_Scores`.`Estimator` AS `Estimator` 
FROM `RF_AVG_Scores`