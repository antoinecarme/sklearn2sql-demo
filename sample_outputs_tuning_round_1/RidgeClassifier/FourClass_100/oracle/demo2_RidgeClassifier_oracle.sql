-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2017

WITH linear_model_cte AS 
(SELECT "ADS"."KEY" AS "KEY", 0.00563028094525002 * "ADS"."Feature_0" + 0.0033727236880995467 * "ADS"."Feature_1" + -0.00021393147197966845 * "ADS"."Feature_2" + 0.030921649952087498 * "ADS"."Feature_3" + -0.010990200017580066 * "ADS"."Feature_4" + -0.0019066449262032726 * "ADS"."Feature_5" + -0.034601030021381665 * "ADS"."Feature_6" + -0.006282501230155131 * "ADS"."Feature_7" + 0.0057256294265776875 * "ADS"."Feature_8" + -0.018278843941273697 * "ADS"."Feature_9" + 0.010906305485658857 * "ADS"."Feature_10" + 0.02559370003577245 * "ADS"."Feature_11" + 0.006180246106730595 * "ADS"."Feature_12" + 0.00563721905185759 * "ADS"."Feature_13" + -0.005782415236759926 * "ADS"."Feature_14" + 0.047821543213495465 * "ADS"."Feature_15" + -0.007421260654849635 * "ADS"."Feature_16" + 0.03496418384495524 * "ADS"."Feature_17" + -0.02603171392506043 * "ADS"."Feature_18" + -0.004577058748842923 * "ADS"."Feature_19" + 0.010668665726463283 * "ADS"."Feature_20" + -0.006275171426424456 * "ADS"."Feature_21" + 0.0028902007543027373 * "ADS"."Feature_22" + -0.0003919745391793717 * "ADS"."Feature_23" + 0.02292760778051959 * "ADS"."Feature_24" + -0.003410383219183755 * "ADS"."Feature_25" + 0.02014079519889348 * "ADS"."Feature_26" + -0.002274639553200739 * "ADS"."Feature_27" + 0.0076199344861088494 * "ADS"."Feature_28" + 0.027422819578498243 * "ADS"."Feature_29" + 0.02821879557053107 * "ADS"."Feature_30" + 0.01630004873050272 * "ADS"."Feature_31" + -0.024069476137919956 * "ADS"."Feature_32" + -0.0053205350012870255 * "ADS"."Feature_33" + 0.015898062041104263 * "ADS"."Feature_34" + 0.009530610374349786 * "ADS"."Feature_35" + 0.01093597956061671 * "ADS"."Feature_36" + 0.008618907298511443 * "ADS"."Feature_37" + -0.0032520686373618385 * "ADS"."Feature_38" + -0.0026604710260810516 * "ADS"."Feature_39" + -0.006703975658365943 * "ADS"."Feature_40" + 0.018012053794480107 * "ADS"."Feature_41" + 0.01272770228757325 * "ADS"."Feature_42" + 0.0037872875295549627 * "ADS"."Feature_43" + 0.004254389728632588 * "ADS"."Feature_44" + -0.0029195755094754724 * "ADS"."Feature_45" + -0.012062510675165944 * "ADS"."Feature_46" + -0.002732755529032533 * "ADS"."Feature_47" + 0.011645630452030776 * "ADS"."Feature_48" + -0.00845699462537336 * "ADS"."Feature_49" + 0.0064439578867889775 * "ADS"."Feature_50" + 0.00866142626189049 * "ADS"."Feature_51" + 0.0029322775625044055 * "ADS"."Feature_52" + -0.007902940084128464 * "ADS"."Feature_53" + -0.006290886254439576 * "ADS"."Feature_54" + 0.003927183224662589 * "ADS"."Feature_55" + -0.028946303107399932 * "ADS"."Feature_56" + -0.009475314775531754 * "ADS"."Feature_57" + 0.0014386639304567808 * "ADS"."Feature_58" + -0.027114781014923085 * "ADS"."Feature_59" + 0.0018284600884055425 * "ADS"."Feature_60" + 0.0032030845353759677 * "ADS"."Feature_61" + 0.007753640058070386 * "ADS"."Feature_62" + 0.006802086632449043 * "ADS"."Feature_63" + 0.0021992532714298447 * "ADS"."Feature_64" + 0.007936378899781361 * "ADS"."Feature_65" + -0.0112856768375649 * "ADS"."Feature_66" + 0.012276795243229341 * "ADS"."Feature_67" + -0.021345138862979573 * "ADS"."Feature_68" + -0.012383507563705425 * "ADS"."Feature_69" + -0.011970569080326027 * "ADS"."Feature_70" + -0.010943012332094194 * "ADS"."Feature_71" + -0.028447456551269568 * "ADS"."Feature_72" + -0.0003750802289516661 * "ADS"."Feature_73" + -0.010737215243966562 * "ADS"."Feature_74" + 0.002146332831623714 * "ADS"."Feature_75" + 0.02821167566782425 * "ADS"."Feature_76" + 0.0021515006910917825 * "ADS"."Feature_77" + 0.007949272446580509 * "ADS"."Feature_78" + 0.01455859925693137 * "ADS"."Feature_79" + -0.005343487553395726 * "ADS"."Feature_80" + -0.0021921547606302506 * "ADS"."Feature_81" + -0.0023802252679433443 * "ADS"."Feature_82" + 0.0007408988683743447 * "ADS"."Feature_83" + -0.025997390072325717 * "ADS"."Feature_84" + -0.025424243392313906 * "ADS"."Feature_85" + 0.010007988176834728 * "ADS"."Feature_86" + -0.01454388948530205 * "ADS"."Feature_87" + -0.002318615616848883 * "ADS"."Feature_88" + 0.01980271857161885 * "ADS"."Feature_89" + -0.0197143737577877 * "ADS"."Feature_90" + -0.007297811772480857 * "ADS"."Feature_91" + -0.03315835323999548 * "ADS"."Feature_92" + -0.00366248350774226 * "ADS"."Feature_93" + 0.0007687752027117773 * "ADS"."Feature_94" + 0.0050633600888664474 * "ADS"."Feature_95" + 0.004608905537617184 * "ADS"."Feature_96" + 0.009648700160028306 * "ADS"."Feature_97" + -0.03339045202016572 * "ADS"."Feature_98" + 0.002906244967715402 * "ADS"."Feature_99" + -0.628596215397 AS "Score_0", -0.009222356280888501 * "ADS"."Feature_0" + -0.010914607101575782 * "ADS"."Feature_1" + -0.013747371836817632 * "ADS"."Feature_2" + 0.0018224811745519171 * "ADS"."Feature_3" + -0.0022483757236255275 * "ADS"."Feature_4" + -0.004117415801729974 * "ADS"."Feature_5" + 0.03360104346513098 * "ADS"."Feature_6" + -0.008582208876481062 * "ADS"."Feature_7" + -0.003449033424531831 * "ADS"."Feature_8" + 0.008904677702412964 * "ADS"."Feature_9" + -0.062295691146039806 * "ADS"."Feature_10" + -0.010326809958105502 * "ADS"."Feature_11" + -0.001341252411257273 * "ADS"."Feature_12" + -0.010271427983897836 * "ADS"."Feature_13" + -0.00052778563933606 * "ADS"."Feature_14" + -0.02067111149107065 * "ADS"."Feature_15" + 0.0035857904840234226 * "ADS"."Feature_16" + -0.012152543382290321 * "ADS"."Feature_17" + 0.00255073876256109 * "ADS"."Feature_18" + -0.003733054052389088 * "ADS"."Feature_19" + -0.03457997539207884 * "ADS"."Feature_20" + 0.02926744065058505 * "ADS"."Feature_21" + 0.0032798146850771424 * "ADS"."Feature_22" + -0.02099319783577611 * "ADS"."Feature_23" + -0.007497417652064251 * "ADS"."Feature_24" + 0.007167767052046854 * "ADS"."Feature_25" + -0.005559090075422858 * "ADS"."Feature_26" + 0.00874257944474111 * "ADS"."Feature_27" + 0.008366918256227226 * "ADS"."Feature_28" + -0.04571748441336352 * "ADS"."Feature_29" + -0.013715285331934512 * "ADS"."Feature_30" + -0.01699234516171087 * "ADS"."Feature_31" + 0.01694839918243973 * "ADS"."Feature_32" + 0.0357103829373074 * "ADS"."Feature_33" + -0.011965035295508533 * "ADS"."Feature_34" + -0.007991961999441834 * "ADS"."Feature_35" + -0.008881207296916029 * "ADS"."Feature_36" + -0.02026230069704541 * "ADS"."Feature_37" + -0.0012986713849595778 * "ADS"."Feature_38" + -0.0015830599905727592 * "ADS"."Feature_39" + 0.004227564585589069 * "ADS"."Feature_40" + -0.003169428580904337 * "ADS"."Feature_41" + -0.015236401650785969 * "ADS"."Feature_42" + 0.027717354605230424 * "ADS"."Feature_43" + -0.003791006088300737 * "ADS"."Feature_44" + 0.034067300927356596 * "ADS"."Feature_45" + 0.0017516887918952312 * "ADS"."Feature_46" + 0.00801791323566109 * "ADS"."Feature_47" + 0.016476840112431602 * "ADS"."Feature_48" + 0.004913477281279525 * "ADS"."Feature_49" + -0.018040192314027176 * "ADS"."Feature_50" + -0.0012988599082473416 * "ADS"."Feature_51" + 0.017196412553892433 * "ADS"."Feature_52" + 0.004448038619461235 * "ADS"."Feature_53" + 0.008854830609909952 * "ADS"."Feature_54" + -0.006262987391356982 * "ADS"."Feature_55" + 0.04463980886830763 * "ADS"."Feature_56" + 0.01633539792828505 * "ADS"."Feature_57" + 0.0048574629826437015 * "ADS"."Feature_58" + 0.0158560811524718 * "ADS"."Feature_59" + -0.006457478426466849 * "ADS"."Feature_60" + -0.007371563535201055 * "ADS"."Feature_61" + -0.001224080236231287 * "ADS"."Feature_62" + -0.0027429905627482424 * "ADS"."Feature_63" + -0.01136127860220586 * "ADS"."Feature_64" + -0.009021412086816602 * "ADS"."Feature_65" + 0.005998166576162599 * "ADS"."Feature_66" + 0.0068996080682556925 * "ADS"."Feature_67" + 0.04557587842019608 * "ADS"."Feature_68" + -0.028957544616258046 * "ADS"."Feature_69" + -0.007539353985347086 * "ADS"."Feature_70" + 0.02936024292155348 * "ADS"."Feature_71" + 0.02014080828371541 * "ADS"."Feature_72" + -0.021256280843179515 * "ADS"."Feature_73" + 0.008460791244871363 * "ADS"."Feature_74" + 0.0036777405269716287 * "ADS"."Feature_75" + -0.05251515510654493 * "ADS"."Feature_76" + -0.008129168070159114 * "ADS"."Feature_77" + 0.024073160587983096 * "ADS"."Feature_78" + -0.006364795719976019 * "ADS"."Feature_79" + -0.006548077419421167 * "ADS"."Feature_80" + -0.008168125768026382 * "ADS"."Feature_81" + 0.014346832702083288 * "ADS"."Feature_82" + 0.0010969674895255407 * "ADS"."Feature_83" + 0.03210501181192101 * "ADS"."Feature_84" + 0.05769706633073896 * "ADS"."Feature_85" + 0.016469901120031903 * "ADS"."Feature_86" + -0.0005126844265984751 * "ADS"."Feature_87" + -0.011250093780948156 * "ADS"."Feature_88" + -0.0020736397412734428 * "ADS"."Feature_89" + 0.02637869019738678 * "ADS"."Feature_90" + -0.01576601211172713 * "ADS"."Feature_91" + 0.03577418678452588 * "ADS"."Feature_92" + 0.013345891650720833 * "ADS"."Feature_93" + 0.03575695230662454 * "ADS"."Feature_94" + 0.010339877786543248 * "ADS"."Feature_95" + 0.016122704010923087 * "ADS"."Feature_96" + -0.0036563138529405455 * "ADS"."Feature_97" + -0.023755251600287918 * "ADS"."Feature_98" + -0.05063940759848066 * "ADS"."Feature_99" + -0.459517046113 AS "Score_1", 0.006457547994360836 * "ADS"."Feature_0" + 0.007434148524936233 * "ADS"."Feature_1" + 0.014609550077023387 * "ADS"."Feature_2" + -0.023420652318971013 * "ADS"."Feature_3" + -0.01030132989675992 * "ADS"."Feature_4" + 0.0012025895271026823 * "ADS"."Feature_5" + 0.007233351887342105 * "ADS"."Feature_6" + 0.015981047229309948 * "ADS"."Feature_7" + 0.0011901944673961813 * "ADS"."Feature_8" + 0.004418772825366849 * "ADS"."Feature_9" + 0.036543438746238624 * "ADS"."Feature_10" + 0.0024891577996115936 * "ADS"."Feature_11" + -0.013827047863815178 * "ADS"."Feature_12" + 0.003592911692352684 * "ADS"."Feature_13" + 0.008344994572257963 * "ADS"."Feature_14" + 0.0153180625386016 * "ADS"."Feature_15" + 0.0020673988671780826 * "ADS"."Feature_16" + -0.021167157250438915 * "ADS"."Feature_17" + 0.023696636002444076 * "ADS"."Feature_18" + 0.006958195289484041 * "ADS"."Feature_19" + -0.011790925073407392 * "ADS"."Feature_20" + -0.014984946546375773 * "ADS"."Feature_21" + 0.005345288403592937 * "ADS"."Feature_22" + 0.018374509335174097 * "ADS"."Feature_23" + 6.300174235293176e-05 * "ADS"."Feature_24" + -0.0035988083171779556 * "ADS"."Feature_25" + 0.0013816817326096284 * "ADS"."Feature_26" + 0.00902786929174961 * "ADS"."Feature_27" + 0.004372876654611517 * "ADS"."Feature_28" + 0.05174570433759932 * "ADS"."Feature_29" + 0.0003445416284752808 * "ADS"."Feature_30" + 0.0014315117791165004 * "ADS"."Feature_31" + 0.04024349667476836 * "ADS"."Feature_32" + 0.005967201692486662 * "ADS"."Feature_33" + -0.006362394479592514 * "ADS"."Feature_34" + 0.00108437281795817 * "ADS"."Feature_35" + -0.0023870869367044367 * "ADS"."Feature_36" + 0.018625259358067758 * "ADS"."Feature_37" + 0.0071764442430844195 * "ADS"."Feature_38" + 0.016978395007013477 * "ADS"."Feature_39" + 0.006271670329805163 * "ADS"."Feature_40" + -0.0018231990197366595 * "ADS"."Feature_41" + -0.00010179150619492186 * "ADS"."Feature_42" + -0.02402659609706189 * "ADS"."Feature_43" + 0.001797910645206432 * "ADS"."Feature_44" + -0.009439826710595848 * "ADS"."Feature_45" + -0.012067240304558881 * "ADS"."Feature_46" + 0.00851506390708641 * "ADS"."Feature_47" + 0.022030909884294705 * "ADS"."Feature_48" + 0.0343277181733014 * "ADS"."Feature_49" + 0.0183081011547159 * "ADS"."Feature_50" + -0.008473283029447042 * "ADS"."Feature_51" + -0.04985658492102531 * "ADS"."Feature_52" + 0.0035041096826581896 * "ADS"."Feature_53" + -0.016063846757149024 * "ADS"."Feature_54" + -0.009391418117974004 * "ADS"."Feature_55" + -0.03241632576840605 * "ADS"."Feature_56" + -0.01406859969439662 * "ADS"."Feature_57" + -0.008633167818478374 * "ADS"."Feature_58" + -0.0036195119609941494 * "ADS"."Feature_59" + 0.0029319432185317892 * "ADS"."Feature_60" + -0.002852566762996761 * "ADS"."Feature_61" + -0.014810742420506007 * "ADS"."Feature_62" + -0.005665144698409192 * "ADS"."Feature_63" + 0.012707385748556194 * "ADS"."Feature_64" + 0.011142088260426071 * "ADS"."Feature_65" + -0.0036594708599747934 * "ADS"."Feature_66" + -0.003601518584498302 * "ADS"."Feature_67" + -0.04453132779036112 * "ADS"."Feature_68" + 0.029774880954156403 * "ADS"."Feature_69" + -0.0037311878083478613 * "ADS"."Feature_70" + -0.02763237044566535 * "ADS"."Feature_71" + 0.004256855985513928 * "ADS"."Feature_72" + 0.002243073227667892 * "ADS"."Feature_73" + 0.0022407450658147943 * "ADS"."Feature_74" + -0.009996746441138259 * "ADS"."Feature_75" + 0.017415833973865792 * "ADS"."Feature_76" + 0.0023449568167530567 * "ADS"."Feature_77" + -0.027015539452471114 * "ADS"."Feature_78" + -0.012923449261111445 * "ADS"."Feature_79" + -0.010854038216283286 * "ADS"."Feature_80" + 0.006997491157318157 * "ADS"."Feature_81" + -0.014965826001200892 * "ADS"."Feature_82" + 0.015621317047228815 * "ADS"."Feature_83" + -0.05418078056643572 * "ADS"."Feature_84" + -0.04157750118608068 * "ADS"."Feature_85" + -0.03544586268379115 * "ADS"."Feature_86" + -0.003313804853478614 * "ADS"."Feature_87" + 0.012958737242828866 * "ADS"."Feature_88" + 0.00017360895219192037 * "ADS"."Feature_89" + -0.0030207002351622467 * "ADS"."Feature_90" + 0.028393161047347446 * "ADS"."Feature_91" + -0.025008469829169794 * "ADS"."Feature_92" + -0.013949072445189371 * "ADS"."Feature_93" + -0.010812546802679268 * "ADS"."Feature_94" + -0.019250132105362992 * "ADS"."Feature_95" + -0.009740614925016844 * "ADS"."Feature_96" + 0.003538026030512171 * "ADS"."Feature_97" + 0.05125888797831094 * "ADS"."Feature_98" + 0.03864482035303291 * "ADS"."Feature_99" + -0.53329004081 AS "Score_2", -0.0028654726587223523 * "ADS"."Feature_0" + 0.00010773488854000642 * "ADS"."Feature_1" + -0.0006482467682260944 * "ADS"."Feature_2" + -0.00932347880766836 * "ADS"."Feature_3" + 0.02353990563796549 * "ADS"."Feature_4" + 0.004821471200830563 * "ADS"."Feature_5" + -0.006233365331091438 * "ADS"."Feature_6" + -0.0011163371226737674 * "ADS"."Feature_7" + -0.0034667904694420356 * "ADS"."Feature_8" + 0.004955393413493863 * "ADS"."Feature_9" + 0.01484594691414234 * "ADS"."Feature_10" + -0.017756047877278563 * "ADS"."Feature_11" + 0.00898805416834186 * "ADS"."Feature_12" + 0.0010412972396875635 * "ADS"."Feature_13" + -0.0020347936961619914 * "ADS"."Feature_14" + -0.04246849426102639 * "ADS"."Feature_15" + 0.0017680713036481218 * "ADS"."Feature_16" + -0.0016444832122259833 * "ADS"."Feature_17" + -0.00021566083994471275 * "ADS"."Feature_18" + 0.001351917511747967 * "ADS"."Feature_19" + 0.03570223473902295 * "ADS"."Feature_20" + -0.008007322677784832 * "ADS"."Feature_21" + -0.011515303842972818 * "ADS"."Feature_22" + 0.0030106630397813785 * "ADS"."Feature_23" + -0.015493191870808264 * "ADS"."Feature_24" + -0.00015857551568514687 * "ADS"."Feature_25" + -0.015963386856080255 * "ADS"."Feature_26" + -0.015495809183289985 * "ADS"."Feature_27" + -0.02035972939694758 * "ADS"."Feature_28" + -0.033451039502734016 * "ADS"."Feature_29" + -0.014848051867071825 * "ADS"."Feature_30" + -0.0007392153479083099 * "ADS"."Feature_31" + -0.03312241971928814 * "ADS"."Feature_32" + -0.03635704962850703 * "ADS"."Feature_33" + 0.002429367733996801 * "ADS"."Feature_34" + -0.0026230211928661216 * "ADS"."Feature_35" + 0.00033231467300376893 * "ADS"."Feature_36" + -0.006981865959533783 * "ADS"."Feature_37" + -0.0026257042207629942 * "ADS"."Feature_38" + -0.012734863990359672 * "ADS"."Feature_39" + -0.003795259257028303 * "ADS"."Feature_40" + -0.013019426193839109 * "ADS"."Feature_41" + 0.002610490869407645 * "ADS"."Feature_42" + -0.00747804603772352 * "ADS"."Feature_43" + -0.0022612942855382775 * "ADS"."Feature_44" + -0.02170789870728525 * "ADS"."Feature_45" + 0.02237806218782959 * "ADS"."Feature_46" + -0.01380022161371498 * "ADS"."Feature_47" + -0.050153380448757126 * "ADS"."Feature_48" + -0.030784200829207582 * "ADS"."Feature_49" + -0.006711866727477729 * "ADS"."Feature_50" + 0.001110716675803908 * "ADS"."Feature_51" + 0.029727894804628483 * "ADS"."Feature_52" + -4.9208217990965686e-05 * "ADS"."Feature_53" + 0.013499902401678645 * "ADS"."Feature_54" + 0.011727222284668399 * "ADS"."Feature_55" + 0.016722820007498345 * "ADS"."Feature_56" + 0.007208516541643327 * "ADS"."Feature_57" + 0.002337040905377885 * "ADS"."Feature_58" + 0.014878211823445404 * "ADS"."Feature_59" + 0.0016970751195295177 * "ADS"."Feature_60" + 0.007021045762821852 * "ADS"."Feature_61" + 0.0082811825986669 * "ADS"."Feature_62" + 0.0016060486287083954 * "ADS"."Feature_63" + -0.003545360417780171 * "ADS"."Feature_64" + -0.010057055073390829 * "ADS"."Feature_65" + 0.008946981121377096 * "ADS"."Feature_66" + -0.015574884726986708 * "ADS"."Feature_67" + 0.020300588233144592 * "ADS"."Feature_68" + 0.011566171225807062 * "ADS"."Feature_69" + 0.02324111087402096 * "ADS"."Feature_70" + 0.009215139856206075 * "ADS"."Feature_71" + 0.004049792282040194 * "ADS"."Feature_72" + 0.019388287844463288 * "ADS"."Feature_73" + 3.5678933280402456e-05 * "ADS"."Feature_74" + 0.004172673082542915 * "ADS"."Feature_75" + 0.006887645464854927 * "ADS"."Feature_76" + 0.0036327105623142762 * "ADS"."Feature_77" + -0.00500689358209246 * "ADS"."Feature_78" + 0.004729645724156099 * "ADS"."Feature_79" + 0.02274560318910019 * "ADS"."Feature_80" + 0.003362789371338476 * "ADS"."Feature_81" + 0.0029992185670609465 * "ADS"."Feature_82" + -0.017459183405128732 * "ADS"."Feature_83" + 0.04807315882684044 * "ADS"."Feature_84" + 0.00930467824765562 * "ADS"."Feature_85" + 0.00896797338692453 * "ADS"."Feature_86" + 0.01837037876537914 * "ADS"."Feature_87" + 0.0006099721549681768 * "ADS"."Feature_88" + -0.017902687782537317 * "ADS"."Feature_89" + -0.0036436162044368404 * "ADS"."Feature_90" + -0.005329337163139478 * "ADS"."Feature_91" + 0.02239263628463938 * "ADS"."Feature_92" + 0.004265664302210801 * "ADS"."Feature_93" + -0.025713180706657054 * "ADS"."Feature_94" + 0.00384689422995331 * "ADS"."Feature_95" + -0.010990994623523424 * "ADS"."Feature_96" + -0.009530412337599938 * "ADS"."Feature_97" + 0.005886815642142668 * "ADS"."Feature_98" + 0.009088342277732324 * "ADS"."Feature_99" + -0.37859669768 AS "Score_3" 
FROM "FourClass_100" "ADS"), 
orig_cte AS 
(SELECT linear_model_cte."KEY" AS "KEY", linear_model_cte."Score_0" AS "Score_0", linear_model_cte."Score_1" AS "Score_1", linear_model_cte."Score_2" AS "Score_2", linear_model_cte."Score_3" AS "Score_3", CAST(NULL AS FLOAT) AS "Proba_0", CAST(NULL AS FLOAT) AS "Proba_1", CAST(NULL AS FLOAT) AS "Proba_2", CAST(NULL AS FLOAT) AS "Proba_3", CAST(NULL AS FLOAT) AS "LogProba_0", CAST(NULL AS FLOAT) AS "LogProba_1", CAST(NULL AS FLOAT) AS "LogProba_2", CAST(NULL AS FLOAT) AS "LogProba_3", CAST(NULL AS INTEGER) AS "Decision", CAST(NULL AS FLOAT) AS "DecisionProba" 
FROM linear_model_cte), 
score_class_union AS 
(SELECT scu."KEY_u" AS "KEY_u", scu.class AS class, scu."LogProba" AS "LogProba", scu."Proba" AS "Proba", scu."Score" AS "Score" 
FROM (SELECT orig_cte."KEY" AS "KEY_u", 0 AS class, orig_cte."LogProba_0" AS "LogProba", orig_cte."Proba_0" AS "Proba", orig_cte."Score_0" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 1 AS class, orig_cte."LogProba_1" AS "LogProba", orig_cte."Proba_1" AS "Proba", orig_cte."Score_1" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 2 AS class, orig_cte."LogProba_2" AS "LogProba", orig_cte."Proba_2" AS "Proba", orig_cte."Score_2" AS "Score" 
FROM orig_cte UNION ALL SELECT orig_cte."KEY" AS "KEY_u", 3 AS class, orig_cte."LogProba_3" AS "LogProba", orig_cte."Proba_3" AS "Proba", orig_cte."Score_3" AS "Score" 
FROM orig_cte) scu), 
score_max AS 
(SELECT orig_cte."KEY" AS "KEY", orig_cte."Score_0" AS "Score_0", orig_cte."Score_1" AS "Score_1", orig_cte."Score_2" AS "Score_2", orig_cte."Score_3" AS "Score_3", orig_cte."Proba_0" AS "Proba_0", orig_cte."Proba_1" AS "Proba_1", orig_cte."Proba_2" AS "Proba_2", orig_cte."Proba_3" AS "Proba_3", orig_cte."LogProba_0" AS "LogProba_0", orig_cte."LogProba_1" AS "LogProba_1", orig_cte."LogProba_2" AS "LogProba_2", orig_cte."LogProba_3" AS "LogProba_3", orig_cte."Decision" AS "Decision", orig_cte."DecisionProba" AS "DecisionProba", max_select."KEY_m" AS "KEY_m", max_select."max_Score" AS "max_Score" 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union."KEY_u" AS "KEY_m", max(score_class_union."Score") AS "max_Score" 
FROM score_class_union GROUP BY score_class_union."KEY_u") max_select ON orig_cte."KEY" = max_select."KEY_m"), 
union_with_max AS 
(SELECT score_class_union."KEY_u" AS "KEY_u", score_class_union.class AS class, score_class_union."LogProba" AS "LogProba", score_class_union."Proba" AS "Proba", score_class_union."Score" AS "Score", score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Score" AS "max_Score" 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union."KEY_u" = score_max."KEY"), 
arg_max_cte AS 
(SELECT score_max."KEY" AS "KEY", score_max."Score_0" AS "Score_0", score_max."Score_1" AS "Score_1", score_max."Score_2" AS "Score_2", score_max."Score_3" AS "Score_3", score_max."Proba_0" AS "Proba_0", score_max."Proba_1" AS "Proba_1", score_max."Proba_2" AS "Proba_2", score_max."Proba_3" AS "Proba_3", score_max."LogProba_0" AS "LogProba_0", score_max."LogProba_1" AS "LogProba_1", score_max."LogProba_2" AS "LogProba_2", score_max."LogProba_3" AS "LogProba_3", score_max."Decision" AS "Decision", score_max."DecisionProba" AS "DecisionProba", score_max."KEY_m" AS "KEY_m", score_max."max_Score" AS "max_Score", "arg_max_t_Score"."KEY_Score" AS "KEY_Score", "arg_max_t_Score"."arg_max_Score" AS "arg_max_Score" 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max."KEY" AS "KEY_Score", min(union_with_max.class) AS "arg_max_Score" 
FROM union_with_max 
WHERE union_with_max."max_Score" <= union_with_max."Score" GROUP BY union_with_max."KEY") "arg_max_t_Score" ON score_max."KEY" = "arg_max_t_Score"."KEY_Score")
 SELECT arg_max_cte."KEY" AS "KEY", arg_max_cte."Score_0" AS "Score_0", arg_max_cte."Score_1" AS "Score_1", arg_max_cte."Score_2" AS "Score_2", arg_max_cte."Score_3" AS "Score_3", arg_max_cte."Proba_0" AS "Proba_0", arg_max_cte."Proba_1" AS "Proba_1", arg_max_cte."Proba_2" AS "Proba_2", arg_max_cte."Proba_3" AS "Proba_3", CASE WHEN (arg_max_cte."Proba_0" IS NULL OR arg_max_cte."Proba_0" > 0.0) THEN ln(arg_max_cte."Proba_0") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_0", CASE WHEN (arg_max_cte."Proba_1" IS NULL OR arg_max_cte."Proba_1" > 0.0) THEN ln(arg_max_cte."Proba_1") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_1", CASE WHEN (arg_max_cte."Proba_2" IS NULL OR arg_max_cte."Proba_2" > 0.0) THEN ln(arg_max_cte."Proba_2") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_2", CASE WHEN (arg_max_cte."Proba_3" IS NULL OR arg_max_cte."Proba_3" > 0.0) THEN ln(arg_max_cte."Proba_3") ELSE -BINARY_FLOAT_INFINITY END AS "LogProba_3", arg_max_cte."arg_max_Score" AS "Decision", CASE WHEN (arg_max_cte."arg_max_Score" = 0) THEN arg_max_cte."Proba_0" WHEN (arg_max_cte."arg_max_Score" = 1) THEN arg_max_cte."Proba_1" WHEN (arg_max_cte."arg_max_Score" = 2) THEN arg_max_cte."Proba_2" WHEN (arg_max_cte."arg_max_Score" = 3) THEN arg_max_cte."Proba_3" END AS "DecisionProba" 
FROM arg_max_cte