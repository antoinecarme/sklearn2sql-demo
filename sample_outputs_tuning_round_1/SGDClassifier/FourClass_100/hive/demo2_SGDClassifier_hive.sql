-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2017

WITH `linear_model_cte` AS 
(SELECT `ADS`.`KEY` AS `KEY`, 34.58718821866331 * `ADS`.`Feature_0` + 21.78433996884325 * `ADS`.`Feature_1` + -0.8168724153025347 * `ADS`.`Feature_2` + 107.79100816868831 * `ADS`.`Feature_3` + -99.15712037690221 * `ADS`.`Feature_4` + -8.61093079365812 * `ADS`.`Feature_5` + -60.92182579532552 * `ADS`.`Feature_6` + -63.36889578374258 * `ADS`.`Feature_7` + -18.481118020502265 * `ADS`.`Feature_8` + 0.17489317693563308 * `ADS`.`Feature_9` + -156.0560709306892 * `ADS`.`Feature_10` + -50.52835412753188 * `ADS`.`Feature_11` + -20.640434077509937 * `ADS`.`Feature_12` + -30.575725123465514 * `ADS`.`Feature_13` + -27.478626013283133 * `ADS`.`Feature_14` + 308.02693785650735 * `ADS`.`Feature_15` + -43.12196450105778 * `ADS`.`Feature_16` + -110.87669032642867 * `ADS`.`Feature_17` + -44.048404404344325 * `ADS`.`Feature_18` + -44.818322477118954 * `ADS`.`Feature_19` + -43.07974513463156 * `ADS`.`Feature_20` + 74.93757736084291 * `ADS`.`Feature_21` + 21.547605643034075 * `ADS`.`Feature_22` + 11.089512335781837 * `ADS`.`Feature_23` + -40.0260599576233 * `ADS`.`Feature_24` + -13.146543253511147 * `ADS`.`Feature_25` + 18.277719125695274 * `ADS`.`Feature_26` + 36.49722513052143 * `ADS`.`Feature_27` + 24.16620323955278 * `ADS`.`Feature_28` + -113.99970713151792 * `ADS`.`Feature_29` + 289.91819401866525 * `ADS`.`Feature_30` + -58.16417296031937 * `ADS`.`Feature_31` + -63.79331922241026 * `ADS`.`Feature_32` + 98.66957395336202 * `ADS`.`Feature_33` + 174.52518270866895 * `ADS`.`Feature_34` + 8.247368178919237 * `ADS`.`Feature_35` + 5.464806439269897 * `ADS`.`Feature_36` + -14.254116165713931 * `ADS`.`Feature_37` + 47.189523668656 * `ADS`.`Feature_38` + 31.00565837280887 * `ADS`.`Feature_39` + -20.997470532947926 * `ADS`.`Feature_40` + -38.04274934361459 * `ADS`.`Feature_41` + -6.8351206411671175 * `ADS`.`Feature_42` + 56.710204978887525 * `ADS`.`Feature_43` + 51.97517127189877 * `ADS`.`Feature_44` + 44.917514544204664 * `ADS`.`Feature_45` + -25.17054199820843 * `ADS`.`Feature_46` + 3.4510077209901047 * `ADS`.`Feature_47` + 62.63738725424175 * `ADS`.`Feature_48` + 123.62244305536194 * `ADS`.`Feature_49` + -45.24198173673038 * `ADS`.`Feature_50` + 23.333860004606795 * `ADS`.`Feature_51` + 74.28657312175726 * `ADS`.`Feature_52` + -12.773887175899509 * `ADS`.`Feature_53` + 34.2974787318344 * `ADS`.`Feature_54` + 1.5534445807972401 * `ADS`.`Feature_55` + 95.22611997464348 * `ADS`.`Feature_56` + 4.996418288603141 * `ADS`.`Feature_57` + -34.06789265001938 * `ADS`.`Feature_58` + -186.65961009550566 * `ADS`.`Feature_59` + -27.567930691474462 * `ADS`.`Feature_60` + -73.32536862145727 * `ADS`.`Feature_61` + 194.75982153615848 * `ADS`.`Feature_62` + -0.7913075588628857 * `ADS`.`Feature_63` + 40.17347246077063 * `ADS`.`Feature_64` + 12.177226507588387 * `ADS`.`Feature_65` + -46.08166948448416 * `ADS`.`Feature_66` + 144.32603007701917 * `ADS`.`Feature_67` + -62.3673833172079 * `ADS`.`Feature_68` + 16.16603886333027 * `ADS`.`Feature_69` + -60.34643013652767 * `ADS`.`Feature_70` + -97.76247846208786 * `ADS`.`Feature_71` + -226.4637717011089 * `ADS`.`Feature_72` + -62.842944560141525 * `ADS`.`Feature_73` + -137.6486137435838 * `ADS`.`Feature_74` + 5.9283080086884645 * `ADS`.`Feature_75` + -0.6632226299769469 * `ADS`.`Feature_76` + 10.229146654263136 * `ADS`.`Feature_77` + 81.16459989021752 * `ADS`.`Feature_78` + 161.27283612934036 * `ADS`.`Feature_79` + -85.58008141043882 * `ADS`.`Feature_80` + -32.24621109533338 * `ADS`.`Feature_81` + 3.4681038378626226 * `ADS`.`Feature_82` + -185.7863649015121 * `ADS`.`Feature_83` + -177.18491744283207 * `ADS`.`Feature_84` + -51.92827600803549 * `ADS`.`Feature_85` + 40.34251153001161 * `ADS`.`Feature_86` + -37.006856886342995 * `ADS`.`Feature_87` + -15.967448046636997 * `ADS`.`Feature_88` + 62.98372195200049 * `ADS`.`Feature_89` + -165.7651189664371 * `ADS`.`Feature_90` + -28.05288759884689 * `ADS`.`Feature_91` + -158.85874504377006 * `ADS`.`Feature_92` + -49.113383625127646 * `ADS`.`Feature_93` + 106.548795248448 * `ADS`.`Feature_94` + 110.10465631002715 * `ADS`.`Feature_95` + 45.44211458842224 * `ADS`.`Feature_96` + 29.33490753559745 * `ADS`.`Feature_97` + -211.21972448086663 * `ADS`.`Feature_98` + 170.13406570226786 * `ADS`.`Feature_99` + -98.7394282247 AS `Score_0`, -7.693011663313862 * `ADS`.`Feature_0` + -36.20292619625962 * `ADS`.`Feature_1` + -62.49154900992069 * `ADS`.`Feature_2` + -125.57309273680833 * `ADS`.`Feature_3` + -198.99232258625415 * `ADS`.`Feature_4` + -23.82913745516103 * `ADS`.`Feature_5` + 205.21626011785142 * `ADS`.`Feature_6` + -86.5378905893136 * `ADS`.`Feature_7` + -53.20287765398628 * `ADS`.`Feature_8` + 28.68334819007594 * `ADS`.`Feature_9` + -552.4311518275664 * `ADS`.`Feature_10` + -42.97722980960405 * `ADS`.`Feature_11` + -29.36818869086608 * `ADS`.`Feature_12` + -57.5528361081704 * `ADS`.`Feature_13` + 21.907117428980754 * `ADS`.`Feature_14` + -37.201250849606105 * `ADS`.`Feature_15` + 11.777755119082654 * `ADS`.`Feature_16` + -253.21765698002642 * `ADS`.`Feature_17` + 15.787514475093023 * `ADS`.`Feature_18` + -14.405595356548776 * `ADS`.`Feature_19` + -280.3212249407356 * `ADS`.`Feature_20` + 383.1053664661475 * `ADS`.`Feature_21` + 69.11433321535483 * `ADS`.`Feature_22` + -108.5002904334718 * `ADS`.`Feature_23` + -138.31354702929414 * `ADS`.`Feature_24` + 21.83020084026818 * `ADS`.`Feature_25` + -13.281717895012745 * `ADS`.`Feature_26` + 103.84361351523457 * `ADS`.`Feature_27` + 262.1547021303219 * `ADS`.`Feature_28` + -227.09289316599566 * `ADS`.`Feature_29` + 37.39940935623956 * `ADS`.`Feature_30` + -100.06271702508553 * `ADS`.`Feature_31` + 5.923574938974721 * `ADS`.`Feature_32` + 334.30518017644846 * `ADS`.`Feature_33` + -114.38252875864737 * `ADS`.`Feature_34` + -14.777238221071556 * `ADS`.`Feature_35` + -90.91137833423258 * `ADS`.`Feature_36` + -83.94011546289262 * `ADS`.`Feature_37` + 20.558339007971913 * `ADS`.`Feature_38` + 20.324532360287286 * `ADS`.`Feature_39` + -24.22319529821681 * `ADS`.`Feature_40` + -156.13232957948608 * `ADS`.`Feature_41` + -115.89041576234965 * `ADS`.`Feature_42` + 42.66936591140184 * `ADS`.`Feature_43` + -31.870630517360166 * `ADS`.`Feature_44` + 180.77612173434645 * `ADS`.`Feature_45` + -36.35598390740233 * `ADS`.`Feature_46` + 73.46932759252043 * `ADS`.`Feature_47` + 126.77179468305735 * `ADS`.`Feature_48` + 19.247131909395257 * `ADS`.`Feature_49` + -87.66068113027714 * `ADS`.`Feature_50` + 3.029618345580898 * `ADS`.`Feature_51` + 129.04563542519506 * `ADS`.`Feature_52` + -0.18018190935522527 * `ADS`.`Feature_53` + 26.415643838789293 * `ADS`.`Feature_54` + 7.357855917157044 * `ADS`.`Feature_55` + 489.4078879471511 * `ADS`.`Feature_56` + 88.09084456149475 * `ADS`.`Feature_57` + -15.401680501692521 * `ADS`.`Feature_58` + -2.8463107056950476 * `ADS`.`Feature_59` + 63.394915559705765 * `ADS`.`Feature_60` + -95.55268364986847 * `ADS`.`Feature_61` + 47.77789109951819 * `ADS`.`Feature_62` + -12.910764225414262 * `ADS`.`Feature_63` + -11.392899674829843 * `ADS`.`Feature_64` + -10.7051885269254 * `ADS`.`Feature_65` + -25.76251684367267 * `ADS`.`Feature_66` + 231.93761504020407 * `ADS`.`Feature_67` + 187.4203876771279 * `ADS`.`Feature_68` + -231.16872910522628 * `ADS`.`Feature_69` + -104.31785914465452 * `ADS`.`Feature_70` + 286.82871026192885 * `ADS`.`Feature_71` + 22.451826099754054 * `ADS`.`Feature_72` + 13.803370282266522 * `ADS`.`Feature_73` + 99.76205208921061 * `ADS`.`Feature_74` + -7.59871195391037 * `ADS`.`Feature_75` + -236.0714678102114 * `ADS`.`Feature_76` + -76.32562838168356 * `ADS`.`Feature_77` + 214.66225699664557 * `ADS`.`Feature_78` + -30.584872291903537 * `ADS`.`Feature_79` + -126.85941701852668 * `ADS`.`Feature_80` + -92.29762700776297 * `ADS`.`Feature_81` + 58.81016192359287 * `ADS`.`Feature_82` + -27.725546842797336 * `ADS`.`Feature_83` + -20.712236582088906 * `ADS`.`Feature_84` + 409.1046627637874 * `ADS`.`Feature_85` + 73.45220812427148 * `ADS`.`Feature_86` + -1.7531622156260058 * `ADS`.`Feature_87` + -20.828424408017096 * `ADS`.`Feature_88` + 46.58026046002133 * `ADS`.`Feature_89` + -4.084927720002403 * `ADS`.`Feature_90` + -64.1111515651139 * `ADS`.`Feature_91` + 105.9273240821634 * `ADS`.`Feature_92` + -1.6469520953650028 * `ADS`.`Feature_93` + 87.57406773836723 * `ADS`.`Feature_94` + 106.53688460425454 * `ADS`.`Feature_95` + 85.1000212818032 * `ADS`.`Feature_96` + -23.49494274264392 * `ADS`.`Feature_97` + -187.26602077619242 * `ADS`.`Feature_98` + -141.6043303613009 * `ADS`.`Feature_99` + -88.6632825574 AS `Score_1`, -0.2127455959959683 * `ADS`.`Feature_0` + 62.34884903406711 * `ADS`.`Feature_1` + 31.073134890250603 * `ADS`.`Feature_2` + -87.63941028067133 * `ADS`.`Feature_3` + -147.59675605603258 * `ADS`.`Feature_4` + -5.414277020299381 * `ADS`.`Feature_5` + 231.54337470586867 * `ADS`.`Feature_6` + 90.60812862181709 * `ADS`.`Feature_7` + 7.689114111201766 * `ADS`.`Feature_8` + 29.885900269861896 * `ADS`.`Feature_9` + 122.37324477578083 * `ADS`.`Feature_10` + 14.300159461084776 * `ADS`.`Feature_11` + -21.99988852876595 * `ADS`.`Feature_12` + -60.22937658251093 * `ADS`.`Feature_13` + 36.84847942170512 * `ADS`.`Feature_14` + 98.5912591706281 * `ADS`.`Feature_15` + 36.85329377759055 * `ADS`.`Feature_16` + -262.7838674358195 * `ADS`.`Feature_17` + 50.73784250790769 * `ADS`.`Feature_18` + 34.32861679431072 * `ADS`.`Feature_19` + -39.47870148236363 * `ADS`.`Feature_20` + 23.704898491684805 * `ADS`.`Feature_21` + 48.22782255972447 * `ADS`.`Feature_22` + 61.14447464447402 * `ADS`.`Feature_23` + -47.36574642679817 * `ADS`.`Feature_24` + -54.78182145872035 * `ADS`.`Feature_25` + 153.84512689035256 * `ADS`.`Feature_26` + 87.88440422841138 * `ADS`.`Feature_27` + 48.538299253989294 * `ADS`.`Feature_28` + 167.1439974147754 * `ADS`.`Feature_29` + 97.12254420497062 * `ADS`.`Feature_30` + -83.30415719832426 * `ADS`.`Feature_31` + 179.32699270588856 * `ADS`.`Feature_32` + 162.04892886840622 * `ADS`.`Feature_33` + 27.361607728009712 * `ADS`.`Feature_34` + 9.450908955636692 * `ADS`.`Feature_35` + -25.779339296633694 * `ADS`.`Feature_36` + 55.29687490657559 * `ADS`.`Feature_37` + 39.8215410944085 * `ADS`.`Feature_38` + 113.28133179138756 * `ADS`.`Feature_39` + 35.74204436623822 * `ADS`.`Feature_40` + -109.4113979067734 * `ADS`.`Feature_41` + -1.0112704154024728 * `ADS`.`Feature_42` + -128.2676244993106 * `ADS`.`Feature_43` + -28.307549469706167 * `ADS`.`Feature_44` + 69.28233187242647 * `ADS`.`Feature_45` + -1.719014692209933 * `ADS`.`Feature_46` + 121.71136062368512 * `ADS`.`Feature_47` + 100.14470817800336 * `ADS`.`Feature_48` + -53.54447737372329 * `ADS`.`Feature_49` + 15.070510513780949 * `ADS`.`Feature_50` + -57.68374739323735 * `ADS`.`Feature_51` + -223.2006720346197 * `ADS`.`Feature_52` + 63.032358772125555 * `ADS`.`Feature_53` + -1.4898661682922905 * `ADS`.`Feature_54` + -95.5229482748306 * `ADS`.`Feature_55` + -121.36084095010254 * `ADS`.`Feature_56` + -41.46026241410782 * `ADS`.`Feature_57` + -64.9142948531251 * `ADS`.`Feature_58` + -11.356941447229515 * `ADS`.`Feature_59` + 200.57673179158073 * `ADS`.`Feature_60` + -19.08699543373758 * `ADS`.`Feature_61` + -157.5784616617697 * `ADS`.`Feature_62` + -54.976169220679566 * `ADS`.`Feature_63` + 54.817527436533375 * `ADS`.`Feature_64` + 75.17369794476255 * `ADS`.`Feature_65` + -58.05021489238973 * `ADS`.`Feature_66` + 228.4840607127427 * `ADS`.`Feature_67` + -181.86639509072452 * `ADS`.`Feature_68` + 355.90860755737816 * `ADS`.`Feature_69` + -7.171123079550667 * `ADS`.`Feature_70` + -208.06247719652063 * `ADS`.`Feature_71` + 126.40981134859524 * `ADS`.`Feature_72` + 52.8066062045895 * `ADS`.`Feature_73` + -47.69592386804039 * `ADS`.`Feature_74` + -11.877930876114654 * `ADS`.`Feature_75` + 20.176300699626573 * `ADS`.`Feature_76` + 29.10925069284883 * `ADS`.`Feature_77` + 37.1425948190109 * `ADS`.`Feature_78` + 119.2606774557825 * `ADS`.`Feature_79` + 85.50168772546473 * `ADS`.`Feature_80` + -2.163845081772027 * `ADS`.`Feature_81` + -42.12802895694685 * `ADS`.`Feature_82` + -155.74798503257549 * `ADS`.`Feature_83` + -262.86807779382764 * `ADS`.`Feature_84` + -377.0336834449507 * `ADS`.`Feature_85` + -115.61506758274245 * `ADS`.`Feature_86` + -0.24681687754526693 * `ADS`.`Feature_87` + 38.39348153882149 * `ADS`.`Feature_88` + 50.36628654359438 * `ADS`.`Feature_89` + 192.9854455060716 * `ADS`.`Feature_90` + 200.5109335397568 * `ADS`.`Feature_91` + -128.28230178000234 * `ADS`.`Feature_92` + -50.23872718292643 * `ADS`.`Feature_93` + -108.45961898922924 * `ADS`.`Feature_94` + -17.70600086689379 * `ADS`.`Feature_95` + 27.318869715211026 * `ADS`.`Feature_96` + 11.022208275241598 * `ADS`.`Feature_97` + 250.30581438062592 * `ADS`.`Feature_98` + 548.5705087298535 * `ADS`.`Feature_99` + -104.717895043 AS `Score_2`, 10.505908965501028 * `ADS`.`Feature_0` + 35.02303611972028 * `ADS`.`Feature_1` + 0.006709229702933551 * `ADS`.`Feature_2` + 88.57122053763435 * `ADS`.`Feature_3` + -99.56547340415614 * `ADS`.`Feature_4` + 60.84955342045068 * `ADS`.`Feature_5` + 74.60389860758828 * `ADS`.`Feature_6` + -80.43314041824803 * `ADS`.`Feature_7` + -23.84183079178616 * `ADS`.`Feature_8` + -6.15738158878689 * `ADS`.`Feature_9` + -92.32359647475047 * `ADS`.`Feature_10` + -138.15703431140088 * `ADS`.`Feature_11` + 30.35804334010366 * `ADS`.`Feature_12` + -15.879762733267265 * `ADS`.`Feature_13` + -37.890329191474905 * `ADS`.`Feature_14` + -75.88421111132755 * `ADS`.`Feature_15` + 9.38641683019642 * `ADS`.`Feature_16` + -126.62015579528729 * `ADS`.`Feature_17` + 55.872009263474126 * `ADS`.`Feature_18` + -9.42265100236561 * `ADS`.`Feature_19` + 271.1216356186905 * `ADS`.`Feature_20` + -39.933181853393506 * `ADS`.`Feature_21` + -4.441594308056025 * `ADS`.`Feature_22` + -28.264021736221178 * `ADS`.`Feature_23` + -126.7190069278191 * `ADS`.`Feature_24` + 29.01497353983 * `ADS`.`Feature_25` + -70.18987220057717 * `ADS`.`Feature_26` + -49.57226809396891 * `ADS`.`Feature_27` + -142.52508780261195 * `ADS`.`Feature_28` + -164.91103173035737 * `ADS`.`Feature_29` + 192.6545571930603 * `ADS`.`Feature_30` + -23.94886869251583 * `ADS`.`Feature_31` + -167.68438617427708 * `ADS`.`Feature_32` + -245.62163854460425 * `ADS`.`Feature_33` + 233.38950090733283 * `ADS`.`Feature_34` + 12.603598554699355 * `ADS`.`Feature_35` + 18.499918843503664 * `ADS`.`Feature_36` + -33.40028831268878 * `ADS`.`Feature_37` + -2.8289728852657214 * `ADS`.`Feature_38` + -49.58050363283531 * `ADS`.`Feature_39` + -53.09078452115944 * `ADS`.`Feature_40` + -92.21227947072995 * `ADS`.`Feature_41` + -1.6627365438511057 * `ADS`.`Feature_42` + -195.3699166944906 * `ADS`.`Feature_43` + 5.030373855740028 * `ADS`.`Feature_44` + -133.92711547553546 * `ADS`.`Feature_45` + 62.69133236855589 * `ADS`.`Feature_46` + -130.06746212547722 * `ADS`.`Feature_47` + -223.03151998416766 * `ADS`.`Feature_48` + -217.35672717674743 * `ADS`.`Feature_49` + -227.15110363562607 * `ADS`.`Feature_50` + 17.564889672146272 * `ADS`.`Feature_51` + 161.99915559141414 * `ADS`.`Feature_52` + -51.55902482666788 * `ADS`.`Feature_53` + 95.99207069665769 * `ADS`.`Feature_54` + 120.40615315546414 * `ADS`.`Feature_55` + 179.1312213885624 * `ADS`.`Feature_56` + 55.28576131699737 * `ADS`.`Feature_57` + -42.06749430780398 * `ADS`.`Feature_58` + 14.472203137850608 * `ADS`.`Feature_59` + 134.5883571823037 * `ADS`.`Feature_60` + -7.100006366431181 * `ADS`.`Feature_61` + 127.13086673078037 * `ADS`.`Feature_62` + -18.103274698957577 * `ADS`.`Feature_63` + 13.103718499514121 * `ADS`.`Feature_64` + -53.936821342670804 * `ADS`.`Feature_65` + 11.960681068443444 * `ADS`.`Feature_66` + -108.38949390845646 * `ADS`.`Feature_67` + 59.267179677198854 * `ADS`.`Feature_68` + 195.71693526426213 * `ADS`.`Feature_69` + 41.63570371650277 * `ADS`.`Feature_70` + 177.30089134211792 * `ADS`.`Feature_71` + -128.23140147050577 * `ADS`.`Feature_72` + 120.02089725947611 * `ADS`.`Feature_73` + 82.55239220938813 * `ADS`.`Feature_74` + 20.23026073812638 * `ADS`.`Feature_75` + 125.8486248759439 * `ADS`.`Feature_76` + -16.86672674066511 * `ADS`.`Feature_77` + -33.702050426668315 * `ADS`.`Feature_78` + -47.59465688017504 * `ADS`.`Feature_79` + 222.0967128798711 * `ADS`.`Feature_80` + -25.87799511842843 * `ADS`.`Feature_81` + 11.188123413582238 * `ADS`.`Feature_82` + -231.11183378328337 * `ADS`.`Feature_83` + 257.1741163857923 * `ADS`.`Feature_84` + -34.046646916637876 * `ADS`.`Feature_85` + 61.702804488787244 * `ADS`.`Feature_86` + 39.12504623979001 * `ADS`.`Feature_87` + 40.481665874643305 * `ADS`.`Feature_88` + -44.329398780212344 * `ADS`.`Feature_89` + -44.08840642338856 * `ADS`.`Feature_90` + -112.17949054793046 * `ADS`.`Feature_91` + -62.06481919792917 * `ADS`.`Feature_92` + -11.901725604008574 * `ADS`.`Feature_93` + -224.40612179235598 * `ADS`.`Feature_94` + 44.403110695716464 * `ADS`.`Feature_95` + -18.706955294397574 * `ADS`.`Feature_96` + -55.926030242228485 * `ADS`.`Feature_97` + -175.86360767654327 * `ADS`.`Feature_98` + 314.7981134911942 * `ADS`.`Feature_99` + -117.765870187 AS `Score_3` 
FROM `FourClass_100` AS `ADS`), 
`orig_cte` AS 
(SELECT `linear_model_cte`.`KEY` AS `KEY`, `linear_model_cte`.`Score_0` AS `Score_0`, `linear_model_cte`.`Score_1` AS `Score_1`, `linear_model_cte`.`Score_2` AS `Score_2`, `linear_model_cte`.`Score_3` AS `Score_3`, CAST(NULL AS FLOAT) AS `Proba_0`, CAST(NULL AS FLOAT) AS `Proba_1`, CAST(NULL AS FLOAT) AS `Proba_2`, CAST(NULL AS FLOAT) AS `Proba_3`, CAST(NULL AS FLOAT) AS `LogProba_0`, CAST(NULL AS FLOAT) AS `LogProba_1`, CAST(NULL AS FLOAT) AS `LogProba_2`, CAST(NULL AS FLOAT) AS `LogProba_3`, CAST(NULL AS INT) AS `Decision`, CAST(NULL AS FLOAT) AS `DecisionProba` 
FROM `linear_model_cte`), 
`score_class_union` AS 
(SELECT `scu`.`KEY_u` AS `KEY_u`, `scu`.`class` AS `class`, `scu`.`LogProba` AS `LogProba`, `scu`.`Proba` AS `Proba`, `scu`.`Score` AS `Score` 
FROM (SELECT `orig_cte`.`KEY` AS `KEY_u`, 0 AS `class`, `orig_cte`.`LogProba_0` AS `LogProba`, `orig_cte`.`Proba_0` AS `Proba`, `orig_cte`.`Score_0` AS `Score` 
FROM `orig_cte` UNION ALL SELECT `orig_cte`.`KEY` AS `KEY_u`, 1 AS `class`, `orig_cte`.`LogProba_1` AS `LogProba`, `orig_cte`.`Proba_1` AS `Proba`, `orig_cte`.`Score_1` AS `Score` 
FROM `orig_cte` UNION ALL SELECT `orig_cte`.`KEY` AS `KEY_u`, 2 AS `class`, `orig_cte`.`LogProba_2` AS `LogProba`, `orig_cte`.`Proba_2` AS `Proba`, `orig_cte`.`Score_2` AS `Score` 
FROM `orig_cte` UNION ALL SELECT `orig_cte`.`KEY` AS `KEY_u`, 3 AS `class`, `orig_cte`.`LogProba_3` AS `LogProba`, `orig_cte`.`Proba_3` AS `Proba`, `orig_cte`.`Score_3` AS `Score` 
FROM `orig_cte`) AS `scu`), 
`score_max` AS 
(SELECT `orig_cte`.`KEY` AS `KEY`, `orig_cte`.`Score_0` AS `Score_0`, `orig_cte`.`Score_1` AS `Score_1`, `orig_cte`.`Score_2` AS `Score_2`, `orig_cte`.`Score_3` AS `Score_3`, `orig_cte`.`Proba_0` AS `Proba_0`, `orig_cte`.`Proba_1` AS `Proba_1`, `orig_cte`.`Proba_2` AS `Proba_2`, `orig_cte`.`Proba_3` AS `Proba_3`, `orig_cte`.`LogProba_0` AS `LogProba_0`, `orig_cte`.`LogProba_1` AS `LogProba_1`, `orig_cte`.`LogProba_2` AS `LogProba_2`, `orig_cte`.`LogProba_3` AS `LogProba_3`, `orig_cte`.`Decision` AS `Decision`, `orig_cte`.`DecisionProba` AS `DecisionProba`, `max_select`.`KEY_m` AS `KEY_m`, `max_select`.`max_Score` AS `max_Score` 
FROM `orig_cte` LEFT OUTER JOIN (SELECT `score_class_union`.`KEY_u` AS `KEY_m`, max(`score_class_union`.`Score`) AS `max_Score` 
FROM `score_class_union` GROUP BY `score_class_union`.`KEY_u`) AS `max_select` ON `orig_cte`.`KEY` = `max_select`.`KEY_m`), 
`union_with_max` AS 
(SELECT `score_class_union`.`KEY_u` AS `KEY_u`, `score_class_union`.`class` AS `class`, `score_class_union`.`LogProba` AS `LogProba`, `score_class_union`.`Proba` AS `Proba`, `score_class_union`.`Score` AS `Score`, `score_max`.`KEY` AS `KEY`, `score_max`.`Score_0` AS `Score_0`, `score_max`.`Score_1` AS `Score_1`, `score_max`.`Score_2` AS `Score_2`, `score_max`.`Score_3` AS `Score_3`, `score_max`.`Proba_0` AS `Proba_0`, `score_max`.`Proba_1` AS `Proba_1`, `score_max`.`Proba_2` AS `Proba_2`, `score_max`.`Proba_3` AS `Proba_3`, `score_max`.`LogProba_0` AS `LogProba_0`, `score_max`.`LogProba_1` AS `LogProba_1`, `score_max`.`LogProba_2` AS `LogProba_2`, `score_max`.`LogProba_3` AS `LogProba_3`, `score_max`.`Decision` AS `Decision`, `score_max`.`DecisionProba` AS `DecisionProba`, `score_max`.`KEY_m` AS `KEY_m`, `score_max`.`max_Score` AS `max_Score` 
FROM `score_class_union` LEFT OUTER JOIN `score_max` ON `score_class_union`.`KEY_u` = `score_max`.`KEY`), 
`arg_max_cte` AS 
(SELECT `score_max`.`KEY` AS `KEY`, `score_max`.`Score_0` AS `Score_0`, `score_max`.`Score_1` AS `Score_1`, `score_max`.`Score_2` AS `Score_2`, `score_max`.`Score_3` AS `Score_3`, `score_max`.`Proba_0` AS `Proba_0`, `score_max`.`Proba_1` AS `Proba_1`, `score_max`.`Proba_2` AS `Proba_2`, `score_max`.`Proba_3` AS `Proba_3`, `score_max`.`LogProba_0` AS `LogProba_0`, `score_max`.`LogProba_1` AS `LogProba_1`, `score_max`.`LogProba_2` AS `LogProba_2`, `score_max`.`LogProba_3` AS `LogProba_3`, `score_max`.`Decision` AS `Decision`, `score_max`.`DecisionProba` AS `DecisionProba`, `score_max`.`KEY_m` AS `KEY_m`, `score_max`.`max_Score` AS `max_Score`, `arg_max_t_Score`.`KEY_Score` AS `KEY_Score`, `arg_max_t_Score`.`arg_max_Score` AS `arg_max_Score` 
FROM `score_max` LEFT OUTER JOIN (SELECT `union_with_max`.`KEY` AS `KEY_Score`, min(`union_with_max`.`class`) AS `arg_max_Score` 
FROM `union_with_max` 
WHERE `union_with_max`.`max_Score` <= `union_with_max`.`Score` GROUP BY `union_with_max`.`KEY`) AS `arg_max_t_Score` ON `score_max`.`KEY` = `arg_max_t_Score`.`KEY_Score`)
 SELECT `arg_max_cte`.`KEY` AS `KEY`, `arg_max_cte`.`Score_0` AS `Score_0`, `arg_max_cte`.`Score_1` AS `Score_1`, `arg_max_cte`.`Score_2` AS `Score_2`, `arg_max_cte`.`Score_3` AS `Score_3`, `arg_max_cte`.`Proba_0` AS `Proba_0`, `arg_max_cte`.`Proba_1` AS `Proba_1`, `arg_max_cte`.`Proba_2` AS `Proba_2`, `arg_max_cte`.`Proba_3` AS `Proba_3`, CASE WHEN (`arg_max_cte`.`Proba_0` IS NULL OR `arg_max_cte`.`Proba_0` > 0.0) THEN log(`arg_max_cte`.`Proba_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (`arg_max_cte`.`Proba_1` IS NULL OR `arg_max_cte`.`Proba_1` > 0.0) THEN log(`arg_max_cte`.`Proba_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (`arg_max_cte`.`Proba_2` IS NULL OR `arg_max_cte`.`Proba_2` > 0.0) THEN log(`arg_max_cte`.`Proba_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, CASE WHEN (`arg_max_cte`.`Proba_3` IS NULL OR `arg_max_cte`.`Proba_3` > 0.0) THEN log(`arg_max_cte`.`Proba_3`) ELSE -1.79769313486231e+308 END AS `LogProba_3`, `arg_max_cte`.`arg_max_Score` AS `Decision`, CASE WHEN (`arg_max_cte`.`arg_max_Score` = 0) THEN `arg_max_cte`.`Proba_0` WHEN (`arg_max_cte`.`arg_max_Score` = 1) THEN `arg_max_cte`.`Proba_1` WHEN (`arg_max_cte`.`arg_max_Score` = 2) THEN `arg_max_cte`.`Proba_2` WHEN (`arg_max_cte`.`arg_max_Score` = 3) THEN `arg_max_cte`.`Proba_3` END AS `DecisionProba` 
FROM `arg_max_cte`