-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2017

WITH `Score_Union_CTE_0` AS 
(WITH `DT_node_lookup` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_18` <= 4.599671840667725) THEN CASE WHEN (`ADS`.`Feature_249` <= 4.27580451965332) THEN CASE WHEN (`ADS`.`Feature_477` <= 0.7047011852264404) THEN CASE WHEN (`ADS`.`Feature_456` <= -3.913557529449463) THEN CASE WHEN (`ADS`.`Feature_368` <= -0.7255069017410278) THEN 5 ELSE 6 END ELSE CASE WHEN (`ADS`.`Feature_208` <= 7.578444480895996) THEN 8 ELSE 9 END END ELSE CASE WHEN (`ADS`.`Feature_252` <= -6.678833484649658) THEN CASE WHEN (`ADS`.`Feature_333` <= -3.098625659942627) THEN 12 ELSE 13 END ELSE CASE WHEN (`ADS`.`Feature_143` <= 0.130018413066864) THEN 15 ELSE 16 END END END ELSE CASE WHEN (`ADS`.`Feature_406` <= -0.07581485062837601) THEN CASE WHEN (`ADS`.`Feature_358` <= 0.31789714097976685) THEN CASE WHEN (`ADS`.`Feature_318` <= -0.8356505036354065) THEN 20 ELSE 21 END ELSE CASE WHEN (`ADS`.`Feature_432` <= 1.7526850700378418) THEN 23 ELSE 24 END END ELSE CASE WHEN (`ADS`.`Feature_198` <= -0.7164835929870605) THEN CASE WHEN (`ADS`.`Feature_377` <= 3.510922431945801) THEN 27 ELSE 28 END ELSE CASE WHEN (`ADS`.`Feature_335` <= -0.20649906992912292) THEN 30 ELSE 31 END END END END ELSE CASE WHEN (`ADS`.`Feature_260` <= 1.3024637699127197) THEN CASE WHEN (`ADS`.`Feature_497` <= -4.776134490966797) THEN CASE WHEN (`ADS`.`Feature_167` <= -0.3644111752510071) THEN 35 ELSE CASE WHEN (`ADS`.`Feature_120` <= 0.21466879546642303) THEN 37 ELSE 38 END END ELSE CASE WHEN (`ADS`.`Feature_436` <= -4.761728763580322) THEN CASE WHEN (`ADS`.`Feature_330` <= 0.5126336812973022) THEN 41 ELSE 42 END ELSE CASE WHEN (`ADS`.`Feature_229` <= -5.699057579040527) THEN 44 ELSE 45 END END END ELSE CASE WHEN (`ADS`.`Feature_14` <= 0.12037023156881332) THEN CASE WHEN (`ADS`.`Feature_139` <= -1.064292311668396) THEN CASE WHEN (`ADS`.`Feature_120` <= -1.0640134811401367) THEN 49 ELSE 50 END ELSE 51 END ELSE 52 END END END AS node_id_2 
FROM `FourClass_500` AS `ADS`), 
`DT_node_data` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.count AS count, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Proba_0` AS `Proba_0`, `Values`.`LogProba_0` AS `LogProba_0`, `Values`.`Proba_1` AS `Proba_1`, `Values`.`LogProba_1` AS `LogProba_1`, `Values`.`Proba_2` AS `Proba_2`, `Values`.`LogProba_2` AS `LogProba_2`, `Values`.`Proba_3` AS `Proba_3`, `Values`.`LogProba_3` AS `LogProba_3`, `Values`.`Decision` AS `Decision`, `Values`.`DecisionProba` AS `DecisionProba` 
FROM (SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 5 AS depth, 4 AS parent_id, 0.8 AS `Proba_0`, -0.223143551314 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.2 AS `Proba_3`, -1.60943791243 AS `LogProba_3`, 0 AS `Decision`, 0.8 AS `DecisionProba` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 29 AS count, 5 AS depth, 4 AS parent_id, 0.06896551724137931 AS `Proba_0`, -2.67414864943 AS `LogProba_0`, 0.2413793103448276 AS `Proba_1`, -1.42138568093 AS `LogProba_1`, 0.5517241379310345 AS `Proba_2`, -0.594707107747 AS `LogProba_2`, 0.13793103448275862 AS `Proba_3`, -1.98100146887 AS `LogProba_3`, 2 AS `Decision`, 0.551724137931 AS `DecisionProba` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 97 AS count, 5 AS depth, 7 AS parent_id, 0.07216494845360824 AS `Proba_0`, -2.62880082945 AS `LogProba_0`, 0.7010309278350515 AS `Proba_1`, -0.355203273327 AS `LogProba_1`, 0.12371134020618557 AS `Proba_2`, -2.08980432872 AS `LogProba_2`, 0.10309278350515463 AS `Proba_3`, -2.27212588551 AS `LogProba_3`, 1 AS `Decision`, 0.701030927835 AS `DecisionProba` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 5 AS depth, 7 AS parent_id, 0.1 AS `Proba_0`, -2.30258509299 AS `LogProba_0`, 0.1 AS `Proba_1`, -2.30258509299 AS `LogProba_1`, 0.2 AS `Proba_2`, -1.60943791243 AS `LogProba_2`, 0.6 AS `Proba_3`, -0.510825623766 AS `LogProba_3`, 3 AS `Decision`, 0.6 AS `DecisionProba` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 5 AS depth, 11 AS parent_id, 0.9 AS `Proba_0`, -0.105360515658 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.1 AS `Proba_2`, -2.30258509299 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 0.9 AS `DecisionProba` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 14 AS count, 5 AS depth, 11 AS parent_id, 0.21428571428571427 AS `Proba_0`, -1.54044504095 AS `LogProba_0`, 0.14285714285714285 AS `Proba_1`, -1.94591014906 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.6428571428571429 AS `Proba_3`, -0.441832752279 AS `LogProba_3`, 3 AS `Decision`, 0.642857142857 AS `DecisionProba` UNION ALL SELECT 15 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 67 AS count, 5 AS depth, 14 AS parent_id, 0.13432835820895522 AS `Proba_0`, -2.00746804205 AS `LogProba_0`, 0.1791044776119403 AS `Proba_1`, -1.7197859696 AS `LogProba_1`, 0.5373134328358209 AS `Proba_2`, -0.621173680935 AS `LogProba_2`, 0.14925373134328357 AS `Proba_3`, -1.9021075264 AS `LogProba_3`, 2 AS `Decision`, 0.537313432836 AS `DecisionProba` UNION ALL SELECT 16 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 59 AS count, 5 AS depth, 14 AS parent_id, 0.23728813559322035 AS `Proba_0`, -1.43848011429 AS `LogProba_0`, 0.3559322033898305 AS `Proba_1`, -1.03301500618 AS `LogProba_1`, 0.1864406779661017 AS `Proba_2`, -1.67964217111 AS `LogProba_2`, 0.22033898305084745 AS `Proba_3`, -1.51258808644 AS `LogProba_3`, 1 AS `Decision`, 0.35593220339 AS `DecisionProba` UNION ALL SELECT 20 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 9 AS count, 5 AS depth, 19 AS parent_id, 0.2222222222222222 AS `Proba_0`, -1.50407739678 AS `LogProba_0`, 0.1111111111111111 AS `Proba_1`, -2.19722457734 AS `LogProba_1`, 0.5555555555555556 AS `Proba_2`, -0.587786664902 AS `LogProba_2`, 0.1111111111111111 AS `Proba_3`, -2.19722457734 AS `LogProba_3`, 2 AS `Decision`, 0.555555555556 AS `DecisionProba` UNION ALL SELECT 21 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 32 AS count, 5 AS depth, 19 AS parent_id, 0.875 AS `Proba_0`, -0.133531392625 AS `LogProba_0`, 0.03125 AS `Proba_1`, -3.4657359028 AS `LogProba_1`, 0.0625 AS `Proba_2`, -2.77258872224 AS `LogProba_2`, 0.03125 AS `Proba_3`, -3.4657359028 AS `LogProba_3`, 0 AS `Decision`, 0.875 AS `DecisionProba` UNION ALL SELECT 23 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 31 AS count, 5 AS depth, 22 AS parent_id, 0.3870967741935484 AS `Proba_0`, -0.949080554697 AS `LogProba_0`, 0.06451612903225806 AS `Proba_1`, -2.74084002393 AS `LogProba_1`, 0.16129032258064516 AS `Proba_2`, -1.82454929205 AS `LogProba_2`, 0.3870967741935484 AS `Proba_3`, -0.949080554697 AS `LogProba_3`, 0 AS `Decision`, 0.387096774194 AS `DecisionProba` UNION ALL SELECT 24 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 4 AS count, 5 AS depth, 22 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 27 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 19 AS count, 5 AS depth, 26 AS parent_id, 0.10526315789473684 AS `Proba_0`, -2.25129179861 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.8421052631578947 AS `Proba_2`, -0.171850256927 AS `LogProba_2`, 0.05263157894736842 AS `Proba_3`, -2.94443897917 AS `LogProba_3`, 2 AS `Decision`, 0.842105263158 AS `DecisionProba` UNION ALL SELECT 28 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 9 AS count, 5 AS depth, 26 AS parent_id, 0.2222222222222222 AS `Proba_0`, -1.50407739678 AS `LogProba_0`, 0.4444444444444444 AS `Proba_1`, -0.810930216216 AS `LogProba_1`, 0.1111111111111111 AS `Proba_2`, -2.19722457734 AS `LogProba_2`, 0.2222222222222222 AS `Proba_3`, -1.50407739678 AS `LogProba_3`, 1 AS `Decision`, 0.444444444444 AS `DecisionProba` UNION ALL SELECT 30 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 27 AS count, 5 AS depth, 29 AS parent_id, 0.4444444444444444 AS `Proba_0`, -0.810930216216 AS `LogProba_0`, 0.037037037037037035 AS `Proba_1`, -3.295836866 AS `LogProba_1`, 0.3333333333333333 AS `Proba_2`, -1.09861228867 AS `LogProba_2`, 0.18518518518518517 AS `Proba_3`, -1.68639895357 AS `LogProba_3`, 0 AS `Decision`, 0.444444444444 AS `DecisionProba` UNION ALL SELECT 31 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 41 AS count, 5 AS depth, 29 AS parent_id, 0.04878048780487805 AS `Proba_0`, -3.02042488614 AS `LogProba_0`, 0.2926829268292683 AS `Proba_1`, -1.22866541692 AS `LogProba_1`, 0.12195121951219512 AS `Proba_2`, -2.10413415427 AS `LogProba_2`, 0.5365853658536586 AS `Proba_3`, -0.622529613346 AS `LogProba_3`, 3 AS `Decision`, 0.536585365854 AS `DecisionProba` UNION ALL SELECT 35 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 13 AS count, 4 AS depth, 34 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 1.0 AS `Proba_2`, 0.0 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 2 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 37 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 7 AS count, 5 AS depth, 36 AS parent_id, 0.5714285714285714 AS `Proba_0`, -0.559615787935 AS `LogProba_0`, 0.14285714285714285 AS `Proba_1`, -1.94591014906 AS `LogProba_1`, 0.2857142857142857 AS `Proba_2`, -1.2527629685 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 0.571428571429 AS `DecisionProba` UNION ALL SELECT 38 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 4 AS count, 5 AS depth, 36 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 1.0 AS `Proba_3`, 0.0 AS `LogProba_3`, 3 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 41 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 15 AS count, 5 AS depth, 40 AS parent_id, 0.8666666666666667 AS `Proba_0`, -0.143100843641 AS `LogProba_0`, 0.06666666666666667 AS `Proba_1`, -2.7080502011 AS `LogProba_1`, 0.06666666666666667 AS `Proba_2`, -2.7080502011 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 0.866666666667 AS `DecisionProba` UNION ALL SELECT 42 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 5 AS depth, 40 AS parent_id, 0.2 AS `Proba_0`, -1.60943791243 AS `LogProba_0`, 0.1 AS `Proba_1`, -2.30258509299 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.7 AS `Proba_3`, -0.356674943939 AS `LogProba_3`, 3 AS `Decision`, 0.7 AS `DecisionProba` UNION ALL SELECT 44 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 5 AS depth, 43 AS parent_id, 0.1 AS `Proba_0`, -2.30258509299 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.8 AS `Proba_2`, -0.223143551314 AS `LogProba_2`, 0.1 AS `Proba_3`, -2.30258509299 AS `LogProba_3`, 2 AS `Decision`, 0.8 AS `DecisionProba` UNION ALL SELECT 45 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 58 AS count, 5 AS depth, 43 AS parent_id, 0.15517241379310345 AS `Proba_0`, -1.86321843321 AS `LogProba_0`, 0.034482758620689655 AS `Proba_1`, -3.36729582999 AS `LogProba_1`, 0.08620689655172414 AS `Proba_2`, -2.45100509811 AS `LogProba_2`, 0.7241379310344828 AS `Proba_3`, -0.322773392263 AS `LogProba_3`, 3 AS `Decision`, 0.724137931034 AS `DecisionProba` UNION ALL SELECT 49 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, 48 AS parent_id, 1.0 AS `Proba_0`, 0.0 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 50 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, 48 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 1.0 AS `Proba_2`, 0.0 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 2 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 51 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 4 AS depth, 47 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 1.0 AS `Proba_3`, 0.0 AS `LogProba_3`, 3 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 52 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 9 AS count, 3 AS depth, 46 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output` AS 
(SELECT `DT_node_lookup`.`KEY` AS `KEY`, `DT_node_lookup`.node_id_2 AS node_id_2, `DT_node_data`.node_id AS node_id, `DT_node_data`.feature AS feature, `DT_node_data`.threshold AS threshold, `DT_node_data`.count AS count, `DT_node_data`.depth AS depth, `DT_node_data`.parent_id AS parent_id, `DT_node_data`.`Proba_0` AS `Proba_0`, `DT_node_data`.`LogProba_0` AS `LogProba_0`, `DT_node_data`.`Proba_1` AS `Proba_1`, `DT_node_data`.`LogProba_1` AS `LogProba_1`, `DT_node_data`.`Proba_2` AS `Proba_2`, `DT_node_data`.`LogProba_2` AS `LogProba_2`, `DT_node_data`.`Proba_3` AS `Proba_3`, `DT_node_data`.`LogProba_3` AS `LogProba_3`, `DT_node_data`.`Decision` AS `Decision`, `DT_node_data`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup` LEFT OUTER JOIN `DT_node_data` ON `DT_node_lookup`.node_id_2 = `DT_node_data`.node_id), 
calibration_base_estimator_0 AS 
(SELECT `DT_Output`.`KEY` AS `KEY`, NULL AS `Score_0`, NULL AS `Score_1`, NULL AS `Score_2`, NULL AS `Score_3`, `DT_Output`.`Proba_0` AS `Proba_0`, `DT_Output`.`Proba_1` AS `Proba_1`, `DT_Output`.`Proba_2` AS `Proba_2`, `DT_Output`.`Proba_3` AS `Proba_3`, `DT_Output`.`LogProba_0` AS `LogProba_0`, `DT_Output`.`LogProba_1` AS `LogProba_1`, `DT_Output`.`LogProba_2` AS `LogProba_2`, `DT_Output`.`LogProba_3` AS `LogProba_3`, CAST(NULL AS SIGNED INTEGER) AS `Decision`, NULL AS `DecisionProba`, coalesce(NULL, `DT_Output`.`Proba_0`) AS `ScoreOrProba_0`, coalesce(NULL, `DT_Output`.`Proba_1`) AS `ScoreOrProba_1`, coalesce(NULL, `DT_Output`.`Proba_2`) AS `ScoreOrProba_2`, coalesce(NULL, `DT_Output`.`Proba_3`) AS `ScoreOrProba_3` 
FROM `DT_Output`), 
sigmoid_calibration_0 AS 
(SELECT calibration_base_estimator_0.`KEY` AS `KEY`, 1.0 / (1.0 + exp(0.334045176041 * calibration_base_estimator_0.`ScoreOrProba_0` + 1.09866562127)) AS `Proba_0`, 1.0 / (1.0 + exp(-1.01334697518 * calibration_base_estimator_0.`ScoreOrProba_1` + 1.36676047946)) AS `Proba_1`, 1.0 / (1.0 + exp(-0.791521805784 * calibration_base_estimator_0.`ScoreOrProba_2` + 1.27983209113)) AS `Proba_2`, 1.0 / (1.0 + exp(-0.0259653694152 * calibration_base_estimator_0.`ScoreOrProba_3` + 1.06652786239)) AS `Proba_3` 
FROM calibration_base_estimator_0), 
`Normalized_Probas` AS 
(SELECT sigmoid_calibration_0.`KEY` AS `KEY`, sigmoid_calibration_0.`Proba_0` / (sigmoid_calibration_0.`Proba_0` + sigmoid_calibration_0.`Proba_1` + sigmoid_calibration_0.`Proba_2` + sigmoid_calibration_0.`Proba_3`) AS `Proba_0`, sigmoid_calibration_0.`Proba_1` / (sigmoid_calibration_0.`Proba_0` + sigmoid_calibration_0.`Proba_1` + sigmoid_calibration_0.`Proba_2` + sigmoid_calibration_0.`Proba_3`) AS `Proba_1`, sigmoid_calibration_0.`Proba_2` / (sigmoid_calibration_0.`Proba_0` + sigmoid_calibration_0.`Proba_1` + sigmoid_calibration_0.`Proba_2` + sigmoid_calibration_0.`Proba_3`) AS `Proba_2`, sigmoid_calibration_0.`Proba_3` / (sigmoid_calibration_0.`Proba_0` + sigmoid_calibration_0.`Proba_1` + sigmoid_calibration_0.`Proba_2` + sigmoid_calibration_0.`Proba_3`) AS `Proba_3` 
FROM sigmoid_calibration_0), 
`DT_node_lookup_1` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_266` <= 2.7727837562561035) THEN CASE WHEN (`ADS`.`Feature_196` <= 3.8369054794311523) THEN CASE WHEN (`ADS`.`Feature_259` <= 0.5386122465133667) THEN CASE WHEN (`ADS`.`Feature_135` <= 1.0529279708862305) THEN CASE WHEN (`ADS`.`Feature_183` <= -8.940668106079102) THEN 5 ELSE 6 END ELSE CASE WHEN (`ADS`.`Feature_459` <= -0.8073694705963135) THEN 8 ELSE 9 END END ELSE CASE WHEN (`ADS`.`Feature_495` <= -0.5938317775726318) THEN CASE WHEN (`ADS`.`Feature_424` <= -0.6840119957923889) THEN 12 ELSE 13 END ELSE CASE WHEN (`ADS`.`Feature_310` <= 0.7753769755363464) THEN 15 ELSE 16 END END END ELSE CASE WHEN (`ADS`.`Feature_74` <= -0.8993635177612305) THEN CASE WHEN (`ADS`.`Feature_420` <= -6.494420051574707) THEN 19 ELSE CASE WHEN (`ADS`.`Feature_115` <= 1.1693236827850342) THEN 21 ELSE 22 END END ELSE CASE WHEN (`ADS`.`Feature_209` <= 4.615220069885254) THEN CASE WHEN (`ADS`.`Feature_390` <= -1.7241226434707642) THEN 25 ELSE 26 END ELSE CASE WHEN (`ADS`.`Feature_308` <= 1.6096198558807373) THEN 28 ELSE 29 END END END END ELSE CASE WHEN (`ADS`.`Feature_106` <= -5.906652450561523) THEN CASE WHEN (`ADS`.`Feature_422` <= 4.5897698402404785) THEN CASE WHEN (`ADS`.`Feature_399` <= 1.0775868892669678) THEN CASE WHEN (`ADS`.`Feature_402` <= 0.8048110008239746) THEN 34 ELSE 35 END ELSE 36 END ELSE CASE WHEN (`ADS`.`Feature_120` <= -1.3463976383209229) THEN 38 ELSE 39 END END ELSE CASE WHEN (`ADS`.`Feature_142` <= 1.063592791557312) THEN CASE WHEN (`ADS`.`Feature_396` <= 4.546978950500488) THEN CASE WHEN (`ADS`.`Feature_31` <= -0.8535979986190796) THEN 43 ELSE 44 END ELSE CASE WHEN (`ADS`.`Feature_185` <= -0.9535076022148132) THEN 46 ELSE 47 END END ELSE CASE WHEN (`ADS`.`Feature_200` <= 1.3213739395141602) THEN CASE WHEN (`ADS`.`Feature_373` <= 1.0130535364151) THEN 50 ELSE 51 END ELSE CASE WHEN (`ADS`.`Feature_67` <= 0.873365044593811) THEN 53 ELSE 54 END END END END END AS node_id_2 
FROM `FourClass_500` AS `ADS`), 
`DT_node_data_1` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.count AS count, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Proba_0` AS `Proba_0`, `Values`.`LogProba_0` AS `LogProba_0`, `Values`.`Proba_1` AS `Proba_1`, `Values`.`LogProba_1` AS `LogProba_1`, `Values`.`Proba_2` AS `Proba_2`, `Values`.`LogProba_2` AS `LogProba_2`, `Values`.`Proba_3` AS `Proba_3`, `Values`.`LogProba_3` AS `LogProba_3`, `Values`.`Decision` AS `Decision`, `Values`.`DecisionProba` AS `DecisionProba` 
FROM (SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 18 AS count, 5 AS depth, 4 AS parent_id, 0.05555555555555555 AS `Proba_0`, -2.8903717579 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.05555555555555555 AS `Proba_2`, -2.8903717579 AS `LogProba_2`, 0.8888888888888888 AS `Proba_3`, -0.117783035656 AS `LogProba_3`, 3 AS `Decision`, 0.888888888889 AS `DecisionProba` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 129 AS count, 5 AS depth, 4 AS parent_id, 0.31007751937984496 AS `Proba_0`, -1.17093295025 AS `LogProba_0`, 0.18604651162790697 AS `Proba_1`, -1.68175857401 AS `LogProba_1`, 0.17829457364341086 AS `Proba_2`, -1.72431818843 AS `LogProba_2`, 0.32558139534883723 AS `Proba_3`, -1.12214278608 AS `LogProba_3`, 3 AS `Decision`, 0.325581395349 AS `DecisionProba` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 19 AS count, 5 AS depth, 7 AS parent_id, 0.05263157894736842 AS `Proba_0`, -2.94443897917 AS `LogProba_0`, 0.7894736842105263 AS `Proba_1`, -0.236388778064 AS `LogProba_1`, 0.10526315789473684 AS `Proba_2`, -2.25129179861 AS `LogProba_2`, 0.05263157894736842 AS `Proba_3`, -2.94443897917 AS `LogProba_3`, 1 AS `Decision`, 0.789473684211 AS `DecisionProba` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 80 AS count, 5 AS depth, 7 AS parent_id, 0.125 AS `Proba_0`, -2.07944154168 AS `LogProba_0`, 0.25 AS `Proba_1`, -1.38629436112 AS `LogProba_1`, 0.325 AS `Proba_2`, -1.12393009665 AS `LogProba_2`, 0.3 AS `Proba_3`, -1.20397280433 AS `LogProba_3`, 2 AS `Decision`, 0.325 AS `DecisionProba` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 8 AS count, 5 AS depth, 11 AS parent_id, 0.125 AS `Proba_0`, -2.07944154168 AS `LogProba_0`, 0.75 AS `Proba_1`, -0.287682072452 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.125 AS `Proba_3`, -2.07944154168 AS `LogProba_3`, 1 AS `Decision`, 0.75 AS `DecisionProba` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 31 AS count, 5 AS depth, 11 AS parent_id, 0.1935483870967742 AS `Proba_0`, -1.64222773526 AS `LogProba_0`, 0.0967741935483871 AS `Proba_1`, -2.33537491582 AS `LogProba_1`, 0.5483870967741935 AS `Proba_2`, -0.600773860429 AS `LogProba_2`, 0.16129032258064516 AS `Proba_3`, -1.82454929205 AS `LogProba_3`, 2 AS `Decision`, 0.548387096774 AS `DecisionProba` UNION ALL SELECT 15 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 40 AS count, 5 AS depth, 14 AS parent_id, 0.05 AS `Proba_0`, -2.99573227355 AS `LogProba_0`, 0.8 AS `Proba_1`, -0.223143551314 AS `LogProba_1`, 0.075 AS `Proba_2`, -2.59026716545 AS `LogProba_2`, 0.075 AS `Proba_3`, -2.59026716545 AS `LogProba_3`, 1 AS `Decision`, 0.8 AS `DecisionProba` UNION ALL SELECT 16 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 5 AS count, 5 AS depth, 14 AS parent_id, 0.8 AS `Proba_0`, -0.223143551314 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.2 AS `Proba_2`, -1.60943791243 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 0.8 AS `DecisionProba` UNION ALL SELECT 19 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 4 AS depth, 18 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 21 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 11 AS count, 5 AS depth, 20 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 1.0 AS `Proba_3`, 0.0 AS `LogProba_3`, 3 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 22 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, 20 AS parent_id, 0.5 AS `Proba_0`, -0.69314718056 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.5 AS `Proba_2`, -0.69314718056 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 0.5 AS `DecisionProba` UNION ALL SELECT 25 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, 24 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 1.0 AS `Proba_3`, 0.0 AS `LogProba_3`, 3 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 26 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 48 AS count, 5 AS depth, 24 AS parent_id, 0.041666666666666664 AS `Proba_0`, -3.17805383035 AS `LogProba_0`, 0.125 AS `Proba_1`, -2.07944154168 AS `LogProba_1`, 0.7708333333333334 AS `Proba_2`, -0.260283098264 AS `LogProba_2`, 0.0625 AS `Proba_3`, -2.77258872224 AS `LogProba_3`, 2 AS `Decision`, 0.770833333333 AS `DecisionProba` UNION ALL SELECT 28 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 14 AS count, 5 AS depth, 27 AS parent_id, 0.14285714285714285 AS `Proba_0`, -1.94591014906 AS `LogProba_0`, 0.21428571428571427 AS `Proba_1`, -1.54044504095 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.6428571428571429 AS `Proba_3`, -0.441832752279 AS `LogProba_3`, 3 AS `Decision`, 0.642857142857 AS `DecisionProba` UNION ALL SELECT 29 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 7 AS count, 5 AS depth, 27 AS parent_id, 0.2857142857142857 AS `Proba_0`, -1.2527629685 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.7142857142857143 AS `Proba_2`, -0.336472236621 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 2 AS `Decision`, 0.714285714286 AS `DecisionProba` UNION ALL SELECT 34 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 5 AS depth, 33 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 1.0 AS `Proba_3`, 0.0 AS `LogProba_3`, 3 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 35 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, 33 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 36 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 4 AS count, 4 AS depth, 32 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 1.0 AS `Proba_2`, 0.0 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 2 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 38 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, 37 AS parent_id, 1.0 AS `Proba_0`, 0.0 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 39 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 4 AS depth, 37 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 43 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 9 AS count, 5 AS depth, 42 AS parent_id, 0.1111111111111111 AS `Proba_0`, -2.19722457734 AS `LogProba_0`, 0.6666666666666666 AS `Proba_1`, -0.405465108108 AS `LogProba_1`, 0.1111111111111111 AS `Proba_2`, -2.19722457734 AS `LogProba_2`, 0.1111111111111111 AS `Proba_3`, -2.19722457734 AS `LogProba_3`, 1 AS `Decision`, 0.666666666667 AS `DecisionProba` UNION ALL SELECT 44 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 64 AS count, 5 AS depth, 42 AS parent_id, 0.796875 AS `Proba_0`, -0.227057450635 AS `LogProba_0`, 0.09375 AS `Proba_1`, -2.36712361413 AS `LogProba_1`, 0.078125 AS `Proba_2`, -2.54944517093 AS `LogProba_2`, 0.03125 AS `Proba_3`, -3.4657359028 AS `LogProba_3`, 0 AS `Decision`, 0.796875 AS `DecisionProba` UNION ALL SELECT 46 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 12 AS count, 5 AS depth, 45 AS parent_id, 0.25 AS `Proba_0`, -1.38629436112 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.75 AS `Proba_2`, -0.287682072452 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 2 AS `Decision`, 0.75 AS `DecisionProba` UNION ALL SELECT 47 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 13 AS count, 5 AS depth, 45 AS parent_id, 0.23076923076923078 AS `Proba_0`, -1.46633706879 AS `LogProba_0`, 0.38461538461538464 AS `Proba_1`, -0.955511445027 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.38461538461538464 AS `Proba_3`, -0.955511445027 AS `LogProba_3`, 1 AS `Decision`, 0.384615384615 AS `DecisionProba` UNION ALL SELECT 50 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 37 AS count, 5 AS depth, 49 AS parent_id, 0.10810810810810811 AS `Proba_0`, -2.22462355152 AS `LogProba_0`, 0.24324324324324326 AS `Proba_1`, -1.41369333531 AS `LogProba_1`, 0.16216216216216217 AS `Proba_2`, -1.81915844342 AS `LogProba_2`, 0.4864864864864865 AS `Proba_3`, -0.720546154748 AS `LogProba_3`, 3 AS `Decision`, 0.486486486486 AS `DecisionProba` UNION ALL SELECT 51 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 9 AS count, 5 AS depth, 49 AS parent_id, 0.7777777777777778 AS `Proba_0`, -0.251314428281 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.2222222222222222 AS `Proba_2`, -1.50407739678 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 0.777777777778 AS `DecisionProba` UNION ALL SELECT 53 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 8 AS count, 5 AS depth, 52 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 1.0 AS `Proba_2`, 0.0 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 2 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 54 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, 52 AS parent_id, 1.0 AS `Proba_0`, 0.0 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 1.0 AS `DecisionProba`) AS `Values`), 
`DT_Output_1` AS 
(SELECT `DT_node_lookup_1`.`KEY` AS `KEY`, `DT_node_lookup_1`.node_id_2 AS node_id_2, `DT_node_data_1`.node_id AS node_id, `DT_node_data_1`.feature AS feature, `DT_node_data_1`.threshold AS threshold, `DT_node_data_1`.count AS count, `DT_node_data_1`.depth AS depth, `DT_node_data_1`.parent_id AS parent_id, `DT_node_data_1`.`Proba_0` AS `Proba_0`, `DT_node_data_1`.`LogProba_0` AS `LogProba_0`, `DT_node_data_1`.`Proba_1` AS `Proba_1`, `DT_node_data_1`.`LogProba_1` AS `LogProba_1`, `DT_node_data_1`.`Proba_2` AS `Proba_2`, `DT_node_data_1`.`LogProba_2` AS `LogProba_2`, `DT_node_data_1`.`Proba_3` AS `Proba_3`, `DT_node_data_1`.`LogProba_3` AS `LogProba_3`, `DT_node_data_1`.`Decision` AS `Decision`, `DT_node_data_1`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_1` LEFT OUTER JOIN `DT_node_data_1` ON `DT_node_lookup_1`.node_id_2 = `DT_node_data_1`.node_id), 
calibration_base_estimator_1 AS 
(SELECT `DT_Output_1`.`KEY` AS `KEY`, NULL AS `Score_0`, NULL AS `Score_1`, NULL AS `Score_2`, NULL AS `Score_3`, `DT_Output_1`.`Proba_0` AS `Proba_0`, `DT_Output_1`.`Proba_1` AS `Proba_1`, `DT_Output_1`.`Proba_2` AS `Proba_2`, `DT_Output_1`.`Proba_3` AS `Proba_3`, `DT_Output_1`.`LogProba_0` AS `LogProba_0`, `DT_Output_1`.`LogProba_1` AS `LogProba_1`, `DT_Output_1`.`LogProba_2` AS `LogProba_2`, `DT_Output_1`.`LogProba_3` AS `LogProba_3`, CAST(NULL AS SIGNED INTEGER) AS `Decision`, NULL AS `DecisionProba`, coalesce(NULL, `DT_Output_1`.`Proba_0`) AS `ScoreOrProba_0`, coalesce(NULL, `DT_Output_1`.`Proba_1`) AS `ScoreOrProba_1`, coalesce(NULL, `DT_Output_1`.`Proba_2`) AS `ScoreOrProba_2`, coalesce(NULL, `DT_Output_1`.`Proba_3`) AS `ScoreOrProba_3` 
FROM `DT_Output_1`), 
sigmoid_calibration_1 AS 
(SELECT calibration_base_estimator_1.`KEY` AS `KEY`, 1.0 / (1.0 + exp(-0.640688823157 * calibration_base_estimator_1.`ScoreOrProba_0` + 1.3030794589)) AS `Proba_0`, 1.0 / (1.0 + exp(-1.1867608354 * calibration_base_estimator_1.`ScoreOrProba_1` + 1.46187564022)) AS `Proba_1`, 1.0 / (1.0 + exp(-1.06036704828 * calibration_base_estimator_1.`ScoreOrProba_2` + 1.37143368601)) AS `Proba_2`, 1.0 / (1.0 + exp(-0.0595161566933 * calibration_base_estimator_1.`ScoreOrProba_3` + 1.0663989215)) AS `Proba_3` 
FROM calibration_base_estimator_1), 
`Normalized_Probas_1` AS 
(SELECT sigmoid_calibration_1.`KEY` AS `KEY`, sigmoid_calibration_1.`Proba_0` / (sigmoid_calibration_1.`Proba_0` + sigmoid_calibration_1.`Proba_1` + sigmoid_calibration_1.`Proba_2` + sigmoid_calibration_1.`Proba_3`) AS `Proba_0`, sigmoid_calibration_1.`Proba_1` / (sigmoid_calibration_1.`Proba_0` + sigmoid_calibration_1.`Proba_1` + sigmoid_calibration_1.`Proba_2` + sigmoid_calibration_1.`Proba_3`) AS `Proba_1`, sigmoid_calibration_1.`Proba_2` / (sigmoid_calibration_1.`Proba_0` + sigmoid_calibration_1.`Proba_1` + sigmoid_calibration_1.`Proba_2` + sigmoid_calibration_1.`Proba_3`) AS `Proba_2`, sigmoid_calibration_1.`Proba_3` / (sigmoid_calibration_1.`Proba_0` + sigmoid_calibration_1.`Proba_1` + sigmoid_calibration_1.`Proba_2` + sigmoid_calibration_1.`Proba_3`) AS `Proba_3` 
FROM sigmoid_calibration_1), 
`DT_node_lookup_2` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_249` <= 2.8677220344543457) THEN CASE WHEN (`ADS`.`Feature_209` <= -3.8308749198913574) THEN CASE WHEN (`ADS`.`Feature_283` <= 4.226866722106934) THEN CASE WHEN (`ADS`.`Feature_336` <= 0.4859238862991333) THEN CASE WHEN (`ADS`.`Feature_146` <= -1.5137760639190674) THEN 5 ELSE 6 END ELSE CASE WHEN (`ADS`.`Feature_141` <= 0.11102236807346344) THEN 8 ELSE 9 END END ELSE CASE WHEN (`ADS`.`Feature_481` <= 0.21180318295955658) THEN 11 ELSE CASE WHEN (`ADS`.`Feature_480` <= 7.416871547698975) THEN 13 ELSE 14 END END END ELSE CASE WHEN (`ADS`.`Feature_338` <= 3.33180570602417) THEN CASE WHEN (`ADS`.`Feature_495` <= -0.5672404170036316) THEN CASE WHEN (`ADS`.`Feature_343` <= -2.3730101585388184) THEN 18 ELSE 19 END ELSE CASE WHEN (`ADS`.`Feature_157` <= -0.9289175271987915) THEN 21 ELSE 22 END END ELSE CASE WHEN (`ADS`.`Feature_483` <= 4.307338237762451) THEN CASE WHEN (`ADS`.`Feature_289` <= 1.8321926593780518) THEN 25 ELSE 26 END ELSE CASE WHEN (`ADS`.`Feature_58` <= -0.6006558537483215) THEN 28 ELSE 29 END END END END ELSE CASE WHEN (`ADS`.`Feature_497` <= -7.866596221923828) THEN CASE WHEN (`ADS`.`Feature_76` <= 0.059133343398571014) THEN CASE WHEN (`ADS`.`Feature_125` <= 1.0105433464050293) THEN 33 ELSE CASE WHEN (`ADS`.`Feature_106` <= -0.6545929908752441) THEN 35 ELSE 36 END END ELSE CASE WHEN (`ADS`.`Feature_114` <= 0.8860902786254883) THEN CASE WHEN (`ADS`.`Feature_41` <= -1.3967514038085938) THEN 39 ELSE 40 END ELSE CASE WHEN (`ADS`.`Feature_377` <= -4.432969570159912) THEN 42 ELSE 43 END END END ELSE CASE WHEN (`ADS`.`Feature_288` <= 3.2893424034118652) THEN CASE WHEN (`ADS`.`Feature_153` <= 1.3871839046478271) THEN CASE WHEN (`ADS`.`Feature_303` <= -0.4292770028114319) THEN 47 ELSE 48 END ELSE CASE WHEN (`ADS`.`Feature_424` <= -0.48529374599456787) THEN 50 ELSE 51 END END ELSE CASE WHEN (`ADS`.`Feature_295` <= -0.8811733722686768) THEN CASE WHEN (`ADS`.`Feature_199` <= -1.3450103998184204) THEN 54 ELSE 55 END ELSE CASE WHEN (`ADS`.`Feature_37` <= 0.3627137541770935) THEN 57 ELSE 58 END END END END END AS node_id_2 
FROM `FourClass_500` AS `ADS`), 
`DT_node_data_2` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.count AS count, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Proba_0` AS `Proba_0`, `Values`.`LogProba_0` AS `LogProba_0`, `Values`.`Proba_1` AS `Proba_1`, `Values`.`LogProba_1` AS `LogProba_1`, `Values`.`Proba_2` AS `Proba_2`, `Values`.`LogProba_2` AS `LogProba_2`, `Values`.`Proba_3` AS `Proba_3`, `Values`.`LogProba_3` AS `LogProba_3`, `Values`.`Decision` AS `Decision`, `Values`.`DecisionProba` AS `DecisionProba` 
FROM (SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 5 AS count, 5 AS depth, 4 AS parent_id, 0.8 AS `Proba_0`, -0.223143551314 AS `LogProba_0`, 0.2 AS `Proba_1`, -1.60943791243 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 0.8 AS `DecisionProba` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 44 AS count, 5 AS depth, 4 AS parent_id, 0.022727272727272728 AS `Proba_0`, -3.78418963392 AS `LogProba_0`, 0.06818181818181818 AS `Proba_1`, -2.68557734525 AS `LogProba_1`, 0.75 AS `Proba_2`, -0.287682072452 AS `LogProba_2`, 0.1590909090909091 AS `Proba_3`, -1.83827948486 AS `LogProba_3`, 2 AS `Decision`, 0.75 AS `DecisionProba` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 5 AS depth, 7 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.9 AS `Proba_1`, -0.105360515658 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.1 AS `Proba_3`, -2.30258509299 AS `LogProba_3`, 1 AS `Decision`, 0.9 AS `DecisionProba` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 9 AS count, 5 AS depth, 7 AS parent_id, 0.6666666666666666 AS `Proba_0`, -0.405465108108 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.3333333333333333 AS `Proba_2`, -1.09861228867 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 0.666666666667 AS `DecisionProba` UNION ALL SELECT 11 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 9 AS count, 4 AS depth, 10 AS parent_id, 1.0 AS `Proba_0`, 0.0 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, 12 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.6666666666666666 AS `Proba_1`, -0.405465108108 AS `LogProba_1`, 0.3333333333333333 AS `Proba_2`, -1.09861228867 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 0.666666666667 AS `DecisionProba` UNION ALL SELECT 14 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, 12 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 1.0 AS `Proba_3`, 0.0 AS `LogProba_3`, 3 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 18 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 53 AS count, 5 AS depth, 17 AS parent_id, 0.4339622641509434 AS `Proba_0`, -0.834797697623 AS `LogProba_0`, 0.2641509433962264 AS `Proba_1`, -1.33123458394 AS `LogProba_1`, 0.2641509433962264 AS `Proba_2`, -1.33123458394 AS `LogProba_2`, 0.03773584905660377 AS `Proba_3`, -3.27714473299 AS `LogProba_3`, 0 AS `Decision`, 0.433962264151 AS `DecisionProba` UNION ALL SELECT 19 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 49 AS count, 5 AS depth, 17 AS parent_id, 0.10204081632653061 AS `Proba_0`, -2.28238238568 AS `LogProba_0`, 0.3469387755102041 AS `Proba_1`, -1.05860695405 AS `LogProba_1`, 0.16326530612244897 AS `Proba_2`, -1.81237875643 AS `LogProba_2`, 0.3877551020408163 AS `Proba_3`, -0.947381318944 AS `LogProba_3`, 3 AS `Decision`, 0.387755102041 AS `DecisionProba` UNION ALL SELECT 21 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 15 AS count, 5 AS depth, 20 AS parent_id, 0.06666666666666667 AS `Proba_0`, -2.7080502011 AS `LogProba_0`, 0.13333333333333333 AS `Proba_1`, -2.01490302054 AS `LogProba_1`, 0.26666666666666666 AS `Proba_2`, -1.32175583998 AS `LogProba_2`, 0.5333333333333333 AS `Proba_3`, -0.628608659422 AS `LogProba_3`, 3 AS `Decision`, 0.533333333333 AS `DecisionProba` UNION ALL SELECT 22 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 83 AS count, 5 AS depth, 20 AS parent_id, 0.07228915662650602 AS `Proba_0`, -2.62708113857 AS `LogProba_0`, 0.6867469879518072 AS `Proba_1`, -0.375789339962 AS `LogProba_1`, 0.10843373493975904 AS `Proba_2`, -2.22161603046 AS `LogProba_2`, 0.13253012048192772 AS `Proba_3`, -2.020945335 AS `LogProba_3`, 1 AS `Decision`, 0.686746987952 AS `DecisionProba` UNION ALL SELECT 25 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 30 AS count, 5 AS depth, 24 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.13333333333333333 AS `Proba_1`, -2.01490302054 AS `LogProba_1`, 0.7666666666666667 AS `Proba_2`, -0.265703165733 AS `LogProba_2`, 0.1 AS `Proba_3`, -2.30258509299 AS `LogProba_3`, 2 AS `Decision`, 0.766666666667 AS `DecisionProba` UNION ALL SELECT 26 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 17 AS count, 5 AS depth, 24 AS parent_id, 0.35294117647058826 AS `Proba_0`, -1.04145387483 AS `LogProba_0`, 0.23529411764705882 AS `Proba_1`, -1.44691898294 AS `LogProba_1`, 0.11764705882352941 AS `Proba_2`, -2.1400661635 AS `LogProba_2`, 0.29411764705882354 AS `Proba_3`, -1.22377543162 AS `LogProba_3`, 0 AS `Decision`, 0.352941176471 AS `DecisionProba` UNION ALL SELECT 28 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 8 AS count, 5 AS depth, 27 AS parent_id, 0.375 AS `Proba_0`, -0.980829253012 AS `LogProba_0`, 0.375 AS `Proba_1`, -0.980829253012 AS `LogProba_1`, 0.125 AS `Proba_2`, -2.07944154168 AS `LogProba_2`, 0.125 AS `Proba_3`, -2.07944154168 AS `LogProba_3`, 0 AS `Decision`, 0.375 AS `DecisionProba` UNION ALL SELECT 29 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 14 AS count, 5 AS depth, 27 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.07142857142857142 AS `Proba_2`, -2.63905732962 AS `LogProba_2`, 0.9285714285714286 AS `Proba_3`, -0.0741079721537 AS `LogProba_3`, 3 AS `Decision`, 0.928571428571 AS `DecisionProba` UNION ALL SELECT 33 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 16 AS count, 4 AS depth, 32 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 1.0 AS `Proba_2`, 0.0 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 2 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 35 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, 34 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 36 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 2 AS count, 5 AS depth, 34 AS parent_id, 0.5 AS `Proba_0`, -0.69314718056 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.5 AS `Proba_3`, -0.69314718056 AS `LogProba_3`, 0 AS `Decision`, 0.5 AS `DecisionProba` UNION ALL SELECT 39 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, 38 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 1.0 AS `Proba_3`, 0.0 AS `LogProba_3`, 3 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 40 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 5 AS depth, 38 AS parent_id, 1.0 AS `Proba_0`, 0.0 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 42 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, 41 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 1.0 AS `Proba_2`, 0.0 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 2 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 43 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, 41 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.6666666666666666 AS `Proba_1`, -0.405465108108 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.3333333333333333 AS `Proba_3`, -1.09861228867 AS `LogProba_3`, 1 AS `Decision`, 0.666666666667 AS `DecisionProba` UNION ALL SELECT 47 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 28 AS count, 5 AS depth, 46 AS parent_id, 0.07142857142857142 AS `Proba_0`, -2.63905732962 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.07142857142857142 AS `Proba_2`, -2.63905732962 AS `LogProba_2`, 0.8571428571428571 AS `Proba_3`, -0.154150679827 AS `LogProba_3`, 3 AS `Decision`, 0.857142857143 AS `DecisionProba` UNION ALL SELECT 48 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 67 AS count, 5 AS depth, 46 AS parent_id, 0.3880597014925373 AS `Proba_0`, -0.946596081369 AS `LogProba_0`, 0.08955223880597014 AS `Proba_1`, -2.41293315016 AS `LogProba_1`, 0.07462686567164178 AS `Proba_2`, -2.59525470696 AS `LogProba_2`, 0.44776119402985076 AS `Proba_3`, -0.803495237729 AS `LogProba_3`, 3 AS `Decision`, 0.44776119403 AS `DecisionProba` UNION ALL SELECT 50 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 21 AS count, 5 AS depth, 49 AS parent_id, 0.47619047619047616 AS `Proba_0`, -0.741937344729 AS `LogProba_0`, 0.3333333333333333 AS `Proba_1`, -1.09861228867 AS `LogProba_1`, 0.19047619047619047 AS `Proba_2`, -1.6582280766 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 0.47619047619 AS `DecisionProba` UNION ALL SELECT 51 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 40 AS count, 5 AS depth, 49 AS parent_id, 0.05 AS `Proba_0`, -2.99573227355 AS `LogProba_0`, 0.225 AS `Proba_1`, -1.49165487678 AS `LogProba_1`, 0.3 AS `Proba_2`, -1.20397280433 AS `LogProba_2`, 0.425 AS `Proba_3`, -0.855666110058 AS `LogProba_3`, 3 AS `Decision`, 0.425 AS `DecisionProba` UNION ALL SELECT 54 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, 53 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 1.0 AS `Proba_3`, 0.0 AS `LogProba_3`, 3 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 55 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 6 AS count, 5 AS depth, 53 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 57 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 31 AS count, 5 AS depth, 56 AS parent_id, 0.7741935483870968 AS `Proba_0`, -0.255933374137 AS `LogProba_0`, 0.03225806451612903 AS `Proba_1`, -3.43398720449 AS `LogProba_1`, 0.06451612903225806 AS `Proba_2`, -2.74084002393 AS `LogProba_2`, 0.12903225806451613 AS `Proba_3`, -2.04769284337 AS `LogProba_3`, 0 AS `Decision`, 0.774193548387 AS `DecisionProba` UNION ALL SELECT 58 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 19 AS count, 5 AS depth, 56 AS parent_id, 0.21052631578947367 AS `Proba_0`, -1.55814461805 AS `LogProba_0`, 0.10526315789473684 AS `Proba_1`, -2.25129179861 AS `LogProba_1`, 0.47368421052631576 AS `Proba_2`, -0.74721440183 AS `LogProba_2`, 0.21052631578947367 AS `Proba_3`, -1.55814461805 AS `LogProba_3`, 2 AS `Decision`, 0.473684210526 AS `DecisionProba`) AS `Values`), 
`DT_Output_2` AS 
(SELECT `DT_node_lookup_2`.`KEY` AS `KEY`, `DT_node_lookup_2`.node_id_2 AS node_id_2, `DT_node_data_2`.node_id AS node_id, `DT_node_data_2`.feature AS feature, `DT_node_data_2`.threshold AS threshold, `DT_node_data_2`.count AS count, `DT_node_data_2`.depth AS depth, `DT_node_data_2`.parent_id AS parent_id, `DT_node_data_2`.`Proba_0` AS `Proba_0`, `DT_node_data_2`.`LogProba_0` AS `LogProba_0`, `DT_node_data_2`.`Proba_1` AS `Proba_1`, `DT_node_data_2`.`LogProba_1` AS `LogProba_1`, `DT_node_data_2`.`Proba_2` AS `Proba_2`, `DT_node_data_2`.`LogProba_2` AS `LogProba_2`, `DT_node_data_2`.`Proba_3` AS `Proba_3`, `DT_node_data_2`.`LogProba_3` AS `LogProba_3`, `DT_node_data_2`.`Decision` AS `Decision`, `DT_node_data_2`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_2` LEFT OUTER JOIN `DT_node_data_2` ON `DT_node_lookup_2`.node_id_2 = `DT_node_data_2`.node_id), 
calibration_base_estimator_2 AS 
(SELECT `DT_Output_2`.`KEY` AS `KEY`, NULL AS `Score_0`, NULL AS `Score_1`, NULL AS `Score_2`, NULL AS `Score_3`, `DT_Output_2`.`Proba_0` AS `Proba_0`, `DT_Output_2`.`Proba_1` AS `Proba_1`, `DT_Output_2`.`Proba_2` AS `Proba_2`, `DT_Output_2`.`Proba_3` AS `Proba_3`, `DT_Output_2`.`LogProba_0` AS `LogProba_0`, `DT_Output_2`.`LogProba_1` AS `LogProba_1`, `DT_Output_2`.`LogProba_2` AS `LogProba_2`, `DT_Output_2`.`LogProba_3` AS `LogProba_3`, CAST(NULL AS SIGNED INTEGER) AS `Decision`, NULL AS `DecisionProba`, coalesce(NULL, `DT_Output_2`.`Proba_0`) AS `ScoreOrProba_0`, coalesce(NULL, `DT_Output_2`.`Proba_1`) AS `ScoreOrProba_1`, coalesce(NULL, `DT_Output_2`.`Proba_2`) AS `ScoreOrProba_2`, coalesce(NULL, `DT_Output_2`.`Proba_3`) AS `ScoreOrProba_3` 
FROM `DT_Output_2`), 
sigmoid_calibration_2 AS 
(SELECT calibration_base_estimator_2.`KEY` AS `KEY`, 1.0 / (1.0 + exp(0.110670360483 * calibration_base_estimator_2.`ScoreOrProba_0` + 1.12000830786)) AS `Proba_0`, 1.0 / (1.0 + exp(-0.99507024865 * calibration_base_estimator_2.`ScoreOrProba_1` + 1.37138334662)) AS `Proba_1`, 1.0 / (1.0 + exp(-0.232239919908 * calibration_base_estimator_2.`ScoreOrProba_2` + 1.1453530957)) AS `Proba_2`, 1.0 / (1.0 + exp(-0.73412579893 * calibration_base_estimator_2.`ScoreOrProba_3` + 1.27513847587)) AS `Proba_3` 
FROM calibration_base_estimator_2), 
`Normalized_Probas_2` AS 
(SELECT sigmoid_calibration_2.`KEY` AS `KEY`, sigmoid_calibration_2.`Proba_0` / (sigmoid_calibration_2.`Proba_0` + sigmoid_calibration_2.`Proba_1` + sigmoid_calibration_2.`Proba_2` + sigmoid_calibration_2.`Proba_3`) AS `Proba_0`, sigmoid_calibration_2.`Proba_1` / (sigmoid_calibration_2.`Proba_0` + sigmoid_calibration_2.`Proba_1` + sigmoid_calibration_2.`Proba_2` + sigmoid_calibration_2.`Proba_3`) AS `Proba_1`, sigmoid_calibration_2.`Proba_2` / (sigmoid_calibration_2.`Proba_0` + sigmoid_calibration_2.`Proba_1` + sigmoid_calibration_2.`Proba_2` + sigmoid_calibration_2.`Proba_3`) AS `Proba_2`, sigmoid_calibration_2.`Proba_3` / (sigmoid_calibration_2.`Proba_0` + sigmoid_calibration_2.`Proba_1` + sigmoid_calibration_2.`Proba_2` + sigmoid_calibration_2.`Proba_3`) AS `Proba_3` 
FROM sigmoid_calibration_2), 
`DT_node_lookup_3` AS 
(SELECT `ADS`.`KEY` AS `KEY`, CASE WHEN (`ADS`.`Feature_338` <= -1.7936967611312866) THEN CASE WHEN (`ADS`.`Feature_249` <= -21.123554229736328) THEN CASE WHEN (`ADS`.`Feature_255` <= 0.2452794909477234) THEN CASE WHEN (`ADS`.`Feature_120` <= -0.6106349229812622) THEN CASE WHEN (`ADS`.`Feature_128` <= 0.4367939531803131) THEN 5 ELSE 6 END ELSE CASE WHEN (`ADS`.`Feature_274` <= 0.3479110598564148) THEN 8 ELSE 9 END END ELSE CASE WHEN (`ADS`.`Feature_329` <= -0.7029154896736145) THEN CASE WHEN (`ADS`.`Feature_5` <= -0.10087765753269196) THEN 12 ELSE 13 END ELSE CASE WHEN (`ADS`.`Feature_242` <= -1.1037298440933228) THEN 15 ELSE 16 END END END ELSE CASE WHEN (`ADS`.`Feature_129` <= -7.825395107269287) THEN CASE WHEN (`ADS`.`Feature_28` <= 1.4765523672103882) THEN 19 ELSE 20 END ELSE CASE WHEN (`ADS`.`Feature_329` <= -0.9750343561172485) THEN CASE WHEN (`ADS`.`Feature_442` <= -2.4997153282165527) THEN 23 ELSE 24 END ELSE CASE WHEN (`ADS`.`Feature_268` <= 8.236695289611816) THEN 26 ELSE 27 END END END END ELSE CASE WHEN (`ADS`.`Feature_301` <= -7.468977928161621) THEN CASE WHEN (`ADS`.`Feature_50` <= 0.6976150274276733) THEN CASE WHEN (`ADS`.`Feature_247` <= 8.527505874633789) THEN 31 ELSE 32 END ELSE CASE WHEN (`ADS`.`Feature_471` <= 1.1554608345031738) THEN 34 ELSE CASE WHEN (`ADS`.`Feature_469` <= -0.5001636743545532) THEN 36 ELSE 37 END END END ELSE CASE WHEN (`ADS`.`Feature_72` <= 2.8854594230651855) THEN CASE WHEN (`ADS`.`Feature_129` <= -5.498040199279785) THEN CASE WHEN (`ADS`.`Feature_182` <= -0.4413303732872009) THEN 41 ELSE 42 END ELSE CASE WHEN (`ADS`.`Feature_289` <= -2.0548653602600098) THEN 44 ELSE 45 END END ELSE CASE WHEN (`ADS`.`Feature_179` <= -4.175331115722656) THEN CASE WHEN (`ADS`.`Feature_137` <= -0.11830663681030273) THEN 48 ELSE 49 END ELSE CASE WHEN (`ADS`.`Feature_228` <= -0.5062150359153748) THEN 51 ELSE 52 END END END END END AS node_id_2 
FROM `FourClass_500` AS `ADS`), 
`DT_node_data_3` AS 
(SELECT `Values`.node_id AS node_id, `Values`.feature AS feature, `Values`.threshold AS threshold, `Values`.count AS count, `Values`.depth AS depth, `Values`.parent_id AS parent_id, `Values`.`Proba_0` AS `Proba_0`, `Values`.`LogProba_0` AS `LogProba_0`, `Values`.`Proba_1` AS `Proba_1`, `Values`.`LogProba_1` AS `LogProba_1`, `Values`.`Proba_2` AS `Proba_2`, `Values`.`LogProba_2` AS `LogProba_2`, `Values`.`Proba_3` AS `Proba_3`, `Values`.`LogProba_3` AS `LogProba_3`, `Values`.`Decision` AS `Decision`, `Values`.`DecisionProba` AS `DecisionProba` 
FROM (SELECT 5 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 13 AS count, 5 AS depth, 4 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.9230769230769231 AS `Proba_2`, -0.0800427076735 AS `LogProba_2`, 0.07692307692307693 AS `Proba_3`, -2.56494935746 AS `LogProba_3`, 2 AS `Decision`, 0.923076923077 AS `DecisionProba` UNION ALL SELECT 6 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, 4 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 8 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 22 AS count, 5 AS depth, 7 AS parent_id, 0.09090909090909091 AS `Proba_0`, -2.3978952728 AS `LogProba_0`, 0.4090909090909091 AS `Proba_1`, -0.893817876022 AS `LogProba_1`, 0.13636363636363635 AS `Proba_2`, -1.99243016469 AS `LogProba_2`, 0.36363636363636365 AS `Proba_3`, -1.01160091168 AS `LogProba_3`, 1 AS `Decision`, 0.409090909091 AS `DecisionProba` UNION ALL SELECT 9 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 12 AS count, 5 AS depth, 7 AS parent_id, 0.75 AS `Proba_0`, -0.287682072452 AS `LogProba_0`, 0.16666666666666666 AS `Proba_1`, -1.79175946923 AS `LogProba_1`, 0.08333333333333333 AS `Proba_2`, -2.48490664979 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 0.75 AS `DecisionProba` UNION ALL SELECT 12 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 5 AS count, 5 AS depth, 11 AS parent_id, 0.2 AS `Proba_0`, -1.60943791243 AS `LogProba_0`, 0.6 AS `Proba_1`, -0.510825623766 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.2 AS `Proba_3`, -1.60943791243 AS `LogProba_3`, 1 AS `Decision`, 0.6 AS `DecisionProba` UNION ALL SELECT 13 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 5 AS count, 5 AS depth, 11 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 1.0 AS `Proba_2`, 0.0 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 2 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 15 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 5 AS depth, 14 AS parent_id, 1.0 AS `Proba_0`, 0.0 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 0 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 16 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 24 AS count, 5 AS depth, 14 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 19 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 7 AS count, 4 AS depth, 18 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 20 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, 18 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 1.0 AS `Proba_3`, 0.0 AS `LogProba_3`, 3 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 23 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 9 AS count, 5 AS depth, 22 AS parent_id, 0.1111111111111111 AS `Proba_0`, -2.19722457734 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.8888888888888888 AS `Proba_3`, -0.117783035656 AS `LogProba_3`, 3 AS `Decision`, 0.888888888889 AS `DecisionProba` UNION ALL SELECT 24 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 5 AS depth, 22 AS parent_id, 0.2 AS `Proba_0`, -1.60943791243 AS `LogProba_0`, 0.5 AS `Proba_1`, -0.69314718056 AS `LogProba_1`, 0.2 AS `Proba_2`, -1.60943791243 AS `LogProba_2`, 0.1 AS `Proba_3`, -2.30258509299 AS `LogProba_3`, 1 AS `Decision`, 0.5 AS `DecisionProba` UNION ALL SELECT 26 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 105 AS count, 5 AS depth, 25 AS parent_id, 0.6095238095238096 AS `Proba_0`, -0.495077266798 AS `LogProba_0`, 0.10476190476190476 AS `Proba_1`, -2.25606507736 AS `LogProba_1`, 0.19047619047619047 AS `Proba_2`, -1.6582280766 AS `LogProba_2`, 0.09523809523809523 AS `Proba_3`, -2.35137525716 AS `LogProba_3`, 0 AS `Decision`, 0.609523809524 AS `DecisionProba` UNION ALL SELECT 27 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 5 AS depth, 25 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.4 AS `Proba_1`, -0.916290731874 AS `LogProba_1`, 0.6 AS `Proba_2`, -0.510825623766 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 2 AS `Decision`, 0.6 AS `DecisionProba` UNION ALL SELECT 31 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 22 AS count, 4 AS depth, 30 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 1.0 AS `Proba_3`, 0.0 AS `LogProba_3`, 3 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 32 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 4 AS depth, 30 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 1.0 AS `Proba_2`, 0.0 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 2 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 34 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 3 AS count, 4 AS depth, 33 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 36 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, 35 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 1.0 AS `Proba_3`, 0.0 AS `LogProba_3`, 3 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 37 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 1 AS count, 5 AS depth, 35 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 0.0 AS `Proba_1`, -1.79769313486231e+308 AS `LogProba_1`, 1.0 AS `Proba_2`, 0.0 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 2 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 41 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 10 AS count, 5 AS depth, 40 AS parent_id, 0.0 AS `Proba_0`, -1.79769313486231e+308 AS `LogProba_0`, 1.0 AS `Proba_1`, 0.0 AS `LogProba_1`, 0.0 AS `Proba_2`, -1.79769313486231e+308 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 1.0 AS `DecisionProba` UNION ALL SELECT 42 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 25 AS count, 5 AS depth, 40 AS parent_id, 0.12 AS `Proba_0`, -2.1202635362 AS `LogProba_0`, 0.28 AS `Proba_1`, -1.27296567581 AS `LogProba_1`, 0.12 AS `Proba_2`, -2.1202635362 AS `LogProba_2`, 0.48 AS `Proba_3`, -0.73396917508 AS `LogProba_3`, 3 AS `Decision`, 0.48 AS `DecisionProba` UNION ALL SELECT 44 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 81 AS count, 5 AS depth, 43 AS parent_id, 0.12345679012345678 AS `Proba_0`, -2.09186406168 AS `LogProba_0`, 0.12345679012345678 AS `Proba_1`, -2.09186406168 AS `LogProba_1`, 0.5185185185185185 AS `Proba_2`, -0.656779536389 AS `LogProba_2`, 0.2345679012345679 AS `Proba_3`, -1.45001017551 AS `LogProba_3`, 2 AS `Decision`, 0.518518518519 AS `DecisionProba` UNION ALL SELECT 45 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 126 AS count, 5 AS depth, 43 AS parent_id, 0.3412698412698413 AS `Proba_0`, -1.07508179126 AS `LogProba_0`, 0.2222222222222222 AS `Proba_1`, -1.50407739678 AS `LogProba_1`, 0.2619047619047619 AS `Proba_2`, -1.33977434548 AS `LogProba_2`, 0.1746031746031746 AS `Proba_3`, -1.74523945359 AS `LogProba_3`, 0 AS `Decision`, 0.34126984127 AS `DecisionProba` UNION ALL SELECT 48 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 14 AS count, 5 AS depth, 47 AS parent_id, 0.07142857142857142 AS `Proba_0`, -2.63905732962 AS `LogProba_0`, 0.8571428571428571 AS `Proba_1`, -0.154150679827 AS `LogProba_1`, 0.07142857142857142 AS `Proba_2`, -2.63905732962 AS `LogProba_2`, 0.0 AS `Proba_3`, -1.79769313486231e+308 AS `LogProba_3`, 1 AS `Decision`, 0.857142857143 AS `DecisionProba` UNION ALL SELECT 49 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 12 AS count, 5 AS depth, 47 AS parent_id, 0.25 AS `Proba_0`, -1.38629436112 AS `LogProba_0`, 0.08333333333333333 AS `Proba_1`, -2.48490664979 AS `LogProba_1`, 0.25 AS `Proba_2`, -1.38629436112 AS `LogProba_2`, 0.4166666666666667 AS `Proba_3`, -0.875468737354 AS `LogProba_3`, 3 AS `Decision`, 0.416666666667 AS `DecisionProba` UNION ALL SELECT 51 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 33 AS count, 5 AS depth, 50 AS parent_id, 0.030303030303030304 AS `Proba_0`, -3.49650756147 AS `LogProba_0`, 0.18181818181818182 AS `Proba_1`, -1.70474809224 AS `LogProba_1`, 0.45454545454545453 AS `Proba_2`, -0.788457360364 AS `LogProba_2`, 0.3333333333333333 AS `Proba_3`, -1.09861228867 AS `LogProba_3`, 2 AS `Decision`, 0.454545454545 AS `DecisionProba` UNION ALL SELECT 52 AS node_id, CAST(NULL AS CHAR(256)) AS feature, NULL AS threshold, 44 AS count, 5 AS depth, 50 AS parent_id, 0.022727272727272728 AS `Proba_0`, -3.78418963392 AS `LogProba_0`, 0.13636363636363635 AS `Proba_1`, -1.99243016469 AS `LogProba_1`, 0.09090909090909091 AS `Proba_2`, -2.3978952728 AS `LogProba_2`, 0.75 AS `Proba_3`, -0.287682072452 AS `LogProba_3`, 3 AS `Decision`, 0.75 AS `DecisionProba`) AS `Values`), 
`DT_Output_3` AS 
(SELECT `DT_node_lookup_3`.`KEY` AS `KEY`, `DT_node_lookup_3`.node_id_2 AS node_id_2, `DT_node_data_3`.node_id AS node_id, `DT_node_data_3`.feature AS feature, `DT_node_data_3`.threshold AS threshold, `DT_node_data_3`.count AS count, `DT_node_data_3`.depth AS depth, `DT_node_data_3`.parent_id AS parent_id, `DT_node_data_3`.`Proba_0` AS `Proba_0`, `DT_node_data_3`.`LogProba_0` AS `LogProba_0`, `DT_node_data_3`.`Proba_1` AS `Proba_1`, `DT_node_data_3`.`LogProba_1` AS `LogProba_1`, `DT_node_data_3`.`Proba_2` AS `Proba_2`, `DT_node_data_3`.`LogProba_2` AS `LogProba_2`, `DT_node_data_3`.`Proba_3` AS `Proba_3`, `DT_node_data_3`.`LogProba_3` AS `LogProba_3`, `DT_node_data_3`.`Decision` AS `Decision`, `DT_node_data_3`.`DecisionProba` AS `DecisionProba` 
FROM `DT_node_lookup_3` LEFT OUTER JOIN `DT_node_data_3` ON `DT_node_lookup_3`.node_id_2 = `DT_node_data_3`.node_id), 
calibration_base_estimator_3 AS 
(SELECT `DT_Output_3`.`KEY` AS `KEY`, NULL AS `Score_0`, NULL AS `Score_1`, NULL AS `Score_2`, NULL AS `Score_3`, `DT_Output_3`.`Proba_0` AS `Proba_0`, `DT_Output_3`.`Proba_1` AS `Proba_1`, `DT_Output_3`.`Proba_2` AS `Proba_2`, `DT_Output_3`.`Proba_3` AS `Proba_3`, `DT_Output_3`.`LogProba_0` AS `LogProba_0`, `DT_Output_3`.`LogProba_1` AS `LogProba_1`, `DT_Output_3`.`LogProba_2` AS `LogProba_2`, `DT_Output_3`.`LogProba_3` AS `LogProba_3`, CAST(NULL AS SIGNED INTEGER) AS `Decision`, NULL AS `DecisionProba`, coalesce(NULL, `DT_Output_3`.`Proba_0`) AS `ScoreOrProba_0`, coalesce(NULL, `DT_Output_3`.`Proba_1`) AS `ScoreOrProba_1`, coalesce(NULL, `DT_Output_3`.`Proba_2`) AS `ScoreOrProba_2`, coalesce(NULL, `DT_Output_3`.`Proba_3`) AS `ScoreOrProba_3` 
FROM `DT_Output_3`), 
sigmoid_calibration_3 AS 
(SELECT calibration_base_estimator_3.`KEY` AS `KEY`, 1.0 / (1.0 + exp(-1.65551226529 * calibration_base_estimator_3.`ScoreOrProba_0` + 1.61714309793)) AS `Proba_0`, 1.0 / (1.0 + exp(-0.540830179195 * calibration_base_estimator_3.`ScoreOrProba_1` + 1.22186540256)) AS `Proba_1`, 1.0 / (1.0 + exp(-0.205237255728 * calibration_base_estimator_3.`ScoreOrProba_2` + 1.13399640422)) AS `Proba_2`, 1.0 / (1.0 + exp(-1.32737104573 * calibration_base_estimator_3.`ScoreOrProba_3` + 1.44082433679)) AS `Proba_3` 
FROM calibration_base_estimator_3), 
`Normalized_Probas_3` AS 
(SELECT sigmoid_calibration_3.`KEY` AS `KEY`, sigmoid_calibration_3.`Proba_0` / (sigmoid_calibration_3.`Proba_0` + sigmoid_calibration_3.`Proba_1` + sigmoid_calibration_3.`Proba_2` + sigmoid_calibration_3.`Proba_3`) AS `Proba_0`, sigmoid_calibration_3.`Proba_1` / (sigmoid_calibration_3.`Proba_0` + sigmoid_calibration_3.`Proba_1` + sigmoid_calibration_3.`Proba_2` + sigmoid_calibration_3.`Proba_3`) AS `Proba_1`, sigmoid_calibration_3.`Proba_2` / (sigmoid_calibration_3.`Proba_0` + sigmoid_calibration_3.`Proba_1` + sigmoid_calibration_3.`Proba_2` + sigmoid_calibration_3.`Proba_3`) AS `Proba_2`, sigmoid_calibration_3.`Proba_3` / (sigmoid_calibration_3.`Proba_0` + sigmoid_calibration_3.`Proba_1` + sigmoid_calibration_3.`Proba_2` + sigmoid_calibration_3.`Proba_3`) AS `Proba_3` 
FROM sigmoid_calibration_3)
 SELECT `Score_Union_CTE_esu_0`.`KEY`, `Score_Union_CTE_esu_0`.`Proba_0`, `Score_Union_CTE_esu_0`.`Proba_1`, `Score_Union_CTE_esu_0`.`Proba_2`, `Score_Union_CTE_esu_0`.`Proba_3` 
FROM (SELECT `Normalized_Probas`.`KEY` AS `KEY`, `Normalized_Probas`.`Proba_0` AS `Proba_0`, `Normalized_Probas`.`Proba_1` AS `Proba_1`, `Normalized_Probas`.`Proba_2` AS `Proba_2`, `Normalized_Probas`.`Proba_3` AS `Proba_3` 
FROM `Normalized_Probas` UNION ALL SELECT `Normalized_Probas_1`.`KEY` AS `KEY`, `Normalized_Probas_1`.`Proba_0` AS `Proba_0`, `Normalized_Probas_1`.`Proba_1` AS `Proba_1`, `Normalized_Probas_1`.`Proba_2` AS `Proba_2`, `Normalized_Probas_1`.`Proba_3` AS `Proba_3` 
FROM `Normalized_Probas_1` UNION ALL SELECT `Normalized_Probas_2`.`KEY` AS `KEY`, `Normalized_Probas_2`.`Proba_0` AS `Proba_0`, `Normalized_Probas_2`.`Proba_1` AS `Proba_1`, `Normalized_Probas_2`.`Proba_2` AS `Proba_2`, `Normalized_Probas_2`.`Proba_3` AS `Proba_3` 
FROM `Normalized_Probas_2` UNION ALL SELECT `Normalized_Probas_3`.`KEY` AS `KEY`, `Normalized_Probas_3`.`Proba_0` AS `Proba_0`, `Normalized_Probas_3`.`Proba_1` AS `Proba_1`, `Normalized_Probas_3`.`Proba_2` AS `Proba_2`, `Normalized_Probas_3`.`Proba_3` AS `Proba_3` 
FROM `Normalized_Probas_3`) AS `Score_Union_CTE_esu_0`), 
`Score_Union_CTE` AS 
(SELECT `Score_Union_CTEbig_esu`.`KEY` AS `KEY`, `Score_Union_CTEbig_esu`.`Proba_0` AS `Proba_0`, `Score_Union_CTEbig_esu`.`Proba_1` AS `Proba_1`, `Score_Union_CTEbig_esu`.`Proba_2` AS `Proba_2`, `Score_Union_CTEbig_esu`.`Proba_3` AS `Proba_3` 
FROM (SELECT `Score_Union_CTE_0`.`KEY` AS `KEY`, `Score_Union_CTE_0`.`Proba_0` AS `Proba_0`, `Score_Union_CTE_0`.`Proba_1` AS `Proba_1`, `Score_Union_CTE_0`.`Proba_2` AS `Proba_2`, `Score_Union_CTE_0`.`Proba_3` AS `Proba_3` 
FROM `Score_Union_CTE_0`) AS `Score_Union_CTEbig_esu`), 
`Calibrate_AVG_Proba` AS 
(SELECT `T`.`KEY` AS `KEY`, `T`.`Proba_0` AS `Proba_0`, `T`.`Proba_1` AS `Proba_1`, `T`.`Proba_2` AS `Proba_2`, `T`.`Proba_3` AS `Proba_3` 
FROM (SELECT `Score_Union_CTE`.`KEY` AS `KEY`, avg(`Score_Union_CTE`.`Proba_0`) AS `Proba_0`, avg(`Score_Union_CTE`.`Proba_1`) AS `Proba_1`, avg(`Score_Union_CTE`.`Proba_2`) AS `Proba_2`, avg(`Score_Union_CTE`.`Proba_3`) AS `Proba_3` 
FROM `Score_Union_CTE` GROUP BY `Score_Union_CTE`.`KEY`) AS `T`), 
orig_cte AS 
(SELECT `Calibrate_AVG_Proba`.`KEY` AS `KEY`, NULL AS `Score_0`, NULL AS `Score_1`, NULL AS `Score_2`, NULL AS `Score_3`, `Calibrate_AVG_Proba`.`Proba_0` AS `Proba_0`, `Calibrate_AVG_Proba`.`Proba_1` AS `Proba_1`, `Calibrate_AVG_Proba`.`Proba_2` AS `Proba_2`, `Calibrate_AVG_Proba`.`Proba_3` AS `Proba_3`, NULL AS `LogProba_0`, NULL AS `LogProba_1`, NULL AS `LogProba_2`, NULL AS `LogProba_3`, CAST(NULL AS SIGNED INTEGER) AS `Decision`, NULL AS `DecisionProba` 
FROM `Calibrate_AVG_Proba`), 
score_class_union AS 
(SELECT scu.`KEY_u` AS `KEY_u`, scu.class AS class, scu.`LogProba` AS `LogProba`, scu.`Proba` AS `Proba`, scu.`Score` AS `Score` 
FROM (SELECT orig_cte.`KEY` AS `KEY_u`, 0 AS class, orig_cte.`LogProba_0` AS `LogProba`, orig_cte.`Proba_0` AS `Proba`, orig_cte.`Score_0` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 1 AS class, orig_cte.`LogProba_1` AS `LogProba`, orig_cte.`Proba_1` AS `Proba`, orig_cte.`Score_1` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 2 AS class, orig_cte.`LogProba_2` AS `LogProba`, orig_cte.`Proba_2` AS `Proba`, orig_cte.`Score_2` AS `Score` 
FROM orig_cte UNION ALL SELECT orig_cte.`KEY` AS `KEY_u`, 3 AS class, orig_cte.`LogProba_3` AS `LogProba`, orig_cte.`Proba_3` AS `Proba`, orig_cte.`Score_3` AS `Score` 
FROM orig_cte) AS scu), 
score_max AS 
(SELECT orig_cte.`KEY` AS `KEY`, orig_cte.`Score_0` AS `Score_0`, orig_cte.`Score_1` AS `Score_1`, orig_cte.`Score_2` AS `Score_2`, orig_cte.`Score_3` AS `Score_3`, orig_cte.`Proba_0` AS `Proba_0`, orig_cte.`Proba_1` AS `Proba_1`, orig_cte.`Proba_2` AS `Proba_2`, orig_cte.`Proba_3` AS `Proba_3`, orig_cte.`LogProba_0` AS `LogProba_0`, orig_cte.`LogProba_1` AS `LogProba_1`, orig_cte.`LogProba_2` AS `LogProba_2`, orig_cte.`LogProba_3` AS `LogProba_3`, orig_cte.`Decision` AS `Decision`, orig_cte.`DecisionProba` AS `DecisionProba`, max_select.`KEY_m` AS `KEY_m`, max_select.`max_Proba` AS `max_Proba` 
FROM orig_cte LEFT OUTER JOIN (SELECT score_class_union.`KEY_u` AS `KEY_m`, max(score_class_union.`Proba`) AS `max_Proba` 
FROM score_class_union GROUP BY score_class_union.`KEY_u`) AS max_select ON orig_cte.`KEY` = max_select.`KEY_m`), 
union_with_max AS 
(SELECT score_class_union.`KEY_u` AS `KEY_u`, score_class_union.class AS class, score_class_union.`LogProba` AS `LogProba`, score_class_union.`Proba` AS `Proba`, score_class_union.`Score` AS `Score`, score_max.`KEY` AS `KEY`, score_max.`Score_0` AS `Score_0`, score_max.`Score_1` AS `Score_1`, score_max.`Score_2` AS `Score_2`, score_max.`Score_3` AS `Score_3`, score_max.`Proba_0` AS `Proba_0`, score_max.`Proba_1` AS `Proba_1`, score_max.`Proba_2` AS `Proba_2`, score_max.`Proba_3` AS `Proba_3`, score_max.`LogProba_0` AS `LogProba_0`, score_max.`LogProba_1` AS `LogProba_1`, score_max.`LogProba_2` AS `LogProba_2`, score_max.`LogProba_3` AS `LogProba_3`, score_max.`Decision` AS `Decision`, score_max.`DecisionProba` AS `DecisionProba`, score_max.`KEY_m` AS `KEY_m`, score_max.`max_Proba` AS `max_Proba` 
FROM score_class_union LEFT OUTER JOIN score_max ON score_class_union.`KEY_u` = score_max.`KEY`), 
arg_max_cte AS 
(SELECT score_max.`KEY` AS `KEY`, score_max.`Score_0` AS `Score_0`, score_max.`Score_1` AS `Score_1`, score_max.`Score_2` AS `Score_2`, score_max.`Score_3` AS `Score_3`, score_max.`Proba_0` AS `Proba_0`, score_max.`Proba_1` AS `Proba_1`, score_max.`Proba_2` AS `Proba_2`, score_max.`Proba_3` AS `Proba_3`, score_max.`LogProba_0` AS `LogProba_0`, score_max.`LogProba_1` AS `LogProba_1`, score_max.`LogProba_2` AS `LogProba_2`, score_max.`LogProba_3` AS `LogProba_3`, score_max.`Decision` AS `Decision`, score_max.`DecisionProba` AS `DecisionProba`, score_max.`KEY_m` AS `KEY_m`, score_max.`max_Proba` AS `max_Proba`, `arg_max_t_Proba`.`KEY_Proba` AS `KEY_Proba`, `arg_max_t_Proba`.`arg_max_Proba` AS `arg_max_Proba` 
FROM score_max LEFT OUTER JOIN (SELECT union_with_max.`KEY` AS `KEY_Proba`, min(union_with_max.class) AS `arg_max_Proba` 
FROM union_with_max 
WHERE union_with_max.`max_Proba` <= union_with_max.`Proba` GROUP BY union_with_max.`KEY`) AS `arg_max_t_Proba` ON score_max.`KEY` = `arg_max_t_Proba`.`KEY_Proba`)
 SELECT arg_max_cte.`KEY` AS `KEY`, arg_max_cte.`Score_0` AS `Score_0`, arg_max_cte.`Score_1` AS `Score_1`, arg_max_cte.`Score_2` AS `Score_2`, arg_max_cte.`Score_3` AS `Score_3`, arg_max_cte.`Proba_0` AS `Proba_0`, arg_max_cte.`Proba_1` AS `Proba_1`, arg_max_cte.`Proba_2` AS `Proba_2`, arg_max_cte.`Proba_3` AS `Proba_3`, CASE WHEN (arg_max_cte.`Proba_0` IS NULL OR arg_max_cte.`Proba_0` > 0.0) THEN ln(arg_max_cte.`Proba_0`) ELSE -1.79769313486231e+308 END AS `LogProba_0`, CASE WHEN (arg_max_cte.`Proba_1` IS NULL OR arg_max_cte.`Proba_1` > 0.0) THEN ln(arg_max_cte.`Proba_1`) ELSE -1.79769313486231e+308 END AS `LogProba_1`, CASE WHEN (arg_max_cte.`Proba_2` IS NULL OR arg_max_cte.`Proba_2` > 0.0) THEN ln(arg_max_cte.`Proba_2`) ELSE -1.79769313486231e+308 END AS `LogProba_2`, CASE WHEN (arg_max_cte.`Proba_3` IS NULL OR arg_max_cte.`Proba_3` > 0.0) THEN ln(arg_max_cte.`Proba_3`) ELSE -1.79769313486231e+308 END AS `LogProba_3`, arg_max_cte.`arg_max_Proba` AS `Decision`, arg_max_cte.`max_Proba` AS `DecisionProba` 
FROM arg_max_cte